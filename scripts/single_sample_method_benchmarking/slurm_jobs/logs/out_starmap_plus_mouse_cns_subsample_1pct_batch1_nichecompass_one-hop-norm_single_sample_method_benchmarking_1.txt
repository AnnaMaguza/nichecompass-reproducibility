Run timestamp: 15062023_155642.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_1pct_batch1', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 1984
Number of validation edges: 220
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8080; val_auprc_score: 0.7819; val_best_acc_score: 0.7409; val_best_f1_score: 0.7799; train_kl_reg_loss: 31.0822; train_edge_recon_loss: 346243.7812; train_gene_expr_recon_loss: 222847.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 569122.8750; train_optim_loss: 569122.8750; val_kl_reg_loss: 55.4930; val_edge_recon_loss: 380116.7812; val_gene_expr_recon_loss: 191260.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 571433.2500; val_optim_loss: 571433.2500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7682; val_auprc_score: 0.7497; val_best_acc_score: 0.7000; val_best_f1_score: 0.7609; train_kl_reg_loss: 55.4399; train_edge_recon_loss: 345949.5312; train_gene_expr_recon_loss: 186261.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 532266.4375; train_optim_loss: 532266.4375; val_kl_reg_loss: 118.6250; val_edge_recon_loss: 385667.0312; val_gene_expr_recon_loss: 169072.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554858.4375; val_optim_loss: 554858.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7534; val_auprc_score: 0.7398; val_best_acc_score: 0.7000; val_best_f1_score: 0.7617; train_kl_reg_loss: 117.4534; train_edge_recon_loss: 345477.1875; train_gene_expr_recon_loss: 164895.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 510490.5000; train_optim_loss: 510490.5000; val_kl_reg_loss: 216.9329; val_edge_recon_loss: 387378.5312; val_gene_expr_recon_loss: 158637.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 546232.7500; val_optim_loss: 546232.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7506; val_auprc_score: 0.7475; val_best_acc_score: 0.6932; val_best_f1_score: 0.7619; train_kl_reg_loss: 214.8218; train_edge_recon_loss: 344912.7188; train_gene_expr_recon_loss: 154780.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499908.4688; train_optim_loss: 499908.4688; val_kl_reg_loss: 305.6791; val_edge_recon_loss: 379830.0312; val_gene_expr_recon_loss: 155023.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 535158.8750; val_optim_loss: 535158.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7013; val_auprc_score: 0.6860; val_best_acc_score: 0.6705; val_best_f1_score: 0.7423; train_kl_reg_loss: 305.7516; train_edge_recon_loss: 344476.6875; train_gene_expr_recon_loss: 151093.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495875.7812; train_optim_loss: 495875.7812; val_kl_reg_loss: 366.3768; val_edge_recon_loss: 376118.4375; val_gene_expr_recon_loss: 154686.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 531171.3750; val_optim_loss: 531171.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7658; val_auprc_score: 0.7499; val_best_acc_score: 0.7364; val_best_f1_score: 0.7836; train_kl_reg_loss: 361.6145; train_edge_recon_loss: 343377.8438; train_gene_expr_recon_loss: 150514.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494254.2500; train_optim_loss: 494254.2500; val_kl_reg_loss: 372.1657; val_edge_recon_loss: 342759.5938; val_gene_expr_recon_loss: 155262.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498394.1250; val_optim_loss: 498394.1250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7285; val_auprc_score: 0.7131; val_best_acc_score: 0.6864; val_best_f1_score: 0.7587; train_kl_reg_loss: 369.7069; train_edge_recon_loss: 340288.5625; train_gene_expr_recon_loss: 150804.6406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491462.9375; train_optim_loss: 491462.9375; val_kl_reg_loss: 386.2838; val_edge_recon_loss: 341529.9688; val_gene_expr_recon_loss: 155822.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 497739.0625; val_optim_loss: 497739.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7426; val_auprc_score: 0.7322; val_best_acc_score: 0.6773; val_best_f1_score: 0.7444; train_kl_reg_loss: 387.0306; train_edge_recon_loss: 338694.3438; train_gene_expr_recon_loss: 151072.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490153.5312; train_optim_loss: 490153.5312; val_kl_reg_loss: 396.5418; val_edge_recon_loss: 334150.1250; val_gene_expr_recon_loss: 156189.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490735.8125; val_optim_loss: 490735.8125
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7570; val_auprc_score: 0.7293; val_best_acc_score: 0.6818; val_best_f1_score: 0.7513; train_kl_reg_loss: 403.7725; train_edge_recon_loss: 335206.3750; train_gene_expr_recon_loss: 151203.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486813.5312; train_optim_loss: 486813.5312; val_kl_reg_loss: 436.7681; val_edge_recon_loss: 320486.3750; val_gene_expr_recon_loss: 156363.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477286.6250; val_optim_loss: 477286.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7801; val_auprc_score: 0.7630; val_best_acc_score: 0.7023; val_best_f1_score: 0.7527; train_kl_reg_loss: 448.5765; train_edge_recon_loss: 330963.7812; train_gene_expr_recon_loss: 151208.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482620.5938; train_optim_loss: 482620.5938; val_kl_reg_loss: 512.5798; val_edge_recon_loss: 312583.3438; val_gene_expr_recon_loss: 156326.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469422.2188; val_optim_loss: 469422.2188
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7914; val_auprc_score: 0.7681; val_best_acc_score: 0.7136; val_best_f1_score: 0.7605; train_kl_reg_loss: 532.9508; train_edge_recon_loss: 325016.0312; train_gene_expr_recon_loss: 151053.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476602.6875; train_optim_loss: 476602.6875; val_kl_reg_loss: 653.7638; val_edge_recon_loss: 305741.5312; val_gene_expr_recon_loss: 156053.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462448.4688; val_optim_loss: 462448.4688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7674; val_auprc_score: 0.7671; val_best_acc_score: 0.6955; val_best_f1_score: 0.7398; train_kl_reg_loss: 685.5449; train_edge_recon_loss: 317623.2500; train_gene_expr_recon_loss: 150717.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469026.1875; train_optim_loss: 469026.1875; val_kl_reg_loss: 878.2651; val_edge_recon_loss: 317932.4688; val_gene_expr_recon_loss: 155516.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474327.3750; val_optim_loss: 474327.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7479; val_auprc_score: 0.7213; val_best_acc_score: 0.6750; val_best_f1_score: 0.7410; train_kl_reg_loss: 924.4823; train_edge_recon_loss: 311004.0625; train_gene_expr_recon_loss: 150151.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462079.8750; train_optim_loss: 462079.8750; val_kl_reg_loss: 1202.5444; val_edge_recon_loss: 315534.1562; val_gene_expr_recon_loss: 154740.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471476.8125; val_optim_loss: 471476.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7771; val_auprc_score: 0.7533; val_best_acc_score: 0.7114; val_best_f1_score: 0.7549; train_kl_reg_loss: 1268.7622; train_edge_recon_loss: 304830.0312; train_gene_expr_recon_loss: 149380.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455479.1250; train_optim_loss: 455479.1250; val_kl_reg_loss: 1528.7139; val_edge_recon_loss: 302636.7188; val_gene_expr_recon_loss: 153857.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458023.4375; val_optim_loss: 458023.4375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7570; val_auprc_score: 0.7623; val_best_acc_score: 0.6773; val_best_f1_score: 0.7339; train_kl_reg_loss: 1630.5331; train_edge_recon_loss: 301224.6875; train_gene_expr_recon_loss: 148529.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451385.1875; train_optim_loss: 451385.1875; val_kl_reg_loss: 1982.4280; val_edge_recon_loss: 316197.7188; val_gene_expr_recon_loss: 152957.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471137.5625; val_optim_loss: 471137.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7614; val_auprc_score: 0.7393; val_best_acc_score: 0.6818; val_best_f1_score: 0.7487; train_kl_reg_loss: 2138.1873; train_edge_recon_loss: 297773.3438; train_gene_expr_recon_loss: 147679.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447590.9375; train_optim_loss: 447590.9375; val_kl_reg_loss: 2566.4946; val_edge_recon_loss: 310440.0625; val_gene_expr_recon_loss: 152146.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465153.4688; val_optim_loss: 465153.4688
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7616; val_auprc_score: 0.7361; val_best_acc_score: 0.6955; val_best_f1_score: 0.7549; train_kl_reg_loss: 2746.8120; train_edge_recon_loss: 296380.7188; train_gene_expr_recon_loss: 146929.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446057.5000; train_optim_loss: 446057.5000; val_kl_reg_loss: 3176.2510; val_edge_recon_loss: 306349.8750; val_gene_expr_recon_loss: 151513.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461039.6875; val_optim_loss: 461039.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7658; val_auprc_score: 0.7567; val_best_acc_score: 0.6818; val_best_f1_score: 0.7509; train_kl_reg_loss: 3374.6926; train_edge_recon_loss: 300484.5625; train_gene_expr_recon_loss: 146348.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450208.0938; train_optim_loss: 450208.0938; val_kl_reg_loss: 3173.8076; val_edge_recon_loss: 313757.0625; val_gene_expr_recon_loss: 151448.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468379.2500; val_optim_loss: 468379.2500
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7396; val_auprc_score: 0.7399; val_best_acc_score: 0.6659; val_best_f1_score: 0.7372; train_kl_reg_loss: 3423.0298; train_edge_recon_loss: 296950.9062; train_gene_expr_recon_loss: 146286.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446660.0000; train_optim_loss: 446660.0000; val_kl_reg_loss: 3222.3162; val_edge_recon_loss: 320744.0938; val_gene_expr_recon_loss: 151361.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475327.9375; val_optim_loss: 475327.9375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8005; val_auprc_score: 0.7989; val_best_acc_score: 0.7136; val_best_f1_score: 0.7631; train_kl_reg_loss: 3453.7495; train_edge_recon_loss: 295340.8438; train_gene_expr_recon_loss: 146198.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444993.1875; train_optim_loss: 444993.1875; val_kl_reg_loss: 3224.4585; val_edge_recon_loss: 297325.4062; val_gene_expr_recon_loss: 151254.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451804.2500; val_optim_loss: 451804.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7895; val_auprc_score: 0.7680; val_best_acc_score: 0.7227; val_best_f1_score: 0.7576; train_kl_reg_loss: 3476.0288; train_edge_recon_loss: 294286.4688; train_gene_expr_recon_loss: 146093.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443855.9375; train_optim_loss: 443855.9375; val_kl_reg_loss: 3264.8735; val_edge_recon_loss: 301165.0000; val_gene_expr_recon_loss: 151131.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455561.0000; val_optim_loss: 455561.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.7398; val_auprc_score: 0.7273; val_best_acc_score: 0.6818; val_best_f1_score: 0.7430; train_kl_reg_loss: 3496.8823; train_edge_recon_loss: 297171.4688; train_gene_expr_recon_loss: 145971.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446640.0625; train_optim_loss: 446640.0625; val_kl_reg_loss: 3276.0518; val_edge_recon_loss: 314251.6875; val_gene_expr_recon_loss: 150997.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468525.5000; val_optim_loss: 468525.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.7571; val_auprc_score: 0.7558; val_best_acc_score: 0.6841; val_best_f1_score: 0.7391; train_kl_reg_loss: 3513.6113; train_edge_recon_loss: 294489.5312; train_gene_expr_recon_loss: 145836.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443839.9375; train_optim_loss: 443839.9375; val_kl_reg_loss: 3255.0632; val_edge_recon_loss: 315334.4375; val_gene_expr_recon_loss: 150856.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469445.8125; val_optim_loss: 469445.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.7601; val_auprc_score: 0.7368; val_best_acc_score: 0.6955; val_best_f1_score: 0.7509; train_kl_reg_loss: 3524.3337; train_edge_recon_loss: 294315.5312; train_gene_expr_recon_loss: 145692.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443532.3750; train_optim_loss: 443532.3750; val_kl_reg_loss: 3286.0977; val_edge_recon_loss: 308264.6562; val_gene_expr_recon_loss: 150841.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462392.3125; val_optim_loss: 462392.3125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.7290; val_auprc_score: 0.7016; val_best_acc_score: 0.6636; val_best_f1_score: 0.7343; train_kl_reg_loss: 3529.4897; train_edge_recon_loss: 297186.1562; train_gene_expr_recon_loss: 145681.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446397.4375; train_optim_loss: 446397.4375; val_kl_reg_loss: 3287.9111; val_edge_recon_loss: 325746.6875; val_gene_expr_recon_loss: 150825.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479860.5000; val_optim_loss: 479860.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.7731; val_auprc_score: 0.7413; val_best_acc_score: 0.7023; val_best_f1_score: 0.7617; train_kl_reg_loss: 3526.4495; train_edge_recon_loss: 295304.3125; train_gene_expr_recon_loss: 145662.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444493.6875; train_optim_loss: 444493.6875; val_kl_reg_loss: 3278.1694; val_edge_recon_loss: 301206.6250; val_gene_expr_recon_loss: 150809.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455294.1562; val_optim_loss: 455294.1562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 9 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.7996
Val AUPRC score: 0.7960
Val best accuracy score: 0.7227
Val best F1 score: 0.7631
Val gene expr MSE score: 1.1286
Duration of model training in run 1: 0 hours, 0 minutes and 14 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 1984
Number of validation edges: 220
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8118; val_auprc_score: 0.7951; val_best_acc_score: 0.7273; val_best_f1_score: 0.7634; train_kl_reg_loss: 23.8511; train_edge_recon_loss: 346386.5000; train_gene_expr_recon_loss: 223528.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 569939.1875; train_optim_loss: 569939.1875; val_kl_reg_loss: 47.7659; val_edge_recon_loss: 379502.9375; val_gene_expr_recon_loss: 188788.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568339.4375; val_optim_loss: 568339.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7535; val_auprc_score: 0.7337; val_best_acc_score: 0.6727; val_best_f1_score: 0.7387; train_kl_reg_loss: 48.5354; train_edge_recon_loss: 346319.0938; train_gene_expr_recon_loss: 185206.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531574.1875; train_optim_loss: 531574.1875; val_kl_reg_loss: 101.5437; val_edge_recon_loss: 388050.8125; val_gene_expr_recon_loss: 166859.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555011.5625; val_optim_loss: 555011.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7355; val_auprc_score: 0.7100; val_best_acc_score: 0.6977; val_best_f1_score: 0.7560; train_kl_reg_loss: 102.8759; train_edge_recon_loss: 345461.3438; train_gene_expr_recon_loss: 163845.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 509409.4375; train_optim_loss: 509409.4375; val_kl_reg_loss: 185.6433; val_edge_recon_loss: 386173.1562; val_gene_expr_recon_loss: 157444.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 543803.0625; val_optim_loss: 543803.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7407; val_auprc_score: 0.7410; val_best_acc_score: 0.6909; val_best_f1_score: 0.7563; train_kl_reg_loss: 186.9380; train_edge_recon_loss: 344763.5625; train_gene_expr_recon_loss: 154626.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499577.0938; train_optim_loss: 499577.0938; val_kl_reg_loss: 277.3132; val_edge_recon_loss: 384923.5938; val_gene_expr_recon_loss: 154490.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 539691.6250; val_optim_loss: 539691.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7458; val_auprc_score: 0.7462; val_best_acc_score: 0.6977; val_best_f1_score: 0.7580; train_kl_reg_loss: 283.0051; train_edge_recon_loss: 344808.6250; train_gene_expr_recon_loss: 151585.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496676.8750; train_optim_loss: 496676.8750; val_kl_reg_loss: 337.6237; val_edge_recon_loss: 370263.0312; val_gene_expr_recon_loss: 154248.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 524849.4375; val_optim_loss: 524849.4375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7616; val_auprc_score: 0.7533; val_best_acc_score: 0.7136; val_best_f1_score: 0.7692; train_kl_reg_loss: 344.8955; train_edge_recon_loss: 343745.3125; train_gene_expr_recon_loss: 151207.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495297.3125; train_optim_loss: 495297.3125; val_kl_reg_loss: 353.7016; val_edge_recon_loss: 345408.0312; val_gene_expr_recon_loss: 154617.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 500379.1562; val_optim_loss: 500379.1562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7256; val_auprc_score: 0.7117; val_best_acc_score: 0.6909; val_best_f1_score: 0.7612; train_kl_reg_loss: 360.7789; train_edge_recon_loss: 342102.0625; train_gene_expr_recon_loss: 151466.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493929.0312; train_optim_loss: 493929.0312; val_kl_reg_loss: 359.6884; val_edge_recon_loss: 336324.9375; val_gene_expr_recon_loss: 154648.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491333.3125; val_optim_loss: 491333.3125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7985; val_auprc_score: 0.7773; val_best_acc_score: 0.7136; val_best_f1_score: 0.7698; train_kl_reg_loss: 358.2583; train_edge_recon_loss: 339362.5312; train_gene_expr_recon_loss: 151370.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491090.8750; train_optim_loss: 491090.8750; val_kl_reg_loss: 366.3256; val_edge_recon_loss: 314946.9375; val_gene_expr_recon_loss: 154134.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469448.1875; val_optim_loss: 469448.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7598; val_auprc_score: 0.7686; val_best_acc_score: 0.6591; val_best_f1_score: 0.7399; train_kl_reg_loss: 368.8591; train_edge_recon_loss: 335464.2812; train_gene_expr_recon_loss: 150785.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486618.6250; train_optim_loss: 486618.6250; val_kl_reg_loss: 429.4951; val_edge_recon_loss: 329082.5000; val_gene_expr_recon_loss: 153318.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 482830.2500; val_optim_loss: 482830.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7846; val_auprc_score: 0.7752; val_best_acc_score: 0.6977; val_best_f1_score: 0.7556; train_kl_reg_loss: 425.9094; train_edge_recon_loss: 330677.0938; train_gene_expr_recon_loss: 149965.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481068.0938; train_optim_loss: 481068.0938; val_kl_reg_loss: 534.8575; val_edge_recon_loss: 315213.8438; val_gene_expr_recon_loss: 152528.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468276.7812; val_optim_loss: 468276.7812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7896; val_auprc_score: 0.7923; val_best_acc_score: 0.7091; val_best_f1_score: 0.7636; train_kl_reg_loss: 532.9832; train_edge_recon_loss: 325156.7500; train_gene_expr_recon_loss: 149216.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474906.0625; train_optim_loss: 474906.0625; val_kl_reg_loss: 690.0650; val_edge_recon_loss: 305003.3750; val_gene_expr_recon_loss: 151914.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457608.4062; val_optim_loss: 457608.4062
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8033; val_auprc_score: 0.8012; val_best_acc_score: 0.7182; val_best_f1_score: 0.7569; train_kl_reg_loss: 690.9685; train_edge_recon_loss: 319563.1562; train_gene_expr_recon_loss: 148663.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468917.8750; train_optim_loss: 468917.8750; val_kl_reg_loss: 896.9224; val_edge_recon_loss: 302785.9688; val_gene_expr_recon_loss: 151426.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455109.1875; val_optim_loss: 455109.1875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7816; val_auprc_score: 0.7808; val_best_acc_score: 0.7136; val_best_f1_score: 0.7558; train_kl_reg_loss: 891.2801; train_edge_recon_loss: 311490.1562; train_gene_expr_recon_loss: 148236.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460618.2500; train_optim_loss: 460618.2500; val_kl_reg_loss: 1216.9434; val_edge_recon_loss: 305938.4688; val_gene_expr_recon_loss: 150938.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458094.3125; val_optim_loss: 458094.3125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.7830; val_auprc_score: 0.7711; val_best_acc_score: 0.7045; val_best_f1_score: 0.7509; train_kl_reg_loss: 1209.7974; train_edge_recon_loss: 305962.1875; train_gene_expr_recon_loss: 147826.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454998.4375; train_optim_loss: 454998.4375; val_kl_reg_loss: 1643.4448; val_edge_recon_loss: 303790.7188; val_gene_expr_recon_loss: 150404.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455838.9375; val_optim_loss: 455838.9375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7746; val_auprc_score: 0.7799; val_best_acc_score: 0.6864; val_best_f1_score: 0.7431; train_kl_reg_loss: 1637.6318; train_edge_recon_loss: 302333.3750; train_gene_expr_recon_loss: 147344.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451315.1250; train_optim_loss: 451315.1250; val_kl_reg_loss: 2141.2896; val_edge_recon_loss: 311740.3125; val_gene_expr_recon_loss: 149839.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463721.0000; val_optim_loss: 463721.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7742; val_auprc_score: 0.7740; val_best_acc_score: 0.7000; val_best_f1_score: 0.7450; train_kl_reg_loss: 2144.0547; train_edge_recon_loss: 296700.4375; train_gene_expr_recon_loss: 146819.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445663.9375; train_optim_loss: 445663.9375; val_kl_reg_loss: 2212.9409; val_edge_recon_loss: 307818.2188; val_gene_expr_recon_loss: 149755.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459787.0625; val_optim_loss: 459787.0625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7249; val_auprc_score: 0.7307; val_best_acc_score: 0.6545; val_best_f1_score: 0.7224; train_kl_reg_loss: 2190.0210; train_edge_recon_loss: 298048.2500; train_gene_expr_recon_loss: 146745.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446984.0312; train_optim_loss: 446984.0312; val_kl_reg_loss: 2294.0393; val_edge_recon_loss: 327123.2188; val_gene_expr_recon_loss: 149625.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479043.1875; val_optim_loss: 479043.1875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7677; val_auprc_score: 0.7634; val_best_acc_score: 0.6909; val_best_f1_score: 0.7404; train_kl_reg_loss: 2250.3179; train_edge_recon_loss: 296464.9062; train_gene_expr_recon_loss: 146616.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445331.4688; train_optim_loss: 445331.4688; val_kl_reg_loss: 2330.5566; val_edge_recon_loss: 311568.2812; val_gene_expr_recon_loss: 149460.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463359.2500; val_optim_loss: 463359.2500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 5 sec.
Using best model state, which was in epoch 12.

--- MODEL EVALUATION ---
Val AUROC score: 0.7982
Val AUPRC score: 0.7938
Val best accuracy score: 0.7045
Val best F1 score: 0.7473
Val gene expr MSE score: 1.4299
Duration of model training in run 2: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 3829
Number of validation edges: 425
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8451; val_auprc_score: 0.8450; val_best_acc_score: 0.7176; val_best_f1_score: 0.7695; train_kl_reg_loss: 42.1607; train_edge_recon_loss: 346194.4531; train_gene_expr_recon_loss: 198841.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545077.8125; train_optim_loss: 545077.8125; val_kl_reg_loss: 115.4455; val_edge_recon_loss: 386411.5938; val_gene_expr_recon_loss: 167073.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553600.6250; val_optim_loss: 553600.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8109; val_auprc_score: 0.7910; val_best_acc_score: 0.7165; val_best_f1_score: 0.7698; train_kl_reg_loss: 166.4221; train_edge_recon_loss: 345819.9219; train_gene_expr_recon_loss: 156836.5547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 502822.8906; train_optim_loss: 502822.8906; val_kl_reg_loss: 286.8453; val_edge_recon_loss: 378004.3438; val_gene_expr_recon_loss: 154996.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 533287.7500; val_optim_loss: 533287.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7823; val_auprc_score: 0.8013; val_best_acc_score: 0.7047; val_best_f1_score: 0.7442; train_kl_reg_loss: 323.7019; train_edge_recon_loss: 344048.3594; train_gene_expr_recon_loss: 150556.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494929.0625; train_optim_loss: 494929.0625; val_kl_reg_loss: 359.7614; val_edge_recon_loss: 355120.7812; val_gene_expr_recon_loss: 155016.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 510497.3438; val_optim_loss: 510497.3438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8263; val_auprc_score: 0.8405; val_best_acc_score: 0.7224; val_best_f1_score: 0.7509; train_kl_reg_loss: 370.0588; train_edge_recon_loss: 340042.4062; train_gene_expr_recon_loss: 150965.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491378.1875; train_optim_loss: 491378.1875; val_kl_reg_loss: 384.4735; val_edge_recon_loss: 325880.8125; val_gene_expr_recon_loss: 155161.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481426.3125; val_optim_loss: 481426.3125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8066; val_auprc_score: 0.8172; val_best_acc_score: 0.7059; val_best_f1_score: 0.7487; train_kl_reg_loss: 421.4848; train_edge_recon_loss: 333726.7031; train_gene_expr_recon_loss: 151074.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485223.0625; train_optim_loss: 485223.0625; val_kl_reg_loss: 525.2493; val_edge_recon_loss: 321863.3750; val_gene_expr_recon_loss: 154121.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476510.5625; val_optim_loss: 476510.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8018; val_auprc_score: 0.8005; val_best_acc_score: 0.7059; val_best_f1_score: 0.7649; train_kl_reg_loss: 599.7609; train_edge_recon_loss: 322930.0781; train_gene_expr_recon_loss: 150443.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473973.0312; train_optim_loss: 473973.0312; val_kl_reg_loss: 840.0231; val_edge_recon_loss: 305641.2188; val_gene_expr_recon_loss: 152876.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459357.5312; val_optim_loss: 459357.5312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7779; val_auprc_score: 0.7768; val_best_acc_score: 0.6882; val_best_f1_score: 0.7493; train_kl_reg_loss: 987.1867; train_edge_recon_loss: 309926.0938; train_gene_expr_recon_loss: 148664.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459577.4844; train_optim_loss: 459577.4844; val_kl_reg_loss: 1478.2944; val_edge_recon_loss: 311520.6250; val_gene_expr_recon_loss: 151622.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464621.1875; val_optim_loss: 464621.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7999; val_auprc_score: 0.8033; val_best_acc_score: 0.7106; val_best_f1_score: 0.7526; train_kl_reg_loss: 1663.8360; train_edge_recon_loss: 303820.2188; train_gene_expr_recon_loss: 146908.1328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452392.1875; train_optim_loss: 452392.1875; val_kl_reg_loss: 2396.7510; val_edge_recon_loss: 306833.0938; val_gene_expr_recon_loss: 150605.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459835.4375; val_optim_loss: 459835.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7969; val_auprc_score: 0.7777; val_best_acc_score: 0.7153; val_best_f1_score: 0.7658; train_kl_reg_loss: 2652.0836; train_edge_recon_loss: 300770.0625; train_gene_expr_recon_loss: 145813.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449235.3438; train_optim_loss: 449235.3438; val_kl_reg_loss: 3442.2510; val_edge_recon_loss: 298501.1875; val_gene_expr_recon_loss: 149880.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451823.4375; val_optim_loss: 451823.4375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7925; val_auprc_score: 0.7772; val_best_acc_score: 0.7165; val_best_f1_score: 0.7544; train_kl_reg_loss: 3579.5455; train_edge_recon_loss: 297701.1406; train_gene_expr_recon_loss: 144907.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446187.7969; train_optim_loss: 446187.7969; val_kl_reg_loss: 4172.1250; val_edge_recon_loss: 307439.1250; val_gene_expr_recon_loss: 149186.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460797.2500; val_optim_loss: 460797.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7797; val_auprc_score: 0.7689; val_best_acc_score: 0.7000; val_best_f1_score: 0.7551; train_kl_reg_loss: 4294.5906; train_edge_recon_loss: 299383.7500; train_gene_expr_recon_loss: 145265.8203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448944.1719; train_optim_loss: 448944.1719; val_kl_reg_loss: 4717.1235; val_edge_recon_loss: 307519.5938; val_gene_expr_recon_loss: 148426.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460663.0625; val_optim_loss: 460663.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8039; val_auprc_score: 0.7840; val_best_acc_score: 0.7176; val_best_f1_score: 0.7614; train_kl_reg_loss: 4673.4463; train_edge_recon_loss: 297042.7656; train_gene_expr_recon_loss: 143624.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445340.4062; train_optim_loss: 445340.4062; val_kl_reg_loss: 4772.3511; val_edge_recon_loss: 298729.5000; val_gene_expr_recon_loss: 147855.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451356.9688; val_optim_loss: 451356.9688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8001; val_auprc_score: 0.7711; val_best_acc_score: 0.7282; val_best_f1_score: 0.7680; train_kl_reg_loss: 4727.5737; train_edge_recon_loss: 296702.0312; train_gene_expr_recon_loss: 143081.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444511.2500; train_optim_loss: 444511.2500; val_kl_reg_loss: 4765.2295; val_edge_recon_loss: 296282.0312; val_gene_expr_recon_loss: 147420.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448467.5938; val_optim_loss: 448467.5938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8125; val_auprc_score: 0.8102; val_best_acc_score: 0.7200; val_best_f1_score: 0.7708; train_kl_reg_loss: 4622.9353; train_edge_recon_loss: 290126.0156; train_gene_expr_recon_loss: 143300.7344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438049.6875; train_optim_loss: 438049.6875; val_kl_reg_loss: 4583.1455; val_edge_recon_loss: 301986.9688; val_gene_expr_recon_loss: 147030.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453601.0000; val_optim_loss: 453601.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8404; val_auprc_score: 0.8190; val_best_acc_score: 0.7706; val_best_f1_score: 0.8020; train_kl_reg_loss: 4500.4739; train_edge_recon_loss: 288706.8438; train_gene_expr_recon_loss: 142606.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435813.7500; train_optim_loss: 435813.7500; val_kl_reg_loss: 4355.0176; val_edge_recon_loss: 284376.6875; val_gene_expr_recon_loss: 146737.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 435469.0938; val_optim_loss: 435469.0938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8429; val_auprc_score: 0.8161; val_best_acc_score: 0.7753; val_best_f1_score: 0.8016; train_kl_reg_loss: 4184.7783; train_edge_recon_loss: 288710.8750; train_gene_expr_recon_loss: 142320.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435215.9688; train_optim_loss: 435215.9688; val_kl_reg_loss: 3974.4924; val_edge_recon_loss: 279896.8125; val_gene_expr_recon_loss: 146561.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430432.3125; val_optim_loss: 430432.3125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8468; val_auprc_score: 0.8217; val_best_acc_score: 0.7682; val_best_f1_score: 0.7959; train_kl_reg_loss: 3840.3962; train_edge_recon_loss: 285593.8594; train_gene_expr_recon_loss: 142126.5625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431560.8125; train_optim_loss: 431560.8125; val_kl_reg_loss: 3783.3047; val_edge_recon_loss: 282720.0312; val_gene_expr_recon_loss: 146373.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432876.5000; val_optim_loss: 432876.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8442; val_auprc_score: 0.8232; val_best_acc_score: 0.7847; val_best_f1_score: 0.8022; train_kl_reg_loss: 3622.0359; train_edge_recon_loss: 283347.2500; train_gene_expr_recon_loss: 141745.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428714.7344; train_optim_loss: 428714.7344; val_kl_reg_loss: 3627.2871; val_edge_recon_loss: 292479.3438; val_gene_expr_recon_loss: 146063.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442169.7812; val_optim_loss: 442169.7812
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8494; val_auprc_score: 0.8159; val_best_acc_score: 0.7918; val_best_f1_score: 0.8138; train_kl_reg_loss: 3588.4760; train_edge_recon_loss: 281788.7500; train_gene_expr_recon_loss: 142614.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427992.0625; train_optim_loss: 427992.0625; val_kl_reg_loss: 3626.0085; val_edge_recon_loss: 284604.4062; val_gene_expr_recon_loss: 145870.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434100.5000; val_optim_loss: 434100.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8594; val_auprc_score: 0.8427; val_best_acc_score: 0.7988; val_best_f1_score: 0.8177; train_kl_reg_loss: 3582.8369; train_edge_recon_loss: 282374.6094; train_gene_expr_recon_loss: 141853.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427810.6719; train_optim_loss: 427810.6719; val_kl_reg_loss: 3625.8018; val_edge_recon_loss: 284968.7812; val_gene_expr_recon_loss: 145841.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434436.4375; val_optim_loss: 434436.4375
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8587; val_auprc_score: 0.8357; val_best_acc_score: 0.7918; val_best_f1_score: 0.8119; train_kl_reg_loss: 3574.4165; train_edge_recon_loss: 281042.0625; train_gene_expr_recon_loss: 141983.9453; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426600.4219; train_optim_loss: 426600.4219; val_kl_reg_loss: 3624.1426; val_edge_recon_loss: 292882.0312; val_gene_expr_recon_loss: 145799.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442305.6875; val_optim_loss: 442305.6875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8577; val_auprc_score: 0.8138; val_best_acc_score: 0.8059; val_best_f1_score: 0.8193; train_kl_reg_loss: 3566.8374; train_edge_recon_loss: 278602.6562; train_gene_expr_recon_loss: 142288.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424458.3750; train_optim_loss: 424458.3750; val_kl_reg_loss: 3607.1411; val_edge_recon_loss: 289162.2500; val_gene_expr_recon_loss: 145755.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438525.1562; val_optim_loss: 438525.1562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 8 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
Val AUROC score: 0.8394
Val AUPRC score: 0.8211
Val best accuracy score: 0.7706
Val best F1 score: 0.7919
Val gene expr MSE score: 1.3019
Duration of model training in run 3: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 3829
Number of validation edges: 425
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8839; val_auprc_score: 0.8906; val_best_acc_score: 0.7459; val_best_f1_score: 0.7854; train_kl_reg_loss: 38.2784; train_edge_recon_loss: 346337.5625; train_gene_expr_recon_loss: 205070.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 551446.3438; train_optim_loss: 551446.3438; val_kl_reg_loss: 103.6608; val_edge_recon_loss: 388211.9062; val_gene_expr_recon_loss: 166049.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554365.1875; val_optim_loss: 554365.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8301; val_auprc_score: 0.8286; val_best_acc_score: 0.7035; val_best_f1_score: 0.7548; train_kl_reg_loss: 143.3454; train_edge_recon_loss: 345643.0312; train_gene_expr_recon_loss: 160202.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 505989.0469; train_optim_loss: 505989.0469; val_kl_reg_loss: 255.4356; val_edge_recon_loss: 383435.5938; val_gene_expr_recon_loss: 153164.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 536855.6250; val_optim_loss: 536855.6250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8420; val_auprc_score: 0.8334; val_best_acc_score: 0.7271; val_best_f1_score: 0.7730; train_kl_reg_loss: 286.5406; train_edge_recon_loss: 344516.4062; train_gene_expr_recon_loss: 152038.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496841.6875; train_optim_loss: 496841.6875; val_kl_reg_loss: 325.4411; val_edge_recon_loss: 345213.8438; val_gene_expr_recon_loss: 153118.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 498658.1250; val_optim_loss: 498658.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8395; val_auprc_score: 0.8288; val_best_acc_score: 0.7259; val_best_f1_score: 0.7634; train_kl_reg_loss: 323.9252; train_edge_recon_loss: 341384.7188; train_gene_expr_recon_loss: 152342.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494051.3594; train_optim_loss: 494051.3594; val_kl_reg_loss: 342.4382; val_edge_recon_loss: 322277.9062; val_gene_expr_recon_loss: 153009.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475630.0312; val_optim_loss: 475630.0312
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8406; val_auprc_score: 0.8279; val_best_acc_score: 0.7435; val_best_f1_score: 0.7604; train_kl_reg_loss: 356.4494; train_edge_recon_loss: 334975.3438; train_gene_expr_recon_loss: 152415.8281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 487747.6250; train_optim_loss: 487747.6250; val_kl_reg_loss: 466.1907; val_edge_recon_loss: 314485.5000; val_gene_expr_recon_loss: 151487.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466438.7812; val_optim_loss: 466438.7812
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8340; val_auprc_score: 0.8284; val_best_acc_score: 0.7329; val_best_f1_score: 0.7714; train_kl_reg_loss: 540.5440; train_edge_recon_loss: 324128.8281; train_gene_expr_recon_loss: 150553.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475222.8125; train_optim_loss: 475222.8125; val_kl_reg_loss: 847.8763; val_edge_recon_loss: 302277.8438; val_gene_expr_recon_loss: 150067.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453193.6250; val_optim_loss: 453193.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7883; val_auprc_score: 0.7680; val_best_acc_score: 0.6988; val_best_f1_score: 0.7568; train_kl_reg_loss: 943.1774; train_edge_recon_loss: 310832.4688; train_gene_expr_recon_loss: 150282.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462058.2500; train_optim_loss: 462058.2500; val_kl_reg_loss: 1415.5686; val_edge_recon_loss: 308569.3125; val_gene_expr_recon_loss: 148974.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458959.4062; val_optim_loss: 458959.4062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8049; val_auprc_score: 0.7964; val_best_acc_score: 0.7235; val_best_f1_score: 0.7704; train_kl_reg_loss: 1560.3139; train_edge_recon_loss: 302554.5625; train_gene_expr_recon_loss: 149461.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453576.8281; train_optim_loss: 453576.8281; val_kl_reg_loss: 2278.5972; val_edge_recon_loss: 295288.5625; val_gene_expr_recon_loss: 147925.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445492.5000; val_optim_loss: 445492.5000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7985; val_auprc_score: 0.7881; val_best_acc_score: 0.7165; val_best_f1_score: 0.7630; train_kl_reg_loss: 2546.3362; train_edge_recon_loss: 300585.4062; train_gene_expr_recon_loss: 147797.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450929.1406; train_optim_loss: 450929.1406; val_kl_reg_loss: 3495.7583; val_edge_recon_loss: 303477.7188; val_gene_expr_recon_loss: 146751.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453724.4688; val_optim_loss: 453724.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8000; val_auprc_score: 0.7820; val_best_acc_score: 0.7247; val_best_f1_score: 0.7694; train_kl_reg_loss: 3678.5968; train_edge_recon_loss: 298146.0312; train_gene_expr_recon_loss: 147475.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449299.9062; train_optim_loss: 449299.9062; val_kl_reg_loss: 4367.2471; val_edge_recon_loss: 300342.6875; val_gene_expr_recon_loss: 145824.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450534.5312; val_optim_loss: 450534.5312
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.7972; val_auprc_score: 0.7840; val_best_acc_score: 0.7271; val_best_f1_score: 0.7786; train_kl_reg_loss: 4426.9529; train_edge_recon_loss: 296125.7812; train_gene_expr_recon_loss: 145768.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446321.5000; train_optim_loss: 446321.5000; val_kl_reg_loss: 4850.8647; val_edge_recon_loss: 293363.3750; val_gene_expr_recon_loss: 145229.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443444.0625; val_optim_loss: 443444.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8158; val_auprc_score: 0.8048; val_best_acc_score: 0.7212; val_best_f1_score: 0.7686; train_kl_reg_loss: 4885.9363; train_edge_recon_loss: 292390.7969; train_gene_expr_recon_loss: 144921.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442198.0938; train_optim_loss: 442198.0938; val_kl_reg_loss: 5173.0166; val_edge_recon_loss: 300356.7500; val_gene_expr_recon_loss: 144781.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450311.5625; val_optim_loss: 450311.5625
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8319; val_auprc_score: 0.8267; val_best_acc_score: 0.7459; val_best_f1_score: 0.7895; train_kl_reg_loss: 5195.3596; train_edge_recon_loss: 293604.9688; train_gene_expr_recon_loss: 144174.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442974.6875; train_optim_loss: 442974.6875; val_kl_reg_loss: 5312.8999; val_edge_recon_loss: 286852.6250; val_gene_expr_recon_loss: 144370.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436536.0625; val_optim_loss: 436536.0625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8224; val_auprc_score: 0.7939; val_best_acc_score: 0.7329; val_best_f1_score: 0.7804; train_kl_reg_loss: 5188.7559; train_edge_recon_loss: 292952.0000; train_gene_expr_recon_loss: 144172.3281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442313.0781; train_optim_loss: 442313.0781; val_kl_reg_loss: 5091.6865; val_edge_recon_loss: 294398.9688; val_gene_expr_recon_loss: 143968.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443459.3125; val_optim_loss: 443459.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8402; val_auprc_score: 0.8154; val_best_acc_score: 0.7494; val_best_f1_score: 0.7914; train_kl_reg_loss: 4891.3440; train_edge_recon_loss: 288171.8594; train_gene_expr_recon_loss: 143514.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436577.4219; train_optim_loss: 436577.4219; val_kl_reg_loss: 4723.8027; val_edge_recon_loss: 283029.0312; val_gene_expr_recon_loss: 143613.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431366.5625; val_optim_loss: 431366.5625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8424; val_auprc_score: 0.8273; val_best_acc_score: 0.7447; val_best_f1_score: 0.7876; train_kl_reg_loss: 4530.7671; train_edge_recon_loss: 291971.1562; train_gene_expr_recon_loss: 143353.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439855.2031; train_optim_loss: 439855.2031; val_kl_reg_loss: 4328.2598; val_edge_recon_loss: 286931.3750; val_gene_expr_recon_loss: 143212.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434472.1875; val_optim_loss: 434472.1875
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8521; val_auprc_score: 0.8314; val_best_acc_score: 0.7635; val_best_f1_score: 0.7869; train_kl_reg_loss: 4157.2915; train_edge_recon_loss: 289699.8125; train_gene_expr_recon_loss: 143351.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437208.5312; train_optim_loss: 437208.5312; val_kl_reg_loss: 3953.0430; val_edge_recon_loss: 286558.4062; val_gene_expr_recon_loss: 142886.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433397.6875; val_optim_loss: 433397.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8467; val_auprc_score: 0.8113; val_best_acc_score: 0.7671; val_best_f1_score: 0.7922; train_kl_reg_loss: 3874.6964; train_edge_recon_loss: 287331.6250; train_gene_expr_recon_loss: 142616.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433822.4062; train_optim_loss: 433822.4062; val_kl_reg_loss: 3729.8162; val_edge_recon_loss: 285307.8438; val_gene_expr_recon_loss: 142705.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431743.1250; val_optim_loss: 431743.1250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8500; val_auprc_score: 0.8222; val_best_acc_score: 0.7824; val_best_f1_score: 0.7922; train_kl_reg_loss: 3669.7759; train_edge_recon_loss: 287304.1875; train_gene_expr_recon_loss: 143440.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434414.7031; train_optim_loss: 434414.7031; val_kl_reg_loss: 3742.5806; val_edge_recon_loss: 285496.0938; val_gene_expr_recon_loss: 142669.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431907.8438; val_optim_loss: 431907.8438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8394; val_auprc_score: 0.8059; val_best_acc_score: 0.7576; val_best_f1_score: 0.7842; train_kl_reg_loss: 3666.7837; train_edge_recon_loss: 287571.6719; train_gene_expr_recon_loss: 143369.3594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434607.8125; train_optim_loss: 434607.8125; val_kl_reg_loss: 3711.1699; val_edge_recon_loss: 290091.4062; val_gene_expr_recon_loss: 142607.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436410.5000; val_optim_loss: 436410.5000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8418; val_auprc_score: 0.7960; val_best_acc_score: 0.7694; val_best_f1_score: 0.7839; train_kl_reg_loss: 3663.6139; train_edge_recon_loss: 283921.3125; train_gene_expr_recon_loss: 142702.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430287.0312; train_optim_loss: 430287.0312; val_kl_reg_loss: 3692.5408; val_edge_recon_loss: 290187.3438; val_gene_expr_recon_loss: 142536.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436416.1562; val_optim_loss: 436416.1562

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 8 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.8242
Val AUPRC score: 0.8079
Val best accuracy score: 0.7259
Val best F1 score: 0.7740
Val gene expr MSE score: 1.6733
Duration of model training in run 4: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 5680
Number of validation edges: 631
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7981; val_auprc_score: 0.8050; val_best_acc_score: 0.7068; val_best_f1_score: 0.7458; train_kl_reg_loss: 183.5581; train_edge_recon_loss: 345825.4219; train_gene_expr_recon_loss: 167312.5833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 513321.5625; train_optim_loss: 513321.5625; val_kl_reg_loss: 334.2367; val_edge_recon_loss: 368207.5000; val_gene_expr_recon_loss: 150161.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 518703.3125; val_optim_loss: 518703.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8543; val_auprc_score: 0.8516; val_best_acc_score: 0.7678; val_best_f1_score: 0.7717; train_kl_reg_loss: 364.1954; train_edge_recon_loss: 338759.1406; train_gene_expr_recon_loss: 153112.5182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 492235.8490; train_optim_loss: 492235.8490; val_kl_reg_loss: 493.1438; val_edge_recon_loss: 306027.3438; val_gene_expr_recon_loss: 147692.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454212.8750; val_optim_loss: 454212.8750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8218; val_auprc_score: 0.8079; val_best_acc_score: 0.7330; val_best_f1_score: 0.7699; train_kl_reg_loss: 965.8349; train_edge_recon_loss: 313721.3229; train_gene_expr_recon_loss: 148959.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463646.3802; train_optim_loss: 463646.3802; val_kl_reg_loss: 1974.1548; val_edge_recon_loss: 297979.6562; val_gene_expr_recon_loss: 144613.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444567.3750; val_optim_loss: 444567.3750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7990; val_auprc_score: 0.7826; val_best_acc_score: 0.7108; val_best_f1_score: 0.7617; train_kl_reg_loss: 3022.0892; train_edge_recon_loss: 296984.2188; train_gene_expr_recon_loss: 145591.3932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445597.7031; train_optim_loss: 445597.7031; val_kl_reg_loss: 4200.5166; val_edge_recon_loss: 303805.2812; val_gene_expr_recon_loss: 142944.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450950.0000; val_optim_loss: 450950.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8244; val_auprc_score: 0.7958; val_best_acc_score: 0.7306; val_best_f1_score: 0.7667; train_kl_reg_loss: 4485.7361; train_edge_recon_loss: 294133.0365; train_gene_expr_recon_loss: 144795.9896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443414.7708; train_optim_loss: 443414.7708; val_kl_reg_loss: 4672.3755; val_edge_recon_loss: 302569.6562; val_gene_expr_recon_loss: 141872.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449114.8750; val_optim_loss: 449114.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8437; val_auprc_score: 0.8243; val_best_acc_score: 0.7591; val_best_f1_score: 0.7716; train_kl_reg_loss: 4294.9122; train_edge_recon_loss: 292590.3281; train_gene_expr_recon_loss: 143796.0156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440681.2552; train_optim_loss: 440681.2552; val_kl_reg_loss: 3817.3401; val_edge_recon_loss: 297152.0625; val_gene_expr_recon_loss: 141187.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442156.4375; val_optim_loss: 442156.4375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8473; val_auprc_score: 0.8285; val_best_acc_score: 0.7662; val_best_f1_score: 0.7836; train_kl_reg_loss: 3456.2395; train_edge_recon_loss: 290061.0208; train_gene_expr_recon_loss: 143143.1120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436660.3750; train_optim_loss: 436660.3750; val_kl_reg_loss: 3117.4358; val_edge_recon_loss: 293256.0938; val_gene_expr_recon_loss: 140693.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437067.2812; val_optim_loss: 437067.2812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8685; val_auprc_score: 0.8415; val_best_acc_score: 0.8106; val_best_f1_score: 0.8236; train_kl_reg_loss: 3068.6003; train_edge_recon_loss: 285832.0104; train_gene_expr_recon_loss: 142533.5677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431434.1875; train_optim_loss: 431434.1875; val_kl_reg_loss: 3222.5415; val_edge_recon_loss: 286908.4062; val_gene_expr_recon_loss: 140369.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430500.6875; val_optim_loss: 430500.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8630; val_auprc_score: 0.8208; val_best_acc_score: 0.8106; val_best_f1_score: 0.8254; train_kl_reg_loss: 3390.6012; train_edge_recon_loss: 279105.5260; train_gene_expr_recon_loss: 142488.9974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424985.1094; train_optim_loss: 424985.1094; val_kl_reg_loss: 3661.8315; val_edge_recon_loss: 282410.7812; val_gene_expr_recon_loss: 140073.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426146.5938; val_optim_loss: 426146.5938
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8820; val_auprc_score: 0.8549; val_best_acc_score: 0.8162; val_best_f1_score: 0.8338; train_kl_reg_loss: 3826.8038; train_edge_recon_loss: 277313.0833; train_gene_expr_recon_loss: 142887.0417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424026.9375; train_optim_loss: 424026.9375; val_kl_reg_loss: 3808.5413; val_edge_recon_loss: 279316.3750; val_gene_expr_recon_loss: 139838.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 422963.1562; val_optim_loss: 422963.1562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9114; val_auprc_score: 0.9004; val_best_acc_score: 0.8344; val_best_f1_score: 0.8467; train_kl_reg_loss: 3822.6070; train_edge_recon_loss: 277642.7604; train_gene_expr_recon_loss: 141840.4583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423305.8229; train_optim_loss: 423305.8229; val_kl_reg_loss: 3550.2812; val_edge_recon_loss: 275717.3125; val_gene_expr_recon_loss: 139662.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 418929.8125; val_optim_loss: 418929.8125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9067; val_auprc_score: 0.8901; val_best_acc_score: 0.8391; val_best_f1_score: 0.8499; train_kl_reg_loss: 3632.9281; train_edge_recon_loss: 274601.0156; train_gene_expr_recon_loss: 141327.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419561.5156; train_optim_loss: 419561.5156; val_kl_reg_loss: 3403.9600; val_edge_recon_loss: 276056.8438; val_gene_expr_recon_loss: 139146.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 418607.7812; val_optim_loss: 418607.7812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9014; val_auprc_score: 0.8749; val_best_acc_score: 0.8312; val_best_f1_score: 0.8482; train_kl_reg_loss: 3568.8510; train_edge_recon_loss: 273192.9062; train_gene_expr_recon_loss: 142308.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419070.6146; train_optim_loss: 419070.6146; val_kl_reg_loss: 3470.3926; val_edge_recon_loss: 275030.2812; val_gene_expr_recon_loss: 139072.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417573.1250; val_optim_loss: 417573.1250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9024; val_auprc_score: 0.8750; val_best_acc_score: 0.8368; val_best_f1_score: 0.8501; train_kl_reg_loss: 3641.7153; train_edge_recon_loss: 269442.2760; train_gene_expr_recon_loss: 140145.1146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413229.1146; train_optim_loss: 413229.1146; val_kl_reg_loss: 3499.4834; val_edge_recon_loss: 278174.1562; val_gene_expr_recon_loss: 139006.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 420680.3125; val_optim_loss: 420680.3125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9254; val_auprc_score: 0.8992; val_best_acc_score: 0.8685; val_best_f1_score: 0.8795; train_kl_reg_loss: 3639.5924; train_edge_recon_loss: 271966.4896; train_gene_expr_recon_loss: 140153.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415759.4062; train_optim_loss: 415759.4062; val_kl_reg_loss: 3435.8542; val_edge_recon_loss: 268071.1562; val_gene_expr_recon_loss: 138907.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410414.9688; val_optim_loss: 410414.9688
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9252; val_auprc_score: 0.8986; val_best_acc_score: 0.8550; val_best_f1_score: 0.8662; train_kl_reg_loss: 3500.9938; train_edge_recon_loss: 268786.9583; train_gene_expr_recon_loss: 139370.3776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411658.3333; train_optim_loss: 411658.3333; val_kl_reg_loss: 3342.9517; val_edge_recon_loss: 274294.6250; val_gene_expr_recon_loss: 138353.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415990.6250; val_optim_loss: 415990.6250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9212; val_auprc_score: 0.8891; val_best_acc_score: 0.8685; val_best_f1_score: 0.8781; train_kl_reg_loss: 3448.9950; train_edge_recon_loss: 270014.0573; train_gene_expr_recon_loss: 140941.2943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414404.3542; train_optim_loss: 414404.3542; val_kl_reg_loss: 3321.3271; val_edge_recon_loss: 270401.7812; val_gene_expr_recon_loss: 138197.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411920.4062; val_optim_loss: 411920.4062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9207; val_auprc_score: 0.8807; val_best_acc_score: 0.8645; val_best_f1_score: 0.8743; train_kl_reg_loss: 3379.9708; train_edge_recon_loss: 270710.2500; train_gene_expr_recon_loss: 139969.7630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414059.9896; train_optim_loss: 414059.9896; val_kl_reg_loss: 3252.6274; val_edge_recon_loss: 273215.4688; val_gene_expr_recon_loss: 138244.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414712.6562; val_optim_loss: 414712.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9223; val_auprc_score: 0.8839; val_best_acc_score: 0.8788; val_best_f1_score: 0.8882; train_kl_reg_loss: 3350.8866; train_edge_recon_loss: 267820.5729; train_gene_expr_recon_loss: 140241.0286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411412.4948; train_optim_loss: 411412.4948; val_kl_reg_loss: 3261.0415; val_edge_recon_loss: 273747.7500; val_gene_expr_recon_loss: 138170.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415178.8438; val_optim_loss: 415178.8438
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9244; val_auprc_score: 0.8829; val_best_acc_score: 0.8780; val_best_f1_score: 0.8849; train_kl_reg_loss: 3339.7116; train_edge_recon_loss: 267053.9375; train_gene_expr_recon_loss: 140088.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410482.0521; train_optim_loss: 410482.0521; val_kl_reg_loss: 3255.1135; val_edge_recon_loss: 271016.6562; val_gene_expr_recon_loss: 137990.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412262.2500; val_optim_loss: 412262.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9288; val_auprc_score: 0.8978; val_best_acc_score: 0.8756; val_best_f1_score: 0.8827; train_kl_reg_loss: 3347.7725; train_edge_recon_loss: 268760.5156; train_gene_expr_recon_loss: 140625.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412733.7188; train_optim_loss: 412733.7188; val_kl_reg_loss: 3281.5347; val_edge_recon_loss: 269290.8750; val_gene_expr_recon_loss: 137886.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410459.1250; val_optim_loss: 410459.1250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 10 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9093
Val AUPRC score: 0.8811
Val best accuracy score: 0.8574
Val best F1 score: 0.8690
Val gene expr MSE score: 1.5108
Duration of model training in run 5: 0 hours, 0 minutes and 11 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 5680
Number of validation edges: 631
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7870; val_auprc_score: 0.8059; val_best_acc_score: 0.6918; val_best_f1_score: 0.7471; train_kl_reg_loss: 132.8510; train_edge_recon_loss: 346053.8281; train_gene_expr_recon_loss: 171193.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 517380.0938; train_optim_loss: 517380.0938; val_kl_reg_loss: 310.7894; val_edge_recon_loss: 373978.0938; val_gene_expr_recon_loss: 149609.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 523898.0938; val_optim_loss: 523898.0938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8295; val_auprc_score: 0.8294; val_best_acc_score: 0.7369; val_best_f1_score: 0.7637; train_kl_reg_loss: 363.7530; train_edge_recon_loss: 339647.1562; train_gene_expr_recon_loss: 154036.9089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494047.8073; train_optim_loss: 494047.8073; val_kl_reg_loss: 497.2986; val_edge_recon_loss: 312030.5000; val_gene_expr_recon_loss: 147674.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460202.3125; val_optim_loss: 460202.3125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8018; val_auprc_score: 0.7926; val_best_acc_score: 0.7036; val_best_f1_score: 0.7612; train_kl_reg_loss: 920.3308; train_edge_recon_loss: 315113.2917; train_gene_expr_recon_loss: 149972.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466006.5260; train_optim_loss: 466006.5260; val_kl_reg_loss: 1992.0618; val_edge_recon_loss: 308445.3125; val_gene_expr_recon_loss: 144713.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455150.8125; val_optim_loss: 455150.8125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8210; val_auprc_score: 0.8172; val_best_acc_score: 0.7345; val_best_f1_score: 0.7643; train_kl_reg_loss: 3061.1618; train_edge_recon_loss: 296991.0677; train_gene_expr_recon_loss: 147375.1536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447427.3854; train_optim_loss: 447427.3854; val_kl_reg_loss: 4563.7910; val_edge_recon_loss: 295754.2188; val_gene_expr_recon_loss: 142489.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442807.8125; val_optim_loss: 442807.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8333; val_auprc_score: 0.8337; val_best_acc_score: 0.7258; val_best_f1_score: 0.7710; train_kl_reg_loss: 4828.9394; train_edge_recon_loss: 296877.1667; train_gene_expr_recon_loss: 144963.8620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446669.9740; train_optim_loss: 446669.9740; val_kl_reg_loss: 5172.7666; val_edge_recon_loss: 298322.0312; val_gene_expr_recon_loss: 141315.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444810.6875; val_optim_loss: 444810.6875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8467; val_auprc_score: 0.8304; val_best_acc_score: 0.7552; val_best_f1_score: 0.7759; train_kl_reg_loss: 4561.4856; train_edge_recon_loss: 291076.9896; train_gene_expr_recon_loss: 144533.4974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440171.9792; train_optim_loss: 440171.9792; val_kl_reg_loss: 3972.0146; val_edge_recon_loss: 294052.2500; val_gene_expr_recon_loss: 140405.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438429.4688; val_optim_loss: 438429.4688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8466; val_auprc_score: 0.8329; val_best_acc_score: 0.7615; val_best_f1_score: 0.7757; train_kl_reg_loss: 3410.6692; train_edge_recon_loss: 290409.6615; train_gene_expr_recon_loss: 143743.6432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437563.9844; train_optim_loss: 437563.9844; val_kl_reg_loss: 3068.2856; val_edge_recon_loss: 294898.4062; val_gene_expr_recon_loss: 139998.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437964.7500; val_optim_loss: 437964.7500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8446; val_auprc_score: 0.8182; val_best_acc_score: 0.7750; val_best_f1_score: 0.7827; train_kl_reg_loss: 2899.3502; train_edge_recon_loss: 287949.5677; train_gene_expr_recon_loss: 143072.0833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433921.0052; train_optim_loss: 433921.0052; val_kl_reg_loss: 2930.6177; val_edge_recon_loss: 295774.4062; val_gene_expr_recon_loss: 139765.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438470.3438; val_optim_loss: 438470.3438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8577; val_auprc_score: 0.8389; val_best_acc_score: 0.7797; val_best_f1_score: 0.8065; train_kl_reg_loss: 3264.6184; train_edge_recon_loss: 283091.9375; train_gene_expr_recon_loss: 143194.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429550.6510; train_optim_loss: 429550.6510; val_kl_reg_loss: 3801.0259; val_edge_recon_loss: 281376.8438; val_gene_expr_recon_loss: 139505.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424683.8750; val_optim_loss: 424683.8750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8800; val_auprc_score: 0.8448; val_best_acc_score: 0.8201; val_best_f1_score: 0.8343; train_kl_reg_loss: 4064.1490; train_edge_recon_loss: 275465.1875; train_gene_expr_recon_loss: 142708.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 422237.7500; train_optim_loss: 422237.7500; val_kl_reg_loss: 4224.1504; val_edge_recon_loss: 275595.9062; val_gene_expr_recon_loss: 139208.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419028.4375; val_optim_loss: 419028.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8938; val_auprc_score: 0.8738; val_best_acc_score: 0.8288; val_best_f1_score: 0.8433; train_kl_reg_loss: 4280.6585; train_edge_recon_loss: 276570.4479; train_gene_expr_recon_loss: 141378.8021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 422229.9010; train_optim_loss: 422229.9010; val_kl_reg_loss: 3977.8367; val_edge_recon_loss: 274834.6875; val_gene_expr_recon_loss: 138808.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417621.0625; val_optim_loss: 417621.0625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8855; val_auprc_score: 0.8588; val_best_acc_score: 0.8193; val_best_f1_score: 0.8370; train_kl_reg_loss: 3920.4125; train_edge_recon_loss: 273779.5521; train_gene_expr_recon_loss: 142201.5286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419901.4948; train_optim_loss: 419901.4948; val_kl_reg_loss: 3585.4985; val_edge_recon_loss: 276513.8438; val_gene_expr_recon_loss: 138640.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 418739.9062; val_optim_loss: 418739.9062
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8851; val_auprc_score: 0.8361; val_best_acc_score: 0.8281; val_best_f1_score: 0.8399; train_kl_reg_loss: 3598.5971; train_edge_recon_loss: 272064.2760; train_gene_expr_recon_loss: 140833.3255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416496.1875; train_optim_loss: 416496.1875; val_kl_reg_loss: 3463.6943; val_edge_recon_loss: 277202.2188; val_gene_expr_recon_loss: 138387.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419053.8750; val_optim_loss: 419053.8750
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9018; val_auprc_score: 0.8700; val_best_acc_score: 0.8415; val_best_f1_score: 0.8521; train_kl_reg_loss: 3544.5879; train_edge_recon_loss: 270561.9062; train_gene_expr_recon_loss: 141366.6380; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415473.1302; train_optim_loss: 415473.1302; val_kl_reg_loss: 3435.2681; val_edge_recon_loss: 274689.5000; val_gene_expr_recon_loss: 138082.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416207.0000; val_optim_loss: 416207.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9147; val_auprc_score: 0.8910; val_best_acc_score: 0.8487; val_best_f1_score: 0.8582; train_kl_reg_loss: 3581.0219; train_edge_recon_loss: 272258.3958; train_gene_expr_recon_loss: 139972.5130; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415811.9375; train_optim_loss: 415811.9375; val_kl_reg_loss: 3470.1738; val_edge_recon_loss: 270572.5938; val_gene_expr_recon_loss: 137760.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411803.1250; val_optim_loss: 411803.1250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8977; val_auprc_score: 0.8551; val_best_acc_score: 0.8399; val_best_f1_score: 0.8502; train_kl_reg_loss: 3591.6428; train_edge_recon_loss: 272447.8594; train_gene_expr_recon_loss: 140407.0521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416446.5417; train_optim_loss: 416446.5417; val_kl_reg_loss: 3449.0779; val_edge_recon_loss: 275024.3750; val_gene_expr_recon_loss: 137878.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416351.9062; val_optim_loss: 416351.9062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9079; val_auprc_score: 0.8760; val_best_acc_score: 0.8471; val_best_f1_score: 0.8598; train_kl_reg_loss: 3500.1261; train_edge_recon_loss: 270015.1458; train_gene_expr_recon_loss: 140084.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413600.0469; train_optim_loss: 413600.0469; val_kl_reg_loss: 3334.2002; val_edge_recon_loss: 275834.6250; val_gene_expr_recon_loss: 137483.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416652.5625; val_optim_loss: 416652.5625
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9203; val_auprc_score: 0.8835; val_best_acc_score: 0.8661; val_best_f1_score: 0.8751; train_kl_reg_loss: 3444.0098; train_edge_recon_loss: 268969.4115; train_gene_expr_recon_loss: 139648.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412062.1719; train_optim_loss: 412062.1719; val_kl_reg_loss: 3314.5430; val_edge_recon_loss: 268655.5000; val_gene_expr_recon_loss: 137390.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409360.9375; val_optim_loss: 409360.9375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9238; val_auprc_score: 0.8988; val_best_acc_score: 0.8732; val_best_f1_score: 0.8801; train_kl_reg_loss: 3418.8403; train_edge_recon_loss: 266877.1406; train_gene_expr_recon_loss: 139368.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409664.3542; train_optim_loss: 409664.3542; val_kl_reg_loss: 3316.2632; val_edge_recon_loss: 270887.1875; val_gene_expr_recon_loss: 137303.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411507.2500; val_optim_loss: 411507.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9224; val_auprc_score: 0.8874; val_best_acc_score: 0.8661; val_best_f1_score: 0.8740; train_kl_reg_loss: 3446.4303; train_edge_recon_loss: 267637.3125; train_gene_expr_recon_loss: 140343.6276; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411427.3698; train_optim_loss: 411427.3698; val_kl_reg_loss: 3376.9771; val_edge_recon_loss: 271806.7188; val_gene_expr_recon_loss: 137141.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412325.6562; val_optim_loss: 412325.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9260; val_auprc_score: 0.8898; val_best_acc_score: 0.8716; val_best_f1_score: 0.8791; train_kl_reg_loss: 3457.2542; train_edge_recon_loss: 267536.0833; train_gene_expr_recon_loss: 139406.1484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410399.4844; train_optim_loss: 410399.4844; val_kl_reg_loss: 3380.3687; val_edge_recon_loss: 269357.5312; val_gene_expr_recon_loss: 136843.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409580.9062; val_optim_loss: 409580.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9151; val_auprc_score: 0.8697; val_best_acc_score: 0.8621; val_best_f1_score: 0.8718; train_kl_reg_loss: 3449.5061; train_edge_recon_loss: 264296.3177; train_gene_expr_recon_loss: 140434.6536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408180.4688; train_optim_loss: 408180.4688; val_kl_reg_loss: 3393.3193; val_edge_recon_loss: 271632.2188; val_gene_expr_recon_loss: 136778.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411803.9375; val_optim_loss: 411803.9375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9173; val_auprc_score: 0.8726; val_best_acc_score: 0.8653; val_best_f1_score: 0.8710; train_kl_reg_loss: 3441.7690; train_edge_recon_loss: 266676.7969; train_gene_expr_recon_loss: 139380.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409498.7969; train_optim_loss: 409498.7969; val_kl_reg_loss: 3370.9316; val_edge_recon_loss: 268767.6562; val_gene_expr_recon_loss: 136702.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408841.0000; val_optim_loss: 408841.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9179; val_auprc_score: 0.8696; val_best_acc_score: 0.8708; val_best_f1_score: 0.8755; train_kl_reg_loss: 3428.4929; train_edge_recon_loss: 266205.2031; train_gene_expr_recon_loss: 139881.2240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409514.9271; train_optim_loss: 409514.9271; val_kl_reg_loss: 3366.2139; val_edge_recon_loss: 272386.9375; val_gene_expr_recon_loss: 136695.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412449.0312; val_optim_loss: 412449.0312
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9358; val_auprc_score: 0.9048; val_best_acc_score: 0.8772; val_best_f1_score: 0.8860; train_kl_reg_loss: 3441.1514; train_edge_recon_loss: 264120.3594; train_gene_expr_recon_loss: 139508.0911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407069.6042; train_optim_loss: 407069.6042; val_kl_reg_loss: 3371.5261; val_edge_recon_loss: 267475.4062; val_gene_expr_recon_loss: 136700.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407547.0000; val_optim_loss: 407547.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9257; val_auprc_score: 0.8791; val_best_acc_score: 0.8772; val_best_f1_score: 0.8846; train_kl_reg_loss: 3435.7985; train_edge_recon_loss: 266323.6615; train_gene_expr_recon_loss: 139713.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409473.4375; train_optim_loss: 409473.4375; val_kl_reg_loss: 3348.7166; val_edge_recon_loss: 267409.9688; val_gene_expr_recon_loss: 136675.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407434.3125; val_optim_loss: 407434.3125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9139; val_auprc_score: 0.8700; val_best_acc_score: 0.8653; val_best_f1_score: 0.8751; train_kl_reg_loss: 3440.9281; train_edge_recon_loss: 266343.6510; train_gene_expr_recon_loss: 140939.2682; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410723.8438; train_optim_loss: 410723.8438; val_kl_reg_loss: 3330.9521; val_edge_recon_loss: 271985.5938; val_gene_expr_recon_loss: 136658.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411974.7812; val_optim_loss: 411974.7812
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9415; val_auprc_score: 0.9090; val_best_acc_score: 0.9025; val_best_f1_score: 0.9066; train_kl_reg_loss: 3436.2502; train_edge_recon_loss: 266895.6302; train_gene_expr_recon_loss: 139159.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409490.8802; train_optim_loss: 409490.8802; val_kl_reg_loss: 3336.5039; val_edge_recon_loss: 261675.3906; val_gene_expr_recon_loss: 136659.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401671.2812; val_optim_loss: 401671.2812
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9245; val_auprc_score: 0.8928; val_best_acc_score: 0.8796; val_best_f1_score: 0.8864; train_kl_reg_loss: 3435.8353; train_edge_recon_loss: 266184.8750; train_gene_expr_recon_loss: 139047.2552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408667.9688; train_optim_loss: 408667.9688; val_kl_reg_loss: 3311.8711; val_edge_recon_loss: 267635.0312; val_gene_expr_recon_loss: 136646.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407592.9375; val_optim_loss: 407592.9375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9344; val_auprc_score: 0.9068; val_best_acc_score: 0.8788; val_best_f1_score: 0.8861; train_kl_reg_loss: 3399.2572; train_edge_recon_loss: 265050.8177; train_gene_expr_recon_loss: 140060.7448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408510.8177; train_optim_loss: 408510.8177; val_kl_reg_loss: 3283.4600; val_edge_recon_loss: 267726.2188; val_gene_expr_recon_loss: 136621.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407630.8750; val_optim_loss: 407630.8750
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9169; val_auprc_score: 0.8737; val_best_acc_score: 0.8732; val_best_f1_score: 0.8808; train_kl_reg_loss: 3392.6642; train_edge_recon_loss: 264885.9531; train_gene_expr_recon_loss: 140173.8385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408452.4583; train_optim_loss: 408452.4583; val_kl_reg_loss: 3286.3179; val_edge_recon_loss: 271053.0312; val_gene_expr_recon_loss: 136612.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410951.5625; val_optim_loss: 410951.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9368; val_auprc_score: 0.8995; val_best_acc_score: 0.8891; val_best_f1_score: 0.8941; train_kl_reg_loss: 3397.6737; train_edge_recon_loss: 264536.4714; train_gene_expr_recon_loss: 139393.6849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407327.8281; train_optim_loss: 407327.8281; val_kl_reg_loss: 3281.5261; val_edge_recon_loss: 260247.8281; val_gene_expr_recon_loss: 136612.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400142.1250; val_optim_loss: 400142.1250
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9421; val_auprc_score: 0.9207; val_best_acc_score: 0.8906; val_best_f1_score: 0.8959; train_kl_reg_loss: 3400.3453; train_edge_recon_loss: 265356.6719; train_gene_expr_recon_loss: 139560.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408317.3177; train_optim_loss: 408317.3177; val_kl_reg_loss: 3274.2129; val_edge_recon_loss: 265550.5938; val_gene_expr_recon_loss: 136613.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405437.9375; val_optim_loss: 405437.9375
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9323; val_auprc_score: 0.8934; val_best_acc_score: 0.8899; val_best_f1_score: 0.8962; train_kl_reg_loss: 3392.1377; train_edge_recon_loss: 266386.5365; train_gene_expr_recon_loss: 139276.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409054.8802; train_optim_loss: 409054.8802; val_kl_reg_loss: 3285.3755; val_edge_recon_loss: 261312.9844; val_gene_expr_recon_loss: 136612.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401210.5000; val_optim_loss: 401210.5000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9393; val_auprc_score: 0.8957; val_best_acc_score: 0.8946; val_best_f1_score: 0.8993; train_kl_reg_loss: 3385.1423; train_edge_recon_loss: 264018.0938; train_gene_expr_recon_loss: 139799.9505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407203.1979; train_optim_loss: 407203.1979; val_kl_reg_loss: 3290.0818; val_edge_recon_loss: 260314.3750; val_gene_expr_recon_loss: 136612.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400216.9375; val_optim_loss: 400216.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9196; val_auprc_score: 0.8752; val_best_acc_score: 0.8803; val_best_f1_score: 0.8882; train_kl_reg_loss: 3377.4932; train_edge_recon_loss: 263641.5208; train_gene_expr_recon_loss: 139765.4974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406784.5104; train_optim_loss: 406784.5104; val_kl_reg_loss: 3295.1943; val_edge_recon_loss: 268138.4375; val_gene_expr_recon_loss: 136612.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408046.0000; val_optim_loss: 408046.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9270; val_auprc_score: 0.8922; val_best_acc_score: 0.8693; val_best_f1_score: 0.8794; train_kl_reg_loss: 3384.9930; train_edge_recon_loss: 264116.1380; train_gene_expr_recon_loss: 139030.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406531.3802; train_optim_loss: 406531.3802; val_kl_reg_loss: 3275.8916; val_edge_recon_loss: 271431.5312; val_gene_expr_recon_loss: 136611.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411319.3750; val_optim_loss: 411319.3750
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9240; val_auprc_score: 0.8897; val_best_acc_score: 0.8788; val_best_f1_score: 0.8852; train_kl_reg_loss: 3384.6351; train_edge_recon_loss: 263840.9271; train_gene_expr_recon_loss: 139040.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406265.9219; train_optim_loss: 406265.9219; val_kl_reg_loss: 3274.7522; val_edge_recon_loss: 269595.7500; val_gene_expr_recon_loss: 136611.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409481.8750; val_optim_loss: 409481.8750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 25 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
Val AUROC score: 0.9311
Val AUPRC score: 0.8879
Val best accuracy score: 0.8859
Val best F1 score: 0.8914
Val gene expr MSE score: 0.9412
Duration of model training in run 6: 0 hours, 0 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 7528
Number of validation edges: 836
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8288; val_auprc_score: 0.8321; val_best_acc_score: 0.7452; val_best_f1_score: 0.7529; train_kl_reg_loss: 305.3009; train_edge_recon_loss: 340908.5625; train_gene_expr_recon_loss: 163491.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 504705.4604; train_optim_loss: 504705.4604; val_kl_reg_loss: 705.9382; val_edge_recon_loss: 315388.1094; val_gene_expr_recon_loss: 145745.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461839.3281; val_optim_loss: 461839.3281
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8079; val_auprc_score: 0.7982; val_best_acc_score: 0.7195; val_best_f1_score: 0.7647; train_kl_reg_loss: 2631.5032; train_edge_recon_loss: 303705.5604; train_gene_expr_recon_loss: 149468.6313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455805.6937; train_optim_loss: 455805.6937; val_kl_reg_loss: 4539.5728; val_edge_recon_loss: 298959.3594; val_gene_expr_recon_loss: 142603.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446102.0938; val_optim_loss: 446102.0938
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8384; val_auprc_score: 0.8139; val_best_acc_score: 0.7476; val_best_f1_score: 0.7716; train_kl_reg_loss: 4176.5989; train_edge_recon_loss: 292966.4104; train_gene_expr_recon_loss: 146098.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443241.0750; train_optim_loss: 443241.0750; val_kl_reg_loss: 3392.7361; val_edge_recon_loss: 302367.2812; val_gene_expr_recon_loss: 140619.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446379.7188; val_optim_loss: 446379.7188
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8595; val_auprc_score: 0.8418; val_best_acc_score: 0.7811; val_best_f1_score: 0.7816; train_kl_reg_loss: 2863.0847; train_edge_recon_loss: 292586.2708; train_gene_expr_recon_loss: 145079.3302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440528.6833; train_optim_loss: 440528.6833; val_kl_reg_loss: 2760.0515; val_edge_recon_loss: 295898.9688; val_gene_expr_recon_loss: 139037.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437696.8125; val_optim_loss: 437696.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8647; val_auprc_score: 0.8461; val_best_acc_score: 0.7925; val_best_f1_score: 0.8057; train_kl_reg_loss: 2906.5484; train_edge_recon_loss: 288445.9250; train_gene_expr_recon_loss: 144184.1583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 435536.6354; train_optim_loss: 435536.6354; val_kl_reg_loss: 3195.4099; val_edge_recon_loss: 282074.3906; val_gene_expr_recon_loss: 137730.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423000.2188; val_optim_loss: 423000.2188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8797; val_auprc_score: 0.8411; val_best_acc_score: 0.8194; val_best_f1_score: 0.8390; train_kl_reg_loss: 3835.4197; train_edge_recon_loss: 278858.1375; train_gene_expr_recon_loss: 143645.9875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426339.5438; train_optim_loss: 426339.5438; val_kl_reg_loss: 4002.5806; val_edge_recon_loss: 279973.2969; val_gene_expr_recon_loss: 136601.1680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 420577.0469; val_optim_loss: 420577.0469
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9132; val_auprc_score: 0.8777; val_best_acc_score: 0.8618; val_best_f1_score: 0.8726; train_kl_reg_loss: 3584.3278; train_edge_recon_loss: 273568.7104; train_gene_expr_recon_loss: 142659.8646; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419812.9042; train_optim_loss: 419812.9042; val_kl_reg_loss: 3379.0613; val_edge_recon_loss: 268133.1875; val_gene_expr_recon_loss: 139114.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410626.7812; val_optim_loss: 410626.7812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9115; val_auprc_score: 0.8746; val_best_acc_score: 0.8618; val_best_f1_score: 0.8748; train_kl_reg_loss: 3491.3080; train_edge_recon_loss: 271818.6875; train_gene_expr_recon_loss: 142274.0292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417584.0292; train_optim_loss: 417584.0292; val_kl_reg_loss: 3527.9723; val_edge_recon_loss: 272717.8750; val_gene_expr_recon_loss: 135331.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411577.8438; val_optim_loss: 411577.8438
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9130; val_auprc_score: 0.8777; val_best_acc_score: 0.8553; val_best_f1_score: 0.8677; train_kl_reg_loss: 3433.7840; train_edge_recon_loss: 271166.5000; train_gene_expr_recon_loss: 141668.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416268.6583; train_optim_loss: 416268.6583; val_kl_reg_loss: 3387.7672; val_edge_recon_loss: 269522.0625; val_gene_expr_recon_loss: 138766.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411675.8906; val_optim_loss: 411675.8906
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9268; val_auprc_score: 0.8941; val_best_acc_score: 0.8732; val_best_f1_score: 0.8828; train_kl_reg_loss: 3431.6329; train_edge_recon_loss: 267713.4406; train_gene_expr_recon_loss: 141331.4516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412476.5229; train_optim_loss: 412476.5229; val_kl_reg_loss: 3511.3464; val_edge_recon_loss: 267594.2969; val_gene_expr_recon_loss: 136912.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408017.9844; val_optim_loss: 408017.9844
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9143; val_auprc_score: 0.8784; val_best_acc_score: 0.8630; val_best_f1_score: 0.8757; train_kl_reg_loss: 3497.8779; train_edge_recon_loss: 266900.4052; train_gene_expr_recon_loss: 141327.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411726.1188; train_optim_loss: 411726.1188; val_kl_reg_loss: 3492.7260; val_edge_recon_loss: 272638.3438; val_gene_expr_recon_loss: 136269.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412400.7812; val_optim_loss: 412400.7812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9420; val_auprc_score: 0.9166; val_best_acc_score: 0.8977; val_best_f1_score: 0.9022; train_kl_reg_loss: 3439.6967; train_edge_recon_loss: 266012.5792; train_gene_expr_recon_loss: 140879.8307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410332.1104; train_optim_loss: 410332.1104; val_kl_reg_loss: 3325.9741; val_edge_recon_loss: 262534.3047; val_gene_expr_recon_loss: 137243.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403104.1719; val_optim_loss: 403104.1719
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9444; val_auprc_score: 0.9145; val_best_acc_score: 0.9007; val_best_f1_score: 0.9068; train_kl_reg_loss: 3335.0555; train_edge_recon_loss: 266154.7906; train_gene_expr_recon_loss: 140964.9885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410454.8292; train_optim_loss: 410454.8292; val_kl_reg_loss: 3363.5679; val_edge_recon_loss: 261140.9609; val_gene_expr_recon_loss: 136679.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401183.8594; val_optim_loss: 401183.8594
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9398; val_auprc_score: 0.9174; val_best_acc_score: 0.8923; val_best_f1_score: 0.9003; train_kl_reg_loss: 3479.6682; train_edge_recon_loss: 265290.0490; train_gene_expr_recon_loss: 140410.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409180.1500; train_optim_loss: 409180.1500; val_kl_reg_loss: 3485.1978; val_edge_recon_loss: 261630.6875; val_gene_expr_recon_loss: 134992.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400108.1875; val_optim_loss: 400108.1875
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9392; val_auprc_score: 0.9034; val_best_acc_score: 0.8977; val_best_f1_score: 0.9036; train_kl_reg_loss: 3378.8601; train_edge_recon_loss: 265323.8333; train_gene_expr_recon_loss: 140135.0021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408837.6979; train_optim_loss: 408837.6979; val_kl_reg_loss: 3362.8503; val_edge_recon_loss: 264687.6406; val_gene_expr_recon_loss: 135288.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403339.4062; val_optim_loss: 403339.4062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9383; val_auprc_score: 0.9125; val_best_acc_score: 0.8882; val_best_f1_score: 0.8959; train_kl_reg_loss: 3398.0327; train_edge_recon_loss: 265659.6500; train_gene_expr_recon_loss: 139942.4302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409000.1083; train_optim_loss: 409000.1083; val_kl_reg_loss: 3375.1279; val_edge_recon_loss: 268025.4844; val_gene_expr_recon_loss: 134409.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405809.6719; val_optim_loss: 405809.6719
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9471; val_auprc_score: 0.9194; val_best_acc_score: 0.8983; val_best_f1_score: 0.9052; train_kl_reg_loss: 3431.3625; train_edge_recon_loss: 262983.3698; train_gene_expr_recon_loss: 139927.2255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406341.9583; train_optim_loss: 406341.9583; val_kl_reg_loss: 3416.8835; val_edge_recon_loss: 264915.5859; val_gene_expr_recon_loss: 134489.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402822.3750; val_optim_loss: 402822.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9518; val_auprc_score: 0.9292; val_best_acc_score: 0.9079; val_best_f1_score: 0.9111; train_kl_reg_loss: 3430.5254; train_edge_recon_loss: 263703.0094; train_gene_expr_recon_loss: 138589.8427; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405723.3771; train_optim_loss: 405723.3771; val_kl_reg_loss: 3401.0387; val_edge_recon_loss: 261795.8125; val_gene_expr_recon_loss: 134210.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399407.2969; val_optim_loss: 399407.2969
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9548; val_auprc_score: 0.9345; val_best_acc_score: 0.9133; val_best_f1_score: 0.9160; train_kl_reg_loss: 3420.5837; train_edge_recon_loss: 264355.1500; train_gene_expr_recon_loss: 138096.2193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405871.9542; train_optim_loss: 405871.9542; val_kl_reg_loss: 3394.3386; val_edge_recon_loss: 262339.4219; val_gene_expr_recon_loss: 132878.8633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398612.6250; val_optim_loss: 398612.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9494; val_auprc_score: 0.9161; val_best_acc_score: 0.9109; val_best_f1_score: 0.9158; train_kl_reg_loss: 3402.0588; train_edge_recon_loss: 264407.8823; train_gene_expr_recon_loss: 137870.7156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405680.6583; train_optim_loss: 405680.6583; val_kl_reg_loss: 3370.7408; val_edge_recon_loss: 261089.1797; val_gene_expr_recon_loss: 133050.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397510.0156; val_optim_loss: 397510.0156
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9447; val_auprc_score: 0.9166; val_best_acc_score: 0.8965; val_best_f1_score: 0.9021; train_kl_reg_loss: 3398.6388; train_edge_recon_loss: 262527.0135; train_gene_expr_recon_loss: 138146.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404072.0896; train_optim_loss: 404072.0896; val_kl_reg_loss: 3386.1970; val_edge_recon_loss: 266737.8750; val_gene_expr_recon_loss: 134716.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404840.9844; val_optim_loss: 404840.9844
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9468; val_auprc_score: 0.9215; val_best_acc_score: 0.8953; val_best_f1_score: 0.9029; train_kl_reg_loss: 3399.4903; train_edge_recon_loss: 263027.9323; train_gene_expr_recon_loss: 137947.5635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404374.9875; train_optim_loss: 404374.9875; val_kl_reg_loss: 3374.1925; val_edge_recon_loss: 263598.4375; val_gene_expr_recon_loss: 136369.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403341.8125; val_optim_loss: 403341.8125
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9480; val_auprc_score: 0.9230; val_best_acc_score: 0.9019; val_best_f1_score: 0.9089; train_kl_reg_loss: 3394.6392; train_edge_recon_loss: 264221.8115; train_gene_expr_recon_loss: 137891.5443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405507.9938; train_optim_loss: 405507.9938; val_kl_reg_loss: 3366.0000; val_edge_recon_loss: 262528.3750; val_gene_expr_recon_loss: 133528.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399422.5312; val_optim_loss: 399422.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9450; val_auprc_score: 0.9174; val_best_acc_score: 0.8977; val_best_f1_score: 0.9052; train_kl_reg_loss: 3383.2667; train_edge_recon_loss: 264366.3656; train_gene_expr_recon_loss: 137562.5729; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405312.2083; train_optim_loss: 405312.2083; val_kl_reg_loss: 3365.5743; val_edge_recon_loss: 266880.9219; val_gene_expr_recon_loss: 133692.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403939.1719; val_optim_loss: 403939.1719
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9509; val_auprc_score: 0.9186; val_best_acc_score: 0.9157; val_best_f1_score: 0.9196; train_kl_reg_loss: 3382.7569; train_edge_recon_loss: 263101.0156; train_gene_expr_recon_loss: 137816.6974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404300.4792; train_optim_loss: 404300.4792; val_kl_reg_loss: 3350.4969; val_edge_recon_loss: 260336.9062; val_gene_expr_recon_loss: 133591.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397278.6406; val_optim_loss: 397278.6406
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9548; val_auprc_score: 0.9279; val_best_acc_score: 0.9091; val_best_f1_score: 0.9132; train_kl_reg_loss: 3384.0241; train_edge_recon_loss: 264426.1281; train_gene_expr_recon_loss: 137735.1286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405545.2854; train_optim_loss: 405545.2854; val_kl_reg_loss: 3255.4670; val_edge_recon_loss: 262206.7109; val_gene_expr_recon_loss: 136186.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401648.2188; val_optim_loss: 401648.2188
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9526; val_auprc_score: 0.9372; val_best_acc_score: 0.9019; val_best_f1_score: 0.9077; train_kl_reg_loss: 3380.4974; train_edge_recon_loss: 264866.7219; train_gene_expr_recon_loss: 137501.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405748.7146; train_optim_loss: 405748.7146; val_kl_reg_loss: 3248.0679; val_edge_recon_loss: 267488.1797; val_gene_expr_recon_loss: 134055.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404792.1562; val_optim_loss: 404792.1562
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9413; val_auprc_score: 0.9117; val_best_acc_score: 0.8941; val_best_f1_score: 0.9019; train_kl_reg_loss: 3373.5097; train_edge_recon_loss: 263374.5333; train_gene_expr_recon_loss: 137737.2411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404485.2833; train_optim_loss: 404485.2833; val_kl_reg_loss: 3255.4364; val_edge_recon_loss: 264606.4688; val_gene_expr_recon_loss: 134009.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401871.4375; val_optim_loss: 401871.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9456; val_auprc_score: 0.9222; val_best_acc_score: 0.9013; val_best_f1_score: 0.9078; train_kl_reg_loss: 3372.9145; train_edge_recon_loss: 264605.5979; train_gene_expr_recon_loss: 138104.8786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406083.3937; train_optim_loss: 406083.3937; val_kl_reg_loss: 3251.8795; val_edge_recon_loss: 264416.1406; val_gene_expr_recon_loss: 133841.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401509.6250; val_optim_loss: 401509.6250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9534; val_auprc_score: 0.9270; val_best_acc_score: 0.9121; val_best_f1_score: 0.9170; train_kl_reg_loss: 3370.7319; train_edge_recon_loss: 265738.8104; train_gene_expr_recon_loss: 137670.1063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406779.6521; train_optim_loss: 406779.6521; val_kl_reg_loss: 3233.3850; val_edge_recon_loss: 262515.3281; val_gene_expr_recon_loss: 132042.3320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397791.0469; val_optim_loss: 397791.0469
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9405; val_auprc_score: 0.9014; val_best_acc_score: 0.8971; val_best_f1_score: 0.9042; train_kl_reg_loss: 3370.6546; train_edge_recon_loss: 264298.0771; train_gene_expr_recon_loss: 137571.0844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405239.8083; train_optim_loss: 405239.8083; val_kl_reg_loss: 3251.5933; val_edge_recon_loss: 263064.9141; val_gene_expr_recon_loss: 134866.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401182.7656; val_optim_loss: 401182.7656

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 29 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9483
Val AUPRC score: 0.9200
Val best accuracy score: 0.9049
Val best F1 score: 0.9108
Val gene expr MSE score: 0.8003
Duration of model training in run 7: 0 hours, 0 minutes and 31 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 7528
Number of validation edges: 836
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8473; val_auprc_score: 0.8480; val_best_acc_score: 0.7440; val_best_f1_score: 0.7586; train_kl_reg_loss: 270.2103; train_edge_recon_loss: 341122.4250; train_gene_expr_recon_loss: 159972.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 501364.7750; train_optim_loss: 501364.7750; val_kl_reg_loss: 743.7657; val_edge_recon_loss: 314255.1562; val_gene_expr_recon_loss: 148908.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463907.0625; val_optim_loss: 463907.0625
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8268; val_auprc_score: 0.8050; val_best_acc_score: 0.7327; val_best_f1_score: 0.7765; train_kl_reg_loss: 2481.8039; train_edge_recon_loss: 305113.1833; train_gene_expr_recon_loss: 146642.9271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454237.9125; train_optim_loss: 454237.9125; val_kl_reg_loss: 4223.5122; val_edge_recon_loss: 298878.3750; val_gene_expr_recon_loss: 143601.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446702.9375; val_optim_loss: 446702.9375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8736; val_auprc_score: 0.8501; val_best_acc_score: 0.7763; val_best_f1_score: 0.7887; train_kl_reg_loss: 4134.3164; train_edge_recon_loss: 297061.0104; train_gene_expr_recon_loss: 144024.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445219.5083; train_optim_loss: 445219.5083; val_kl_reg_loss: 3207.8901; val_edge_recon_loss: 290753.5469; val_gene_expr_recon_loss: 140190.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434151.7031; val_optim_loss: 434151.7031
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8753; val_auprc_score: 0.8479; val_best_acc_score: 0.8092; val_best_f1_score: 0.8056; train_kl_reg_loss: 2996.8193; train_edge_recon_loss: 293242.1333; train_gene_expr_recon_loss: 142623.5698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438862.5229; train_optim_loss: 438862.5229; val_kl_reg_loss: 2854.3412; val_edge_recon_loss: 290015.6250; val_gene_expr_recon_loss: 137690.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430560.1094; val_optim_loss: 430560.1094
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8762; val_auprc_score: 0.8554; val_best_acc_score: 0.8140; val_best_f1_score: 0.8240; train_kl_reg_loss: 3146.0164; train_edge_recon_loss: 286003.1875; train_gene_expr_recon_loss: 141959.9036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431109.1063; train_optim_loss: 431109.1063; val_kl_reg_loss: 3411.3375; val_edge_recon_loss: 285593.9844; val_gene_expr_recon_loss: 141014.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430019.7969; val_optim_loss: 430019.7969
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8940; val_auprc_score: 0.8521; val_best_acc_score: 0.8469; val_best_f1_score: 0.8599; train_kl_reg_loss: 3789.1193; train_edge_recon_loss: 275106.5229; train_gene_expr_recon_loss: 141928.4010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420824.0417; train_optim_loss: 420824.0417; val_kl_reg_loss: 3811.3781; val_edge_recon_loss: 275852.1094; val_gene_expr_recon_loss: 139124.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 418788.0156; val_optim_loss: 418788.0156
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9165; val_auprc_score: 0.8756; val_best_acc_score: 0.8594; val_best_f1_score: 0.8655; train_kl_reg_loss: 3655.6810; train_edge_recon_loss: 274837.2979; train_gene_expr_recon_loss: 140797.6922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419290.6708; train_optim_loss: 419290.6708; val_kl_reg_loss: 3432.7422; val_edge_recon_loss: 268081.0156; val_gene_expr_recon_loss: 138883.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410396.8281; val_optim_loss: 410396.8281
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9040; val_auprc_score: 0.8529; val_best_acc_score: 0.8517; val_best_f1_score: 0.8655; train_kl_reg_loss: 3408.3875; train_edge_recon_loss: 272580.7500; train_gene_expr_recon_loss: 140177.1859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416166.3229; train_optim_loss: 416166.3229; val_kl_reg_loss: 3316.4930; val_edge_recon_loss: 273119.5469; val_gene_expr_recon_loss: 138000.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414436.4219; val_optim_loss: 414436.4219
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9004; val_auprc_score: 0.8533; val_best_acc_score: 0.8523; val_best_f1_score: 0.8658; train_kl_reg_loss: 3420.4608; train_edge_recon_loss: 271611.4667; train_gene_expr_recon_loss: 139674.4125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414706.3417; train_optim_loss: 414706.3417; val_kl_reg_loss: 3431.1572; val_edge_recon_loss: 270919.9375; val_gene_expr_recon_loss: 137355.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411706.6250; val_optim_loss: 411706.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9032; val_auprc_score: 0.8543; val_best_acc_score: 0.8511; val_best_f1_score: 0.8665; train_kl_reg_loss: 3513.6122; train_edge_recon_loss: 269583.0500; train_gene_expr_recon_loss: 139609.1953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412705.8604; train_optim_loss: 412705.8604; val_kl_reg_loss: 3490.7482; val_edge_recon_loss: 271979.4531; val_gene_expr_recon_loss: 137097.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412567.6562; val_optim_loss: 412567.6562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8903; val_auprc_score: 0.8388; val_best_acc_score: 0.8421; val_best_f1_score: 0.8582; train_kl_reg_loss: 3498.2664; train_edge_recon_loss: 270683.3167; train_gene_expr_recon_loss: 138672.8349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412854.4104; train_optim_loss: 412854.4104; val_kl_reg_loss: 3463.4893; val_edge_recon_loss: 275720.1406; val_gene_expr_recon_loss: 136785.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415969.0156; val_optim_loss: 415969.0156
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9173; val_auprc_score: 0.8762; val_best_acc_score: 0.8696; val_best_f1_score: 0.8807; train_kl_reg_loss: 3451.7489; train_edge_recon_loss: 269271.5500; train_gene_expr_recon_loss: 138257.0125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410980.3083; train_optim_loss: 410980.3083; val_kl_reg_loss: 3409.0012; val_edge_recon_loss: 266349.5312; val_gene_expr_recon_loss: 138457.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408216.2969; val_optim_loss: 408216.2969
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9112; val_auprc_score: 0.8782; val_best_acc_score: 0.8559; val_best_f1_score: 0.8656; train_kl_reg_loss: 3432.6699; train_edge_recon_loss: 268323.7958; train_gene_expr_recon_loss: 137894.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409650.6146; train_optim_loss: 409650.6146; val_kl_reg_loss: 3395.7046; val_edge_recon_loss: 270892.5938; val_gene_expr_recon_loss: 136126.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410414.5000; val_optim_loss: 410414.5000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9166; val_auprc_score: 0.8708; val_best_acc_score: 0.8565; val_best_f1_score: 0.8697; train_kl_reg_loss: 3417.4782; train_edge_recon_loss: 269131.1854; train_gene_expr_recon_loss: 137956.2620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410504.9229; train_optim_loss: 410504.9229; val_kl_reg_loss: 3416.9333; val_edge_recon_loss: 269893.8594; val_gene_expr_recon_loss: 136140.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409451.6250; val_optim_loss: 409451.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9095; val_auprc_score: 0.8606; val_best_acc_score: 0.8517; val_best_f1_score: 0.8664; train_kl_reg_loss: 3420.7690; train_edge_recon_loss: 267467.1490; train_gene_expr_recon_loss: 137527.7286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408415.6479; train_optim_loss: 408415.6479; val_kl_reg_loss: 3440.2268; val_edge_recon_loss: 269728.9219; val_gene_expr_recon_loss: 135990.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409159.6406; val_optim_loss: 409159.6406

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9224; val_auprc_score: 0.8988; val_best_acc_score: 0.8600; val_best_f1_score: 0.8722; train_kl_reg_loss: 3437.2828; train_edge_recon_loss: 267465.4396; train_gene_expr_recon_loss: 137724.0786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408626.7979; train_optim_loss: 408626.7979; val_kl_reg_loss: 3435.0920; val_edge_recon_loss: 268165.0000; val_gene_expr_recon_loss: 135654.2930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407254.3906; val_optim_loss: 407254.3906
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9203; val_auprc_score: 0.8769; val_best_acc_score: 0.8648; val_best_f1_score: 0.8751; train_kl_reg_loss: 3434.1280; train_edge_recon_loss: 267856.2094; train_gene_expr_recon_loss: 137796.1193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409086.4604; train_optim_loss: 409086.4604; val_kl_reg_loss: 3411.6168; val_edge_recon_loss: 267473.5469; val_gene_expr_recon_loss: 136778.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407663.6250; val_optim_loss: 407663.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9166; val_auprc_score: 0.8873; val_best_acc_score: 0.8565; val_best_f1_score: 0.8698; train_kl_reg_loss: 3439.7138; train_edge_recon_loss: 266425.4719; train_gene_expr_recon_loss: 137834.8896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407700.0771; train_optim_loss: 407700.0771; val_kl_reg_loss: 3431.6299; val_edge_recon_loss: 268313.3906; val_gene_expr_recon_loss: 134081.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405826.4375; val_optim_loss: 405826.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9183; val_auprc_score: 0.8774; val_best_acc_score: 0.8762; val_best_f1_score: 0.8862; train_kl_reg_loss: 3437.6052; train_edge_recon_loss: 267835.9740; train_gene_expr_recon_loss: 137671.3495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408944.9271; train_optim_loss: 408944.9271; val_kl_reg_loss: 3438.1953; val_edge_recon_loss: 261743.8438; val_gene_expr_recon_loss: 138050.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403232.0469; val_optim_loss: 403232.0469
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9158; val_auprc_score: 0.8843; val_best_acc_score: 0.8583; val_best_f1_score: 0.8713; train_kl_reg_loss: 3440.1800; train_edge_recon_loss: 266646.3292; train_gene_expr_recon_loss: 137440.4203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407526.9313; train_optim_loss: 407526.9313; val_kl_reg_loss: 3415.1381; val_edge_recon_loss: 271026.4531; val_gene_expr_recon_loss: 138282.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412724.1094; val_optim_loss: 412724.1094
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9319; val_auprc_score: 0.9065; val_best_acc_score: 0.8666; val_best_f1_score: 0.8774; train_kl_reg_loss: 3440.6121; train_edge_recon_loss: 267813.9042; train_gene_expr_recon_loss: 137628.8141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408883.3354; train_optim_loss: 408883.3354; val_kl_reg_loss: 3437.5779; val_edge_recon_loss: 266512.7891; val_gene_expr_recon_loss: 135998.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405949.0312; val_optim_loss: 405949.0312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9066; val_auprc_score: 0.8821; val_best_acc_score: 0.8499; val_best_f1_score: 0.8648; train_kl_reg_loss: 3439.4549; train_edge_recon_loss: 267437.4250; train_gene_expr_recon_loss: 137971.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408848.1562; train_optim_loss: 408848.1562; val_kl_reg_loss: 3428.2441; val_edge_recon_loss: 271805.7188; val_gene_expr_recon_loss: 137410.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412644.0469; val_optim_loss: 412644.0469

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8985; val_auprc_score: 0.8490; val_best_acc_score: 0.8391; val_best_f1_score: 0.8564; train_kl_reg_loss: 3437.6337; train_edge_recon_loss: 266942.7260; train_gene_expr_recon_loss: 137544.4547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407924.8208; train_optim_loss: 407924.8208; val_kl_reg_loss: 3406.5669; val_edge_recon_loss: 274430.1875; val_gene_expr_recon_loss: 136798.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414634.9219; val_optim_loss: 414634.9219
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9119; val_auprc_score: 0.8646; val_best_acc_score: 0.8565; val_best_f1_score: 0.8682; train_kl_reg_loss: 3447.1801; train_edge_recon_loss: 267218.8823; train_gene_expr_recon_loss: 137577.0432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408243.1000; train_optim_loss: 408243.1000; val_kl_reg_loss: 3421.1587; val_edge_recon_loss: 271425.8281; val_gene_expr_recon_loss: 138367.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413214.0156; val_optim_loss: 413214.0156
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9132; val_auprc_score: 0.8720; val_best_acc_score: 0.8636; val_best_f1_score: 0.8749; train_kl_reg_loss: 3441.1376; train_edge_recon_loss: 267171.3688; train_gene_expr_recon_loss: 137379.5057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407992.0167; train_optim_loss: 407992.0167; val_kl_reg_loss: 3428.3599; val_edge_recon_loss: 268850.1406; val_gene_expr_recon_loss: 139009.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411288.1875; val_optim_loss: 411288.1875

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 18 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9097
Val AUPRC score: 0.8620
Val best accuracy score: 0.8648
Val best F1 score: 0.8769
Val gene expr MSE score: 1.0516
Duration of model training in run 8: 0 hours, 0 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 9397
Number of validation edges: 1044
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8349; val_auprc_score: 0.8132; val_best_acc_score: 0.7399; val_best_f1_score: 0.7746; train_kl_reg_loss: 1585.2705; train_edge_recon_loss: 320102.4003; train_gene_expr_recon_loss: 152467.5747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474155.2475; train_optim_loss: 474155.2475; val_kl_reg_loss: 4043.7153; val_edge_recon_loss: 290923.8688; val_gene_expr_recon_loss: 148548.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443515.6250; val_optim_loss: 443515.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8603; val_auprc_score: 0.8333; val_best_acc_score: 0.7965; val_best_f1_score: 0.8076; train_kl_reg_loss: 3192.1322; train_edge_recon_loss: 293045.9257; train_gene_expr_recon_loss: 144552.7684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 440790.8277; train_optim_loss: 440790.8277; val_kl_reg_loss: 2995.9786; val_edge_recon_loss: 305696.4000; val_gene_expr_recon_loss: 149018.3031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457710.6813; val_optim_loss: 457710.6813
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8952; val_auprc_score: 0.8572; val_best_acc_score: 0.8443; val_best_f1_score: 0.8566; train_kl_reg_loss: 3137.1031; train_edge_recon_loss: 283757.4206; train_gene_expr_recon_loss: 143085.2679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429979.7880; train_optim_loss: 429979.7880; val_kl_reg_loss: 3426.7952; val_edge_recon_loss: 273533.5812; val_gene_expr_recon_loss: 149269.0438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426229.4313; val_optim_loss: 426229.4313
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9025; val_auprc_score: 0.8703; val_best_acc_score: 0.8348; val_best_f1_score: 0.8467; train_kl_reg_loss: 3433.0163; train_edge_recon_loss: 274650.8691; train_gene_expr_recon_loss: 141643.7665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419727.6546; train_optim_loss: 419727.6546; val_kl_reg_loss: 2996.7043; val_edge_recon_loss: 271251.5938; val_gene_expr_recon_loss: 145166.0281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419414.3125; val_optim_loss: 419414.3125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9160; val_auprc_score: 0.8739; val_best_acc_score: 0.8611; val_best_f1_score: 0.8726; train_kl_reg_loss: 3321.8873; train_edge_recon_loss: 270906.2390; train_gene_expr_recon_loss: 140654.1117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414882.2365; train_optim_loss: 414882.2365; val_kl_reg_loss: 3183.9940; val_edge_recon_loss: 269665.7313; val_gene_expr_recon_loss: 146597.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419447.1188; val_optim_loss: 419447.1188
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9284; val_auprc_score: 0.8854; val_best_acc_score: 0.8898; val_best_f1_score: 0.8963; train_kl_reg_loss: 3307.3939; train_edge_recon_loss: 268795.7242; train_gene_expr_recon_loss: 140671.9179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412775.0380; train_optim_loss: 412775.0380; val_kl_reg_loss: 3269.4304; val_edge_recon_loss: 271875.4313; val_gene_expr_recon_loss: 148331.2750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423476.1437; val_optim_loss: 423476.1437
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9411; val_auprc_score: 0.9165; val_best_acc_score: 0.8951; val_best_f1_score: 0.8996; train_kl_reg_loss: 3379.8181; train_edge_recon_loss: 266452.5992; train_gene_expr_recon_loss: 139413.0604; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409245.4747; train_optim_loss: 409245.4747; val_kl_reg_loss: 3381.2261; val_edge_recon_loss: 273337.3281; val_gene_expr_recon_loss: 142657.6594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419376.2062; val_optim_loss: 419376.2062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9446; val_auprc_score: 0.9243; val_best_acc_score: 0.8999; val_best_f1_score: 0.9052; train_kl_reg_loss: 3377.6834; train_edge_recon_loss: 265698.3628; train_gene_expr_recon_loss: 139254.3300; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408330.3784; train_optim_loss: 408330.3784; val_kl_reg_loss: 3238.9274; val_edge_recon_loss: 269973.7125; val_gene_expr_recon_loss: 145765.3969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 418978.0312; val_optim_loss: 418978.0312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9425; val_auprc_score: 0.9033; val_best_acc_score: 0.8989; val_best_f1_score: 0.9055; train_kl_reg_loss: 3362.6559; train_edge_recon_loss: 265333.4852; train_gene_expr_recon_loss: 138623.9966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407320.1410; train_optim_loss: 407320.1410; val_kl_reg_loss: 3189.1539; val_edge_recon_loss: 264923.8656; val_gene_expr_recon_loss: 143992.8219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412105.8500; val_optim_loss: 412105.8500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9495; val_auprc_score: 0.9198; val_best_acc_score: 0.9100; val_best_f1_score: 0.9145; train_kl_reg_loss: 3386.1706; train_edge_recon_loss: 264793.8881; train_gene_expr_recon_loss: 138235.0008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406415.0566; train_optim_loss: 406415.0566; val_kl_reg_loss: 3264.2535; val_edge_recon_loss: 267327.9688; val_gene_expr_recon_loss: 141845.0094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412437.2313; val_optim_loss: 412437.2313
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9595; val_auprc_score: 0.9410; val_best_acc_score: 0.9114; val_best_f1_score: 0.9160; train_kl_reg_loss: 3331.7943; train_edge_recon_loss: 263231.8902; train_gene_expr_recon_loss: 138210.3332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404774.0194; train_optim_loss: 404774.0194; val_kl_reg_loss: 3231.0757; val_edge_recon_loss: 260393.7281; val_gene_expr_recon_loss: 146453.3094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410078.1125; val_optim_loss: 410078.1125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9642; val_auprc_score: 0.9344; val_best_acc_score: 0.9267; val_best_f1_score: 0.9295; train_kl_reg_loss: 3359.7908; train_edge_recon_loss: 263964.0473; train_gene_expr_recon_loss: 138157.5655; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405481.4003; train_optim_loss: 405481.4003; val_kl_reg_loss: 3242.3671; val_edge_recon_loss: 264522.2188; val_gene_expr_recon_loss: 142891.6844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410656.2687; val_optim_loss: 410656.2687
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9626; val_auprc_score: 0.9385; val_best_acc_score: 0.9176; val_best_f1_score: 0.9218; train_kl_reg_loss: 3359.3701; train_edge_recon_loss: 262019.3421; train_gene_expr_recon_loss: 136632.3651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402011.0769; train_optim_loss: 402011.0769; val_kl_reg_loss: 3278.4383; val_edge_recon_loss: 261373.5063; val_gene_expr_recon_loss: 144911.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409563.7938; val_optim_loss: 409563.7938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9680; val_auprc_score: 0.9419; val_best_acc_score: 0.9215; val_best_f1_score: 0.9243; train_kl_reg_loss: 3369.1713; train_edge_recon_loss: 262822.3923; train_gene_expr_recon_loss: 136616.3786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402807.9400; train_optim_loss: 402807.9400; val_kl_reg_loss: 3304.8185; val_edge_recon_loss: 266743.3969; val_gene_expr_recon_loss: 146569.4594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416617.6688; val_optim_loss: 416617.6688
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9635; val_auprc_score: 0.9370; val_best_acc_score: 0.9315; val_best_f1_score: 0.9338; train_kl_reg_loss: 3329.4262; train_edge_recon_loss: 262659.9789; train_gene_expr_recon_loss: 136246.9793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402236.3860; train_optim_loss: 402236.3860; val_kl_reg_loss: 3229.9229; val_edge_recon_loss: 266052.5812; val_gene_expr_recon_loss: 146389.9281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415672.4250; val_optim_loss: 415672.4250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9750; val_auprc_score: 0.9577; val_best_acc_score: 0.9368; val_best_f1_score: 0.9390; train_kl_reg_loss: 3301.6257; train_edge_recon_loss: 263555.5144; train_gene_expr_recon_loss: 135579.0057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402436.1453; train_optim_loss: 402436.1453; val_kl_reg_loss: 3320.7382; val_edge_recon_loss: 260951.8406; val_gene_expr_recon_loss: 145859.0875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410131.6688; val_optim_loss: 410131.6688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9720; val_auprc_score: 0.9476; val_best_acc_score: 0.9377; val_best_f1_score: 0.9399; train_kl_reg_loss: 3358.3223; train_edge_recon_loss: 261647.1098; train_gene_expr_recon_loss: 134234.2179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399239.6495; train_optim_loss: 399239.6495; val_kl_reg_loss: 3313.5668; val_edge_recon_loss: 258855.2000; val_gene_expr_recon_loss: 142448.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404617.1562; val_optim_loss: 404617.1562
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9720; val_auprc_score: 0.9525; val_best_acc_score: 0.9416; val_best_f1_score: 0.9441; train_kl_reg_loss: 3344.6163; train_edge_recon_loss: 261523.9700; train_gene_expr_recon_loss: 133553.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398421.8699; train_optim_loss: 398421.8699; val_kl_reg_loss: 3277.6937; val_edge_recon_loss: 259991.8031; val_gene_expr_recon_loss: 145165.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408435.3937; val_optim_loss: 408435.3937
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9813; val_auprc_score: 0.9714; val_best_acc_score: 0.9444; val_best_f1_score: 0.9465; train_kl_reg_loss: 3329.6041; train_edge_recon_loss: 261859.6508; train_gene_expr_recon_loss: 133408.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398597.6850; train_optim_loss: 398597.6850; val_kl_reg_loss: 3280.1684; val_edge_recon_loss: 261829.9219; val_gene_expr_recon_loss: 143783.7406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408893.8187; val_optim_loss: 408893.8187
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9691; val_auprc_score: 0.9451; val_best_acc_score: 0.9392; val_best_f1_score: 0.9414; train_kl_reg_loss: 3346.6484; train_edge_recon_loss: 261443.8619; train_gene_expr_recon_loss: 133365.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398155.9671; train_optim_loss: 398155.9671; val_kl_reg_loss: 3305.7071; val_edge_recon_loss: 257750.0750; val_gene_expr_recon_loss: 141030.6609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402086.4500; val_optim_loss: 402086.4500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9702; val_auprc_score: 0.9425; val_best_acc_score: 0.9406; val_best_f1_score: 0.9429; train_kl_reg_loss: 3332.5539; train_edge_recon_loss: 261722.9489; train_gene_expr_recon_loss: 133271.3524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398326.8581; train_optim_loss: 398326.8581; val_kl_reg_loss: 3307.3546; val_edge_recon_loss: 260384.1437; val_gene_expr_recon_loss: 139183.6172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402875.1125; val_optim_loss: 402875.1125
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9726; val_auprc_score: 0.9501; val_best_acc_score: 0.9444; val_best_f1_score: 0.9462; train_kl_reg_loss: 3327.9322; train_edge_recon_loss: 261949.7732; train_gene_expr_recon_loss: 133328.9234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398606.6284; train_optim_loss: 398606.6284; val_kl_reg_loss: 3294.8887; val_edge_recon_loss: 263564.9875; val_gene_expr_recon_loss: 140509.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407368.8750; val_optim_loss: 407368.8750
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9708; val_auprc_score: 0.9529; val_best_acc_score: 0.9368; val_best_f1_score: 0.9398; train_kl_reg_loss: 3338.6045; train_edge_recon_loss: 260819.4523; train_gene_expr_recon_loss: 133162.0576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397320.1123; train_optim_loss: 397320.1123; val_kl_reg_loss: 3295.4631; val_edge_recon_loss: 261865.9281; val_gene_expr_recon_loss: 142031.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407193.3125; val_optim_loss: 407193.3125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9757; val_auprc_score: 0.9499; val_best_acc_score: 0.9464; val_best_f1_score: 0.9481; train_kl_reg_loss: 3345.7089; train_edge_recon_loss: 261700.3142; train_gene_expr_recon_loss: 132950.5196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397996.5439; train_optim_loss: 397996.5439; val_kl_reg_loss: 3281.1375; val_edge_recon_loss: 264974.3250; val_gene_expr_recon_loss: 140651.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408906.6937; val_optim_loss: 408906.6937
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9755; val_auprc_score: 0.9567; val_best_acc_score: 0.9425; val_best_f1_score: 0.9438; train_kl_reg_loss: 3340.6081; train_edge_recon_loss: 262271.3193; train_gene_expr_recon_loss: 133249.1052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398861.0363; train_optim_loss: 398861.0363; val_kl_reg_loss: 3283.9082; val_edge_recon_loss: 260006.8719; val_gene_expr_recon_loss: 139213.8156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402504.6000; val_optim_loss: 402504.6000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9664; val_auprc_score: 0.9403; val_best_acc_score: 0.9377; val_best_f1_score: 0.9402; train_kl_reg_loss: 3331.8501; train_edge_recon_loss: 261287.1474; train_gene_expr_recon_loss: 132893.5494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397512.5515; train_optim_loss: 397512.5515; val_kl_reg_loss: 3062.2401; val_edge_recon_loss: 261132.0312; val_gene_expr_recon_loss: 139924.1750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404118.4500; val_optim_loss: 404118.4500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 35 sec.
Using best model state, which was in epoch 20.

--- MODEL EVALUATION ---
Val AUROC score: 0.9634
Val AUPRC score: 0.9385
Val best accuracy score: 0.9339
Val best F1 score: 0.9372
Val gene expr MSE score: 0.8483
Duration of model training in run 9: 0 hours, 0 minutes and 38 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 821
Number of validation nodes: 91
Number of training edges: 9397
Number of validation edges: 1044
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8128; val_auprc_score: 0.7825; val_best_acc_score: 0.7280; val_best_f1_score: 0.7621; train_kl_reg_loss: 1630.0320; train_edge_recon_loss: 321231.5329; train_gene_expr_recon_loss: 154472.1421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 477333.7052; train_optim_loss: 477333.7052; val_kl_reg_loss: 4614.3019; val_edge_recon_loss: 308713.1875; val_gene_expr_recon_loss: 137107.0438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450434.5312; val_optim_loss: 450434.5312
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8613; val_auprc_score: 0.8344; val_best_acc_score: 0.7864; val_best_f1_score: 0.7815; train_kl_reg_loss: 3226.9418; train_edge_recon_loss: 293093.3353; train_gene_expr_recon_loss: 145927.3704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442247.6461; train_optim_loss: 442247.6461; val_kl_reg_loss: 2761.9839; val_edge_recon_loss: 291593.3063; val_gene_expr_recon_loss: 137683.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432038.4562; val_optim_loss: 432038.4562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8957; val_auprc_score: 0.8506; val_best_acc_score: 0.8448; val_best_f1_score: 0.8547; train_kl_reg_loss: 3095.5082; train_edge_recon_loss: 281371.3454; train_gene_expr_recon_loss: 144321.2350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 428788.0887; train_optim_loss: 428788.0887; val_kl_reg_loss: 3675.5123; val_edge_recon_loss: 267840.8406; val_gene_expr_recon_loss: 140815.5344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412331.8750; val_optim_loss: 412331.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9027; val_auprc_score: 0.8608; val_best_acc_score: 0.8525; val_best_f1_score: 0.8634; train_kl_reg_loss: 3577.9485; train_edge_recon_loss: 271767.9654; train_gene_expr_recon_loss: 143360.5834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418706.4958; train_optim_loss: 418706.4958; val_kl_reg_loss: 3462.2534; val_edge_recon_loss: 277872.4625; val_gene_expr_recon_loss: 138196.1969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419530.9125; val_optim_loss: 419530.9125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9028; val_auprc_score: 0.8571; val_best_acc_score: 0.8530; val_best_f1_score: 0.8632; train_kl_reg_loss: 3347.6491; train_edge_recon_loss: 271112.1170; train_gene_expr_recon_loss: 142135.7551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416595.5186; train_optim_loss: 416595.5186; val_kl_reg_loss: 3419.2536; val_edge_recon_loss: 271456.8625; val_gene_expr_recon_loss: 136735.3875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411611.5062; val_optim_loss: 411611.5062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9253; val_auprc_score: 0.8883; val_best_acc_score: 0.8726; val_best_f1_score: 0.8821; train_kl_reg_loss: 3277.3205; train_edge_recon_loss: 269900.6508; train_gene_expr_recon_loss: 141360.3951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414538.3666; train_optim_loss: 414538.3666; val_kl_reg_loss: 3277.3571; val_edge_recon_loss: 271779.4938; val_gene_expr_recon_loss: 138194.2094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413251.0687; val_optim_loss: 413251.0687
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9479; val_auprc_score: 0.9254; val_best_acc_score: 0.8989; val_best_f1_score: 0.9023; train_kl_reg_loss: 3417.1178; train_edge_recon_loss: 266178.0773; train_gene_expr_recon_loss: 140633.5990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410228.7948; train_optim_loss: 410228.7948; val_kl_reg_loss: 3229.5391; val_edge_recon_loss: 262573.8563; val_gene_expr_recon_loss: 136494.5125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402297.9062; val_optim_loss: 402297.9062
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9411; val_auprc_score: 0.9056; val_best_acc_score: 0.8994; val_best_f1_score: 0.9059; train_kl_reg_loss: 3358.9561; train_edge_recon_loss: 265845.4793; train_gene_expr_recon_loss: 140502.4472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409706.8809; train_optim_loss: 409706.8809; val_kl_reg_loss: 3279.7618; val_edge_recon_loss: 267504.3187; val_gene_expr_recon_loss: 136013.8109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406797.8937; val_optim_loss: 406797.8937
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9504; val_auprc_score: 0.9167; val_best_acc_score: 0.9109; val_best_f1_score: 0.9160; train_kl_reg_loss: 3346.9682; train_edge_recon_loss: 265000.5891; train_gene_expr_recon_loss: 139620.5857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407968.1436; train_optim_loss: 407968.1436; val_kl_reg_loss: 3340.5046; val_edge_recon_loss: 265708.0406; val_gene_expr_recon_loss: 136604.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405652.8375; val_optim_loss: 405652.8375
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9563; val_auprc_score: 0.9307; val_best_acc_score: 0.9090; val_best_f1_score: 0.9134; train_kl_reg_loss: 3336.8049; train_edge_recon_loss: 264567.9033; train_gene_expr_recon_loss: 139850.9166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407755.6225; train_optim_loss: 407755.6225; val_kl_reg_loss: 3359.7555; val_edge_recon_loss: 274419.5062; val_gene_expr_recon_loss: 133814.7563; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411594.0187; val_optim_loss: 411594.0187

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9560; val_auprc_score: 0.9213; val_best_acc_score: 0.9186; val_best_f1_score: 0.9229; train_kl_reg_loss: 3338.9239; train_edge_recon_loss: 263966.9147; train_gene_expr_recon_loss: 137354.6254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404660.4662; train_optim_loss: 404660.4662; val_kl_reg_loss: 3363.4554; val_edge_recon_loss: 259886.4312; val_gene_expr_recon_loss: 130623.5844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393873.4750; val_optim_loss: 393873.4750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9554; val_auprc_score: 0.9286; val_best_acc_score: 0.9114; val_best_f1_score: 0.9166; train_kl_reg_loss: 3353.3035; train_edge_recon_loss: 263772.7356; train_gene_expr_recon_loss: 136578.0283; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403704.0633; train_optim_loss: 403704.0633; val_kl_reg_loss: 3373.7381; val_edge_recon_loss: 263858.0344; val_gene_expr_recon_loss: 132215.5984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399447.3688; val_optim_loss: 399447.3688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9662; val_auprc_score: 0.9447; val_best_acc_score: 0.9272; val_best_f1_score: 0.9298; train_kl_reg_loss: 3375.8383; train_edge_recon_loss: 263098.8433; train_gene_expr_recon_loss: 136789.4840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403264.1647; train_optim_loss: 403264.1647; val_kl_reg_loss: 3401.4582; val_edge_recon_loss: 259495.6125; val_gene_expr_recon_loss: 131722.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394619.4938; val_optim_loss: 394619.4938
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9607; val_auprc_score: 0.9286; val_best_acc_score: 0.9152; val_best_f1_score: 0.9193; train_kl_reg_loss: 3359.4250; train_edge_recon_loss: 264035.6947; train_gene_expr_recon_loss: 136199.9111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403595.0304; train_optim_loss: 403595.0304; val_kl_reg_loss: 3344.7405; val_edge_recon_loss: 256598.0469; val_gene_expr_recon_loss: 132900.3766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 392843.1750; val_optim_loss: 392843.1750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9579; val_auprc_score: 0.9396; val_best_acc_score: 0.9138; val_best_f1_score: 0.9180; train_kl_reg_loss: 3315.8836; train_edge_recon_loss: 262651.2352; train_gene_expr_recon_loss: 136755.2466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402722.3666; train_optim_loss: 402722.3666; val_kl_reg_loss: 3349.3054; val_edge_recon_loss: 261526.9906; val_gene_expr_recon_loss: 131783.2922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396659.5875; val_optim_loss: 396659.5875
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9551; val_auprc_score: 0.9362; val_best_acc_score: 0.9162; val_best_f1_score: 0.9209; train_kl_reg_loss: 3363.0051; train_edge_recon_loss: 262648.8264; train_gene_expr_recon_loss: 136194.4979; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402206.3285; train_optim_loss: 402206.3285; val_kl_reg_loss: 3396.0580; val_edge_recon_loss: 261385.6063; val_gene_expr_recon_loss: 133357.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398138.8312; val_optim_loss: 398138.8312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9536; val_auprc_score: 0.9159; val_best_acc_score: 0.9210; val_best_f1_score: 0.9239; train_kl_reg_loss: 3369.6522; train_edge_recon_loss: 262455.5722; train_gene_expr_recon_loss: 136992.1848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402817.4088; train_optim_loss: 402817.4088; val_kl_reg_loss: 3354.6737; val_edge_recon_loss: 265972.5969; val_gene_expr_recon_loss: 132088.6359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401415.9062; val_optim_loss: 401415.9062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9596; val_auprc_score: 0.9320; val_best_acc_score: 0.9239; val_best_f1_score: 0.9270; train_kl_reg_loss: 3346.8011; train_edge_recon_loss: 262484.2462; train_gene_expr_recon_loss: 136830.7285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402661.7728; train_optim_loss: 402661.7728; val_kl_reg_loss: 3370.4856; val_edge_recon_loss: 260119.4375; val_gene_expr_recon_loss: 130876.0344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 394365.9562; val_optim_loss: 394365.9562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9634; val_auprc_score: 0.9452; val_best_acc_score: 0.9248; val_best_f1_score: 0.9268; train_kl_reg_loss: 3344.8413; train_edge_recon_loss: 262727.0435; train_gene_expr_recon_loss: 136882.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402954.2280; train_optim_loss: 402954.2280; val_kl_reg_loss: 3370.4442; val_edge_recon_loss: 262869.5250; val_gene_expr_recon_loss: 134167.3344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400407.2938; val_optim_loss: 400407.2938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9637; val_auprc_score: 0.9482; val_best_acc_score: 0.9191; val_best_f1_score: 0.9229; train_kl_reg_loss: 3349.7874; train_edge_recon_loss: 262942.1267; train_gene_expr_recon_loss: 136660.5695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402952.4814; train_optim_loss: 402952.4814; val_kl_reg_loss: 3375.4823; val_edge_recon_loss: 261531.9062; val_gene_expr_recon_loss: 133614.3687; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398521.7500; val_optim_loss: 398521.7500

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 24 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9465
Val AUPRC score: 0.9167
Val best accuracy score: 0.9028
Val best F1 score: 0.9091
Val gene expr MSE score: 1.1377
Duration of model training in run 10: 0 hours, 0 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
