Run timestamp: 16082023_143443_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'Cell_Type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'vizgen_merfish_mouse_liver_subsample_25pct', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 347, n_cat_covariates_embed_input: 0, n_hidden: 347, n_latent: 1378, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1378, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 347

--- INITIALIZING TRAINER ---
Number of training nodes: 82650
Number of validation nodes: 9183
Number of training edges: 718887
Number of validation edges: 79876
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9371; val_auprc_score: 0.9396; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 24875.7182; train_edge_recon_loss: 3491129.2216; train_gene_expr_recon_loss: 3605851.5511; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7121856.4773; train_optim_loss: 7121856.4773; val_kl_reg_loss: 60780.4852; val_edge_recon_loss: 4065605.4000; val_gene_expr_recon_loss: 3017483.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7143869.5000; val_optim_loss: 7143869.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9043; val_auprc_score: 0.9033; val_best_acc_score: 0.5014; val_best_f1_score: 0.6672; train_kl_reg_loss: 62228.3171; train_edge_recon_loss: 3511622.8182; train_gene_expr_recon_loss: 2817992.5966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6391843.7386; train_optim_loss: 6391843.7386; val_kl_reg_loss: 63589.1281; val_edge_recon_loss: 4064694.4000; val_gene_expr_recon_loss: 2683966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6812249.6000; val_optim_loss: 6812249.6000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8959; val_auprc_score: 0.8801; val_best_acc_score: 0.7177; val_best_f1_score: 0.7780; train_kl_reg_loss: 53531.0923; train_edge_recon_loss: 3502006.0000; train_gene_expr_recon_loss: 2644386.2216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6199923.2727; train_optim_loss: 6199923.2727; val_kl_reg_loss: 54741.9758; val_edge_recon_loss: 4054074.2000; val_gene_expr_recon_loss: 2608843.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6717659.6000; val_optim_loss: 6717659.6000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8860; val_auprc_score: 0.8584; val_best_acc_score: 0.8092; val_best_f1_score: 0.8280; train_kl_reg_loss: 42522.5957; train_edge_recon_loss: 3484923.5852; train_gene_expr_recon_loss: 2593491.1023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6120937.3068; train_optim_loss: 6120937.3068; val_kl_reg_loss: 28766.0289; val_edge_recon_loss: 3712806.0000; val_gene_expr_recon_loss: 2579047.7000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6320619.8000; val_optim_loss: 6320619.8000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8488; val_auprc_score: 0.8308; val_best_acc_score: 0.7524; val_best_f1_score: 0.7860; train_kl_reg_loss: 29896.8541; train_edge_recon_loss: 3110396.7841; train_gene_expr_recon_loss: 2618972.0852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5759265.7045; train_optim_loss: 5759265.7045; val_kl_reg_loss: 52620.2625; val_edge_recon_loss: 2967652.0500; val_gene_expr_recon_loss: 2597602.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5617874.3000; val_optim_loss: 5617874.3000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8462; val_auprc_score: 0.8294; val_best_acc_score: 0.7484; val_best_f1_score: 0.7830; train_kl_reg_loss: 55496.8605; train_edge_recon_loss: 2946963.5170; train_gene_expr_recon_loss: 2563259.7841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5565720.1932; train_optim_loss: 5565720.1932; val_kl_reg_loss: 58223.4242; val_edge_recon_loss: 2958836.0000; val_gene_expr_recon_loss: 2540854.0500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5557913.6000; val_optim_loss: 5557913.6000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8486; val_auprc_score: 0.8331; val_best_acc_score: 0.7493; val_best_f1_score: 0.7834; train_kl_reg_loss: 57233.8619; train_edge_recon_loss: 2939895.6591; train_gene_expr_recon_loss: 2532416.4886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5529546.0341; train_optim_loss: 5529546.0341; val_kl_reg_loss: 55793.8438; val_edge_recon_loss: 2948231.3000; val_gene_expr_recon_loss: 2518400.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5522425.6000; val_optim_loss: 5522425.6000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8494; val_auprc_score: 0.8329; val_best_acc_score: 0.7520; val_best_f1_score: 0.7851; train_kl_reg_loss: 53985.9552; train_edge_recon_loss: 2932638.2670; train_gene_expr_recon_loss: 2514274.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5500898.3750; train_optim_loss: 5500898.3750; val_kl_reg_loss: 51727.7922; val_edge_recon_loss: 2933724.0500; val_gene_expr_recon_loss: 2499830.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5485281.8000; val_optim_loss: 5485281.8000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8524; val_auprc_score: 0.8317; val_best_acc_score: 0.7605; val_best_f1_score: 0.7899; train_kl_reg_loss: 50066.6040; train_edge_recon_loss: 2920227.5568; train_gene_expr_recon_loss: 2496850.2955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5467144.4659; train_optim_loss: 5467144.4659; val_kl_reg_loss: 47440.2164; val_edge_recon_loss: 2915555.4000; val_gene_expr_recon_loss: 2487500.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5450495.9000; val_optim_loss: 5450495.9000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8716; val_auprc_score: 0.8466; val_best_acc_score: 0.7899; val_best_f1_score: 0.8105; train_kl_reg_loss: 45178.1853; train_edge_recon_loss: 2885514.3239; train_gene_expr_recon_loss: 2485469.3920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5416161.8864; train_optim_loss: 5416161.8864; val_kl_reg_loss: 44032.6961; val_edge_recon_loss: 2868906.0000; val_gene_expr_recon_loss: 2482717.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5395656.2000; val_optim_loss: 5395656.2000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8922; val_auprc_score: 0.8662; val_best_acc_score: 0.8159; val_best_f1_score: 0.8321; train_kl_reg_loss: 46582.5178; train_edge_recon_loss: 2835632.2841; train_gene_expr_recon_loss: 2472990.0114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5355204.7727; train_optim_loss: 5355204.7727; val_kl_reg_loss: 47809.8453; val_edge_recon_loss: 2836596.5500; val_gene_expr_recon_loss: 2460983.5500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5345389.9000; val_optim_loss: 5345389.9000
