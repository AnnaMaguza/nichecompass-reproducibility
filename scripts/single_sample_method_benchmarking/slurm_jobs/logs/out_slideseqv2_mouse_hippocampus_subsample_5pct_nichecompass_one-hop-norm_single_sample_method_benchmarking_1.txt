Run timestamp: 15062023_135543.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'slideseqv2_mouse_hippocampus_subsample_5pct', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 4407
Number of validation edges: 489
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8181; val_auprc_score: 0.8108; val_best_acc_score: 0.7536; val_best_f1_score: 0.7583; train_kl_reg_loss: 2.6941; train_edge_recon_loss: 346691.6562; train_gene_expr_recon_loss: 89475.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436169.5938; train_optim_loss: 436169.5938; val_kl_reg_loss: 7.0608; val_edge_recon_loss: 390530.1250; val_gene_expr_recon_loss: 78610.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469147.2812; val_optim_loss: 469147.2812
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8115; val_auprc_score: 0.7979; val_best_acc_score: 0.7311; val_best_f1_score: 0.7478; train_kl_reg_loss: 10.8080; train_edge_recon_loss: 346458.4531; train_gene_expr_recon_loss: 72365.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418835.2344; train_optim_loss: 418835.2344; val_kl_reg_loss: 24.2135; val_edge_recon_loss: 397293.8750; val_gene_expr_recon_loss: 73578.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470896.6875; val_optim_loss: 470896.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8086; val_auprc_score: 0.7830; val_best_acc_score: 0.7035; val_best_f1_score: 0.7623; train_kl_reg_loss: 33.1936; train_edge_recon_loss: 346552.4219; train_gene_expr_recon_loss: 69114.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415699.8438; train_optim_loss: 415699.8438; val_kl_reg_loss: 67.2792; val_edge_recon_loss: 399718.2188; val_gene_expr_recon_loss: 73770.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473555.5938; val_optim_loss: 473555.5938
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7903; val_auprc_score: 0.7706; val_best_acc_score: 0.6779; val_best_f1_score: 0.7331; train_kl_reg_loss: 87.2559; train_edge_recon_loss: 345630.3438; train_gene_expr_recon_loss: 69210.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414928.0781; train_optim_loss: 414928.0781; val_kl_reg_loss: 155.4041; val_edge_recon_loss: 400841.5000; val_gene_expr_recon_loss: 73723.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474720.5938; val_optim_loss: 474720.5938
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7684; val_auprc_score: 0.7562; val_best_acc_score: 0.6830; val_best_f1_score: 0.7352; train_kl_reg_loss: 187.5654; train_edge_recon_loss: 345386.1719; train_gene_expr_recon_loss: 69048.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414622.0312; train_optim_loss: 414622.0312; val_kl_reg_loss: 271.6588; val_edge_recon_loss: 397268.5312; val_gene_expr_recon_loss: 73031.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470571.4375; val_optim_loss: 470571.4375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7727; val_auprc_score: 0.7642; val_best_acc_score: 0.6830; val_best_f1_score: 0.7378; train_kl_reg_loss: 293.7019; train_edge_recon_loss: 343411.4375; train_gene_expr_recon_loss: 68379.0977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412084.2188; train_optim_loss: 412084.2188; val_kl_reg_loss: 334.7568; val_edge_recon_loss: 382968.0625; val_gene_expr_recon_loss: 72318.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455621.0625; val_optim_loss: 455621.0625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7548; val_auprc_score: 0.7386; val_best_acc_score: 0.6902; val_best_f1_score: 0.7335; train_kl_reg_loss: 351.2738; train_edge_recon_loss: 341278.6562; train_gene_expr_recon_loss: 67912.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409542.0625; train_optim_loss: 409542.0625; val_kl_reg_loss: 387.6371; val_edge_recon_loss: 357993.1562; val_gene_expr_recon_loss: 72026.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430407.7188; val_optim_loss: 430407.7188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7749; val_auprc_score: 0.7428; val_best_acc_score: 0.7127; val_best_f1_score: 0.7587; train_kl_reg_loss: 396.6291; train_edge_recon_loss: 339989.4375; train_gene_expr_recon_loss: 67698.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408084.4062; train_optim_loss: 408084.4062; val_kl_reg_loss: 404.5402; val_edge_recon_loss: 326660.4688; val_gene_expr_recon_loss: 71838.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398903.7188; val_optim_loss: 398903.7188
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7980; val_auprc_score: 0.7686; val_best_acc_score: 0.7311; val_best_f1_score: 0.7707; train_kl_reg_loss: 422.2834; train_edge_recon_loss: 334795.2188; train_gene_expr_recon_loss: 67491.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402708.6875; train_optim_loss: 402708.6875; val_kl_reg_loss: 504.8680; val_edge_recon_loss: 303678.2188; val_gene_expr_recon_loss: 71686.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375870.0000; val_optim_loss: 375870.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.7883; val_auprc_score: 0.7687; val_best_acc_score: 0.7168; val_best_f1_score: 0.7690; train_kl_reg_loss: 536.2307; train_edge_recon_loss: 331702.5625; train_gene_expr_recon_loss: 67276.9062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399515.7031; train_optim_loss: 399515.7031; val_kl_reg_loss: 658.1451; val_edge_recon_loss: 302393.0312; val_gene_expr_recon_loss: 71472.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374523.2500; val_optim_loss: 374523.2500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8111; val_auprc_score: 0.7939; val_best_acc_score: 0.7280; val_best_f1_score: 0.7685; train_kl_reg_loss: 724.1504; train_edge_recon_loss: 322230.2031; train_gene_expr_recon_loss: 66998.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 389952.5000; train_optim_loss: 389952.5000; val_kl_reg_loss: 990.3721; val_edge_recon_loss: 300069.6250; val_gene_expr_recon_loss: 71153.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 372213.5625; val_optim_loss: 372213.5625
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.7725; val_auprc_score: 0.7676; val_best_acc_score: 0.6851; val_best_f1_score: 0.7381; train_kl_reg_loss: 1115.5485; train_edge_recon_loss: 311324.0000; train_gene_expr_recon_loss: 66689.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 379128.8438; train_optim_loss: 379128.8438; val_kl_reg_loss: 1573.9357; val_edge_recon_loss: 318765.2812; val_gene_expr_recon_loss: 70845.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 391184.8125; val_optim_loss: 391184.8125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.7943; val_auprc_score: 0.7834; val_best_acc_score: 0.7086; val_best_f1_score: 0.7578; train_kl_reg_loss: 1798.5585; train_edge_recon_loss: 303026.5938; train_gene_expr_recon_loss: 66429.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371254.3750; train_optim_loss: 371254.3750; val_kl_reg_loss: 2639.5249; val_edge_recon_loss: 302868.4688; val_gene_expr_recon_loss: 70564.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 376072.9375; val_optim_loss: 376072.9375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8101; val_auprc_score: 0.8138; val_best_acc_score: 0.7096; val_best_f1_score: 0.7617; train_kl_reg_loss: 3008.4841; train_edge_recon_loss: 299190.8438; train_gene_expr_recon_loss: 66187.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368386.7656; train_optim_loss: 368386.7656; val_kl_reg_loss: 4053.6250; val_edge_recon_loss: 300528.8125; val_gene_expr_recon_loss: 70309.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374891.8438; val_optim_loss: 374891.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.7945; val_auprc_score: 0.7883; val_best_acc_score: 0.7045; val_best_f1_score: 0.7573; train_kl_reg_loss: 4049.5217; train_edge_recon_loss: 301545.7969; train_gene_expr_recon_loss: 66004.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 371599.8125; train_optim_loss: 371599.8125; val_kl_reg_loss: 4189.7168; val_edge_recon_loss: 303753.0625; val_gene_expr_recon_loss: 70268.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 378211.7500; val_optim_loss: 378211.7500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7981; val_auprc_score: 0.7952; val_best_acc_score: 0.7096; val_best_f1_score: 0.7610; train_kl_reg_loss: 4197.2305; train_edge_recon_loss: 294256.5469; train_gene_expr_recon_loss: 65958.5039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364412.2812; train_optim_loss: 364412.2812; val_kl_reg_loss: 4335.4189; val_edge_recon_loss: 300876.9062; val_gene_expr_recon_loss: 70204.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375416.5625; val_optim_loss: 375416.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8160; val_auprc_score: 0.8067; val_best_acc_score: 0.7229; val_best_f1_score: 0.7646; train_kl_reg_loss: 4334.1353; train_edge_recon_loss: 289586.8750; train_gene_expr_recon_loss: 65893.6992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359814.7031; train_optim_loss: 359814.7031; val_kl_reg_loss: 4395.0879; val_edge_recon_loss: 296193.7812; val_gene_expr_recon_loss: 70128.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370717.8125; val_optim_loss: 370717.8125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8092; val_auprc_score: 0.8100; val_best_acc_score: 0.7178; val_best_f1_score: 0.7677; train_kl_reg_loss: 4408.7344; train_edge_recon_loss: 290053.0781; train_gene_expr_recon_loss: 65819.6484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 360281.4531; train_optim_loss: 360281.4531; val_kl_reg_loss: 4479.0811; val_edge_recon_loss: 297308.2812; val_gene_expr_recon_loss: 70056.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371843.5000; val_optim_loss: 371843.5000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7932; val_auprc_score: 0.7771; val_best_acc_score: 0.7035; val_best_f1_score: 0.7585; train_kl_reg_loss: 4476.2944; train_edge_recon_loss: 295168.8594; train_gene_expr_recon_loss: 65750.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365395.7344; train_optim_loss: 365395.7344; val_kl_reg_loss: 4568.4814; val_edge_recon_loss: 307683.9375; val_gene_expr_recon_loss: 69993.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 382246.1875; val_optim_loss: 382246.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8176; val_auprc_score: 0.8177; val_best_acc_score: 0.7209; val_best_f1_score: 0.7606; train_kl_reg_loss: 4603.1626; train_edge_recon_loss: 288264.2500; train_gene_expr_recon_loss: 65691.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358559.2500; train_optim_loss: 358559.2500; val_kl_reg_loss: 4570.7271; val_edge_recon_loss: 300828.3438; val_gene_expr_recon_loss: 69945.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 375344.1562; val_optim_loss: 375344.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7827; val_auprc_score: 0.7742; val_best_acc_score: 0.6933; val_best_f1_score: 0.7455; train_kl_reg_loss: 4613.1665; train_edge_recon_loss: 298009.9844; train_gene_expr_recon_loss: 65654.7773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368277.9219; train_optim_loss: 368277.9219; val_kl_reg_loss: 4635.6777; val_edge_recon_loss: 315175.5625; val_gene_expr_recon_loss: 69940.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 389752.1875; val_optim_loss: 389752.1875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8074; val_auprc_score: 0.8015; val_best_acc_score: 0.7127; val_best_f1_score: 0.7662; train_kl_reg_loss: 4671.5234; train_edge_recon_loss: 292338.1094; train_gene_expr_recon_loss: 65651.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362661.3906; train_optim_loss: 362661.3906; val_kl_reg_loss: 4604.1201; val_edge_recon_loss: 300339.6875; val_gene_expr_recon_loss: 69936.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 374880.5938; val_optim_loss: 374880.5938
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.7953; val_auprc_score: 0.7960; val_best_acc_score: 0.7045; val_best_f1_score: 0.7596; train_kl_reg_loss: 4631.4341; train_edge_recon_loss: 294757.3906; train_gene_expr_recon_loss: 65646.6953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365035.5156; train_optim_loss: 365035.5156; val_kl_reg_loss: 4672.1553; val_edge_recon_loss: 305767.4375; val_gene_expr_recon_loss: 69932.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380372.3125; val_optim_loss: 380372.3125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 13 sec.
Using best model state, which was in epoch 17.

--- MODEL EVALUATION ---
Val AUROC score: 0.8119
Val AUPRC score: 0.8012
Val best accuracy score: 0.7229
Val best F1 score: 0.7629
Val gene expr MSE score: 0.0109
Duration of model training in run 1: 0 hours, 0 minutes and 16 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 4407
Number of validation edges: 489
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8292; val_auprc_score: 0.8208; val_best_acc_score: 0.7536; val_best_f1_score: 0.7720; train_kl_reg_loss: 3.0316; train_edge_recon_loss: 346544.5625; train_gene_expr_recon_loss: 89979.3359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436526.9375; train_optim_loss: 436526.9375; val_kl_reg_loss: 7.8627; val_edge_recon_loss: 390962.0625; val_gene_expr_recon_loss: 69928.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460898.6562; val_optim_loss: 460898.6562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8341; val_auprc_score: 0.8222; val_best_acc_score: 0.7577; val_best_f1_score: 0.7628; train_kl_reg_loss: 12.8914; train_edge_recon_loss: 346217.5625; train_gene_expr_recon_loss: 73102.8555; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419333.3125; train_optim_loss: 419333.3125; val_kl_reg_loss: 27.4948; val_edge_recon_loss: 397539.1875; val_gene_expr_recon_loss: 66052.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463619.5000; val_optim_loss: 463619.5000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8248; val_auprc_score: 0.8138; val_best_acc_score: 0.6861; val_best_f1_score: 0.7550; train_kl_reg_loss: 40.6808; train_edge_recon_loss: 346339.5469; train_gene_expr_recon_loss: 70523.4688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416903.7031; train_optim_loss: 416903.7031; val_kl_reg_loss: 73.5229; val_edge_recon_loss: 400233.9062; val_gene_expr_recon_loss: 66439.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466747.0000; val_optim_loss: 466747.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7897; val_auprc_score: 0.7840; val_best_acc_score: 0.6789; val_best_f1_score: 0.7524; train_kl_reg_loss: 103.4512; train_edge_recon_loss: 346009.9844; train_gene_expr_recon_loss: 70986.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417100.1406; train_optim_loss: 417100.1406; val_kl_reg_loss: 155.6972; val_edge_recon_loss: 398624.9062; val_gene_expr_recon_loss: 66382.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465162.8750; val_optim_loss: 465162.8750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7337; val_auprc_score: 0.7280; val_best_acc_score: 0.6380; val_best_f1_score: 0.7216; train_kl_reg_loss: 199.6871; train_edge_recon_loss: 344924.6250; train_gene_expr_recon_loss: 70692.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415816.7188; train_optim_loss: 415816.7188; val_kl_reg_loss: 258.5700; val_edge_recon_loss: 395826.6875; val_gene_expr_recon_loss: 65517.5898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461602.8438; val_optim_loss: 461602.8438
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7610; val_auprc_score: 0.7572; val_best_acc_score: 0.6708; val_best_f1_score: 0.7284; train_kl_reg_loss: 308.5457; train_edge_recon_loss: 343437.0000; train_gene_expr_recon_loss: 69867.7461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413613.2969; train_optim_loss: 413613.2969; val_kl_reg_loss: 341.2756; val_edge_recon_loss: 376176.5000; val_gene_expr_recon_loss: 65117.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441635.0000; val_optim_loss: 441635.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7426; val_auprc_score: 0.7502; val_best_acc_score: 0.6554; val_best_f1_score: 0.7231; train_kl_reg_loss: 402.8233; train_edge_recon_loss: 342129.5156; train_gene_expr_recon_loss: 69539.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412072.0156; train_optim_loss: 412072.0156; val_kl_reg_loss: 384.5712; val_edge_recon_loss: 357132.6562; val_gene_expr_recon_loss: 65020.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 422538.1875; val_optim_loss: 422538.1875
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7840; val_auprc_score: 0.7729; val_best_acc_score: 0.7025; val_best_f1_score: 0.7589; train_kl_reg_loss: 430.1265; train_edge_recon_loss: 339573.4219; train_gene_expr_recon_loss: 69400.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409404.1562; train_optim_loss: 409404.1562; val_kl_reg_loss: 387.6375; val_edge_recon_loss: 323310.6250; val_gene_expr_recon_loss: 64894.7461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 388593.0000; val_optim_loss: 388593.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8280; val_auprc_score: 0.8161; val_best_acc_score: 0.7423; val_best_f1_score: 0.7805; train_kl_reg_loss: 444.0635; train_edge_recon_loss: 335973.7812; train_gene_expr_recon_loss: 69167.9844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405585.8281; train_optim_loss: 405585.8281; val_kl_reg_loss: 410.5830; val_edge_recon_loss: 301024.8125; val_gene_expr_recon_loss: 64655.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366090.5312; val_optim_loss: 366090.5312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8336; val_auprc_score: 0.8287; val_best_acc_score: 0.7413; val_best_f1_score: 0.7780; train_kl_reg_loss: 492.3577; train_edge_recon_loss: 329976.6875; train_gene_expr_recon_loss: 68847.5352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399316.5781; train_optim_loss: 399316.5781; val_kl_reg_loss: 574.4316; val_edge_recon_loss: 296280.2812; val_gene_expr_recon_loss: 64391.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361245.7500; val_optim_loss: 361245.7500
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8156; val_auprc_score: 0.7925; val_best_acc_score: 0.7321; val_best_f1_score: 0.7715; train_kl_reg_loss: 726.2921; train_edge_recon_loss: 322513.2031; train_gene_expr_recon_loss: 68534.5273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391774.0312; train_optim_loss: 391774.0312; val_kl_reg_loss: 975.0653; val_edge_recon_loss: 299284.7500; val_gene_expr_recon_loss: 64150.1680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364409.9688; val_optim_loss: 364409.9688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8273; val_auprc_score: 0.8229; val_best_acc_score: 0.7362; val_best_f1_score: 0.7682; train_kl_reg_loss: 1232.2867; train_edge_recon_loss: 315237.9531; train_gene_expr_recon_loss: 68259.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 384729.6562; train_optim_loss: 384729.6562; val_kl_reg_loss: 1661.9863; val_edge_recon_loss: 295912.5312; val_gene_expr_recon_loss: 63907.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361482.2500; val_optim_loss: 361482.2500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8008; val_auprc_score: 0.7839; val_best_acc_score: 0.7137; val_best_f1_score: 0.7584; train_kl_reg_loss: 2017.0781; train_edge_recon_loss: 299651.3906; train_gene_expr_recon_loss: 68001.5703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 369670.0469; train_optim_loss: 369670.0469; val_kl_reg_loss: 2552.3301; val_edge_recon_loss: 304146.6562; val_gene_expr_recon_loss: 63689.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370388.2188; val_optim_loss: 370388.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8245; val_auprc_score: 0.8136; val_best_acc_score: 0.7321; val_best_f1_score: 0.7630; train_kl_reg_loss: 2794.1956; train_edge_recon_loss: 297337.5000; train_gene_expr_recon_loss: 67821.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367953.6719; train_optim_loss: 367953.6719; val_kl_reg_loss: 2610.2002; val_edge_recon_loss: 301047.5000; val_gene_expr_recon_loss: 63653.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367311.2812; val_optim_loss: 367311.2812
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8280; val_auprc_score: 0.8240; val_best_acc_score: 0.7382; val_best_f1_score: 0.7690; train_kl_reg_loss: 2917.8165; train_edge_recon_loss: 293508.4844; train_gene_expr_recon_loss: 67773.6641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364199.9688; train_optim_loss: 364199.9688; val_kl_reg_loss: 2757.8525; val_edge_recon_loss: 296236.4688; val_gene_expr_recon_loss: 63594.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 362588.6250; val_optim_loss: 362588.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8317; val_auprc_score: 0.8170; val_best_acc_score: 0.7362; val_best_f1_score: 0.7740; train_kl_reg_loss: 3069.9368; train_edge_recon_loss: 298178.9531; train_gene_expr_recon_loss: 67698.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368947.8125; train_optim_loss: 368947.8125; val_kl_reg_loss: 2910.2683; val_edge_recon_loss: 294217.0625; val_gene_expr_recon_loss: 63524.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360651.7500; val_optim_loss: 360651.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8161; val_auprc_score: 0.8123; val_best_acc_score: 0.7198; val_best_f1_score: 0.7600; train_kl_reg_loss: 3129.4673; train_edge_recon_loss: 295564.3438; train_gene_expr_recon_loss: 67617.2578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366311.0781; train_optim_loss: 366311.0781; val_kl_reg_loss: 3045.1201; val_edge_recon_loss: 303966.9375; val_gene_expr_recon_loss: 63455.3477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370467.4062; val_optim_loss: 370467.4062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8280; val_auprc_score: 0.8190; val_best_acc_score: 0.7393; val_best_f1_score: 0.7655; train_kl_reg_loss: 3319.1447; train_edge_recon_loss: 296810.1719; train_gene_expr_recon_loss: 67539.0664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367668.3750; train_optim_loss: 367668.3750; val_kl_reg_loss: 3097.7070; val_edge_recon_loss: 299268.1562; val_gene_expr_recon_loss: 63394.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365760.6562; val_optim_loss: 365760.6562
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8179; val_auprc_score: 0.8099; val_best_acc_score: 0.7209; val_best_f1_score: 0.7633; train_kl_reg_loss: 3470.7145; train_edge_recon_loss: 297994.5625; train_gene_expr_recon_loss: 67469.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 368934.5938; train_optim_loss: 368934.5938; val_kl_reg_loss: 3267.8271; val_edge_recon_loss: 299137.2812; val_gene_expr_recon_loss: 63348.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 365753.1562; val_optim_loss: 365753.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8338; val_auprc_score: 0.8410; val_best_acc_score: 0.7362; val_best_f1_score: 0.7615; train_kl_reg_loss: 3537.2249; train_edge_recon_loss: 299841.6406; train_gene_expr_recon_loss: 67424.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 370803.4531; train_optim_loss: 370803.4531; val_kl_reg_loss: 3232.8169; val_edge_recon_loss: 302465.7188; val_gene_expr_recon_loss: 63344.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369042.6562; val_optim_loss: 369042.6562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8356; val_auprc_score: 0.8301; val_best_acc_score: 0.7413; val_best_f1_score: 0.7722; train_kl_reg_loss: 3586.6592; train_edge_recon_loss: 291512.3594; train_gene_expr_recon_loss: 67421.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362520.8125; train_optim_loss: 362520.8125; val_kl_reg_loss: 3294.0464; val_edge_recon_loss: 293919.5938; val_gene_expr_recon_loss: 63340.1445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360553.7812; val_optim_loss: 360553.7812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8261; val_auprc_score: 0.8195; val_best_acc_score: 0.7311; val_best_f1_score: 0.7640; train_kl_reg_loss: 3573.2300; train_edge_recon_loss: 293740.2812; train_gene_expr_recon_loss: 67416.8828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364730.3906; train_optim_loss: 364730.3906; val_kl_reg_loss: 3237.9070; val_edge_recon_loss: 300587.4375; val_gene_expr_recon_loss: 63336.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367161.5312; val_optim_loss: 367161.5312
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8131; val_auprc_score: 0.8075; val_best_acc_score: 0.7188; val_best_f1_score: 0.7639; train_kl_reg_loss: 3545.9362; train_edge_recon_loss: 295370.5781; train_gene_expr_recon_loss: 67409.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366326.4688; train_optim_loss: 366326.4688; val_kl_reg_loss: 3318.7444; val_edge_recon_loss: 301019.4688; val_gene_expr_recon_loss: 63332.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 367670.4375; val_optim_loss: 367670.4375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8361; val_auprc_score: 0.8317; val_best_acc_score: 0.7413; val_best_f1_score: 0.7714; train_kl_reg_loss: 3566.6465; train_edge_recon_loss: 296042.3594; train_gene_expr_recon_loss: 67406.4023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367015.3906; train_optim_loss: 367015.3906; val_kl_reg_loss: 3312.2153; val_edge_recon_loss: 293669.9688; val_gene_expr_recon_loss: 63328.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360310.5000; val_optim_loss: 360310.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8192; val_auprc_score: 0.8224; val_best_acc_score: 0.7147; val_best_f1_score: 0.7620; train_kl_reg_loss: 3604.0605; train_edge_recon_loss: 294352.8906; train_gene_expr_recon_loss: 67401.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365358.3594; train_optim_loss: 365358.3594; val_kl_reg_loss: 3299.9885; val_edge_recon_loss: 302058.3750; val_gene_expr_recon_loss: 63324.5117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368682.8750; val_optim_loss: 368682.8750
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8097; val_auprc_score: 0.7943; val_best_acc_score: 0.7198; val_best_f1_score: 0.7573; train_kl_reg_loss: 3570.4191; train_edge_recon_loss: 293614.0000; train_gene_expr_recon_loss: 67397.9258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364582.3438; train_optim_loss: 364582.3438; val_kl_reg_loss: 3189.6025; val_edge_recon_loss: 307041.6250; val_gene_expr_recon_loss: 63320.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373552.0000; val_optim_loss: 373552.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8194; val_auprc_score: 0.8092; val_best_acc_score: 0.7249; val_best_f1_score: 0.7738; train_kl_reg_loss: 3629.8364; train_edge_recon_loss: 294273.7812; train_gene_expr_recon_loss: 67392.9570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365296.5781; train_optim_loss: 365296.5781; val_kl_reg_loss: 3254.6599; val_edge_recon_loss: 294538.7812; val_gene_expr_recon_loss: 63317.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361110.5625; val_optim_loss: 361110.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8104; val_auprc_score: 0.8189; val_best_acc_score: 0.7086; val_best_f1_score: 0.7524; train_kl_reg_loss: 3573.3606; train_edge_recon_loss: 293741.8281; train_gene_expr_recon_loss: 67388.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364703.9531; train_optim_loss: 364703.9531; val_kl_reg_loss: 3195.2979; val_edge_recon_loss: 313405.2500; val_gene_expr_recon_loss: 63316.7773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 379917.3438; val_optim_loss: 379917.3438
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8215; val_auprc_score: 0.8107; val_best_acc_score: 0.7249; val_best_f1_score: 0.7677; train_kl_reg_loss: 3580.5092; train_edge_recon_loss: 295557.5000; train_gene_expr_recon_loss: 67389.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366527.3125; train_optim_loss: 366527.3125; val_kl_reg_loss: 3242.2866; val_edge_recon_loss: 297249.4375; val_gene_expr_recon_loss: 63316.4102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363808.1250; val_optim_loss: 363808.1250
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8301; val_auprc_score: 0.8165; val_best_acc_score: 0.7362; val_best_f1_score: 0.7669; train_kl_reg_loss: 3581.1575; train_edge_recon_loss: 296573.9062; train_gene_expr_recon_loss: 67389.3945; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367544.4531; train_optim_loss: 367544.4531; val_kl_reg_loss: 3226.8494; val_edge_recon_loss: 296766.5000; val_gene_expr_recon_loss: 63316.0586; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363309.4062; val_optim_loss: 363309.4062

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 17 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.8159
Val AUPRC score: 0.8170
Val best accuracy score: 0.7301
Val best F1 score: 0.7522
Val gene expr MSE score: 0.0107
Duration of model training in run 2: 0 hours, 0 minutes and 18 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 8587
Number of validation edges: 954
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8839; val_auprc_score: 0.8717; val_best_acc_score: 0.7516; val_best_f1_score: 0.7618; train_kl_reg_loss: 16.4604; train_edge_recon_loss: 346451.4625; train_gene_expr_recon_loss: 78824.4812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425292.4000; train_optim_loss: 425292.4000; val_kl_reg_loss: 64.1357; val_edge_recon_loss: 399563.0938; val_gene_expr_recon_loss: 69941.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469568.6562; val_optim_loss: 469568.6562
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7968; val_auprc_score: 0.7966; val_best_acc_score: 0.7112; val_best_f1_score: 0.7343; train_kl_reg_loss: 169.4920; train_edge_recon_loss: 344605.9875; train_gene_expr_recon_loss: 70084.7781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414860.2625; train_optim_loss: 414860.2625; val_kl_reg_loss: 351.9104; val_edge_recon_loss: 381962.0312; val_gene_expr_recon_loss: 69740.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452054.6875; val_optim_loss: 452054.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8210; val_auprc_score: 0.8106; val_best_acc_score: 0.7332; val_best_f1_score: 0.7735; train_kl_reg_loss: 425.7326; train_edge_recon_loss: 339007.9188; train_gene_expr_recon_loss: 69254.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408688.3500; train_optim_loss: 408688.3500; val_kl_reg_loss: 447.3342; val_edge_recon_loss: 310688.3438; val_gene_expr_recon_loss: 69134.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 380270.5000; val_optim_loss: 380270.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8397; val_auprc_score: 0.8355; val_best_acc_score: 0.7385; val_best_f1_score: 0.7798; train_kl_reg_loss: 646.3742; train_edge_recon_loss: 326422.0375; train_gene_expr_recon_loss: 69148.7734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396217.1875; train_optim_loss: 396217.1875; val_kl_reg_loss: 1063.3160; val_edge_recon_loss: 292495.0312; val_gene_expr_recon_loss: 68357.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361915.5625; val_optim_loss: 361915.5625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8374; val_auprc_score: 0.8424; val_best_acc_score: 0.7306; val_best_f1_score: 0.7708; train_kl_reg_loss: 2045.4928; train_edge_recon_loss: 304896.0312; train_gene_expr_recon_loss: 67936.2906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 374877.8125; train_optim_loss: 374877.8125; val_kl_reg_loss: 3840.5625; val_edge_recon_loss: 297519.1250; val_gene_expr_recon_loss: 67779.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369138.9062; val_optim_loss: 369138.9062
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8454; val_auprc_score: 0.8402; val_best_acc_score: 0.7500; val_best_f1_score: 0.7787; train_kl_reg_loss: 5871.5401; train_edge_recon_loss: 291277.4062; train_gene_expr_recon_loss: 67111.5281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364260.4688; train_optim_loss: 364260.4688; val_kl_reg_loss: 7942.0293; val_edge_recon_loss: 289601.6250; val_gene_expr_recon_loss: 67293.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 364836.6875; val_optim_loss: 364836.6875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8359; val_auprc_score: 0.8399; val_best_acc_score: 0.7254; val_best_f1_score: 0.7724; train_kl_reg_loss: 8788.2506; train_edge_recon_loss: 290729.2375; train_gene_expr_recon_loss: 67004.9891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 366522.4688; train_optim_loss: 366522.4688; val_kl_reg_loss: 8329.6484; val_edge_recon_loss: 298368.5938; val_gene_expr_recon_loss: 66942.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373640.5312; val_optim_loss: 373640.5312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8486; val_auprc_score: 0.8471; val_best_acc_score: 0.7411; val_best_f1_score: 0.7781; train_kl_reg_loss: 8641.5045; train_edge_recon_loss: 288902.9375; train_gene_expr_recon_loss: 66207.4500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363751.9000; train_optim_loss: 363751.9000; val_kl_reg_loss: 8328.2617; val_edge_recon_loss: 290827.4062; val_gene_expr_recon_loss: 66852.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 366008.4375; val_optim_loss: 366008.4375
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8436; val_auprc_score: 0.8373; val_best_acc_score: 0.7379; val_best_f1_score: 0.7740; train_kl_reg_loss: 8577.0301; train_edge_recon_loss: 287251.8187; train_gene_expr_recon_loss: 66293.3625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362122.2125; train_optim_loss: 362122.2125; val_kl_reg_loss: 8114.1689; val_edge_recon_loss: 293436.8438; val_gene_expr_recon_loss: 66742.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368293.0000; val_optim_loss: 368293.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8275; val_auprc_score: 0.8225; val_best_acc_score: 0.7301; val_best_f1_score: 0.7634; train_kl_reg_loss: 8395.7779; train_edge_recon_loss: 287069.6875; train_gene_expr_recon_loss: 66860.3992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362325.8750; train_optim_loss: 362325.8750; val_kl_reg_loss: 7931.3701; val_edge_recon_loss: 302551.8438; val_gene_expr_recon_loss: 66683.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 377166.3750; val_optim_loss: 377166.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.8413
Val AUPRC score: 0.8446
Val best accuracy score: 0.7348
Val best F1 score: 0.7759
Val gene expr MSE score: 0.0106
Duration of model training in run 3: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 8587
Number of validation edges: 954
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8796; val_auprc_score: 0.8579; val_best_acc_score: 0.7427; val_best_f1_score: 0.7626; train_kl_reg_loss: 13.1297; train_edge_recon_loss: 346625.0750; train_gene_expr_recon_loss: 79260.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425898.5000; train_optim_loss: 425898.5000; val_kl_reg_loss: 51.8841; val_edge_recon_loss: 399442.0000; val_gene_expr_recon_loss: 71924.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471418.3125; val_optim_loss: 471418.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7982; val_auprc_score: 0.8189; val_best_acc_score: 0.7007; val_best_f1_score: 0.7312; train_kl_reg_loss: 137.6070; train_edge_recon_loss: 345513.6063; train_gene_expr_recon_loss: 70226.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415877.4000; train_optim_loss: 415877.4000; val_kl_reg_loss: 299.3062; val_edge_recon_loss: 386270.6250; val_gene_expr_recon_loss: 71806.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458376.4375; val_optim_loss: 458376.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8308; val_auprc_score: 0.8194; val_best_acc_score: 0.7469; val_best_f1_score: 0.7764; train_kl_reg_loss: 367.4702; train_edge_recon_loss: 340151.0062; train_gene_expr_recon_loss: 69215.9297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409734.4188; train_optim_loss: 409734.4188; val_kl_reg_loss: 441.6304; val_edge_recon_loss: 314310.3438; val_gene_expr_recon_loss: 70945.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 385697.2812; val_optim_loss: 385697.2812
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8468; val_auprc_score: 0.8442; val_best_acc_score: 0.7432; val_best_f1_score: 0.7832; train_kl_reg_loss: 583.4555; train_edge_recon_loss: 329183.2750; train_gene_expr_recon_loss: 68792.8328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398559.5687; train_optim_loss: 398559.5687; val_kl_reg_loss: 995.7679; val_edge_recon_loss: 292633.2188; val_gene_expr_recon_loss: 70171.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 363800.4375; val_optim_loss: 363800.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8432; val_auprc_score: 0.8434; val_best_acc_score: 0.7385; val_best_f1_score: 0.7678; train_kl_reg_loss: 1713.6756; train_edge_recon_loss: 307876.5875; train_gene_expr_recon_loss: 68288.8141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 377879.0812; train_optim_loss: 377879.0812; val_kl_reg_loss: 3372.4136; val_edge_recon_loss: 298256.6250; val_gene_expr_recon_loss: 69564.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371193.9375; val_optim_loss: 371193.9375
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8434; val_auprc_score: 0.8203; val_best_acc_score: 0.7552; val_best_f1_score: 0.7791; train_kl_reg_loss: 5173.6695; train_edge_recon_loss: 294743.9313; train_gene_expr_recon_loss: 67249.4016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367167.0000; train_optim_loss: 367167.0000; val_kl_reg_loss: 7976.7646; val_edge_recon_loss: 291132.9062; val_gene_expr_recon_loss: 69008.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368118.6250; val_optim_loss: 368118.6250
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8450; val_auprc_score: 0.8466; val_best_acc_score: 0.7301; val_best_f1_score: 0.7726; train_kl_reg_loss: 8185.5521; train_edge_recon_loss: 289649.9500; train_gene_expr_recon_loss: 67238.1406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365073.6500; train_optim_loss: 365073.6500; val_kl_reg_loss: 8149.1211; val_edge_recon_loss: 296197.9688; val_gene_expr_recon_loss: 68674.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373021.7500; val_optim_loss: 373021.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8509; val_auprc_score: 0.8495; val_best_acc_score: 0.7463; val_best_f1_score: 0.7766; train_kl_reg_loss: 8015.2560; train_edge_recon_loss: 287316.6250; train_gene_expr_recon_loss: 66349.2164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361681.1000; train_optim_loss: 361681.1000; val_kl_reg_loss: 7998.6611; val_edge_recon_loss: 293572.4375; val_gene_expr_recon_loss: 68563.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 370134.1875; val_optim_loss: 370134.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8446; val_auprc_score: 0.8454; val_best_acc_score: 0.7322; val_best_f1_score: 0.7748; train_kl_reg_loss: 7963.3051; train_edge_recon_loss: 289491.8250; train_gene_expr_recon_loss: 66684.8414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 364139.9750; train_optim_loss: 364139.9750; val_kl_reg_loss: 8020.9106; val_edge_recon_loss: 297337.7188; val_gene_expr_recon_loss: 68427.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 373786.3750; val_optim_loss: 373786.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8558; val_auprc_score: 0.8549; val_best_acc_score: 0.7531; val_best_f1_score: 0.7772; train_kl_reg_loss: 7855.6553; train_edge_recon_loss: 291229.3063; train_gene_expr_recon_loss: 66689.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365774.5687; train_optim_loss: 365774.5687; val_kl_reg_loss: 7868.5967; val_edge_recon_loss: 292914.4688; val_gene_expr_recon_loss: 68359.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369143.0312; val_optim_loss: 369143.0312

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 7 sec.
Using best model state, which was in epoch 4.

--- MODEL EVALUATION ---
Val AUROC score: 0.8458
Val AUPRC score: 0.8489
Val best accuracy score: 0.7406
Val best F1 score: 0.7817
Val gene expr MSE score: 0.0115
Duration of model training in run 4: 0 hours, 0 minutes and 9 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 12735
Number of validation edges: 1415
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7774; val_auprc_score: 0.7890; val_best_acc_score: 0.6905; val_best_f1_score: 0.7263; train_kl_reg_loss: 164.4008; train_edge_recon_loss: 344619.5240; train_gene_expr_recon_loss: 74486.6196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419270.5457; train_optim_loss: 419270.5457; val_kl_reg_loss: 391.4967; val_edge_recon_loss: 365623.1406; val_gene_expr_recon_loss: 66864.7617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432879.4062; val_optim_loss: 432879.4062
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8494; val_auprc_score: 0.8553; val_best_acc_score: 0.7276; val_best_f1_score: 0.7665; train_kl_reg_loss: 931.5613; train_edge_recon_loss: 323967.9495; train_gene_expr_recon_loss: 69582.2960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394481.8029; train_optim_loss: 394481.8029; val_kl_reg_loss: 2712.7413; val_edge_recon_loss: 300655.7344; val_gene_expr_recon_loss: 66101.1914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369469.6562; val_optim_loss: 369469.6562
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8479; val_auprc_score: 0.8419; val_best_acc_score: 0.7470; val_best_f1_score: 0.7822; train_kl_reg_loss: 7557.9502; train_edge_recon_loss: 289923.3245; train_gene_expr_recon_loss: 67847.3954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 365328.6707; train_optim_loss: 365328.6707; val_kl_reg_loss: 8337.2393; val_edge_recon_loss: 288336.8906; val_gene_expr_recon_loss: 64943.0645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361617.1875; val_optim_loss: 361617.1875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8697; val_auprc_score: 0.8669; val_best_acc_score: 0.7608; val_best_f1_score: 0.7906; train_kl_reg_loss: 7196.3601; train_edge_recon_loss: 287093.3942; train_gene_expr_recon_loss: 67628.1187; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 361917.8774; train_optim_loss: 361917.8774; val_kl_reg_loss: 4387.8003; val_edge_recon_loss: 287489.4219; val_gene_expr_recon_loss: 63971.2207; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355848.4375; val_optim_loss: 355848.4375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8792; val_auprc_score: 0.8655; val_best_acc_score: 0.7887; val_best_f1_score: 0.8090; train_kl_reg_loss: 4131.4214; train_edge_recon_loss: 286483.6514; train_gene_expr_recon_loss: 67676.3768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 358291.4519; train_optim_loss: 358291.4519; val_kl_reg_loss: 3753.7366; val_edge_recon_loss: 279686.3281; val_gene_expr_recon_loss: 66006.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349446.7656; val_optim_loss: 349446.7656
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9056; val_auprc_score: 0.8845; val_best_acc_score: 0.8413; val_best_f1_score: 0.8564; train_kl_reg_loss: 4095.5870; train_edge_recon_loss: 278844.9062; train_gene_expr_recon_loss: 66566.8765; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349507.3702; train_optim_loss: 349507.3702; val_kl_reg_loss: 4094.3462; val_edge_recon_loss: 273324.4531; val_gene_expr_recon_loss: 63511.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340930.1094; val_optim_loss: 340930.1094
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9273; val_auprc_score: 0.9032; val_best_acc_score: 0.8622; val_best_f1_score: 0.8740; train_kl_reg_loss: 4632.9857; train_edge_recon_loss: 272268.5793; train_gene_expr_recon_loss: 66559.2779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 343460.8438; train_optim_loss: 343460.8438; val_kl_reg_loss: 4738.5151; val_edge_recon_loss: 270066.9531; val_gene_expr_recon_loss: 64658.0332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339463.5000; val_optim_loss: 339463.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9461; val_auprc_score: 0.9297; val_best_acc_score: 0.8890; val_best_f1_score: 0.8927; train_kl_reg_loss: 4570.6977; train_edge_recon_loss: 270751.1346; train_gene_expr_recon_loss: 66893.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342215.5913; train_optim_loss: 342215.5913; val_kl_reg_loss: 4099.9919; val_edge_recon_loss: 267554.9062; val_gene_expr_recon_loss: 64437.6738; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336092.5625; val_optim_loss: 336092.5625
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9482; val_auprc_score: 0.9386; val_best_acc_score: 0.8859; val_best_f1_score: 0.8900; train_kl_reg_loss: 4158.3803; train_edge_recon_loss: 268606.0024; train_gene_expr_recon_loss: 66250.3248; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339014.7043; train_optim_loss: 339014.7043; val_kl_reg_loss: 4110.3782; val_edge_recon_loss: 271594.8438; val_gene_expr_recon_loss: 64508.9824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 340214.2031; val_optim_loss: 340214.2031
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9546; val_auprc_score: 0.9321; val_best_acc_score: 0.9000; val_best_f1_score: 0.9063; train_kl_reg_loss: 4088.0106; train_edge_recon_loss: 266841.9207; train_gene_expr_recon_loss: 66240.4754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337170.4038; train_optim_loss: 337170.4038; val_kl_reg_loss: 4038.1572; val_edge_recon_loss: 268150.5312; val_gene_expr_recon_loss: 62027.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334215.9844; val_optim_loss: 334215.9844
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9592; val_auprc_score: 0.9420; val_best_acc_score: 0.9131; val_best_f1_score: 0.9174; train_kl_reg_loss: 4144.0798; train_edge_recon_loss: 265860.0841; train_gene_expr_recon_loss: 65994.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335998.4183; train_optim_loss: 335998.4183; val_kl_reg_loss: 4095.4457; val_edge_recon_loss: 263190.7500; val_gene_expr_recon_loss: 65446.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332733.1250; val_optim_loss: 332733.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9633; val_auprc_score: 0.9470; val_best_acc_score: 0.9138; val_best_f1_score: 0.9180; train_kl_reg_loss: 4160.9220; train_edge_recon_loss: 263770.7704; train_gene_expr_recon_loss: 65932.0718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333863.7644; train_optim_loss: 333863.7644; val_kl_reg_loss: 4158.0991; val_edge_recon_loss: 264000.4531; val_gene_expr_recon_loss: 61581.2070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329739.7500; val_optim_loss: 329739.7500
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9670; val_auprc_score: 0.9528; val_best_acc_score: 0.9219; val_best_f1_score: 0.9260; train_kl_reg_loss: 4152.9082; train_edge_recon_loss: 263350.5312; train_gene_expr_recon_loss: 66104.8074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333608.2500; train_optim_loss: 333608.2500; val_kl_reg_loss: 3965.4553; val_edge_recon_loss: 261659.3281; val_gene_expr_recon_loss: 65016.9160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330641.6875; val_optim_loss: 330641.6875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9652; val_auprc_score: 0.9454; val_best_acc_score: 0.9261; val_best_f1_score: 0.9292; train_kl_reg_loss: 4169.6721; train_edge_recon_loss: 261935.3341; train_gene_expr_recon_loss: 64814.0550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330919.0625; train_optim_loss: 330919.0625; val_kl_reg_loss: 4145.2903; val_edge_recon_loss: 265166.5234; val_gene_expr_recon_loss: 64348.6855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333660.5000; val_optim_loss: 333660.5000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9653; val_auprc_score: 0.9453; val_best_acc_score: 0.9265; val_best_f1_score: 0.9299; train_kl_reg_loss: 4130.4648; train_edge_recon_loss: 262102.0637; train_gene_expr_recon_loss: 65322.0799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331554.6106; train_optim_loss: 331554.6106; val_kl_reg_loss: 4028.1221; val_edge_recon_loss: 262513.2734; val_gene_expr_recon_loss: 62766.2168; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329307.5938; val_optim_loss: 329307.5938
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9661; val_auprc_score: 0.9492; val_best_acc_score: 0.9272; val_best_f1_score: 0.9306; train_kl_reg_loss: 4145.0947; train_edge_recon_loss: 262485.5709; train_gene_expr_recon_loss: 64944.5974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331575.2620; train_optim_loss: 331575.2620; val_kl_reg_loss: 4121.3188; val_edge_recon_loss: 261867.7891; val_gene_expr_recon_loss: 62458.5566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328447.6719; val_optim_loss: 328447.6719
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9693; val_auprc_score: 0.9487; val_best_acc_score: 0.9311; val_best_f1_score: 0.9344; train_kl_reg_loss: 4108.3897; train_edge_recon_loss: 262637.5156; train_gene_expr_recon_loss: 65236.5934; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331982.4952; train_optim_loss: 331982.4952; val_kl_reg_loss: 4019.8907; val_edge_recon_loss: 263362.0469; val_gene_expr_recon_loss: 63265.7852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330647.7188; val_optim_loss: 330647.7188
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9709; val_auprc_score: 0.9494; val_best_acc_score: 0.9357; val_best_f1_score: 0.9378; train_kl_reg_loss: 4071.6658; train_edge_recon_loss: 260877.8245; train_gene_expr_recon_loss: 65093.8735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330043.3678; train_optim_loss: 330043.3678; val_kl_reg_loss: 4094.9661; val_edge_recon_loss: 258327.1797; val_gene_expr_recon_loss: 64050.2383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326472.3906; val_optim_loss: 326472.3906
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9680; val_auprc_score: 0.9500; val_best_acc_score: 0.9283; val_best_f1_score: 0.9314; train_kl_reg_loss: 4107.4965; train_edge_recon_loss: 262066.7248; train_gene_expr_recon_loss: 64209.8528; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330384.0721; train_optim_loss: 330384.0721; val_kl_reg_loss: 3985.3542; val_edge_recon_loss: 264365.4844; val_gene_expr_recon_loss: 64230.9805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332581.8125; val_optim_loss: 332581.8125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9700; val_auprc_score: 0.9549; val_best_acc_score: 0.9360; val_best_f1_score: 0.9389; train_kl_reg_loss: 4058.9424; train_edge_recon_loss: 261476.9483; train_gene_expr_recon_loss: 64453.8753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329989.7668; train_optim_loss: 329989.7668; val_kl_reg_loss: 4019.4945; val_edge_recon_loss: 258133.2891; val_gene_expr_recon_loss: 61963.6973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324116.4844; val_optim_loss: 324116.4844
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9726; val_auprc_score: 0.9619; val_best_acc_score: 0.9332; val_best_f1_score: 0.9362; train_kl_reg_loss: 4052.1514; train_edge_recon_loss: 262901.8966; train_gene_expr_recon_loss: 64867.8047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331821.8510; train_optim_loss: 331821.8510; val_kl_reg_loss: 3955.4620; val_edge_recon_loss: 261922.9453; val_gene_expr_recon_loss: 63047.6133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328926.0156; val_optim_loss: 328926.0156
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9691; val_auprc_score: 0.9543; val_best_acc_score: 0.9332; val_best_f1_score: 0.9367; train_kl_reg_loss: 4007.1851; train_edge_recon_loss: 262207.4519; train_gene_expr_recon_loss: 64191.5379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330406.1755; train_optim_loss: 330406.1755; val_kl_reg_loss: 3969.6409; val_edge_recon_loss: 260995.9688; val_gene_expr_recon_loss: 61723.4746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326689.0781; val_optim_loss: 326689.0781
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9768; val_auprc_score: 0.9681; val_best_acc_score: 0.9410; val_best_f1_score: 0.9433; train_kl_reg_loss: 4044.1353; train_edge_recon_loss: 261321.2536; train_gene_expr_recon_loss: 63600.9814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328966.3702; train_optim_loss: 328966.3702; val_kl_reg_loss: 4017.1417; val_edge_recon_loss: 259379.2891; val_gene_expr_recon_loss: 63032.4980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326428.9219; val_optim_loss: 326428.9219

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9702; val_auprc_score: 0.9513; val_best_acc_score: 0.9360; val_best_f1_score: 0.9385; train_kl_reg_loss: 4050.2623; train_edge_recon_loss: 261584.5469; train_gene_expr_recon_loss: 64915.7680; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330550.5793; train_optim_loss: 330550.5793; val_kl_reg_loss: 4010.1548; val_edge_recon_loss: 261261.4453; val_gene_expr_recon_loss: 62422.2383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327693.8281; val_optim_loss: 327693.8281
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9755; val_auprc_score: 0.9646; val_best_acc_score: 0.9466; val_best_f1_score: 0.9482; train_kl_reg_loss: 4039.7821; train_edge_recon_loss: 261307.1731; train_gene_expr_recon_loss: 63963.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329310.8149; train_optim_loss: 329310.8149; val_kl_reg_loss: 3989.9025; val_edge_recon_loss: 258275.9375; val_gene_expr_recon_loss: 61277.2832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323543.1406; val_optim_loss: 323543.1406
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9740; val_auprc_score: 0.9643; val_best_acc_score: 0.9360; val_best_f1_score: 0.9387; train_kl_reg_loss: 4027.7700; train_edge_recon_loss: 262690.5300; train_gene_expr_recon_loss: 63241.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329959.7236; train_optim_loss: 329959.7236; val_kl_reg_loss: 3847.8875; val_edge_recon_loss: 264578.2344; val_gene_expr_recon_loss: 62068.1426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330494.2656; val_optim_loss: 330494.2656
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9703; val_auprc_score: 0.9565; val_best_acc_score: 0.9314; val_best_f1_score: 0.9345; train_kl_reg_loss: 3987.1858; train_edge_recon_loss: 261042.6358; train_gene_expr_recon_loss: 63786.0877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328815.9135; train_optim_loss: 328815.9135; val_kl_reg_loss: 3826.1111; val_edge_recon_loss: 263810.7500; val_gene_expr_recon_loss: 62061.3164; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329698.1875; val_optim_loss: 329698.1875
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9709; val_auprc_score: 0.9504; val_best_acc_score: 0.9392; val_best_f1_score: 0.9416; train_kl_reg_loss: 3948.1084; train_edge_recon_loss: 261608.3786; train_gene_expr_recon_loss: 63170.0871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328726.5745; train_optim_loss: 328726.5745; val_kl_reg_loss: 3726.8309; val_edge_recon_loss: 260178.0859; val_gene_expr_recon_loss: 62944.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326849.2500; val_optim_loss: 326849.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9773; val_auprc_score: 0.9635; val_best_acc_score: 0.9435; val_best_f1_score: 0.9455; train_kl_reg_loss: 3905.2678; train_edge_recon_loss: 262086.5012; train_gene_expr_recon_loss: 64313.6881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330305.4543; train_optim_loss: 330305.4543; val_kl_reg_loss: 3735.8253; val_edge_recon_loss: 259468.2109; val_gene_expr_recon_loss: 64102.5176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327306.5625; val_optim_loss: 327306.5625
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9716; val_auprc_score: 0.9511; val_best_acc_score: 0.9385; val_best_f1_score: 0.9410; train_kl_reg_loss: 3896.5392; train_edge_recon_loss: 260925.1118; train_gene_expr_recon_loss: 62978.4793; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327800.1250; train_optim_loss: 327800.1250; val_kl_reg_loss: 3738.3064; val_edge_recon_loss: 261097.6953; val_gene_expr_recon_loss: 62909.9355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327745.9375; val_optim_loss: 327745.9375
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9738; val_auprc_score: 0.9571; val_best_acc_score: 0.9413; val_best_f1_score: 0.9435; train_kl_reg_loss: 3890.4298; train_edge_recon_loss: 260932.3293; train_gene_expr_recon_loss: 63433.2100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328255.9712; train_optim_loss: 328255.9712; val_kl_reg_loss: 3723.0192; val_edge_recon_loss: 261062.2109; val_gene_expr_recon_loss: 62335.7402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327120.9688; val_optim_loss: 327120.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 49 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9697
Val AUPRC score: 0.9533
Val best accuracy score: 0.9346
Val best F1 score: 0.9373
Val gene expr MSE score: 0.0094
Duration of model training in run 5: 0 hours, 0 minutes and 51 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 12735
Number of validation edges: 1415
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8003; val_auprc_score: 0.8040; val_best_acc_score: 0.7046; val_best_f1_score: 0.7454; train_kl_reg_loss: 177.1724; train_edge_recon_loss: 345028.5938; train_gene_expr_recon_loss: 74343.2272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419548.9976; train_optim_loss: 419548.9976; val_kl_reg_loss: 366.3898; val_edge_recon_loss: 347713.4531; val_gene_expr_recon_loss: 66309.1211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414388.9531; val_optim_loss: 414388.9531
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8427; val_auprc_score: 0.8424; val_best_acc_score: 0.7265; val_best_f1_score: 0.7712; train_kl_reg_loss: 1049.6707; train_edge_recon_loss: 320796.7260; train_gene_expr_recon_loss: 69285.2849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391131.6779; train_optim_loss: 391131.6779; val_kl_reg_loss: 3215.2893; val_edge_recon_loss: 297799.2344; val_gene_expr_recon_loss: 67212.0664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 368226.5781; val_optim_loss: 368226.5781
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8560; val_auprc_score: 0.8530; val_best_acc_score: 0.7481; val_best_f1_score: 0.7750; train_kl_reg_loss: 6687.9800; train_edge_recon_loss: 292328.6010; train_gene_expr_recon_loss: 68506.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 367523.2668; train_optim_loss: 367523.2668; val_kl_reg_loss: 6660.4141; val_edge_recon_loss: 298240.1094; val_gene_expr_recon_loss: 66280.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371181.1719; val_optim_loss: 371181.1719
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8734; val_auprc_score: 0.8736; val_best_acc_score: 0.7537; val_best_f1_score: 0.7809; train_kl_reg_loss: 5614.0145; train_edge_recon_loss: 290421.3365; train_gene_expr_recon_loss: 67573.4570; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363608.8029; train_optim_loss: 363608.8029; val_kl_reg_loss: 3757.9839; val_edge_recon_loss: 292240.9062; val_gene_expr_recon_loss: 65834.2871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 361833.1719; val_optim_loss: 361833.1719
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8723; val_auprc_score: 0.8617; val_best_acc_score: 0.7678; val_best_f1_score: 0.7941; train_kl_reg_loss: 3598.1057; train_edge_recon_loss: 289049.5120; train_gene_expr_recon_loss: 67256.3188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 359903.9375; train_optim_loss: 359903.9375; val_kl_reg_loss: 3762.9387; val_edge_recon_loss: 290049.5625; val_gene_expr_recon_loss: 65833.6074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 359646.1094; val_optim_loss: 359646.1094
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8847; val_auprc_score: 0.8557; val_best_acc_score: 0.8113; val_best_f1_score: 0.8244; train_kl_reg_loss: 4204.6995; train_edge_recon_loss: 282779.8438; train_gene_expr_recon_loss: 67215.6562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354200.1971; train_optim_loss: 354200.1971; val_kl_reg_loss: 4147.5320; val_edge_recon_loss: 276779.9844; val_gene_expr_recon_loss: 66092.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347020.4062; val_optim_loss: 347020.4062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9163; val_auprc_score: 0.8935; val_best_acc_score: 0.8396; val_best_f1_score: 0.8565; train_kl_reg_loss: 4228.0821; train_edge_recon_loss: 275192.0048; train_gene_expr_recon_loss: 66736.6848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346156.7692; train_optim_loss: 346156.7692; val_kl_reg_loss: 3912.4271; val_edge_recon_loss: 278010.6406; val_gene_expr_recon_loss: 63834.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345757.7188; val_optim_loss: 345757.7188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9310; val_auprc_score: 0.9069; val_best_acc_score: 0.8664; val_best_f1_score: 0.8740; train_kl_reg_loss: 4136.4520; train_edge_recon_loss: 271785.5312; train_gene_expr_recon_loss: 66263.0433; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 342185.0288; train_optim_loss: 342185.0288; val_kl_reg_loss: 4147.2107; val_edge_recon_loss: 273109.7344; val_gene_expr_recon_loss: 65466.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342723.5312; val_optim_loss: 342723.5312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9455; val_auprc_score: 0.9171; val_best_acc_score: 0.8862; val_best_f1_score: 0.8926; train_kl_reg_loss: 4206.9698; train_edge_recon_loss: 269263.1058; train_gene_expr_recon_loss: 66369.3843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339839.4639; train_optim_loss: 339839.4639; val_kl_reg_loss: 3990.4113; val_edge_recon_loss: 269833.8594; val_gene_expr_recon_loss: 65770.6934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339594.9688; val_optim_loss: 339594.9688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9524; val_auprc_score: 0.9339; val_best_acc_score: 0.9004; val_best_f1_score: 0.9042; train_kl_reg_loss: 4003.4137; train_edge_recon_loss: 268517.3341; train_gene_expr_recon_loss: 66723.6400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 339244.3846; train_optim_loss: 339244.3846; val_kl_reg_loss: 4011.3600; val_edge_recon_loss: 270614.2188; val_gene_expr_recon_loss: 64294.7383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338920.3281; val_optim_loss: 338920.3281
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9548; val_auprc_score: 0.9389; val_best_acc_score: 0.9032; val_best_f1_score: 0.9076; train_kl_reg_loss: 4084.7211; train_edge_recon_loss: 266570.7764; train_gene_expr_recon_loss: 66701.9666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337357.4615; train_optim_loss: 337357.4615; val_kl_reg_loss: 4092.7145; val_edge_recon_loss: 269652.6562; val_gene_expr_recon_loss: 65267.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 339012.3750; val_optim_loss: 339012.3750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9577; val_auprc_score: 0.9311; val_best_acc_score: 0.9099; val_best_f1_score: 0.9129; train_kl_reg_loss: 4126.9662; train_edge_recon_loss: 263476.5853; train_gene_expr_recon_loss: 65828.3879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333431.9447; train_optim_loss: 333431.9447; val_kl_reg_loss: 4076.2955; val_edge_recon_loss: 267428.1875; val_gene_expr_recon_loss: 64075.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 335580.1406; val_optim_loss: 335580.1406
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9608; val_auprc_score: 0.9494; val_best_acc_score: 0.9159; val_best_f1_score: 0.9197; train_kl_reg_loss: 4065.0311; train_edge_recon_loss: 263284.6466; train_gene_expr_recon_loss: 65643.7350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332993.4183; train_optim_loss: 332993.4183; val_kl_reg_loss: 4103.9941; val_edge_recon_loss: 261903.8750; val_gene_expr_recon_loss: 63875.0508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329882.9219; val_optim_loss: 329882.9219
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9621; val_auprc_score: 0.9451; val_best_acc_score: 0.9184; val_best_f1_score: 0.9229; train_kl_reg_loss: 4168.9392; train_edge_recon_loss: 263531.0000; train_gene_expr_recon_loss: 65599.7518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333299.6875; train_optim_loss: 333299.6875; val_kl_reg_loss: 4141.7510; val_edge_recon_loss: 262778.9062; val_gene_expr_recon_loss: 63045.1289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329965.7812; val_optim_loss: 329965.7812
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9609; val_auprc_score: 0.9456; val_best_acc_score: 0.9092; val_best_f1_score: 0.9151; train_kl_reg_loss: 4152.1364; train_edge_recon_loss: 263205.7620; train_gene_expr_recon_loss: 64744.8891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332102.7861; train_optim_loss: 332102.7861; val_kl_reg_loss: 4014.5560; val_edge_recon_loss: 265537.5938; val_gene_expr_recon_loss: 64558.0566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334110.2031; val_optim_loss: 334110.2031
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9621; val_auprc_score: 0.9430; val_best_acc_score: 0.9166; val_best_f1_score: 0.9215; train_kl_reg_loss: 4089.3767; train_edge_recon_loss: 262221.9255; train_gene_expr_recon_loss: 65244.4378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331555.7428; train_optim_loss: 331555.7428; val_kl_reg_loss: 4042.0535; val_edge_recon_loss: 264478.7656; val_gene_expr_recon_loss: 64073.2695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332594.1094; val_optim_loss: 332594.1094

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9660; val_auprc_score: 0.9390; val_best_acc_score: 0.9254; val_best_f1_score: 0.9279; train_kl_reg_loss: 4100.0244; train_edge_recon_loss: 261918.7175; train_gene_expr_recon_loss: 65049.8428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331068.5841; train_optim_loss: 331068.5841; val_kl_reg_loss: 4053.0282; val_edge_recon_loss: 260516.1406; val_gene_expr_recon_loss: 63546.5762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328115.7500; val_optim_loss: 328115.7500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9724; val_auprc_score: 0.9595; val_best_acc_score: 0.9329; val_best_f1_score: 0.9339; train_kl_reg_loss: 4087.4136; train_edge_recon_loss: 263184.5757; train_gene_expr_recon_loss: 64147.1980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331419.1923; train_optim_loss: 331419.1923; val_kl_reg_loss: 4033.6938; val_edge_recon_loss: 259227.8750; val_gene_expr_recon_loss: 63594.3965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326855.9688; val_optim_loss: 326855.9688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9743; val_auprc_score: 0.9594; val_best_acc_score: 0.9339; val_best_f1_score: 0.9370; train_kl_reg_loss: 4081.6382; train_edge_recon_loss: 262182.7127; train_gene_expr_recon_loss: 64050.8552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330315.2091; train_optim_loss: 330315.2091; val_kl_reg_loss: 4032.0315; val_edge_recon_loss: 257392.8125; val_gene_expr_recon_loss: 62645.9551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324070.8125; val_optim_loss: 324070.8125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9655; val_auprc_score: 0.9463; val_best_acc_score: 0.9258; val_best_f1_score: 0.9299; train_kl_reg_loss: 4092.0497; train_edge_recon_loss: 262911.5325; train_gene_expr_recon_loss: 64553.1148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331556.6971; train_optim_loss: 331556.6971; val_kl_reg_loss: 4031.7168; val_edge_recon_loss: 263428.1484; val_gene_expr_recon_loss: 61071.4258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328531.2969; val_optim_loss: 328531.2969
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9696; val_auprc_score: 0.9546; val_best_acc_score: 0.9261; val_best_f1_score: 0.9301; train_kl_reg_loss: 4075.4477; train_edge_recon_loss: 261349.0529; train_gene_expr_recon_loss: 64201.3278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329625.8269; train_optim_loss: 329625.8269; val_kl_reg_loss: 4035.5978; val_edge_recon_loss: 261047.3359; val_gene_expr_recon_loss: 65354.4902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330437.4375; val_optim_loss: 330437.4375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9725; val_auprc_score: 0.9580; val_best_acc_score: 0.9276; val_best_f1_score: 0.9315; train_kl_reg_loss: 4096.9791; train_edge_recon_loss: 261417.4555; train_gene_expr_recon_loss: 64679.6587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330194.0962; train_optim_loss: 330194.0962; val_kl_reg_loss: 4046.0300; val_edge_recon_loss: 261438.0703; val_gene_expr_recon_loss: 64530.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330014.8125; val_optim_loss: 330014.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9717; val_auprc_score: 0.9556; val_best_acc_score: 0.9300; val_best_f1_score: 0.9320; train_kl_reg_loss: 4092.1455; train_edge_recon_loss: 262246.8305; train_gene_expr_recon_loss: 63959.5916; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330298.5673; train_optim_loss: 330298.5673; val_kl_reg_loss: 4061.5249; val_edge_recon_loss: 256855.3516; val_gene_expr_recon_loss: 64814.2227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325731.0938; val_optim_loss: 325731.0938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9700; val_auprc_score: 0.9528; val_best_acc_score: 0.9254; val_best_f1_score: 0.9296; train_kl_reg_loss: 4097.6765; train_edge_recon_loss: 261350.8822; train_gene_expr_recon_loss: 64453.0246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329901.5841; train_optim_loss: 329901.5841; val_kl_reg_loss: 4017.0458; val_edge_recon_loss: 261936.1328; val_gene_expr_recon_loss: 60039.3730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325992.5469; val_optim_loss: 325992.5469
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9694; val_auprc_score: 0.9575; val_best_acc_score: 0.9269; val_best_f1_score: 0.9309; train_kl_reg_loss: 4082.6374; train_edge_recon_loss: 262771.6070; train_gene_expr_recon_loss: 64139.9775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330994.2188; train_optim_loss: 330994.2188; val_kl_reg_loss: 4039.7388; val_edge_recon_loss: 260052.5312; val_gene_expr_recon_loss: 63642.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327734.5469; val_optim_loss: 327734.5469

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 34 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9712
Val AUPRC score: 0.9603
Val best accuracy score: 0.9219
Val best F1 score: 0.9268
Val gene expr MSE score: 0.0101
Duration of model training in run 6: 0 hours, 0 minutes and 36 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 16983
Number of validation edges: 1886
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8407; val_auprc_score: 0.8347; val_best_acc_score: 0.7338; val_best_f1_score: 0.7758; train_kl_reg_loss: 1123.8210; train_edge_recon_loss: 328121.0074; train_gene_expr_recon_loss: 70839.7779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400084.6066; train_optim_loss: 400084.6066; val_kl_reg_loss: 6768.6663; val_edge_recon_loss: 292286.9219; val_gene_expr_recon_loss: 70057.3145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 369112.8984; val_optim_loss: 369112.8984
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8758; val_auprc_score: 0.8737; val_best_acc_score: 0.7633; val_best_f1_score: 0.7959; train_kl_reg_loss: 5972.9558; train_edge_recon_loss: 290711.8134; train_gene_expr_recon_loss: 67293.1101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 363977.8833; train_optim_loss: 363977.8833; val_kl_reg_loss: 4079.8794; val_edge_recon_loss: 287751.7500; val_gene_expr_recon_loss: 66595.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358427.4688; val_optim_loss: 358427.4688
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9268; val_auprc_score: 0.8982; val_best_acc_score: 0.8696; val_best_f1_score: 0.8762; train_kl_reg_loss: 4244.5328; train_edge_recon_loss: 278240.5414; train_gene_expr_recon_loss: 66516.4229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349001.4982; train_optim_loss: 349001.4982; val_kl_reg_loss: 4665.5538; val_edge_recon_loss: 270330.2891; val_gene_expr_recon_loss: 67599.9131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342595.7500; val_optim_loss: 342595.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9384; val_auprc_score: 0.9197; val_best_acc_score: 0.8765; val_best_f1_score: 0.8833; train_kl_reg_loss: 4329.4264; train_edge_recon_loss: 271223.8396; train_gene_expr_recon_loss: 66297.0398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 341850.3051; train_optim_loss: 341850.3051; val_kl_reg_loss: 3982.0142; val_edge_recon_loss: 267914.0781; val_gene_expr_recon_loss: 66598.1855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 338494.2812; val_optim_loss: 338494.2812
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9533; val_auprc_score: 0.9279; val_best_acc_score: 0.9064; val_best_f1_score: 0.9109; train_kl_reg_loss: 4008.4180; train_edge_recon_loss: 268096.7881; train_gene_expr_recon_loss: 65592.8841; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337698.0901; train_optim_loss: 337698.0901; val_kl_reg_loss: 4169.3708; val_edge_recon_loss: 262016.9922; val_gene_expr_recon_loss: 65997.7051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332184.0703; val_optim_loss: 332184.0703
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9610; val_auprc_score: 0.9483; val_best_acc_score: 0.9125; val_best_f1_score: 0.9170; train_kl_reg_loss: 4097.9768; train_edge_recon_loss: 264389.7592; train_gene_expr_recon_loss: 65556.9262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334044.6664; train_optim_loss: 334044.6664; val_kl_reg_loss: 3979.6281; val_edge_recon_loss: 261845.5547; val_gene_expr_recon_loss: 65236.6748; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331061.8594; val_optim_loss: 331061.8594
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9630; val_auprc_score: 0.9390; val_best_acc_score: 0.9202; val_best_f1_score: 0.9238; train_kl_reg_loss: 4112.9937; train_edge_recon_loss: 263818.0625; train_gene_expr_recon_loss: 65289.2099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333220.2684; train_optim_loss: 333220.2684; val_kl_reg_loss: 4165.1916; val_edge_recon_loss: 261773.7578; val_gene_expr_recon_loss: 66439.3535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332378.3047; val_optim_loss: 332378.3047
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9664; val_auprc_score: 0.9468; val_best_acc_score: 0.9266; val_best_f1_score: 0.9300; train_kl_reg_loss: 4086.8356; train_edge_recon_loss: 261602.6847; train_gene_expr_recon_loss: 64957.5533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330647.0708; train_optim_loss: 330647.0708; val_kl_reg_loss: 4065.7261; val_edge_recon_loss: 260452.0625; val_gene_expr_recon_loss: 65947.7607; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330465.5391; val_optim_loss: 330465.5391
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9734; val_auprc_score: 0.9598; val_best_acc_score: 0.9327; val_best_f1_score: 0.9348; train_kl_reg_loss: 4108.3268; train_edge_recon_loss: 261873.7725; train_gene_expr_recon_loss: 64711.2892; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330693.3934; train_optim_loss: 330693.3934; val_kl_reg_loss: 4018.1807; val_edge_recon_loss: 259059.9453; val_gene_expr_recon_loss: 66008.9951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329087.1172; val_optim_loss: 329087.1172
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9702; val_auprc_score: 0.9534; val_best_acc_score: 0.9332; val_best_f1_score: 0.9364; train_kl_reg_loss: 4030.5855; train_edge_recon_loss: 262213.5142; train_gene_expr_recon_loss: 64147.0385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330391.1379; train_optim_loss: 330391.1379; val_kl_reg_loss: 4023.9677; val_edge_recon_loss: 259721.9492; val_gene_expr_recon_loss: 64998.4170; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328744.3359; val_optim_loss: 328744.3359
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9700; val_auprc_score: 0.9553; val_best_acc_score: 0.9292; val_best_f1_score: 0.9326; train_kl_reg_loss: 4027.3910; train_edge_recon_loss: 261682.5142; train_gene_expr_recon_loss: 64073.0348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329782.9412; train_optim_loss: 329782.9412; val_kl_reg_loss: 4057.4799; val_edge_recon_loss: 262217.7188; val_gene_expr_recon_loss: 65880.4570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332155.6641; val_optim_loss: 332155.6641
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9711; val_auprc_score: 0.9545; val_best_acc_score: 0.9340; val_best_f1_score: 0.9368; train_kl_reg_loss: 4053.5685; train_edge_recon_loss: 262199.3833; train_gene_expr_recon_loss: 63873.0308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330125.9825; train_optim_loss: 330125.9825; val_kl_reg_loss: 3918.7181; val_edge_recon_loss: 259574.0000; val_gene_expr_recon_loss: 65415.6035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328908.3359; val_optim_loss: 328908.3359
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9794; val_auprc_score: 0.9674; val_best_acc_score: 0.9443; val_best_f1_score: 0.9467; train_kl_reg_loss: 3989.1323; train_edge_recon_loss: 261917.8934; train_gene_expr_recon_loss: 63849.9771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329757.0009; train_optim_loss: 329757.0009; val_kl_reg_loss: 3884.7491; val_edge_recon_loss: 258152.0234; val_gene_expr_recon_loss: 64801.3730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326838.1484; val_optim_loss: 326838.1484
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9739; val_auprc_score: 0.9581; val_best_acc_score: 0.9332; val_best_f1_score: 0.9356; train_kl_reg_loss: 4003.3803; train_edge_recon_loss: 261970.1691; train_gene_expr_recon_loss: 63695.9820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329669.5285; train_optim_loss: 329669.5285; val_kl_reg_loss: 3999.3017; val_edge_recon_loss: 260414.6992; val_gene_expr_recon_loss: 64368.5117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328782.5078; val_optim_loss: 328782.5078
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9772; val_auprc_score: 0.9662; val_best_acc_score: 0.9414; val_best_f1_score: 0.9438; train_kl_reg_loss: 3987.6385; train_edge_recon_loss: 260891.7840; train_gene_expr_recon_loss: 63204.6051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328084.0294; train_optim_loss: 328084.0294; val_kl_reg_loss: 4051.3210; val_edge_recon_loss: 258477.3281; val_gene_expr_recon_loss: 64062.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326591.2969; val_optim_loss: 326591.2969
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9767; val_auprc_score: 0.9657; val_best_acc_score: 0.9396; val_best_f1_score: 0.9423; train_kl_reg_loss: 4038.1909; train_edge_recon_loss: 260773.1967; train_gene_expr_recon_loss: 63518.4227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328329.8107; train_optim_loss: 328329.8107; val_kl_reg_loss: 4007.1799; val_edge_recon_loss: 259824.4766; val_gene_expr_recon_loss: 63690.9863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327522.6406; val_optim_loss: 327522.6406
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9807; val_auprc_score: 0.9644; val_best_acc_score: 0.9499; val_best_f1_score: 0.9513; train_kl_reg_loss: 4020.5087; train_edge_recon_loss: 259533.5786; train_gene_expr_recon_loss: 63565.0200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327119.1066; train_optim_loss: 327119.1066; val_kl_reg_loss: 4059.0760; val_edge_recon_loss: 257336.7461; val_gene_expr_recon_loss: 64349.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325745.4062; val_optim_loss: 325745.4062
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9815; val_auprc_score: 0.9671; val_best_acc_score: 0.9520; val_best_f1_score: 0.9534; train_kl_reg_loss: 4057.6559; train_edge_recon_loss: 259467.4642; train_gene_expr_recon_loss: 62747.2345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326272.3566; train_optim_loss: 326272.3566; val_kl_reg_loss: 4034.4628; val_edge_recon_loss: 259386.0117; val_gene_expr_recon_loss: 63796.7373; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327217.2031; val_optim_loss: 327217.2031
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9781; val_auprc_score: 0.9664; val_best_acc_score: 0.9433; val_best_f1_score: 0.9453; train_kl_reg_loss: 4063.4283; train_edge_recon_loss: 259720.5666; train_gene_expr_recon_loss: 62766.7310; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326550.7261; train_optim_loss: 326550.7261; val_kl_reg_loss: 3985.7884; val_edge_recon_loss: 260464.1406; val_gene_expr_recon_loss: 63148.8447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327598.7734; val_optim_loss: 327598.7734
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9808; val_auprc_score: 0.9662; val_best_acc_score: 0.9539; val_best_f1_score: 0.9552; train_kl_reg_loss: 4038.1905; train_edge_recon_loss: 260099.1503; train_gene_expr_recon_loss: 62620.5684; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326757.9118; train_optim_loss: 326757.9118; val_kl_reg_loss: 4048.4897; val_edge_recon_loss: 260226.7031; val_gene_expr_recon_loss: 63331.2949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327606.4922; val_optim_loss: 327606.4922

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9780; val_auprc_score: 0.9657; val_best_acc_score: 0.9454; val_best_f1_score: 0.9473; train_kl_reg_loss: 4019.6691; train_edge_recon_loss: 259536.9223; train_gene_expr_recon_loss: 62000.3417; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325556.9292; train_optim_loss: 325556.9292; val_kl_reg_loss: 4020.3433; val_edge_recon_loss: 261967.2227; val_gene_expr_recon_loss: 63187.6270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 329175.1953; val_optim_loss: 329175.1953
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9785; val_auprc_score: 0.9588; val_best_acc_score: 0.9557; val_best_f1_score: 0.9571; train_kl_reg_loss: 4034.0552; train_edge_recon_loss: 258855.8837; train_gene_expr_recon_loss: 61504.4388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324394.3805; train_optim_loss: 324394.3805; val_kl_reg_loss: 4016.2401; val_edge_recon_loss: 256904.6094; val_gene_expr_recon_loss: 63349.5840; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324270.4297; val_optim_loss: 324270.4297
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9789; val_auprc_score: 0.9619; val_best_acc_score: 0.9520; val_best_f1_score: 0.9534; train_kl_reg_loss: 4054.5279; train_edge_recon_loss: 259133.4292; train_gene_expr_recon_loss: 61990.4218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325178.3741; train_optim_loss: 325178.3741; val_kl_reg_loss: 4068.5162; val_edge_recon_loss: 259076.2070; val_gene_expr_recon_loss: 62876.1504; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326020.8750; val_optim_loss: 326020.8750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9853; val_auprc_score: 0.9798; val_best_acc_score: 0.9584; val_best_f1_score: 0.9597; train_kl_reg_loss: 4048.2949; train_edge_recon_loss: 259307.3199; train_gene_expr_recon_loss: 61734.5198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325090.1324; train_optim_loss: 325090.1324; val_kl_reg_loss: 4034.2941; val_edge_recon_loss: 254587.9141; val_gene_expr_recon_loss: 61985.6465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320607.8594; val_optim_loss: 320607.8594
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9848; val_auprc_score: 0.9762; val_best_acc_score: 0.9549; val_best_f1_score: 0.9565; train_kl_reg_loss: 4046.3247; train_edge_recon_loss: 259263.9972; train_gene_expr_recon_loss: 61849.7900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325160.1103; train_optim_loss: 325160.1103; val_kl_reg_loss: 4049.7813; val_edge_recon_loss: 257423.2188; val_gene_expr_recon_loss: 61812.7939; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323285.7891; val_optim_loss: 323285.7891
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9815; val_auprc_score: 0.9698; val_best_acc_score: 0.9539; val_best_f1_score: 0.9551; train_kl_reg_loss: 4009.7542; train_edge_recon_loss: 258464.4375; train_gene_expr_recon_loss: 61898.1118; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324372.3070; train_optim_loss: 324372.3070; val_kl_reg_loss: 3746.5238; val_edge_recon_loss: 255902.2109; val_gene_expr_recon_loss: 63558.3223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323207.0625; val_optim_loss: 323207.0625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9825; val_auprc_score: 0.9686; val_best_acc_score: 0.9597; val_best_f1_score: 0.9609; train_kl_reg_loss: 3852.4151; train_edge_recon_loss: 259208.4729; train_gene_expr_recon_loss: 61700.7771; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324761.6654; train_optim_loss: 324761.6654; val_kl_reg_loss: 3613.4411; val_edge_recon_loss: 257661.3750; val_gene_expr_recon_loss: 62632.0146; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323906.8359; val_optim_loss: 323906.8359

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9809; val_auprc_score: 0.9652; val_best_acc_score: 0.9528; val_best_f1_score: 0.9545; train_kl_reg_loss: 3801.2799; train_edge_recon_loss: 258599.6880; train_gene_expr_recon_loss: 61874.0920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324275.0625; train_optim_loss: 324275.0625; val_kl_reg_loss: 3619.9802; val_edge_recon_loss: 257579.9883; val_gene_expr_recon_loss: 63893.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325093.8516; val_optim_loss: 325093.8516
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9851; val_auprc_score: 0.9802; val_best_acc_score: 0.9549; val_best_f1_score: 0.9565; train_kl_reg_loss: 3790.6953; train_edge_recon_loss: 259271.9642; train_gene_expr_recon_loss: 61728.9012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324791.5634; train_optim_loss: 324791.5634; val_kl_reg_loss: 3602.6180; val_edge_recon_loss: 257771.2188; val_gene_expr_recon_loss: 62131.9277; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323505.7656; val_optim_loss: 323505.7656
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9831; val_auprc_score: 0.9731; val_best_acc_score: 0.9541; val_best_f1_score: 0.9557; train_kl_reg_loss: 3782.2637; train_edge_recon_loss: 259134.6273; train_gene_expr_recon_loss: 61585.9089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324502.8015; train_optim_loss: 324502.8015; val_kl_reg_loss: 3589.8477; val_edge_recon_loss: 255904.9492; val_gene_expr_recon_loss: 62251.2197; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321746.0156; val_optim_loss: 321746.0156

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 32 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9760
Val AUPRC score: 0.9576
Val best accuracy score: 0.9486
Val best F1 score: 0.9506
Val gene expr MSE score: 0.0097
Duration of model training in run 7: 0 hours, 1 minutes and 35 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 16983
Number of validation edges: 1886
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8424; val_auprc_score: 0.8415; val_best_acc_score: 0.7285; val_best_f1_score: 0.7737; train_kl_reg_loss: 922.3214; train_edge_recon_loss: 329527.3392; train_gene_expr_recon_loss: 70969.8617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401419.5239; train_optim_loss: 401419.5239; val_kl_reg_loss: 6221.2194; val_edge_recon_loss: 297166.0547; val_gene_expr_recon_loss: 68334.4658; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 371721.7344; val_optim_loss: 371721.7344
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8930; val_auprc_score: 0.8868; val_best_acc_score: 0.7704; val_best_f1_score: 0.7976; train_kl_reg_loss: 6166.6480; train_edge_recon_loss: 289454.9136; train_gene_expr_recon_loss: 67314.9431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 362936.5055; train_optim_loss: 362936.5055; val_kl_reg_loss: 3586.2714; val_edge_recon_loss: 286740.6562; val_gene_expr_recon_loss: 66433.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 356760.8594; val_optim_loss: 356760.8594
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8962; val_auprc_score: 0.8728; val_best_acc_score: 0.8256; val_best_f1_score: 0.8467; train_kl_reg_loss: 3849.4528; train_edge_recon_loss: 281792.1094; train_gene_expr_recon_loss: 66531.6961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 352173.2564; train_optim_loss: 352173.2564; val_kl_reg_loss: 4023.8804; val_edge_recon_loss: 275971.5781; val_gene_expr_recon_loss: 65234.8936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345230.3438; val_optim_loss: 345230.3438
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9366; val_auprc_score: 0.9144; val_best_acc_score: 0.8730; val_best_f1_score: 0.8818; train_kl_reg_loss: 3950.4655; train_edge_recon_loss: 273185.6866; train_gene_expr_recon_loss: 66553.0009; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 343689.1517; train_optim_loss: 343689.1517; val_kl_reg_loss: 3865.4451; val_edge_recon_loss: 267264.0312; val_gene_expr_recon_loss: 63467.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334597.0547; val_optim_loss: 334597.0547
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9556; val_auprc_score: 0.9363; val_best_acc_score: 0.9035; val_best_f1_score: 0.9080; train_kl_reg_loss: 3929.9718; train_edge_recon_loss: 268529.2877; train_gene_expr_recon_loss: 66261.6569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338720.9145; train_optim_loss: 338720.9145; val_kl_reg_loss: 4113.9707; val_edge_recon_loss: 263631.1797; val_gene_expr_recon_loss: 65236.7861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 332981.9453; val_optim_loss: 332981.9453
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9614; val_auprc_score: 0.9429; val_best_acc_score: 0.9173; val_best_f1_score: 0.9212; train_kl_reg_loss: 4142.5798; train_edge_recon_loss: 265984.2937; train_gene_expr_recon_loss: 65448.4391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 335575.3116; train_optim_loss: 335575.3116; val_kl_reg_loss: 4130.3578; val_edge_recon_loss: 265639.9297; val_gene_expr_recon_loss: 64910.9648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 334681.2500; val_optim_loss: 334681.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9628; val_auprc_score: 0.9449; val_best_acc_score: 0.9210; val_best_f1_score: 0.9248; train_kl_reg_loss: 4085.1452; train_edge_recon_loss: 263941.6958; train_gene_expr_recon_loss: 65481.3247; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 333508.1654; train_optim_loss: 333508.1654; val_kl_reg_loss: 4048.3326; val_edge_recon_loss: 263657.0820; val_gene_expr_recon_loss: 63561.1279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331266.5469; val_optim_loss: 331266.5469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9713; val_auprc_score: 0.9580; val_best_acc_score: 0.9276; val_best_f1_score: 0.9314; train_kl_reg_loss: 4122.7740; train_edge_recon_loss: 262766.9269; train_gene_expr_recon_loss: 64831.3436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331721.0460; train_optim_loss: 331721.0460; val_kl_reg_loss: 4057.3548; val_edge_recon_loss: 261949.3203; val_gene_expr_recon_loss: 64551.3545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330558.0234; val_optim_loss: 330558.0234
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9712; val_auprc_score: 0.9616; val_best_acc_score: 0.9316; val_best_f1_score: 0.9354; train_kl_reg_loss: 4085.1224; train_edge_recon_loss: 261789.2491; train_gene_expr_recon_loss: 64657.3282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 330531.6985; train_optim_loss: 330531.6985; val_kl_reg_loss: 4100.5606; val_edge_recon_loss: 260964.4062; val_gene_expr_recon_loss: 65180.6582; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330245.6172; val_optim_loss: 330245.6172
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9732; val_auprc_score: 0.9626; val_best_acc_score: 0.9350; val_best_f1_score: 0.9379; train_kl_reg_loss: 4061.1816; train_edge_recon_loss: 260843.2284; train_gene_expr_recon_loss: 64544.4648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329448.8741; train_optim_loss: 329448.8741; val_kl_reg_loss: 4015.9705; val_edge_recon_loss: 260914.2773; val_gene_expr_recon_loss: 62552.2002; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327482.4453; val_optim_loss: 327482.4453
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9772; val_auprc_score: 0.9633; val_best_acc_score: 0.9430; val_best_f1_score: 0.9449; train_kl_reg_loss: 4093.8120; train_edge_recon_loss: 259994.5561; train_gene_expr_recon_loss: 64234.5910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328322.9577; train_optim_loss: 328322.9577; val_kl_reg_loss: 4045.0925; val_edge_recon_loss: 258703.6133; val_gene_expr_recon_loss: 63740.5020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326489.2109; val_optim_loss: 326489.2109
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9762; val_auprc_score: 0.9648; val_best_acc_score: 0.9435; val_best_f1_score: 0.9458; train_kl_reg_loss: 4070.1323; train_edge_recon_loss: 260730.4816; train_gene_expr_recon_loss: 64027.5232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328828.1369; train_optim_loss: 328828.1369; val_kl_reg_loss: 4090.8904; val_edge_recon_loss: 260998.3125; val_gene_expr_recon_loss: 63675.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328764.8047; val_optim_loss: 328764.8047
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9761; val_auprc_score: 0.9618; val_best_acc_score: 0.9462; val_best_f1_score: 0.9481; train_kl_reg_loss: 4051.1447; train_edge_recon_loss: 260075.5703; train_gene_expr_recon_loss: 63860.5595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327987.2730; train_optim_loss: 327987.2730; val_kl_reg_loss: 4055.7473; val_edge_recon_loss: 260267.2188; val_gene_expr_recon_loss: 62378.7510; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326701.7188; val_optim_loss: 326701.7188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9764; val_auprc_score: 0.9574; val_best_acc_score: 0.9504; val_best_f1_score: 0.9522; train_kl_reg_loss: 4090.3554; train_edge_recon_loss: 259764.4642; train_gene_expr_recon_loss: 63524.7264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327379.5441; train_optim_loss: 327379.5441; val_kl_reg_loss: 4113.4098; val_edge_recon_loss: 258388.8320; val_gene_expr_recon_loss: 64417.9473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326920.1875; val_optim_loss: 326920.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9793; val_auprc_score: 0.9640; val_best_acc_score: 0.9539; val_best_f1_score: 0.9554; train_kl_reg_loss: 4080.4981; train_edge_recon_loss: 259901.8456; train_gene_expr_recon_loss: 62869.8441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326852.1912; train_optim_loss: 326852.1912; val_kl_reg_loss: 4031.8503; val_edge_recon_loss: 256183.6289; val_gene_expr_recon_loss: 61663.2910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321878.7656; val_optim_loss: 321878.7656
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9796; val_auprc_score: 0.9666; val_best_acc_score: 0.9502; val_best_f1_score: 0.9519; train_kl_reg_loss: 4046.3494; train_edge_recon_loss: 259596.0381; train_gene_expr_recon_loss: 62419.9424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326062.3318; train_optim_loss: 326062.3318; val_kl_reg_loss: 4006.5016; val_edge_recon_loss: 260881.6133; val_gene_expr_recon_loss: 62040.6514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326928.7578; val_optim_loss: 326928.7578
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9764; val_auprc_score: 0.9633; val_best_acc_score: 0.9494; val_best_f1_score: 0.9512; train_kl_reg_loss: 4038.0253; train_edge_recon_loss: 259457.6006; train_gene_expr_recon_loss: 62586.7065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326082.3355; train_optim_loss: 326082.3355; val_kl_reg_loss: 4036.3687; val_edge_recon_loss: 259006.9883; val_gene_expr_recon_loss: 62203.5850; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325246.9453; val_optim_loss: 325246.9453
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9798; val_auprc_score: 0.9662; val_best_acc_score: 0.9531; val_best_f1_score: 0.9547; train_kl_reg_loss: 4064.4527; train_edge_recon_loss: 259221.4141; train_gene_expr_recon_loss: 62445.0941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325730.9596; train_optim_loss: 325730.9596; val_kl_reg_loss: 4037.8271; val_edge_recon_loss: 259393.5234; val_gene_expr_recon_loss: 62150.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325581.6016; val_optim_loss: 325581.6016

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9822; val_auprc_score: 0.9738; val_best_acc_score: 0.9539; val_best_f1_score: 0.9554; train_kl_reg_loss: 4075.0360; train_edge_recon_loss: 259429.3056; train_gene_expr_recon_loss: 62571.8724; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326076.2132; train_optim_loss: 326076.2132; val_kl_reg_loss: 4047.3341; val_edge_recon_loss: 258467.1133; val_gene_expr_recon_loss: 63538.4639; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326052.9062; val_optim_loss: 326052.9062
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9756; val_auprc_score: 0.9612; val_best_acc_score: 0.9488; val_best_f1_score: 0.9510; train_kl_reg_loss: 4069.0635; train_edge_recon_loss: 258759.1186; train_gene_expr_recon_loss: 62468.0327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325296.2160; train_optim_loss: 325296.2160; val_kl_reg_loss: 4037.7123; val_edge_recon_loss: 259489.0703; val_gene_expr_recon_loss: 61760.9717; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325287.7578; val_optim_loss: 325287.7578
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9810; val_auprc_score: 0.9721; val_best_acc_score: 0.9539; val_best_f1_score: 0.9556; train_kl_reg_loss: 4067.6465; train_edge_recon_loss: 259403.3217; train_gene_expr_recon_loss: 62440.9421; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325911.9108; train_optim_loss: 325911.9108; val_kl_reg_loss: 4039.9816; val_edge_recon_loss: 257887.8516; val_gene_expr_recon_loss: 61472.8389; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323400.6641; val_optim_loss: 323400.6641

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 54 sec.
Using best model state, which was in epoch 15.

--- MODEL EVALUATION ---
Val AUROC score: 0.9738
Val AUPRC score: 0.9519
Val best accuracy score: 0.9441
Val best F1 score: 0.9464
Val gene expr MSE score: 0.0093
Duration of model training in run 8: 0 hours, 0 minutes and 57 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 21239
Number of validation edges: 2359
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8884; val_auprc_score: 0.8820; val_best_acc_score: 0.7675; val_best_f1_score: 0.7990; train_kl_reg_loss: 3319.5007; train_edge_recon_loss: 308766.3630; train_gene_expr_recon_loss: 70324.2976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382410.1630; train_optim_loss: 382410.1630; val_kl_reg_loss: 3436.6615; val_edge_recon_loss: 285391.8766; val_gene_expr_recon_loss: 66334.6332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 355163.1750; val_optim_loss: 355163.1750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9393; val_auprc_score: 0.9131; val_best_acc_score: 0.8758; val_best_f1_score: 0.8818; train_kl_reg_loss: 4057.2211; train_edge_recon_loss: 274954.2654; train_gene_expr_recon_loss: 67703.4701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346714.9541; train_optim_loss: 346714.9541; val_kl_reg_loss: 3892.1927; val_edge_recon_loss: 269405.6125; val_gene_expr_recon_loss: 67873.8133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 341171.6156; val_optim_loss: 341171.6156
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9559; val_auprc_score: 0.9310; val_best_acc_score: 0.9061; val_best_f1_score: 0.9120; train_kl_reg_loss: 4049.7647; train_edge_recon_loss: 267097.8701; train_gene_expr_recon_loss: 66823.7157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 337971.3517; train_optim_loss: 337971.3517; val_kl_reg_loss: 3970.9994; val_edge_recon_loss: 267764.1328; val_gene_expr_recon_loss: 65068.5832; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 336803.7094; val_optim_loss: 336803.7094
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9723; val_auprc_score: 0.9571; val_best_acc_score: 0.9332; val_best_f1_score: 0.9360; train_kl_reg_loss: 4024.7384; train_edge_recon_loss: 264257.2967; train_gene_expr_recon_loss: 66191.8671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334473.9025; train_optim_loss: 334473.9025; val_kl_reg_loss: 4049.1054; val_edge_recon_loss: 261298.1422; val_gene_expr_recon_loss: 65183.0648; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330530.3094; val_optim_loss: 330530.3094
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9723; val_auprc_score: 0.9603; val_best_acc_score: 0.9305; val_best_f1_score: 0.9343; train_kl_reg_loss: 4066.2972; train_edge_recon_loss: 262394.8818; train_gene_expr_recon_loss: 65790.4179; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332251.5971; train_optim_loss: 332251.5971; val_kl_reg_loss: 4028.7694; val_edge_recon_loss: 262183.5797; val_gene_expr_recon_loss: 65005.4398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 331217.7875; val_optim_loss: 331217.7875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9729; val_auprc_score: 0.9574; val_best_acc_score: 0.9396; val_best_f1_score: 0.9420; train_kl_reg_loss: 4019.5056; train_edge_recon_loss: 260906.1939; train_gene_expr_recon_loss: 64975.5742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329901.2752; train_optim_loss: 329901.2752; val_kl_reg_loss: 3954.4667; val_edge_recon_loss: 261495.0172; val_gene_expr_recon_loss: 63019.0367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328468.5187; val_optim_loss: 328468.5187
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9773; val_auprc_score: 0.9651; val_best_acc_score: 0.9428; val_best_f1_score: 0.9448; train_kl_reg_loss: 4042.6444; train_edge_recon_loss: 260673.0683; train_gene_expr_recon_loss: 64604.5951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329320.3065; train_optim_loss: 329320.3065; val_kl_reg_loss: 4031.3453; val_edge_recon_loss: 259089.5938; val_gene_expr_recon_loss: 63762.7363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326883.6781; val_optim_loss: 326883.6781
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9809; val_auprc_score: 0.9713; val_best_acc_score: 0.9466; val_best_f1_score: 0.9488; train_kl_reg_loss: 4056.3286; train_edge_recon_loss: 260106.5585; train_gene_expr_recon_loss: 63912.9716; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 328075.8603; train_optim_loss: 328075.8603; val_kl_reg_loss: 4100.1971; val_edge_recon_loss: 259908.5078; val_gene_expr_recon_loss: 64758.8309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328767.5312; val_optim_loss: 328767.5312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9819; val_auprc_score: 0.9749; val_best_acc_score: 0.9532; val_best_f1_score: 0.9548; train_kl_reg_loss: 4082.1758; train_edge_recon_loss: 259354.6617; train_gene_expr_recon_loss: 63793.2687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 327230.1073; train_optim_loss: 327230.1073; val_kl_reg_loss: 3999.5614; val_edge_recon_loss: 258108.0625; val_gene_expr_recon_loss: 64139.3074; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326246.9313; val_optim_loss: 326246.9313
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9819; val_auprc_score: 0.9741; val_best_acc_score: 0.9536; val_best_f1_score: 0.9549; train_kl_reg_loss: 4076.4267; train_edge_recon_loss: 259474.7317; train_gene_expr_recon_loss: 63388.3819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326939.5403; train_optim_loss: 326939.5403; val_kl_reg_loss: 4082.6369; val_edge_recon_loss: 259705.0672; val_gene_expr_recon_loss: 60479.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324267.1656; val_optim_loss: 324267.1656
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9823; val_auprc_score: 0.9702; val_best_acc_score: 0.9587; val_best_f1_score: 0.9598; train_kl_reg_loss: 4099.1954; train_edge_recon_loss: 259039.4703; train_gene_expr_recon_loss: 63032.5569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326171.2255; train_optim_loss: 326171.2255; val_kl_reg_loss: 4004.9682; val_edge_recon_loss: 258516.1984; val_gene_expr_recon_loss: 62027.3285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324548.4969; val_optim_loss: 324548.4969
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9841; val_auprc_score: 0.9753; val_best_acc_score: 0.9657; val_best_f1_score: 0.9666; train_kl_reg_loss: 4080.0823; train_edge_recon_loss: 258488.1248; train_gene_expr_recon_loss: 62749.6574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325317.8645; train_optim_loss: 325317.8645; val_kl_reg_loss: 3990.9027; val_edge_recon_loss: 258851.1625; val_gene_expr_recon_loss: 61892.6492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324734.7188; val_optim_loss: 324734.7188
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9852; val_auprc_score: 0.9744; val_best_acc_score: 0.9655; val_best_f1_score: 0.9663; train_kl_reg_loss: 4073.5589; train_edge_recon_loss: 257934.1450; train_gene_expr_recon_loss: 62443.1041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324450.8069; train_optim_loss: 324450.8069; val_kl_reg_loss: 3981.0485; val_edge_recon_loss: 255178.1562; val_gene_expr_recon_loss: 62510.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321669.3937; val_optim_loss: 321669.3937
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9837; val_auprc_score: 0.9747; val_best_acc_score: 0.9635; val_best_f1_score: 0.9643; train_kl_reg_loss: 4083.7964; train_edge_recon_loss: 258542.8539; train_gene_expr_recon_loss: 62101.3302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324727.9816; train_optim_loss: 324727.9816; val_kl_reg_loss: 4035.5224; val_edge_recon_loss: 257149.6719; val_gene_expr_recon_loss: 62363.6926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323548.8906; val_optim_loss: 323548.8906
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9825; val_auprc_score: 0.9718; val_best_acc_score: 0.9585; val_best_f1_score: 0.9596; train_kl_reg_loss: 4099.6065; train_edge_recon_loss: 257799.9006; train_gene_expr_recon_loss: 62141.2138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 324040.7203; train_optim_loss: 324040.7203; val_kl_reg_loss: 3971.7108; val_edge_recon_loss: 260256.3422; val_gene_expr_recon_loss: 62109.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326337.6437; val_optim_loss: 326337.6437
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9841; val_auprc_score: 0.9714; val_best_acc_score: 0.9576; val_best_f1_score: 0.9589; train_kl_reg_loss: 4102.4835; train_edge_recon_loss: 257802.6066; train_gene_expr_recon_loss: 61750.0193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 323655.1092; train_optim_loss: 323655.1092; val_kl_reg_loss: 4114.4708; val_edge_recon_loss: 259912.8234; val_gene_expr_recon_loss: 61344.5621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325371.8563; val_optim_loss: 325371.8563

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9866; val_auprc_score: 0.9770; val_best_acc_score: 0.9661; val_best_f1_score: 0.9669; train_kl_reg_loss: 4111.4101; train_edge_recon_loss: 257340.2713; train_gene_expr_recon_loss: 61185.3507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322637.0312; train_optim_loss: 322637.0312; val_kl_reg_loss: 4050.0953; val_edge_recon_loss: 255790.9531; val_gene_expr_recon_loss: 60582.2352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320423.2812; val_optim_loss: 320423.2812
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9845; val_auprc_score: 0.9718; val_best_acc_score: 0.9655; val_best_f1_score: 0.9664; train_kl_reg_loss: 4080.1150; train_edge_recon_loss: 258043.1805; train_gene_expr_recon_loss: 60690.8264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322814.1235; train_optim_loss: 322814.1235; val_kl_reg_loss: 4050.2706; val_edge_recon_loss: 257036.1688; val_gene_expr_recon_loss: 59189.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320276.2406; val_optim_loss: 320276.2406
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9871; val_auprc_score: 0.9805; val_best_acc_score: 0.9686; val_best_f1_score: 0.9694; train_kl_reg_loss: 4094.3056; train_edge_recon_loss: 257558.9951; train_gene_expr_recon_loss: 60525.9533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322179.2541; train_optim_loss: 322179.2541; val_kl_reg_loss: 4093.3906; val_edge_recon_loss: 255364.5875; val_gene_expr_recon_loss: 59434.2973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 318892.2719; val_optim_loss: 318892.2719
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9827; val_auprc_score: 0.9712; val_best_acc_score: 0.9657; val_best_f1_score: 0.9666; train_kl_reg_loss: 4072.2772; train_edge_recon_loss: 258108.1297; train_gene_expr_recon_loss: 60752.6983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322933.1050; train_optim_loss: 322933.1050; val_kl_reg_loss: 4040.8254; val_edge_recon_loss: 258329.0547; val_gene_expr_recon_loss: 60848.1340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323218.0125; val_optim_loss: 323218.0125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9839; val_auprc_score: 0.9728; val_best_acc_score: 0.9674; val_best_f1_score: 0.9681; train_kl_reg_loss: 4099.5781; train_edge_recon_loss: 257565.3035; train_gene_expr_recon_loss: 60935.5237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322600.4062; train_optim_loss: 322600.4062; val_kl_reg_loss: 4064.4231; val_edge_recon_loss: 255148.5000; val_gene_expr_recon_loss: 61419.8023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320632.7281; val_optim_loss: 320632.7281
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9868; val_auprc_score: 0.9785; val_best_acc_score: 0.9701; val_best_f1_score: 0.9707; train_kl_reg_loss: 4071.8108; train_edge_recon_loss: 257341.9447; train_gene_expr_recon_loss: 60599.0432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322012.7974; train_optim_loss: 322012.7974; val_kl_reg_loss: 4019.8737; val_edge_recon_loss: 256011.9062; val_gene_expr_recon_loss: 60157.3824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320189.1625; val_optim_loss: 320189.1625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9851; val_auprc_score: 0.9735; val_best_acc_score: 0.9686; val_best_f1_score: 0.9693; train_kl_reg_loss: 4041.9132; train_edge_recon_loss: 257905.5429; train_gene_expr_recon_loss: 60348.2523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322295.7075; train_optim_loss: 322295.7075; val_kl_reg_loss: 4025.9960; val_edge_recon_loss: 255659.5625; val_gene_expr_recon_loss: 59746.7270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 319432.2844; val_optim_loss: 319432.2844
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9873; val_auprc_score: 0.9818; val_best_acc_score: 0.9688; val_best_f1_score: 0.9695; train_kl_reg_loss: 4054.3784; train_edge_recon_loss: 257805.9863; train_gene_expr_recon_loss: 60528.7521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322389.1163; train_optim_loss: 322389.1163; val_kl_reg_loss: 4035.4593; val_edge_recon_loss: 256167.1516; val_gene_expr_recon_loss: 60415.0754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 320617.6875; val_optim_loss: 320617.6875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9870; val_auprc_score: 0.9799; val_best_acc_score: 0.9669; val_best_f1_score: 0.9679; train_kl_reg_loss: 4057.7412; train_edge_recon_loss: 258030.2508; train_gene_expr_recon_loss: 60457.7464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 322545.7402; train_optim_loss: 322545.7402; val_kl_reg_loss: 4037.5312; val_edge_recon_loss: 255157.7172; val_gene_expr_recon_loss: 62500.3613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 321695.6125; val_optim_loss: 321695.6125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 9 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.9857
Val AUPRC score: 0.9730
Val best accuracy score: 0.9646
Val best F1 score: 0.9653
Val gene expr MSE score: 0.0096
Duration of model training in run 9: 0 hours, 2 minutes and 17 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 4000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 974, n_latent: 974, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 974, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 974, n_cond_embed_input: 974, n_addon_input: 0, n_output: 8000
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 1888
Number of validation nodes: 210
Number of training edges: 21239
Number of validation edges: 2359
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8988; val_auprc_score: 0.8985; val_best_acc_score: 0.7533; val_best_f1_score: 0.7917; train_kl_reg_loss: 2877.3570; train_edge_recon_loss: 308923.4435; train_gene_expr_recon_loss: 70281.1963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 382081.9951; train_optim_loss: 382081.9951; val_kl_reg_loss: 3923.6170; val_edge_recon_loss: 285910.7031; val_gene_expr_recon_loss: 68321.6035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 358155.9219; val_optim_loss: 358155.9219
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9350; val_auprc_score: 0.9118; val_best_acc_score: 0.8800; val_best_f1_score: 0.8875; train_kl_reg_loss: 3672.9511; train_edge_recon_loss: 279161.1122; train_gene_expr_recon_loss: 68002.6240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350836.6867; train_optim_loss: 350836.6867; val_kl_reg_loss: 4104.0893; val_edge_recon_loss: 271554.4281; val_gene_expr_recon_loss: 66991.5340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 342650.0594; val_optim_loss: 342650.0594
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9589; val_auprc_score: 0.9440; val_best_acc_score: 0.9095; val_best_f1_score: 0.9138; train_kl_reg_loss: 4042.3123; train_edge_recon_loss: 267646.8820; train_gene_expr_recon_loss: 67306.9472; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 338996.1408; train_optim_loss: 338996.1408; val_kl_reg_loss: 3928.3686; val_edge_recon_loss: 266802.7703; val_gene_expr_recon_loss: 66311.0691; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 337042.2031; val_optim_loss: 337042.2031
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9653; val_auprc_score: 0.9446; val_best_acc_score: 0.9199; val_best_f1_score: 0.9229; train_kl_reg_loss: 3991.9791; train_edge_recon_loss: 263919.1721; train_gene_expr_recon_loss: 66373.3284; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 334284.4782; train_optim_loss: 334284.4782; val_kl_reg_loss: 3990.7510; val_edge_recon_loss: 264320.8063; val_gene_expr_recon_loss: 64889.6566; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 333201.2125; val_optim_loss: 333201.2125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9733; val_auprc_score: 0.9650; val_best_acc_score: 0.9356; val_best_f1_score: 0.9384; train_kl_reg_loss: 4057.9259; train_edge_recon_loss: 262811.7176; train_gene_expr_recon_loss: 65828.3370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 332697.9804; train_optim_loss: 332697.9804; val_kl_reg_loss: 4001.1347; val_edge_recon_loss: 261714.0391; val_gene_expr_recon_loss: 61667.5219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327382.7031; val_optim_loss: 327382.7031
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9696; val_auprc_score: 0.9576; val_best_acc_score: 0.9326; val_best_f1_score: 0.9362; train_kl_reg_loss: 4040.2773; train_edge_recon_loss: 261776.9454; train_gene_expr_recon_loss: 65382.4030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 331199.6258; train_optim_loss: 331199.6258; val_kl_reg_loss: 3986.7440; val_edge_recon_loss: 260127.4141; val_gene_expr_recon_loss: 63366.4746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327480.6312; val_optim_loss: 327480.6312
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9728; val_auprc_score: 0.9605; val_best_acc_score: 0.9309; val_best_f1_score: 0.9341; train_kl_reg_loss: 4054.9973; train_edge_recon_loss: 260636.3426; train_gene_expr_recon_loss: 64753.6464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329444.9849; train_optim_loss: 329444.9849; val_kl_reg_loss: 3874.8704; val_edge_recon_loss: 262222.2797; val_gene_expr_recon_loss: 64450.1023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 330547.2531; val_optim_loss: 330547.2531
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9731; val_auprc_score: 0.9559; val_best_acc_score: 0.9341; val_best_f1_score: 0.9368; train_kl_reg_loss: 4054.7025; train_edge_recon_loss: 260596.6992; train_gene_expr_recon_loss: 64350.2147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 329001.6186; train_optim_loss: 329001.6186; val_kl_reg_loss: 4001.7368; val_edge_recon_loss: 263456.1813; val_gene_expr_recon_loss: 61478.6848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 328936.6000; val_optim_loss: 328936.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9747; val_auprc_score: 0.9595; val_best_acc_score: 0.9430; val_best_f1_score: 0.9456; train_kl_reg_loss: 4067.5414; train_edge_recon_loss: 259432.3850; train_gene_expr_recon_loss: 63275.7443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326775.6713; train_optim_loss: 326775.6713; val_kl_reg_loss: 4049.2329; val_edge_recon_loss: 257818.2094; val_gene_expr_recon_loss: 62677.7480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324545.1875; val_optim_loss: 324545.1875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9751; val_auprc_score: 0.9561; val_best_acc_score: 0.9434; val_best_f1_score: 0.9457; train_kl_reg_loss: 4068.0133; train_edge_recon_loss: 259462.3262; train_gene_expr_recon_loss: 62838.1497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326368.4883; train_optim_loss: 326368.4883; val_kl_reg_loss: 4026.6979; val_edge_recon_loss: 258301.2047; val_gene_expr_recon_loss: 61888.8629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324216.7687; val_optim_loss: 324216.7687
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9794; val_auprc_score: 0.9631; val_best_acc_score: 0.9476; val_best_f1_score: 0.9494; train_kl_reg_loss: 4084.2704; train_edge_recon_loss: 258922.3624; train_gene_expr_recon_loss: 62607.8535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325614.4864; train_optim_loss: 325614.4864; val_kl_reg_loss: 4069.4614; val_edge_recon_loss: 259209.5547; val_gene_expr_recon_loss: 61075.1039; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 324354.1125; val_optim_loss: 324354.1125
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9774; val_auprc_score: 0.9655; val_best_acc_score: 0.9455; val_best_f1_score: 0.9474; train_kl_reg_loss: 4052.2516; train_edge_recon_loss: 259354.5164; train_gene_expr_recon_loss: 62501.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325907.9447; train_optim_loss: 325907.9447; val_kl_reg_loss: 4022.0763; val_edge_recon_loss: 260078.8281; val_gene_expr_recon_loss: 62033.6133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326134.5156; val_optim_loss: 326134.5156
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9736; val_auprc_score: 0.9526; val_best_acc_score: 0.9402; val_best_f1_score: 0.9429; train_kl_reg_loss: 4041.8025; train_edge_recon_loss: 259460.9902; train_gene_expr_recon_loss: 62681.9998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 326184.7903; train_optim_loss: 326184.7903; val_kl_reg_loss: 4020.1997; val_edge_recon_loss: 260667.1594; val_gene_expr_recon_loss: 60877.4223; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325564.7781; val_optim_loss: 325564.7781

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9788; val_auprc_score: 0.9701; val_best_acc_score: 0.9455; val_best_f1_score: 0.9474; train_kl_reg_loss: 4057.2192; train_edge_recon_loss: 259067.0314; train_gene_expr_recon_loss: 62817.4159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325941.6634; train_optim_loss: 325941.6634; val_kl_reg_loss: 4039.6506; val_edge_recon_loss: 257699.1984; val_gene_expr_recon_loss: 60267.5023; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322006.3469; val_optim_loss: 322006.3469
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9772; val_auprc_score: 0.9642; val_best_acc_score: 0.9451; val_best_f1_score: 0.9470; train_kl_reg_loss: 4054.5869; train_edge_recon_loss: 259239.4413; train_gene_expr_recon_loss: 62470.8134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325764.8404; train_optim_loss: 325764.8404; val_kl_reg_loss: 4021.0805; val_edge_recon_loss: 258503.0703; val_gene_expr_recon_loss: 60509.6977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323033.8563; val_optim_loss: 323033.8563
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9778; val_auprc_score: 0.9606; val_best_acc_score: 0.9462; val_best_f1_score: 0.9480; train_kl_reg_loss: 4055.5901; train_edge_recon_loss: 259060.7210; train_gene_expr_recon_loss: 62518.6285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325634.9401; train_optim_loss: 325634.9401; val_kl_reg_loss: 4027.7091; val_edge_recon_loss: 258085.5172; val_gene_expr_recon_loss: 64526.0344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 326639.2625; val_optim_loss: 326639.2625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9755; val_auprc_score: 0.9593; val_best_acc_score: 0.9402; val_best_f1_score: 0.9426; train_kl_reg_loss: 4052.9221; train_edge_recon_loss: 259173.8786; train_gene_expr_recon_loss: 62236.1083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325462.9123; train_optim_loss: 325462.9123; val_kl_reg_loss: 4031.2018; val_edge_recon_loss: 262239.2781; val_gene_expr_recon_loss: 61640.8426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 327911.3250; val_optim_loss: 327911.3250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9783; val_auprc_score: 0.9649; val_best_acc_score: 0.9500; val_best_f1_score: 0.9515; train_kl_reg_loss: 4052.2483; train_edge_recon_loss: 259206.4686; train_gene_expr_recon_loss: 62583.2351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325841.9518; train_optim_loss: 325841.9518; val_kl_reg_loss: 4025.7016; val_edge_recon_loss: 258979.2891; val_gene_expr_recon_loss: 60496.4402; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 323501.4375; val_optim_loss: 323501.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9740; val_auprc_score: 0.9592; val_best_acc_score: 0.9434; val_best_f1_score: 0.9455; train_kl_reg_loss: 4050.6560; train_edge_recon_loss: 258919.4703; train_gene_expr_recon_loss: 62766.9625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325737.0904; train_optim_loss: 325737.0904; val_kl_reg_loss: 4012.1827; val_edge_recon_loss: 260055.5516; val_gene_expr_recon_loss: 61321.4875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 325389.2281; val_optim_loss: 325389.2281
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9786; val_auprc_score: 0.9686; val_best_acc_score: 0.9474; val_best_f1_score: 0.9492; train_kl_reg_loss: 4050.3893; train_edge_recon_loss: 259598.1280; train_gene_expr_recon_loss: 62150.2643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 325798.7812; train_optim_loss: 325798.7812; val_kl_reg_loss: 4009.4421; val_edge_recon_loss: 257463.2844; val_gene_expr_recon_loss: 61396.2316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 322868.9594; val_optim_loss: 322868.9594

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 47 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9752
Val AUPRC score: 0.9563
Val best accuracy score: 0.9462
Val best F1 score: 0.9484
Val gene expr MSE score: 0.0098
Duration of model training in run 10: 0 hours, 1 minutes and 54 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
