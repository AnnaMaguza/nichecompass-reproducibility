Run timestamp: 16082023_220204_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '8192', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_imputed_subsample_50pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1471, n_latent: 1471, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 6383
Number of validation nodes: 709
Number of training edges: 56625
Number of validation edges: 6291
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9606; val_auprc_score: 0.9633; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 606098.3434; train_edge_recon_loss: 3522335.5714; train_gene_expr_recon_loss: 137841778.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 141970212.5714; train_optim_loss: 141970212.5714; val_kl_reg_loss: 111579.8750; val_edge_recon_loss: 4065887.0000; val_gene_expr_recon_loss: 26761056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30938524.0000; val_optim_loss: 30938524.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9560; val_auprc_score: 0.9571; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 148501.4342; train_edge_recon_loss: 3585811.5357; train_gene_expr_recon_loss: 27052582.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30786895.1429; train_optim_loss: 30786895.1429; val_kl_reg_loss: 230507.0469; val_edge_recon_loss: 4066147.5000; val_gene_expr_recon_loss: 25483060.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29779714.0000; val_optim_loss: 29779714.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9515; val_auprc_score: 0.9517; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 245563.0156; train_edge_recon_loss: 3646647.5714; train_gene_expr_recon_loss: 23026892.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26919102.8571; train_optim_loss: 26919102.8571; val_kl_reg_loss: 379294.2812; val_edge_recon_loss: 4066208.0000; val_gene_expr_recon_loss: 19123324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23568826.0000; val_optim_loss: 23568826.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9487; val_auprc_score: 0.9490; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 366665.5491; train_edge_recon_loss: 3676964.3571; train_gene_expr_recon_loss: 18099783.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22143413.1429; train_optim_loss: 22143413.1429; val_kl_reg_loss: 282283.5625; val_edge_recon_loss: 4066226.2500; val_gene_expr_recon_loss: 17108454.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21456964.0000; val_optim_loss: 21456964.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9498; val_auprc_score: 0.9528; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 350606.1250; train_edge_recon_loss: 3746724.8214; train_gene_expr_recon_loss: 16689754.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20787084.5714; train_optim_loss: 20787084.5714; val_kl_reg_loss: 294263.1250; val_edge_recon_loss: 4066230.0000; val_gene_expr_recon_loss: 16016580.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20377072.0000; val_optim_loss: 20377072.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9500; val_auprc_score: 0.9511; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 357402.5000; train_edge_recon_loss: 3754369.2143; train_gene_expr_recon_loss: 16934119.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21045891.1429; train_optim_loss: 21045891.1429; val_kl_reg_loss: 298297.6875; val_edge_recon_loss: 4066228.5000; val_gene_expr_recon_loss: 15481729.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19846256.0000; val_optim_loss: 19846256.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9529; val_auprc_score: 0.9531; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 375556.7723; train_edge_recon_loss: 3748413.6786; train_gene_expr_recon_loss: 15430113.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19554084.0000; train_optim_loss: 19554084.0000; val_kl_reg_loss: 260233.4062; val_edge_recon_loss: 4066245.5000; val_gene_expr_recon_loss: 14926660.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19253140.0000; val_optim_loss: 19253140.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9519; val_auprc_score: 0.9506; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 354856.7411; train_edge_recon_loss: 3781924.7143; train_gene_expr_recon_loss: 14798689.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18935471.4286; train_optim_loss: 18935471.4286; val_kl_reg_loss: 383134.0000; val_edge_recon_loss: 4066253.0000; val_gene_expr_recon_loss: 14611010.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19060396.0000; val_optim_loss: 19060396.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9503; val_auprc_score: 0.9485; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 413501.2991; train_edge_recon_loss: 3756242.0000; train_gene_expr_recon_loss: 14649143.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18818886.5714; train_optim_loss: 18818886.5714; val_kl_reg_loss: 475315.3750; val_edge_recon_loss: 4066254.2500; val_gene_expr_recon_loss: 14353668.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18895238.0000; val_optim_loss: 18895238.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9500; val_auprc_score: 0.9481; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 393207.9241; train_edge_recon_loss: 3759824.5714; train_gene_expr_recon_loss: 14259089.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18412121.4286; train_optim_loss: 18412121.4286; val_kl_reg_loss: 280476.5625; val_edge_recon_loss: 4066251.7500; val_gene_expr_recon_loss: 14175324.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18522052.0000; val_optim_loss: 18522052.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9509; val_auprc_score: 0.9492; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 343914.2188; train_edge_recon_loss: 3880058.0000; train_gene_expr_recon_loss: 14192874.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18416846.2857; train_optim_loss: 18416846.2857; val_kl_reg_loss: 264471.6250; val_edge_recon_loss: 4066251.0000; val_gene_expr_recon_loss: 14014344.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18345066.0000; val_optim_loss: 18345066.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9484; val_auprc_score: 0.9476; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 360772.2277; train_edge_recon_loss: 3847563.7500; train_gene_expr_recon_loss: 15515095.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19723431.7143; train_optim_loss: 19723431.7143; val_kl_reg_loss: 296442.3125; val_edge_recon_loss: 4066256.0000; val_gene_expr_recon_loss: 13904351.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18267050.0000; val_optim_loss: 18267050.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9477; val_auprc_score: 0.9468; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 383423.9196; train_edge_recon_loss: 3863223.5000; train_gene_expr_recon_loss: 16724510.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20971157.1429; train_optim_loss: 20971157.1429; val_kl_reg_loss: 251808.6562; val_edge_recon_loss: 4066257.5000; val_gene_expr_recon_loss: 13808902.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18126968.0000; val_optim_loss: 18126968.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9476; val_auprc_score: 0.9472; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 746284.6384; train_edge_recon_loss: 3902243.7500; train_gene_expr_recon_loss: 14586920.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19235448.5714; train_optim_loss: 19235448.5714; val_kl_reg_loss: 260700.5781; val_edge_recon_loss: 4066264.7500; val_gene_expr_recon_loss: 13730342.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18057308.0000; val_optim_loss: 18057308.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9450; val_auprc_score: 0.9433; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 354549.1339; train_edge_recon_loss: 3931737.6429; train_gene_expr_recon_loss: 13787122.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18073408.8571; train_optim_loss: 18073408.8571; val_kl_reg_loss: 277472.0312; val_edge_recon_loss: 4066265.0000; val_gene_expr_recon_loss: 13660688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18004424.0000; val_optim_loss: 18004424.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9437; val_auprc_score: 0.9432; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1656935.7098; train_edge_recon_loss: 3879106.9286; train_gene_expr_recon_loss: 15873892.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21409935.4286; train_optim_loss: 21409935.4286; val_kl_reg_loss: 266518.4688; val_edge_recon_loss: 4066265.0000; val_gene_expr_recon_loss: 13618186.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17950970.0000; val_optim_loss: 17950970.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9470; val_auprc_score: 0.9453; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 323922.7812; train_edge_recon_loss: 3964083.7857; train_gene_expr_recon_loss: 14378043.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18666049.7143; train_optim_loss: 18666049.7143; val_kl_reg_loss: 266448.1875; val_edge_recon_loss: 4066273.7500; val_gene_expr_recon_loss: 13589695.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17922416.0000; val_optim_loss: 17922416.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9464; val_auprc_score: 0.9426; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 282147.7366; train_edge_recon_loss: 4035111.7143; train_gene_expr_recon_loss: 14503885.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18821145.1429; train_optim_loss: 18821145.1429; val_kl_reg_loss: 1003588.3750; val_edge_recon_loss: 4066274.2500; val_gene_expr_recon_loss: 13580273.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18650136.0000; val_optim_loss: 18650136.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9459; val_auprc_score: 0.9402; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 611345.8348; train_edge_recon_loss: 3885325.6786; train_gene_expr_recon_loss: 20376732.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24873404.0000; train_optim_loss: 24873404.0000; val_kl_reg_loss: 282508.1875; val_edge_recon_loss: 4066282.2500; val_gene_expr_recon_loss: 13622876.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17971666.0000; val_optim_loss: 17971666.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9459; val_auprc_score: 0.9393; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1400431.3259; train_edge_recon_loss: 3936281.9643; train_gene_expr_recon_loss: 13904681.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19241394.0000; train_optim_loss: 19241394.0000; val_kl_reg_loss: 731312.5625; val_edge_recon_loss: 4066281.2500; val_gene_expr_recon_loss: 13573954.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18371548.0000; val_optim_loss: 18371548.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9474; val_auprc_score: 0.9435; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 539056.4375; train_edge_recon_loss: 3944138.5000; train_gene_expr_recon_loss: 13584923.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18068118.2857; train_optim_loss: 18068118.2857; val_kl_reg_loss: 270365.5000; val_edge_recon_loss: 4066280.2500; val_gene_expr_recon_loss: 13544149.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17880796.0000; val_optim_loss: 17880796.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9449; val_auprc_score: 0.9391; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 326871.2946; train_edge_recon_loss: 4010585.4643; train_gene_expr_recon_loss: 17400348.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21737804.8571; train_optim_loss: 21737804.8571; val_kl_reg_loss: 596170.0000; val_edge_recon_loss: 4066279.7500; val_gene_expr_recon_loss: 13530190.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18192640.0000; val_optim_loss: 18192640.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9450; val_auprc_score: 0.9412; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 355155.3527; train_edge_recon_loss: 3973617.1429; train_gene_expr_recon_loss: 13830344.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18159117.1429; train_optim_loss: 18159117.1429; val_kl_reg_loss: 267106.6250; val_edge_recon_loss: 4066274.2500; val_gene_expr_recon_loss: 13518898.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17852280.0000; val_optim_loss: 17852280.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9441; val_auprc_score: 0.9377; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 308873.3214; train_edge_recon_loss: 4021891.3929; train_gene_expr_recon_loss: 20719709.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25050474.0000; train_optim_loss: 25050474.0000; val_kl_reg_loss: 296810.8125; val_edge_recon_loss: 4066281.2500; val_gene_expr_recon_loss: 13639398.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18002490.0000; val_optim_loss: 18002490.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9366; val_auprc_score: 0.9341; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 385275.0759; train_edge_recon_loss: 3975073.5000; train_gene_expr_recon_loss: 14440021.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18800370.5714; train_optim_loss: 18800370.5714; val_kl_reg_loss: 2280969.0000; val_edge_recon_loss: 4066271.5000; val_gene_expr_recon_loss: 13578307.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19925548.0000; val_optim_loss: 19925548.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9291; val_auprc_score: 0.9269; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 669510.8973; train_edge_recon_loss: 3972180.5000; train_gene_expr_recon_loss: 15542332.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20184023.7143; train_optim_loss: 20184023.7143; val_kl_reg_loss: 283394.0625; val_edge_recon_loss: 4066264.7500; val_gene_expr_recon_loss: 13525240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17874900.0000; val_optim_loss: 17874900.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9270; val_auprc_score: 0.9269; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 281166.1384; train_edge_recon_loss: 4065196.9643; train_gene_expr_recon_loss: 13329737.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17676100.0000; train_optim_loss: 17676100.0000; val_kl_reg_loss: 267973.0625; val_edge_recon_loss: 4066254.5000; val_gene_expr_recon_loss: 16022711.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20356938.0000; val_optim_loss: 20356938.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9242; val_auprc_score: 0.9233; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 270966.2455; train_edge_recon_loss: 4064885.7500; train_gene_expr_recon_loss: 13251799.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17587651.1429; train_optim_loss: 17587651.1429; val_kl_reg_loss: 267589.6875; val_edge_recon_loss: 4066255.7500; val_gene_expr_recon_loss: 12998913.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17332758.0000; val_optim_loss: 17332758.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9256; val_auprc_score: 0.9254; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 270491.0268; train_edge_recon_loss: 4064731.8929; train_gene_expr_recon_loss: 13122969.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17458192.0000; train_optim_loss: 17458192.0000; val_kl_reg_loss: 266481.1875; val_edge_recon_loss: 4066253.2500; val_gene_expr_recon_loss: 13256509.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17589244.0000; val_optim_loss: 17589244.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9250; val_auprc_score: 0.9258; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 269529.6875; train_edge_recon_loss: 4064655.5000; train_gene_expr_recon_loss: 13292331.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17626516.5714; train_optim_loss: 17626516.5714; val_kl_reg_loss: 265639.5625; val_edge_recon_loss: 4066255.7500; val_gene_expr_recon_loss: 13327686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17659582.0000; val_optim_loss: 17659582.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9261; val_auprc_score: 0.9273; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 267463.2411; train_edge_recon_loss: 4064586.5357; train_gene_expr_recon_loss: 13314174.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17646224.2857; train_optim_loss: 17646224.2857; val_kl_reg_loss: 263349.2188; val_edge_recon_loss: 4066252.7500; val_gene_expr_recon_loss: 13305352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17634954.0000; val_optim_loss: 17634954.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9248; val_auprc_score: 0.9252; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 265510.1607; train_edge_recon_loss: 4064064.5357; train_gene_expr_recon_loss: 13278309.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17607884.2857; train_optim_loss: 17607884.2857; val_kl_reg_loss: 261351.9688; val_edge_recon_loss: 4066252.0000; val_gene_expr_recon_loss: 13246372.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17573976.0000; val_optim_loss: 17573976.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9263; val_auprc_score: 0.9272; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 264268.6071; train_edge_recon_loss: 4063083.5000; train_gene_expr_recon_loss: 13239435.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17566788.5714; train_optim_loss: 17566788.5714; val_kl_reg_loss: 260749.4531; val_edge_recon_loss: 4066251.7500; val_gene_expr_recon_loss: 13231721.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17558722.0000; val_optim_loss: 17558722.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9243; val_auprc_score: 0.9241; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 264205.1339; train_edge_recon_loss: 4062671.0000; train_gene_expr_recon_loss: 13221891.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17548767.4286; train_optim_loss: 17548767.4286; val_kl_reg_loss: 260917.7344; val_edge_recon_loss: 4066254.2500; val_gene_expr_recon_loss: 13229688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17556860.0000; val_optim_loss: 17556860.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9278; val_auprc_score: 0.9291; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 264338.2857; train_edge_recon_loss: 4061801.9286; train_gene_expr_recon_loss: 13220469.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17546609.4286; train_optim_loss: 17546609.4286; val_kl_reg_loss: 260718.6562; val_edge_recon_loss: 4066252.7500; val_gene_expr_recon_loss: 13214068.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17541040.0000; val_optim_loss: 17541040.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9273; val_auprc_score: 0.9288; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 264393.8527; train_edge_recon_loss: 4060426.6429; train_gene_expr_recon_loss: 13202496.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17527317.4286; train_optim_loss: 17527317.4286; val_kl_reg_loss: 261515.2500; val_edge_recon_loss: 4066252.7500; val_gene_expr_recon_loss: 13208130.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17535898.0000; val_optim_loss: 17535898.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 11 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9254
val AUPRC score: 0.9252
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 15.5764
val source rna MSE score: 10.2986
Duration of model training in run 8: 0 hours, 2 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1471, n_latent: 1471, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 6383
Number of validation nodes: 709
Number of training edges: 56625
Number of validation edges: 6291
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9517; val_auprc_score: 0.9567; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 204942.4237; train_edge_recon_loss: 3531086.7500; train_gene_expr_recon_loss: 46833921.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 50569951.7143; train_optim_loss: 50569951.7143; val_kl_reg_loss: 112092.2188; val_edge_recon_loss: 4065975.7500; val_gene_expr_recon_loss: 24121750.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28299818.0000; val_optim_loss: 28299818.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9415; val_auprc_score: 0.9479; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 311649.7969; train_edge_recon_loss: 3626806.6429; train_gene_expr_recon_loss: 23237805.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27176261.7143; train_optim_loss: 27176261.7143; val_kl_reg_loss: 187666.7656; val_edge_recon_loss: 4066140.2500; val_gene_expr_recon_loss: 21563698.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25817504.0000; val_optim_loss: 25817504.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9355; val_auprc_score: 0.9433; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 380038.4464; train_edge_recon_loss: 3819053.9286; train_gene_expr_recon_loss: 20757576.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24956668.8571; train_optim_loss: 24956668.8571; val_kl_reg_loss: 319999.1250; val_edge_recon_loss: 4066192.7500; val_gene_expr_recon_loss: 18835896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23222088.0000; val_optim_loss: 23222088.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9334; val_auprc_score: 0.9410; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 383492.8348; train_edge_recon_loss: 3896590.8571; train_gene_expr_recon_loss: 18198696.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22478779.4286; train_optim_loss: 22478779.4286; val_kl_reg_loss: 459725.1250; val_edge_recon_loss: 4066207.7500; val_gene_expr_recon_loss: 17340730.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21866664.0000; val_optim_loss: 21866664.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9307; val_auprc_score: 0.9378; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 511300.7366; train_edge_recon_loss: 3835441.3571; train_gene_expr_recon_loss: 17082625.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21429368.0000; train_optim_loss: 21429368.0000; val_kl_reg_loss: 722546.5000; val_edge_recon_loss: 4066200.5000; val_gene_expr_recon_loss: 16623717.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21412464.0000; val_optim_loss: 21412464.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9272; val_auprc_score: 0.9356; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 566081.1027; train_edge_recon_loss: 3845650.1786; train_gene_expr_recon_loss: 16748313.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21160045.1429; train_optim_loss: 21160045.1429; val_kl_reg_loss: 421650.0938; val_edge_recon_loss: 4066190.0000; val_gene_expr_recon_loss: 15995282.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20483122.0000; val_optim_loss: 20483122.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9277; val_auprc_score: 0.9360; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 470521.9554; train_edge_recon_loss: 3856430.3214; train_gene_expr_recon_loss: 16821691.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21148644.0000; train_optim_loss: 21148644.0000; val_kl_reg_loss: 381479.5625; val_edge_recon_loss: 4066192.7500; val_gene_expr_recon_loss: 15611737.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20059410.0000; val_optim_loss: 20059410.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9281; val_auprc_score: 0.9350; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 408596.2232; train_edge_recon_loss: 3960027.6429; train_gene_expr_recon_loss: 16727429.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21096053.4286; train_optim_loss: 21096053.4286; val_kl_reg_loss: 653118.1250; val_edge_recon_loss: 4066206.5000; val_gene_expr_recon_loss: 15265308.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19984632.0000; val_optim_loss: 19984632.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9304; val_auprc_score: 0.9353; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 454079.0759; train_edge_recon_loss: 3944427.7500; train_gene_expr_recon_loss: 18630885.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23029392.2857; train_optim_loss: 23029392.2857; val_kl_reg_loss: 367196.6875; val_edge_recon_loss: 4066237.0000; val_gene_expr_recon_loss: 15138688.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19572122.0000; val_optim_loss: 19572122.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9305; val_auprc_score: 0.9346; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 527063.0625; train_edge_recon_loss: 3963296.3571; train_gene_expr_recon_loss: 18780428.2857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23270787.7143; train_optim_loss: 23270787.7143; val_kl_reg_loss: 386461.3125; val_edge_recon_loss: 4066245.0000; val_gene_expr_recon_loss: 14969952.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19422658.0000; val_optim_loss: 19422658.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9281; val_auprc_score: 0.9312; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 574603.4598; train_edge_recon_loss: 3948699.0357; train_gene_expr_recon_loss: 19159955.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23683258.0000; train_optim_loss: 23683258.0000; val_kl_reg_loss: 434752.4375; val_edge_recon_loss: 4066254.7500; val_gene_expr_recon_loss: 14813264.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19314272.0000; val_optim_loss: 19314272.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9292; val_auprc_score: 0.9322; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 659466.1429; train_edge_recon_loss: 3931260.9643; train_gene_expr_recon_loss: 16572395.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21163122.8571; train_optim_loss: 21163122.8571; val_kl_reg_loss: 450540.9062; val_edge_recon_loss: 4066252.7500; val_gene_expr_recon_loss: 14713579.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19230372.0000; val_optim_loss: 19230372.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9244; val_auprc_score: 0.9265; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 544102.9330; train_edge_recon_loss: 4016039.2857; train_gene_expr_recon_loss: 14861096.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19421238.8571; train_optim_loss: 19421238.8571; val_kl_reg_loss: 457205.0000; val_edge_recon_loss: 4066258.7500; val_gene_expr_recon_loss: 14598842.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19122306.0000; val_optim_loss: 19122306.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9241; val_auprc_score: 0.9247; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 619781.7634; train_edge_recon_loss: 3990756.8571; train_gene_expr_recon_loss: 14623907.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19234445.7143; train_optim_loss: 19234445.7143; val_kl_reg_loss: 441974.5625; val_edge_recon_loss: 4066254.7500; val_gene_expr_recon_loss: 14536811.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19045040.0000; val_optim_loss: 19045040.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9251; val_auprc_score: 0.9261; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 539127.0938; train_edge_recon_loss: 3975339.3571; train_gene_expr_recon_loss: 14529100.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19043566.5714; train_optim_loss: 19043566.5714; val_kl_reg_loss: 414555.5625; val_edge_recon_loss: 4066249.5000; val_gene_expr_recon_loss: 14506578.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18987384.0000; val_optim_loss: 18987384.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9268; val_auprc_score: 0.9303; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 459994.7455; train_edge_recon_loss: 4009315.6786; train_gene_expr_recon_loss: 15996307.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20465617.4286; train_optim_loss: 20465617.4286; val_kl_reg_loss: 408304.9375; val_edge_recon_loss: 4066248.7500; val_gene_expr_recon_loss: 14473738.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18948292.0000; val_optim_loss: 18948292.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9255; val_auprc_score: 0.9289; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 873168.2232; train_edge_recon_loss: 4003317.7857; train_gene_expr_recon_loss: 14526561.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19403048.0000; train_optim_loss: 19403048.0000; val_kl_reg_loss: 643775.6875; val_edge_recon_loss: 4066244.2500; val_gene_expr_recon_loss: 14448476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19158496.0000; val_optim_loss: 19158496.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9234; val_auprc_score: 0.9248; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 516027.9911; train_edge_recon_loss: 3963267.1786; train_gene_expr_recon_loss: 16590122.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21069418.0000; train_optim_loss: 21069418.0000; val_kl_reg_loss: 419886.1250; val_edge_recon_loss: 4066245.7500; val_gene_expr_recon_loss: 14495980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18982112.0000; val_optim_loss: 18982112.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9219; val_auprc_score: 0.9234; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 757992.5223; train_edge_recon_loss: 4004421.6071; train_gene_expr_recon_loss: 30631696.1429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35394110.8571; train_optim_loss: 35394110.8571; val_kl_reg_loss: 468180.0625; val_edge_recon_loss: 4066243.2500; val_gene_expr_recon_loss: 14718353.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19252776.0000; val_optim_loss: 19252776.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9166; val_auprc_score: 0.9164; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 588976.9241; train_edge_recon_loss: 4020583.9286; train_gene_expr_recon_loss: 28321620.8571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32931181.4286; train_optim_loss: 32931181.4286; val_kl_reg_loss: 477305.0000; val_edge_recon_loss: 4066249.2500; val_gene_expr_recon_loss: 14615459.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19159012.0000; val_optim_loss: 19159012.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9208; val_auprc_score: 0.9225; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 487541.4286; train_edge_recon_loss: 4055566.7143; train_gene_expr_recon_loss: 14571567.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19114674.8571; train_optim_loss: 19114674.8571; val_kl_reg_loss: 492984.9688; val_edge_recon_loss: 4066246.5000; val_gene_expr_recon_loss: 14554896.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19114128.0000; val_optim_loss: 19114128.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9191; val_auprc_score: 0.9221; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 546903.4955; train_edge_recon_loss: 3976479.2857; train_gene_expr_recon_loss: 14537539.4286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19060922.5714; train_optim_loss: 19060922.5714; val_kl_reg_loss: 499071.3750; val_edge_recon_loss: 4066248.7500; val_gene_expr_recon_loss: 14527848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19093168.0000; val_optim_loss: 19093168.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9189; val_auprc_score: 0.9205; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 505644.3616; train_edge_recon_loss: 4009952.6429; train_gene_expr_recon_loss: 14502188.5714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19017786.0000; train_optim_loss: 19017786.0000; val_kl_reg_loss: 528085.3750; val_edge_recon_loss: 4066242.5000; val_gene_expr_recon_loss: 14496835.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19091164.0000; val_optim_loss: 19091164.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9180; val_auprc_score: 0.9194; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 544323.2634; train_edge_recon_loss: 3956923.1786; train_gene_expr_recon_loss: 14473671.7143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18974918.0000; train_optim_loss: 18974918.0000; val_kl_reg_loss: 498251.5000; val_edge_recon_loss: 4066242.0000; val_gene_expr_recon_loss: 14475310.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19039804.0000; val_optim_loss: 19039804.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 9 sec.
Using best model state, which was in epoch 16.

--- MODEL EVALUATION ---
val AUROC score: 0.9262
val AUPRC score: 0.9290
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 19.9578
val source rna MSE score: 15.0189
Duration of model training in run 7: 0 hours, 1 minutes and 13 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1471, n_latent: 1471, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 6383
Number of validation nodes: 709
Number of training edges: 42711
Number of validation edges: 4745
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9595; val_auprc_score: 0.9611; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 612579.2897; train_edge_recon_loss: 3530536.8333; train_gene_expr_recon_loss: 166909575.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 171052690.3333; train_optim_loss: 171052690.3333; val_kl_reg_loss: 118970.4062; val_edge_recon_loss: 4065709.0000; val_gene_expr_recon_loss: 26860690.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31045370.0000; val_optim_loss: 31045370.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9566; val_auprc_score: 0.9569; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 159770.7591; train_edge_recon_loss: 3575124.2500; train_gene_expr_recon_loss: 28320218.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32055113.0000; train_optim_loss: 32055113.0000; val_kl_reg_loss: 164383.2500; val_edge_recon_loss: 4066129.0000; val_gene_expr_recon_loss: 27109852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31340364.0000; val_optim_loss: 31340364.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9554; val_auprc_score: 0.9578; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 274137.5339; train_edge_recon_loss: 3642262.2500; train_gene_expr_recon_loss: 25791700.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29708100.3333; train_optim_loss: 29708100.3333; val_kl_reg_loss: 184568.6719; val_edge_recon_loss: 4066197.0000; val_gene_expr_recon_loss: 23837998.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28088764.0000; val_optim_loss: 28088764.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9541; val_auprc_score: 0.9549; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 340237.5703; train_edge_recon_loss: 3742394.5417; train_gene_expr_recon_loss: 23457107.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27539739.6667; train_optim_loss: 27539739.6667; val_kl_reg_loss: 289479.1875; val_edge_recon_loss: 4066224.0000; val_gene_expr_recon_loss: 22542228.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26897932.0000; val_optim_loss: 26897932.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9526; val_auprc_score: 0.9550; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 370154.8594; train_edge_recon_loss: 3784772.9167; train_gene_expr_recon_loss: 21858606.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26013533.6667; train_optim_loss: 26013533.6667; val_kl_reg_loss: 355025.5625; val_edge_recon_loss: 4066236.2500; val_gene_expr_recon_loss: 19338956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23760218.0000; val_optim_loss: 23760218.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9505; val_auprc_score: 0.9513; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 461363.7292; train_edge_recon_loss: 3773724.5417; train_gene_expr_recon_loss: 17715351.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21950439.3333; train_optim_loss: 21950439.3333; val_kl_reg_loss: 354355.2500; val_edge_recon_loss: 4066236.2500; val_gene_expr_recon_loss: 16309289.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20729880.0000; val_optim_loss: 20729880.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9487; val_auprc_score: 0.9491; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 416113.0260; train_edge_recon_loss: 3784095.2500; train_gene_expr_recon_loss: 17044375.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21244584.0000; train_optim_loss: 21244584.0000; val_kl_reg_loss: 340025.3125; val_edge_recon_loss: 4066233.2500; val_gene_expr_recon_loss: 16955082.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21361340.0000; val_optim_loss: 21361340.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9499; val_auprc_score: 0.9517; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 471522.1250; train_edge_recon_loss: 3793281.2083; train_gene_expr_recon_loss: 16131711.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20396515.0000; train_optim_loss: 20396515.0000; val_kl_reg_loss: 346668.3438; val_edge_recon_loss: 4066232.2500; val_gene_expr_recon_loss: 15420750.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19833650.0000; val_optim_loss: 19833650.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9489; val_auprc_score: 0.9505; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 414422.4479; train_edge_recon_loss: 3836229.0833; train_gene_expr_recon_loss: 15576393.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19827044.6667; train_optim_loss: 19827044.6667; val_kl_reg_loss: 599729.2500; val_edge_recon_loss: 4066223.5000; val_gene_expr_recon_loss: 15085626.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19751580.0000; val_optim_loss: 19751580.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9509; val_auprc_score: 0.9535; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 477594.4479; train_edge_recon_loss: 3894129.6667; train_gene_expr_recon_loss: 16122043.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20493767.0000; train_optim_loss: 20493767.0000; val_kl_reg_loss: 279315.2500; val_edge_recon_loss: 4066228.7500; val_gene_expr_recon_loss: 15019575.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19365120.0000; val_optim_loss: 19365120.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9501; val_auprc_score: 0.9503; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 370373.7031; train_edge_recon_loss: 3956405.4583; train_gene_expr_recon_loss: 16228773.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20555553.3333; train_optim_loss: 20555553.3333; val_kl_reg_loss: 270302.4688; val_edge_recon_loss: 4066233.7500; val_gene_expr_recon_loss: 14770983.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19107520.0000; val_optim_loss: 19107520.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9498; val_auprc_score: 0.9496; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 326665.0104; train_edge_recon_loss: 3985141.1250; train_gene_expr_recon_loss: 15430172.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19741978.3333; train_optim_loss: 19741978.3333; val_kl_reg_loss: 271593.2500; val_edge_recon_loss: 4066234.5000; val_gene_expr_recon_loss: 14685404.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19023232.0000; val_optim_loss: 19023232.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9475; val_auprc_score: 0.9488; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 305533.8073; train_edge_recon_loss: 3991633.0833; train_gene_expr_recon_loss: 14644264.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18941430.6667; train_optim_loss: 18941430.6667; val_kl_reg_loss: 401998.3750; val_edge_recon_loss: 4066231.2500; val_gene_expr_recon_loss: 14568072.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19036302.0000; val_optim_loss: 19036302.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9474; val_auprc_score: 0.9479; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 372397.2500; train_edge_recon_loss: 3868357.7500; train_gene_expr_recon_loss: 15451324.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19692079.3333; train_optim_loss: 19692079.3333; val_kl_reg_loss: 316747.1250; val_edge_recon_loss: 4066228.2500; val_gene_expr_recon_loss: 14492024.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18875000.0000; val_optim_loss: 18875000.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9485; val_auprc_score: 0.9516; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 326859.3542; train_edge_recon_loss: 3957603.2500; train_gene_expr_recon_loss: 14493546.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18778008.0000; train_optim_loss: 18778008.0000; val_kl_reg_loss: 564131.7500; val_edge_recon_loss: 4066218.7500; val_gene_expr_recon_loss: 14413064.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19043414.0000; val_optim_loss: 19043414.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9461; val_auprc_score: 0.9466; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 419869.9271; train_edge_recon_loss: 3900000.7500; train_gene_expr_recon_loss: 17593154.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21913025.3333; train_optim_loss: 21913025.3333; val_kl_reg_loss: 268306.5625; val_edge_recon_loss: 4066224.7500; val_gene_expr_recon_loss: 14376946.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18711478.0000; val_optim_loss: 18711478.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9462; val_auprc_score: 0.9482; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 293192.5104; train_edge_recon_loss: 4017235.9583; train_gene_expr_recon_loss: 15550708.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19861137.0000; train_optim_loss: 19861137.0000; val_kl_reg_loss: 330485.8125; val_edge_recon_loss: 4066234.7500; val_gene_expr_recon_loss: 14415607.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18812328.0000; val_optim_loss: 18812328.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9418; val_auprc_score: 0.9433; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 315285.0573; train_edge_recon_loss: 4020324.9583; train_gene_expr_recon_loss: 16454113.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20789723.3333; train_optim_loss: 20789723.3333; val_kl_reg_loss: 299849.0625; val_edge_recon_loss: 4066242.2500; val_gene_expr_recon_loss: 14416941.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18783032.0000; val_optim_loss: 18783032.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9422; val_auprc_score: 0.9431; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 314123.7500; train_edge_recon_loss: 4031471.2500; train_gene_expr_recon_loss: 14530243.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18875838.3333; train_optim_loss: 18875838.3333; val_kl_reg_loss: 380815.2812; val_edge_recon_loss: 4066240.2500; val_gene_expr_recon_loss: 14336644.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18783700.0000; val_optim_loss: 18783700.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9362; val_auprc_score: 0.9358; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 439343.8854; train_edge_recon_loss: 3942792.9583; train_gene_expr_recon_loss: 19345410.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23727548.0000; train_optim_loss: 23727548.0000; val_kl_reg_loss: 324670.5625; val_edge_recon_loss: 4066247.7500; val_gene_expr_recon_loss: 14358521.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18749440.0000; val_optim_loss: 18749440.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9382; val_auprc_score: 0.9385; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 330657.2031; train_edge_recon_loss: 4037951.5417; train_gene_expr_recon_loss: 14350107.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18718716.0000; train_optim_loss: 18718716.0000; val_kl_reg_loss: 321374.8125; val_edge_recon_loss: 4066246.7500; val_gene_expr_recon_loss: 14325322.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18712944.0000; val_optim_loss: 18712944.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9403; val_auprc_score: 0.9418; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 322089.5990; train_edge_recon_loss: 4057031.1250; train_gene_expr_recon_loss: 14304470.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18683591.0000; train_optim_loss: 18683591.0000; val_kl_reg_loss: 315703.5000; val_edge_recon_loss: 4066244.0000; val_gene_expr_recon_loss: 14296133.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18678080.0000; val_optim_loss: 18678080.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9389; val_auprc_score: 0.9402; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 318962.6562; train_edge_recon_loss: 4055710.0417; train_gene_expr_recon_loss: 14290704.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18665377.0000; train_optim_loss: 18665377.0000; val_kl_reg_loss: 315693.2500; val_edge_recon_loss: 4066245.7500; val_gene_expr_recon_loss: 14277710.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18659648.0000; val_optim_loss: 18659648.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9410; val_auprc_score: 0.9421; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 317473.3438; train_edge_recon_loss: 4047759.2917; train_gene_expr_recon_loss: 14254148.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18619380.3333; train_optim_loss: 18619380.3333; val_kl_reg_loss: 325679.3125; val_edge_recon_loss: 4066243.2500; val_gene_expr_recon_loss: 14260102.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18652024.0000; val_optim_loss: 18652024.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9392; val_auprc_score: 0.9392; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 399241.9844; train_edge_recon_loss: 3922236.0417; train_gene_expr_recon_loss: 14246275.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18567753.3333; train_optim_loss: 18567753.3333; val_kl_reg_loss: 363406.2500; val_edge_recon_loss: 4066242.0000; val_gene_expr_recon_loss: 14248746.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18678394.0000; val_optim_loss: 18678394.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9386; val_auprc_score: 0.9387; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 346141.1927; train_edge_recon_loss: 3965606.0833; train_gene_expr_recon_loss: 14248592.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18560339.0000; train_optim_loss: 18560339.0000; val_kl_reg_loss: 349039.0000; val_edge_recon_loss: 4066243.2500; val_gene_expr_recon_loss: 14242766.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18658048.0000; val_optim_loss: 18658048.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9386; val_auprc_score: 0.9401; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 408959.3333; train_edge_recon_loss: 3884130.3333; train_gene_expr_recon_loss: 14232523.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18525613.3333; train_optim_loss: 18525613.3333; val_kl_reg_loss: 431026.8750; val_edge_recon_loss: 4066241.7500; val_gene_expr_recon_loss: 14234028.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18731296.0000; val_optim_loss: 18731296.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9391; val_auprc_score: 0.9406; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 388385.9792; train_edge_recon_loss: 3886062.4583; train_gene_expr_recon_loss: 14223312.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18497760.6667; train_optim_loss: 18497760.6667; val_kl_reg_loss: 379687.8438; val_edge_recon_loss: 4066240.2500; val_gene_expr_recon_loss: 14228238.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18674166.0000; val_optim_loss: 18674166.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9407; val_auprc_score: 0.9421; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 388221.8646; train_edge_recon_loss: 3884715.6250; train_gene_expr_recon_loss: 14229894.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18502831.3333; train_optim_loss: 18502831.3333; val_kl_reg_loss: 384225.2500; val_edge_recon_loss: 4066239.5000; val_gene_expr_recon_loss: 14222226.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18672692.0000; val_optim_loss: 18672692.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9405; val_auprc_score: 0.9426; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 388152.3073; train_edge_recon_loss: 3879071.0417; train_gene_expr_recon_loss: 14222404.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18489627.0000; train_optim_loss: 18489627.0000; val_kl_reg_loss: 383976.2500; val_edge_recon_loss: 4066239.5000; val_gene_expr_recon_loss: 14228138.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18678354.0000; val_optim_loss: 18678354.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9390; val_auprc_score: 0.9403; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 387753.6406; train_edge_recon_loss: 3879918.3750; train_gene_expr_recon_loss: 14229634.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18497306.3333; train_optim_loss: 18497306.3333; val_kl_reg_loss: 385915.6875; val_edge_recon_loss: 4066238.5000; val_gene_expr_recon_loss: 14227810.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18679964.0000; val_optim_loss: 18679964.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9385; val_auprc_score: 0.9392; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 390616.2500; train_edge_recon_loss: 3876890.9167; train_gene_expr_recon_loss: 14225301.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18492808.6667; train_optim_loss: 18492808.6667; val_kl_reg_loss: 391160.0625; val_edge_recon_loss: 4066238.5000; val_gene_expr_recon_loss: 14227436.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18684834.0000; val_optim_loss: 18684834.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 22 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
val AUROC score: 0.9400
val AUPRC score: 0.9416
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 16.6439
val source rna MSE score: 12.4561
Duration of model training in run 6: 0 hours, 1 minutes and 26 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1471, n_latent: 1471, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1471, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 6383
Number of validation nodes: 709
Number of training edges: 42711
Number of validation edges: 4745
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9551; val_auprc_score: 0.9571; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 257163.3989; train_edge_recon_loss: 3529326.7083; train_gene_expr_recon_loss: 62964297.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 66750789.6667; train_optim_loss: 66750789.6667; val_kl_reg_loss: 137745.8281; val_edge_recon_loss: 4065764.2500; val_gene_expr_recon_loss: 24356292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28559802.0000; val_optim_loss: 28559802.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9481; val_auprc_score: 0.9542; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 167934.7148; train_edge_recon_loss: 3608429.7917; train_gene_expr_recon_loss: 24243503.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28019868.0000; train_optim_loss: 28019868.0000; val_kl_reg_loss: 222352.1250; val_edge_recon_loss: 4066148.5000; val_gene_expr_recon_loss: 22870944.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27159444.0000; val_optim_loss: 27159444.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9439; val_auprc_score: 0.9502; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 350121.8359; train_edge_recon_loss: 3693700.1667; train_gene_expr_recon_loss: 21785298.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25829120.3333; train_optim_loss: 25829120.3333; val_kl_reg_loss: 314412.1875; val_edge_recon_loss: 4066211.5000; val_gene_expr_recon_loss: 20122012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24502636.0000; val_optim_loss: 24502636.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9414; val_auprc_score: 0.9459; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 382774.4479; train_edge_recon_loss: 3772369.2083; train_gene_expr_recon_loss: 19979464.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24134607.6667; train_optim_loss: 24134607.6667; val_kl_reg_loss: 401572.3125; val_edge_recon_loss: 4066233.2500; val_gene_expr_recon_loss: 19099870.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23567676.0000; val_optim_loss: 23567676.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9423; val_auprc_score: 0.9476; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 460949.7604; train_edge_recon_loss: 3828122.2083; train_gene_expr_recon_loss: 18808603.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23097675.3333; train_optim_loss: 23097675.3333; val_kl_reg_loss: 508193.6875; val_edge_recon_loss: 4066236.2500; val_gene_expr_recon_loss: 18161292.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22735722.0000; val_optim_loss: 22735722.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9412; val_auprc_score: 0.9456; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 499986.0417; train_edge_recon_loss: 3821120.0417; train_gene_expr_recon_loss: 18010740.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22331846.0000; train_optim_loss: 22331846.0000; val_kl_reg_loss: 405841.1875; val_edge_recon_loss: 4066240.7500; val_gene_expr_recon_loss: 17516110.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21988192.0000; val_optim_loss: 21988192.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9407; val_auprc_score: 0.9463; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 466103.9844; train_edge_recon_loss: 3888194.7500; train_gene_expr_recon_loss: 17516817.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21871116.0000; train_optim_loss: 21871116.0000; val_kl_reg_loss: 680225.4375; val_edge_recon_loss: 4066238.5000; val_gene_expr_recon_loss: 17058462.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21804926.0000; val_optim_loss: 21804926.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9393; val_auprc_score: 0.9443; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 520725.1979; train_edge_recon_loss: 3859724.3333; train_gene_expr_recon_loss: 17103219.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21483669.0000; train_optim_loss: 21483669.0000; val_kl_reg_loss: 711475.2500; val_edge_recon_loss: 4066234.5000; val_gene_expr_recon_loss: 16755610.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21533320.0000; val_optim_loss: 21533320.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9417; val_auprc_score: 0.9471; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 556626.3125; train_edge_recon_loss: 3881092.4583; train_gene_expr_recon_loss: 17472386.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21910105.0000; train_optim_loss: 21910105.0000; val_kl_reg_loss: 367006.1875; val_edge_recon_loss: 4066236.5000; val_gene_expr_recon_loss: 16572394.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21005636.0000; val_optim_loss: 21005636.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9345; val_auprc_score: 0.9409; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 440552.8073; train_edge_recon_loss: 3932923.7917; train_gene_expr_recon_loss: 17731862.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22105339.3333; train_optim_loss: 22105339.3333; val_kl_reg_loss: 380860.1875; val_edge_recon_loss: 4066235.5000; val_gene_expr_recon_loss: 16440589.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20887684.0000; val_optim_loss: 20887684.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9311; val_auprc_score: 0.9368; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 758348.4115; train_edge_recon_loss: 3972877.1667; train_gene_expr_recon_loss: 17741001.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22472227.3333; train_optim_loss: 22472227.3333; val_kl_reg_loss: 478652.0000; val_edge_recon_loss: 4066221.5000; val_gene_expr_recon_loss: 16321486.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20866360.0000; val_optim_loss: 20866360.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9307; val_auprc_score: 0.9375; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 382258.3385; train_edge_recon_loss: 4006743.2083; train_gene_expr_recon_loss: 17127511.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21516513.3333; train_optim_loss: 21516513.3333; val_kl_reg_loss: 348315.7500; val_edge_recon_loss: 4066218.2500; val_gene_expr_recon_loss: 16248928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20663462.0000; val_optim_loss: 20663462.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9277; val_auprc_score: 0.9347; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 448604.2812; train_edge_recon_loss: 3941302.7500; train_gene_expr_recon_loss: 17138586.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21528494.0000; train_optim_loss: 21528494.0000; val_kl_reg_loss: 383755.3125; val_edge_recon_loss: 4066212.7500; val_gene_expr_recon_loss: 16170821.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20620788.0000; val_optim_loss: 20620788.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9269; val_auprc_score: 0.9337; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 699112.8854; train_edge_recon_loss: 3997398.2500; train_gene_expr_recon_loss: 16217754.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20914265.3333; train_optim_loss: 20914265.3333; val_kl_reg_loss: 664999.6250; val_edge_recon_loss: 4066215.5000; val_gene_expr_recon_loss: 16083216.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20814432.0000; val_optim_loss: 20814432.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9255; val_auprc_score: 0.9293; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 640571.0052; train_edge_recon_loss: 3900334.0417; train_gene_expr_recon_loss: 35670088.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40210994.3333; train_optim_loss: 40210994.3333; val_kl_reg_loss: 512499.0625; val_edge_recon_loss: 4066232.7500; val_gene_expr_recon_loss: 16218974.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20797706.0000; val_optim_loss: 20797706.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9219; val_auprc_score: 0.9254; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1162907.4844; train_edge_recon_loss: 3914817.9167; train_gene_expr_recon_loss: 17805184.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22882910.0000; train_optim_loss: 22882910.0000; val_kl_reg_loss: 476714.3125; val_edge_recon_loss: 4066251.0000; val_gene_expr_recon_loss: 16311532.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20854498.0000; val_optim_loss: 20854498.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9185; val_auprc_score: 0.9225; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 662272.0521; train_edge_recon_loss: 4013449.8333; train_gene_expr_recon_loss: 16595365.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21271087.0000; train_optim_loss: 21271087.0000; val_kl_reg_loss: 617009.6250; val_edge_recon_loss: 4066253.0000; val_gene_expr_recon_loss: 16141152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20824414.0000; val_optim_loss: 20824414.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9188; val_auprc_score: 0.9222; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 572629.2292; train_edge_recon_loss: 3961510.4167; train_gene_expr_recon_loss: 22650108.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27184248.6667; train_optim_loss: 27184248.6667; val_kl_reg_loss: 580191.0625; val_edge_recon_loss: 4066252.5000; val_gene_expr_recon_loss: 16081856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20728300.0000; val_optim_loss: 20728300.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9189; val_auprc_score: 0.9222; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 599803.4062; train_edge_recon_loss: 3923925.6250; train_gene_expr_recon_loss: 16156157.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20679887.0000; train_optim_loss: 20679887.0000; val_kl_reg_loss: 563570.5000; val_edge_recon_loss: 4066251.5000; val_gene_expr_recon_loss: 16050794.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20680616.0000; val_optim_loss: 20680616.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9190; val_auprc_score: 0.9224; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 564962.3438; train_edge_recon_loss: 3950083.5000; train_gene_expr_recon_loss: 16119775.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20634821.6667; train_optim_loss: 20634821.6667; val_kl_reg_loss: 562999.2500; val_edge_recon_loss: 4066248.7500; val_gene_expr_recon_loss: 16023959.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20653208.0000; val_optim_loss: 20653208.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9210; val_auprc_score: 0.9250; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 580212.1562; train_edge_recon_loss: 3924072.0000; train_gene_expr_recon_loss: 16112149.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20616433.3333; train_optim_loss: 20616433.3333; val_kl_reg_loss: 579734.8750; val_edge_recon_loss: 4066246.7500; val_gene_expr_recon_loss: 16001648.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20647630.0000; val_optim_loss: 20647630.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 49 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
val AUROC score: 0.9255
val AUPRC score: 0.9326
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 23.7686
val source rna MSE score: 20.3324
Duration of model training in run 5: 0 hours, 0 minutes and 53 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1473, n_latent: 1473, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1473, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1473, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 6383
Number of validation nodes: 709
Number of training edges: 28587
Number of validation edges: 3176
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9511; val_auprc_score: 0.9561; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5237037.2923; train_edge_recon_loss: 3647766.6250; train_gene_expr_recon_loss: 217475213.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 226360018.0000; train_optim_loss: 226360018.0000; val_kl_reg_loss: 78859.0781; val_edge_recon_loss: 4064964.2500; val_gene_expr_recon_loss: 23856552.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28000376.0000; val_optim_loss: 28000376.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9484; val_auprc_score: 0.9545; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 101043.4590; train_edge_recon_loss: 3527019.8125; train_gene_expr_recon_loss: 28988806.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32616869.5000; train_optim_loss: 32616869.5000; val_kl_reg_loss: 102782.2891; val_edge_recon_loss: 4065978.5000; val_gene_expr_recon_loss: 28021980.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32190740.0000; val_optim_loss: 32190740.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9502; val_auprc_score: 0.9550; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 140495.6094; train_edge_recon_loss: 3577634.3125; train_gene_expr_recon_loss: 27772947.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31491077.5000; train_optim_loss: 31491077.5000; val_kl_reg_loss: 153133.0625; val_edge_recon_loss: 4066131.0000; val_gene_expr_recon_loss: 26474082.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30693346.0000; val_optim_loss: 30693346.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9491; val_auprc_score: 0.9542; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 198333.0352; train_edge_recon_loss: 3638276.8750; train_gene_expr_recon_loss: 25831059.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29667670.0000; train_optim_loss: 29667670.0000; val_kl_reg_loss: 226145.0625; val_edge_recon_loss: 4066192.0000; val_gene_expr_recon_loss: 24361012.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28653348.0000; val_optim_loss: 28653348.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9446; val_auprc_score: 0.9485; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 293755.1953; train_edge_recon_loss: 3662119.0000; train_gene_expr_recon_loss: 23622128.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27578002.0000; train_optim_loss: 27578002.0000; val_kl_reg_loss: 202875.2344; val_edge_recon_loss: 4066225.0000; val_gene_expr_recon_loss: 22453830.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26722930.0000; val_optim_loss: 26722930.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9481; val_auprc_score: 0.9533; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 327823.5000; train_edge_recon_loss: 3709950.1875; train_gene_expr_recon_loss: 23246330.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27284104.0000; train_optim_loss: 27284104.0000; val_kl_reg_loss: 254045.9844; val_edge_recon_loss: 4066241.5000; val_gene_expr_recon_loss: 22278948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26599236.0000; val_optim_loss: 26599236.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9430; val_auprc_score: 0.9454; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 398699.9219; train_edge_recon_loss: 3761175.6875; train_gene_expr_recon_loss: 22214916.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26374792.5000; train_optim_loss: 26374792.5000; val_kl_reg_loss: 289469.2188; val_edge_recon_loss: 4066255.0000; val_gene_expr_recon_loss: 21509804.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25865528.0000; val_optim_loss: 25865528.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9427; val_auprc_score: 0.9444; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 447093.2422; train_edge_recon_loss: 3787419.3125; train_gene_expr_recon_loss: 21315984.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25550496.5000; train_optim_loss: 25550496.5000; val_kl_reg_loss: 302700.0625; val_edge_recon_loss: 4066259.5000; val_gene_expr_recon_loss: 20914906.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25283866.0000; val_optim_loss: 25283866.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9434; val_auprc_score: 0.9444; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 394422.1719; train_edge_recon_loss: 3894736.1250; train_gene_expr_recon_loss: 21104678.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25393836.5000; train_optim_loss: 25393836.5000; val_kl_reg_loss: 342336.6875; val_edge_recon_loss: 4066261.2500; val_gene_expr_recon_loss: 20399338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24807936.0000; val_optim_loss: 24807936.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9421; val_auprc_score: 0.9466; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 449902.3359; train_edge_recon_loss: 3838943.3125; train_gene_expr_recon_loss: 20468251.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24757096.5000; train_optim_loss: 24757096.5000; val_kl_reg_loss: 397483.2812; val_edge_recon_loss: 4066263.5000; val_gene_expr_recon_loss: 20043170.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24506916.0000; val_optim_loss: 24506916.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9425; val_auprc_score: 0.9462; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 466928.2422; train_edge_recon_loss: 3872038.0625; train_gene_expr_recon_loss: 21994569.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26333535.0000; train_optim_loss: 26333535.0000; val_kl_reg_loss: 508660.9375; val_edge_recon_loss: 4066265.7500; val_gene_expr_recon_loss: 19777816.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24352742.0000; val_optim_loss: 24352742.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9428; val_auprc_score: 0.9438; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 524766.8906; train_edge_recon_loss: 3776477.0000; train_gene_expr_recon_loss: 20909430.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25210674.0000; train_optim_loss: 25210674.0000; val_kl_reg_loss: 335750.5938; val_edge_recon_loss: 4066266.5000; val_gene_expr_recon_loss: 19577802.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23979820.0000; val_optim_loss: 23979820.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9467; val_auprc_score: 0.9477; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 348635.4141; train_edge_recon_loss: 3964600.5000; train_gene_expr_recon_loss: 19693889.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24007125.0000; train_optim_loss: 24007125.0000; val_kl_reg_loss: 340253.0625; val_edge_recon_loss: 4066271.2500; val_gene_expr_recon_loss: 19415420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23821944.0000; val_optim_loss: 23821944.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9423; val_auprc_score: 0.9428; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 440579.7891; train_edge_recon_loss: 3894702.8750; train_gene_expr_recon_loss: 22232069.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26567351.5000; train_optim_loss: 26567351.5000; val_kl_reg_loss: 376420.5938; val_edge_recon_loss: 4066275.0000; val_gene_expr_recon_loss: 19288280.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23730976.0000; val_optim_loss: 23730976.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9422; val_auprc_score: 0.9421; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 547770.8359; train_edge_recon_loss: 3824212.7500; train_gene_expr_recon_loss: 19290662.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23662645.5000; train_optim_loss: 23662645.5000; val_kl_reg_loss: 365186.8750; val_edge_recon_loss: 4066274.5000; val_gene_expr_recon_loss: 19168016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23599478.0000; val_optim_loss: 23599478.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9384; val_auprc_score: 0.9366; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 427166.1641; train_edge_recon_loss: 3872604.3125; train_gene_expr_recon_loss: 19110079.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23409850.0000; train_optim_loss: 23409850.0000; val_kl_reg_loss: 382471.9062; val_edge_recon_loss: 4066272.7500; val_gene_expr_recon_loss: 19048720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23497464.0000; val_optim_loss: 23497464.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9399; val_auprc_score: 0.9406; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 439462.0469; train_edge_recon_loss: 3862912.0625; train_gene_expr_recon_loss: 19121670.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23424044.5000; train_optim_loss: 23424044.5000; val_kl_reg_loss: 363424.1875; val_edge_recon_loss: 4066269.7500; val_gene_expr_recon_loss: 18939664.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23369358.0000; val_optim_loss: 23369358.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9384; val_auprc_score: 0.9385; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 412003.3672; train_edge_recon_loss: 3894661.8750; train_gene_expr_recon_loss: 18912435.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23219100.0000; train_optim_loss: 23219100.0000; val_kl_reg_loss: 368145.8750; val_edge_recon_loss: 4066269.7500; val_gene_expr_recon_loss: 18844852.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23279268.0000; val_optim_loss: 23279268.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9388; val_auprc_score: 0.9391; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 366677.9375; train_edge_recon_loss: 3938743.9375; train_gene_expr_recon_loss: 19169003.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23474425.0000; train_optim_loss: 23474425.0000; val_kl_reg_loss: 419433.6250; val_edge_recon_loss: 4066270.2500; val_gene_expr_recon_loss: 18764792.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23250496.0000; val_optim_loss: 23250496.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9413; val_auprc_score: 0.9435; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 462108.6719; train_edge_recon_loss: 3839039.7500; train_gene_expr_recon_loss: 18926045.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23227193.5000; train_optim_loss: 23227193.5000; val_kl_reg_loss: 354786.3750; val_edge_recon_loss: 4066270.2500; val_gene_expr_recon_loss: 18695100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23116156.0000; val_optim_loss: 23116156.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9398; val_auprc_score: 0.9421; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 483137.9609; train_edge_recon_loss: 3843321.6875; train_gene_expr_recon_loss: 18673965.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23000425.0000; train_optim_loss: 23000425.0000; val_kl_reg_loss: 324618.6250; val_edge_recon_loss: 4066269.7500; val_gene_expr_recon_loss: 18638050.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23028938.0000; val_optim_loss: 23028938.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9329; val_auprc_score: 0.9320; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 380913.1797; train_edge_recon_loss: 3966763.6875; train_gene_expr_recon_loss: 21086483.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25434160.5000; train_optim_loss: 25434160.5000; val_kl_reg_loss: 312594.5312; val_edge_recon_loss: 4066268.7500; val_gene_expr_recon_loss: 18599220.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22978084.0000; val_optim_loss: 22978084.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9320; val_auprc_score: 0.9377; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 362837.4141; train_edge_recon_loss: 3996674.6875; train_gene_expr_recon_loss: 18642136.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23001648.0000; train_optim_loss: 23001648.0000; val_kl_reg_loss: 320946.7500; val_edge_recon_loss: 4066263.2500; val_gene_expr_recon_loss: 18568392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22955602.0000; val_optim_loss: 22955602.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9295; val_auprc_score: 0.9327; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 564017.2266; train_edge_recon_loss: 3909529.5000; train_gene_expr_recon_loss: 30824231.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35297778.5000; train_optim_loss: 35297778.5000; val_kl_reg_loss: 310464.1250; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 18606314.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22983044.0000; val_optim_loss: 22983044.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9288; val_auprc_score: 0.9317; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 352342.8594; train_edge_recon_loss: 4018416.6875; train_gene_expr_recon_loss: 23171907.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27542666.5000; train_optim_loss: 27542666.5000; val_kl_reg_loss: 627802.0000; val_edge_recon_loss: 4066269.7500; val_gene_expr_recon_loss: 18596156.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23290228.0000; val_optim_loss: 23290228.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9270; val_auprc_score: 0.9295; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 630109.1406; train_edge_recon_loss: 3887875.2500; train_gene_expr_recon_loss: 20354946.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24872930.0000; train_optim_loss: 24872930.0000; val_kl_reg_loss: 377562.0000; val_edge_recon_loss: 4066268.0000; val_gene_expr_recon_loss: 18577166.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23020996.0000; val_optim_loss: 23020996.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9253; val_auprc_score: 0.9273; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 435495.4453; train_edge_recon_loss: 3933713.8750; train_gene_expr_recon_loss: 18577646.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22946855.5000; train_optim_loss: 22946855.5000; val_kl_reg_loss: 361770.7188; val_edge_recon_loss: 4066265.2500; val_gene_expr_recon_loss: 18554352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22982388.0000; val_optim_loss: 22982388.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9248; val_auprc_score: 0.9286; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 369198.9531; train_edge_recon_loss: 4014046.7500; train_gene_expr_recon_loss: 18552316.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22935562.5000; train_optim_loss: 22935562.5000; val_kl_reg_loss: 366260.1250; val_edge_recon_loss: 4066267.2500; val_gene_expr_recon_loss: 18543250.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22975778.0000; val_optim_loss: 22975778.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9260; val_auprc_score: 0.9282; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 383096.0234; train_edge_recon_loss: 3987766.8125; train_gene_expr_recon_loss: 18551023.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22921885.5000; train_optim_loss: 22921885.5000; val_kl_reg_loss: 401086.0625; val_edge_recon_loss: 4066264.7500; val_gene_expr_recon_loss: 18521576.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22988928.0000; val_optim_loss: 22988928.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9283; val_auprc_score: 0.9321; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 444746.1875; train_edge_recon_loss: 3915060.7500; train_gene_expr_recon_loss: 18523265.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22883072.0000; train_optim_loss: 22883072.0000; val_kl_reg_loss: 465131.3750; val_edge_recon_loss: 4066263.5000; val_gene_expr_recon_loss: 18501752.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23033148.0000; val_optim_loss: 23033148.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9240; val_auprc_score: 0.9253; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 476421.3047; train_edge_recon_loss: 3868618.0000; train_gene_expr_recon_loss: 18489688.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22834727.0000; train_optim_loss: 22834727.0000; val_kl_reg_loss: 422870.2500; val_edge_recon_loss: 4066264.2500; val_gene_expr_recon_loss: 18483364.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22972498.0000; val_optim_loss: 22972498.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 54 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9341
val AUPRC score: 0.9406
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 21.7766
val source rna MSE score: 24.2125
Duration of model training in run 4: 0 hours, 0 minutes and 57 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1473, n_latent: 1473, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1473, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1473, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 6383
Number of validation nodes: 709
Number of training edges: 28587
Number of validation edges: 3176
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9586; val_auprc_score: 0.9588; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1106623.5265; train_edge_recon_loss: 3522386.8125; train_gene_expr_recon_loss: 137887009.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 142516020.0000; train_optim_loss: 142516020.0000; val_kl_reg_loss: 110192.0703; val_edge_recon_loss: 4065676.7500; val_gene_expr_recon_loss: 23933708.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28109576.0000; val_optim_loss: 28109576.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9606; val_auprc_score: 0.9628; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 142262.4902; train_edge_recon_loss: 3560816.7500; train_gene_expr_recon_loss: 26620916.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30323996.0000; train_optim_loss: 30323996.0000; val_kl_reg_loss: 220915.6562; val_edge_recon_loss: 4066137.0000; val_gene_expr_recon_loss: 26882266.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31169318.0000; val_optim_loss: 31169318.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9579; val_auprc_score: 0.9607; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 221169.2070; train_edge_recon_loss: 3672317.0625; train_gene_expr_recon_loss: 25919404.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29812891.0000; train_optim_loss: 29812891.0000; val_kl_reg_loss: 547161.1875; val_edge_recon_loss: 4066220.0000; val_gene_expr_recon_loss: 22989090.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27602472.0000; val_optim_loss: 27602472.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9546; val_auprc_score: 0.9568; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 489789.7305; train_edge_recon_loss: 3702444.2500; train_gene_expr_recon_loss: 23108639.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27300873.5000; train_optim_loss: 27300873.5000; val_kl_reg_loss: 302657.8125; val_edge_recon_loss: 4066248.7500; val_gene_expr_recon_loss: 22013358.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26382264.0000; val_optim_loss: 26382264.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9544; val_auprc_score: 0.9565; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 879878.4922; train_edge_recon_loss: 3800783.5000; train_gene_expr_recon_loss: 26202740.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30883403.0000; train_optim_loss: 30883403.0000; val_kl_reg_loss: 451668.5625; val_edge_recon_loss: 4066261.0000; val_gene_expr_recon_loss: 23793608.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28311538.0000; val_optim_loss: 28311538.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9529; val_auprc_score: 0.9547; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 434477.4375; train_edge_recon_loss: 3908062.4375; train_gene_expr_recon_loss: 23792228.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28134768.5000; train_optim_loss: 28134768.5000; val_kl_reg_loss: 434434.8125; val_edge_recon_loss: 4066267.2500; val_gene_expr_recon_loss: 22828758.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27329460.0000; val_optim_loss: 27329460.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9539; val_auprc_score: 0.9553; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 812888.6953; train_edge_recon_loss: 3888205.2500; train_gene_expr_recon_loss: 23888094.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28589188.5000; train_optim_loss: 28589188.5000; val_kl_reg_loss: 407079.2500; val_edge_recon_loss: 4066271.7500; val_gene_expr_recon_loss: 22113406.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26586756.0000; val_optim_loss: 26586756.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9516; val_auprc_score: 0.9511; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 558302.8281; train_edge_recon_loss: 3967833.9375; train_gene_expr_recon_loss: 22482604.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27008740.5000; train_optim_loss: 27008740.5000; val_kl_reg_loss: 738222.1875; val_edge_recon_loss: 4066274.5000; val_gene_expr_recon_loss: 21524332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26328828.0000; val_optim_loss: 26328828.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9523; val_auprc_score: 0.9527; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 870806.9844; train_edge_recon_loss: 3873524.3750; train_gene_expr_recon_loss: 22866151.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27610483.0000; train_optim_loss: 27610483.0000; val_kl_reg_loss: 426725.1250; val_edge_recon_loss: 4066275.2500; val_gene_expr_recon_loss: 20901158.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25394158.0000; val_optim_loss: 25394158.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9523; val_auprc_score: 0.9529; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 569246.6094; train_edge_recon_loss: 3970697.2500; train_gene_expr_recon_loss: 22878868.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27418812.5000; train_optim_loss: 27418812.5000; val_kl_reg_loss: 432562.2500; val_edge_recon_loss: 4066275.7500; val_gene_expr_recon_loss: 20862360.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25361198.0000; val_optim_loss: 25361198.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9536; val_auprc_score: 0.9543; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 950926.9141; train_edge_recon_loss: 3963954.4375; train_gene_expr_recon_loss: 22015521.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26930402.5000; train_optim_loss: 26930402.5000; val_kl_reg_loss: 417428.5312; val_edge_recon_loss: 4066273.7500; val_gene_expr_recon_loss: 20782162.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25265864.0000; val_optim_loss: 25265864.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9540; val_auprc_score: 0.9549; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 429353.8906; train_edge_recon_loss: 4055709.8750; train_gene_expr_recon_loss: 20816334.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25301398.5000; train_optim_loss: 25301398.5000; val_kl_reg_loss: 474890.3750; val_edge_recon_loss: 4066274.2500; val_gene_expr_recon_loss: 20613392.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25154556.0000; val_optim_loss: 25154556.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9529; val_auprc_score: 0.9500; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 438393.7109; train_edge_recon_loss: 4039076.5000; train_gene_expr_recon_loss: 20998954.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25476425.0000; train_optim_loss: 25476425.0000; val_kl_reg_loss: 596659.1875; val_edge_recon_loss: 4066277.2500; val_gene_expr_recon_loss: 20433994.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25096930.0000; val_optim_loss: 25096930.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9517; val_auprc_score: 0.9516; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 545186.2891; train_edge_recon_loss: 3963472.2500; train_gene_expr_recon_loss: 22840171.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27348829.5000; train_optim_loss: 27348829.5000; val_kl_reg_loss: 430689.8750; val_edge_recon_loss: 4066279.0000; val_gene_expr_recon_loss: 20333482.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24830452.0000; val_optim_loss: 24830452.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9478; val_auprc_score: 0.9444; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 424753.7188; train_edge_recon_loss: 4052438.3125; train_gene_expr_recon_loss: 20431384.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24908576.5000; train_optim_loss: 24908576.5000; val_kl_reg_loss: 505487.4375; val_edge_recon_loss: 4066277.7500; val_gene_expr_recon_loss: 20234748.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24806512.0000; val_optim_loss: 24806512.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9501; val_auprc_score: 0.9493; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 666171.5781; train_edge_recon_loss: 3944679.5000; train_gene_expr_recon_loss: 21997588.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26608439.5000; train_optim_loss: 26608439.5000; val_kl_reg_loss: 421599.3750; val_edge_recon_loss: 4066276.5000; val_gene_expr_recon_loss: 20154776.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24642652.0000; val_optim_loss: 24642652.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9485; val_auprc_score: 0.9483; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 433191.7344; train_edge_recon_loss: 4041494.6250; train_gene_expr_recon_loss: 20220224.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24694910.5000; train_optim_loss: 24694910.5000; val_kl_reg_loss: 463206.5625; val_edge_recon_loss: 4066277.2500; val_gene_expr_recon_loss: 20059694.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24589178.0000; val_optim_loss: 24589178.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9499; val_auprc_score: 0.9518; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1259211.4844; train_edge_recon_loss: 3968182.5625; train_gene_expr_recon_loss: 22838840.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28066234.0000; train_optim_loss: 28066234.0000; val_kl_reg_loss: 406489.6875; val_edge_recon_loss: 4066275.7500; val_gene_expr_recon_loss: 19990158.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24462924.0000; val_optim_loss: 24462924.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9483; val_auprc_score: 0.9499; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 796084.1328; train_edge_recon_loss: 3992488.3750; train_gene_expr_recon_loss: 47895019.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 52683593.5000; train_optim_loss: 52683593.5000; val_kl_reg_loss: 417376.5625; val_edge_recon_loss: 4066276.5000; val_gene_expr_recon_loss: 20009332.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24492984.0000; val_optim_loss: 24492984.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9437; val_auprc_score: 0.9414; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 450836.6172; train_edge_recon_loss: 4035837.3750; train_gene_expr_recon_loss: 20745260.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25231934.0000; train_optim_loss: 25231934.0000; val_kl_reg_loss: 441356.0000; val_edge_recon_loss: 4066280.5000; val_gene_expr_recon_loss: 19990872.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24498508.0000; val_optim_loss: 24498508.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9423; val_auprc_score: 0.9399; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 478222.8750; train_edge_recon_loss: 4038601.1875; train_gene_expr_recon_loss: 20005557.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24522382.0000; train_optim_loss: 24522382.0000; val_kl_reg_loss: 457110.1875; val_edge_recon_loss: 4066282.0000; val_gene_expr_recon_loss: 19911000.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24434392.0000; val_optim_loss: 24434392.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9437; val_auprc_score: 0.9422; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 465080.8359; train_edge_recon_loss: 4063364.8750; train_gene_expr_recon_loss: 19978768.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24507214.0000; train_optim_loss: 24507214.0000; val_kl_reg_loss: 456601.0000; val_edge_recon_loss: 4066282.0000; val_gene_expr_recon_loss: 19838350.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24361232.0000; val_optim_loss: 24361232.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9435; val_auprc_score: 0.9410; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 640005.1875; train_edge_recon_loss: 3996853.9375; train_gene_expr_recon_loss: 24997930.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29634789.5000; train_optim_loss: 29634789.5000; val_kl_reg_loss: 463639.8750; val_edge_recon_loss: 4066283.5000; val_gene_expr_recon_loss: 19858656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24388580.0000; val_optim_loss: 24388580.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9454; val_auprc_score: 0.9465; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 536326.6484; train_edge_recon_loss: 4011863.0000; train_gene_expr_recon_loss: 21299298.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25847488.5000; train_optim_loss: 25847488.5000; val_kl_reg_loss: 486607.9062; val_edge_recon_loss: 4066283.5000; val_gene_expr_recon_loss: 19842192.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24395084.0000; val_optim_loss: 24395084.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9426; val_auprc_score: 0.9406; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 546409.0312; train_edge_recon_loss: 4018994.1875; train_gene_expr_recon_loss: 19899184.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24464587.0000; train_optim_loss: 24464587.0000; val_kl_reg_loss: 494124.6250; val_edge_recon_loss: 4066283.5000; val_gene_expr_recon_loss: 19817340.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24377748.0000; val_optim_loss: 24377748.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9391; val_auprc_score: 0.9362; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 502976.4688; train_edge_recon_loss: 4064432.0000; train_gene_expr_recon_loss: 19868337.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24435745.5000; train_optim_loss: 24435745.5000; val_kl_reg_loss: 495663.1250; val_edge_recon_loss: 4066286.0000; val_gene_expr_recon_loss: 19774128.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24336076.0000; val_optim_loss: 24336076.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9421; val_auprc_score: 0.9417; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1892631.4766; train_edge_recon_loss: 3973663.8125; train_gene_expr_recon_loss: 19970977.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25837272.5000; train_optim_loss: 25837272.5000; val_kl_reg_loss: 514039.5000; val_edge_recon_loss: 4066285.0000; val_gene_expr_recon_loss: 19739152.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24319476.0000; val_optim_loss: 24319476.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9437; val_auprc_score: 0.9426; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 547942.1250; train_edge_recon_loss: 4006225.1250; train_gene_expr_recon_loss: 19787453.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24341621.0000; train_optim_loss: 24341621.0000; val_kl_reg_loss: 509110.9688; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 19706208.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24281604.0000; val_optim_loss: 24281604.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9417; val_auprc_score: 0.9413; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 504944.9219; train_edge_recon_loss: 4045649.5000; train_gene_expr_recon_loss: 19736639.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24287234.0000; train_optim_loss: 24287234.0000; val_kl_reg_loss: 1058707.6250; val_edge_recon_loss: 4066286.5000; val_gene_expr_recon_loss: 19680022.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24805016.0000; val_optim_loss: 24805016.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9415; val_auprc_score: 0.9412; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 681812.0625; train_edge_recon_loss: 3966286.7500; train_gene_expr_recon_loss: 23018332.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27666431.5000; train_optim_loss: 27666431.5000; val_kl_reg_loss: 496921.5625; val_edge_recon_loss: 4066287.0000; val_gene_expr_recon_loss: 19650150.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24213358.0000; val_optim_loss: 24213358.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9405; val_auprc_score: 0.9390; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 562436.2734; train_edge_recon_loss: 4001716.0000; train_gene_expr_recon_loss: 21800442.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26364594.5000; train_optim_loss: 26364594.5000; val_kl_reg_loss: 545730.4375; val_edge_recon_loss: 4066287.2500; val_gene_expr_recon_loss: 19669424.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24281442.0000; val_optim_loss: 24281442.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9458; val_auprc_score: 0.9463; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 569131.5156; train_edge_recon_loss: 3980214.6250; train_gene_expr_recon_loss: 19732594.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24281940.5000; train_optim_loss: 24281940.5000; val_kl_reg_loss: 510113.7500; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 19641052.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24217452.0000; val_optim_loss: 24217452.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9429; val_auprc_score: 0.9423; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1452916.3047; train_edge_recon_loss: 3956562.3125; train_gene_expr_recon_loss: 38094131.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43503610.5000; train_optim_loss: 43503610.5000; val_kl_reg_loss: 486491.6562; val_edge_recon_loss: 4066285.0000; val_gene_expr_recon_loss: 19634318.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24187094.0000; val_optim_loss: 24187094.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9404; val_auprc_score: 0.9385; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 487499.6016; train_edge_recon_loss: 4049233.6875; train_gene_expr_recon_loss: 19701376.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24238109.0000; train_optim_loss: 24238109.0000; val_kl_reg_loss: 473321.1875; val_edge_recon_loss: 4066283.5000; val_gene_expr_recon_loss: 19646056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24185660.0000; val_optim_loss: 24185660.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9429; val_auprc_score: 0.9405; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 10877450.7109; train_edge_recon_loss: 3991644.8750; train_gene_expr_recon_loss: 27048521.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41917617.5000; train_optim_loss: 41917617.5000; val_kl_reg_loss: 515494.3125; val_edge_recon_loss: 4066283.5000; val_gene_expr_recon_loss: 19609656.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24191434.0000; val_optim_loss: 24191434.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9418; val_auprc_score: 0.9397; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 585662.9375; train_edge_recon_loss: 3916540.8125; train_gene_expr_recon_loss: 19647152.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24149356.0000; train_optim_loss: 24149356.0000; val_kl_reg_loss: 494668.6875; val_edge_recon_loss: 4066282.5000; val_gene_expr_recon_loss: 19596308.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24157260.0000; val_optim_loss: 24157260.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9409; val_auprc_score: 0.9393; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 475209.5312; train_edge_recon_loss: 4025922.0625; train_gene_expr_recon_loss: 19640095.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24141227.0000; train_optim_loss: 24141227.0000; val_kl_reg_loss: 450440.0000; val_edge_recon_loss: 4066282.5000; val_gene_expr_recon_loss: 19568632.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24085354.0000; val_optim_loss: 24085354.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9398; val_auprc_score: 0.9360; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6477674.3125; train_edge_recon_loss: 3969203.3750; train_gene_expr_recon_loss: 30712642.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41159521.0000; train_optim_loss: 41159521.0000; val_kl_reg_loss: 499605.5000; val_edge_recon_loss: 4066285.7500; val_gene_expr_recon_loss: 19692636.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24258528.0000; val_optim_loss: 24258528.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9411; val_auprc_score: 0.9351; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1371933.6797; train_edge_recon_loss: 3759112.1875; train_gene_expr_recon_loss: 180582457.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 185713499.5000; train_optim_loss: 185713499.5000; val_kl_reg_loss: 5062810.5000; val_edge_recon_loss: 4066292.2500; val_gene_expr_recon_loss: 32625434.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 41754536.0000; val_optim_loss: 41754536.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9342; val_auprc_score: 0.9224; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1925678.4688; train_edge_recon_loss: 3889887.8125; train_gene_expr_recon_loss: 176435745.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 182251310.0000; train_optim_loss: 182251310.0000; val_kl_reg_loss: 923968.0000; val_edge_recon_loss: 4066296.5000; val_gene_expr_recon_loss: 35351724.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 40341988.0000; val_optim_loss: 40341988.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9329; val_auprc_score: 0.9217; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1000537.0312; train_edge_recon_loss: 4059931.8750; train_gene_expr_recon_loss: 36695985.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41756454.0000; train_optim_loss: 41756454.0000; val_kl_reg_loss: 1450343.2500; val_edge_recon_loss: 4066296.5000; val_gene_expr_recon_loss: 33974916.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39491556.0000; val_optim_loss: 39491556.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9303; val_auprc_score: 0.9181; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1242188.8438; train_edge_recon_loss: 3981501.8125; train_gene_expr_recon_loss: 39420392.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44644083.0000; train_optim_loss: 44644083.0000; val_kl_reg_loss: 1081271.0000; val_edge_recon_loss: 4066297.0000; val_gene_expr_recon_loss: 33392936.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 38540504.0000; val_optim_loss: 38540504.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9282; val_auprc_score: 0.9162; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1092440.0938; train_edge_recon_loss: 4060494.2500; train_gene_expr_recon_loss: 32973861.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 38126795.0000; train_optim_loss: 38126795.0000; val_kl_reg_loss: 1067934.7500; val_edge_recon_loss: 4066297.0000; val_gene_expr_recon_loss: 32423268.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 37557500.0000; val_optim_loss: 37557500.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9275; val_auprc_score: 0.9139; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1081875.0938; train_edge_recon_loss: 4065029.3125; train_gene_expr_recon_loss: 31986289.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37133193.0000; train_optim_loss: 37133193.0000; val_kl_reg_loss: 1061386.0000; val_edge_recon_loss: 4066296.7500; val_gene_expr_recon_loss: 31447420.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36575104.0000; val_optim_loss: 36575104.0000
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9278; val_auprc_score: 0.9129; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1072808.9375; train_edge_recon_loss: 4065553.8750; train_gene_expr_recon_loss: 31043501.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 36181863.0000; train_optim_loss: 36181863.0000; val_kl_reg_loss: 1048994.5000; val_edge_recon_loss: 4066296.7500; val_gene_expr_recon_loss: 30456666.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 35571956.0000; val_optim_loss: 35571956.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 26 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9406
val AUPRC score: 0.9391
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 19.6574
val source rna MSE score: 18.5152
Duration of model training in run 3: 0 hours, 1 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1481, n_latent: 1481, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 6383
Number of validation nodes: 709
Number of training edges: 14760
Number of validation edges: 1639
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9336; val_auprc_score: 0.9398; val_best_acc_score: 0.5702; val_best_f1_score: 0.6981; train_kl_reg_loss: 1510319.8386; train_edge_recon_loss: 3562461.2500; train_gene_expr_recon_loss: 168150002.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 173222785.0000; train_optim_loss: 173222785.0000; val_kl_reg_loss: 110819.3438; val_edge_recon_loss: 4061012.5000; val_gene_expr_recon_loss: 23199716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27371548.0000; val_optim_loss: 27371548.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9286; val_auprc_score: 0.9258; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 94181.3477; train_edge_recon_loss: 3559281.0000; train_gene_expr_recon_loss: 39786025.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 43439487.0000; train_optim_loss: 43439487.0000; val_kl_reg_loss: 123668.3438; val_edge_recon_loss: 4064624.5000; val_gene_expr_recon_loss: 24545782.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28734074.0000; val_optim_loss: 28734074.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9348; val_auprc_score: 0.9366; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 159708.7656; train_edge_recon_loss: 3532262.0000; train_gene_expr_recon_loss: 25761282.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29453253.0000; train_optim_loss: 29453253.0000; val_kl_reg_loss: 138850.7188; val_edge_recon_loss: 4065574.5000; val_gene_expr_recon_loss: 26422736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30627160.0000; val_optim_loss: 30627160.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9342; val_auprc_score: 0.9402; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 126954.0078; train_edge_recon_loss: 3556017.3750; train_gene_expr_recon_loss: 26916275.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30599246.0000; train_optim_loss: 30599246.0000; val_kl_reg_loss: 88298.7812; val_edge_recon_loss: 4065934.7500; val_gene_expr_recon_loss: 26920336.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 31074570.0000; val_optim_loss: 31074570.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9311; val_auprc_score: 0.9327; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 138405.8359; train_edge_recon_loss: 3603601.7500; train_gene_expr_recon_loss: 26742963.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 30484970.0000; train_optim_loss: 30484970.0000; val_kl_reg_loss: 202839.4062; val_edge_recon_loss: 4066065.5000; val_gene_expr_recon_loss: 25969100.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30238004.0000; val_optim_loss: 30238004.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9266; val_auprc_score: 0.9294; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 179206.6562; train_edge_recon_loss: 3631287.7500; train_gene_expr_recon_loss: 25839195.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29649689.0000; train_optim_loss: 29649689.0000; val_kl_reg_loss: 186858.4688; val_edge_recon_loss: 4066126.2500; val_gene_expr_recon_loss: 24860652.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 29113636.0000; val_optim_loss: 29113636.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9299; val_auprc_score: 0.9323; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 351066.1094; train_edge_recon_loss: 3599190.3750; train_gene_expr_recon_loss: 24561345.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28511601.0000; train_optim_loss: 28511601.0000; val_kl_reg_loss: 223118.0625; val_edge_recon_loss: 4066160.2500; val_gene_expr_recon_loss: 23776662.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28065940.0000; val_optim_loss: 28065940.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9260; val_auprc_score: 0.9234; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 206222.3047; train_edge_recon_loss: 3762122.0000; train_gene_expr_recon_loss: 23596891.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 27565235.0000; train_optim_loss: 27565235.0000; val_kl_reg_loss: 187909.5938; val_edge_recon_loss: 4066191.0000; val_gene_expr_recon_loss: 23025868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 27279968.0000; val_optim_loss: 27279968.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9206; val_auprc_score: 0.9214; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 284248.2891; train_edge_recon_loss: 3766377.3750; train_gene_expr_recon_loss: 22710414.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26761040.0000; train_optim_loss: 26761040.0000; val_kl_reg_loss: 376470.8750; val_edge_recon_loss: 4066212.5000; val_gene_expr_recon_loss: 22145400.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26588084.0000; val_optim_loss: 26588084.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9271; val_auprc_score: 0.9279; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 341447.9062; train_edge_recon_loss: 3722968.3750; train_gene_expr_recon_loss: 22681409.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26745825.0000; train_optim_loss: 26745825.0000; val_kl_reg_loss: 328751.3125; val_edge_recon_loss: 4066217.7500; val_gene_expr_recon_loss: 21647956.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26042924.0000; val_optim_loss: 26042924.0000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9275; val_auprc_score: 0.9285; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 410988.1562; train_edge_recon_loss: 3703498.3750; train_gene_expr_recon_loss: 22170672.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26285159.0000; train_optim_loss: 26285159.0000; val_kl_reg_loss: 279547.6875; val_edge_recon_loss: 4066227.0000; val_gene_expr_recon_loss: 21743498.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26089272.0000; val_optim_loss: 26089272.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9248; val_auprc_score: 0.9265; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 310383.9688; train_edge_recon_loss: 3857213.0000; train_gene_expr_recon_loss: 21615693.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25783290.0000; train_optim_loss: 25783290.0000; val_kl_reg_loss: 738539.6250; val_edge_recon_loss: 4066236.2500; val_gene_expr_recon_loss: 21352484.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26157260.0000; val_optim_loss: 26157260.0000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9218; val_auprc_score: 0.9206; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 573194.4375; train_edge_recon_loss: 3764015.0000; train_gene_expr_recon_loss: 21352201.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25689411.0000; train_optim_loss: 25689411.0000; val_kl_reg_loss: 307883.2188; val_edge_recon_loss: 4066241.7500; val_gene_expr_recon_loss: 21042868.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25416992.0000; val_optim_loss: 25416992.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9200; val_auprc_score: 0.9188; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 383712.5625; train_edge_recon_loss: 3872180.8750; train_gene_expr_recon_loss: 20926376.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25182270.0000; train_optim_loss: 25182270.0000; val_kl_reg_loss: 449977.8125; val_edge_recon_loss: 4066241.7500; val_gene_expr_recon_loss: 20659106.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25175326.0000; val_optim_loss: 25175326.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9264; val_auprc_score: 0.9265; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 434629.0625; train_edge_recon_loss: 3826815.6250; train_gene_expr_recon_loss: 20563597.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24825042.0000; train_optim_loss: 24825042.0000; val_kl_reg_loss: 672440.4375; val_edge_recon_loss: 4066243.2500; val_gene_expr_recon_loss: 20351196.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25089880.0000; val_optim_loss: 25089880.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9263; val_auprc_score: 0.9265; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 551451.8750; train_edge_recon_loss: 3831255.6250; train_gene_expr_recon_loss: 20291800.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24674508.0000; train_optim_loss: 24674508.0000; val_kl_reg_loss: 399921.1875; val_edge_recon_loss: 4066244.7500; val_gene_expr_recon_loss: 20120352.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24586518.0000; val_optim_loss: 24586518.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9210; val_auprc_score: 0.9201; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1016157.6562; train_edge_recon_loss: 3764772.7500; train_gene_expr_recon_loss: 20263425.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25044355.0000; train_optim_loss: 25044355.0000; val_kl_reg_loss: 392192.6250; val_edge_recon_loss: 4066245.2500; val_gene_expr_recon_loss: 19875982.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24334420.0000; val_optim_loss: 24334420.0000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9234; val_auprc_score: 0.9224; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 384088.7812; train_edge_recon_loss: 3958824.5000; train_gene_expr_recon_loss: 19829647.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24172560.0000; train_optim_loss: 24172560.0000; val_kl_reg_loss: 416591.6562; val_edge_recon_loss: 4066245.2500; val_gene_expr_recon_loss: 19695784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24178620.0000; val_optim_loss: 24178620.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9265; val_auprc_score: 0.9250; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 492258.4688; train_edge_recon_loss: 3859439.8750; train_gene_expr_recon_loss: 19984489.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24336187.0000; train_optim_loss: 24336187.0000; val_kl_reg_loss: 371105.0000; val_edge_recon_loss: 4066246.5000; val_gene_expr_recon_loss: 19527972.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23965324.0000; val_optim_loss: 23965324.0000
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9190; val_auprc_score: 0.9184; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 459649.5312; train_edge_recon_loss: 3907393.5000; train_gene_expr_recon_loss: 19487972.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23855015.0000; train_optim_loss: 23855015.0000; val_kl_reg_loss: 387854.2500; val_edge_recon_loss: 4066247.2500; val_gene_expr_recon_loss: 19399366.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23853468.0000; val_optim_loss: 23853468.0000
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9213; val_auprc_score: 0.9215; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 522185.5469; train_edge_recon_loss: 3878415.7500; train_gene_expr_recon_loss: 19366503.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23767105.0000; train_optim_loss: 23767105.0000; val_kl_reg_loss: 379158.5312; val_edge_recon_loss: 4066244.7500; val_gene_expr_recon_loss: 19263040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23708444.0000; val_optim_loss: 23708444.0000
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9255; val_auprc_score: 0.9266; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 619628.8438; train_edge_recon_loss: 3876921.0000; train_gene_expr_recon_loss: 19309149.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23805699.0000; train_optim_loss: 23805699.0000; val_kl_reg_loss: 356890.7812; val_edge_recon_loss: 4066241.5000; val_gene_expr_recon_loss: 19147238.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23570370.0000; val_optim_loss: 23570370.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9192; val_auprc_score: 0.9184; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 362763.5625; train_edge_recon_loss: 4035968.7500; train_gene_expr_recon_loss: 19122412.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23521145.0000; train_optim_loss: 23521145.0000; val_kl_reg_loss: 449647.1875; val_edge_recon_loss: 4066244.7500; val_gene_expr_recon_loss: 19041300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23557192.0000; val_optim_loss: 23557192.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9200; val_auprc_score: 0.9215; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 448836.7812; train_edge_recon_loss: 3925495.2500; train_gene_expr_recon_loss: 20701376.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25075708.0000; train_optim_loss: 25075708.0000; val_kl_reg_loss: 452412.1250; val_edge_recon_loss: 4066242.2500; val_gene_expr_recon_loss: 18939990.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23458644.0000; val_optim_loss: 23458644.0000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9191; val_auprc_score: 0.9212; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 419596.4219; train_edge_recon_loss: 3977988.3750; train_gene_expr_recon_loss: 18921401.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23318986.0000; train_optim_loss: 23318986.0000; val_kl_reg_loss: 361181.5938; val_edge_recon_loss: 4066240.2500; val_gene_expr_recon_loss: 18858686.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23286108.0000; val_optim_loss: 23286108.0000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9180; val_auprc_score: 0.9205; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 366751.2344; train_edge_recon_loss: 4049277.7500; train_gene_expr_recon_loss: 18877788.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23293817.0000; train_optim_loss: 23293817.0000; val_kl_reg_loss: 360134.0625; val_edge_recon_loss: 4066237.5000; val_gene_expr_recon_loss: 18778842.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23205214.0000; val_optim_loss: 23205214.0000
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9112; val_auprc_score: 0.9097; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 367597.4375; train_edge_recon_loss: 4052787.3750; train_gene_expr_recon_loss: 18786018.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23206403.0000; train_optim_loss: 23206403.0000; val_kl_reg_loss: 363946.8125; val_edge_recon_loss: 4066231.7500; val_gene_expr_recon_loss: 18704518.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23134696.0000; val_optim_loss: 23134696.0000
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9156; val_auprc_score: 0.9167; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 374443.0781; train_edge_recon_loss: 4040276.2500; train_gene_expr_recon_loss: 18743175.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23157894.0000; train_optim_loss: 23157894.0000; val_kl_reg_loss: 455625.5625; val_edge_recon_loss: 4066231.7500; val_gene_expr_recon_loss: 18646206.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23168064.0000; val_optim_loss: 23168064.0000
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9194; val_auprc_score: 0.9208; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 438128.4844; train_edge_recon_loss: 3945097.7500; train_gene_expr_recon_loss: 19203057.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23586283.0000; train_optim_loss: 23586283.0000; val_kl_reg_loss: 541914.7500; val_edge_recon_loss: 4066233.2500; val_gene_expr_recon_loss: 18585564.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23193712.0000; val_optim_loss: 23193712.0000
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9201; val_auprc_score: 0.9224; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 486256.1875; train_edge_recon_loss: 3916136.3750; train_gene_expr_recon_loss: 26990579.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31392972.0000; train_optim_loss: 31392972.0000; val_kl_reg_loss: 1843778.2500; val_edge_recon_loss: 4066240.0000; val_gene_expr_recon_loss: 18577850.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24487868.0000; val_optim_loss: 24487868.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9175; val_auprc_score: 0.9200; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1242324.9375; train_edge_recon_loss: 3871703.6250; train_gene_expr_recon_loss: 18699463.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23813492.0000; train_optim_loss: 23813492.0000; val_kl_reg_loss: 350418.9375; val_edge_recon_loss: 4066242.2500; val_gene_expr_recon_loss: 18536348.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22953008.0000; val_optim_loss: 22953008.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9181; val_auprc_score: 0.9206; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 366966.2344; train_edge_recon_loss: 4035367.0000; train_gene_expr_recon_loss: 18529058.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22931391.0000; train_optim_loss: 22931391.0000; val_kl_reg_loss: 620696.3750; val_edge_recon_loss: 4066244.2500; val_gene_expr_recon_loss: 18492766.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23179706.0000; val_optim_loss: 23179706.0000
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9189; val_auprc_score: 0.9210; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 525732.8125; train_edge_recon_loss: 3910033.2500; train_gene_expr_recon_loss: 18647870.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23083636.0000; train_optim_loss: 23083636.0000; val_kl_reg_loss: 671031.3750; val_edge_recon_loss: 4066249.2500; val_gene_expr_recon_loss: 18454266.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23191546.0000; val_optim_loss: 23191546.0000
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9206; val_auprc_score: 0.9213; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 550901.4844; train_edge_recon_loss: 3912961.6250; train_gene_expr_recon_loss: 18850463.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23314326.0000; train_optim_loss: 23314326.0000; val_kl_reg_loss: 518091.4375; val_edge_recon_loss: 4066245.7500; val_gene_expr_recon_loss: 18407858.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22992196.0000; val_optim_loss: 22992196.0000
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9208; val_auprc_score: 0.9239; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 872368.0000; train_edge_recon_loss: 3800324.1250; train_gene_expr_recon_loss: 29191274.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 33863966.0000; train_optim_loss: 33863966.0000; val_kl_reg_loss: 363167.9688; val_edge_recon_loss: 4066248.2500; val_gene_expr_recon_loss: 18401584.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22831000.0000; val_optim_loss: 22831000.0000
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9153; val_auprc_score: 0.9137; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 376049.3750; train_edge_recon_loss: 4048943.7500; train_gene_expr_recon_loss: 18407176.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22832169.0000; train_optim_loss: 22832169.0000; val_kl_reg_loss: 411745.9375; val_edge_recon_loss: 4066257.2500; val_gene_expr_recon_loss: 18397210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22875212.0000; val_optim_loss: 22875212.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9131; val_auprc_score: 0.9148; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1466869.2188; train_edge_recon_loss: 3843250.2500; train_gene_expr_recon_loss: 19353154.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24663274.0000; train_optim_loss: 24663274.0000; val_kl_reg_loss: 395890.9375; val_edge_recon_loss: 4066261.0000; val_gene_expr_recon_loss: 18354848.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22817000.0000; val_optim_loss: 22817000.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9208; val_auprc_score: 0.9228; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 424338.2500; train_edge_recon_loss: 3993636.8750; train_gene_expr_recon_loss: 18351615.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22769590.0000; train_optim_loss: 22769590.0000; val_kl_reg_loss: 1127289.8750; val_edge_recon_loss: 4066260.2500; val_gene_expr_recon_loss: 18334736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23528286.0000; val_optim_loss: 23528286.0000
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9197; val_auprc_score: 0.9204; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 817810.9531; train_edge_recon_loss: 3867726.0000; train_gene_expr_recon_loss: 18549654.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23235190.0000; train_optim_loss: 23235190.0000; val_kl_reg_loss: 415170.4375; val_edge_recon_loss: 4066260.2500; val_gene_expr_recon_loss: 18289138.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22770568.0000; val_optim_loss: 22770568.0000
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9203; val_auprc_score: 0.9215; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 1386337.2500; train_edge_recon_loss: 3891166.8750; train_gene_expr_recon_loss: 21248352.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26525856.0000; train_optim_loss: 26525856.0000; val_kl_reg_loss: 399141.4688; val_edge_recon_loss: 4066260.2500; val_gene_expr_recon_loss: 18255716.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22721118.0000; val_optim_loss: 22721118.0000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9122; val_auprc_score: 0.9103; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 410750.4375; train_edge_recon_loss: 4059902.1250; train_gene_expr_recon_loss: 18251474.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22722127.0000; train_optim_loss: 22722127.0000; val_kl_reg_loss: 477786.7812; val_edge_recon_loss: 4066264.2500; val_gene_expr_recon_loss: 18234568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22778620.0000; val_optim_loss: 22778620.0000
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9192; val_auprc_score: 0.9194; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 458464.9219; train_edge_recon_loss: 4000769.1250; train_gene_expr_recon_loss: 18232239.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22691473.0000; train_optim_loss: 22691473.0000; val_kl_reg_loss: 611872.0000; val_edge_recon_loss: 4066266.0000; val_gene_expr_recon_loss: 18207002.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22885140.0000; val_optim_loss: 22885140.0000
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9141; val_auprc_score: 0.9156; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 534151.2500; train_edge_recon_loss: 3941404.1250; train_gene_expr_recon_loss: 20012434.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24487989.0000; train_optim_loss: 24487989.0000; val_kl_reg_loss: 422440.3125; val_edge_recon_loss: 4066268.5000; val_gene_expr_recon_loss: 18243920.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22732628.0000; val_optim_loss: 22732628.0000
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9140; val_auprc_score: 0.9095; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 433069.8750; train_edge_recon_loss: 4038393.2500; train_gene_expr_recon_loss: 18261257.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22732720.0000; train_optim_loss: 22732720.0000; val_kl_reg_loss: 788052.5625; val_edge_recon_loss: 4066266.0000; val_gene_expr_recon_loss: 18246226.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23100544.0000; val_optim_loss: 23100544.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9110; val_auprc_score: 0.9079; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 716720.6875; train_edge_recon_loss: 3843307.6250; train_gene_expr_recon_loss: 36731869.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 41291898.0000; train_optim_loss: 41291898.0000; val_kl_reg_loss: 483568.1250; val_edge_recon_loss: 4066269.0000; val_gene_expr_recon_loss: 18236168.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22786004.0000; val_optim_loss: 22786004.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9153; val_auprc_score: 0.9127; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 487305.4844; train_edge_recon_loss: 3975337.5000; train_gene_expr_recon_loss: 18320007.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22782650.0000; train_optim_loss: 22782650.0000; val_kl_reg_loss: 442647.0625; val_edge_recon_loss: 4066266.0000; val_gene_expr_recon_loss: 18224210.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22733124.0000; val_optim_loss: 22733124.0000
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9174; val_auprc_score: 0.9147; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 450857.7344; train_edge_recon_loss: 4024837.7500; train_gene_expr_recon_loss: 18218906.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22694602.0000; train_optim_loss: 22694602.0000; val_kl_reg_loss: 431284.5000; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 18214118.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22711670.0000; val_optim_loss: 22711670.0000
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9207; val_auprc_score: 0.9187; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 442089.1875; train_edge_recon_loss: 4042664.3750; train_gene_expr_recon_loss: 18206502.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22691256.0000; train_optim_loss: 22691256.0000; val_kl_reg_loss: 427026.5000; val_edge_recon_loss: 4066264.7500; val_gene_expr_recon_loss: 18208966.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22702256.0000; val_optim_loss: 22702256.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9189; val_auprc_score: 0.9189; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 439943.4062; train_edge_recon_loss: 4049201.0000; train_gene_expr_recon_loss: 18196830.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22685975.0000; train_optim_loss: 22685975.0000; val_kl_reg_loss: 428373.5000; val_edge_recon_loss: 4066270.0000; val_gene_expr_recon_loss: 18199604.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22694248.0000; val_optim_loss: 22694248.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9192; val_auprc_score: 0.9190; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 439075.7344; train_edge_recon_loss: 4051023.7500; train_gene_expr_recon_loss: 18191957.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22682057.0000; train_optim_loss: 22682057.0000; val_kl_reg_loss: 427588.5625; val_edge_recon_loss: 4066263.7500; val_gene_expr_recon_loss: 18189086.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22682938.0000; val_optim_loss: 22682938.0000
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9149; val_auprc_score: 0.9119; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 439889.7812; train_edge_recon_loss: 4048987.0000; train_gene_expr_recon_loss: 18190808.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22679685.0000; train_optim_loss: 22679685.0000; val_kl_reg_loss: 427406.2500; val_edge_recon_loss: 4066265.5000; val_gene_expr_recon_loss: 18181432.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22675104.0000; val_optim_loss: 22675104.0000
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9149; val_auprc_score: 0.9112; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 437938.7812; train_edge_recon_loss: 4051326.7500; train_gene_expr_recon_loss: 18178318.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22667583.0000; train_optim_loss: 22667583.0000; val_kl_reg_loss: 423589.1875; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 18172618.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22662474.0000; val_optim_loss: 22662474.0000
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9117; val_auprc_score: 0.9064; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 435915.7344; train_edge_recon_loss: 4054966.5000; train_gene_expr_recon_loss: 18168994.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22659877.0000; train_optim_loss: 22659877.0000; val_kl_reg_loss: 424533.9375; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 18167338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22658140.0000; val_optim_loss: 22658140.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9133; val_auprc_score: 0.9133; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 434667.8438; train_edge_recon_loss: 4056353.3750; train_gene_expr_recon_loss: 18163306.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22654327.0000; train_optim_loss: 22654327.0000; val_kl_reg_loss: 422360.4375; val_edge_recon_loss: 4066268.2500; val_gene_expr_recon_loss: 18157476.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22646104.0000; val_optim_loss: 22646104.0000
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9087; val_auprc_score: 0.9032; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 433461.7500; train_edge_recon_loss: 4056275.6250; train_gene_expr_recon_loss: 18155724.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22645461.0000; train_optim_loss: 22645461.0000; val_kl_reg_loss: 420421.2812; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 18150202.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22636890.0000; val_optim_loss: 22636890.0000
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9161; val_auprc_score: 0.9167; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 432960.2969; train_edge_recon_loss: 4055740.0000; train_gene_expr_recon_loss: 18148883.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22637583.0000; train_optim_loss: 22637583.0000; val_kl_reg_loss: 420741.3438; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 18145108.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22632116.0000; val_optim_loss: 22632116.0000
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9145; val_auprc_score: 0.9103; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 432059.4688; train_edge_recon_loss: 4054556.6250; train_gene_expr_recon_loss: 18144326.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22630942.0000; train_optim_loss: 22630942.0000; val_kl_reg_loss: 418409.8125; val_edge_recon_loss: 4066267.5000; val_gene_expr_recon_loss: 18139124.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22623802.0000; val_optim_loss: 22623802.0000
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9149; val_auprc_score: 0.9134; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 431926.0781; train_edge_recon_loss: 4052671.6250; train_gene_expr_recon_loss: 18143464.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22628061.0000; train_optim_loss: 22628061.0000; val_kl_reg_loss: 420057.3750; val_edge_recon_loss: 4066264.7500; val_gene_expr_recon_loss: 18134202.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22620524.0000; val_optim_loss: 22620524.0000
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9105; val_auprc_score: 0.9035; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 432011.2812; train_edge_recon_loss: 4049834.7500; train_gene_expr_recon_loss: 18135942.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22617788.0000; train_optim_loss: 22617788.0000; val_kl_reg_loss: 420706.9375; val_edge_recon_loss: 4066266.0000; val_gene_expr_recon_loss: 18132614.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22619588.0000; val_optim_loss: 22619588.0000
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9178; val_auprc_score: 0.9172; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 432990.4375; train_edge_recon_loss: 4045815.3750; train_gene_expr_recon_loss: 18135367.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22614173.0000; train_optim_loss: 22614173.0000; val_kl_reg_loss: 421830.2500; val_edge_recon_loss: 4066263.2500; val_gene_expr_recon_loss: 18130598.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22618692.0000; val_optim_loss: 22618692.0000
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9090; val_auprc_score: 0.9042; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 435000.2969; train_edge_recon_loss: 4039679.5000; train_gene_expr_recon_loss: 18126066.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22600746.0000; train_optim_loss: 22600746.0000; val_kl_reg_loss: 424893.8750; val_edge_recon_loss: 4066266.0000; val_gene_expr_recon_loss: 18121590.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22612750.0000; val_optim_loss: 22612750.0000
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9152; val_auprc_score: 0.9138; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 439735.5938; train_edge_recon_loss: 4027126.6250; train_gene_expr_recon_loss: 18128957.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22595820.0000; train_optim_loss: 22595820.0000; val_kl_reg_loss: 434850.4688; val_edge_recon_loss: 4066263.7500; val_gene_expr_recon_loss: 18123322.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22624436.0000; val_optim_loss: 22624436.0000
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9177; val_auprc_score: 0.9174; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 453676.7188; train_edge_recon_loss: 4001838.7500; train_gene_expr_recon_loss: 18123390.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22578905.0000; train_optim_loss: 22578905.0000; val_kl_reg_loss: 465387.3750; val_edge_recon_loss: 4066263.2500; val_gene_expr_recon_loss: 18123480.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22655130.0000; val_optim_loss: 22655130.0000
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9187; val_auprc_score: 0.9201; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 483394.6719; train_edge_recon_loss: 3963735.1250; train_gene_expr_recon_loss: 18125172.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22572302.0000; train_optim_loss: 22572302.0000; val_kl_reg_loss: 475111.3125; val_edge_recon_loss: 4066264.0000; val_gene_expr_recon_loss: 18117184.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22658560.0000; val_optim_loss: 22658560.0000
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9119; val_auprc_score: 0.9092; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 496372.2656; train_edge_recon_loss: 3953758.1250; train_gene_expr_recon_loss: 18118454.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22568584.0000; train_optim_loss: 22568584.0000; val_kl_reg_loss: 486371.4375; val_edge_recon_loss: 4066267.0000; val_gene_expr_recon_loss: 18113568.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22666206.0000; val_optim_loss: 22666206.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9162; val_auprc_score: 0.9147; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 504882.3281; train_edge_recon_loss: 3944640.7500; train_gene_expr_recon_loss: 18117458.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22566981.0000; train_optim_loss: 22566981.0000; val_kl_reg_loss: 484771.7188; val_edge_recon_loss: 4066264.0000; val_gene_expr_recon_loss: 18109818.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22660854.0000; val_optim_loss: 22660854.0000
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9145; val_auprc_score: 0.9086; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 505282.8281; train_edge_recon_loss: 3942602.7500; train_gene_expr_recon_loss: 18112797.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22560683.0000; train_optim_loss: 22560683.0000; val_kl_reg_loss: 484698.2500; val_edge_recon_loss: 4066259.7500; val_gene_expr_recon_loss: 18112948.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22663906.0000; val_optim_loss: 22663906.0000
Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9163; val_auprc_score: 0.9154; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 503077.4531; train_edge_recon_loss: 3943660.2500; train_gene_expr_recon_loss: 18118281.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22565019.0000; train_optim_loss: 22565019.0000; val_kl_reg_loss: 480301.1875; val_edge_recon_loss: 4066262.5000; val_gene_expr_recon_loss: 18112834.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22659398.0000; val_optim_loss: 22659398.0000
Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9192; val_auprc_score: 0.9181; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 500414.9219; train_edge_recon_loss: 3944859.8750; train_gene_expr_recon_loss: 18117331.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22562606.0000; train_optim_loss: 22562606.0000; val_kl_reg_loss: 478527.7500; val_edge_recon_loss: 4066261.7500; val_gene_expr_recon_loss: 18112784.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22657574.0000; val_optim_loss: 22657574.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 24 sec.
Using best model state, which was in epoch 61.

--- MODEL EVALUATION ---
val AUROC score: 0.9122
val AUPRC score: 0.9074
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 21.1643
val source rna MSE score: 18.9754
Duration of model training in run 2: 0 hours, 1 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Filtering genes...
Starting with 29239 genes.
Keeping 29239 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 3000, n_cat_covariates_embed_input: 0, n_hidden: 1481, n_latent: 1481, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1481, n_addon_gp_input: 0, n_cat_covariates_embed_input: 0, n_output: 3000

--- INITIALIZING TRAINER ---
Number of training nodes: 6383
Number of validation nodes: 709
Number of training edges: 14760
Number of validation edges: 1639
Edge batch size: 8192
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9455; val_auprc_score: 0.9495; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 527894.9585; train_edge_recon_loss: 3509477.2500; train_gene_expr_recon_loss: 239777876.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 243815245.0000; train_optim_loss: 243815245.0000; val_kl_reg_loss: 410001428959452857737674752.0000; val_edge_recon_loss: 4064572.2500; val_gene_expr_recon_loss: 137168016.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410001428959452857737674752.0000; val_optim_loss: 410001428959452857737674752.0000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9405; val_auprc_score: 0.9462; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 6055590300975696678777520128.0000; train_edge_recon_loss: 4068414.0000; train_gene_expr_recon_loss: 490627824.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6055590300975696678777520128.0000; train_optim_loss: 6055590300975696678777520128.0000; val_kl_reg_loss: 8249506731291466093450756096.0000; val_edge_recon_loss: 4065122.5000; val_gene_expr_recon_loss: 183638112.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8249506731291466093450756096.0000; val_optim_loss: 8249506731291466093450756096.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9412; val_auprc_score: 0.9416; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5260561899562375966529421312.0000; train_edge_recon_loss: 4053398.1250; train_gene_expr_recon_loss: 488832624.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 5260561899562375966529421312.0000; train_optim_loss: 5260561899562375966529421312.0000; val_kl_reg_loss: 2926810294730732770022129664.0000; val_edge_recon_loss: 4065500.0000; val_gene_expr_recon_loss: 252583248.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2926810294730732770022129664.0000; val_optim_loss: 2926810294730732770022129664.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9399; val_auprc_score: 0.9466; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 5107673808939945305971884032.0000; train_edge_recon_loss: 4100822.8750; train_gene_expr_recon_loss: 488505936.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 5107673808939945305971884032.0000; train_optim_loss: 5107673808939945305971884032.0000; val_kl_reg_loss: 2469964133959345601756790784.0000; val_edge_recon_loss: 4065740.5000; val_gene_expr_recon_loss: 289973728.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2469964133959345601756790784.0000; val_optim_loss: 2469964133959345601756790784.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9399; val_auprc_score: 0.9395; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4299068308740469184381583360.0000; train_edge_recon_loss: 4041216.6250; train_gene_expr_recon_loss: 488194192.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4299068308740469184381583360.0000; train_optim_loss: 4299068308740469184381583360.0000; val_kl_reg_loss: 801891623226408793184141312.0000; val_edge_recon_loss: 4065838.7500; val_gene_expr_recon_loss: 305837856.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 801891623226408793184141312.0000; val_optim_loss: 801891623226408793184141312.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9406; val_auprc_score: 0.9465; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4975710229055204864003407872.0000; train_edge_recon_loss: 4084976.7500; train_gene_expr_recon_loss: 488156720.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4975710229055204864003407872.0000; train_optim_loss: 4975710229055204864003407872.0000; val_kl_reg_loss: 3577143025925686118099976192.0000; val_edge_recon_loss: 4065911.7500; val_gene_expr_recon_loss: 310383040.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 3577143025925686118099976192.0000; val_optim_loss: 3577143025925686118099976192.0000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9383; val_auprc_score: 0.9391; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4943451300888864548519411712.0000; train_edge_recon_loss: 4078558.1250; train_gene_expr_recon_loss: 487729760.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4943451300888864548519411712.0000; train_optim_loss: 4943451300888864548519411712.0000; val_kl_reg_loss: 4513772176623663500786401280.0000; val_edge_recon_loss: 4065970.5000; val_gene_expr_recon_loss: 304480928.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 4513772176623663500786401280.0000; val_optim_loss: 4513772176623663500786401280.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9437; val_auprc_score: 0.9482; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4429499037979660657448976384.0000; train_edge_recon_loss: 4059631.2500; train_gene_expr_recon_loss: 487441920.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4429499037979660657448976384.0000; train_optim_loss: 4429499037979660657448976384.0000; val_kl_reg_loss: 2301518206959100895042732032.0000; val_edge_recon_loss: 4065972.0000; val_gene_expr_recon_loss: 297302592.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2301518206959100895042732032.0000; val_optim_loss: 2301518206959100895042732032.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9392; val_auprc_score: 0.9400; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 4497690083779274629172953088.0000; train_edge_recon_loss: 4057109.3750; train_gene_expr_recon_loss: 487246000.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 4497690083779274629172953088.0000; train_optim_loss: 4497690083779274629172953088.0000; val_kl_reg_loss: 512309764816880792594546688.0000; val_edge_recon_loss: 4065993.2500; val_gene_expr_recon_loss: 296418240.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 512309764816880792594546688.0000; val_optim_loss: 512309764816880792594546688.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 9 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9433
val AUPRC score: 0.9460
val best accuracy score: 0.5000
val best F1 score: 0.6667
val target rna MSE score: 33563.4073
val source rna MSE score: 56.0277
Duration of model training in run 1: 0 hours, 0 minutes and 12 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
