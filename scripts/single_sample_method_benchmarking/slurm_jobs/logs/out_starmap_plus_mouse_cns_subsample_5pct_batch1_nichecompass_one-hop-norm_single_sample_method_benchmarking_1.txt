Run timestamp: 15062023_155642.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '4096', '4096', '2048', '2048', '1024', '1024', '512', '512', '256', '256', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'Main_molecular_cell_type', '--nichenet_keep_target_genes_ratio', '0.01', '--nichenet_max_n_target_genes_per_gp', '25344', '--include_mebocost_gps', '--mebocost_species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'starmap_plus_mouse_cns_subsample_5pct_batch1', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '0.', '--contrastive_logits_ratio', '0.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 9818
Number of validation edges: 1090
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7679; val_auprc_score: 0.8036; val_best_acc_score: 0.6697; val_best_f1_score: 0.7140; train_kl_reg_loss: 68.7747; train_edge_recon_loss: 346082.8958; train_gene_expr_recon_loss: 203917.8385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 550069.5000; train_optim_loss: 550069.5000; val_kl_reg_loss: 188.8091; val_edge_recon_loss: 395628.5625; val_gene_expr_recon_loss: 161032.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 556849.5000; val_optim_loss: 556849.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7484; val_auprc_score: 0.7708; val_best_acc_score: 0.6619; val_best_f1_score: 0.7253; train_kl_reg_loss: 233.1212; train_edge_recon_loss: 345402.2500; train_gene_expr_recon_loss: 157649.6719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 503285.0417; train_optim_loss: 503285.0417; val_kl_reg_loss: 247.8509; val_edge_recon_loss: 378352.7812; val_gene_expr_recon_loss: 160189.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 538790.1250; val_optim_loss: 538790.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7740; val_auprc_score: 0.7889; val_best_acc_score: 0.6849; val_best_f1_score: 0.7306; train_kl_reg_loss: 238.6695; train_edge_recon_loss: 343836.0000; train_gene_expr_recon_loss: 166294.4844; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 510369.1562; train_optim_loss: 510369.1562; val_kl_reg_loss: 219.5508; val_edge_recon_loss: 342069.5000; val_gene_expr_recon_loss: 160658.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 502947.9375; val_optim_loss: 502947.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7516; val_auprc_score: 0.7715; val_best_acc_score: 0.6725; val_best_f1_score: 0.7227; train_kl_reg_loss: 313.6521; train_edge_recon_loss: 338729.1354; train_gene_expr_recon_loss: 167001.0677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 506043.8542; train_optim_loss: 506043.8542; val_kl_reg_loss: 429.1631; val_edge_recon_loss: 334661.7500; val_gene_expr_recon_loss: 157735.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 492826.5000; val_optim_loss: 492826.5000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7266; val_auprc_score: 0.7471; val_best_acc_score: 0.6587; val_best_f1_score: 0.7036; train_kl_reg_loss: 584.8217; train_edge_recon_loss: 327593.8958; train_gene_expr_recon_loss: 158529.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486708.6458; train_optim_loss: 486708.6458; val_kl_reg_loss: 895.1766; val_edge_recon_loss: 328259.8750; val_gene_expr_recon_loss: 156641.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 485796.3125; val_optim_loss: 485796.3125
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7265; val_auprc_score: 0.7488; val_best_acc_score: 0.6693; val_best_f1_score: 0.6994; train_kl_reg_loss: 1344.5914; train_edge_recon_loss: 310205.4896; train_gene_expr_recon_loss: 157110.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468660.3542; train_optim_loss: 468660.3542; val_kl_reg_loss: 2297.3257; val_edge_recon_loss: 327476.4688; val_gene_expr_recon_loss: 155591.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 485364.8750; val_optim_loss: 485364.8750
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7516; val_auprc_score: 0.7668; val_best_acc_score: 0.6835; val_best_f1_score: 0.7126; train_kl_reg_loss: 2966.2931; train_edge_recon_loss: 302323.1562; train_gene_expr_recon_loss: 150444.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455734.1146; train_optim_loss: 455734.1146; val_kl_reg_loss: 3961.3369; val_edge_recon_loss: 318912.8438; val_gene_expr_recon_loss: 154385.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477259.3750; val_optim_loss: 477259.3750
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7553; val_auprc_score: 0.7595; val_best_acc_score: 0.6766; val_best_f1_score: 0.7198; train_kl_reg_loss: 4282.4085; train_edge_recon_loss: 296619.6562; train_gene_expr_recon_loss: 145113.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446015.1250; train_optim_loss: 446015.1250; val_kl_reg_loss: 4870.3071; val_edge_recon_loss: 314604.0312; val_gene_expr_recon_loss: 153773.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473247.5312; val_optim_loss: 473247.5312
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7939; val_auprc_score: 0.7917; val_best_acc_score: 0.7151; val_best_f1_score: 0.7363; train_kl_reg_loss: 5245.7389; train_edge_recon_loss: 288406.7188; train_gene_expr_recon_loss: 158377.1198; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452029.5833; train_optim_loss: 452029.5833; val_kl_reg_loss: 5174.9912; val_edge_recon_loss: 300295.3438; val_gene_expr_recon_loss: 153176.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458647.0000; val_optim_loss: 458647.0000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8277; val_auprc_score: 0.8208; val_best_acc_score: 0.7532; val_best_f1_score: 0.7642; train_kl_reg_loss: 5361.7419; train_edge_recon_loss: 281680.3333; train_gene_expr_recon_loss: 157440.4323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444482.5000; train_optim_loss: 444482.5000; val_kl_reg_loss: 5058.0098; val_edge_recon_loss: 289582.7500; val_gene_expr_recon_loss: 152703.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447344.2812; val_optim_loss: 447344.2812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8378; val_auprc_score: 0.8173; val_best_acc_score: 0.7642; val_best_f1_score: 0.7888; train_kl_reg_loss: 4971.0589; train_edge_recon_loss: 278300.7083; train_gene_expr_recon_loss: 151014.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 434286.5729; train_optim_loss: 434286.5729; val_kl_reg_loss: 4790.0376; val_edge_recon_loss: 287279.4375; val_gene_expr_recon_loss: 152629.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444698.8438; val_optim_loss: 444698.8438
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8577; val_auprc_score: 0.8371; val_best_acc_score: 0.7830; val_best_f1_score: 0.8042; train_kl_reg_loss: 4713.6284; train_edge_recon_loss: 273626.7396; train_gene_expr_recon_loss: 148482.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426823.2604; train_optim_loss: 426823.2604; val_kl_reg_loss: 4543.8071; val_edge_recon_loss: 284076.4375; val_gene_expr_recon_loss: 152397.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441017.3750; val_optim_loss: 441017.3750
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8712; val_auprc_score: 0.8456; val_best_acc_score: 0.7867; val_best_f1_score: 0.8099; train_kl_reg_loss: 4534.8537; train_edge_recon_loss: 273808.8021; train_gene_expr_recon_loss: 142278.8177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420622.4688; train_optim_loss: 420622.4688; val_kl_reg_loss: 4330.2969; val_edge_recon_loss: 281547.7500; val_gene_expr_recon_loss: 152312.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438190.0625; val_optim_loss: 438190.0625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8820; val_auprc_score: 0.8617; val_best_acc_score: 0.8005; val_best_f1_score: 0.8224; train_kl_reg_loss: 4197.7069; train_edge_recon_loss: 271826.1250; train_gene_expr_recon_loss: 144788.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420812.7188; train_optim_loss: 420812.7188; val_kl_reg_loss: 4181.6475; val_edge_recon_loss: 277843.6250; val_gene_expr_recon_loss: 152032.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 434057.8750; val_optim_loss: 434057.8750
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8788; val_auprc_score: 0.8561; val_best_acc_score: 0.7991; val_best_f1_score: 0.8196; train_kl_reg_loss: 4294.1203; train_edge_recon_loss: 273407.1250; train_gene_expr_recon_loss: 161337.0052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439038.2604; train_optim_loss: 439038.2604; val_kl_reg_loss: 4092.0557; val_edge_recon_loss: 277764.8750; val_gene_expr_recon_loss: 151728.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433585.2188; val_optim_loss: 433585.2188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8826; val_auprc_score: 0.8591; val_best_acc_score: 0.8023; val_best_f1_score: 0.8257; train_kl_reg_loss: 4142.5439; train_edge_recon_loss: 270486.8958; train_gene_expr_recon_loss: 150495.5312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425124.9688; train_optim_loss: 425124.9688; val_kl_reg_loss: 4069.7224; val_edge_recon_loss: 276723.9375; val_gene_expr_recon_loss: 151777.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432570.8125; val_optim_loss: 432570.8125
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8915; val_auprc_score: 0.8662; val_best_acc_score: 0.8183; val_best_f1_score: 0.8342; train_kl_reg_loss: 4212.3438; train_edge_recon_loss: 271646.3958; train_gene_expr_recon_loss: 149146.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425005.2500; train_optim_loss: 425005.2500; val_kl_reg_loss: 4047.2454; val_edge_recon_loss: 273115.5625; val_gene_expr_recon_loss: 151752.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428915.5000; val_optim_loss: 428915.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9010; val_auprc_score: 0.8807; val_best_acc_score: 0.8252; val_best_f1_score: 0.8412; train_kl_reg_loss: 4057.6877; train_edge_recon_loss: 271664.2292; train_gene_expr_recon_loss: 147600.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 423322.2188; train_optim_loss: 423322.2188; val_kl_reg_loss: 4061.2812; val_edge_recon_loss: 271564.1250; val_gene_expr_recon_loss: 151490.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427115.5938; val_optim_loss: 427115.5938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9131; val_auprc_score: 0.8945; val_best_acc_score: 0.8427; val_best_f1_score: 0.8541; train_kl_reg_loss: 4146.1618; train_edge_recon_loss: 269653.7604; train_gene_expr_recon_loss: 150815.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424615.6875; train_optim_loss: 424615.6875; val_kl_reg_loss: 4019.9497; val_edge_recon_loss: 268877.3125; val_gene_expr_recon_loss: 151245.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424142.2500; val_optim_loss: 424142.2500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9108; val_auprc_score: 0.8831; val_best_acc_score: 0.8413; val_best_f1_score: 0.8520; train_kl_reg_loss: 4149.9857; train_edge_recon_loss: 268473.5729; train_gene_expr_recon_loss: 155045.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427669.1979; train_optim_loss: 427669.1979; val_kl_reg_loss: 3979.6885; val_edge_recon_loss: 271802.5312; val_gene_expr_recon_loss: 151065.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426847.3125; val_optim_loss: 426847.3125
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9109; val_auprc_score: 0.8878; val_best_acc_score: 0.8413; val_best_f1_score: 0.8557; train_kl_reg_loss: 3853.0920; train_edge_recon_loss: 268857.8958; train_gene_expr_recon_loss: 145857.1354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418568.1250; train_optim_loss: 418568.1250; val_kl_reg_loss: 3960.5557; val_edge_recon_loss: 273609.6875; val_gene_expr_recon_loss: 150999.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428569.7812; val_optim_loss: 428569.7812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9237; val_auprc_score: 0.9054; val_best_acc_score: 0.8583; val_best_f1_score: 0.8680; train_kl_reg_loss: 3924.3936; train_edge_recon_loss: 269469.1354; train_gene_expr_recon_loss: 141321.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414715.5104; train_optim_loss: 414715.5104; val_kl_reg_loss: 3901.9033; val_edge_recon_loss: 269436.9375; val_gene_expr_recon_loss: 151198.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424536.8750; val_optim_loss: 424536.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9097; val_auprc_score: 0.8798; val_best_acc_score: 0.8482; val_best_f1_score: 0.8604; train_kl_reg_loss: 3952.0842; train_edge_recon_loss: 266994.2812; train_gene_expr_recon_loss: 150025.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420972.2500; train_optim_loss: 420972.2500; val_kl_reg_loss: 3899.2209; val_edge_recon_loss: 273972.3750; val_gene_expr_recon_loss: 151054.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428925.9375; val_optim_loss: 428925.9375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9001; val_auprc_score: 0.8667; val_best_acc_score: 0.8339; val_best_f1_score: 0.8482; train_kl_reg_loss: 3997.9398; train_edge_recon_loss: 267931.1250; train_gene_expr_recon_loss: 144022.3958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415951.4583; train_optim_loss: 415951.4583; val_kl_reg_loss: 3912.6899; val_edge_recon_loss: 276405.2188; val_gene_expr_recon_loss: 150684.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 431002.5312; val_optim_loss: 431002.5312
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9170; val_auprc_score: 0.8961; val_best_acc_score: 0.8509; val_best_f1_score: 0.8639; train_kl_reg_loss: 4019.2468; train_edge_recon_loss: 267762.1042; train_gene_expr_recon_loss: 153521.4896; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425302.8333; train_optim_loss: 425302.8333; val_kl_reg_loss: 3893.3967; val_edge_recon_loss: 270123.3750; val_gene_expr_recon_loss: 150224.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424241.5625; val_optim_loss: 424241.5625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 18 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
Val AUROC score: 0.8966
Val AUPRC score: 0.8778
Val best accuracy score: 0.8266
Val best F1 score: 0.8421
Val gene expr MSE score: 1.1713
Duration of model training in run 1: 0 hours, 0 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 9818
Number of validation edges: 1090
Edge batch size: 4096
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7909; val_auprc_score: 0.8190; val_best_acc_score: 0.6711; val_best_f1_score: 0.7119; train_kl_reg_loss: 66.5771; train_edge_recon_loss: 346272.6979; train_gene_expr_recon_loss: 206724.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 553063.3958; train_optim_loss: 553063.3958; val_kl_reg_loss: 196.4082; val_edge_recon_loss: 395989.7812; val_gene_expr_recon_loss: 159306.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 555492.3750; val_optim_loss: 555492.3750
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7889; val_auprc_score: 0.8175; val_best_acc_score: 0.6936; val_best_f1_score: 0.7221; train_kl_reg_loss: 247.1484; train_edge_recon_loss: 345785.0208; train_gene_expr_recon_loss: 161201.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 507233.6667; train_optim_loss: 507233.6667; val_kl_reg_loss: 241.2058; val_edge_recon_loss: 378473.8750; val_gene_expr_recon_loss: 156559.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 535274.4375; val_optim_loss: 535274.4375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7809; val_auprc_score: 0.8060; val_best_acc_score: 0.7023; val_best_f1_score: 0.7268; train_kl_reg_loss: 213.5249; train_edge_recon_loss: 343898.6562; train_gene_expr_recon_loss: 153317.1719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497429.3438; train_optim_loss: 497429.3438; val_kl_reg_loss: 207.6528; val_edge_recon_loss: 347504.4062; val_gene_expr_recon_loss: 158664.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 506376.2500; val_optim_loss: 506376.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7661; val_auprc_score: 0.7856; val_best_acc_score: 0.6858; val_best_f1_score: 0.7241; train_kl_reg_loss: 247.4441; train_edge_recon_loss: 339809.3229; train_gene_expr_recon_loss: 162277.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 502334.6458; train_optim_loss: 502334.6458; val_kl_reg_loss: 372.8886; val_edge_recon_loss: 335486.0312; val_gene_expr_recon_loss: 156386.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 492245.7188; val_optim_loss: 492245.7188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7549; val_auprc_score: 0.7649; val_best_acc_score: 0.6734; val_best_f1_score: 0.7222; train_kl_reg_loss: 467.5643; train_edge_recon_loss: 329068.3333; train_gene_expr_recon_loss: 161671.1875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491207.0938; train_optim_loss: 491207.0938; val_kl_reg_loss: 815.4959; val_edge_recon_loss: 320486.7812; val_gene_expr_recon_loss: 154181.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 475483.9688; val_optim_loss: 475483.9688
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7368; val_auprc_score: 0.7505; val_best_acc_score: 0.6647; val_best_f1_score: 0.7090; train_kl_reg_loss: 1202.2941; train_edge_recon_loss: 313335.0729; train_gene_expr_recon_loss: 160712.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475249.6667; train_optim_loss: 475249.6667; val_kl_reg_loss: 2055.3669; val_edge_recon_loss: 324424.7812; val_gene_expr_recon_loss: 152981.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479461.7812; val_optim_loss: 479461.7812
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7392; val_auprc_score: 0.7433; val_best_acc_score: 0.6661; val_best_f1_score: 0.7079; train_kl_reg_loss: 2674.5015; train_edge_recon_loss: 305004.5625; train_gene_expr_recon_loss: 160269.7552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467948.8229; train_optim_loss: 467948.8229; val_kl_reg_loss: 3526.5154; val_edge_recon_loss: 320753.8750; val_gene_expr_recon_loss: 152413.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476693.7812; val_optim_loss: 476693.7812
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7652; val_auprc_score: 0.7702; val_best_acc_score: 0.6945; val_best_f1_score: 0.7162; train_kl_reg_loss: 3967.2574; train_edge_recon_loss: 301211.7396; train_gene_expr_recon_loss: 157740.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462919.7917; train_optim_loss: 462919.7917; val_kl_reg_loss: 4383.0684; val_edge_recon_loss: 314321.5000; val_gene_expr_recon_loss: 151721.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470425.6875; val_optim_loss: 470425.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7830; val_auprc_score: 0.7854; val_best_acc_score: 0.7009; val_best_f1_score: 0.7366; train_kl_reg_loss: 4938.9427; train_edge_recon_loss: 294947.4375; train_gene_expr_recon_loss: 160383.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460270.2292; train_optim_loss: 460270.2292; val_kl_reg_loss: 4655.9355; val_edge_recon_loss: 304098.5000; val_gene_expr_recon_loss: 151160.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459915.1875; val_optim_loss: 459915.1875
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8145; val_auprc_score: 0.8035; val_best_acc_score: 0.7463; val_best_f1_score: 0.7587; train_kl_reg_loss: 4742.4915; train_edge_recon_loss: 287050.5208; train_gene_expr_recon_loss: 153086.5885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444879.6042; train_optim_loss: 444879.6042; val_kl_reg_loss: 4548.8730; val_edge_recon_loss: 296380.6562; val_gene_expr_recon_loss: 150896.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451826.4062; val_optim_loss: 451826.4062
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8396; val_auprc_score: 0.8307; val_best_acc_score: 0.7619; val_best_f1_score: 0.7770; train_kl_reg_loss: 4614.4019; train_edge_recon_loss: 281487.2812; train_gene_expr_recon_loss: 150996.6354; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437098.3125; train_optim_loss: 437098.3125; val_kl_reg_loss: 4364.1421; val_edge_recon_loss: 291950.6562; val_gene_expr_recon_loss: 150490.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446804.9375; val_optim_loss: 446804.9375
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8636; val_auprc_score: 0.8480; val_best_acc_score: 0.7922; val_best_f1_score: 0.8085; train_kl_reg_loss: 4394.2707; train_edge_recon_loss: 278220.7812; train_gene_expr_recon_loss: 155372.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437987.8542; train_optim_loss: 437987.8542; val_kl_reg_loss: 4207.1382; val_edge_recon_loss: 283383.5000; val_gene_expr_recon_loss: 149950.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437540.7812; val_optim_loss: 437540.7812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8715; val_auprc_score: 0.8485; val_best_acc_score: 0.7950; val_best_f1_score: 0.8110; train_kl_reg_loss: 4194.3260; train_edge_recon_loss: 273419.7812; train_gene_expr_recon_loss: 166532.2760; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444146.3854; train_optim_loss: 444146.3854; val_kl_reg_loss: 4102.4380; val_edge_recon_loss: 283984.8125; val_gene_expr_recon_loss: 149798.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437886.0625; val_optim_loss: 437886.0625
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8931; val_auprc_score: 0.8705; val_best_acc_score: 0.8161; val_best_f1_score: 0.8320; train_kl_reg_loss: 4244.0439; train_edge_recon_loss: 271946.4688; train_gene_expr_recon_loss: 160374.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 436564.6146; train_optim_loss: 436564.6146; val_kl_reg_loss: 4057.5000; val_edge_recon_loss: 274211.3438; val_gene_expr_recon_loss: 150002.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428271.5625; val_optim_loss: 428271.5625
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8992; val_auprc_score: 0.8814; val_best_acc_score: 0.8174; val_best_f1_score: 0.8298; train_kl_reg_loss: 4113.8835; train_edge_recon_loss: 271814.6354; train_gene_expr_recon_loss: 144256.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420184.8333; train_optim_loss: 420184.8333; val_kl_reg_loss: 4060.6167; val_edge_recon_loss: 275200.6875; val_gene_expr_recon_loss: 149965.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429226.8750; val_optim_loss: 429226.8750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8901; val_auprc_score: 0.8640; val_best_acc_score: 0.8073; val_best_f1_score: 0.8231; train_kl_reg_loss: 4181.0615; train_edge_recon_loss: 272335.1354; train_gene_expr_recon_loss: 161977.0052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438493.2083; train_optim_loss: 438493.2083; val_kl_reg_loss: 4108.3540; val_edge_recon_loss: 278919.4375; val_gene_expr_recon_loss: 149408.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432436.5625; val_optim_loss: 432436.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9095; val_auprc_score: 0.8896; val_best_acc_score: 0.8307; val_best_f1_score: 0.8422; train_kl_reg_loss: 4091.8252; train_edge_recon_loss: 271569.0000; train_gene_expr_recon_loss: 142749.1094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418409.9375; train_optim_loss: 418409.9375; val_kl_reg_loss: 4057.2283; val_edge_recon_loss: 270579.2812; val_gene_expr_recon_loss: 149261.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423897.6875; val_optim_loss: 423897.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9029; val_auprc_score: 0.8801; val_best_acc_score: 0.8257; val_best_f1_score: 0.8395; train_kl_reg_loss: 4246.5086; train_edge_recon_loss: 270508.4479; train_gene_expr_recon_loss: 156222.8490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 430977.8125; train_optim_loss: 430977.8125; val_kl_reg_loss: 4054.1694; val_edge_recon_loss: 273941.0625; val_gene_expr_recon_loss: 149098.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427093.4375; val_optim_loss: 427093.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9115; val_auprc_score: 0.8878; val_best_acc_score: 0.8413; val_best_f1_score: 0.8507; train_kl_reg_loss: 4234.0181; train_edge_recon_loss: 268647.6250; train_gene_expr_recon_loss: 147107.8594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419989.5000; train_optim_loss: 419989.5000; val_kl_reg_loss: 4038.5352; val_edge_recon_loss: 272335.5000; val_gene_expr_recon_loss: 149012.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425386.9375; val_optim_loss: 425386.9375
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9122; val_auprc_score: 0.8895; val_best_acc_score: 0.8399; val_best_f1_score: 0.8536; train_kl_reg_loss: 4022.4860; train_edge_recon_loss: 268661.4896; train_gene_expr_recon_loss: 144372.9505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417056.9167; train_optim_loss: 417056.9167; val_kl_reg_loss: 4055.7273; val_edge_recon_loss: 273965.9375; val_gene_expr_recon_loss: 148997.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427018.6875; val_optim_loss: 427018.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9191; val_auprc_score: 0.8973; val_best_acc_score: 0.8427; val_best_f1_score: 0.8542; train_kl_reg_loss: 4221.8569; train_edge_recon_loss: 269343.2812; train_gene_expr_recon_loss: 150625.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424190.8021; train_optim_loss: 424190.8021; val_kl_reg_loss: 4052.9495; val_edge_recon_loss: 270515.9062; val_gene_expr_recon_loss: 148873.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423441.9688; val_optim_loss: 423441.9688
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9146; val_auprc_score: 0.8875; val_best_acc_score: 0.8463; val_best_f1_score: 0.8560; train_kl_reg_loss: 4102.5656; train_edge_recon_loss: 267103.2500; train_gene_expr_recon_loss: 146318.8698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417524.6771; train_optim_loss: 417524.6771; val_kl_reg_loss: 4050.3538; val_edge_recon_loss: 272588.1250; val_gene_expr_recon_loss: 148580.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425219.4375; val_optim_loss: 425219.4375
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9128; val_auprc_score: 0.8904; val_best_acc_score: 0.8367; val_best_f1_score: 0.8476; train_kl_reg_loss: 4046.2295; train_edge_recon_loss: 267578.1875; train_gene_expr_recon_loss: 148335.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419959.7708; train_optim_loss: 419959.7708; val_kl_reg_loss: 4062.9282; val_edge_recon_loss: 273487.1250; val_gene_expr_recon_loss: 148238.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425788.8125; val_optim_loss: 425788.8125
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9092; val_auprc_score: 0.8848; val_best_acc_score: 0.8436; val_best_f1_score: 0.8508; train_kl_reg_loss: 4233.2438; train_edge_recon_loss: 267926.8958; train_gene_expr_recon_loss: 154187.9583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 426348.0938; train_optim_loss: 426348.0938; val_kl_reg_loss: 4026.5769; val_edge_recon_loss: 274632.6562; val_gene_expr_recon_loss: 147915.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426575.0312; val_optim_loss: 426575.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9219; val_auprc_score: 0.9064; val_best_acc_score: 0.8491; val_best_f1_score: 0.8591; train_kl_reg_loss: 4322.8773; train_edge_recon_loss: 268958.0625; train_gene_expr_recon_loss: 159024.1146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 432305.0521; train_optim_loss: 432305.0521; val_kl_reg_loss: 4036.4189; val_edge_recon_loss: 269999.5625; val_gene_expr_recon_loss: 147884.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 421920.4375; val_optim_loss: 421920.4375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9191; val_auprc_score: 0.8997; val_best_acc_score: 0.8477; val_best_f1_score: 0.8606; train_kl_reg_loss: 4171.4880; train_edge_recon_loss: 268808.2500; train_gene_expr_recon_loss: 160697.7240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 433677.4583; train_optim_loss: 433677.4583; val_kl_reg_loss: 3986.6050; val_edge_recon_loss: 269723.5625; val_gene_expr_recon_loss: 147849.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 421559.4375; val_optim_loss: 421559.4375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9232; val_auprc_score: 0.8974; val_best_acc_score: 0.8555; val_best_f1_score: 0.8635; train_kl_reg_loss: 4132.6675; train_edge_recon_loss: 267758.1146; train_gene_expr_recon_loss: 155835.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 427726.1979; train_optim_loss: 427726.1979; val_kl_reg_loss: 3975.2495; val_edge_recon_loss: 267229.6250; val_gene_expr_recon_loss: 147811.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419016.3750; val_optim_loss: 419016.3750
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9206; val_auprc_score: 0.9043; val_best_acc_score: 0.8454; val_best_f1_score: 0.8573; train_kl_reg_loss: 4110.6919; train_edge_recon_loss: 268970.8229; train_gene_expr_recon_loss: 156544.4271; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429625.9375; train_optim_loss: 429625.9375; val_kl_reg_loss: 3977.0730; val_edge_recon_loss: 271011.2500; val_gene_expr_recon_loss: 147772.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 422761.0312; val_optim_loss: 422761.0312
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9243; val_auprc_score: 0.9090; val_best_acc_score: 0.8514; val_best_f1_score: 0.8633; train_kl_reg_loss: 4094.9898; train_edge_recon_loss: 266790.5417; train_gene_expr_recon_loss: 146552.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417437.8854; train_optim_loss: 417437.8854; val_kl_reg_loss: 3972.0840; val_edge_recon_loss: 269190.0312; val_gene_expr_recon_loss: 147733.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 420895.5938; val_optim_loss: 420895.5938
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9260; val_auprc_score: 0.8969; val_best_acc_score: 0.8560; val_best_f1_score: 0.8640; train_kl_reg_loss: 4085.1645; train_edge_recon_loss: 268101.3958; train_gene_expr_recon_loss: 149195.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 421382.3021; train_optim_loss: 421382.3021; val_kl_reg_loss: 3959.8455; val_edge_recon_loss: 267986.7500; val_gene_expr_recon_loss: 147696.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419642.8750; val_optim_loss: 419642.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9174; val_auprc_score: 0.8891; val_best_acc_score: 0.8523; val_best_f1_score: 0.8608; train_kl_reg_loss: 4083.2515; train_edge_recon_loss: 268142.3750; train_gene_expr_recon_loss: 141121.7865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413347.4167; train_optim_loss: 413347.4167; val_kl_reg_loss: 3964.3545; val_edge_recon_loss: 268483.4062; val_gene_expr_recon_loss: 147692.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 420140.2500; val_optim_loss: 420140.2500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9157; val_auprc_score: 0.8938; val_best_acc_score: 0.8500; val_best_f1_score: 0.8561; train_kl_reg_loss: 4157.2642; train_edge_recon_loss: 267941.2708; train_gene_expr_recon_loss: 157114.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429212.7396; train_optim_loss: 429212.7396; val_kl_reg_loss: 3972.8774; val_edge_recon_loss: 271697.8750; val_gene_expr_recon_loss: 147688.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423359.3750; val_optim_loss: 423359.3750
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9146; val_auprc_score: 0.8872; val_best_acc_score: 0.8463; val_best_f1_score: 0.8537; train_kl_reg_loss: 4164.7326; train_edge_recon_loss: 267582.9375; train_gene_expr_recon_loss: 146539.1042; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418286.7812; train_optim_loss: 418286.7812; val_kl_reg_loss: 3963.3569; val_edge_recon_loss: 272085.8125; val_gene_expr_recon_loss: 147684.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423733.7812; val_optim_loss: 423733.7812

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 25 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9229
Val AUPRC score: 0.9056
Val best accuracy score: 0.8505
Val best F1 score: 0.8570
Val gene expr MSE score: 0.9303
Duration of model training in run 2: 0 hours, 0 minutes and 27 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 18899
Number of validation edges: 2099
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8485; val_auprc_score: 0.8682; val_best_acc_score: 0.7568; val_best_f1_score: 0.7648; train_kl_reg_loss: 173.0066; train_edge_recon_loss: 345628.4156; train_gene_expr_recon_loss: 168428.9078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 514230.3312; train_optim_loss: 514230.3312; val_kl_reg_loss: 184.9250; val_edge_recon_loss: 360273.5938; val_gene_expr_recon_loss: 158989.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 519448.0938; val_optim_loss: 519448.0938
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7761; val_auprc_score: 0.7850; val_best_acc_score: 0.6982; val_best_f1_score: 0.7293; train_kl_reg_loss: 563.8774; train_edge_recon_loss: 330345.3375; train_gene_expr_recon_loss: 154708.1734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 485617.3937; train_optim_loss: 485617.3937; val_kl_reg_loss: 1589.9586; val_edge_recon_loss: 318342.8125; val_gene_expr_recon_loss: 153986.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473919.2656; val_optim_loss: 473919.2656
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8080; val_auprc_score: 0.8072; val_best_acc_score: 0.7237; val_best_f1_score: 0.7455; train_kl_reg_loss: 3283.8254; train_edge_recon_loss: 300918.8969; train_gene_expr_recon_loss: 153662.7016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457865.4250; train_optim_loss: 457865.4250; val_kl_reg_loss: 4450.3394; val_edge_recon_loss: 298894.2031; val_gene_expr_recon_loss: 151785.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455130.0469; val_optim_loss: 455130.0469
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8765; val_auprc_score: 0.8517; val_best_acc_score: 0.8028; val_best_f1_score: 0.8232; train_kl_reg_loss: 4551.1748; train_edge_recon_loss: 281021.9219; train_gene_expr_recon_loss: 151911.5328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 437484.6344; train_optim_loss: 437484.6344; val_kl_reg_loss: 4325.8030; val_edge_recon_loss: 278562.6719; val_gene_expr_recon_loss: 150826.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433714.6406; val_optim_loss: 433714.6406
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9029; val_auprc_score: 0.8809; val_best_acc_score: 0.8278; val_best_f1_score: 0.8399; train_kl_reg_loss: 4190.8980; train_edge_recon_loss: 273360.0687; train_gene_expr_recon_loss: 152085.4250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 429636.3937; train_optim_loss: 429636.3937; val_kl_reg_loss: 3865.6206; val_edge_recon_loss: 281873.8750; val_gene_expr_recon_loss: 150424.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 436163.7500; val_optim_loss: 436163.7500
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9151; val_auprc_score: 0.8888; val_best_acc_score: 0.8495; val_best_f1_score: 0.8612; train_kl_reg_loss: 3962.1898; train_edge_recon_loss: 270274.4281; train_gene_expr_recon_loss: 150034.7594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424271.3781; train_optim_loss: 424271.3781; val_kl_reg_loss: 3883.9507; val_edge_recon_loss: 283012.8594; val_gene_expr_recon_loss: 150128.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 437024.8125; val_optim_loss: 437024.8125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9271; val_auprc_score: 0.9027; val_best_acc_score: 0.8633; val_best_f1_score: 0.8728; train_kl_reg_loss: 3937.9953; train_edge_recon_loss: 269129.9688; train_gene_expr_recon_loss: 148671.4422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 421739.3937; train_optim_loss: 421739.3937; val_kl_reg_loss: 3812.2649; val_edge_recon_loss: 275354.2500; val_gene_expr_recon_loss: 149566.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428733.2500; val_optim_loss: 428733.2500
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9476; val_auprc_score: 0.9281; val_best_acc_score: 0.8921; val_best_f1_score: 0.8967; train_kl_reg_loss: 3869.1872; train_edge_recon_loss: 267152.9906; train_gene_expr_recon_loss: 149640.1766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420662.3563; train_optim_loss: 420662.3563; val_kl_reg_loss: 3705.7910; val_edge_recon_loss: 256685.1953; val_gene_expr_recon_loss: 149318.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409709.0000; val_optim_loss: 409709.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9531; val_auprc_score: 0.9368; val_best_acc_score: 0.8990; val_best_f1_score: 0.9042; train_kl_reg_loss: 3836.8584; train_edge_recon_loss: 265583.7906; train_gene_expr_recon_loss: 148945.3219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418365.9750; train_optim_loss: 418365.9750; val_kl_reg_loss: 3779.1791; val_edge_recon_loss: 261112.7344; val_gene_expr_recon_loss: 149060.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413952.2031; val_optim_loss: 413952.2031
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9531; val_auprc_score: 0.9374; val_best_acc_score: 0.9038; val_best_f1_score: 0.9087; train_kl_reg_loss: 3842.6496; train_edge_recon_loss: 265219.6156; train_gene_expr_recon_loss: 147707.4891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416769.7562; train_optim_loss: 416769.7562; val_kl_reg_loss: 3769.2797; val_edge_recon_loss: 266941.4375; val_gene_expr_recon_loss: 148838.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419549.0938; val_optim_loss: 419549.0938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9532; val_auprc_score: 0.9369; val_best_acc_score: 0.9045; val_best_f1_score: 0.9098; train_kl_reg_loss: 3746.0315; train_edge_recon_loss: 265305.3531; train_gene_expr_recon_loss: 146635.3969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415686.7906; train_optim_loss: 415686.7906; val_kl_reg_loss: 3724.5658; val_edge_recon_loss: 280274.6719; val_gene_expr_recon_loss: 148567.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 432567.0312; val_optim_loss: 432567.0312

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9457; val_auprc_score: 0.9244; val_best_acc_score: 0.8971; val_best_f1_score: 0.9031; train_kl_reg_loss: 3742.3684; train_edge_recon_loss: 266858.4969; train_gene_expr_recon_loss: 147361.4094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417962.2812; train_optim_loss: 417962.2812; val_kl_reg_loss: 3677.7349; val_edge_recon_loss: 264949.5312; val_gene_expr_recon_loss: 147750.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416377.3125; val_optim_loss: 416377.3125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9540; val_auprc_score: 0.9284; val_best_acc_score: 0.9116; val_best_f1_score: 0.9157; train_kl_reg_loss: 3711.2719; train_edge_recon_loss: 264585.7891; train_gene_expr_recon_loss: 144140.5070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412437.5656; train_optim_loss: 412437.5656; val_kl_reg_loss: 3636.0154; val_edge_recon_loss: 262360.2812; val_gene_expr_recon_loss: 147256.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413252.4688; val_optim_loss: 413252.4688
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9524; val_auprc_score: 0.9358; val_best_acc_score: 0.9030; val_best_f1_score: 0.9079; train_kl_reg_loss: 3765.5127; train_edge_recon_loss: 266151.8156; train_gene_expr_recon_loss: 147718.6578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417635.9844; train_optim_loss: 417635.9844; val_kl_reg_loss: 3725.7820; val_edge_recon_loss: 256592.6719; val_gene_expr_recon_loss: 147172.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407490.4531; val_optim_loss: 407490.4531
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9509; val_auprc_score: 0.9256; val_best_acc_score: 0.9061; val_best_f1_score: 0.9111; train_kl_reg_loss: 3739.7200; train_edge_recon_loss: 264486.2281; train_gene_expr_recon_loss: 143356.3469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411582.2969; train_optim_loss: 411582.2969; val_kl_reg_loss: 3723.1443; val_edge_recon_loss: 261843.3594; val_gene_expr_recon_loss: 147111.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412677.8125; val_optim_loss: 412677.8125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9508; val_auprc_score: 0.9284; val_best_acc_score: 0.9035; val_best_f1_score: 0.9087; train_kl_reg_loss: 3816.7091; train_edge_recon_loss: 265278.0031; train_gene_expr_recon_loss: 145782.5906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414877.2938; train_optim_loss: 414877.2938; val_kl_reg_loss: 3688.2848; val_edge_recon_loss: 266858.8125; val_gene_expr_recon_loss: 147085.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417633.0312; val_optim_loss: 417633.0312
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9513; val_auprc_score: 0.9307; val_best_acc_score: 0.9021; val_best_f1_score: 0.9070; train_kl_reg_loss: 3725.2540; train_edge_recon_loss: 264520.0062; train_gene_expr_recon_loss: 146642.9406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414888.2000; train_optim_loss: 414888.2000; val_kl_reg_loss: 3689.2834; val_edge_recon_loss: 273916.9219; val_gene_expr_recon_loss: 147071.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424677.9844; val_optim_loss: 424677.9844

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9515; val_auprc_score: 0.9262; val_best_acc_score: 0.9033; val_best_f1_score: 0.9086; train_kl_reg_loss: 3730.2310; train_edge_recon_loss: 265879.5969; train_gene_expr_recon_loss: 146440.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416050.1906; train_optim_loss: 416050.1906; val_kl_reg_loss: 3672.9218; val_edge_recon_loss: 263745.2891; val_gene_expr_recon_loss: 147059.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414478.0156; val_optim_loss: 414478.0156
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9512; val_auprc_score: 0.9294; val_best_acc_score: 0.9033; val_best_f1_score: 0.9078; train_kl_reg_loss: 3729.6923; train_edge_recon_loss: 265124.9250; train_gene_expr_recon_loss: 144869.1156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413723.7438; train_optim_loss: 413723.7438; val_kl_reg_loss: 3654.6726; val_edge_recon_loss: 267152.0312; val_gene_expr_recon_loss: 147039.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417846.6406; val_optim_loss: 417846.6406
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9564; val_auprc_score: 0.9372; val_best_acc_score: 0.9121; val_best_f1_score: 0.9155; train_kl_reg_loss: 3719.0993; train_edge_recon_loss: 265086.0844; train_gene_expr_recon_loss: 143164.7641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411969.9594; train_optim_loss: 411969.9594; val_kl_reg_loss: 3712.7983; val_edge_recon_loss: 263379.0312; val_gene_expr_recon_loss: 147018.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414110.0156; val_optim_loss: 414110.0156

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 27 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9478
Val AUPRC score: 0.9231
Val best accuracy score: 0.9014
Val best F1 score: 0.9060
Val gene expr MSE score: 0.8361
Duration of model training in run 3: 0 hours, 0 minutes and 29 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 18899
Number of validation edges: 2099
Edge batch size: 2048
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8497; val_auprc_score: 0.8669; val_best_acc_score: 0.7727; val_best_f1_score: 0.7629; train_kl_reg_loss: 172.7887; train_edge_recon_loss: 345641.1219; train_gene_expr_recon_loss: 169781.2812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 515595.1937; train_optim_loss: 515595.1937; val_kl_reg_loss: 169.8720; val_edge_recon_loss: 337038.6875; val_gene_expr_recon_loss: 164512.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 501720.7188; val_optim_loss: 501720.7188
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7764; val_auprc_score: 0.7866; val_best_acc_score: 0.6968; val_best_f1_score: 0.7253; train_kl_reg_loss: 642.5426; train_edge_recon_loss: 328135.0406; train_gene_expr_recon_loss: 154951.4172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 483729.0094; train_optim_loss: 483729.0094; val_kl_reg_loss: 1875.1969; val_edge_recon_loss: 322698.1562; val_gene_expr_recon_loss: 159477.4688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 484050.8125; val_optim_loss: 484050.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8344; val_auprc_score: 0.8258; val_best_acc_score: 0.7556; val_best_f1_score: 0.7672; train_kl_reg_loss: 3343.8770; train_edge_recon_loss: 301026.2219; train_gene_expr_recon_loss: 153419.9937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457790.0906; train_optim_loss: 457790.0906; val_kl_reg_loss: 4275.8794; val_edge_recon_loss: 284326.5625; val_gene_expr_recon_loss: 157414.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446016.5000; val_optim_loss: 446016.5000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9019; val_auprc_score: 0.8781; val_best_acc_score: 0.8302; val_best_f1_score: 0.8399; train_kl_reg_loss: 4409.5303; train_edge_recon_loss: 277333.2344; train_gene_expr_recon_loss: 149359.1984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 431101.9688; train_optim_loss: 431101.9688; val_kl_reg_loss: 4102.2856; val_edge_recon_loss: 277566.8750; val_gene_expr_recon_loss: 156652.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 438322.0781; val_optim_loss: 438322.0781
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9308; val_auprc_score: 0.9137; val_best_acc_score: 0.8549; val_best_f1_score: 0.8649; train_kl_reg_loss: 4071.8694; train_edge_recon_loss: 271207.7906; train_gene_expr_recon_loss: 150344.2141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425623.8656; train_optim_loss: 425623.8656; val_kl_reg_loss: 3984.0791; val_edge_recon_loss: 265516.3438; val_gene_expr_recon_loss: 156133.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425633.7969; val_optim_loss: 425633.7969
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9334; val_auprc_score: 0.9065; val_best_acc_score: 0.8721; val_best_f1_score: 0.8784; train_kl_reg_loss: 4048.2457; train_edge_recon_loss: 269244.8625; train_gene_expr_recon_loss: 149129.7406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 422422.8531; train_optim_loss: 422422.8531; val_kl_reg_loss: 3923.2946; val_edge_recon_loss: 273691.8594; val_gene_expr_recon_loss: 155677.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 433292.5000; val_optim_loss: 433292.5000
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9472; val_auprc_score: 0.9275; val_best_acc_score: 0.8852; val_best_f1_score: 0.8900; train_kl_reg_loss: 3857.4983; train_edge_recon_loss: 266130.7938; train_gene_expr_recon_loss: 149009.1500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418997.4406; train_optim_loss: 418997.4406; val_kl_reg_loss: 3795.4708; val_edge_recon_loss: 269948.9531; val_gene_expr_recon_loss: 155384.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 429128.8594; val_optim_loss: 429128.8594
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9538; val_auprc_score: 0.9362; val_best_acc_score: 0.8995; val_best_f1_score: 0.9035; train_kl_reg_loss: 3834.0752; train_edge_recon_loss: 266306.6594; train_gene_expr_recon_loss: 146293.8648; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416434.6063; train_optim_loss: 416434.6063; val_kl_reg_loss: 3788.5834; val_edge_recon_loss: 258834.9531; val_gene_expr_recon_loss: 155287.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417911.4844; val_optim_loss: 417911.4844
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9522; val_auprc_score: 0.9309; val_best_acc_score: 0.9035; val_best_f1_score: 0.9081; train_kl_reg_loss: 3741.1504; train_edge_recon_loss: 266104.7531; train_gene_expr_recon_loss: 147882.8234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417728.7281; train_optim_loss: 417728.7281; val_kl_reg_loss: 3657.3058; val_edge_recon_loss: 268875.5156; val_gene_expr_recon_loss: 154509.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 427042.5312; val_optim_loss: 427042.5312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9536; val_auprc_score: 0.9308; val_best_acc_score: 0.9007; val_best_f1_score: 0.9047; train_kl_reg_loss: 3719.1105; train_edge_recon_loss: 266406.0938; train_gene_expr_recon_loss: 148471.7922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418597.0000; train_optim_loss: 418597.0000; val_kl_reg_loss: 3656.6567; val_edge_recon_loss: 262509.5469; val_gene_expr_recon_loss: 154369.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 420535.5781; val_optim_loss: 420535.5781
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9560; val_auprc_score: 0.9389; val_best_acc_score: 0.8992; val_best_f1_score: 0.9018; train_kl_reg_loss: 3688.4564; train_edge_recon_loss: 265672.7812; train_gene_expr_recon_loss: 146096.1852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415457.4219; train_optim_loss: 415457.4219; val_kl_reg_loss: 3661.1027; val_edge_recon_loss: 264579.5781; val_gene_expr_recon_loss: 154464.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 422704.8750; val_optim_loss: 422704.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9601; val_auprc_score: 0.9432; val_best_acc_score: 0.9081; val_best_f1_score: 0.9125; train_kl_reg_loss: 3709.5791; train_edge_recon_loss: 266685.7531; train_gene_expr_recon_loss: 148233.1016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418628.4313; train_optim_loss: 418628.4313; val_kl_reg_loss: 3651.1929; val_edge_recon_loss: 270839.8906; val_gene_expr_recon_loss: 153586.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 428077.4688; val_optim_loss: 428077.4688
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9525; val_auprc_score: 0.9352; val_best_acc_score: 0.8978; val_best_f1_score: 0.9041; train_kl_reg_loss: 3658.7390; train_edge_recon_loss: 264052.9062; train_gene_expr_recon_loss: 144803.3766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412515.0219; train_optim_loss: 412515.0219; val_kl_reg_loss: 3586.5085; val_edge_recon_loss: 268864.7656; val_gene_expr_recon_loss: 153065.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425516.8438; val_optim_loss: 425516.8438
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9447; val_auprc_score: 0.9235; val_best_acc_score: 0.8902; val_best_f1_score: 0.8952; train_kl_reg_loss: 3674.6331; train_edge_recon_loss: 265327.4437; train_gene_expr_recon_loss: 144360.4375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413362.5125; train_optim_loss: 413362.5125; val_kl_reg_loss: 3588.2594; val_edge_recon_loss: 273751.4844; val_gene_expr_recon_loss: 152972.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430311.9688; val_optim_loss: 430311.9688

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 19 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.9456
Val AUPRC score: 0.9230
Val best accuracy score: 0.8895
Val best F1 score: 0.8955
Val gene expr MSE score: 1.0714
Duration of model training in run 4: 0 hours, 0 minutes and 21 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 27860
Number of validation edges: 3095
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7996; val_auprc_score: 0.8030; val_best_acc_score: 0.7194; val_best_f1_score: 0.7318; train_kl_reg_loss: 618.3642; train_edge_recon_loss: 333619.6205; train_gene_expr_recon_loss: 159455.2288; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493693.2132; train_optim_loss: 493693.2132; val_kl_reg_loss: 3080.4181; val_edge_recon_loss: 319771.0781; val_gene_expr_recon_loss: 149748.6211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472600.1328; val_optim_loss: 472600.1328
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9037; val_auprc_score: 0.8822; val_best_acc_score: 0.8341; val_best_f1_score: 0.8466; train_kl_reg_loss: 4039.6773; train_edge_recon_loss: 285074.1339; train_gene_expr_recon_loss: 149847.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 438961.2701; train_optim_loss: 438961.2701; val_kl_reg_loss: 3926.8744; val_edge_recon_loss: 273140.3984; val_gene_expr_recon_loss: 146835.3633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423902.6484; val_optim_loss: 423902.6484
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9373; val_auprc_score: 0.9204; val_best_acc_score: 0.8751; val_best_f1_score: 0.8838; train_kl_reg_loss: 3833.7665; train_edge_recon_loss: 271367.0982; train_gene_expr_recon_loss: 149131.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 424332.0480; train_optim_loss: 424332.0480; val_kl_reg_loss: 3777.1015; val_edge_recon_loss: 262653.2930; val_gene_expr_recon_loss: 146687.1445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413117.5312; val_optim_loss: 413117.5312
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9466; val_auprc_score: 0.9270; val_best_acc_score: 0.8926; val_best_f1_score: 0.8989; train_kl_reg_loss: 3732.1305; train_edge_recon_loss: 267369.4431; train_gene_expr_recon_loss: 148333.1295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 419434.7042; train_optim_loss: 419434.7042; val_kl_reg_loss: 3619.9928; val_edge_recon_loss: 263536.9648; val_gene_expr_recon_loss: 146509.2383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413666.1953; val_optim_loss: 413666.1953
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9576; val_auprc_score: 0.9413; val_best_acc_score: 0.9079; val_best_f1_score: 0.9107; train_kl_reg_loss: 3691.7554; train_edge_recon_loss: 266065.5725; train_gene_expr_recon_loss: 146916.2935; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416673.6217; train_optim_loss: 416673.6217; val_kl_reg_loss: 3601.5386; val_edge_recon_loss: 257704.4492; val_gene_expr_recon_loss: 146423.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407729.1641; val_optim_loss: 407729.1641
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9593; val_auprc_score: 0.9471; val_best_acc_score: 0.9045; val_best_f1_score: 0.9083; train_kl_reg_loss: 3620.3764; train_edge_recon_loss: 265009.9023; train_gene_expr_recon_loss: 146030.7171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414660.9944; train_optim_loss: 414660.9944; val_kl_reg_loss: 3564.3653; val_edge_recon_loss: 267708.2344; val_gene_expr_recon_loss: 145182.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416454.6406; val_optim_loss: 416454.6406
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9636; val_auprc_score: 0.9477; val_best_acc_score: 0.9157; val_best_f1_score: 0.9189; train_kl_reg_loss: 3525.3145; train_edge_recon_loss: 265300.0430; train_gene_expr_recon_loss: 146334.1518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 415159.5100; train_optim_loss: 415159.5100; val_kl_reg_loss: 3504.6938; val_edge_recon_loss: 267872.5234; val_gene_expr_recon_loss: 144938.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416315.6172; val_optim_loss: 416315.6172
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9675; val_auprc_score: 0.9480; val_best_acc_score: 0.9234; val_best_f1_score: 0.9252; train_kl_reg_loss: 3541.4049; train_edge_recon_loss: 263654.0357; train_gene_expr_recon_loss: 145519.0815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412714.5201; train_optim_loss: 412714.5201; val_kl_reg_loss: 3500.4877; val_edge_recon_loss: 269190.6250; val_gene_expr_recon_loss: 143439.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416130.7188; val_optim_loss: 416130.7188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9680; val_auprc_score: 0.9560; val_best_acc_score: 0.9223; val_best_f1_score: 0.9253; train_kl_reg_loss: 3510.3628; train_edge_recon_loss: 263794.8583; train_gene_expr_recon_loss: 144590.9894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411896.2199; train_optim_loss: 411896.2199; val_kl_reg_loss: 3480.2388; val_edge_recon_loss: 263471.8828; val_gene_expr_recon_loss: 144266.8867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411219.0156; val_optim_loss: 411219.0156
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9681; val_auprc_score: 0.9543; val_best_acc_score: 0.9231; val_best_f1_score: 0.9255; train_kl_reg_loss: 3491.5740; train_edge_recon_loss: 263019.9235; train_gene_expr_recon_loss: 144003.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410514.7679; train_optim_loss: 410514.7679; val_kl_reg_loss: 3467.5399; val_edge_recon_loss: 263644.3750; val_gene_expr_recon_loss: 141931.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409043.8047; val_optim_loss: 409043.8047
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9660; val_auprc_score: 0.9505; val_best_acc_score: 0.9234; val_best_f1_score: 0.9260; train_kl_reg_loss: 3484.8514; train_edge_recon_loss: 263895.1523; train_gene_expr_recon_loss: 144463.1931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411843.1920; train_optim_loss: 411843.1920; val_kl_reg_loss: 3439.9764; val_edge_recon_loss: 261291.9922; val_gene_expr_recon_loss: 142313.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407045.0000; val_optim_loss: 407045.0000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9675; val_auprc_score: 0.9539; val_best_acc_score: 0.9216; val_best_f1_score: 0.9239; train_kl_reg_loss: 3498.1718; train_edge_recon_loss: 262906.2249; train_gene_expr_recon_loss: 143871.4866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410275.8839; train_optim_loss: 410275.8839; val_kl_reg_loss: 3489.9945; val_edge_recon_loss: 268710.4805; val_gene_expr_recon_loss: 143200.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415400.9141; val_optim_loss: 415400.9141
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9696; val_auprc_score: 0.9527; val_best_acc_score: 0.9281; val_best_f1_score: 0.9304; train_kl_reg_loss: 3495.6796; train_edge_recon_loss: 263849.2360; train_gene_expr_recon_loss: 144552.7215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411897.6339; train_optim_loss: 411897.6339; val_kl_reg_loss: 3438.2547; val_edge_recon_loss: 264918.4727; val_gene_expr_recon_loss: 145272.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413629.2969; val_optim_loss: 413629.2969
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9707; val_auprc_score: 0.9596; val_best_acc_score: 0.9268; val_best_f1_score: 0.9295; train_kl_reg_loss: 3493.6164; train_edge_recon_loss: 263500.1401; train_gene_expr_recon_loss: 144287.1669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411280.9241; train_optim_loss: 411280.9241; val_kl_reg_loss: 3482.3424; val_edge_recon_loss: 257609.9648; val_gene_expr_recon_loss: 142192.2695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403284.5781; val_optim_loss: 403284.5781
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9695; val_auprc_score: 0.9566; val_best_acc_score: 0.9255; val_best_f1_score: 0.9279; train_kl_reg_loss: 3511.0399; train_edge_recon_loss: 263182.6066; train_gene_expr_recon_loss: 143993.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410686.6596; train_optim_loss: 410686.6596; val_kl_reg_loss: 3473.6949; val_edge_recon_loss: 262114.9570; val_gene_expr_recon_loss: 141895.9727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407484.6172; val_optim_loss: 407484.6172
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9735; val_auprc_score: 0.9599; val_best_acc_score: 0.9352; val_best_f1_score: 0.9368; train_kl_reg_loss: 3512.1212; train_edge_recon_loss: 262646.2215; train_gene_expr_recon_loss: 144056.8147; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410215.1629; train_optim_loss: 410215.1629; val_kl_reg_loss: 3511.5372; val_edge_recon_loss: 267378.5859; val_gene_expr_recon_loss: 143261.0273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414151.1484; val_optim_loss: 414151.1484
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9683; val_auprc_score: 0.9541; val_best_acc_score: 0.9263; val_best_f1_score: 0.9284; train_kl_reg_loss: 3503.4168; train_edge_recon_loss: 262341.3337; train_gene_expr_recon_loss: 143959.9219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409804.6775; train_optim_loss: 409804.6775; val_kl_reg_loss: 3467.7910; val_edge_recon_loss: 262547.7891; val_gene_expr_recon_loss: 142436.8086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408452.3750; val_optim_loss: 408452.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9716; val_auprc_score: 0.9607; val_best_acc_score: 0.9307; val_best_f1_score: 0.9323; train_kl_reg_loss: 3483.1728; train_edge_recon_loss: 263036.8398; train_gene_expr_recon_loss: 143620.3022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410140.3136; train_optim_loss: 410140.3136; val_kl_reg_loss: 3443.7094; val_edge_recon_loss: 263637.2617; val_gene_expr_recon_loss: 141841.1992; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408922.1719; val_optim_loss: 408922.1719
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9697; val_auprc_score: 0.9566; val_best_acc_score: 0.9270; val_best_f1_score: 0.9290; train_kl_reg_loss: 3482.4787; train_edge_recon_loss: 262891.5117; train_gene_expr_recon_loss: 143405.2232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409779.2132; train_optim_loss: 409779.2132; val_kl_reg_loss: 3445.2806; val_edge_recon_loss: 262625.6523; val_gene_expr_recon_loss: 143481.3789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409552.3125; val_optim_loss: 409552.3125
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9711; val_auprc_score: 0.9567; val_best_acc_score: 0.9321; val_best_f1_score: 0.9337; train_kl_reg_loss: 3484.6024; train_edge_recon_loss: 263129.6674; train_gene_expr_recon_loss: 143146.2704; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409760.5402; train_optim_loss: 409760.5402; val_kl_reg_loss: 3442.5243; val_edge_recon_loss: 263020.9258; val_gene_expr_recon_loss: 143970.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410433.8516; val_optim_loss: 410433.8516

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 50 sec.
Using best model state, which was in epoch 14.

--- MODEL EVALUATION ---
Val AUROC score: 0.9703
Val AUPRC score: 0.9548
Val best accuracy score: 0.9247
Val best F1 score: 0.9273
Val gene expr MSE score: 0.9170
Duration of model training in run 5: 0 hours, 0 minutes and 52 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 27860
Number of validation edges: 3095
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7891; val_auprc_score: 0.7989; val_best_acc_score: 0.7103; val_best_f1_score: 0.7283; train_kl_reg_loss: 593.6402; train_edge_recon_loss: 334234.8962; train_gene_expr_recon_loss: 159585.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 494414.4353; train_optim_loss: 494414.4353; val_kl_reg_loss: 2978.1384; val_edge_recon_loss: 309516.6484; val_gene_expr_recon_loss: 149908.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462403.6484; val_optim_loss: 462403.6484
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9014; val_auprc_score: 0.8861; val_best_acc_score: 0.8291; val_best_f1_score: 0.8412; train_kl_reg_loss: 3993.1763; train_edge_recon_loss: 285220.1842; train_gene_expr_recon_loss: 150712.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 439925.4955; train_optim_loss: 439925.4955; val_kl_reg_loss: 3998.0636; val_edge_recon_loss: 270681.1094; val_gene_expr_recon_loss: 149515.9492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 424195.1250; val_optim_loss: 424195.1250
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9290; val_auprc_score: 0.9083; val_best_acc_score: 0.8658; val_best_f1_score: 0.8735; train_kl_reg_loss: 3853.7344; train_edge_recon_loss: 272314.6228; train_gene_expr_recon_loss: 149346.4425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 425514.8058; train_optim_loss: 425514.8058; val_kl_reg_loss: 3841.0870; val_edge_recon_loss: 263349.1289; val_gene_expr_recon_loss: 147680.2461; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414870.4531; val_optim_loss: 414870.4531
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9500; val_auprc_score: 0.9337; val_best_acc_score: 0.8948; val_best_f1_score: 0.8983; train_kl_reg_loss: 3796.0604; train_edge_recon_loss: 266952.2199; train_gene_expr_recon_loss: 147811.3504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 418559.6306; train_optim_loss: 418559.6306; val_kl_reg_loss: 3683.2830; val_edge_recon_loss: 274956.0469; val_gene_expr_recon_loss: 147067.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 425707.1016; val_optim_loss: 425707.1016
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9516; val_auprc_score: 0.9348; val_best_acc_score: 0.8985; val_best_f1_score: 0.9037; train_kl_reg_loss: 3702.8104; train_edge_recon_loss: 266489.1663; train_gene_expr_recon_loss: 147050.1440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417242.1228; train_optim_loss: 417242.1228; val_kl_reg_loss: 3630.2800; val_edge_recon_loss: 265522.3789; val_gene_expr_recon_loss: 145802.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414955.5938; val_optim_loss: 414955.5938
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9605; val_auprc_score: 0.9436; val_best_acc_score: 0.9115; val_best_f1_score: 0.9147; train_kl_reg_loss: 3651.5169; train_edge_recon_loss: 266039.0664; train_gene_expr_recon_loss: 147433.2372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417123.8237; train_optim_loss: 417123.8237; val_kl_reg_loss: 3621.6237; val_edge_recon_loss: 264591.1094; val_gene_expr_recon_loss: 145830.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414043.2188; val_optim_loss: 414043.2188
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9585; val_auprc_score: 0.9405; val_best_acc_score: 0.9087; val_best_f1_score: 0.9126; train_kl_reg_loss: 3598.1104; train_edge_recon_loss: 265092.1473; train_gene_expr_recon_loss: 146300.1378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414990.3996; train_optim_loss: 414990.3996; val_kl_reg_loss: 3614.3815; val_edge_recon_loss: 272611.4062; val_gene_expr_recon_loss: 142980.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 419206.2656; val_optim_loss: 419206.2656
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9623; val_auprc_score: 0.9423; val_best_acc_score: 0.9195; val_best_f1_score: 0.9214; train_kl_reg_loss: 3538.4338; train_edge_recon_loss: 264574.9375; train_gene_expr_recon_loss: 145794.4074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413907.7812; train_optim_loss: 413907.7812; val_kl_reg_loss: 3395.7748; val_edge_recon_loss: 270003.9219; val_gene_expr_recon_loss: 145014.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 418414.6172; val_optim_loss: 418414.6172
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9677; val_auprc_score: 0.9537; val_best_acc_score: 0.9246; val_best_f1_score: 0.9264; train_kl_reg_loss: 3516.3668; train_edge_recon_loss: 263685.7360; train_gene_expr_recon_loss: 145291.8309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412493.9319; train_optim_loss: 412493.9319; val_kl_reg_loss: 3513.1159; val_edge_recon_loss: 257895.1953; val_gene_expr_recon_loss: 142396.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403804.4297; val_optim_loss: 403804.4297
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9675; val_auprc_score: 0.9539; val_best_acc_score: 0.9249; val_best_f1_score: 0.9270; train_kl_reg_loss: 3548.1108; train_edge_recon_loss: 262543.6267; train_gene_expr_recon_loss: 144771.4950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410863.2366; train_optim_loss: 410863.2366; val_kl_reg_loss: 3625.8901; val_edge_recon_loss: 266609.1758; val_gene_expr_recon_loss: 144581.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414816.0938; val_optim_loss: 414816.0938
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9753; val_auprc_score: 0.9632; val_best_acc_score: 0.9352; val_best_f1_score: 0.9374; train_kl_reg_loss: 3537.7116; train_edge_recon_loss: 262911.9704; train_gene_expr_recon_loss: 145264.0435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411713.7243; train_optim_loss: 411713.7243; val_kl_reg_loss: 3467.4274; val_edge_recon_loss: 264925.4336; val_gene_expr_recon_loss: 143602.2227; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411995.0781; val_optim_loss: 411995.0781
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9736; val_auprc_score: 0.9620; val_best_acc_score: 0.9326; val_best_f1_score: 0.9351; train_kl_reg_loss: 3497.5153; train_edge_recon_loss: 261985.5988; train_gene_expr_recon_loss: 143594.3633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409077.4766; train_optim_loss: 409077.4766; val_kl_reg_loss: 3429.2446; val_edge_recon_loss: 261926.9219; val_gene_expr_recon_loss: 141432.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406789.1172; val_optim_loss: 406789.1172

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9745; val_auprc_score: 0.9601; val_best_acc_score: 0.9338; val_best_f1_score: 0.9365; train_kl_reg_loss: 3446.3869; train_edge_recon_loss: 262354.9782; train_gene_expr_recon_loss: 143920.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409722.1350; train_optim_loss: 409722.1350; val_kl_reg_loss: 3423.9510; val_edge_recon_loss: 266712.0781; val_gene_expr_recon_loss: 142466.5820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412602.6094; val_optim_loss: 412602.6094
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9725; val_auprc_score: 0.9570; val_best_acc_score: 0.9367; val_best_f1_score: 0.9381; train_kl_reg_loss: 3478.4372; train_edge_recon_loss: 261860.1356; train_gene_expr_recon_loss: 143762.4018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409100.9766; train_optim_loss: 409100.9766; val_kl_reg_loss: 3423.8169; val_edge_recon_loss: 266219.7148; val_gene_expr_recon_loss: 142209.2930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411852.8125; val_optim_loss: 411852.8125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9744; val_auprc_score: 0.9614; val_best_acc_score: 0.9368; val_best_f1_score: 0.9383; train_kl_reg_loss: 3480.0176; train_edge_recon_loss: 261754.7483; train_gene_expr_recon_loss: 143049.5285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408284.2935; train_optim_loss: 408284.2935; val_kl_reg_loss: 3450.1185; val_edge_recon_loss: 262574.8242; val_gene_expr_recon_loss: 140346.9414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406371.8672; val_optim_loss: 406371.8672

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 37 sec.
Using best model state, which was in epoch 9.

--- MODEL EVALUATION ---
Val AUROC score: 0.9708
Val AUPRC score: 0.9532
Val best accuracy score: 0.9296
Val best F1 score: 0.9309
Val gene expr MSE score: 0.9870
Duration of model training in run 6: 0 hours, 0 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 36783
Number of validation edges: 4087
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9029; val_auprc_score: 0.8761; val_best_acc_score: 0.8333; val_best_f1_score: 0.8461; train_kl_reg_loss: 2302.6583; train_edge_recon_loss: 310149.4440; train_gene_expr_recon_loss: 154588.1984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467040.3008; train_optim_loss: 467040.3008; val_kl_reg_loss: 4166.0534; val_edge_recon_loss: 274338.3281; val_gene_expr_recon_loss: 152259.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 430764.0820; val_optim_loss: 430764.0820
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9557; val_auprc_score: 0.9373; val_best_acc_score: 0.9038; val_best_f1_score: 0.9081; train_kl_reg_loss: 3860.9782; train_edge_recon_loss: 268074.5410; train_gene_expr_recon_loss: 148907.5260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 420843.0486; train_optim_loss: 420843.0486; val_kl_reg_loss: 3622.0363; val_edge_recon_loss: 265366.0371; val_gene_expr_recon_loss: 148557.9883; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417546.0625; val_optim_loss: 417546.0625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9605; val_auprc_score: 0.9450; val_best_acc_score: 0.9138; val_best_f1_score: 0.9171; train_kl_reg_loss: 3619.3825; train_edge_recon_loss: 266032.4167; train_gene_expr_recon_loss: 147129.3657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 416781.1654; train_optim_loss: 416781.1654; val_kl_reg_loss: 3640.4118; val_edge_recon_loss: 265426.7305; val_gene_expr_recon_loss: 146881.7930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415948.9375; val_optim_loss: 415948.9375
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9702; val_auprc_score: 0.9588; val_best_acc_score: 0.9264; val_best_f1_score: 0.9290; train_kl_reg_loss: 3549.3368; train_edge_recon_loss: 264428.5773; train_gene_expr_recon_loss: 145954.9859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413932.9015; train_optim_loss: 413932.9015; val_kl_reg_loss: 3583.1968; val_edge_recon_loss: 263845.0469; val_gene_expr_recon_loss: 146285.4902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413713.7383; val_optim_loss: 413713.7383
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9720; val_auprc_score: 0.9597; val_best_acc_score: 0.9349; val_best_f1_score: 0.9368; train_kl_reg_loss: 3527.3600; train_edge_recon_loss: 263067.0933; train_gene_expr_recon_loss: 145190.5132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411784.9670; train_optim_loss: 411784.9670; val_kl_reg_loss: 3607.6985; val_edge_recon_loss: 263577.3984; val_gene_expr_recon_loss: 144480.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411665.1250; val_optim_loss: 411665.1250
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9743; val_auprc_score: 0.9620; val_best_acc_score: 0.9355; val_best_f1_score: 0.9374; train_kl_reg_loss: 3446.4614; train_edge_recon_loss: 263186.4243; train_gene_expr_recon_loss: 144517.7669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411150.6510; train_optim_loss: 411150.6510; val_kl_reg_loss: 3373.8883; val_edge_recon_loss: 262199.0938; val_gene_expr_recon_loss: 141429.7822; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407002.7656; val_optim_loss: 407002.7656
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9740; val_auprc_score: 0.9622; val_best_acc_score: 0.9359; val_best_f1_score: 0.9376; train_kl_reg_loss: 3410.4164; train_edge_recon_loss: 262397.6686; train_gene_expr_recon_loss: 144022.7216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 409830.8047; train_optim_loss: 409830.8047; val_kl_reg_loss: 3347.0575; val_edge_recon_loss: 262176.9082; val_gene_expr_recon_loss: 146912.0488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412436.0156; val_optim_loss: 412436.0156
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9773; val_auprc_score: 0.9642; val_best_acc_score: 0.9479; val_best_f1_score: 0.9494; train_kl_reg_loss: 3390.2427; train_edge_recon_loss: 261725.8568; train_gene_expr_recon_loss: 142969.7769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408085.8776; train_optim_loss: 408085.8776; val_kl_reg_loss: 3456.9762; val_edge_recon_loss: 259753.9316; val_gene_expr_recon_loss: 144298.9746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407509.8750; val_optim_loss: 407509.8750
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9798; val_auprc_score: 0.9704; val_best_acc_score: 0.9456; val_best_f1_score: 0.9471; train_kl_reg_loss: 3391.9654; train_edge_recon_loss: 261152.1495; train_gene_expr_recon_loss: 142495.3270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 407039.4427; train_optim_loss: 407039.4427; val_kl_reg_loss: 3346.5942; val_edge_recon_loss: 261220.7754; val_gene_expr_recon_loss: 142616.8926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407184.2617; val_optim_loss: 407184.2617

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9779; val_auprc_score: 0.9689; val_best_acc_score: 0.9431; val_best_f1_score: 0.9449; train_kl_reg_loss: 3379.4103; train_edge_recon_loss: 260738.4909; train_gene_expr_recon_loss: 141387.1156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405505.0156; train_optim_loss: 405505.0156; val_kl_reg_loss: 3356.7908; val_edge_recon_loss: 262224.6094; val_gene_expr_recon_loss: 143631.2715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409212.6680; val_optim_loss: 409212.6680
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9774; val_auprc_score: 0.9649; val_best_acc_score: 0.9436; val_best_f1_score: 0.9452; train_kl_reg_loss: 3388.1313; train_edge_recon_loss: 260340.5701; train_gene_expr_recon_loss: 141248.7914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404977.4935; train_optim_loss: 404977.4935; val_kl_reg_loss: 3370.2292; val_edge_recon_loss: 261078.5039; val_gene_expr_recon_loss: 141420.5684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405869.2969; val_optim_loss: 405869.2969
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9800; val_auprc_score: 0.9705; val_best_acc_score: 0.9476; val_best_f1_score: 0.9495; train_kl_reg_loss: 3385.2126; train_edge_recon_loss: 260166.5536; train_gene_expr_recon_loss: 140662.2071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404213.9696; train_optim_loss: 404213.9696; val_kl_reg_loss: 3389.4183; val_edge_recon_loss: 258756.1504; val_gene_expr_recon_loss: 142442.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404588.3164; val_optim_loss: 404588.3164
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9808; val_auprc_score: 0.9693; val_best_acc_score: 0.9479; val_best_f1_score: 0.9493; train_kl_reg_loss: 3395.9305; train_edge_recon_loss: 260168.4510; train_gene_expr_recon_loss: 140424.8679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403989.2509; train_optim_loss: 403989.2509; val_kl_reg_loss: 3374.1375; val_edge_recon_loss: 260143.8184; val_gene_expr_recon_loss: 138373.7305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401891.6875; val_optim_loss: 401891.6875
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9812; val_auprc_score: 0.9704; val_best_acc_score: 0.9494; val_best_f1_score: 0.9506; train_kl_reg_loss: 3380.8172; train_edge_recon_loss: 260069.7320; train_gene_expr_recon_loss: 140814.0891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404264.6385; train_optim_loss: 404264.6385; val_kl_reg_loss: 3358.2107; val_edge_recon_loss: 258973.0195; val_gene_expr_recon_loss: 140267.9365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402599.1641; val_optim_loss: 402599.1641
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9794; val_auprc_score: 0.9617; val_best_acc_score: 0.9492; val_best_f1_score: 0.9505; train_kl_reg_loss: 3387.2271; train_edge_recon_loss: 259926.5551; train_gene_expr_recon_loss: 141019.7877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404333.5694; train_optim_loss: 404333.5694; val_kl_reg_loss: 3354.6895; val_edge_recon_loss: 259855.7891; val_gene_expr_recon_loss: 143538.8477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406749.3242; val_optim_loss: 406749.3242
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9815; val_auprc_score: 0.9731; val_best_acc_score: 0.9469; val_best_f1_score: 0.9484; train_kl_reg_loss: 3381.7831; train_edge_recon_loss: 259955.8752; train_gene_expr_recon_loss: 140941.7258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404279.3876; train_optim_loss: 404279.3876; val_kl_reg_loss: 3366.4454; val_edge_recon_loss: 261033.8008; val_gene_expr_recon_loss: 140055.7676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404456.0117; val_optim_loss: 404456.0117

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9819; val_auprc_score: 0.9729; val_best_acc_score: 0.9489; val_best_f1_score: 0.9506; train_kl_reg_loss: 3381.1193; train_edge_recon_loss: 259990.5588; train_gene_expr_recon_loss: 140675.3911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404047.0707; train_optim_loss: 404047.0707; val_kl_reg_loss: 3383.9086; val_edge_recon_loss: 259603.6602; val_gene_expr_recon_loss: 140284.4053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403271.9766; val_optim_loss: 403271.9766
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9794; val_auprc_score: 0.9695; val_best_acc_score: 0.9465; val_best_f1_score: 0.9480; train_kl_reg_loss: 3382.4712; train_edge_recon_loss: 259913.2072; train_gene_expr_recon_loss: 140272.7274; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403568.4062; train_optim_loss: 403568.4062; val_kl_reg_loss: 3360.8491; val_edge_recon_loss: 260871.8379; val_gene_expr_recon_loss: 140119.6865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404352.3711; val_optim_loss: 404352.3711
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9805; val_auprc_score: 0.9702; val_best_acc_score: 0.9503; val_best_f1_score: 0.9518; train_kl_reg_loss: 3385.5547; train_edge_recon_loss: 260011.4108; train_gene_expr_recon_loss: 140346.1583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403743.1254; train_optim_loss: 403743.1254; val_kl_reg_loss: 3367.1978; val_edge_recon_loss: 259329.1406; val_gene_expr_recon_loss: 140155.7773; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402852.1133; val_optim_loss: 402852.1133

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 29 sec.
Using best model state, which was in epoch 13.

--- MODEL EVALUATION ---
Val AUROC score: 0.9804
Val AUPRC score: 0.9669
Val best accuracy score: 0.9480
Val best F1 score: 0.9492
Val gene expr MSE score: 0.9636
Duration of model training in run 7: 0 hours, 1 minutes and 34 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 36783
Number of validation edges: 4087
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9013; val_auprc_score: 0.8836; val_best_acc_score: 0.8285; val_best_f1_score: 0.8403; train_kl_reg_loss: 2329.0521; train_edge_recon_loss: 307588.8615; train_gene_expr_recon_loss: 155263.9913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465181.9036; train_optim_loss: 465181.9036; val_kl_reg_loss: 3929.1985; val_edge_recon_loss: 274580.2969; val_gene_expr_recon_loss: 147744.9199; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 426254.4102; val_optim_loss: 426254.4102
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9438; val_auprc_score: 0.9179; val_best_acc_score: 0.8943; val_best_f1_score: 0.9006; train_kl_reg_loss: 3763.8897; train_edge_recon_loss: 268807.1261; train_gene_expr_recon_loss: 149489.8522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 422060.8672; train_optim_loss: 422060.8672; val_kl_reg_loss: 3672.9588; val_edge_recon_loss: 268339.1133; val_gene_expr_recon_loss: 143090.6133; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 415102.6875; val_optim_loss: 415102.6875
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9667; val_auprc_score: 0.9527; val_best_acc_score: 0.9210; val_best_f1_score: 0.9242; train_kl_reg_loss: 3591.9294; train_edge_recon_loss: 266021.1662; train_gene_expr_recon_loss: 147895.1806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417508.2778; train_optim_loss: 417508.2778; val_kl_reg_loss: 3549.7013; val_edge_recon_loss: 263116.9434; val_gene_expr_recon_loss: 144957.5957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411624.2383; val_optim_loss: 411624.2383
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9674; val_auprc_score: 0.9534; val_best_acc_score: 0.9251; val_best_f1_score: 0.9272; train_kl_reg_loss: 3567.2953; train_edge_recon_loss: 264053.0128; train_gene_expr_recon_loss: 147374.2196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 414994.5265; train_optim_loss: 414994.5265; val_kl_reg_loss: 3484.5910; val_edge_recon_loss: 263455.1250; val_gene_expr_recon_loss: 141849.0117; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 408788.7266; val_optim_loss: 408788.7266
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9697; val_auprc_score: 0.9538; val_best_acc_score: 0.9298; val_best_f1_score: 0.9319; train_kl_reg_loss: 3517.2876; train_edge_recon_loss: 262792.8559; train_gene_expr_recon_loss: 146208.7368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 412518.8806; train_optim_loss: 412518.8806; val_kl_reg_loss: 3415.5315; val_edge_recon_loss: 263330.7695; val_gene_expr_recon_loss: 145522.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412268.9922; val_optim_loss: 412268.9922
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9727; val_auprc_score: 0.9602; val_best_acc_score: 0.9320; val_best_f1_score: 0.9343; train_kl_reg_loss: 3438.4798; train_edge_recon_loss: 262978.0241; train_gene_expr_recon_loss: 144908.2215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411324.7244; train_optim_loss: 411324.7244; val_kl_reg_loss: 3484.3244; val_edge_recon_loss: 263440.2012; val_gene_expr_recon_loss: 144168.3398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411092.8672; val_optim_loss: 411092.8672
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9724; val_auprc_score: 0.9578; val_best_acc_score: 0.9344; val_best_f1_score: 0.9368; train_kl_reg_loss: 3406.1958; train_edge_recon_loss: 262911.1204; train_gene_expr_recon_loss: 144690.2286; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411007.5460; train_optim_loss: 411007.5460; val_kl_reg_loss: 3340.8661; val_edge_recon_loss: 262630.2578; val_gene_expr_recon_loss: 141698.0918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407669.2148; val_optim_loss: 407669.2148
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9752; val_auprc_score: 0.9633; val_best_acc_score: 0.9375; val_best_f1_score: 0.9395; train_kl_reg_loss: 3383.9356; train_edge_recon_loss: 261863.9219; train_gene_expr_recon_loss: 143706.8295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408954.6853; train_optim_loss: 408954.6853; val_kl_reg_loss: 3294.7176; val_edge_recon_loss: 261670.9902; val_gene_expr_recon_loss: 140723.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405689.0781; val_optim_loss: 405689.0781
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9773; val_auprc_score: 0.9657; val_best_acc_score: 0.9434; val_best_f1_score: 0.9453; train_kl_reg_loss: 3373.9080; train_edge_recon_loss: 261480.9227; train_gene_expr_recon_loss: 143248.1667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408102.9965; train_optim_loss: 408102.9965; val_kl_reg_loss: 3315.5034; val_edge_recon_loss: 261667.6387; val_gene_expr_recon_loss: 141774.6826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406757.8281; val_optim_loss: 406757.8281
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9767; val_auprc_score: 0.9659; val_best_acc_score: 0.9423; val_best_f1_score: 0.9439; train_kl_reg_loss: 3396.3175; train_edge_recon_loss: 260297.7893; train_gene_expr_recon_loss: 143258.0450; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406952.1528; train_optim_loss: 406952.1528; val_kl_reg_loss: 3391.9362; val_edge_recon_loss: 261355.7422; val_gene_expr_recon_loss: 139812.9043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 404560.5820; val_optim_loss: 404560.5820
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9809; val_auprc_score: 0.9695; val_best_acc_score: 0.9479; val_best_f1_score: 0.9499; train_kl_reg_loss: 3386.5119; train_edge_recon_loss: 260030.7687; train_gene_expr_recon_loss: 142462.8605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405880.1424; train_optim_loss: 405880.1424; val_kl_reg_loss: 3424.4186; val_edge_recon_loss: 261264.9863; val_gene_expr_recon_loss: 142125.1816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406814.5820; val_optim_loss: 406814.5820
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9821; val_auprc_score: 0.9740; val_best_acc_score: 0.9494; val_best_f1_score: 0.9507; train_kl_reg_loss: 3376.3834; train_edge_recon_loss: 260161.5202; train_gene_expr_recon_loss: 142029.1762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 405567.0794; train_optim_loss: 405567.0794; val_kl_reg_loss: 3364.5070; val_edge_recon_loss: 260189.8379; val_gene_expr_recon_loss: 137375.8877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400930.2305; val_optim_loss: 400930.2305
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9842; val_auprc_score: 0.9774; val_best_acc_score: 0.9541; val_best_f1_score: 0.9553; train_kl_reg_loss: 3386.1530; train_edge_recon_loss: 259531.4008; train_gene_expr_recon_loss: 141160.3194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404077.8715; train_optim_loss: 404077.8715; val_kl_reg_loss: 3407.3682; val_edge_recon_loss: 259612.3750; val_gene_expr_recon_loss: 140571.3340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403591.0820; val_optim_loss: 403591.0820
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9871; val_auprc_score: 0.9800; val_best_acc_score: 0.9599; val_best_f1_score: 0.9605; train_kl_reg_loss: 3373.7798; train_edge_recon_loss: 259447.5306; train_gene_expr_recon_loss: 141006.9111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403828.2214; train_optim_loss: 403828.2214; val_kl_reg_loss: 3369.0178; val_edge_recon_loss: 257979.5977; val_gene_expr_recon_loss: 142358.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403707.5703; val_optim_loss: 403707.5703
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9870; val_auprc_score: 0.9782; val_best_acc_score: 0.9612; val_best_f1_score: 0.9620; train_kl_reg_loss: 3355.0280; train_edge_recon_loss: 259760.2133; train_gene_expr_recon_loss: 140186.8260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403302.0638; train_optim_loss: 403302.0638; val_kl_reg_loss: 3370.8005; val_edge_recon_loss: 258648.2988; val_gene_expr_recon_loss: 137792.6523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399811.7695; val_optim_loss: 399811.7695
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9869; val_auprc_score: 0.9776; val_best_acc_score: 0.9613; val_best_f1_score: 0.9623; train_kl_reg_loss: 3373.6967; train_edge_recon_loss: 258930.7129; train_gene_expr_recon_loss: 140274.8619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402579.2717; train_optim_loss: 402579.2717; val_kl_reg_loss: 3312.6082; val_edge_recon_loss: 259490.5625; val_gene_expr_recon_loss: 136976.6104; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399779.7812; val_optim_loss: 399779.7812
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9871; val_auprc_score: 0.9793; val_best_acc_score: 0.9605; val_best_f1_score: 0.9614; train_kl_reg_loss: 3368.1645; train_edge_recon_loss: 258690.8253; train_gene_expr_recon_loss: 139875.8874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401934.8785; train_optim_loss: 401934.8785; val_kl_reg_loss: 3292.0779; val_edge_recon_loss: 259249.1934; val_gene_expr_recon_loss: 141346.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403887.3125; val_optim_loss: 403887.3125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9881; val_auprc_score: 0.9826; val_best_acc_score: 0.9616; val_best_f1_score: 0.9623; train_kl_reg_loss: 3375.1661; train_edge_recon_loss: 258896.7862; train_gene_expr_recon_loss: 139248.0600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 401520.0139; train_optim_loss: 401520.0139; val_kl_reg_loss: 3259.2419; val_edge_recon_loss: 258851.0371; val_gene_expr_recon_loss: 135228.3506; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397338.6328; val_optim_loss: 397338.6328
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9904; val_auprc_score: 0.9864; val_best_acc_score: 0.9662; val_best_f1_score: 0.9666; train_kl_reg_loss: 3370.3848; train_edge_recon_loss: 258097.3481; train_gene_expr_recon_loss: 138771.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400239.3711; train_optim_loss: 400239.3711; val_kl_reg_loss: 3322.8898; val_edge_recon_loss: 258378.8164; val_gene_expr_recon_loss: 135023.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396724.8633; val_optim_loss: 396724.8633
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9898; val_auprc_score: 0.9829; val_best_acc_score: 0.9666; val_best_f1_score: 0.9674; train_kl_reg_loss: 3364.9662; train_edge_recon_loss: 258456.1139; train_gene_expr_recon_loss: 138412.2280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400233.3095; train_optim_loss: 400233.3095; val_kl_reg_loss: 3343.1808; val_edge_recon_loss: 257451.4473; val_gene_expr_recon_loss: 139526.9404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400321.5703; val_optim_loss: 400321.5703
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9898; val_auprc_score: 0.9825; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 3370.7918; train_edge_recon_loss: 258373.1257; train_gene_expr_recon_loss: 138325.1222; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400069.0395; train_optim_loss: 400069.0395; val_kl_reg_loss: 3344.0327; val_edge_recon_loss: 258190.3691; val_gene_expr_recon_loss: 136648.0430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398182.4453; val_optim_loss: 398182.4453
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9914; val_auprc_score: 0.9860; val_best_acc_score: 0.9693; val_best_f1_score: 0.9698; train_kl_reg_loss: 3387.2021; train_edge_recon_loss: 257972.6000; train_gene_expr_recon_loss: 137514.7989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398874.6003; train_optim_loss: 398874.6003; val_kl_reg_loss: 3322.4892; val_edge_recon_loss: 257512.1641; val_gene_expr_recon_loss: 136129.6816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396964.3320; val_optim_loss: 396964.3320

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9902; val_auprc_score: 0.9840; val_best_acc_score: 0.9684; val_best_f1_score: 0.9692; train_kl_reg_loss: 3356.5938; train_edge_recon_loss: 257742.5341; train_gene_expr_recon_loss: 137439.3770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398538.5056; train_optim_loss: 398538.5056; val_kl_reg_loss: 3360.1841; val_edge_recon_loss: 257942.7188; val_gene_expr_recon_loss: 135824.0977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397127.0000; val_optim_loss: 397127.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9924; val_auprc_score: 0.9878; val_best_acc_score: 0.9727; val_best_f1_score: 0.9732; train_kl_reg_loss: 3363.3460; train_edge_recon_loss: 258034.3322; train_gene_expr_recon_loss: 136976.2496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398373.9284; train_optim_loss: 398373.9284; val_kl_reg_loss: 3347.9494; val_edge_recon_loss: 256528.3633; val_gene_expr_recon_loss: 130656.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 390532.9492; val_optim_loss: 390532.9492
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9926; val_auprc_score: 0.9880; val_best_acc_score: 0.9713; val_best_f1_score: 0.9717; train_kl_reg_loss: 3366.2262; train_edge_recon_loss: 257791.3520; train_gene_expr_recon_loss: 137039.5392; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398197.1137; train_optim_loss: 398197.1137; val_kl_reg_loss: 3366.5282; val_edge_recon_loss: 257885.9102; val_gene_expr_recon_loss: 136184.1387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397436.5781; val_optim_loss: 397436.5781
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9913; val_auprc_score: 0.9861; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 3251.2997; train_edge_recon_loss: 258339.9592; train_gene_expr_recon_loss: 136712.1660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398303.4275; train_optim_loss: 398303.4275; val_kl_reg_loss: 2898.6569; val_edge_recon_loss: 257285.0293; val_gene_expr_recon_loss: 137556.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397740.4961; val_optim_loss: 397740.4961
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9915; val_auprc_score: 0.9873; val_best_acc_score: 0.9706; val_best_f1_score: 0.9711; train_kl_reg_loss: 3063.7233; train_edge_recon_loss: 257839.0412; train_gene_expr_recon_loss: 136825.5558; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397728.3190; train_optim_loss: 397728.3190; val_kl_reg_loss: 2735.4565; val_edge_recon_loss: 258052.9922; val_gene_expr_recon_loss: 134327.7979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395116.2461; val_optim_loss: 395116.2461

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9912; val_auprc_score: 0.9877; val_best_acc_score: 0.9678; val_best_f1_score: 0.9685; train_kl_reg_loss: 2976.8052; train_edge_recon_loss: 257430.9564; train_gene_expr_recon_loss: 136577.3212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396985.0816; train_optim_loss: 396985.0816; val_kl_reg_loss: 2718.2961; val_edge_recon_loss: 258289.2891; val_gene_expr_recon_loss: 134724.0410; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395731.6328; val_optim_loss: 395731.6328
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9911; val_auprc_score: 0.9856; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 2957.4381; train_edge_recon_loss: 257818.3103; train_gene_expr_recon_loss: 136599.7638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397375.5130; train_optim_loss: 397375.5130; val_kl_reg_loss: 2692.9245; val_edge_recon_loss: 257229.7949; val_gene_expr_recon_loss: 137424.1338; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397346.8555; val_optim_loss: 397346.8555
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9927; val_auprc_score: 0.9898; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 2938.4835; train_edge_recon_loss: 257205.8707; train_gene_expr_recon_loss: 136770.9616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396915.3134; train_optim_loss: 396915.3134; val_kl_reg_loss: 2688.3293; val_edge_recon_loss: 256925.5391; val_gene_expr_recon_loss: 134168.2158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 393782.0898; val_optim_loss: 393782.0898

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 37 sec.
Using best model state, which was in epoch 24.

--- MODEL EVALUATION ---
Val AUROC score: 0.9904
Val AUPRC score: 0.9865
Val best accuracy score: 0.9701
Val best F1 score: 0.9706
Val gene expr MSE score: 0.7975
Duration of model training in run 8: 0 hours, 2 minutes and 42 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 45766
Number of validation edges: 5085
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9518; val_auprc_score: 0.9321; val_best_acc_score: 0.8974; val_best_f1_score: 0.9020; train_kl_reg_loss: 2910.5883; train_edge_recon_loss: 292504.3767; train_gene_expr_recon_loss: 153431.2255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448846.1913; train_optim_loss: 448846.1913; val_kl_reg_loss: 3616.4405; val_edge_recon_loss: 265906.8781; val_gene_expr_recon_loss: 152166.9941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 421690.3109; val_optim_loss: 421690.3109
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9625; val_auprc_score: 0.9474; val_best_acc_score: 0.9155; val_best_f1_score: 0.9189; train_kl_reg_loss: 3562.9762; train_edge_recon_loss: 265457.4071; train_gene_expr_recon_loss: 148410.5038; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417430.8869; train_optim_loss: 417430.8869; val_kl_reg_loss: 3463.3548; val_edge_recon_loss: 264195.2383; val_gene_expr_recon_loss: 150143.5480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 417802.1437; val_optim_loss: 417802.1437
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9724; val_auprc_score: 0.9609; val_best_acc_score: 0.9314; val_best_f1_score: 0.9343; train_kl_reg_loss: 3470.5304; train_edge_recon_loss: 263209.9344; train_gene_expr_recon_loss: 146445.9390; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413126.4049; train_optim_loss: 413126.4049; val_kl_reg_loss: 3453.2823; val_edge_recon_loss: 262228.5320; val_gene_expr_recon_loss: 148101.0816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 413782.8953; val_optim_loss: 413782.8953
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9733; val_auprc_score: 0.9616; val_best_acc_score: 0.9347; val_best_f1_score: 0.9368; train_kl_reg_loss: 3395.2719; train_edge_recon_loss: 262249.4800; train_gene_expr_recon_loss: 144721.6706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 410366.4218; train_optim_loss: 410366.4218; val_kl_reg_loss: 3271.7141; val_edge_recon_loss: 261667.4641; val_gene_expr_recon_loss: 146719.4703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 411658.6484; val_optim_loss: 411658.6484
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9804; val_auprc_score: 0.9711; val_best_acc_score: 0.9477; val_best_f1_score: 0.9494; train_kl_reg_loss: 3357.3038; train_edge_recon_loss: 261690.5178; train_gene_expr_recon_loss: 143390.6165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408438.4377; train_optim_loss: 408438.4377; val_kl_reg_loss: 3388.2315; val_edge_recon_loss: 260320.8344; val_gene_expr_recon_loss: 145720.4258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 409429.4922; val_optim_loss: 409429.4922
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9819; val_auprc_score: 0.9706; val_best_acc_score: 0.9526; val_best_f1_score: 0.9537; train_kl_reg_loss: 3376.2623; train_edge_recon_loss: 260387.1118; train_gene_expr_recon_loss: 142296.1969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406059.5718; train_optim_loss: 406059.5718; val_kl_reg_loss: 3265.9676; val_edge_recon_loss: 259613.4758; val_gene_expr_recon_loss: 144467.2680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407346.7172; val_optim_loss: 407346.7172
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9859; val_auprc_score: 0.9786; val_best_acc_score: 0.9559; val_best_f1_score: 0.9570; train_kl_reg_loss: 3374.8794; train_edge_recon_loss: 259321.0738; train_gene_expr_recon_loss: 141230.3736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403926.3284; train_optim_loss: 403926.3284; val_kl_reg_loss: 3447.4366; val_edge_recon_loss: 259203.6430; val_gene_expr_recon_loss: 143780.0715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406431.1469; val_optim_loss: 406431.1469
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9856; val_auprc_score: 0.9779; val_best_acc_score: 0.9581; val_best_f1_score: 0.9591; train_kl_reg_loss: 3370.8021; train_edge_recon_loss: 259520.2656; train_gene_expr_recon_loss: 140298.7953; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403189.8631; train_optim_loss: 403189.8631; val_kl_reg_loss: 3271.5141; val_edge_recon_loss: 259778.9273; val_gene_expr_recon_loss: 143172.2281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406222.6672; val_optim_loss: 406222.6672
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9884; val_auprc_score: 0.9824; val_best_acc_score: 0.9640; val_best_f1_score: 0.9646; train_kl_reg_loss: 3361.6004; train_edge_recon_loss: 259234.2556; train_gene_expr_recon_loss: 139471.2873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402067.1428; train_optim_loss: 402067.1428; val_kl_reg_loss: 3333.2334; val_edge_recon_loss: 257696.2211; val_gene_expr_recon_loss: 142354.2391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403383.6984; val_optim_loss: 403383.6984
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9891; val_auprc_score: 0.9825; val_best_acc_score: 0.9656; val_best_f1_score: 0.9663; train_kl_reg_loss: 3379.5525; train_edge_recon_loss: 258233.8019; train_gene_expr_recon_loss: 138727.8800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400341.2357; train_optim_loss: 400341.2357; val_kl_reg_loss: 3341.4972; val_edge_recon_loss: 257463.4734; val_gene_expr_recon_loss: 141530.7871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402335.7578; val_optim_loss: 402335.7578
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9900; val_auprc_score: 0.9859; val_best_acc_score: 0.9666; val_best_f1_score: 0.9673; train_kl_reg_loss: 3378.3304; train_edge_recon_loss: 258208.2170; train_gene_expr_recon_loss: 138157.9584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399744.5052; train_optim_loss: 399744.5052; val_kl_reg_loss: 3321.9269; val_edge_recon_loss: 257856.5938; val_gene_expr_recon_loss: 141276.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402455.2078; val_optim_loss: 402455.2078
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9930; val_auprc_score: 0.9902; val_best_acc_score: 0.9698; val_best_f1_score: 0.9704; train_kl_reg_loss: 3372.5501; train_edge_recon_loss: 258073.8491; train_gene_expr_recon_loss: 137575.3794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399021.7792; train_optim_loss: 399021.7792; val_kl_reg_loss: 3444.8626; val_edge_recon_loss: 257975.0875; val_gene_expr_recon_loss: 140528.5055; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401948.4562; val_optim_loss: 401948.4562
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9912; val_auprc_score: 0.9874; val_best_acc_score: 0.9715; val_best_f1_score: 0.9720; train_kl_reg_loss: 3383.5084; train_edge_recon_loss: 257611.7160; train_gene_expr_recon_loss: 137059.4168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398054.6409; train_optim_loss: 398054.6409; val_kl_reg_loss: 3266.9382; val_edge_recon_loss: 258029.3656; val_gene_expr_recon_loss: 140069.9480; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401366.2562; val_optim_loss: 401366.2562
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9911; val_auprc_score: 0.9851; val_best_acc_score: 0.9711; val_best_f1_score: 0.9715; train_kl_reg_loss: 3380.4956; train_edge_recon_loss: 257873.5259; train_gene_expr_recon_loss: 136592.3480; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397846.3691; train_optim_loss: 397846.3691; val_kl_reg_loss: 3404.0806; val_edge_recon_loss: 257616.8344; val_gene_expr_recon_loss: 139821.0531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400841.9672; val_optim_loss: 400841.9672
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9914; val_auprc_score: 0.9865; val_best_acc_score: 0.9707; val_best_f1_score: 0.9713; train_kl_reg_loss: 3386.1160; train_edge_recon_loss: 257944.4484; train_gene_expr_recon_loss: 136100.1745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397430.7387; train_optim_loss: 397430.7387; val_kl_reg_loss: 3420.8689; val_edge_recon_loss: 257574.9758; val_gene_expr_recon_loss: 139339.5879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400335.4297; val_optim_loss: 400335.4297
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9916; val_auprc_score: 0.9853; val_best_acc_score: 0.9755; val_best_f1_score: 0.9760; train_kl_reg_loss: 3395.0435; train_edge_recon_loss: 257812.8996; train_gene_expr_recon_loss: 135757.4241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396965.3680; train_optim_loss: 396965.3680; val_kl_reg_loss: 3361.9745; val_edge_recon_loss: 257988.0578; val_gene_expr_recon_loss: 139135.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400485.5563; val_optim_loss: 400485.5563
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9939; val_auprc_score: 0.9899; val_best_acc_score: 0.9765; val_best_f1_score: 0.9769; train_kl_reg_loss: 3402.0869; train_edge_recon_loss: 257179.1081; train_gene_expr_recon_loss: 135414.8777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395996.0733; train_optim_loss: 395996.0733; val_kl_reg_loss: 3295.4349; val_edge_recon_loss: 256904.5695; val_gene_expr_recon_loss: 138804.4914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399004.4969; val_optim_loss: 399004.4969
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9926; val_auprc_score: 0.9871; val_best_acc_score: 0.9773; val_best_f1_score: 0.9775; train_kl_reg_loss: 3385.6438; train_edge_recon_loss: 257351.4701; train_gene_expr_recon_loss: 135100.5856; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395837.7008; train_optim_loss: 395837.7008; val_kl_reg_loss: 3373.4233; val_edge_recon_loss: 257000.8117; val_gene_expr_recon_loss: 138647.0805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399021.3187; val_optim_loss: 399021.3187
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9936; val_auprc_score: 0.9894; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 3398.5536; train_edge_recon_loss: 257226.7564; train_gene_expr_recon_loss: 134839.3798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395464.6903; train_optim_loss: 395464.6903; val_kl_reg_loss: 3392.4071; val_edge_recon_loss: 257100.7687; val_gene_expr_recon_loss: 138419.9172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398913.0938; val_optim_loss: 398913.0938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9922; val_auprc_score: 0.9835; val_best_acc_score: 0.9779; val_best_f1_score: 0.9782; train_kl_reg_loss: 3396.8597; train_edge_recon_loss: 257205.0755; train_gene_expr_recon_loss: 134560.0272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395161.9619; train_optim_loss: 395161.9619; val_kl_reg_loss: 3384.8107; val_edge_recon_loss: 256467.1859; val_gene_expr_recon_loss: 138230.9379; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398082.9328; val_optim_loss: 398082.9328
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9940; val_auprc_score: 0.9901; val_best_acc_score: 0.9791; val_best_f1_score: 0.9793; train_kl_reg_loss: 3410.9726; train_edge_recon_loss: 256805.7722; train_gene_expr_recon_loss: 134307.2238; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394523.9689; train_optim_loss: 394523.9689; val_kl_reg_loss: 3497.0463; val_edge_recon_loss: 257204.2258; val_gene_expr_recon_loss: 138193.5160; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398894.7859; val_optim_loss: 398894.7859
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9940; val_auprc_score: 0.9894; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 3404.5187; train_edge_recon_loss: 256989.2575; train_gene_expr_recon_loss: 134037.4298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394431.2046; train_optim_loss: 394431.2046; val_kl_reg_loss: 3378.9603; val_edge_recon_loss: 256391.5586; val_gene_expr_recon_loss: 137952.7973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397723.3172; val_optim_loss: 397723.3172
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9934; val_auprc_score: 0.9897; val_best_acc_score: 0.9803; val_best_f1_score: 0.9806; train_kl_reg_loss: 3400.5641; train_edge_recon_loss: 257011.1832; train_gene_expr_recon_loss: 133821.9120; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394233.6611; train_optim_loss: 394233.6611; val_kl_reg_loss: 3341.1332; val_edge_recon_loss: 257236.0969; val_gene_expr_recon_loss: 138020.7953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398598.0203; val_optim_loss: 398598.0203
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9939; val_auprc_score: 0.9877; val_best_acc_score: 0.9809; val_best_f1_score: 0.9812; train_kl_reg_loss: 3416.1342; train_edge_recon_loss: 256797.9820; train_gene_expr_recon_loss: 133692.3852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393906.4993; train_optim_loss: 393906.4993; val_kl_reg_loss: 3266.2872; val_edge_recon_loss: 256982.6406; val_gene_expr_recon_loss: 137620.7004; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397869.6312; val_optim_loss: 397869.6312
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9928; val_auprc_score: 0.9847; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 3408.8136; train_edge_recon_loss: 256791.0251; train_gene_expr_recon_loss: 133459.5196; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393659.3579; train_optim_loss: 393659.3579; val_kl_reg_loss: 3482.4878; val_edge_recon_loss: 256713.0797; val_gene_expr_recon_loss: 137622.9750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397818.5438; val_optim_loss: 397818.5438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9938; val_auprc_score: 0.9870; val_best_acc_score: 0.9786; val_best_f1_score: 0.9789; train_kl_reg_loss: 3322.2446; train_edge_recon_loss: 256381.5997; train_gene_expr_recon_loss: 133033.2113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392737.0560; train_optim_loss: 392737.0560; val_kl_reg_loss: 2880.3931; val_edge_recon_loss: 257034.1625; val_gene_expr_recon_loss: 137360.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397275.4375; val_optim_loss: 397275.4375
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9949; val_auprc_score: 0.9906; val_best_acc_score: 0.9808; val_best_f1_score: 0.9811; train_kl_reg_loss: 3124.0933; train_edge_recon_loss: 256575.9565; train_gene_expr_recon_loss: 132894.1108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392594.1613; train_optim_loss: 392594.1613; val_kl_reg_loss: 2667.7072; val_edge_recon_loss: 256784.4414; val_gene_expr_recon_loss: 137378.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396830.8812; val_optim_loss: 396830.8812
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9931; val_auprc_score: 0.9881; val_best_acc_score: 0.9804; val_best_f1_score: 0.9807; train_kl_reg_loss: 2925.5234; train_edge_recon_loss: 256508.3935; train_gene_expr_recon_loss: 132888.1669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392322.0845; train_optim_loss: 392322.0845; val_kl_reg_loss: 2541.5533; val_edge_recon_loss: 257269.0148; val_gene_expr_recon_loss: 137550.7020; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397361.2719; val_optim_loss: 397361.2719
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9935; val_auprc_score: 0.9865; val_best_acc_score: 0.9805; val_best_f1_score: 0.9807; train_kl_reg_loss: 2780.7575; train_edge_recon_loss: 256317.5630; train_gene_expr_recon_loss: 132805.4181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391903.7399; train_optim_loss: 391903.7399; val_kl_reg_loss: 2411.8770; val_edge_recon_loss: 256691.5367; val_gene_expr_recon_loss: 137385.5176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396488.9328; val_optim_loss: 396488.9328
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9921; val_auprc_score: 0.9820; val_best_acc_score: 0.9803; val_best_f1_score: 0.9806; train_kl_reg_loss: 2689.8857; train_edge_recon_loss: 256582.9125; train_gene_expr_recon_loss: 132846.0265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392118.8235; train_optim_loss: 392118.8235; val_kl_reg_loss: 2335.4383; val_edge_recon_loss: 256180.3305; val_gene_expr_recon_loss: 137353.4621; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395869.2359; val_optim_loss: 395869.2359
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9955; val_auprc_score: 0.9912; val_best_acc_score: 0.9828; val_best_f1_score: 0.9829; train_kl_reg_loss: 2655.8938; train_edge_recon_loss: 256406.2194; train_gene_expr_recon_loss: 132830.6173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391892.7299; train_optim_loss: 391892.7299; val_kl_reg_loss: 2328.9271; val_edge_recon_loss: 256617.8516; val_gene_expr_recon_loss: 137341.9418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396288.7188; val_optim_loss: 396288.7188
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9942; val_auprc_score: 0.9891; val_best_acc_score: 0.9811; val_best_f1_score: 0.9813; train_kl_reg_loss: 2637.5323; train_edge_recon_loss: 256175.8547; train_gene_expr_recon_loss: 132788.4860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391601.8710; train_optim_loss: 391601.8710; val_kl_reg_loss: 2329.3569; val_edge_recon_loss: 257548.3469; val_gene_expr_recon_loss: 137440.1305; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397317.8328; val_optim_loss: 397317.8328
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9944; val_auprc_score: 0.9902; val_best_acc_score: 0.9824; val_best_f1_score: 0.9826; train_kl_reg_loss: 2628.7817; train_edge_recon_loss: 256292.7610; train_gene_expr_recon_loss: 132696.3320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391617.8747; train_optim_loss: 391617.8747; val_kl_reg_loss: 2320.5083; val_edge_recon_loss: 256779.8539; val_gene_expr_recon_loss: 137474.6418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396575.0031; val_optim_loss: 396575.0031

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9939; val_auprc_score: 0.9864; val_best_acc_score: 0.9815; val_best_f1_score: 0.9817; train_kl_reg_loss: 2605.8131; train_edge_recon_loss: 256332.3782; train_gene_expr_recon_loss: 132706.7140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391644.9050; train_optim_loss: 391644.9050; val_kl_reg_loss: 2324.7450; val_edge_recon_loss: 257185.7414; val_gene_expr_recon_loss: 137240.0762; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396750.5609; val_optim_loss: 396750.5609
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9946; val_auprc_score: 0.9904; val_best_acc_score: 0.9820; val_best_f1_score: 0.9822; train_kl_reg_loss: 2613.9883; train_edge_recon_loss: 256028.6538; train_gene_expr_recon_loss: 132643.6513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391286.2943; train_optim_loss: 391286.2943; val_kl_reg_loss: 2336.8419; val_edge_recon_loss: 256836.7086; val_gene_expr_recon_loss: 137315.7488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396489.2984; val_optim_loss: 396489.2984
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9951; val_auprc_score: 0.9928; val_best_acc_score: 0.9830; val_best_f1_score: 0.9832; train_kl_reg_loss: 2620.0861; train_edge_recon_loss: 256141.9353; train_gene_expr_recon_loss: 132660.3406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 391422.3610; train_optim_loss: 391422.3610; val_kl_reg_loss: 2337.4396; val_edge_recon_loss: 256285.5828; val_gene_expr_recon_loss: 137312.4496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395935.4703; val_optim_loss: 395935.4703

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 47 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9945
Val AUPRC score: 0.9902
Val best accuracy score: 0.9819
Val best F1 score: 0.9821
Val gene expr MSE score: 0.8534
Duration of model training in run 9: 0 hours, 7 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cond_embed_input: 0, n_layers: 1, n_hidden: 732, n_latent: 732, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 732, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 732, n_cond_embed_input: 732, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 4106
Number of validation nodes: 456
Number of training edges: 45766
Number of validation edges: 5085
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9522; val_auprc_score: 0.9361; val_best_acc_score: 0.8971; val_best_f1_score: 0.9029; train_kl_reg_loss: 3009.4547; train_edge_recon_loss: 290633.4542; train_gene_expr_recon_loss: 153435.8218; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447078.7297; train_optim_loss: 447078.7297; val_kl_reg_loss: 3628.2952; val_edge_recon_loss: 267349.4969; val_gene_expr_recon_loss: 152714.9320; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 423692.7203; val_optim_loss: 423692.7203
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9710; val_auprc_score: 0.9587; val_best_acc_score: 0.9301; val_best_f1_score: 0.9327; train_kl_reg_loss: 3569.5408; train_edge_recon_loss: 265927.3602; train_gene_expr_recon_loss: 148400.3949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 417897.2950; train_optim_loss: 417897.2950; val_kl_reg_loss: 3427.4102; val_edge_recon_loss: 262905.6250; val_gene_expr_recon_loss: 150393.1672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 416726.2031; val_optim_loss: 416726.2031
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9743; val_auprc_score: 0.9627; val_best_acc_score: 0.9318; val_best_f1_score: 0.9340; train_kl_reg_loss: 3452.5609; train_edge_recon_loss: 263949.4661; train_gene_expr_recon_loss: 146566.5295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 413968.5560; train_optim_loss: 413968.5560; val_kl_reg_loss: 3391.1472; val_edge_recon_loss: 262379.6031; val_gene_expr_recon_loss: 148569.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 414340.7094; val_optim_loss: 414340.7094
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9750; val_auprc_score: 0.9629; val_best_acc_score: 0.9366; val_best_f1_score: 0.9384; train_kl_reg_loss: 3372.4037; train_edge_recon_loss: 263220.5579; train_gene_expr_recon_loss: 145012.2407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 411605.2016; train_optim_loss: 411605.2016; val_kl_reg_loss: 3435.4227; val_edge_recon_loss: 262092.3922; val_gene_expr_recon_loss: 147411.5934; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 412939.4141; val_optim_loss: 412939.4141
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9798; val_auprc_score: 0.9699; val_best_acc_score: 0.9471; val_best_f1_score: 0.9484; train_kl_reg_loss: 3369.3327; train_edge_recon_loss: 261909.2301; train_gene_expr_recon_loss: 143525.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 408803.9541; train_optim_loss: 408803.9541; val_kl_reg_loss: 3331.7779; val_edge_recon_loss: 260925.4586; val_gene_expr_recon_loss: 146609.5680; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 410866.8047; val_optim_loss: 410866.8047
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9818; val_auprc_score: 0.9694; val_best_acc_score: 0.9543; val_best_f1_score: 0.9557; train_kl_reg_loss: 3376.0459; train_edge_recon_loss: 260335.9373; train_gene_expr_recon_loss: 142495.1021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 406207.0862; train_optim_loss: 406207.0862; val_kl_reg_loss: 3416.6842; val_edge_recon_loss: 258658.7891; val_gene_expr_recon_loss: 144980.3176; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 407055.7938; val_optim_loss: 407055.7938
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9839; val_auprc_score: 0.9741; val_best_acc_score: 0.9556; val_best_f1_score: 0.9565; train_kl_reg_loss: 3379.3625; train_edge_recon_loss: 259688.3763; train_gene_expr_recon_loss: 141437.5398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 404505.2792; train_optim_loss: 404505.2792; val_kl_reg_loss: 3366.0978; val_edge_recon_loss: 258826.6164; val_gene_expr_recon_loss: 144129.9156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 406322.6312; val_optim_loss: 406322.6312
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9883; val_auprc_score: 0.9837; val_best_acc_score: 0.9617; val_best_f1_score: 0.9624; train_kl_reg_loss: 3369.4953; train_edge_recon_loss: 259803.3164; train_gene_expr_recon_loss: 140682.3235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 403855.1365; train_optim_loss: 403855.1365; val_kl_reg_loss: 3281.9292; val_edge_recon_loss: 257330.3586; val_gene_expr_recon_loss: 143334.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403946.3453; val_optim_loss: 403946.3453
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9880; val_auprc_score: 0.9814; val_best_acc_score: 0.9609; val_best_f1_score: 0.9618; train_kl_reg_loss: 3363.8847; train_edge_recon_loss: 259222.6080; train_gene_expr_recon_loss: 139664.2057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 402250.6978; train_optim_loss: 402250.6978; val_kl_reg_loss: 3311.2836; val_edge_recon_loss: 259027.7922; val_gene_expr_recon_loss: 142663.3086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 405002.3797; val_optim_loss: 405002.3797
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9892; val_auprc_score: 0.9847; val_best_acc_score: 0.9652; val_best_f1_score: 0.9659; train_kl_reg_loss: 3364.8946; train_edge_recon_loss: 258578.6567; train_gene_expr_recon_loss: 138919.3426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400862.8925; train_optim_loss: 400862.8925; val_kl_reg_loss: 3435.8001; val_edge_recon_loss: 257506.7437; val_gene_expr_recon_loss: 142188.4871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 403131.0266; val_optim_loss: 403131.0266
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9906; val_auprc_score: 0.9862; val_best_acc_score: 0.9667; val_best_f1_score: 0.9672; train_kl_reg_loss: 3374.4111; train_edge_recon_loss: 258400.8341; train_gene_expr_recon_loss: 138280.4768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 400055.7214; train_optim_loss: 400055.7214; val_kl_reg_loss: 3345.7020; val_edge_recon_loss: 257358.1187; val_gene_expr_recon_loss: 141487.7867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 402191.6047; val_optim_loss: 402191.6047
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9924; val_auprc_score: 0.9871; val_best_acc_score: 0.9726; val_best_f1_score: 0.9729; train_kl_reg_loss: 3373.9595; train_edge_recon_loss: 258078.5878; train_gene_expr_recon_loss: 137788.1850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 399240.7343; train_optim_loss: 399240.7343; val_kl_reg_loss: 3299.8804; val_edge_recon_loss: 257157.8430; val_gene_expr_recon_loss: 141195.4535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401653.1781; val_optim_loss: 401653.1781
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9915; val_auprc_score: 0.9874; val_best_acc_score: 0.9703; val_best_f1_score: 0.9707; train_kl_reg_loss: 3385.6353; train_edge_recon_loss: 257829.6675; train_gene_expr_recon_loss: 137229.4257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 398444.7296; train_optim_loss: 398444.7296; val_kl_reg_loss: 3381.4779; val_edge_recon_loss: 257185.4703; val_gene_expr_recon_loss: 140596.2746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 401163.2297; val_optim_loss: 401163.2297
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9932; val_auprc_score: 0.9898; val_best_acc_score: 0.9728; val_best_f1_score: 0.9731; train_kl_reg_loss: 3394.4067; train_edge_recon_loss: 257805.5550; train_gene_expr_recon_loss: 136711.2913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397911.2530; train_optim_loss: 397911.2530; val_kl_reg_loss: 3322.1860; val_edge_recon_loss: 256552.8977; val_gene_expr_recon_loss: 140355.0445; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 400230.1250; val_optim_loss: 400230.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9931; val_auprc_score: 0.9885; val_best_acc_score: 0.9754; val_best_f1_score: 0.9758; train_kl_reg_loss: 3401.2079; train_edge_recon_loss: 257526.3424; train_gene_expr_recon_loss: 136394.6657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 397322.2151; train_optim_loss: 397322.2151; val_kl_reg_loss: 3357.9564; val_edge_recon_loss: 255820.9438; val_gene_expr_recon_loss: 140036.4785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399215.3781; val_optim_loss: 399215.3781
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9915; val_auprc_score: 0.9840; val_best_acc_score: 0.9723; val_best_f1_score: 0.9728; train_kl_reg_loss: 3393.6893; train_edge_recon_loss: 257595.7950; train_gene_expr_recon_loss: 135921.8637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396911.3497; train_optim_loss: 396911.3497; val_kl_reg_loss: 3335.0942; val_edge_recon_loss: 256436.7359; val_gene_expr_recon_loss: 139740.1965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399512.0250; val_optim_loss: 399512.0250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9926; val_auprc_score: 0.9883; val_best_acc_score: 0.9745; val_best_f1_score: 0.9750; train_kl_reg_loss: 3396.4480; train_edge_recon_loss: 257536.9110; train_gene_expr_recon_loss: 135601.1432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 396534.5017; train_optim_loss: 396534.5017; val_kl_reg_loss: 3368.3803; val_edge_recon_loss: 257054.0453; val_gene_expr_recon_loss: 138982.8059; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399405.2313; val_optim_loss: 399405.2313
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9944; val_auprc_score: 0.9922; val_best_acc_score: 0.9769; val_best_f1_score: 0.9771; train_kl_reg_loss: 3398.3939; train_edge_recon_loss: 257095.4239; train_gene_expr_recon_loss: 135306.0126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395799.8308; train_optim_loss: 395799.8308; val_kl_reg_loss: 3429.2302; val_edge_recon_loss: 256294.3961; val_gene_expr_recon_loss: 139155.4367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398879.0609; val_optim_loss: 398879.0609
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9933; val_auprc_score: 0.9861; val_best_acc_score: 0.9755; val_best_f1_score: 0.9758; train_kl_reg_loss: 3408.1924; train_edge_recon_loss: 257361.9539; train_gene_expr_recon_loss: 134956.6436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395726.7896; train_optim_loss: 395726.7896; val_kl_reg_loss: 3432.5176; val_edge_recon_loss: 256924.7188; val_gene_expr_recon_loss: 138940.3781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399297.6141; val_optim_loss: 399297.6141
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9927; val_auprc_score: 0.9883; val_best_acc_score: 0.9775; val_best_f1_score: 0.9778; train_kl_reg_loss: 3404.1552; train_edge_recon_loss: 257078.8898; train_gene_expr_recon_loss: 134672.1103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 395155.1559; train_optim_loss: 395155.1559; val_kl_reg_loss: 3397.1520; val_edge_recon_loss: 256741.0445; val_gene_expr_recon_loss: 138909.9496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 399048.1516; val_optim_loss: 399048.1516
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9922; val_auprc_score: 0.9885; val_best_acc_score: 0.9743; val_best_f1_score: 0.9748; train_kl_reg_loss: 3414.0857; train_edge_recon_loss: 256928.5146; train_gene_expr_recon_loss: 134379.7295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394722.3298; train_optim_loss: 394722.3298; val_kl_reg_loss: 3333.8811; val_edge_recon_loss: 257186.9406; val_gene_expr_recon_loss: 138405.7918; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398926.6156; val_optim_loss: 398926.6156

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9942; val_auprc_score: 0.9905; val_best_acc_score: 0.9783; val_best_f1_score: 0.9786; train_kl_reg_loss: 3394.6480; train_edge_recon_loss: 256772.9485; train_gene_expr_recon_loss: 133702.9350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393870.5323; train_optim_loss: 393870.5323; val_kl_reg_loss: 3384.7736; val_edge_recon_loss: 256184.8758; val_gene_expr_recon_loss: 137980.4727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397550.1219; val_optim_loss: 397550.1219
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9943; val_auprc_score: 0.9889; val_best_acc_score: 0.9783; val_best_f1_score: 0.9785; train_kl_reg_loss: 3407.6420; train_edge_recon_loss: 256756.4653; train_gene_expr_recon_loss: 133537.6781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393701.7861; train_optim_loss: 393701.7861; val_kl_reg_loss: 3403.3134; val_edge_recon_loss: 256028.3961; val_gene_expr_recon_loss: 138113.5191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397545.2297; val_optim_loss: 397545.2297
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9917; val_auprc_score: 0.9832; val_best_acc_score: 0.9778; val_best_f1_score: 0.9781; train_kl_reg_loss: 3409.1749; train_edge_recon_loss: 256295.5428; train_gene_expr_recon_loss: 133530.4146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393235.1332; train_optim_loss: 393235.1332; val_kl_reg_loss: 3404.9785; val_edge_recon_loss: 256870.2383; val_gene_expr_recon_loss: 137984.4863; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 398259.7031; val_optim_loss: 398259.7031
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9957; val_auprc_score: 0.9924; val_best_acc_score: 0.9810; val_best_f1_score: 0.9812; train_kl_reg_loss: 3403.6056; train_edge_recon_loss: 256889.6423; train_gene_expr_recon_loss: 133517.5594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393810.8071; train_optim_loss: 393810.8071; val_kl_reg_loss: 3381.1973; val_edge_recon_loss: 256349.8352; val_gene_expr_recon_loss: 137974.2922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397705.3187; val_optim_loss: 397705.3187
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9938; val_auprc_score: 0.9880; val_best_acc_score: 0.9789; val_best_f1_score: 0.9791; train_kl_reg_loss: 3240.3728; train_edge_recon_loss: 257153.9061; train_gene_expr_recon_loss: 133613.9747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 394008.2537; train_optim_loss: 394008.2537; val_kl_reg_loss: 2802.1495; val_edge_recon_loss: 256541.7445; val_gene_expr_recon_loss: 138110.8238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397454.7141; val_optim_loss: 397454.7141
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9926; val_auprc_score: 0.9841; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 3032.9699; train_edge_recon_loss: 256607.7948; train_gene_expr_recon_loss: 133584.8742; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393225.6398; train_optim_loss: 393225.6398; val_kl_reg_loss: 2554.6428; val_edge_recon_loss: 256621.2742; val_gene_expr_recon_loss: 138049.1371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397225.0500; val_optim_loss: 397225.0500
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9942; val_auprc_score: 0.9896; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 2816.0545; train_edge_recon_loss: 256882.0270; train_gene_expr_recon_loss: 133619.0210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 393317.1023; train_optim_loss: 393317.1023; val_kl_reg_loss: 2379.7359; val_edge_recon_loss: 256469.4148; val_gene_expr_recon_loss: 138052.0293; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396901.1781; val_optim_loss: 396901.1781
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9937; val_auprc_score: 0.9891; val_best_acc_score: 0.9773; val_best_f1_score: 0.9776; train_kl_reg_loss: 2672.5640; train_edge_recon_loss: 256728.9897; train_gene_expr_recon_loss: 133526.7833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392928.3369; train_optim_loss: 392928.3369; val_kl_reg_loss: 2292.5568; val_edge_recon_loss: 257370.1234; val_gene_expr_recon_loss: 138108.1422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397770.8187; val_optim_loss: 397770.8187
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9941; val_auprc_score: 0.9907; val_best_acc_score: 0.9794; val_best_f1_score: 0.9797; train_kl_reg_loss: 2609.6159; train_edge_recon_loss: 256647.9692; train_gene_expr_recon_loss: 133528.0151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392785.6013; train_optim_loss: 392785.6013; val_kl_reg_loss: 2257.7110; val_edge_recon_loss: 256445.3203; val_gene_expr_recon_loss: 138108.4695; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396811.5047; val_optim_loss: 396811.5047
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9950; val_auprc_score: 0.9909; val_best_acc_score: 0.9823; val_best_f1_score: 0.9825; train_kl_reg_loss: 2587.6256; train_edge_recon_loss: 256261.7038; train_gene_expr_recon_loss: 133447.9359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392297.2647; train_optim_loss: 392297.2647; val_kl_reg_loss: 2263.1539; val_edge_recon_loss: 255572.2203; val_gene_expr_recon_loss: 138145.0043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 395980.3719; val_optim_loss: 395980.3719
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9939; val_auprc_score: 0.9889; val_best_acc_score: 0.9792; val_best_f1_score: 0.9794; train_kl_reg_loss: 2589.8499; train_edge_recon_loss: 256367.2985; train_gene_expr_recon_loss: 133485.9949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392443.1432; train_optim_loss: 392443.1432; val_kl_reg_loss: 2270.1387; val_edge_recon_loss: 257226.1523; val_gene_expr_recon_loss: 138225.3813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397721.6766; val_optim_loss: 397721.6766
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9950; val_auprc_score: 0.9926; val_best_acc_score: 0.9800; val_best_f1_score: 0.9803; train_kl_reg_loss: 2564.2776; train_edge_recon_loss: 256593.8938; train_gene_expr_recon_loss: 133376.6146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392534.7863; train_optim_loss: 392534.7863; val_kl_reg_loss: 2247.2025; val_edge_recon_loss: 256716.4008; val_gene_expr_recon_loss: 137980.7898; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396944.3922; val_optim_loss: 396944.3922
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9933; val_auprc_score: 0.9884; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 2556.8471; train_edge_recon_loss: 256390.2553; train_gene_expr_recon_loss: 133412.2351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392359.3355; train_optim_loss: 392359.3355; val_kl_reg_loss: 2249.6826; val_edge_recon_loss: 257038.7437; val_gene_expr_recon_loss: 138079.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397367.9250; val_optim_loss: 397367.9250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9946; val_auprc_score: 0.9895; val_best_acc_score: 0.9797; val_best_f1_score: 0.9800; train_kl_reg_loss: 2539.1976; train_edge_recon_loss: 256413.6431; train_gene_expr_recon_loss: 133381.3036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392334.1444; train_optim_loss: 392334.1444; val_kl_reg_loss: 2261.8819; val_edge_recon_loss: 256650.3922; val_gene_expr_recon_loss: 138010.9395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396923.2125; val_optim_loss: 396923.2125
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9945; val_auprc_score: 0.9895; val_best_acc_score: 0.9808; val_best_f1_score: 0.9810; train_kl_reg_loss: 2542.1378; train_edge_recon_loss: 256425.2975; train_gene_expr_recon_loss: 133286.8590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392254.2936; train_optim_loss: 392254.2936; val_kl_reg_loss: 2269.2417; val_edge_recon_loss: 255860.5023; val_gene_expr_recon_loss: 138030.5715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 396160.3109; val_optim_loss: 396160.3109
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9945; val_auprc_score: 0.9906; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 2543.3930; train_edge_recon_loss: 256376.4569; train_gene_expr_recon_loss: 133325.9173; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 392245.7671; train_optim_loss: 392245.7671; val_kl_reg_loss: 2268.7128; val_edge_recon_loss: 257418.4102; val_gene_expr_recon_loss: 137786.8543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 397473.9750; val_optim_loss: 397473.9750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 8 min 10 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9934
Val AUPRC score: 0.9860
Val best accuracy score: 0.9793
Val best F1 score: 0.9795
Val gene expr MSE score: 0.9350
Duration of model training in run 10: 0 hours, 8 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
