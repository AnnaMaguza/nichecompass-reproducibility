Run timestamp: 16082023_163743_1.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '16', '16', '12', '12', '8', '8', '4', '4', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '7', '6', '5', '4', '3', '2', '1', '0', '--run_index', '8', '7', '6', '5', '4', '3', '2', '1', '--cell_type_key', 'cell_type', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'slideseqv2_mouse_hippocampus_subsample_1pct', '--reference_batches', 'None', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'gatv2conv_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 3020
Number of validation edges: 335
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9365; val_auprc_score: 0.8826; val_best_acc_score: 0.8791; val_best_f1_score: 0.8851; train_kl_reg_loss: 0.4479; train_edge_recon_loss: 3466061.7500; train_gene_expr_recon_loss: 1806215.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5272277.0000; train_optim_loss: 5272277.0000; val_kl_reg_loss: 6.8259; val_edge_recon_loss: 4040679.7500; val_gene_expr_recon_loss: 1899945.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5940632.0000; val_optim_loss: 5940632.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9367; val_auprc_score: 0.9120; val_best_acc_score: 0.6836; val_best_f1_score: 0.7596; train_kl_reg_loss: 6.5492; train_edge_recon_loss: 3466735.5000; train_gene_expr_recon_loss: 1794493.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5261235.5000; train_optim_loss: 5261235.5000; val_kl_reg_loss: 42.0149; val_edge_recon_loss: 4057898.7500; val_gene_expr_recon_loss: 1886349.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5944290.0000; val_optim_loss: 5944290.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8982; val_auprc_score: 0.8565; val_best_acc_score: 0.5134; val_best_f1_score: 0.6727; train_kl_reg_loss: 39.7575; train_edge_recon_loss: 3466428.0000; train_gene_expr_recon_loss: 1782716.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5249184.0000; train_optim_loss: 5249184.0000; val_kl_reg_loss: 145.5925; val_edge_recon_loss: 4063277.0000; val_gene_expr_recon_loss: 1879732.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5943155.0000; val_optim_loss: 5943155.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8875; val_auprc_score: 0.8554; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 139.4635; train_edge_recon_loss: 3462899.0000; train_gene_expr_recon_loss: 1775158.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5238197.0000; train_optim_loss: 5238197.0000; val_kl_reg_loss: 383.8802; val_edge_recon_loss: 4064673.5000; val_gene_expr_recon_loss: 1885924.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5950981.5000; val_optim_loss: 5950981.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8986; val_auprc_score: 0.8797; val_best_acc_score: 0.5030; val_best_f1_score: 0.6680; train_kl_reg_loss: 363.3085; train_edge_recon_loss: 3461754.0000; train_gene_expr_recon_loss: 1770177.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5232295.0000; train_optim_loss: 5232295.0000; val_kl_reg_loss: 490.1491; val_edge_recon_loss: 4064242.7500; val_gene_expr_recon_loss: 1886840.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5951573.5000; val_optim_loss: 5951573.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8876; val_auprc_score: 0.8660; val_best_acc_score: 0.5731; val_best_f1_score: 0.7008; train_kl_reg_loss: 462.9537; train_edge_recon_loss: 3462935.7500; train_gene_expr_recon_loss: 1766183.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5229582.0000; train_optim_loss: 5229582.0000; val_kl_reg_loss: 403.0686; val_edge_recon_loss: 4062759.5000; val_gene_expr_recon_loss: 1882817.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5945979.5000; val_optim_loss: 5945979.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8879; val_auprc_score: 0.8667; val_best_acc_score: 0.6030; val_best_f1_score: 0.7158; train_kl_reg_loss: 390.7127; train_edge_recon_loss: 3459922.7500; train_gene_expr_recon_loss: 1764491.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5224805.0000; train_optim_loss: 5224805.0000; val_kl_reg_loss: 420.8715; val_edge_recon_loss: 4060776.0000; val_gene_expr_recon_loss: 1870785.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5931982.0000; val_optim_loss: 5931982.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8561; val_auprc_score: 0.8346; val_best_acc_score: 0.6090; val_best_f1_score: 0.7171; train_kl_reg_loss: 398.9257; train_edge_recon_loss: 3454174.5000; train_gene_expr_recon_loss: 1761372.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5215946.5000; train_optim_loss: 5215946.5000; val_kl_reg_loss: 590.7750; val_edge_recon_loss: 4058203.5000; val_gene_expr_recon_loss: 1877683.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5936477.0000; val_optim_loss: 5936477.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8130; val_auprc_score: 0.7722; val_best_acc_score: 0.6642; val_best_f1_score: 0.7434; train_kl_reg_loss: 550.0253; train_edge_recon_loss: 3446986.5000; train_gene_expr_recon_loss: 1758472.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5206009.0000; train_optim_loss: 5206009.0000; val_kl_reg_loss: 794.7609; val_edge_recon_loss: 4048153.2500; val_gene_expr_recon_loss: 1874232.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5923180.0000; val_optim_loss: 5923180.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8170; val_auprc_score: 0.7880; val_best_acc_score: 0.7284; val_best_f1_score: 0.7736; train_kl_reg_loss: 728.2365; train_edge_recon_loss: 3444566.7500; train_gene_expr_recon_loss: 1754777.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5200072.0000; train_optim_loss: 5200072.0000; val_kl_reg_loss: 697.0918; val_edge_recon_loss: 4023576.5000; val_gene_expr_recon_loss: 1865247.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5889521.0000; val_optim_loss: 5889521.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7839; val_auprc_score: 0.7644; val_best_acc_score: 0.7060; val_best_f1_score: 0.7398; train_kl_reg_loss: 624.5088; train_edge_recon_loss: 3431583.7500; train_gene_expr_recon_loss: 1754089.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5186297.5000; train_optim_loss: 5186297.5000; val_kl_reg_loss: 738.9907; val_edge_recon_loss: 3983727.5000; val_gene_expr_recon_loss: 1867212.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5851679.0000; val_optim_loss: 5851679.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7881; val_auprc_score: 0.7743; val_best_acc_score: 0.7060; val_best_f1_score: 0.7421; train_kl_reg_loss: 657.2351; train_edge_recon_loss: 3421565.2500; train_gene_expr_recon_loss: 1751820.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5174043.0000; train_optim_loss: 5174043.0000; val_kl_reg_loss: 936.5864; val_edge_recon_loss: 3864752.2500; val_gene_expr_recon_loss: 1862011.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5727700.0000; val_optim_loss: 5727700.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7876; val_auprc_score: 0.7742; val_best_acc_score: 0.7194; val_best_f1_score: 0.7689; train_kl_reg_loss: 863.0297; train_edge_recon_loss: 3420158.0000; train_gene_expr_recon_loss: 1747919.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5168940.0000; train_optim_loss: 5168940.0000; val_kl_reg_loss: 961.2915; val_edge_recon_loss: 3692354.5000; val_gene_expr_recon_loss: 1862484.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5555800.0000; val_optim_loss: 5555800.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8197; val_auprc_score: 0.7561; val_best_acc_score: 0.7731; val_best_f1_score: 0.8000; train_kl_reg_loss: 851.1792; train_edge_recon_loss: 3405744.7500; train_gene_expr_recon_loss: 1746103.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5152699.0000; train_optim_loss: 5152699.0000; val_kl_reg_loss: 853.3120; val_edge_recon_loss: 3464166.2500; val_gene_expr_recon_loss: 1864826.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5329846.0000; val_optim_loss: 5329846.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8129; val_auprc_score: 0.7822; val_best_acc_score: 0.7433; val_best_f1_score: 0.7781; train_kl_reg_loss: 687.3218; train_edge_recon_loss: 3391716.5000; train_gene_expr_recon_loss: 1746145.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5138549.0000; train_optim_loss: 5138549.0000; val_kl_reg_loss: 1160.5256; val_edge_recon_loss: 3311299.0000; val_gene_expr_recon_loss: 1855224.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5167684.0000; val_optim_loss: 5167684.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8100; val_auprc_score: 0.7891; val_best_acc_score: 0.7418; val_best_f1_score: 0.7692; train_kl_reg_loss: 1019.7180; train_edge_recon_loss: 3385088.7500; train_gene_expr_recon_loss: 1740821.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5126930.5000; train_optim_loss: 5126930.5000; val_kl_reg_loss: 1362.6904; val_edge_recon_loss: 3185132.2500; val_gene_expr_recon_loss: 1852901.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5039397.0000; val_optim_loss: 5039397.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8287; val_auprc_score: 0.8028; val_best_acc_score: 0.7537; val_best_f1_score: 0.7779; train_kl_reg_loss: 1222.9886; train_edge_recon_loss: 3371409.2500; train_gene_expr_recon_loss: 1737221.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5109854.0000; train_optim_loss: 5109854.0000; val_kl_reg_loss: 1543.2008; val_edge_recon_loss: 3046667.7500; val_gene_expr_recon_loss: 1855766.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4903977.0000; val_optim_loss: 4903977.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8147; val_auprc_score: 0.7904; val_best_acc_score: 0.7403; val_best_f1_score: 0.7751; train_kl_reg_loss: 1403.2600; train_edge_recon_loss: 3362819.0000; train_gene_expr_recon_loss: 1734021.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5098244.0000; train_optim_loss: 5098244.0000; val_kl_reg_loss: 1671.8558; val_edge_recon_loss: 3065226.0000; val_gene_expr_recon_loss: 1855044.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4921942.0000; val_optim_loss: 4921942.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8234; val_auprc_score: 0.7922; val_best_acc_score: 0.7358; val_best_f1_score: 0.7712; train_kl_reg_loss: 1408.8499; train_edge_recon_loss: 3335486.2500; train_gene_expr_recon_loss: 1732153.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5069048.0000; train_optim_loss: 5069048.0000; val_kl_reg_loss: 1671.4519; val_edge_recon_loss: 3011633.5000; val_gene_expr_recon_loss: 1843860.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4857165.0000; val_optim_loss: 4857165.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8201; val_auprc_score: 0.8097; val_best_acc_score: 0.7328; val_best_f1_score: 0.7546; train_kl_reg_loss: 1443.5505; train_edge_recon_loss: 3313808.2500; train_gene_expr_recon_loss: 1731436.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5046688.0000; train_optim_loss: 5046688.0000; val_kl_reg_loss: 1955.2601; val_edge_recon_loss: 3055167.2500; val_gene_expr_recon_loss: 1836321.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4893443.5000; val_optim_loss: 4893443.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8197; val_auprc_score: 0.8204; val_best_acc_score: 0.7194; val_best_f1_score: 0.7636; train_kl_reg_loss: 1691.9264; train_edge_recon_loss: 3311885.5000; train_gene_expr_recon_loss: 1729215.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5042792.5000; train_optim_loss: 5042792.5000; val_kl_reg_loss: 2218.9219; val_edge_recon_loss: 3044068.0000; val_gene_expr_recon_loss: 1847328.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4893615.5000; val_optim_loss: 4893615.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7796; val_auprc_score: 0.7713; val_best_acc_score: 0.6836; val_best_f1_score: 0.7376; train_kl_reg_loss: 1901.6536; train_edge_recon_loss: 3276743.2500; train_gene_expr_recon_loss: 1728228.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5006873.0000; train_optim_loss: 5006873.0000; val_kl_reg_loss: 3020.6855; val_edge_recon_loss: 3174842.5000; val_gene_expr_recon_loss: 1833259.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5011122.0000; val_optim_loss: 5011122.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8083; val_auprc_score: 0.8065; val_best_acc_score: 0.6925; val_best_f1_score: 0.7470; train_kl_reg_loss: 2745.5942; train_edge_recon_loss: 3207988.7500; train_gene_expr_recon_loss: 1723567.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4934302.0000; train_optim_loss: 4934302.0000; val_kl_reg_loss: 4132.2046; val_edge_recon_loss: 3124385.7500; val_gene_expr_recon_loss: 1850978.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4979496.5000; val_optim_loss: 4979496.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8098; val_auprc_score: 0.7942; val_best_acc_score: 0.6910; val_best_f1_score: 0.7473; train_kl_reg_loss: 3567.3818; train_edge_recon_loss: 3160491.0000; train_gene_expr_recon_loss: 1726530.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4890588.5000; train_optim_loss: 4890588.5000; val_kl_reg_loss: 4113.4189; val_edge_recon_loss: 3120584.7500; val_gene_expr_recon_loss: 1841298.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4965997.0000; val_optim_loss: 4965997.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8070; val_auprc_score: 0.7919; val_best_acc_score: 0.7060; val_best_f1_score: 0.7568; train_kl_reg_loss: 3637.3613; train_edge_recon_loss: 3148251.0000; train_gene_expr_recon_loss: 1726948.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4878837.0000; train_optim_loss: 4878837.0000; val_kl_reg_loss: 4239.3628; val_edge_recon_loss: 3051085.5000; val_gene_expr_recon_loss: 1843392.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4898717.5000; val_optim_loss: 4898717.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8177; val_auprc_score: 0.8277; val_best_acc_score: 0.6985; val_best_f1_score: 0.7450; train_kl_reg_loss: 3735.2312; train_edge_recon_loss: 3157839.0000; train_gene_expr_recon_loss: 1727082.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4888656.5000; train_optim_loss: 4888656.5000; val_kl_reg_loss: 4268.8877; val_edge_recon_loss: 3149880.2500; val_gene_expr_recon_loss: 1862071.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5016220.5000; val_optim_loss: 5016220.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8082; val_auprc_score: 0.8031; val_best_acc_score: 0.6925; val_best_f1_score: 0.7461; train_kl_reg_loss: 3777.4355; train_edge_recon_loss: 3126142.2500; train_gene_expr_recon_loss: 1727914.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4857834.0000; train_optim_loss: 4857834.0000; val_kl_reg_loss: 4132.5132; val_edge_recon_loss: 3161122.0000; val_gene_expr_recon_loss: 1845142.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5010396.5000; val_optim_loss: 5010396.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 18 sec.
Using best model state, which was in epoch 19.

--- MODEL EVALUATION ---
val AUROC score: 0.8082
val AUPRC score: 0.7847
val best accuracy score: 0.7209
val best F1 score: 0.7608
val target rna MSE score: 0.0110
val source rna MSE score: 0.0031
Duration of model training in run 8: 0 hours, 0 minutes and 33 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 3020
Number of validation edges: 335
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9333; val_auprc_score: 0.8935; val_best_acc_score: 0.8881; val_best_f1_score: 0.8895; train_kl_reg_loss: 0.4701; train_edge_recon_loss: 3467051.7500; train_gene_expr_recon_loss: 1803685.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5270737.0000; train_optim_loss: 5270737.0000; val_kl_reg_loss: 6.9126; val_edge_recon_loss: 4040957.5000; val_gene_expr_recon_loss: 1880404.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5921369.0000; val_optim_loss: 5921369.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9260; val_auprc_score: 0.9033; val_best_acc_score: 0.7060; val_best_f1_score: 0.7728; train_kl_reg_loss: 6.7072; train_edge_recon_loss: 3467490.7500; train_gene_expr_recon_loss: 1790529.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5258027.0000; train_optim_loss: 5258027.0000; val_kl_reg_loss: 41.6511; val_edge_recon_loss: 4056879.0000; val_gene_expr_recon_loss: 1875857.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5932778.0000; val_optim_loss: 5932778.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8932; val_auprc_score: 0.8878; val_best_acc_score: 0.5403; val_best_f1_score: 0.6851; train_kl_reg_loss: 39.5666; train_edge_recon_loss: 3465879.2500; train_gene_expr_recon_loss: 1781384.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5247303.0000; train_optim_loss: 5247303.0000; val_kl_reg_loss: 152.0699; val_edge_recon_loss: 4062798.0000; val_gene_expr_recon_loss: 1875659.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5938610.0000; val_optim_loss: 5938610.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8820; val_auprc_score: 0.8682; val_best_acc_score: 0.5045; val_best_f1_score: 0.6687; train_kl_reg_loss: 142.7206; train_edge_recon_loss: 3462222.7500; train_gene_expr_recon_loss: 1774202.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5236567.5000; train_optim_loss: 5236567.5000; val_kl_reg_loss: 393.4500; val_edge_recon_loss: 4064127.0000; val_gene_expr_recon_loss: 1872409.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5936930.0000; val_optim_loss: 5936930.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8759; val_auprc_score: 0.8711; val_best_acc_score: 0.5418; val_best_f1_score: 0.6858; train_kl_reg_loss: 373.1810; train_edge_recon_loss: 3462297.5000; train_gene_expr_recon_loss: 1768652.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5231323.0000; train_optim_loss: 5231323.0000; val_kl_reg_loss: 553.5470; val_edge_recon_loss: 4063401.7500; val_gene_expr_recon_loss: 1874171.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5938127.0000; val_optim_loss: 5938127.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8846; val_auprc_score: 0.8744; val_best_acc_score: 0.5910; val_best_f1_score: 0.7097; train_kl_reg_loss: 514.0697; train_edge_recon_loss: 3463088.0000; train_gene_expr_recon_loss: 1764556.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5228158.0000; train_optim_loss: 5228158.0000; val_kl_reg_loss: 427.8151; val_edge_recon_loss: 4061603.5000; val_gene_expr_recon_loss: 1875954.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5937986.0000; val_optim_loss: 5937986.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8820; val_auprc_score: 0.8610; val_best_acc_score: 0.6313; val_best_f1_score: 0.7295; train_kl_reg_loss: 400.7205; train_edge_recon_loss: 3456737.0000; train_gene_expr_recon_loss: 1762707.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5219845.0000; train_optim_loss: 5219845.0000; val_kl_reg_loss: 429.3191; val_edge_recon_loss: 4057306.7500; val_gene_expr_recon_loss: 1867091.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5924827.0000; val_optim_loss: 5924827.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8549; val_auprc_score: 0.8451; val_best_acc_score: 0.6463; val_best_f1_score: 0.7334; train_kl_reg_loss: 398.9965; train_edge_recon_loss: 3455550.7500; train_gene_expr_recon_loss: 1760277.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5216227.0000; train_optim_loss: 5216227.0000; val_kl_reg_loss: 553.8580; val_edge_recon_loss: 4051431.7500; val_gene_expr_recon_loss: 1869736.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5921721.5000; val_optim_loss: 5921721.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8412; val_auprc_score: 0.8139; val_best_acc_score: 0.6493; val_best_f1_score: 0.7351; train_kl_reg_loss: 481.4164; train_edge_recon_loss: 3448529.0000; train_gene_expr_recon_loss: 1758268.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5207279.0000; train_optim_loss: 5207279.0000; val_kl_reg_loss: 544.6583; val_edge_recon_loss: 4050369.5000; val_gene_expr_recon_loss: 1863261.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5914175.5000; val_optim_loss: 5914175.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8435; val_auprc_score: 0.8351; val_best_acc_score: 0.6522; val_best_f1_score: 0.7355; train_kl_reg_loss: 499.1709; train_edge_recon_loss: 3449013.5000; train_gene_expr_recon_loss: 1757190.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5206703.0000; train_optim_loss: 5206703.0000; val_kl_reg_loss: 567.2526; val_edge_recon_loss: 4050916.2500; val_gene_expr_recon_loss: 1868081.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5919565.0000; val_optim_loss: 5919565.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8614; val_auprc_score: 0.8411; val_best_acc_score: 0.6940; val_best_f1_score: 0.7591; train_kl_reg_loss: 516.3527; train_edge_recon_loss: 3448068.0000; train_gene_expr_recon_loss: 1757179.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5205764.0000; train_optim_loss: 5205764.0000; val_kl_reg_loss: 589.0746; val_edge_recon_loss: 4045788.7500; val_gene_expr_recon_loss: 1871494.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5917872.5000; val_optim_loss: 5917872.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8454; val_auprc_score: 0.8417; val_best_acc_score: 0.6716; val_best_f1_score: 0.7460; train_kl_reg_loss: 537.3475; train_edge_recon_loss: 3447553.5000; train_gene_expr_recon_loss: 1756657.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5204748.0000; train_optim_loss: 5204748.0000; val_kl_reg_loss: 596.9447; val_edge_recon_loss: 4047829.7500; val_gene_expr_recon_loss: 1865739.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5914166.0000; val_optim_loss: 5914166.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8385; val_auprc_score: 0.8043; val_best_acc_score: 0.6970; val_best_f1_score: 0.7598; train_kl_reg_loss: 558.3154; train_edge_recon_loss: 3448794.7500; train_gene_expr_recon_loss: 1756248.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5205602.0000; train_optim_loss: 5205602.0000; val_kl_reg_loss: 597.8634; val_edge_recon_loss: 4043541.7500; val_gene_expr_recon_loss: 1864377.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5908517.0000; val_optim_loss: 5908517.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8311; val_auprc_score: 0.8125; val_best_acc_score: 0.6821; val_best_f1_score: 0.7497; train_kl_reg_loss: 567.1256; train_edge_recon_loss: 3443809.7500; train_gene_expr_recon_loss: 1755792.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5200169.0000; train_optim_loss: 5200169.0000; val_kl_reg_loss: 632.6193; val_edge_recon_loss: 4039861.5000; val_gene_expr_recon_loss: 1868373.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5908867.0000; val_optim_loss: 5908867.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.8416; val_auprc_score: 0.8371; val_best_acc_score: 0.7149; val_best_f1_score: 0.7690; train_kl_reg_loss: 579.4118; train_edge_recon_loss: 3441974.5000; train_gene_expr_recon_loss: 1756030.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5198584.0000; train_optim_loss: 5198584.0000; val_kl_reg_loss: 645.4575; val_edge_recon_loss: 4037964.0000; val_gene_expr_recon_loss: 1874269.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5912879.0000; val_optim_loss: 5912879.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.8137; val_auprc_score: 0.7995; val_best_acc_score: 0.6940; val_best_f1_score: 0.7551; train_kl_reg_loss: 598.6696; train_edge_recon_loss: 3444816.2500; train_gene_expr_recon_loss: 1755725.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5201141.0000; train_optim_loss: 5201141.0000; val_kl_reg_loss: 640.4391; val_edge_recon_loss: 4037114.5000; val_gene_expr_recon_loss: 1861141.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5898896.0000; val_optim_loss: 5898896.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.8184; val_auprc_score: 0.8130; val_best_acc_score: 0.6910; val_best_f1_score: 0.7527; train_kl_reg_loss: 603.9852; train_edge_recon_loss: 3441880.0000; train_gene_expr_recon_loss: 1754456.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5196940.0000; train_optim_loss: 5196940.0000; val_kl_reg_loss: 656.1619; val_edge_recon_loss: 4034706.2500; val_gene_expr_recon_loss: 1867169.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5902532.0000; val_optim_loss: 5902532.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.8479; val_auprc_score: 0.8413; val_best_acc_score: 0.7388; val_best_f1_score: 0.7815; train_kl_reg_loss: 603.4916; train_edge_recon_loss: 3437555.7500; train_gene_expr_recon_loss: 1754644.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5192803.0000; train_optim_loss: 5192803.0000; val_kl_reg_loss: 635.5177; val_edge_recon_loss: 4020466.0000; val_gene_expr_recon_loss: 1864783.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5885884.5000; val_optim_loss: 5885884.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.8372; val_auprc_score: 0.8383; val_best_acc_score: 0.7373; val_best_f1_score: 0.7794; train_kl_reg_loss: 605.1333; train_edge_recon_loss: 3439502.5000; train_gene_expr_recon_loss: 1753144.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5193252.0000; train_optim_loss: 5193252.0000; val_kl_reg_loss: 656.3010; val_edge_recon_loss: 4017747.0000; val_gene_expr_recon_loss: 1862741.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5881145.0000; val_optim_loss: 5881145.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.8113; val_auprc_score: 0.8103; val_best_acc_score: 0.7149; val_best_f1_score: 0.7627; train_kl_reg_loss: 599.8549; train_edge_recon_loss: 3439044.0000; train_gene_expr_recon_loss: 1753977.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5193621.5000; train_optim_loss: 5193621.5000; val_kl_reg_loss: 630.1940; val_edge_recon_loss: 4019431.2500; val_gene_expr_recon_loss: 1864274.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5884336.0000; val_optim_loss: 5884336.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.8239; val_auprc_score: 0.8013; val_best_acc_score: 0.7373; val_best_f1_score: 0.7744; train_kl_reg_loss: 586.0637; train_edge_recon_loss: 3433747.2500; train_gene_expr_recon_loss: 1753831.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5188164.5000; train_optim_loss: 5188164.5000; val_kl_reg_loss: 610.4050; val_edge_recon_loss: 4008131.0000; val_gene_expr_recon_loss: 1868145.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5876887.0000; val_optim_loss: 5876887.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.8114; val_auprc_score: 0.7969; val_best_acc_score: 0.7299; val_best_f1_score: 0.7671; train_kl_reg_loss: 576.2185; train_edge_recon_loss: 3431795.7500; train_gene_expr_recon_loss: 1754069.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5186441.0000; train_optim_loss: 5186441.0000; val_kl_reg_loss: 614.9445; val_edge_recon_loss: 4004797.2500; val_gene_expr_recon_loss: 1866757.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5872170.0000; val_optim_loss: 5872170.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.8079; val_auprc_score: 0.7858; val_best_acc_score: 0.7328; val_best_f1_score: 0.7648; train_kl_reg_loss: 567.7408; train_edge_recon_loss: 3429659.5000; train_gene_expr_recon_loss: 1753940.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5184168.0000; train_optim_loss: 5184168.0000; val_kl_reg_loss: 613.9058; val_edge_recon_loss: 3992099.2500; val_gene_expr_recon_loss: 1862799.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5855513.0000; val_optim_loss: 5855513.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.8133; val_auprc_score: 0.7896; val_best_acc_score: 0.7269; val_best_f1_score: 0.7563; train_kl_reg_loss: 571.7290; train_edge_recon_loss: 3435697.5000; train_gene_expr_recon_loss: 1753023.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5189292.5000; train_optim_loss: 5189292.5000; val_kl_reg_loss: 608.8599; val_edge_recon_loss: 3974777.2500; val_gene_expr_recon_loss: 1866983.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5842369.0000; val_optim_loss: 5842369.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.8229; val_auprc_score: 0.8233; val_best_acc_score: 0.7403; val_best_f1_score: 0.7636; train_kl_reg_loss: 561.3497; train_edge_recon_loss: 3430678.5000; train_gene_expr_recon_loss: 1753183.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5184423.5000; train_optim_loss: 5184423.5000; val_kl_reg_loss: 602.9286; val_edge_recon_loss: 3972385.7500; val_gene_expr_recon_loss: 1857172.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5830161.5000; val_optim_loss: 5830161.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8116; val_auprc_score: 0.7819; val_best_acc_score: 0.7269; val_best_f1_score: 0.7552; train_kl_reg_loss: 560.9890; train_edge_recon_loss: 3425738.5000; train_gene_expr_recon_loss: 1753015.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5179315.0000; train_optim_loss: 5179315.0000; val_kl_reg_loss: 591.4169; val_edge_recon_loss: 3951993.5000; val_gene_expr_recon_loss: 1863689.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5816275.0000; val_optim_loss: 5816275.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7858; val_auprc_score: 0.7569; val_best_acc_score: 0.7119; val_best_f1_score: 0.7387; train_kl_reg_loss: 562.6143; train_edge_recon_loss: 3425479.2500; train_gene_expr_recon_loss: 1753318.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5179360.0000; train_optim_loss: 5179360.0000; val_kl_reg_loss: 618.9346; val_edge_recon_loss: 3934434.7500; val_gene_expr_recon_loss: 1858400.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5793454.0000; val_optim_loss: 5793454.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7935; val_auprc_score: 0.7818; val_best_acc_score: 0.7134; val_best_f1_score: 0.7433; train_kl_reg_loss: 578.4231; train_edge_recon_loss: 3425542.0000; train_gene_expr_recon_loss: 1752549.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5178670.0000; train_optim_loss: 5178670.0000; val_kl_reg_loss: 621.7007; val_edge_recon_loss: 3930385.7500; val_gene_expr_recon_loss: 1861492.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5792500.0000; val_optim_loss: 5792500.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8178; val_auprc_score: 0.8179; val_best_acc_score: 0.7373; val_best_f1_score: 0.7486; train_kl_reg_loss: 591.1610; train_edge_recon_loss: 3424145.5000; train_gene_expr_recon_loss: 1752734.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5177471.0000; train_optim_loss: 5177471.0000; val_kl_reg_loss: 631.7659; val_edge_recon_loss: 3896283.5000; val_gene_expr_recon_loss: 1863190.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5760106.0000; val_optim_loss: 5760106.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.7986; val_auprc_score: 0.7718; val_best_acc_score: 0.7179; val_best_f1_score: 0.7660; train_kl_reg_loss: 597.7634; train_edge_recon_loss: 3416271.2500; train_gene_expr_recon_loss: 1751903.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5168772.5000; train_optim_loss: 5168772.5000; val_kl_reg_loss: 640.5084; val_edge_recon_loss: 3867077.2500; val_gene_expr_recon_loss: 1856866.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5724584.0000; val_optim_loss: 5724584.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.7914; val_auprc_score: 0.7673; val_best_acc_score: 0.7179; val_best_f1_score: 0.7497; train_kl_reg_loss: 614.1822; train_edge_recon_loss: 3412887.2500; train_gene_expr_recon_loss: 1751401.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5164903.0000; train_optim_loss: 5164903.0000; val_kl_reg_loss: 672.3296; val_edge_recon_loss: 3860906.2500; val_gene_expr_recon_loss: 1862056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5723634.5000; val_optim_loss: 5723634.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8033; val_auprc_score: 0.7911; val_best_acc_score: 0.7299; val_best_f1_score: 0.7677; train_kl_reg_loss: 635.9734; train_edge_recon_loss: 3416211.2500; train_gene_expr_recon_loss: 1749870.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5166718.0000; train_optim_loss: 5166718.0000; val_kl_reg_loss: 716.6485; val_edge_recon_loss: 3825750.0000; val_gene_expr_recon_loss: 1878697.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5705164.0000; val_optim_loss: 5705164.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.7654; val_auprc_score: 0.7504; val_best_acc_score: 0.6896; val_best_f1_score: 0.7438; train_kl_reg_loss: 649.8530; train_edge_recon_loss: 3413590.5000; train_gene_expr_recon_loss: 1750814.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5165055.0000; train_optim_loss: 5165055.0000; val_kl_reg_loss: 701.4878; val_edge_recon_loss: 3819055.0000; val_gene_expr_recon_loss: 1861536.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5681293.0000; val_optim_loss: 5681293.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.7801; val_auprc_score: 0.7443; val_best_acc_score: 0.7060; val_best_f1_score: 0.7516; train_kl_reg_loss: 665.2639; train_edge_recon_loss: 3416984.0000; train_gene_expr_recon_loss: 1750573.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5168222.0000; train_optim_loss: 5168222.0000; val_kl_reg_loss: 713.6958; val_edge_recon_loss: 3812169.5000; val_gene_expr_recon_loss: 1854963.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5667847.0000; val_optim_loss: 5667847.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.7781; val_auprc_score: 0.7773; val_best_acc_score: 0.7060; val_best_f1_score: 0.7484; train_kl_reg_loss: 666.1304; train_edge_recon_loss: 3407544.2500; train_gene_expr_recon_loss: 1750010.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5158221.0000; train_optim_loss: 5158221.0000; val_kl_reg_loss: 726.0162; val_edge_recon_loss: 3778325.5000; val_gene_expr_recon_loss: 1864844.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5643896.0000; val_optim_loss: 5643896.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8101; val_auprc_score: 0.8038; val_best_acc_score: 0.7299; val_best_f1_score: 0.7696; train_kl_reg_loss: 678.2457; train_edge_recon_loss: 3408574.7500; train_gene_expr_recon_loss: 1749957.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5159211.0000; train_optim_loss: 5159211.0000; val_kl_reg_loss: 716.1898; val_edge_recon_loss: 3744510.0000; val_gene_expr_recon_loss: 1868599.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5613826.0000; val_optim_loss: 5613826.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.7996; val_auprc_score: 0.7704; val_best_acc_score: 0.7328; val_best_f1_score: 0.7698; train_kl_reg_loss: 676.9935; train_edge_recon_loss: 3406448.7500; train_gene_expr_recon_loss: 1749815.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5156941.0000; train_optim_loss: 5156941.0000; val_kl_reg_loss: 725.3492; val_edge_recon_loss: 3671851.7500; val_gene_expr_recon_loss: 1855378.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5527955.5000; val_optim_loss: 5527955.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8245; val_auprc_score: 0.8150; val_best_acc_score: 0.7388; val_best_f1_score: 0.7712; train_kl_reg_loss: 678.2531; train_edge_recon_loss: 3406798.2500; train_gene_expr_recon_loss: 1751085.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5158561.5000; train_optim_loss: 5158561.5000; val_kl_reg_loss: 699.7348; val_edge_recon_loss: 3632361.5000; val_gene_expr_recon_loss: 1856924.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5489985.5000; val_optim_loss: 5489985.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8353; val_auprc_score: 0.8208; val_best_acc_score: 0.7537; val_best_f1_score: 0.7797; train_kl_reg_loss: 668.7120; train_edge_recon_loss: 3395236.2500; train_gene_expr_recon_loss: 1749818.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5145724.0000; train_optim_loss: 5145724.0000; val_kl_reg_loss: 708.2695; val_edge_recon_loss: 3590931.0000; val_gene_expr_recon_loss: 1863383.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5455022.0000; val_optim_loss: 5455022.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8062; val_auprc_score: 0.7958; val_best_acc_score: 0.7239; val_best_f1_score: 0.7648; train_kl_reg_loss: 665.7009; train_edge_recon_loss: 3389441.0000; train_gene_expr_recon_loss: 1749220.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5139327.0000; train_optim_loss: 5139327.0000; val_kl_reg_loss: 726.3293; val_edge_recon_loss: 3542222.5000; val_gene_expr_recon_loss: 1856252.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5399201.0000; val_optim_loss: 5399201.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.7914; val_auprc_score: 0.7703; val_best_acc_score: 0.7224; val_best_f1_score: 0.7654; train_kl_reg_loss: 678.1003; train_edge_recon_loss: 3385701.7500; train_gene_expr_recon_loss: 1749235.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5135615.0000; train_optim_loss: 5135615.0000; val_kl_reg_loss: 766.6962; val_edge_recon_loss: 3570462.5000; val_gene_expr_recon_loss: 1860718.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5431947.0000; val_optim_loss: 5431947.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.7850; val_auprc_score: 0.7652; val_best_acc_score: 0.7104; val_best_f1_score: 0.7534; train_kl_reg_loss: 709.7449; train_edge_recon_loss: 3392506.2500; train_gene_expr_recon_loss: 1748847.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5142064.0000; train_optim_loss: 5142064.0000; val_kl_reg_loss: 794.5665; val_edge_recon_loss: 3569695.7500; val_gene_expr_recon_loss: 1857717.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5428207.0000; val_optim_loss: 5428207.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.7894; val_auprc_score: 0.7660; val_best_acc_score: 0.7299; val_best_f1_score: 0.7652; train_kl_reg_loss: 738.8235; train_edge_recon_loss: 3382706.7500; train_gene_expr_recon_loss: 1748221.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5131667.5000; train_optim_loss: 5131667.5000; val_kl_reg_loss: 832.3331; val_edge_recon_loss: 3492730.5000; val_gene_expr_recon_loss: 1856533.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5350096.0000; val_optim_loss: 5350096.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8080; val_auprc_score: 0.7926; val_best_acc_score: 0.7373; val_best_f1_score: 0.7690; train_kl_reg_loss: 779.3064; train_edge_recon_loss: 3387219.5000; train_gene_expr_recon_loss: 1746942.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5134941.0000; train_optim_loss: 5134941.0000; val_kl_reg_loss: 836.1970; val_edge_recon_loss: 3476289.2500; val_gene_expr_recon_loss: 1855958.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5333084.0000; val_optim_loss: 5333084.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8113; val_auprc_score: 0.7718; val_best_acc_score: 0.7493; val_best_f1_score: 0.7818; train_kl_reg_loss: 800.1880; train_edge_recon_loss: 3386130.0000; train_gene_expr_recon_loss: 1748199.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5135129.5000; train_optim_loss: 5135129.5000; val_kl_reg_loss: 897.0632; val_edge_recon_loss: 3407459.2500; val_gene_expr_recon_loss: 1852406.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5260762.5000; val_optim_loss: 5260762.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8176; val_auprc_score: 0.7975; val_best_acc_score: 0.7522; val_best_f1_score: 0.7831; train_kl_reg_loss: 823.6187; train_edge_recon_loss: 3376302.7500; train_gene_expr_recon_loss: 1747247.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5124374.0000; train_optim_loss: 5124374.0000; val_kl_reg_loss: 917.3218; val_edge_recon_loss: 3354143.7500; val_gene_expr_recon_loss: 1862014.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5217075.0000; val_optim_loss: 5217075.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8052; val_auprc_score: 0.7947; val_best_acc_score: 0.7403; val_best_f1_score: 0.7758; train_kl_reg_loss: 853.1938; train_edge_recon_loss: 3384250.7500; train_gene_expr_recon_loss: 1747769.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5132874.0000; train_optim_loss: 5132874.0000; val_kl_reg_loss: 942.6499; val_edge_recon_loss: 3377796.5000; val_gene_expr_recon_loss: 1847281.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5226020.5000; val_optim_loss: 5226020.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8021; val_auprc_score: 0.7829; val_best_acc_score: 0.7358; val_best_f1_score: 0.7740; train_kl_reg_loss: 872.4119; train_edge_recon_loss: 3378434.5000; train_gene_expr_recon_loss: 1746037.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5125344.0000; train_optim_loss: 5125344.0000; val_kl_reg_loss: 951.4548; val_edge_recon_loss: 3323491.5000; val_gene_expr_recon_loss: 1861125.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5185569.0000; val_optim_loss: 5185569.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8202; val_auprc_score: 0.7837; val_best_acc_score: 0.7537; val_best_f1_score: 0.7846; train_kl_reg_loss: 895.4460; train_edge_recon_loss: 3375198.7500; train_gene_expr_recon_loss: 1746681.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5122775.5000; train_optim_loss: 5122775.5000; val_kl_reg_loss: 967.1487; val_edge_recon_loss: 3270163.7500; val_gene_expr_recon_loss: 1855106.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5126238.0000; val_optim_loss: 5126238.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.7890; val_auprc_score: 0.7497; val_best_acc_score: 0.7373; val_best_f1_score: 0.7723; train_kl_reg_loss: 914.7025; train_edge_recon_loss: 3374844.0000; train_gene_expr_recon_loss: 1746436.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5122195.5000; train_optim_loss: 5122195.5000; val_kl_reg_loss: 1022.1517; val_edge_recon_loss: 3303052.0000; val_gene_expr_recon_loss: 1854337.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5158411.0000; val_optim_loss: 5158411.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8017; val_auprc_score: 0.7592; val_best_acc_score: 0.7388; val_best_f1_score: 0.7776; train_kl_reg_loss: 920.6700; train_edge_recon_loss: 3370157.7500; train_gene_expr_recon_loss: 1746502.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5117581.0000; train_optim_loss: 5117581.0000; val_kl_reg_loss: 1036.9666; val_edge_recon_loss: 3251428.2500; val_gene_expr_recon_loss: 1865235.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5117701.0000; val_optim_loss: 5117701.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8144; val_auprc_score: 0.7998; val_best_acc_score: 0.7567; val_best_f1_score: 0.7794; train_kl_reg_loss: 933.2224; train_edge_recon_loss: 3365561.2500; train_gene_expr_recon_loss: 1746300.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5112795.0000; train_optim_loss: 5112795.0000; val_kl_reg_loss: 1042.8312; val_edge_recon_loss: 3207434.0000; val_gene_expr_recon_loss: 1855840.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5064317.0000; val_optim_loss: 5064317.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.7808; val_auprc_score: 0.7337; val_best_acc_score: 0.7358; val_best_f1_score: 0.7626; train_kl_reg_loss: 953.6079; train_edge_recon_loss: 3352686.7500; train_gene_expr_recon_loss: 1745935.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5099576.0000; train_optim_loss: 5099576.0000; val_kl_reg_loss: 1078.5381; val_edge_recon_loss: 3265676.5000; val_gene_expr_recon_loss: 1859604.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5126359.5000; val_optim_loss: 5126359.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8067; val_auprc_score: 0.7932; val_best_acc_score: 0.7448; val_best_f1_score: 0.7713; train_kl_reg_loss: 1003.7845; train_edge_recon_loss: 3360192.0000; train_gene_expr_recon_loss: 1745414.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5106610.5000; train_optim_loss: 5106610.5000; val_kl_reg_loss: 1044.5762; val_edge_recon_loss: 3195414.5000; val_gene_expr_recon_loss: 1847987.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5044446.5000; val_optim_loss: 5044446.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8117; val_auprc_score: 0.7794; val_best_acc_score: 0.7552; val_best_f1_score: 0.7779; train_kl_reg_loss: 1039.6847; train_edge_recon_loss: 3362029.7500; train_gene_expr_recon_loss: 1745194.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5108263.5000; train_optim_loss: 5108263.5000; val_kl_reg_loss: 1203.0840; val_edge_recon_loss: 3098143.0000; val_gene_expr_recon_loss: 1855783.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4955129.0000; val_optim_loss: 4955129.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8089; val_auprc_score: 0.7795; val_best_acc_score: 0.7642; val_best_f1_score: 0.7705; train_kl_reg_loss: 1086.5541; train_edge_recon_loss: 3346080.2500; train_gene_expr_recon_loss: 1745411.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5092578.5000; train_optim_loss: 5092578.5000; val_kl_reg_loss: 1221.1377; val_edge_recon_loss: 3144271.0000; val_gene_expr_recon_loss: 1849088.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4994581.0000; val_optim_loss: 4994581.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8119; val_auprc_score: 0.7795; val_best_acc_score: 0.7552; val_best_f1_score: 0.7776; train_kl_reg_loss: 1126.9595; train_edge_recon_loss: 3342867.7500; train_gene_expr_recon_loss: 1745049.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5089044.5000; train_optim_loss: 5089044.5000; val_kl_reg_loss: 1224.8711; val_edge_recon_loss: 3094673.5000; val_gene_expr_recon_loss: 1848333.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4944231.5000; val_optim_loss: 4944231.5000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8067; val_auprc_score: 0.7890; val_best_acc_score: 0.7433; val_best_f1_score: 0.7772; train_kl_reg_loss: 1175.5237; train_edge_recon_loss: 3343100.5000; train_gene_expr_recon_loss: 1743439.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5087715.0000; train_optim_loss: 5087715.0000; val_kl_reg_loss: 1314.2136; val_edge_recon_loss: 3101506.2500; val_gene_expr_recon_loss: 1855741.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4958562.0000; val_optim_loss: 4958562.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8003; val_auprc_score: 0.7656; val_best_acc_score: 0.7597; val_best_f1_score: 0.7819; train_kl_reg_loss: 1214.5225; train_edge_recon_loss: 3333832.0000; train_gene_expr_recon_loss: 1743443.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5078490.0000; train_optim_loss: 5078490.0000; val_kl_reg_loss: 1369.9434; val_edge_recon_loss: 3047284.2500; val_gene_expr_recon_loss: 1847131.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4895786.0000; val_optim_loss: 4895786.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.7994; val_auprc_score: 0.7685; val_best_acc_score: 0.7493; val_best_f1_score: 0.7807; train_kl_reg_loss: 1264.4343; train_edge_recon_loss: 3345574.7500; train_gene_expr_recon_loss: 1743054.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5089894.0000; train_optim_loss: 5089894.0000; val_kl_reg_loss: 1405.3174; val_edge_recon_loss: 3060338.5000; val_gene_expr_recon_loss: 1851252.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4912996.0000; val_optim_loss: 4912996.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.8119; val_auprc_score: 0.7994; val_best_acc_score: 0.7522; val_best_f1_score: 0.7855; train_kl_reg_loss: 1289.4442; train_edge_recon_loss: 3334644.5000; train_gene_expr_recon_loss: 1742914.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5078848.0000; train_optim_loss: 5078848.0000; val_kl_reg_loss: 1467.9080; val_edge_recon_loss: 3031109.2500; val_gene_expr_recon_loss: 1851658.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4884235.5000; val_optim_loss: 4884235.5000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.8024; val_auprc_score: 0.7706; val_best_acc_score: 0.7478; val_best_f1_score: 0.7764; train_kl_reg_loss: 1316.7166; train_edge_recon_loss: 3318819.0000; train_gene_expr_recon_loss: 1742907.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5063043.0000; train_optim_loss: 5063043.0000; val_kl_reg_loss: 1426.6279; val_edge_recon_loss: 3027394.5000; val_gene_expr_recon_loss: 1845467.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4874288.5000; val_optim_loss: 4874288.5000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.8030; val_auprc_score: 0.7957; val_best_acc_score: 0.7388; val_best_f1_score: 0.7686; train_kl_reg_loss: 1355.3359; train_edge_recon_loss: 3317542.7500; train_gene_expr_recon_loss: 1742195.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5061093.0000; train_optim_loss: 5061093.0000; val_kl_reg_loss: 1528.1851; val_edge_recon_loss: 3072022.7500; val_gene_expr_recon_loss: 1851574.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4925125.5000; val_optim_loss: 4925125.5000
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.7884; val_auprc_score: 0.7890; val_best_acc_score: 0.7179; val_best_f1_score: 0.7484; train_kl_reg_loss: 1418.1946; train_edge_recon_loss: 3335681.5000; train_gene_expr_recon_loss: 1742640.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5079740.0000; train_optim_loss: 5079740.0000; val_kl_reg_loss: 1591.1628; val_edge_recon_loss: 3155660.0000; val_gene_expr_recon_loss: 1853789.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5011040.0000; val_optim_loss: 5011040.0000
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.8038; val_auprc_score: 0.7911; val_best_acc_score: 0.7463; val_best_f1_score: 0.7676; train_kl_reg_loss: 1496.4053; train_edge_recon_loss: 3321228.5000; train_gene_expr_recon_loss: 1742138.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5064864.0000; train_optim_loss: 5064864.0000; val_kl_reg_loss: 1709.6503; val_edge_recon_loss: 3017209.7500; val_gene_expr_recon_loss: 1857092.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4876012.0000; val_optim_loss: 4876012.0000
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.7979; val_auprc_score: 0.7929; val_best_acc_score: 0.7358; val_best_f1_score: 0.7572; train_kl_reg_loss: 1559.4849; train_edge_recon_loss: 3303136.2500; train_gene_expr_recon_loss: 1742534.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5047230.0000; train_optim_loss: 5047230.0000; val_kl_reg_loss: 1747.1562; val_edge_recon_loss: 3091355.5000; val_gene_expr_recon_loss: 1836352.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4929455.0000; val_optim_loss: 4929455.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.7935; val_auprc_score: 0.7782; val_best_acc_score: 0.7299; val_best_f1_score: 0.7570; train_kl_reg_loss: 1659.8336; train_edge_recon_loss: 3306732.7500; train_gene_expr_recon_loss: 1741754.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5050147.5000; train_optim_loss: 5050147.5000; val_kl_reg_loss: 1763.2988; val_edge_recon_loss: 3063457.2500; val_gene_expr_recon_loss: 1846915.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4912136.0000; val_optim_loss: 4912136.0000
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.7713; val_auprc_score: 0.7488; val_best_acc_score: 0.7075; val_best_f1_score: 0.7391; train_kl_reg_loss: 1664.5449; train_edge_recon_loss: 3310169.2500; train_gene_expr_recon_loss: 1742061.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5053895.5000; train_optim_loss: 5053895.5000; val_kl_reg_loss: 1823.2373; val_edge_recon_loss: 3174974.5000; val_gene_expr_recon_loss: 1851602.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5028400.0000; val_optim_loss: 5028400.0000
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.8022; val_auprc_score: 0.7912; val_best_acc_score: 0.7403; val_best_f1_score: 0.7591; train_kl_reg_loss: 1630.6272; train_edge_recon_loss: 3288827.2500; train_gene_expr_recon_loss: 1739989.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5030447.0000; train_optim_loss: 5030447.0000; val_kl_reg_loss: 1724.6257; val_edge_recon_loss: 3090333.2500; val_gene_expr_recon_loss: 1847595.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4939653.5000; val_optim_loss: 4939653.5000
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.7945; val_auprc_score: 0.7771; val_best_acc_score: 0.7209; val_best_f1_score: 0.7562; train_kl_reg_loss: 1650.2744; train_edge_recon_loss: 3287285.5000; train_gene_expr_recon_loss: 1740432.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5029368.0000; train_optim_loss: 5029368.0000; val_kl_reg_loss: 1795.5286; val_edge_recon_loss: 3032732.2500; val_gene_expr_recon_loss: 1848090.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4882618.0000; val_optim_loss: 4882618.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 38 sec.
Using best model state, which was in epoch 62.

--- MODEL EVALUATION ---
val AUROC score: 0.8048
val AUPRC score: 0.7871
val best accuracy score: 0.7478
val best F1 score: 0.7734
val target rna MSE score: 0.0116
val source rna MSE score: 0.0040
Duration of model training in run 7: 0 hours, 0 minutes and 40 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 2290
Number of validation edges: 254
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9421; val_auprc_score: 0.8953; val_best_acc_score: 0.8917; val_best_f1_score: 0.8898; train_kl_reg_loss: 0.4875; train_edge_recon_loss: 3464291.7500; train_gene_expr_recon_loss: 1813459.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5277752.0000; train_optim_loss: 5277752.0000; val_kl_reg_loss: 6.1507; val_edge_recon_loss: 4038376.5000; val_gene_expr_recon_loss: 1755932.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5794315.5000; val_optim_loss: 5794315.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9423; val_auprc_score: 0.9010; val_best_acc_score: 0.6969; val_best_f1_score: 0.7652; train_kl_reg_loss: 6.1872; train_edge_recon_loss: 3466595.7500; train_gene_expr_recon_loss: 1801518.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5268120.0000; train_optim_loss: 5268120.0000; val_kl_reg_loss: 36.2253; val_edge_recon_loss: 4057012.0000; val_gene_expr_recon_loss: 1750908.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5807957.0000; val_optim_loss: 5807957.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9062; val_auprc_score: 0.8626; val_best_acc_score: 0.5197; val_best_f1_score: 0.6755; train_kl_reg_loss: 37.2215; train_edge_recon_loss: 3467459.7500; train_gene_expr_recon_loss: 1790423.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5257920.5000; train_optim_loss: 5257920.5000; val_kl_reg_loss: 132.0107; val_edge_recon_loss: 4062889.5000; val_gene_expr_recon_loss: 1759959.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5822980.5000; val_optim_loss: 5822980.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8924; val_auprc_score: 0.8702; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 129.9641; train_edge_recon_loss: 3462988.2500; train_gene_expr_recon_loss: 1783993.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5247112.0000; train_optim_loss: 5247112.0000; val_kl_reg_loss: 320.5439; val_edge_recon_loss: 4064561.7500; val_gene_expr_recon_loss: 1762207.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5827090.0000; val_optim_loss: 5827090.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8940; val_auprc_score: 0.8726; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 318.9266; train_edge_recon_loss: 3460228.2500; train_gene_expr_recon_loss: 1778198.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5238746.0000; train_optim_loss: 5238746.0000; val_kl_reg_loss: 486.9304; val_edge_recon_loss: 4064737.2500; val_gene_expr_recon_loss: 1752311.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5817536.0000; val_optim_loss: 5817536.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9013; val_auprc_score: 0.8902; val_best_acc_score: 0.5295; val_best_f1_score: 0.6801; train_kl_reg_loss: 498.8734; train_edge_recon_loss: 3465141.2500; train_gene_expr_recon_loss: 1772845.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5238486.0000; train_optim_loss: 5238486.0000; val_kl_reg_loss: 461.9367; val_edge_recon_loss: 4063743.7500; val_gene_expr_recon_loss: 1757600.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5821806.0000; val_optim_loss: 5821806.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8868; val_auprc_score: 0.8682; val_best_acc_score: 0.5669; val_best_f1_score: 0.6978; train_kl_reg_loss: 454.0563; train_edge_recon_loss: 3457706.7500; train_gene_expr_recon_loss: 1771444.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5229605.5000; train_optim_loss: 5229605.5000; val_kl_reg_loss: 447.2357; val_edge_recon_loss: 4062313.2500; val_gene_expr_recon_loss: 1746527.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5809288.5000; val_optim_loss: 5809288.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8741; val_auprc_score: 0.8450; val_best_acc_score: 0.6319; val_best_f1_score: 0.7309; train_kl_reg_loss: 441.0384; train_edge_recon_loss: 3454861.0000; train_gene_expr_recon_loss: 1769616.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5224919.0000; train_optim_loss: 5224919.0000; val_kl_reg_loss: 519.7369; val_edge_recon_loss: 4058286.2500; val_gene_expr_recon_loss: 1751963.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5810769.5000; val_optim_loss: 5810769.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8656; val_auprc_score: 0.8189; val_best_acc_score: 0.6575; val_best_f1_score: 0.7441; train_kl_reg_loss: 513.7422; train_edge_recon_loss: 3451538.7500; train_gene_expr_recon_loss: 1767309.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5219362.0000; train_optim_loss: 5219362.0000; val_kl_reg_loss: 553.3461; val_edge_recon_loss: 4056154.2500; val_gene_expr_recon_loss: 1751647.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5808355.0000; val_optim_loss: 5808355.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9424
val AUPRC score: 0.8881
val best accuracy score: 0.9016
val best F1 score: 0.8988
val target rna MSE score: 0.0118
val source rna MSE score: 0.0034
Duration of model training in run 6: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 2290
Number of validation edges: 254
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9648; val_auprc_score: 0.9421; val_best_acc_score: 0.9075; val_best_f1_score: 0.9051; train_kl_reg_loss: 0.4824; train_edge_recon_loss: 3465578.7500; train_gene_expr_recon_loss: 1792652.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5258232.0000; train_optim_loss: 5258232.0000; val_kl_reg_loss: 6.5500; val_edge_recon_loss: 4032267.7500; val_gene_expr_recon_loss: 1909434.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5941709.0000; val_optim_loss: 5941709.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9325; val_auprc_score: 0.8964; val_best_acc_score: 0.7264; val_best_f1_score: 0.7838; train_kl_reg_loss: 6.0674; train_edge_recon_loss: 3467671.7500; train_gene_expr_recon_loss: 1781758.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5249436.0000; train_optim_loss: 5249436.0000; val_kl_reg_loss: 41.5180; val_edge_recon_loss: 4055042.7500; val_gene_expr_recon_loss: 1910166.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5965250.0000; val_optim_loss: 5965250.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9126; val_auprc_score: 0.8782; val_best_acc_score: 0.5374; val_best_f1_score: 0.6837; train_kl_reg_loss: 37.2597; train_edge_recon_loss: 3466684.0000; train_gene_expr_recon_loss: 1771590.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5238312.0000; train_optim_loss: 5238312.0000; val_kl_reg_loss: 153.5604; val_edge_recon_loss: 4062527.0000; val_gene_expr_recon_loss: 1910843.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5973524.0000; val_optim_loss: 5973524.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9028; val_auprc_score: 0.8733; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 136.7697; train_edge_recon_loss: 3461896.5000; train_gene_expr_recon_loss: 1764725.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5226759.0000; train_optim_loss: 5226759.0000; val_kl_reg_loss: 410.7193; val_edge_recon_loss: 4064341.7500; val_gene_expr_recon_loss: 1919397.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5984150.0000; val_optim_loss: 5984150.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8974; val_auprc_score: 0.8664; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 357.2194; train_edge_recon_loss: 3462833.2500; train_gene_expr_recon_loss: 1758595.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5221786.0000; train_optim_loss: 5221786.0000; val_kl_reg_loss: 675.1412; val_edge_recon_loss: 4064532.7500; val_gene_expr_recon_loss: 1900660.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5965869.0000; val_optim_loss: 5965869.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9098; val_auprc_score: 0.8956; val_best_acc_score: 0.5256; val_best_f1_score: 0.6782; train_kl_reg_loss: 588.0311; train_edge_recon_loss: 3461111.2500; train_gene_expr_recon_loss: 1753927.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5215627.0000; train_optim_loss: 5215627.0000; val_kl_reg_loss: 643.3917; val_edge_recon_loss: 4063472.7500; val_gene_expr_recon_loss: 1904271.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5968387.5000; val_optim_loss: 5968387.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9108; val_auprc_score: 0.8990; val_best_acc_score: 0.5984; val_best_f1_score: 0.7135; train_kl_reg_loss: 554.6302; train_edge_recon_loss: 3455386.7500; train_gene_expr_recon_loss: 1752024.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5207966.0000; train_optim_loss: 5207966.0000; val_kl_reg_loss: 561.0972; val_edge_recon_loss: 4061388.0000; val_gene_expr_recon_loss: 1908160.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5970109.0000; val_optim_loss: 5970109.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8844; val_auprc_score: 0.8578; val_best_acc_score: 0.6161; val_best_f1_score: 0.7218; train_kl_reg_loss: 470.0174; train_edge_recon_loss: 3456167.2500; train_gene_expr_recon_loss: 1750585.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5207222.0000; train_optim_loss: 5207222.0000; val_kl_reg_loss: 618.3969; val_edge_recon_loss: 4058900.0000; val_gene_expr_recon_loss: 1907882.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5967400.5000; val_optim_loss: 5967400.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8866; val_auprc_score: 0.8429; val_best_acc_score: 0.6378; val_best_f1_score: 0.7333; train_kl_reg_loss: 501.1273; train_edge_recon_loss: 3448111.0000; train_gene_expr_recon_loss: 1748757.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5197370.0000; train_optim_loss: 5197370.0000; val_kl_reg_loss: 620.0275; val_edge_recon_loss: 4058510.7500; val_gene_expr_recon_loss: 1899340.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5958471.5000; val_optim_loss: 5958471.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9537
val AUPRC score: 0.9245
val best accuracy score: 0.9055
val best F1 score: 0.9032
val target rna MSE score: 0.0110
val source rna MSE score: 0.0040
Duration of model training in run 5: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 1549
Number of validation edges: 172
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9464; val_auprc_score: 0.8999; val_best_acc_score: 0.8256; val_best_f1_score: 0.8013; train_kl_reg_loss: 0.4564; train_edge_recon_loss: 3465031.7500; train_gene_expr_recon_loss: 1801387.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5266420.0000; train_optim_loss: 5266420.0000; val_kl_reg_loss: 6.1924; val_edge_recon_loss: 4031713.5000; val_gene_expr_recon_loss: 1833446.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5865166.0000; val_optim_loss: 5865166.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9365; val_auprc_score: 0.9024; val_best_acc_score: 0.7442; val_best_f1_score: 0.7953; train_kl_reg_loss: 5.9246; train_edge_recon_loss: 3464110.5000; train_gene_expr_recon_loss: 1788285.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5252402.0000; train_optim_loss: 5252402.0000; val_kl_reg_loss: 36.2204; val_edge_recon_loss: 4055006.7500; val_gene_expr_recon_loss: 1834002.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5889045.5000; val_optim_loss: 5889045.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9278; val_auprc_score: 0.9052; val_best_acc_score: 0.5785; val_best_f1_score: 0.7035; train_kl_reg_loss: 34.3943; train_edge_recon_loss: 3463809.2500; train_gene_expr_recon_loss: 1778432.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5242276.5000; train_optim_loss: 5242276.5000; val_kl_reg_loss: 137.1869; val_edge_recon_loss: 4061220.0000; val_gene_expr_recon_loss: 1835310.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5896668.0000; val_optim_loss: 5896668.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9120; val_auprc_score: 0.9058; val_best_acc_score: 0.5116; val_best_f1_score: 0.6719; train_kl_reg_loss: 127.2637; train_edge_recon_loss: 3463314.7500; train_gene_expr_recon_loss: 1771895.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5235337.5000; train_optim_loss: 5235337.5000; val_kl_reg_loss: 340.2799; val_edge_recon_loss: 4063545.5000; val_gene_expr_recon_loss: 1836179.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5900065.5000; val_optim_loss: 5900065.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9069; val_auprc_score: 0.8723; val_best_acc_score: 0.5087; val_best_f1_score: 0.6706; train_kl_reg_loss: 317.9095; train_edge_recon_loss: 3463781.0000; train_gene_expr_recon_loss: 1766145.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5230244.0000; train_optim_loss: 5230244.0000; val_kl_reg_loss: 573.9926; val_edge_recon_loss: 4063965.7500; val_gene_expr_recon_loss: 1832706.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5897246.5000; val_optim_loss: 5897246.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9119; val_auprc_score: 0.8866; val_best_acc_score: 0.5436; val_best_f1_score: 0.6866; train_kl_reg_loss: 532.9918; train_edge_recon_loss: 3463282.5000; train_gene_expr_recon_loss: 1761547.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5225363.0000; train_optim_loss: 5225363.0000; val_kl_reg_loss: 616.7894; val_edge_recon_loss: 4062909.7500; val_gene_expr_recon_loss: 1823778.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5887305.0000; val_optim_loss: 5887305.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8737; val_auprc_score: 0.8534; val_best_acc_score: 0.5959; val_best_f1_score: 0.7122; train_kl_reg_loss: 575.8185; train_edge_recon_loss: 3459143.2500; train_gene_expr_recon_loss: 1759223.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5218942.0000; train_optim_loss: 5218942.0000; val_kl_reg_loss: 622.9445; val_edge_recon_loss: 4061068.0000; val_gene_expr_recon_loss: 1832118.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5893809.5000; val_optim_loss: 5893809.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8682; val_auprc_score: 0.8546; val_best_acc_score: 0.6395; val_best_f1_score: 0.7350; train_kl_reg_loss: 552.9315; train_edge_recon_loss: 3459160.7500; train_gene_expr_recon_loss: 1758289.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5218003.0000; train_optim_loss: 5218003.0000; val_kl_reg_loss: 632.2778; val_edge_recon_loss: 4057453.5000; val_gene_expr_recon_loss: 1823774.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5881860.0000; val_optim_loss: 5881860.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8955; val_auprc_score: 0.8689; val_best_acc_score: 0.6599; val_best_f1_score: 0.7462; train_kl_reg_loss: 556.6929; train_edge_recon_loss: 3450908.0000; train_gene_expr_recon_loss: 1756497.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5207962.0000; train_optim_loss: 5207962.0000; val_kl_reg_loss: 666.9372; val_edge_recon_loss: 4055087.0000; val_gene_expr_recon_loss: 1827851.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5883606.0000; val_optim_loss: 5883606.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9645
val AUPRC score: 0.9373
val best accuracy score: 0.8343
val best F1 score: 0.8094
val target rna MSE score: 0.0114
val source rna MSE score: 0.0038
Duration of model training in run 4: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 1549
Number of validation edges: 172
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9706; val_auprc_score: 0.9658; val_best_acc_score: 0.8576; val_best_f1_score: 0.8414; train_kl_reg_loss: 0.4847; train_edge_recon_loss: 3468318.2500; train_gene_expr_recon_loss: 1808078.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5276397.0000; train_optim_loss: 5276397.0000; val_kl_reg_loss: 6.1951; val_edge_recon_loss: 4030246.2500; val_gene_expr_recon_loss: 1804604.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5834856.5000; val_optim_loss: 5834856.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9302; val_auprc_score: 0.9042; val_best_acc_score: 0.7587; val_best_f1_score: 0.8056; train_kl_reg_loss: 6.0040; train_edge_recon_loss: 3464946.5000; train_gene_expr_recon_loss: 1793256.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5258209.0000; train_optim_loss: 5258209.0000; val_kl_reg_loss: 37.8098; val_edge_recon_loss: 4054372.0000; val_gene_expr_recon_loss: 1802301.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5856711.0000; val_optim_loss: 5856711.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9298; val_auprc_score: 0.9130; val_best_acc_score: 0.5640; val_best_f1_score: 0.6964; train_kl_reg_loss: 36.0124; train_edge_recon_loss: 3467319.2500; train_gene_expr_recon_loss: 1782642.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5249998.0000; train_optim_loss: 5249998.0000; val_kl_reg_loss: 131.9965; val_edge_recon_loss: 4061313.0000; val_gene_expr_recon_loss: 1800678.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5862123.5000; val_optim_loss: 5862123.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9019; val_auprc_score: 0.8712; val_best_acc_score: 0.5058; val_best_f1_score: 0.6693; train_kl_reg_loss: 128.5363; train_edge_recon_loss: 3463859.0000; train_gene_expr_recon_loss: 1776574.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5240562.0000; train_optim_loss: 5240562.0000; val_kl_reg_loss: 335.0869; val_edge_recon_loss: 4063470.7500; val_gene_expr_recon_loss: 1789169.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5852975.0000; val_optim_loss: 5852975.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8948; val_auprc_score: 0.8900; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 321.1422; train_edge_recon_loss: 3461482.0000; train_gene_expr_recon_loss: 1771449.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5233252.5000; train_optim_loss: 5233252.5000; val_kl_reg_loss: 599.2728; val_edge_recon_loss: 4064426.7500; val_gene_expr_recon_loss: 1794477.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5859504.0000; val_optim_loss: 5859504.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9062; val_auprc_score: 0.8742; val_best_acc_score: 0.5233; val_best_f1_score: 0.6772; train_kl_reg_loss: 581.6497; train_edge_recon_loss: 3469888.5000; train_gene_expr_recon_loss: 1767210.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5237681.0000; train_optim_loss: 5237681.0000; val_kl_reg_loss: 650.1978; val_edge_recon_loss: 4063463.7500; val_gene_expr_recon_loss: 1797491.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5861605.0000; val_optim_loss: 5861605.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9299; val_auprc_score: 0.9206; val_best_acc_score: 0.5698; val_best_f1_score: 0.6992; train_kl_reg_loss: 617.0461; train_edge_recon_loss: 3459416.0000; train_gene_expr_recon_loss: 1764755.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5224788.5000; train_optim_loss: 5224788.5000; val_kl_reg_loss: 634.2291; val_edge_recon_loss: 4062256.5000; val_gene_expr_recon_loss: 1794899.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5857790.5000; val_optim_loss: 5857790.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9439; val_auprc_score: 0.9261; val_best_acc_score: 0.6541; val_best_f1_score: 0.7430; train_kl_reg_loss: 582.1865; train_edge_recon_loss: 3460783.0000; train_gene_expr_recon_loss: 1763644.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5225009.5000; train_optim_loss: 5225009.5000; val_kl_reg_loss: 625.3168; val_edge_recon_loss: 4058657.0000; val_gene_expr_recon_loss: 1795264.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5854546.5000; val_optim_loss: 5854546.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8993; val_auprc_score: 0.8669; val_best_acc_score: 0.6279; val_best_f1_score: 0.7288; train_kl_reg_loss: 575.9864; train_edge_recon_loss: 3454836.5000; train_gene_expr_recon_loss: 1761588.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5217001.0000; train_optim_loss: 5217001.0000; val_kl_reg_loss: 672.9592; val_edge_recon_loss: 4059611.0000; val_gene_expr_recon_loss: 1801720.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5862004.0000; val_optim_loss: 5862004.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9815
val AUPRC score: 0.9797
val best accuracy score: 0.8692
val best F1 score: 0.8525
val target rna MSE score: 0.0113
val source rna MSE score: 0.0043
Duration of model training in run 3: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 797
Number of validation edges: 88
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8981; val_auprc_score: 0.8921; val_best_acc_score: 0.7216; val_best_f1_score: 0.7783; train_kl_reg_loss: 0.5462; train_edge_recon_loss: 3466931.0000; train_gene_expr_recon_loss: 1778979.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5245910.5000; train_optim_loss: 5245910.5000; val_kl_reg_loss: 5.2432; val_edge_recon_loss: 4017522.7500; val_gene_expr_recon_loss: 1888781.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5906309.5000; val_optim_loss: 5906309.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8635; val_auprc_score: 0.8348; val_best_acc_score: 0.8011; val_best_f1_score: 0.8108; train_kl_reg_loss: 5.1253; train_edge_recon_loss: 3466746.0000; train_gene_expr_recon_loss: 1767756.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5234507.5000; train_optim_loss: 5234507.5000; val_kl_reg_loss: 28.7595; val_edge_recon_loss: 4049772.2500; val_gene_expr_recon_loss: 1892643.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5942444.0000; val_optim_loss: 5942444.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8534; val_auprc_score: 0.8626; val_best_acc_score: 0.6875; val_best_f1_score: 0.7577; train_kl_reg_loss: 28.4734; train_edge_recon_loss: 3467570.0000; train_gene_expr_recon_loss: 1757951.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5225549.5000; train_optim_loss: 5225549.5000; val_kl_reg_loss: 101.9620; val_edge_recon_loss: 4058825.0000; val_gene_expr_recon_loss: 1892767.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5951694.5000; val_optim_loss: 5951694.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8369; val_auprc_score: 0.8072; val_best_acc_score: 0.5341; val_best_f1_score: 0.6822; train_kl_reg_loss: 98.7364; train_edge_recon_loss: 3463479.2500; train_gene_expr_recon_loss: 1751093.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5214671.0000; train_optim_loss: 5214671.0000; val_kl_reg_loss: 259.2079; val_edge_recon_loss: 4062902.0000; val_gene_expr_recon_loss: 1881474.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5944636.0000; val_optim_loss: 5944636.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8623; val_auprc_score: 0.8324; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 252.8343; train_edge_recon_loss: 3458677.7500; train_gene_expr_recon_loss: 1746997.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5205928.0000; train_optim_loss: 5205928.0000; val_kl_reg_loss: 533.8516; val_edge_recon_loss: 4063796.0000; val_gene_expr_recon_loss: 1882367.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5946697.5000; val_optim_loss: 5946697.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7886; val_auprc_score: 0.7832; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 530.0952; train_edge_recon_loss: 3455194.0000; train_gene_expr_recon_loss: 1742826.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5198550.0000; train_optim_loss: 5198550.0000; val_kl_reg_loss: 818.6226; val_edge_recon_loss: 4064659.7500; val_gene_expr_recon_loss: 1880560.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5946039.0000; val_optim_loss: 5946039.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8028; val_auprc_score: 0.8039; val_best_acc_score: 0.5227; val_best_f1_score: 0.6769; train_kl_reg_loss: 791.0526; train_edge_recon_loss: 3460343.7500; train_gene_expr_recon_loss: 1739064.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5200199.5000; train_optim_loss: 5200199.5000; val_kl_reg_loss: 867.1177; val_edge_recon_loss: 4064342.0000; val_gene_expr_recon_loss: 1881228.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5946437.0000; val_optim_loss: 5946437.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8694; val_auprc_score: 0.8557; val_best_acc_score: 0.5739; val_best_f1_score: 0.7012; train_kl_reg_loss: 855.4165; train_edge_recon_loss: 3465396.2500; train_gene_expr_recon_loss: 1736866.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5203118.0000; train_optim_loss: 5203118.0000; val_kl_reg_loss: 640.5288; val_edge_recon_loss: 4061967.7500; val_gene_expr_recon_loss: 1875044.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5937653.0000; val_optim_loss: 5937653.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8523; val_auprc_score: 0.8335; val_best_acc_score: 0.6080; val_best_f1_score: 0.7184; train_kl_reg_loss: 725.2140; train_edge_recon_loss: 3451396.2500; train_gene_expr_recon_loss: 1736588.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5188710.0000; train_optim_loss: 5188710.0000; val_kl_reg_loss: 708.4501; val_edge_recon_loss: 4061702.5000; val_gene_expr_recon_loss: 1884338.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5946749.0000; val_optim_loss: 5946749.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.8997
val AUPRC score: 0.8871
val best accuracy score: 0.6818
val best F1 score: 0.7544
val target rna MSE score: 0.0127
val source rna MSE score: 0.0049
Duration of model training in run 2: 0 hours, 0 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 4000, n_cat_covariates_embed_input: 0, n_hidden: 1529, n_latent: 1519, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1519, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 4000

--- INITIALIZING TRAINER ---
Number of training nodes: 349
Number of validation nodes: 39
Number of training edges: 797
Number of validation edges: 88
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9376; val_auprc_score: 0.9342; val_best_acc_score: 0.7330; val_best_f1_score: 0.7854; train_kl_reg_loss: 0.5213; train_edge_recon_loss: 3465306.2500; train_gene_expr_recon_loss: 1806451.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5271758.5000; train_optim_loss: 5271758.5000; val_kl_reg_loss: 5.0497; val_edge_recon_loss: 4014994.2500; val_gene_expr_recon_loss: 1692725.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5707725.0000; val_optim_loss: 5707725.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8569; val_auprc_score: 0.8198; val_best_acc_score: 0.7557; val_best_f1_score: 0.7882; train_kl_reg_loss: 5.1818; train_edge_recon_loss: 3466401.7500; train_gene_expr_recon_loss: 1793657.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5260065.0000; train_optim_loss: 5260065.0000; val_kl_reg_loss: 28.4930; val_edge_recon_loss: 4053065.0000; val_gene_expr_recon_loss: 1693945.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5747039.0000; val_optim_loss: 5747039.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8407; val_auprc_score: 0.7503; val_best_acc_score: 0.6648; val_best_f1_score: 0.7468; train_kl_reg_loss: 28.8812; train_edge_recon_loss: 3467463.5000; train_gene_expr_recon_loss: 1783445.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5250938.0000; train_optim_loss: 5250938.0000; val_kl_reg_loss: 92.6514; val_edge_recon_loss: 4058936.0000; val_gene_expr_recon_loss: 1693981.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5753010.0000; val_optim_loss: 5753010.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8665; val_auprc_score: 0.8081; val_best_acc_score: 0.5795; val_best_f1_score: 0.7040; train_kl_reg_loss: 96.7380; train_edge_recon_loss: 3460511.0000; train_gene_expr_recon_loss: 1777367.5000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5237975.0000; train_optim_loss: 5237975.0000; val_kl_reg_loss: 231.8844; val_edge_recon_loss: 4061592.5000; val_gene_expr_recon_loss: 1686841.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5748665.5000; val_optim_loss: 5748665.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8939; val_auprc_score: 0.8803; val_best_acc_score: 0.5170; val_best_f1_score: 0.6743; train_kl_reg_loss: 234.7802; train_edge_recon_loss: 3455661.2500; train_gene_expr_recon_loss: 1771408.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5227305.0000; train_optim_loss: 5227305.0000; val_kl_reg_loss: 438.6415; val_edge_recon_loss: 4062925.2500; val_gene_expr_recon_loss: 1685485.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5748850.0000; val_optim_loss: 5748850.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9050; val_auprc_score: 0.8942; val_best_acc_score: 0.5170; val_best_f1_score: 0.6743; train_kl_reg_loss: 465.4117; train_edge_recon_loss: 3457087.7500; train_gene_expr_recon_loss: 1767507.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5225060.5000; train_optim_loss: 5225060.5000; val_kl_reg_loss: 659.0562; val_edge_recon_loss: 4063171.5000; val_gene_expr_recon_loss: 1686952.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5750783.0000; val_optim_loss: 5750783.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8642; val_auprc_score: 0.8484; val_best_acc_score: 0.5966; val_best_f1_score: 0.7126; train_kl_reg_loss: 708.0338; train_edge_recon_loss: 3464807.2500; train_gene_expr_recon_loss: 1763995.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5229510.5000; train_optim_loss: 5229510.5000; val_kl_reg_loss: 715.6829; val_edge_recon_loss: 4061929.5000; val_gene_expr_recon_loss: 1685717.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5748363.0000; val_optim_loss: 5748363.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8596; val_auprc_score: 0.8439; val_best_acc_score: 0.6364; val_best_f1_score: 0.7333; train_kl_reg_loss: 730.1494; train_edge_recon_loss: 3459177.2500; train_gene_expr_recon_loss: 1762186.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5222094.0000; train_optim_loss: 5222094.0000; val_kl_reg_loss: 661.3555; val_edge_recon_loss: 4059174.2500; val_gene_expr_recon_loss: 1683683.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5743519.0000; val_optim_loss: 5743519.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9046; val_auprc_score: 0.8813; val_best_acc_score: 0.6420; val_best_f1_score: 0.7364; train_kl_reg_loss: 653.4393; train_edge_recon_loss: 3448392.7500; train_gene_expr_recon_loss: 1761385.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5210432.0000; train_optim_loss: 5210432.0000; val_kl_reg_loss: 677.9321; val_edge_recon_loss: 4056916.2500; val_gene_expr_recon_loss: 1683705.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5741300.0000; val_optim_loss: 5741300.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 3 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
val AUROC score: 0.9042
val AUPRC score: 0.8941
val best accuracy score: 0.6761
val best F1 score: 0.7511
val target rna MSE score: 0.0117
val source rna MSE score: 0.0047
Duration of model training in run 1: 0 hours, 0 minutes and 6 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
