Run timestamp: 21062023_133735.
Script arguments:
['../train_nichecompass_benchmarking_models.py', '--adata_new_name', 'None', '--n_neighbors_list', '4', '4', '8', '8', '12', '12', '16', '16', '20', '20', '--edge_batch_size_list', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '16384', '--node_batch_size_list', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', 'None', '--seeds', '0', '1', '2', '3', '4', '5', '6', '7', '8', '9', '--run_index', '1', '2', '3', '4', '5', '6', '7', '8', '9', '10', '--cell_type_key', 'celltype_mapped_refined', '--nichenet_keep_target_genes_ratio', '1.', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--dataset', 'seqfish_mouse_organogenesis_subsample_10pct_embryo2', '--reference_batches', 'None', '--counts_key', 'counts', '--condition_key', 'batch', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--no-filter_genes', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_single_sample_method_benchmarking', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.05', '--gene_expr_recon_dist', 'nb', '--cond_embed_injection', 'encoder', 'gene_expr_decoder', '--n_cond_embed', 'None', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cond_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cond_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.03125', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6523; val_auprc_score: 0.6819; val_best_acc_score: 0.6495; val_best_f1_score: 0.6417; train_kl_reg_loss: 1101.4287; train_edge_recon_loss: 365241.4219; train_cond_contrastive_loss: 139807.1602; train_gene_expr_recon_loss: 145560.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 651710.4375; train_optim_loss: 651710.4375; val_kl_reg_loss: 2031.2104; val_edge_recon_loss: 429298.9688; val_cond_contrastive_loss: 78437.8594; val_gene_expr_recon_loss: 131147.5469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 640915.6250; val_optim_loss: 640915.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6564; val_auprc_score: 0.6904; val_best_acc_score: 0.6341; val_best_f1_score: 0.6562; train_kl_reg_loss: 2738.6949; train_edge_recon_loss: 383060.2656; train_cond_contrastive_loss: 98381.7656; train_gene_expr_recon_loss: 127678.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 611858.7812; train_optim_loss: 611858.7812; val_kl_reg_loss: 5646.5708; val_edge_recon_loss: 417521.4688; val_cond_contrastive_loss: 78411.2188; val_gene_expr_recon_loss: 121299.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 622879.2500; val_optim_loss: 622879.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6366; val_auprc_score: 0.6633; val_best_acc_score: 0.6212; val_best_f1_score: 0.6484; train_kl_reg_loss: 14068.2671; train_edge_recon_loss: 385677.0625; train_cond_contrastive_loss: 83251.8594; train_gene_expr_recon_loss: 120313.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 603310.6875; train_optim_loss: 603310.6875; val_kl_reg_loss: 9990.1758; val_edge_recon_loss: 416205.6875; val_cond_contrastive_loss: 78427.0078; val_gene_expr_recon_loss: 117426.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 622049.7500; val_optim_loss: 622049.7500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6381; val_auprc_score: 0.6689; val_best_acc_score: 0.6177; val_best_f1_score: 0.6531; train_kl_reg_loss: 9321.7236; train_edge_recon_loss: 378341.8906; train_cond_contrastive_loss: 85762.1758; train_gene_expr_recon_loss: 116999.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 590425.7188; train_optim_loss: 590425.7188; val_kl_reg_loss: 5631.3330; val_edge_recon_loss: 405880.4062; val_cond_contrastive_loss: 78467.9688; val_gene_expr_recon_loss: 116131.8984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 606111.6250; val_optim_loss: 606111.6250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6462; val_auprc_score: 0.6646; val_best_acc_score: 0.6098; val_best_f1_score: 0.6463; train_kl_reg_loss: 5695.8755; train_edge_recon_loss: 373511.8438; train_cond_contrastive_loss: 88616.3945; train_gene_expr_recon_loss: 115888.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 583713.0000; train_optim_loss: 583713.0000; val_kl_reg_loss: 4705.4990; val_edge_recon_loss: 398280.8125; val_cond_contrastive_loss: 78529.4062; val_gene_expr_recon_loss: 115578.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 597093.8750; val_optim_loss: 597093.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6439; val_auprc_score: 0.6624; val_best_acc_score: 0.6162; val_best_f1_score: 0.6417; train_kl_reg_loss: 4791.1414; train_edge_recon_loss: 369644.2031; train_cond_contrastive_loss: 88133.6094; train_gene_expr_recon_loss: 115360.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 577929.3125; train_optim_loss: 577929.3125; val_kl_reg_loss: 3826.0498; val_edge_recon_loss: 386883.4688; val_cond_contrastive_loss: 78582.2344; val_gene_expr_recon_loss: 115323.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 584615.2500; val_optim_loss: 584615.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6426; val_auprc_score: 0.6587; val_best_acc_score: 0.6235; val_best_f1_score: 0.6439; train_kl_reg_loss: 3790.2190; train_edge_recon_loss: 358728.9688; train_cond_contrastive_loss: 88478.5859; train_gene_expr_recon_loss: 115044.7891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 566042.5625; train_optim_loss: 566042.5625; val_kl_reg_loss: 3228.6143; val_edge_recon_loss: 375712.6250; val_cond_contrastive_loss: 78544.9062; val_gene_expr_recon_loss: 115086.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572572.3125; val_optim_loss: 572572.3125
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6461; val_auprc_score: 0.6599; val_best_acc_score: 0.6238; val_best_f1_score: 0.6426; train_kl_reg_loss: 3281.4335; train_edge_recon_loss: 350202.3594; train_cond_contrastive_loss: 86381.7070; train_gene_expr_recon_loss: 114813.1445; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 554678.6562; train_optim_loss: 554678.6562; val_kl_reg_loss: 3209.3779; val_edge_recon_loss: 371927.1250; val_cond_contrastive_loss: 78473.3516; val_gene_expr_recon_loss: 114835.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 568445.6875; val_optim_loss: 568445.6875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6492; val_auprc_score: 0.6713; val_best_acc_score: 0.6189; val_best_f1_score: 0.6494; train_kl_reg_loss: 3341.0122; train_edge_recon_loss: 344024.0625; train_cond_contrastive_loss: 82811.9102; train_gene_expr_recon_loss: 114429.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544606.8125; train_optim_loss: 544606.8125; val_kl_reg_loss: 3502.2095; val_edge_recon_loss: 367368.3750; val_cond_contrastive_loss: 78441.6406; val_gene_expr_recon_loss: 114533.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 563845.6250; val_optim_loss: 563845.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6391; val_auprc_score: 0.6642; val_best_acc_score: 0.6063; val_best_f1_score: 0.6500; train_kl_reg_loss: 3627.5004; train_edge_recon_loss: 344065.5000; train_cond_contrastive_loss: 80864.4883; train_gene_expr_recon_loss: 114181.4805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542738.9375; train_optim_loss: 542738.9375; val_kl_reg_loss: 3724.2703; val_edge_recon_loss: 369086.4375; val_cond_contrastive_loss: 78430.5625; val_gene_expr_recon_loss: 114159.8672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 565401.1250; val_optim_loss: 565401.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6443; val_auprc_score: 0.6611; val_best_acc_score: 0.6204; val_best_f1_score: 0.6423; train_kl_reg_loss: 3792.0070; train_edge_recon_loss: 347766.6719; train_cond_contrastive_loss: 80361.7383; train_gene_expr_recon_loss: 113805.7969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545726.2188; train_optim_loss: 545726.2188; val_kl_reg_loss: 3724.9897; val_edge_recon_loss: 374115.3125; val_cond_contrastive_loss: 78429.7812; val_gene_expr_recon_loss: 113803.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 570073.1250; val_optim_loss: 570073.1250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6594; val_auprc_score: 0.6723; val_best_acc_score: 0.6303; val_best_f1_score: 0.6487; train_kl_reg_loss: 3751.3096; train_edge_recon_loss: 344509.1875; train_cond_contrastive_loss: 80242.0508; train_gene_expr_recon_loss: 113331.9961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 541834.5625; train_optim_loss: 541834.5625; val_kl_reg_loss: 3614.4434; val_edge_recon_loss: 367774.7188; val_cond_contrastive_loss: 78414.4141; val_gene_expr_recon_loss: 113543.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 563346.6250; val_optim_loss: 563346.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6676; val_auprc_score: 0.6757; val_best_acc_score: 0.6332; val_best_f1_score: 0.6529; train_kl_reg_loss: 3608.3317; train_edge_recon_loss: 343629.8281; train_cond_contrastive_loss: 80532.6445; train_gene_expr_recon_loss: 113085.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 540856.4062; train_optim_loss: 540856.4062; val_kl_reg_loss: 3483.3616; val_edge_recon_loss: 366881.4688; val_cond_contrastive_loss: 78409.4766; val_gene_expr_recon_loss: 113335.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 562110.2500; val_optim_loss: 562110.2500
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6768; val_auprc_score: 0.6819; val_best_acc_score: 0.6397; val_best_f1_score: 0.6625; train_kl_reg_loss: 3509.1326; train_edge_recon_loss: 338659.7969; train_cond_contrastive_loss: 80961.2656; train_gene_expr_recon_loss: 113074.6328; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 536204.8438; train_optim_loss: 536204.8438; val_kl_reg_loss: 3497.7305; val_edge_recon_loss: 359255.3125; val_cond_contrastive_loss: 78413.4453; val_gene_expr_recon_loss: 113141.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 554308.0000; val_optim_loss: 554308.0000
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.6920; val_auprc_score: 0.6890; val_best_acc_score: 0.6466; val_best_f1_score: 0.6703; train_kl_reg_loss: 3549.3281; train_edge_recon_loss: 337037.5469; train_cond_contrastive_loss: 80798.7812; train_gene_expr_recon_loss: 112890.1250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 534275.7812; train_optim_loss: 534275.7812; val_kl_reg_loss: 3656.4712; val_edge_recon_loss: 349128.3750; val_cond_contrastive_loss: 78426.9375; val_gene_expr_recon_loss: 112938.5859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 544150.3750; val_optim_loss: 544150.3750
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.7179; val_auprc_score: 0.7052; val_best_acc_score: 0.6585; val_best_f1_score: 0.6773; train_kl_reg_loss: 3731.9517; train_edge_recon_loss: 331419.7188; train_cond_contrastive_loss: 80323.6133; train_gene_expr_recon_loss: 112636.4336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528111.7188; train_optim_loss: 528111.7188; val_kl_reg_loss: 3980.0171; val_edge_recon_loss: 339577.0000; val_cond_contrastive_loss: 78431.8672; val_gene_expr_recon_loss: 112693.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 534682.5625; val_optim_loss: 534682.5625
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.7438; val_auprc_score: 0.7260; val_best_acc_score: 0.6749; val_best_f1_score: 0.6891; train_kl_reg_loss: 4154.9564; train_edge_recon_loss: 321963.5469; train_cond_contrastive_loss: 79824.8750; train_gene_expr_recon_loss: 112457.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518401.0312; train_optim_loss: 518401.0312; val_kl_reg_loss: 4535.9521; val_edge_recon_loss: 334131.6250; val_cond_contrastive_loss: 78455.3672; val_gene_expr_recon_loss: 112400.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 529523.6875; val_optim_loss: 529523.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.7750; val_auprc_score: 0.7499; val_best_acc_score: 0.6979; val_best_f1_score: 0.7202; train_kl_reg_loss: 4797.4272; train_edge_recon_loss: 316340.7656; train_cond_contrastive_loss: 79332.6797; train_gene_expr_recon_loss: 111981.6523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 512452.5469; train_optim_loss: 512452.5469; val_kl_reg_loss: 5291.0371; val_edge_recon_loss: 316594.1562; val_cond_contrastive_loss: 78474.5391; val_gene_expr_recon_loss: 112082.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 512442.4688; val_optim_loss: 512442.4688
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.7697; val_auprc_score: 0.7406; val_best_acc_score: 0.6896; val_best_f1_score: 0.7223; train_kl_reg_loss: 5600.3071; train_edge_recon_loss: 313932.5000; train_cond_contrastive_loss: 78983.5977; train_gene_expr_recon_loss: 111719.6094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 510236.0312; train_optim_loss: 510236.0312; val_kl_reg_loss: 6083.3823; val_edge_recon_loss: 323298.2500; val_cond_contrastive_loss: 78476.5156; val_gene_expr_recon_loss: 111792.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 519650.5312; val_optim_loss: 519650.5312
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.7923; val_auprc_score: 0.7555; val_best_acc_score: 0.7137; val_best_f1_score: 0.7391; train_kl_reg_loss: 6396.1538; train_edge_recon_loss: 306913.2031; train_cond_contrastive_loss: 78783.4766; train_gene_expr_recon_loss: 111524.2969; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 503617.1406; train_optim_loss: 503617.1406; val_kl_reg_loss: 6756.5332; val_edge_recon_loss: 313332.7188; val_cond_contrastive_loss: 78472.6406; val_gene_expr_recon_loss: 111524.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 510086.5938; val_optim_loss: 510086.5938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.7943; val_auprc_score: 0.7514; val_best_acc_score: 0.7157; val_best_f1_score: 0.7472; train_kl_reg_loss: 7048.1118; train_edge_recon_loss: 303853.8750; train_cond_contrastive_loss: 78681.9141; train_gene_expr_recon_loss: 111211.9141; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 500795.8125; train_optim_loss: 500795.8125; val_kl_reg_loss: 7245.6240; val_edge_recon_loss: 310924.5938; val_cond_contrastive_loss: 78463.0156; val_gene_expr_recon_loss: 111266.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 507899.5312; val_optim_loss: 507899.5312
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8064; val_auprc_score: 0.7606; val_best_acc_score: 0.7298; val_best_f1_score: 0.7516; train_kl_reg_loss: 7504.5913; train_edge_recon_loss: 301955.1562; train_cond_contrastive_loss: 78654.6445; train_gene_expr_recon_loss: 110986.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499101.2344; train_optim_loss: 499101.2344; val_kl_reg_loss: 7584.8125; val_edge_recon_loss: 308391.8125; val_cond_contrastive_loss: 78456.6641; val_gene_expr_recon_loss: 111032.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 505466.0625; val_optim_loss: 505466.0625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8059; val_auprc_score: 0.7465; val_best_acc_score: 0.7270; val_best_f1_score: 0.7496; train_kl_reg_loss: 7816.5745; train_edge_recon_loss: 301987.0156; train_cond_contrastive_loss: 78634.7617; train_gene_expr_recon_loss: 110759.2070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499197.5625; train_optim_loss: 499197.5625; val_kl_reg_loss: 7750.8838; val_edge_recon_loss: 312833.9062; val_cond_contrastive_loss: 78443.2109; val_gene_expr_recon_loss: 110817.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 509845.4688; val_optim_loss: 509845.4688
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8197; val_auprc_score: 0.7697; val_best_acc_score: 0.7386; val_best_f1_score: 0.7608; train_kl_reg_loss: 7941.8762; train_edge_recon_loss: 300824.7969; train_cond_contrastive_loss: 78623.7148; train_gene_expr_recon_loss: 110449.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 497840.0000; train_optim_loss: 497840.0000; val_kl_reg_loss: 7741.3037; val_edge_recon_loss: 305612.4375; val_cond_contrastive_loss: 78437.9453; val_gene_expr_recon_loss: 110620.1172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 502411.8125; val_optim_loss: 502411.8125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8257; val_auprc_score: 0.7717; val_best_acc_score: 0.7570; val_best_f1_score: 0.7740; train_kl_reg_loss: 7871.9995; train_edge_recon_loss: 296164.8750; train_cond_contrastive_loss: 78639.4297; train_gene_expr_recon_loss: 110311.2617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 492987.5625; train_optim_loss: 492987.5625; val_kl_reg_loss: 7499.7979; val_edge_recon_loss: 296611.0312; val_cond_contrastive_loss: 78435.7031; val_gene_expr_recon_loss: 110452.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 492999.3125; val_optim_loss: 492999.3125
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8202; val_auprc_score: 0.7580; val_best_acc_score: 0.7531; val_best_f1_score: 0.7652; train_kl_reg_loss: 7603.6094; train_edge_recon_loss: 299533.9062; train_cond_contrastive_loss: 78686.2852; train_gene_expr_recon_loss: 110249.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 496073.5000; train_optim_loss: 496073.5000; val_kl_reg_loss: 7168.5537; val_edge_recon_loss: 305900.8438; val_cond_contrastive_loss: 78437.3359; val_gene_expr_recon_loss: 110309.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 501816.4688; val_optim_loss: 501816.4688
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8334; val_auprc_score: 0.7718; val_best_acc_score: 0.7627; val_best_f1_score: 0.7737; train_kl_reg_loss: 7265.1855; train_edge_recon_loss: 297491.3438; train_cond_contrastive_loss: 78754.3477; train_gene_expr_recon_loss: 110221.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493732.8594; train_optim_loss: 493732.8594; val_kl_reg_loss: 6839.8213; val_edge_recon_loss: 300411.8125; val_cond_contrastive_loss: 78438.0156; val_gene_expr_recon_loss: 110161.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 495851.0312; val_optim_loss: 495851.0312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8357; val_auprc_score: 0.7814; val_best_acc_score: 0.7642; val_best_f1_score: 0.7810; train_kl_reg_loss: 6957.9282; train_edge_recon_loss: 295574.6719; train_cond_contrastive_loss: 78806.9414; train_gene_expr_recon_loss: 109996.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491335.9844; train_optim_loss: 491335.9844; val_kl_reg_loss: 6593.8984; val_edge_recon_loss: 299805.8750; val_cond_contrastive_loss: 78442.9688; val_gene_expr_recon_loss: 110016.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494859.1562; val_optim_loss: 494859.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8454; val_auprc_score: 0.7900; val_best_acc_score: 0.7722; val_best_f1_score: 0.7826; train_kl_reg_loss: 6766.9888; train_edge_recon_loss: 294901.6094; train_cond_contrastive_loss: 78837.9805; train_gene_expr_recon_loss: 109851.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490357.6406; train_optim_loss: 490357.6406; val_kl_reg_loss: 6575.5508; val_edge_recon_loss: 299810.1562; val_cond_contrastive_loss: 78441.5703; val_gene_expr_recon_loss: 109996.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494823.8750; val_optim_loss: 494823.8750
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8449; val_auprc_score: 0.7924; val_best_acc_score: 0.7730; val_best_f1_score: 0.7862; train_kl_reg_loss: 6741.8694; train_edge_recon_loss: 293887.8750; train_cond_contrastive_loss: 78849.4062; train_gene_expr_recon_loss: 109825.7188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489304.8750; train_optim_loss: 489304.8750; val_kl_reg_loss: 6525.9502; val_edge_recon_loss: 295817.3750; val_cond_contrastive_loss: 78441.2812; val_gene_expr_recon_loss: 109970.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490755.0000; val_optim_loss: 490755.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8341; val_auprc_score: 0.7776; val_best_acc_score: 0.7577; val_best_f1_score: 0.7802; train_kl_reg_loss: 6702.5581; train_edge_recon_loss: 296492.4062; train_cond_contrastive_loss: 78858.7539; train_gene_expr_recon_loss: 109673.3906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491727.0938; train_optim_loss: 491727.0938; val_kl_reg_loss: 6495.9814; val_edge_recon_loss: 302038.5000; val_cond_contrastive_loss: 78445.1797; val_gene_expr_recon_loss: 109944.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 496923.9688; val_optim_loss: 496923.9688
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8479; val_auprc_score: 0.8059; val_best_acc_score: 0.7729; val_best_f1_score: 0.7892; train_kl_reg_loss: 6673.3623; train_edge_recon_loss: 296212.9688; train_cond_contrastive_loss: 78857.3594; train_gene_expr_recon_loss: 109756.7852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491500.4688; train_optim_loss: 491500.4688; val_kl_reg_loss: 6460.4658; val_edge_recon_loss: 293880.2500; val_cond_contrastive_loss: 78445.7500; val_gene_expr_recon_loss: 109919.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488706.0625; val_optim_loss: 488706.0625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8439; val_auprc_score: 0.7893; val_best_acc_score: 0.7750; val_best_f1_score: 0.7853; train_kl_reg_loss: 6650.8323; train_edge_recon_loss: 295170.0938; train_cond_contrastive_loss: 78865.6602; train_gene_expr_recon_loss: 109711.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490398.2188; train_optim_loss: 490398.2188; val_kl_reg_loss: 6436.3037; val_edge_recon_loss: 298872.0938; val_cond_contrastive_loss: 78448.4531; val_gene_expr_recon_loss: 109895.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 493652.6875; val_optim_loss: 493652.6875
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8440; val_auprc_score: 0.7831; val_best_acc_score: 0.7769; val_best_f1_score: 0.7879; train_kl_reg_loss: 6610.1763; train_edge_recon_loss: 296598.8750; train_cond_contrastive_loss: 78869.0430; train_gene_expr_recon_loss: 109621.8867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491699.9531; train_optim_loss: 491699.9531; val_kl_reg_loss: 6418.3838; val_edge_recon_loss: 297939.4688; val_cond_contrastive_loss: 78439.8594; val_gene_expr_recon_loss: 109873.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 492671.3125; val_optim_loss: 492671.3125
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8476; val_auprc_score: 0.7975; val_best_acc_score: 0.7699; val_best_f1_score: 0.7876; train_kl_reg_loss: 6594.1963; train_edge_recon_loss: 295434.7812; train_cond_contrastive_loss: 78876.4062; train_gene_expr_recon_loss: 109635.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490540.5625; train_optim_loss: 490540.5625; val_kl_reg_loss: 6395.0449; val_edge_recon_loss: 297359.0938; val_cond_contrastive_loss: 78443.0625; val_gene_expr_recon_loss: 109851.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 492049.1562; val_optim_loss: 492049.1562

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8360; val_auprc_score: 0.7811; val_best_acc_score: 0.7701; val_best_f1_score: 0.7933; train_kl_reg_loss: 6585.1323; train_edge_recon_loss: 294107.1562; train_cond_contrastive_loss: 78879.0742; train_gene_expr_recon_loss: 109726.8984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489298.2656; train_optim_loss: 489298.2656; val_kl_reg_loss: 6393.4336; val_edge_recon_loss: 293350.1250; val_cond_contrastive_loss: 78442.3984; val_gene_expr_recon_loss: 109849.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488035.6250; val_optim_loss: 488035.6250
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8491; val_auprc_score: 0.7909; val_best_acc_score: 0.7802; val_best_f1_score: 0.7955; train_kl_reg_loss: 6583.4060; train_edge_recon_loss: 298119.3125; train_cond_contrastive_loss: 78876.9844; train_gene_expr_recon_loss: 109800.1172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 493379.8281; train_optim_loss: 493379.8281; val_kl_reg_loss: 6388.0029; val_edge_recon_loss: 293462.6562; val_cond_contrastive_loss: 78442.6875; val_gene_expr_recon_loss: 109847.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488140.5938; val_optim_loss: 488140.5938
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8514; val_auprc_score: 0.7947; val_best_acc_score: 0.7823; val_best_f1_score: 0.7964; train_kl_reg_loss: 6587.2976; train_edge_recon_loss: 295124.4375; train_cond_contrastive_loss: 78879.3984; train_gene_expr_recon_loss: 109689.0117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490280.1250; train_optim_loss: 490280.1250; val_kl_reg_loss: 6394.5908; val_edge_recon_loss: 294882.0000; val_cond_contrastive_loss: 78447.6016; val_gene_expr_recon_loss: 109844.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489568.9062; val_optim_loss: 489568.9062
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.8458; val_auprc_score: 0.7990; val_best_acc_score: 0.7746; val_best_f1_score: 0.7902; train_kl_reg_loss: 6576.3984; train_edge_recon_loss: 294974.4219; train_cond_contrastive_loss: 78879.5391; train_gene_expr_recon_loss: 109732.9727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490163.3438; train_optim_loss: 490163.3438; val_kl_reg_loss: 6381.2666; val_edge_recon_loss: 298641.8750; val_cond_contrastive_loss: 78452.5859; val_gene_expr_recon_loss: 109842.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 493317.8125; val_optim_loss: 493317.8125

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.8387; val_auprc_score: 0.7811; val_best_acc_score: 0.7708; val_best_f1_score: 0.7834; train_kl_reg_loss: 6575.2471; train_edge_recon_loss: 296440.7812; train_cond_contrastive_loss: 78876.5000; train_gene_expr_recon_loss: 109584.4258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491476.9531; train_optim_loss: 491476.9531; val_kl_reg_loss: 6394.6055; val_edge_recon_loss: 301940.8125; val_cond_contrastive_loss: 78441.2344; val_gene_expr_recon_loss: 109841.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 496618.4062; val_optim_loss: 496618.4062
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.8478; val_auprc_score: 0.7915; val_best_acc_score: 0.7742; val_best_f1_score: 0.7895; train_kl_reg_loss: 6576.2424; train_edge_recon_loss: 291328.0781; train_cond_contrastive_loss: 78881.2070; train_gene_expr_recon_loss: 109729.1836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486514.7188; train_optim_loss: 486514.7188; val_kl_reg_loss: 6408.1333; val_edge_recon_loss: 300061.0312; val_cond_contrastive_loss: 78445.0234; val_gene_expr_recon_loss: 109841.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494755.6875; val_optim_loss: 494755.6875
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.8465; val_auprc_score: 0.7926; val_best_acc_score: 0.7823; val_best_f1_score: 0.7929; train_kl_reg_loss: 6574.0330; train_edge_recon_loss: 295231.1562; train_cond_contrastive_loss: 78878.4023; train_gene_expr_recon_loss: 109730.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 490413.9062; train_optim_loss: 490413.9062; val_kl_reg_loss: 6397.3643; val_edge_recon_loss: 295609.5938; val_cond_contrastive_loss: 78443.1719; val_gene_expr_recon_loss: 109841.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490291.3750; val_optim_loss: 490291.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 14 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
Val AUROC score: 0.8433
Val AUPRC score: 0.7838
Val best accuracy score: 0.7695
Val best F1 score: 0.7851
Val gene expr MSE score: 2.2661
Duration of model training in run 1: 0 hours, 1 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 30388
Number of validation edges: 3376
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.6661; val_auprc_score: 0.6868; val_best_acc_score: 0.6404; val_best_f1_score: 0.6442; train_kl_reg_loss: 1219.2500; train_edge_recon_loss: 366475.5781; train_cond_contrastive_loss: 138916.9609; train_gene_expr_recon_loss: 147353.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 653965.0625; train_optim_loss: 653965.0625; val_kl_reg_loss: 2226.2368; val_edge_recon_loss: 427118.7188; val_cond_contrastive_loss: 78413.3516; val_gene_expr_recon_loss: 130744.9922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 638503.3125; val_optim_loss: 638503.3125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6668; val_auprc_score: 0.6779; val_best_acc_score: 0.6297; val_best_f1_score: 0.6468; train_kl_reg_loss: 3026.3617; train_edge_recon_loss: 381796.5625; train_cond_contrastive_loss: 99105.0586; train_gene_expr_recon_loss: 128863.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 612791.5625; train_optim_loss: 612791.5625; val_kl_reg_loss: 6493.0015; val_edge_recon_loss: 427466.5938; val_cond_contrastive_loss: 78391.9062; val_gene_expr_recon_loss: 120570.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 632921.8125; val_optim_loss: 632921.8125
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6363; val_auprc_score: 0.6514; val_best_acc_score: 0.6250; val_best_f1_score: 0.6396; train_kl_reg_loss: 10209.0586; train_edge_recon_loss: 380221.2188; train_cond_contrastive_loss: 86664.0234; train_gene_expr_recon_loss: 122553.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 599648.0000; train_optim_loss: 599648.0000; val_kl_reg_loss: 8742.7168; val_edge_recon_loss: 427261.3438; val_cond_contrastive_loss: 78403.5625; val_gene_expr_recon_loss: 117465.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 631872.6875; val_optim_loss: 631872.6875
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6392; val_auprc_score: 0.6449; val_best_acc_score: 0.6254; val_best_f1_score: 0.6409; train_kl_reg_loss: 8366.9851; train_edge_recon_loss: 375702.8281; train_cond_contrastive_loss: 88442.0508; train_gene_expr_recon_loss: 118229.9609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 590741.8125; train_optim_loss: 590741.8125; val_kl_reg_loss: 5866.2622; val_edge_recon_loss: 419235.6250; val_cond_contrastive_loss: 78427.0703; val_gene_expr_recon_loss: 116129.0781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 619658.0000; val_optim_loss: 619658.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6310; val_auprc_score: 0.6435; val_best_acc_score: 0.6138; val_best_f1_score: 0.6388; train_kl_reg_loss: 5913.5916; train_edge_recon_loss: 374947.8594; train_cond_contrastive_loss: 89058.3906; train_gene_expr_recon_loss: 116779.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 586699.4375; train_optim_loss: 586699.4375; val_kl_reg_loss: 5050.1323; val_edge_recon_loss: 408848.1250; val_cond_contrastive_loss: 78469.0781; val_gene_expr_recon_loss: 115269.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 607636.3750; val_optim_loss: 607636.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6311; val_auprc_score: 0.6357; val_best_acc_score: 0.6051; val_best_f1_score: 0.6360; train_kl_reg_loss: 5172.1157; train_edge_recon_loss: 367120.8906; train_cond_contrastive_loss: 88837.1602; train_gene_expr_recon_loss: 115971.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 577101.2188; train_optim_loss: 577101.2188; val_kl_reg_loss: 4519.9141; val_edge_recon_loss: 397693.7500; val_cond_contrastive_loss: 78513.8828; val_gene_expr_recon_loss: 114680.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 595407.7500; val_optim_loss: 595407.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6211; val_auprc_score: 0.6313; val_best_acc_score: 0.6066; val_best_f1_score: 0.6422; train_kl_reg_loss: 4518.7390; train_edge_recon_loss: 361712.2969; train_cond_contrastive_loss: 88161.7500; train_gene_expr_recon_loss: 115368.9414; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 569761.7188; train_optim_loss: 569761.7188; val_kl_reg_loss: 3871.3872; val_edge_recon_loss: 383508.7188; val_cond_contrastive_loss: 78515.4609; val_gene_expr_recon_loss: 114339.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 580235.5000; val_optim_loss: 580235.5000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.6528; val_auprc_score: 0.6534; val_best_acc_score: 0.6113; val_best_f1_score: 0.6495; train_kl_reg_loss: 3886.6798; train_edge_recon_loss: 354603.1406; train_cond_contrastive_loss: 87328.3594; train_gene_expr_recon_loss: 115045.5781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 560863.7500; train_optim_loss: 560863.7500; val_kl_reg_loss: 3650.7935; val_edge_recon_loss: 365840.7812; val_cond_contrastive_loss: 78455.9297; val_gene_expr_recon_loss: 114047.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 561994.6250; val_optim_loss: 561994.6250
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.6292; val_auprc_score: 0.6385; val_best_acc_score: 0.6036; val_best_f1_score: 0.6454; train_kl_reg_loss: 3740.3010; train_edge_recon_loss: 345922.7500; train_cond_contrastive_loss: 84097.6523; train_gene_expr_recon_loss: 114675.2148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 548435.9062; train_optim_loss: 548435.9062; val_kl_reg_loss: 3807.2764; val_edge_recon_loss: 377127.1562; val_cond_contrastive_loss: 78412.9297; val_gene_expr_recon_loss: 113692.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 573040.2500; val_optim_loss: 573040.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.6229; val_auprc_score: 0.6224; val_best_acc_score: 0.6014; val_best_f1_score: 0.6396; train_kl_reg_loss: 3917.3505; train_edge_recon_loss: 346407.4688; train_cond_contrastive_loss: 81600.3203; train_gene_expr_recon_loss: 114326.0586; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 546251.1875; train_optim_loss: 546251.1875; val_kl_reg_loss: 3996.5745; val_edge_recon_loss: 382440.2188; val_cond_contrastive_loss: 78401.1641; val_gene_expr_recon_loss: 113339.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 578177.4375; val_optim_loss: 578177.4375
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.6342; val_auprc_score: 0.6378; val_best_acc_score: 0.6059; val_best_f1_score: 0.6446; train_kl_reg_loss: 4058.6238; train_edge_recon_loss: 346659.8438; train_cond_contrastive_loss: 80464.2266; train_gene_expr_recon_loss: 114188.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545370.8125; train_optim_loss: 545370.8125; val_kl_reg_loss: 4007.8535; val_edge_recon_loss: 377427.6250; val_cond_contrastive_loss: 78394.5781; val_gene_expr_recon_loss: 112957.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 572787.1875; val_optim_loss: 572787.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.6352; val_auprc_score: 0.6459; val_best_acc_score: 0.6134; val_best_f1_score: 0.6414; train_kl_reg_loss: 4041.5815; train_edge_recon_loss: 346062.8438; train_cond_contrastive_loss: 80121.4023; train_gene_expr_recon_loss: 113799.6133; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 544025.4375; train_optim_loss: 544025.4375; val_kl_reg_loss: 3980.9937; val_edge_recon_loss: 378830.3125; val_cond_contrastive_loss: 78395.6719; val_gene_expr_recon_loss: 112909.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 574116.3125; val_optim_loss: 574116.3125
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.6306; val_auprc_score: 0.6425; val_best_acc_score: 0.6039; val_best_f1_score: 0.6499; train_kl_reg_loss: 4021.1313; train_edge_recon_loss: 347857.4219; train_cond_contrastive_loss: 80112.7188; train_gene_expr_recon_loss: 113668.2773; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 545659.5625; train_optim_loss: 545659.5625; val_kl_reg_loss: 3954.7852; val_edge_recon_loss: 376339.9688; val_cond_contrastive_loss: 78394.1484; val_gene_expr_recon_loss: 112844.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 571533.8125; val_optim_loss: 571533.8125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.6455; val_auprc_score: 0.6445; val_best_acc_score: 0.6125; val_best_f1_score: 0.6468; train_kl_reg_loss: 3980.5371; train_edge_recon_loss: 345106.6406; train_cond_contrastive_loss: 80177.6367; train_gene_expr_recon_loss: 113568.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 542833.4375; train_optim_loss: 542833.4375; val_kl_reg_loss: 3896.0735; val_edge_recon_loss: 372224.4062; val_cond_contrastive_loss: 78393.7500; val_gene_expr_recon_loss: 112771.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 567285.9375; val_optim_loss: 567285.9375

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 0 min 22 sec.
Using best model state, which was in epoch 8.

--- MODEL EVALUATION ---
Val AUROC score: 0.6333
Val AUPRC score: 0.6415
Val best accuracy score: 0.6069
Val best F1 score: 0.6466
Val gene expr MSE score: 2.3954
Duration of model training in run 2: 0 hours, 0 minutes and 25 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7233; val_auprc_score: 0.7667; val_best_acc_score: 0.6722; val_best_f1_score: 0.6802; train_kl_reg_loss: 1864.8796; train_edge_recon_loss: 355645.4766; train_cond_contrastive_loss: 118379.4824; train_gene_expr_recon_loss: 138261.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 614151.0781; train_optim_loss: 614151.0781; val_kl_reg_loss: 6324.1797; val_edge_recon_loss: 404413.6875; val_cond_contrastive_loss: 78358.5312; val_gene_expr_recon_loss: 123651.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 612747.8125; val_optim_loss: 612747.8125
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6769; val_auprc_score: 0.7211; val_best_acc_score: 0.6145; val_best_f1_score: 0.6856; train_kl_reg_loss: 8759.8440; train_edge_recon_loss: 364075.7031; train_cond_contrastive_loss: 83579.5703; train_gene_expr_recon_loss: 121832.0957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 578247.2031; train_optim_loss: 578247.2031; val_kl_reg_loss: 5940.9873; val_edge_recon_loss: 394586.1562; val_cond_contrastive_loss: 78380.1172; val_gene_expr_recon_loss: 118028.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 596936.0000; val_optim_loss: 596936.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6734; val_auprc_score: 0.7070; val_best_acc_score: 0.6078; val_best_f1_score: 0.6824; train_kl_reg_loss: 5967.8679; train_edge_recon_loss: 356937.8047; train_cond_contrastive_loss: 88047.0859; train_gene_expr_recon_loss: 116928.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567880.9688; train_optim_loss: 567880.9688; val_kl_reg_loss: 4632.0010; val_edge_recon_loss: 381344.6250; val_cond_contrastive_loss: 78442.2031; val_gene_expr_recon_loss: 117267.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 581686.0625; val_optim_loss: 581686.0625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6604; val_auprc_score: 0.6976; val_best_acc_score: 0.6053; val_best_f1_score: 0.6793; train_kl_reg_loss: 4227.8041; train_edge_recon_loss: 347506.2891; train_cond_contrastive_loss: 89180.3965; train_gene_expr_recon_loss: 116840.6836; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 557755.1719; train_optim_loss: 557755.1719; val_kl_reg_loss: 3565.2861; val_edge_recon_loss: 360436.5938; val_cond_contrastive_loss: 78537.1016; val_gene_expr_recon_loss: 116830.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 559369.6875; val_optim_loss: 559369.6875
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6581; val_auprc_score: 0.6977; val_best_acc_score: 0.6146; val_best_f1_score: 0.6811; train_kl_reg_loss: 3561.0930; train_edge_recon_loss: 336789.3438; train_cond_contrastive_loss: 87774.3105; train_gene_expr_recon_loss: 115500.4707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 543625.2188; train_optim_loss: 543625.2188; val_kl_reg_loss: 3552.0547; val_edge_recon_loss: 350103.2812; val_cond_contrastive_loss: 78430.1016; val_gene_expr_recon_loss: 116114.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 548199.8750; val_optim_loss: 548199.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6634; val_auprc_score: 0.7037; val_best_acc_score: 0.6156; val_best_f1_score: 0.6821; train_kl_reg_loss: 3844.0805; train_edge_recon_loss: 329382.1172; train_cond_contrastive_loss: 83130.2793; train_gene_expr_recon_loss: 115054.5176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531411.0000; train_optim_loss: 531411.0000; val_kl_reg_loss: 4232.0029; val_edge_recon_loss: 344172.9688; val_cond_contrastive_loss: 78401.1641; val_gene_expr_recon_loss: 115555.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 542361.2500; val_optim_loss: 542361.2500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.6831; val_auprc_score: 0.7207; val_best_acc_score: 0.6372; val_best_f1_score: 0.6807; train_kl_reg_loss: 4432.8425; train_edge_recon_loss: 327785.9297; train_cond_contrastive_loss: 79990.5723; train_gene_expr_recon_loss: 114030.3301; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 526239.6719; train_optim_loss: 526239.6719; val_kl_reg_loss: 4516.0303; val_edge_recon_loss: 341986.3750; val_cond_contrastive_loss: 78404.6016; val_gene_expr_recon_loss: 115009.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 539916.9375; val_optim_loss: 539916.9375
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7262; val_auprc_score: 0.7452; val_best_acc_score: 0.6620; val_best_f1_score: 0.6994; train_kl_reg_loss: 4523.2512; train_edge_recon_loss: 317575.6016; train_cond_contrastive_loss: 79565.7363; train_gene_expr_recon_loss: 113595.3340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 515259.9297; train_optim_loss: 515259.9297; val_kl_reg_loss: 4447.1816; val_edge_recon_loss: 325522.8125; val_cond_contrastive_loss: 78413.2188; val_gene_expr_recon_loss: 114567.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 522950.9688; val_optim_loss: 522950.9688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.7865; val_auprc_score: 0.7863; val_best_acc_score: 0.7061; val_best_f1_score: 0.7376; train_kl_reg_loss: 4602.9758; train_edge_recon_loss: 305201.4766; train_cond_contrastive_loss: 79632.0273; train_gene_expr_recon_loss: 113339.5762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 502776.0547; train_optim_loss: 502776.0547; val_kl_reg_loss: 4856.4707; val_edge_recon_loss: 303789.9688; val_cond_contrastive_loss: 78450.2656; val_gene_expr_recon_loss: 114023.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 501120.0625; val_optim_loss: 501120.0625
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8176; val_auprc_score: 0.8023; val_best_acc_score: 0.7363; val_best_f1_score: 0.7724; train_kl_reg_loss: 5253.4899; train_edge_recon_loss: 293979.2188; train_cond_contrastive_loss: 79138.3145; train_gene_expr_recon_loss: 112768.3809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 491139.3984; train_optim_loss: 491139.3984; val_kl_reg_loss: 5763.2441; val_edge_recon_loss: 291618.9688; val_cond_contrastive_loss: 78459.4609; val_gene_expr_recon_loss: 113420.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 489262.4062; val_optim_loss: 489262.4062
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8440; val_auprc_score: 0.8159; val_best_acc_score: 0.7637; val_best_f1_score: 0.7847; train_kl_reg_loss: 6163.5736; train_edge_recon_loss: 285943.9531; train_cond_contrastive_loss: 78809.2949; train_gene_expr_recon_loss: 111704.9707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482621.7891; train_optim_loss: 482621.7891; val_kl_reg_loss: 6442.4912; val_edge_recon_loss: 290893.4688; val_cond_contrastive_loss: 78434.9766; val_gene_expr_recon_loss: 112951.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 488721.9688; val_optim_loss: 488721.9688
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8572; val_auprc_score: 0.8294; val_best_acc_score: 0.7815; val_best_f1_score: 0.8035; train_kl_reg_loss: 6633.3136; train_edge_recon_loss: 283261.8359; train_cond_contrastive_loss: 78762.6758; train_gene_expr_recon_loss: 111812.9805; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480470.8203; train_optim_loss: 480470.8203; val_kl_reg_loss: 6498.4556; val_edge_recon_loss: 283697.1875; val_cond_contrastive_loss: 78426.3203; val_gene_expr_recon_loss: 112604.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481226.0938; val_optim_loss: 481226.0938
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8637; val_auprc_score: 0.8351; val_best_acc_score: 0.7946; val_best_f1_score: 0.8159; train_kl_reg_loss: 6579.4686; train_edge_recon_loss: 279401.1641; train_cond_contrastive_loss: 78840.9336; train_gene_expr_recon_loss: 110995.2441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475816.8125; train_optim_loss: 475816.8125; val_kl_reg_loss: 6207.7891; val_edge_recon_loss: 281823.0625; val_cond_contrastive_loss: 78420.0469; val_gene_expr_recon_loss: 112195.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478646.0000; val_optim_loss: 478646.0000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8799; val_auprc_score: 0.8537; val_best_acc_score: 0.8114; val_best_f1_score: 0.8312; train_kl_reg_loss: 6266.1589; train_edge_recon_loss: 276955.3828; train_cond_contrastive_loss: 78942.7305; train_gene_expr_recon_loss: 110811.0879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472975.3672; train_optim_loss: 472975.3672; val_kl_reg_loss: 6031.7695; val_edge_recon_loss: 276885.9375; val_cond_contrastive_loss: 78421.0000; val_gene_expr_recon_loss: 111851.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473190.2500; val_optim_loss: 473190.2500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8868; val_auprc_score: 0.8553; val_best_acc_score: 0.8189; val_best_f1_score: 0.8350; train_kl_reg_loss: 6171.0641; train_edge_recon_loss: 275483.9688; train_cond_contrastive_loss: 78957.3164; train_gene_expr_recon_loss: 110668.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471280.4375; train_optim_loss: 471280.4375; val_kl_reg_loss: 5973.3633; val_edge_recon_loss: 278737.2812; val_cond_contrastive_loss: 78423.7188; val_gene_expr_recon_loss: 111560.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 474694.6250; val_optim_loss: 474694.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8975; val_auprc_score: 0.8691; val_best_acc_score: 0.8239; val_best_f1_score: 0.8394; train_kl_reg_loss: 6178.1659; train_edge_recon_loss: 274574.3047; train_cond_contrastive_loss: 78938.3965; train_gene_expr_recon_loss: 109850.6367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469541.5078; train_optim_loss: 469541.5078; val_kl_reg_loss: 6082.1504; val_edge_recon_loss: 277328.3750; val_cond_contrastive_loss: 78430.9062; val_gene_expr_recon_loss: 111274.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473115.8750; val_optim_loss: 473115.8750
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9138; val_auprc_score: 0.8958; val_best_acc_score: 0.8382; val_best_f1_score: 0.8478; train_kl_reg_loss: 6239.6682; train_edge_recon_loss: 271364.2188; train_cond_contrastive_loss: 78824.4883; train_gene_expr_recon_loss: 110302.8848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466731.2578; train_optim_loss: 466731.2578; val_kl_reg_loss: 6053.1953; val_edge_recon_loss: 275338.3750; val_cond_contrastive_loss: 78433.8672; val_gene_expr_recon_loss: 111008.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470833.6875; val_optim_loss: 470833.6875
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9197; val_auprc_score: 0.9071; val_best_acc_score: 0.8421; val_best_f1_score: 0.8499; train_kl_reg_loss: 6180.5254; train_edge_recon_loss: 272289.7109; train_cond_contrastive_loss: 78769.1094; train_gene_expr_recon_loss: 109351.2637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466590.6172; train_optim_loss: 466590.6172; val_kl_reg_loss: 5927.3057; val_edge_recon_loss: 275077.9062; val_cond_contrastive_loss: 78434.4453; val_gene_expr_recon_loss: 110746.2344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470185.8750; val_optim_loss: 470185.8750
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9316; val_auprc_score: 0.9183; val_best_acc_score: 0.8566; val_best_f1_score: 0.8649; train_kl_reg_loss: 6049.6865; train_edge_recon_loss: 271412.6406; train_cond_contrastive_loss: 78741.7129; train_gene_expr_recon_loss: 109133.0547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465337.1016; train_optim_loss: 465337.1016; val_kl_reg_loss: 5945.6113; val_edge_recon_loss: 268062.4062; val_cond_contrastive_loss: 78433.6484; val_gene_expr_recon_loss: 110494.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462936.0938; val_optim_loss: 462936.0938
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9378; val_auprc_score: 0.9306; val_best_acc_score: 0.8630; val_best_f1_score: 0.8675; train_kl_reg_loss: 6125.4385; train_edge_recon_loss: 271127.5547; train_cond_contrastive_loss: 78686.4473; train_gene_expr_recon_loss: 109086.8242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465026.2734; train_optim_loss: 465026.2734; val_kl_reg_loss: 6064.4141; val_edge_recon_loss: 269275.1250; val_cond_contrastive_loss: 78428.9453; val_gene_expr_recon_loss: 110270.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464039.1562; val_optim_loss: 464039.1562
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9400; val_auprc_score: 0.9321; val_best_acc_score: 0.8697; val_best_f1_score: 0.8748; train_kl_reg_loss: 6248.5923; train_edge_recon_loss: 269217.5234; train_cond_contrastive_loss: 78644.0410; train_gene_expr_recon_loss: 108300.2227; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462410.3750; train_optim_loss: 462410.3750; val_kl_reg_loss: 6169.7012; val_edge_recon_loss: 269268.8750; val_cond_contrastive_loss: 78425.2422; val_gene_expr_recon_loss: 110095.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463959.6562; val_optim_loss: 463959.6562
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9388; val_auprc_score: 0.9292; val_best_acc_score: 0.8702; val_best_f1_score: 0.8744; train_kl_reg_loss: 6312.3679; train_edge_recon_loss: 269560.4375; train_cond_contrastive_loss: 78634.0312; train_gene_expr_recon_loss: 108418.6055; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462925.4453; train_optim_loss: 462925.4453; val_kl_reg_loss: 6150.0854; val_edge_recon_loss: 273862.0000; val_cond_contrastive_loss: 78422.4219; val_gene_expr_recon_loss: 109894.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468328.8750; val_optim_loss: 468328.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9449; val_auprc_score: 0.9368; val_best_acc_score: 0.8781; val_best_f1_score: 0.8831; train_kl_reg_loss: 6282.2319; train_edge_recon_loss: 268757.3438; train_cond_contrastive_loss: 78641.0215; train_gene_expr_recon_loss: 108527.2363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462207.8359; train_optim_loss: 462207.8359; val_kl_reg_loss: 6127.9600; val_edge_recon_loss: 268051.2812; val_cond_contrastive_loss: 78423.1953; val_gene_expr_recon_loss: 109861.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462464.2500; val_optim_loss: 462464.2500
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9398; val_auprc_score: 0.9264; val_best_acc_score: 0.8732; val_best_f1_score: 0.8776; train_kl_reg_loss: 6270.0358; train_edge_recon_loss: 268049.3125; train_cond_contrastive_loss: 78647.1133; train_gene_expr_recon_loss: 108850.9707; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461817.4375; train_optim_loss: 461817.4375; val_kl_reg_loss: 6113.1924; val_edge_recon_loss: 273882.5938; val_cond_contrastive_loss: 78422.0781; val_gene_expr_recon_loss: 109826.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468244.6875; val_optim_loss: 468244.6875
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9484; val_auprc_score: 0.9417; val_best_acc_score: 0.8814; val_best_f1_score: 0.8851; train_kl_reg_loss: 6263.9330; train_edge_recon_loss: 268521.9531; train_cond_contrastive_loss: 78649.5742; train_gene_expr_recon_loss: 108095.6738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461531.1172; train_optim_loss: 461531.1172; val_kl_reg_loss: 6089.2666; val_edge_recon_loss: 266165.1875; val_cond_contrastive_loss: 78423.6562; val_gene_expr_recon_loss: 109794.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460472.9062; val_optim_loss: 460472.9062
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9460; val_auprc_score: 0.9379; val_best_acc_score: 0.8778; val_best_f1_score: 0.8832; train_kl_reg_loss: 6224.9534; train_edge_recon_loss: 269696.9844; train_cond_contrastive_loss: 78654.8457; train_gene_expr_recon_loss: 108309.6387; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462886.4297; train_optim_loss: 462886.4297; val_kl_reg_loss: 6044.3174; val_edge_recon_loss: 270616.2812; val_cond_contrastive_loss: 78422.3594; val_gene_expr_recon_loss: 109764.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464847.4062; val_optim_loss: 464847.4062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9456; val_auprc_score: 0.9354; val_best_acc_score: 0.8786; val_best_f1_score: 0.8846; train_kl_reg_loss: 6174.9708; train_edge_recon_loss: 269390.9766; train_cond_contrastive_loss: 78661.6836; train_gene_expr_recon_loss: 108400.6973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462628.3203; train_optim_loss: 462628.3203; val_kl_reg_loss: 6026.0200; val_edge_recon_loss: 268395.7812; val_cond_contrastive_loss: 78422.8125; val_gene_expr_recon_loss: 109738.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462583.1250; val_optim_loss: 462583.1250
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9506; val_auprc_score: 0.9449; val_best_acc_score: 0.8821; val_best_f1_score: 0.8862; train_kl_reg_loss: 6172.2723; train_edge_recon_loss: 268598.1797; train_cond_contrastive_loss: 78667.5586; train_gene_expr_recon_loss: 108920.3672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462358.3672; train_optim_loss: 462358.3672; val_kl_reg_loss: 5999.7612; val_edge_recon_loss: 267652.6250; val_cond_contrastive_loss: 78426.2891; val_gene_expr_recon_loss: 109713.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461792.0000; val_optim_loss: 461792.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9466; val_auprc_score: 0.9405; val_best_acc_score: 0.8777; val_best_f1_score: 0.8844; train_kl_reg_loss: 6157.4419; train_edge_recon_loss: 269511.7188; train_cond_contrastive_loss: 78671.7598; train_gene_expr_recon_loss: 108117.7754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462458.6875; train_optim_loss: 462458.6875; val_kl_reg_loss: 5997.9199; val_edge_recon_loss: 267939.1250; val_cond_contrastive_loss: 78426.1406; val_gene_expr_recon_loss: 109710.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462073.8438; val_optim_loss: 462073.8438
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9465; val_auprc_score: 0.9324; val_best_acc_score: 0.8835; val_best_f1_score: 0.8861; train_kl_reg_loss: 6154.6927; train_edge_recon_loss: 269229.4141; train_cond_contrastive_loss: 78670.5977; train_gene_expr_recon_loss: 108355.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462410.6406; train_optim_loss: 462410.6406; val_kl_reg_loss: 5993.7891; val_edge_recon_loss: 269676.1875; val_cond_contrastive_loss: 78425.8750; val_gene_expr_recon_loss: 109707.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463803.5625; val_optim_loss: 463803.5625
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9466; val_auprc_score: 0.9370; val_best_acc_score: 0.8784; val_best_f1_score: 0.8836; train_kl_reg_loss: 6140.3563; train_edge_recon_loss: 269581.8203; train_cond_contrastive_loss: 78672.4375; train_gene_expr_recon_loss: 108010.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462405.3672; train_optim_loss: 462405.3672; val_kl_reg_loss: 5999.0181; val_edge_recon_loss: 268729.5312; val_cond_contrastive_loss: 78425.8594; val_gene_expr_recon_loss: 109704.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462859.0938; val_optim_loss: 462859.0938

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1 min 35 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
Val AUROC score: 0.9449
Val AUPRC score: 0.9316
Val best accuracy score: 0.8802
Val best F1 score: 0.8821
Val gene expr MSE score: 2.0094
Duration of model training in run 3: 0 hours, 1 minutes and 38 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57592
Number of validation edges: 6399
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7350; val_auprc_score: 0.7827; val_best_acc_score: 0.6761; val_best_f1_score: 0.6952; train_kl_reg_loss: 1957.2655; train_edge_recon_loss: 355411.1250; train_cond_contrastive_loss: 119981.4805; train_gene_expr_recon_loss: 139977.1523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 617327.0156; train_optim_loss: 617327.0156; val_kl_reg_loss: 5082.7451; val_edge_recon_loss: 399898.8125; val_cond_contrastive_loss: 78356.8438; val_gene_expr_recon_loss: 122808.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 606146.6250; val_optim_loss: 606146.6250
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7077; val_auprc_score: 0.7454; val_best_acc_score: 0.6360; val_best_f1_score: 0.6894; train_kl_reg_loss: 10017.7480; train_edge_recon_loss: 361679.0859; train_cond_contrastive_loss: 88232.2832; train_gene_expr_recon_loss: 122681.4961; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 582610.6094; train_optim_loss: 582610.6094; val_kl_reg_loss: 7794.9790; val_edge_recon_loss: 396645.4688; val_cond_contrastive_loss: 78371.1719; val_gene_expr_recon_loss: 116667.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 599478.9375; val_optim_loss: 599478.9375
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6881; val_auprc_score: 0.7238; val_best_acc_score: 0.6225; val_best_f1_score: 0.6896; train_kl_reg_loss: 6414.0057; train_edge_recon_loss: 358438.9297; train_cond_contrastive_loss: 88640.2324; train_gene_expr_recon_loss: 117110.7520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 570603.9219; train_optim_loss: 570603.9219; val_kl_reg_loss: 4753.6377; val_edge_recon_loss: 383468.3125; val_cond_contrastive_loss: 78423.7891; val_gene_expr_recon_loss: 115032.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 581678.1250; val_optim_loss: 581678.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.6814; val_auprc_score: 0.7204; val_best_acc_score: 0.6212; val_best_f1_score: 0.6834; train_kl_reg_loss: 4800.6968; train_edge_recon_loss: 350370.2734; train_cond_contrastive_loss: 88369.6641; train_gene_expr_recon_loss: 115736.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 559277.2344; train_optim_loss: 559277.2344; val_kl_reg_loss: 4474.1089; val_edge_recon_loss: 356276.3438; val_cond_contrastive_loss: 78534.3984; val_gene_expr_recon_loss: 114328.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 553613.8125; val_optim_loss: 553613.8125
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.6872; val_auprc_score: 0.7249; val_best_acc_score: 0.6342; val_best_f1_score: 0.6880; train_kl_reg_loss: 4164.1045; train_edge_recon_loss: 340504.7578; train_cond_contrastive_loss: 86785.5645; train_gene_expr_recon_loss: 114761.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 546215.7344; train_optim_loss: 546215.7344; val_kl_reg_loss: 3603.8984; val_edge_recon_loss: 342070.1875; val_cond_contrastive_loss: 78440.5078; val_gene_expr_recon_loss: 113852.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 537966.6875; val_optim_loss: 537966.6875
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.6867; val_auprc_score: 0.7265; val_best_acc_score: 0.6409; val_best_f1_score: 0.6820; train_kl_reg_loss: 3755.0577; train_edge_recon_loss: 328873.2891; train_cond_contrastive_loss: 84462.5605; train_gene_expr_recon_loss: 114640.7031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 531731.6094; train_optim_loss: 531731.6094; val_kl_reg_loss: 3990.4993; val_edge_recon_loss: 342089.8750; val_cond_contrastive_loss: 78389.8906; val_gene_expr_recon_loss: 113391.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 537861.3125; val_optim_loss: 537861.3125
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.7147; val_auprc_score: 0.7452; val_best_acc_score: 0.6572; val_best_f1_score: 0.6949; train_kl_reg_loss: 4234.9324; train_edge_recon_loss: 325374.3359; train_cond_contrastive_loss: 80119.5547; train_gene_expr_recon_loss: 114457.3789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 524186.2031; train_optim_loss: 524186.2031; val_kl_reg_loss: 4417.4629; val_edge_recon_loss: 331225.3125; val_cond_contrastive_loss: 78392.3672; val_gene_expr_recon_loss: 112866.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 526902.1250; val_optim_loss: 526902.1250
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.7677; val_auprc_score: 0.7780; val_best_acc_score: 0.6852; val_best_f1_score: 0.7246; train_kl_reg_loss: 4590.0784; train_edge_recon_loss: 313689.7500; train_cond_contrastive_loss: 79359.5938; train_gene_expr_recon_loss: 113593.7520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 511233.1719; train_optim_loss: 511233.1719; val_kl_reg_loss: 4752.9092; val_edge_recon_loss: 307848.3125; val_cond_contrastive_loss: 78408.6484; val_gene_expr_recon_loss: 112327.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 503337.1875; val_optim_loss: 503337.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8001; val_auprc_score: 0.7889; val_best_acc_score: 0.7179; val_best_f1_score: 0.7593; train_kl_reg_loss: 5040.6909; train_edge_recon_loss: 298474.9062; train_cond_contrastive_loss: 79126.1309; train_gene_expr_recon_loss: 112658.6250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495300.3594; train_optim_loss: 495300.3594; val_kl_reg_loss: 5425.9434; val_edge_recon_loss: 298943.1875; val_cond_contrastive_loss: 78426.0625; val_gene_expr_recon_loss: 111813.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494608.6250; val_optim_loss: 494608.6250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8353; val_auprc_score: 0.8180; val_best_acc_score: 0.7529; val_best_f1_score: 0.7897; train_kl_reg_loss: 5813.9448; train_edge_recon_loss: 289970.4219; train_cond_contrastive_loss: 78862.0020; train_gene_expr_recon_loss: 112076.1211; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486722.5000; train_optim_loss: 486722.5000; val_kl_reg_loss: 6181.9048; val_edge_recon_loss: 285555.0312; val_cond_contrastive_loss: 78423.3594; val_gene_expr_recon_loss: 111142.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481302.6562; val_optim_loss: 481302.6562
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8402; val_auprc_score: 0.8124; val_best_acc_score: 0.7632; val_best_f1_score: 0.7972; train_kl_reg_loss: 6483.3417; train_edge_recon_loss: 285256.6562; train_cond_contrastive_loss: 78771.2598; train_gene_expr_recon_loss: 112146.3203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482657.5781; train_optim_loss: 482657.5781; val_kl_reg_loss: 6505.0698; val_edge_recon_loss: 284024.0625; val_cond_contrastive_loss: 78410.3828; val_gene_expr_recon_loss: 110755.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479694.8750; val_optim_loss: 479694.8750
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8554; val_auprc_score: 0.8199; val_best_acc_score: 0.7835; val_best_f1_score: 0.8081; train_kl_reg_loss: 6619.8125; train_edge_recon_loss: 282565.7266; train_cond_contrastive_loss: 78871.4805; train_gene_expr_recon_loss: 111716.5645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479773.5859; train_optim_loss: 479773.5859; val_kl_reg_loss: 6513.9199; val_edge_recon_loss: 281653.8125; val_cond_contrastive_loss: 78402.1875; val_gene_expr_recon_loss: 110405.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476974.9375; val_optim_loss: 476974.9375
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8750; val_auprc_score: 0.8452; val_best_acc_score: 0.8086; val_best_f1_score: 0.8284; train_kl_reg_loss: 6626.1154; train_edge_recon_loss: 279741.5312; train_cond_contrastive_loss: 78962.6621; train_gene_expr_recon_loss: 111523.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476853.4375; train_optim_loss: 476853.4375; val_kl_reg_loss: 6585.8491; val_edge_recon_loss: 273521.0000; val_cond_contrastive_loss: 78407.0625; val_gene_expr_recon_loss: 110050.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468564.4375; val_optim_loss: 468564.4375
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8784; val_auprc_score: 0.8467; val_best_acc_score: 0.8145; val_best_f1_score: 0.8353; train_kl_reg_loss: 6742.4841; train_edge_recon_loss: 276744.4453; train_cond_contrastive_loss: 78945.4844; train_gene_expr_recon_loss: 110671.8965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 473104.3203; train_optim_loss: 473104.3203; val_kl_reg_loss: 6689.3550; val_edge_recon_loss: 277027.4688; val_cond_contrastive_loss: 78415.2188; val_gene_expr_recon_loss: 109688.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471820.8125; val_optim_loss: 471820.8125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8954; val_auprc_score: 0.8695; val_best_acc_score: 0.8338; val_best_f1_score: 0.8482; train_kl_reg_loss: 6837.5852; train_edge_recon_loss: 278791.9453; train_cond_contrastive_loss: 78883.8203; train_gene_expr_recon_loss: 110250.0039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474763.3516; train_optim_loss: 474763.3516; val_kl_reg_loss: 6574.3145; val_edge_recon_loss: 274918.7500; val_cond_contrastive_loss: 78423.7266; val_gene_expr_recon_loss: 109368.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 469285.0625; val_optim_loss: 469285.0625
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9001; val_auprc_score: 0.8730; val_best_acc_score: 0.8352; val_best_f1_score: 0.8518; train_kl_reg_loss: 6597.6372; train_edge_recon_loss: 274167.1484; train_cond_contrastive_loss: 78905.4551; train_gene_expr_recon_loss: 109911.7422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469581.9766; train_optim_loss: 469581.9766; val_kl_reg_loss: 6264.1396; val_edge_recon_loss: 272678.6562; val_cond_contrastive_loss: 78434.9766; val_gene_expr_recon_loss: 109131.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466509.5000; val_optim_loss: 466509.5000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9200; val_auprc_score: 0.9013; val_best_acc_score: 0.8459; val_best_f1_score: 0.8550; train_kl_reg_loss: 6364.9137; train_edge_recon_loss: 273081.6172; train_cond_contrastive_loss: 78805.8086; train_gene_expr_recon_loss: 109880.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468133.0859; train_optim_loss: 468133.0859; val_kl_reg_loss: 6146.4980; val_edge_recon_loss: 272322.0312; val_cond_contrastive_loss: 78443.3047; val_gene_expr_recon_loss: 108901.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465813.5000; val_optim_loss: 465813.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9226; val_auprc_score: 0.8998; val_best_acc_score: 0.8524; val_best_f1_score: 0.8606; train_kl_reg_loss: 6237.5374; train_edge_recon_loss: 273497.6641; train_cond_contrastive_loss: 78748.8672; train_gene_expr_recon_loss: 109610.5195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468094.5859; train_optim_loss: 468094.5859; val_kl_reg_loss: 5990.7437; val_edge_recon_loss: 270153.2188; val_cond_contrastive_loss: 78443.2891; val_gene_expr_recon_loss: 108693.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463280.4375; val_optim_loss: 463280.4375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9404; val_auprc_score: 0.9277; val_best_acc_score: 0.8729; val_best_f1_score: 0.8776; train_kl_reg_loss: 6198.6843; train_edge_recon_loss: 271820.4531; train_cond_contrastive_loss: 78701.2031; train_gene_expr_recon_loss: 109577.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466298.1094; train_optim_loss: 466298.1094; val_kl_reg_loss: 6128.9463; val_edge_recon_loss: 270389.9062; val_cond_contrastive_loss: 78442.5078; val_gene_expr_recon_loss: 108479.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463441.2812; val_optim_loss: 463441.2812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9355; val_auprc_score: 0.9197; val_best_acc_score: 0.8666; val_best_f1_score: 0.8748; train_kl_reg_loss: 6318.0947; train_edge_recon_loss: 270799.9297; train_cond_contrastive_loss: 78647.4219; train_gene_expr_recon_loss: 108573.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464339.4062; train_optim_loss: 464339.4062; val_kl_reg_loss: 6208.1030; val_edge_recon_loss: 267990.0938; val_cond_contrastive_loss: 78439.3438; val_gene_expr_recon_loss: 108276.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460914.0938; val_optim_loss: 460914.0938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9451; val_auprc_score: 0.9335; val_best_acc_score: 0.8751; val_best_f1_score: 0.8791; train_kl_reg_loss: 6417.0259; train_edge_recon_loss: 270686.9844; train_cond_contrastive_loss: 78624.2910; train_gene_expr_recon_loss: 108932.7129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464661.0234; train_optim_loss: 464661.0234; val_kl_reg_loss: 6209.5396; val_edge_recon_loss: 271570.5000; val_cond_contrastive_loss: 78434.1875; val_gene_expr_recon_loss: 108069.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464283.9375; val_optim_loss: 464283.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9481; val_auprc_score: 0.9364; val_best_acc_score: 0.8841; val_best_f1_score: 0.8893; train_kl_reg_loss: 6369.1016; train_edge_recon_loss: 270139.8906; train_cond_contrastive_loss: 78639.0137; train_gene_expr_recon_loss: 109296.0645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464444.0703; train_optim_loss: 464444.0703; val_kl_reg_loss: 6077.5376; val_edge_recon_loss: 266452.5938; val_cond_contrastive_loss: 78432.7812; val_gene_expr_recon_loss: 107887.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458850.7500; val_optim_loss: 458850.7500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9533; val_auprc_score: 0.9412; val_best_acc_score: 0.8889; val_best_f1_score: 0.8936; train_kl_reg_loss: 6221.0206; train_edge_recon_loss: 267993.5469; train_cond_contrastive_loss: 78666.3711; train_gene_expr_recon_loss: 108416.5859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461297.5156; train_optim_loss: 461297.5156; val_kl_reg_loss: 6012.4219; val_edge_recon_loss: 270184.7812; val_cond_contrastive_loss: 78433.8906; val_gene_expr_recon_loss: 107694.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462325.0938; val_optim_loss: 462325.0938
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9622; val_auprc_score: 0.9552; val_best_acc_score: 0.9027; val_best_f1_score: 0.9037; train_kl_reg_loss: 6167.3597; train_edge_recon_loss: 268449.3281; train_cond_contrastive_loss: 78675.5938; train_gene_expr_recon_loss: 108977.4980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462269.7734; train_optim_loss: 462269.7734; val_kl_reg_loss: 5948.7959; val_edge_recon_loss: 267017.2188; val_cond_contrastive_loss: 78435.3281; val_gene_expr_recon_loss: 107496.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458897.4688; val_optim_loss: 458897.4688
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9616; val_auprc_score: 0.9546; val_best_acc_score: 0.9018; val_best_f1_score: 0.9062; train_kl_reg_loss: 6054.4463; train_edge_recon_loss: 268613.2656; train_cond_contrastive_loss: 78700.1465; train_gene_expr_recon_loss: 107840.6348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461208.5000; train_optim_loss: 461208.5000; val_kl_reg_loss: 5790.1040; val_edge_recon_loss: 264576.1875; val_cond_contrastive_loss: 78444.6016; val_gene_expr_recon_loss: 107287.8828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456098.7500; val_optim_loss: 456098.7500
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9649; val_auprc_score: 0.9573; val_best_acc_score: 0.9107; val_best_f1_score: 0.9119; train_kl_reg_loss: 5917.9861; train_edge_recon_loss: 267436.3047; train_cond_contrastive_loss: 78738.1816; train_gene_expr_recon_loss: 107859.0391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459951.5078; train_optim_loss: 459951.5078; val_kl_reg_loss: 5725.7119; val_edge_recon_loss: 266476.6250; val_cond_contrastive_loss: 78447.4766; val_gene_expr_recon_loss: 107067.5156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457717.3125; val_optim_loss: 457717.3125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9688; val_auprc_score: 0.9622; val_best_acc_score: 0.9183; val_best_f1_score: 0.9201; train_kl_reg_loss: 5861.9960; train_edge_recon_loss: 268432.2422; train_cond_contrastive_loss: 78727.4688; train_gene_expr_recon_loss: 108026.6074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461048.3203; train_optim_loss: 461048.3203; val_kl_reg_loss: 5609.5625; val_edge_recon_loss: 265383.9688; val_cond_contrastive_loss: 78455.8438; val_gene_expr_recon_loss: 106868.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456317.4062; val_optim_loss: 456317.4062
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9738; val_auprc_score: 0.9694; val_best_acc_score: 0.9281; val_best_f1_score: 0.9300; train_kl_reg_loss: 5765.3422; train_edge_recon_loss: 266501.5781; train_cond_contrastive_loss: 78742.5293; train_gene_expr_recon_loss: 107225.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458234.7891; train_optim_loss: 458234.7891; val_kl_reg_loss: 5580.7090; val_edge_recon_loss: 262035.4531; val_cond_contrastive_loss: 78462.9609; val_gene_expr_recon_loss: 106668.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452747.1250; val_optim_loss: 452747.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9726; val_auprc_score: 0.9646; val_best_acc_score: 0.9244; val_best_f1_score: 0.9262; train_kl_reg_loss: 5718.8597; train_edge_recon_loss: 265846.4922; train_cond_contrastive_loss: 78752.7871; train_gene_expr_recon_loss: 107453.5566; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457771.6875; train_optim_loss: 457771.6875; val_kl_reg_loss: 5575.4932; val_edge_recon_loss: 263751.5625; val_cond_contrastive_loss: 78467.2500; val_gene_expr_recon_loss: 106474.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454269.2500; val_optim_loss: 454269.2500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9766; val_auprc_score: 0.9720; val_best_acc_score: 0.9272; val_best_f1_score: 0.9288; train_kl_reg_loss: 5739.3604; train_edge_recon_loss: 265049.7109; train_cond_contrastive_loss: 78779.1465; train_gene_expr_recon_loss: 106888.2051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456456.4375; train_optim_loss: 456456.4375; val_kl_reg_loss: 5642.4189; val_edge_recon_loss: 264755.3438; val_cond_contrastive_loss: 78465.0859; val_gene_expr_recon_loss: 106304.5703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455167.4062; val_optim_loss: 455167.4062
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9763; val_auprc_score: 0.9685; val_best_acc_score: 0.9320; val_best_f1_score: 0.9340; train_kl_reg_loss: 5788.0940; train_edge_recon_loss: 264003.7695; train_cond_contrastive_loss: 78759.6738; train_gene_expr_recon_loss: 106462.1074; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455013.6406; train_optim_loss: 455013.6406; val_kl_reg_loss: 5655.7930; val_edge_recon_loss: 262412.0625; val_cond_contrastive_loss: 78461.2656; val_gene_expr_recon_loss: 106114.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452643.6250; val_optim_loss: 452643.6250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9799; val_auprc_score: 0.9718; val_best_acc_score: 0.9348; val_best_f1_score: 0.9373; train_kl_reg_loss: 5815.5665; train_edge_recon_loss: 262528.6289; train_cond_contrastive_loss: 78769.2227; train_gene_expr_recon_loss: 106648.2109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453761.6484; train_optim_loss: 453761.6484; val_kl_reg_loss: 5644.1729; val_edge_recon_loss: 260532.0156; val_cond_contrastive_loss: 78454.3906; val_gene_expr_recon_loss: 105919.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450550.5312; val_optim_loss: 450550.5312
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9783; val_auprc_score: 0.9705; val_best_acc_score: 0.9356; val_best_f1_score: 0.9376; train_kl_reg_loss: 5825.5496; train_edge_recon_loss: 263333.6602; train_cond_contrastive_loss: 78779.0078; train_gene_expr_recon_loss: 106516.9688; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454455.1797; train_optim_loss: 454455.1797; val_kl_reg_loss: 5697.3135; val_edge_recon_loss: 261990.8438; val_cond_contrastive_loss: 78450.7266; val_gene_expr_recon_loss: 105691.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451829.9062; val_optim_loss: 451829.9062
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9826; val_auprc_score: 0.9774; val_best_acc_score: 0.9440; val_best_f1_score: 0.9454; train_kl_reg_loss: 5854.5653; train_edge_recon_loss: 262190.0898; train_cond_contrastive_loss: 78789.1875; train_gene_expr_recon_loss: 105889.0254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452722.8672; train_optim_loss: 452722.8672; val_kl_reg_loss: 5764.5596; val_edge_recon_loss: 262080.5469; val_cond_contrastive_loss: 78449.2812; val_gene_expr_recon_loss: 105452.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451747.3125; val_optim_loss: 451747.3125
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9840; val_auprc_score: 0.9809; val_best_acc_score: 0.9429; val_best_f1_score: 0.9442; train_kl_reg_loss: 5887.1716; train_edge_recon_loss: 261815.9062; train_cond_contrastive_loss: 78786.4219; train_gene_expr_recon_loss: 105433.8438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451923.3359; train_optim_loss: 451923.3359; val_kl_reg_loss: 5803.3193; val_edge_recon_loss: 262008.3750; val_cond_contrastive_loss: 78447.8984; val_gene_expr_recon_loss: 105199.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451459.4062; val_optim_loss: 451459.4062

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9832; val_auprc_score: 0.9794; val_best_acc_score: 0.9440; val_best_f1_score: 0.9456; train_kl_reg_loss: 5943.0729; train_edge_recon_loss: 262081.7617; train_cond_contrastive_loss: 78769.1543; train_gene_expr_recon_loss: 105792.8398; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452586.8438; train_optim_loss: 452586.8438; val_kl_reg_loss: 5772.7998; val_edge_recon_loss: 260517.1562; val_cond_contrastive_loss: 78448.0703; val_gene_expr_recon_loss: 105158.8281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449896.8750; val_optim_loss: 449896.8750
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9815; val_auprc_score: 0.9774; val_best_acc_score: 0.9441; val_best_f1_score: 0.9460; train_kl_reg_loss: 5898.6123; train_edge_recon_loss: 261621.5078; train_cond_contrastive_loss: 78786.6602; train_gene_expr_recon_loss: 105912.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452219.0156; train_optim_loss: 452219.0156; val_kl_reg_loss: 5747.6582; val_edge_recon_loss: 258995.8594; val_cond_contrastive_loss: 78447.0312; val_gene_expr_recon_loss: 105120.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448311.5000; val_optim_loss: 448311.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9834; val_auprc_score: 0.9785; val_best_acc_score: 0.9431; val_best_f1_score: 0.9445; train_kl_reg_loss: 5885.7338; train_edge_recon_loss: 261538.3477; train_cond_contrastive_loss: 78793.6328; train_gene_expr_recon_loss: 105106.3008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451324.0234; train_optim_loss: 451324.0234; val_kl_reg_loss: 5753.0596; val_edge_recon_loss: 262323.7812; val_cond_contrastive_loss: 78446.5078; val_gene_expr_recon_loss: 105079.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451602.5625; val_optim_loss: 451602.5625
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9823; val_auprc_score: 0.9776; val_best_acc_score: 0.9443; val_best_f1_score: 0.9458; train_kl_reg_loss: 5881.6188; train_edge_recon_loss: 261872.7695; train_cond_contrastive_loss: 78792.0625; train_gene_expr_recon_loss: 105148.2129; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451694.6719; train_optim_loss: 451694.6719; val_kl_reg_loss: 5757.9736; val_edge_recon_loss: 261273.0938; val_cond_contrastive_loss: 78446.6484; val_gene_expr_recon_loss: 105047.9297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450525.6562; val_optim_loss: 450525.6562
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9825; val_auprc_score: 0.9766; val_best_acc_score: 0.9414; val_best_f1_score: 0.9428; train_kl_reg_loss: 5880.5258; train_edge_recon_loss: 263461.3516; train_cond_contrastive_loss: 78784.5078; train_gene_expr_recon_loss: 105255.0371; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453381.4219; train_optim_loss: 453381.4219; val_kl_reg_loss: 5758.4399; val_edge_recon_loss: 264296.0312; val_cond_contrastive_loss: 78445.9766; val_gene_expr_recon_loss: 105016.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453516.9688; val_optim_loss: 453516.9688

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9822; val_auprc_score: 0.9754; val_best_acc_score: 0.9413; val_best_f1_score: 0.9428; train_kl_reg_loss: 5906.2007; train_edge_recon_loss: 260427.9531; train_cond_contrastive_loss: 78787.9316; train_gene_expr_recon_loss: 105659.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450781.9141; train_optim_loss: 450781.9141; val_kl_reg_loss: 5752.2256; val_edge_recon_loss: 261972.4844; val_cond_contrastive_loss: 78445.4141; val_gene_expr_recon_loss: 105013.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451183.5625; val_optim_loss: 451183.5625
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9852; val_auprc_score: 0.9813; val_best_acc_score: 0.9443; val_best_f1_score: 0.9457; train_kl_reg_loss: 5898.5756; train_edge_recon_loss: 261980.2305; train_cond_contrastive_loss: 78788.0137; train_gene_expr_recon_loss: 105477.1914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452144.0156; train_optim_loss: 452144.0156; val_kl_reg_loss: 5751.7695; val_edge_recon_loss: 259460.0000; val_cond_contrastive_loss: 78446.3125; val_gene_expr_recon_loss: 105010.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448668.3125; val_optim_loss: 448668.3125
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9847; val_auprc_score: 0.9820; val_best_acc_score: 0.9436; val_best_f1_score: 0.9448; train_kl_reg_loss: 5885.8201; train_edge_recon_loss: 259924.3555; train_cond_contrastive_loss: 78787.7637; train_gene_expr_recon_loss: 105687.8340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450285.7812; train_optim_loss: 450285.7812; val_kl_reg_loss: 5753.1221; val_edge_recon_loss: 261893.6875; val_cond_contrastive_loss: 78445.8906; val_gene_expr_recon_loss: 105006.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451099.5625; val_optim_loss: 451099.5625

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 19 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
Val AUROC score: 0.9833
Val AUPRC score: 0.9793
Val best accuracy score: 0.9450
Val best F1 score: 0.9460
Val gene expr MSE score: 1.7070
Duration of model training in run 4: 0 hours, 2 minutes and 22 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7419; val_auprc_score: 0.7809; val_best_acc_score: 0.6687; val_best_f1_score: 0.7023; train_kl_reg_loss: 5574.4078; train_edge_recon_loss: 356755.4583; train_cond_contrastive_loss: 104664.2956; train_gene_expr_recon_loss: 132906.7500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 599900.9062; train_optim_loss: 599900.9062; val_kl_reg_loss: 8630.5234; val_edge_recon_loss: 401483.8125; val_cond_contrastive_loss: 78339.8828; val_gene_expr_recon_loss: 118228.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 606682.5000; val_optim_loss: 606682.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.6939; val_auprc_score: 0.7201; val_best_acc_score: 0.6199; val_best_f1_score: 0.7014; train_kl_reg_loss: 6530.4893; train_edge_recon_loss: 356228.6510; train_cond_contrastive_loss: 88078.6055; train_gene_expr_recon_loss: 116976.4440; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567814.1771; train_optim_loss: 567814.1771; val_kl_reg_loss: 5352.0732; val_edge_recon_loss: 385051.1250; val_cond_contrastive_loss: 78369.5000; val_gene_expr_recon_loss: 114837.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 583610.2500; val_optim_loss: 583610.2500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.6893; val_auprc_score: 0.7176; val_best_acc_score: 0.6188; val_best_f1_score: 0.6991; train_kl_reg_loss: 4576.4004; train_edge_recon_loss: 348258.9115; train_cond_contrastive_loss: 87527.5938; train_gene_expr_recon_loss: 114971.7643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 555334.6667; train_optim_loss: 555334.6667; val_kl_reg_loss: 3382.2153; val_edge_recon_loss: 345001.2500; val_cond_contrastive_loss: 78395.3750; val_gene_expr_recon_loss: 113985.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 540764.5625; val_optim_loss: 540764.5625
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7031; val_auprc_score: 0.7350; val_best_acc_score: 0.6365; val_best_f1_score: 0.6979; train_kl_reg_loss: 3660.6946; train_edge_recon_loss: 329731.7240; train_cond_contrastive_loss: 85823.6966; train_gene_expr_recon_loss: 114055.0013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 533271.1146; train_optim_loss: 533271.1146; val_kl_reg_loss: 4219.7139; val_edge_recon_loss: 332335.4688; val_cond_contrastive_loss: 78354.5000; val_gene_expr_recon_loss: 113314.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 528224.2500; val_optim_loss: 528224.2500
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7178; val_auprc_score: 0.7485; val_best_acc_score: 0.6522; val_best_f1_score: 0.6981; train_kl_reg_loss: 4588.9955; train_edge_recon_loss: 323254.3073; train_cond_contrastive_loss: 80045.6836; train_gene_expr_recon_loss: 113287.6471; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 521176.6458; train_optim_loss: 521176.6458; val_kl_reg_loss: 4703.1543; val_edge_recon_loss: 329180.1875; val_cond_contrastive_loss: 78352.8125; val_gene_expr_recon_loss: 112641.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 524878.0625; val_optim_loss: 524878.0625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.7859; val_auprc_score: 0.7905; val_best_acc_score: 0.7015; val_best_f1_score: 0.7403; train_kl_reg_loss: 4633.9460; train_edge_recon_loss: 313507.1510; train_cond_contrastive_loss: 79534.9531; train_gene_expr_recon_loss: 112710.3047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 510386.3594; train_optim_loss: 510386.3594; val_kl_reg_loss: 4600.8662; val_edge_recon_loss: 299785.3750; val_cond_contrastive_loss: 78382.5156; val_gene_expr_recon_loss: 111892.4297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 494661.1875; val_optim_loss: 494661.1875
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8288; val_auprc_score: 0.8113; val_best_acc_score: 0.7550; val_best_f1_score: 0.7853; train_kl_reg_loss: 5061.7430; train_edge_recon_loss: 293098.4323; train_cond_contrastive_loss: 79243.2995; train_gene_expr_recon_loss: 111800.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 489203.7917; train_optim_loss: 489203.7917; val_kl_reg_loss: 5779.8223; val_edge_recon_loss: 286221.9688; val_cond_contrastive_loss: 78401.9688; val_gene_expr_recon_loss: 111155.9766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481559.7188; val_optim_loss: 481559.7188
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8415; val_auprc_score: 0.8207; val_best_acc_score: 0.7664; val_best_f1_score: 0.7944; train_kl_reg_loss: 6284.6893; train_edge_recon_loss: 284311.6979; train_cond_contrastive_loss: 78852.5078; train_gene_expr_recon_loss: 111166.2083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 480615.1042; train_optim_loss: 480615.1042; val_kl_reg_loss: 6619.4209; val_edge_recon_loss: 283874.6562; val_cond_contrastive_loss: 78384.3984; val_gene_expr_recon_loss: 110541.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479420.2188; val_optim_loss: 479420.2188
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8550; val_auprc_score: 0.8261; val_best_acc_score: 0.7814; val_best_f1_score: 0.8063; train_kl_reg_loss: 6585.9486; train_edge_recon_loss: 282321.2552; train_cond_contrastive_loss: 78806.7135; train_gene_expr_recon_loss: 110506.3177; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478220.2292; train_optim_loss: 478220.2292; val_kl_reg_loss: 6185.6841; val_edge_recon_loss: 277998.5625; val_cond_contrastive_loss: 78378.6484; val_gene_expr_recon_loss: 110011.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472574.3750; val_optim_loss: 472574.3750
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8654; val_auprc_score: 0.8425; val_best_acc_score: 0.7923; val_best_f1_score: 0.8154; train_kl_reg_loss: 6102.0793; train_edge_recon_loss: 280855.4635; train_cond_contrastive_loss: 78960.9232; train_gene_expr_recon_loss: 110093.0951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476011.5573; train_optim_loss: 476011.5573; val_kl_reg_loss: 5902.8652; val_edge_recon_loss: 276575.5938; val_cond_contrastive_loss: 78385.0234; val_gene_expr_recon_loss: 109573.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 470437.1250; val_optim_loss: 470437.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8865; val_auprc_score: 0.8614; val_best_acc_score: 0.8191; val_best_f1_score: 0.8376; train_kl_reg_loss: 6074.4849; train_edge_recon_loss: 276603.6615; train_cond_contrastive_loss: 78907.1250; train_gene_expr_recon_loss: 109605.2852; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471190.5573; train_optim_loss: 471190.5573; val_kl_reg_loss: 6117.3120; val_edge_recon_loss: 273228.4375; val_cond_contrastive_loss: 78397.5938; val_gene_expr_recon_loss: 109169.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466912.6562; val_optim_loss: 466912.6562
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8960; val_auprc_score: 0.8742; val_best_acc_score: 0.8270; val_best_f1_score: 0.8457; train_kl_reg_loss: 6243.7143; train_edge_recon_loss: 274943.6250; train_cond_contrastive_loss: 78818.8620; train_gene_expr_recon_loss: 109304.4727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469310.6875; train_optim_loss: 469310.6875; val_kl_reg_loss: 6074.0000; val_edge_recon_loss: 275142.6562; val_cond_contrastive_loss: 78415.9844; val_gene_expr_recon_loss: 108739.6641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468372.2812; val_optim_loss: 468372.2812
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9265; val_auprc_score: 0.9116; val_best_acc_score: 0.8541; val_best_f1_score: 0.8621; train_kl_reg_loss: 6016.3122; train_edge_recon_loss: 271693.8958; train_cond_contrastive_loss: 78894.8672; train_gene_expr_recon_loss: 108618.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465224.0729; train_optim_loss: 465224.0729; val_kl_reg_loss: 5798.3999; val_edge_recon_loss: 267644.1562; val_cond_contrastive_loss: 78428.6953; val_gene_expr_recon_loss: 108370.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460242.2188; val_optim_loss: 460242.2188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9378; val_auprc_score: 0.9236; val_best_acc_score: 0.8677; val_best_f1_score: 0.8742; train_kl_reg_loss: 5925.9126; train_edge_recon_loss: 269708.6094; train_cond_contrastive_loss: 78981.7930; train_gene_expr_recon_loss: 108468.2266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463084.5521; train_optim_loss: 463084.5521; val_kl_reg_loss: 5982.2505; val_edge_recon_loss: 269309.8438; val_cond_contrastive_loss: 78431.2266; val_gene_expr_recon_loss: 107966.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461689.8125; val_optim_loss: 461689.8125
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9511; val_auprc_score: 0.9422; val_best_acc_score: 0.8846; val_best_f1_score: 0.8896; train_kl_reg_loss: 6140.8973; train_edge_recon_loss: 269288.3021; train_cond_contrastive_loss: 78870.8646; train_gene_expr_recon_loss: 107950.8073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462250.8594; train_optim_loss: 462250.8594; val_kl_reg_loss: 6109.7441; val_edge_recon_loss: 267472.9375; val_cond_contrastive_loss: 78428.2656; val_gene_expr_recon_loss: 107582.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459593.7188; val_optim_loss: 459593.7188
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9529; val_auprc_score: 0.9381; val_best_acc_score: 0.8947; val_best_f1_score: 0.8967; train_kl_reg_loss: 6129.8295; train_edge_recon_loss: 267290.0104; train_cond_contrastive_loss: 78800.9557; train_gene_expr_recon_loss: 107658.4154; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459879.2135; train_optim_loss: 459879.2135; val_kl_reg_loss: 5951.9189; val_edge_recon_loss: 270499.2500; val_cond_contrastive_loss: 78423.4688; val_gene_expr_recon_loss: 107211.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462085.8438; val_optim_loss: 462085.8438
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9629; val_auprc_score: 0.9549; val_best_acc_score: 0.9087; val_best_f1_score: 0.9118; train_kl_reg_loss: 6031.3385; train_edge_recon_loss: 266350.6354; train_cond_contrastive_loss: 78743.6224; train_gene_expr_recon_loss: 107430.1068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458555.6979; train_optim_loss: 458555.6979; val_kl_reg_loss: 5914.9072; val_edge_recon_loss: 266575.4688; val_cond_contrastive_loss: 78421.8828; val_gene_expr_recon_loss: 106837.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457749.8125; val_optim_loss: 457749.8125
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9685; val_auprc_score: 0.9617; val_best_acc_score: 0.9210; val_best_f1_score: 0.9225; train_kl_reg_loss: 6031.3662; train_edge_recon_loss: 267253.1979; train_cond_contrastive_loss: 78701.6003; train_gene_expr_recon_loss: 106735.5911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458721.7604; train_optim_loss: 458721.7604; val_kl_reg_loss: 5915.9810; val_edge_recon_loss: 265133.3750; val_cond_contrastive_loss: 78420.5391; val_gene_expr_recon_loss: 106439.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455909.6875; val_optim_loss: 455909.6875
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9756; val_auprc_score: 0.9713; val_best_acc_score: 0.9300; val_best_f1_score: 0.9308; train_kl_reg_loss: 5940.6132; train_edge_recon_loss: 266133.5365; train_cond_contrastive_loss: 78703.4727; train_gene_expr_recon_loss: 106486.1341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457263.7552; train_optim_loss: 457263.7552; val_kl_reg_loss: 5844.3574; val_edge_recon_loss: 264630.0625; val_cond_contrastive_loss: 78419.8984; val_gene_expr_recon_loss: 106065.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454960.1875; val_optim_loss: 454960.1875
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9764; val_auprc_score: 0.9691; val_best_acc_score: 0.9320; val_best_f1_score: 0.9331; train_kl_reg_loss: 5963.6073; train_edge_recon_loss: 263535.5078; train_cond_contrastive_loss: 78711.0560; train_gene_expr_recon_loss: 106034.8477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454245.0104; train_optim_loss: 454245.0104; val_kl_reg_loss: 5877.1787; val_edge_recon_loss: 264317.2500; val_cond_contrastive_loss: 78420.0078; val_gene_expr_recon_loss: 105711.5312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454325.9688; val_optim_loss: 454325.9688
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9801; val_auprc_score: 0.9750; val_best_acc_score: 0.9385; val_best_f1_score: 0.9401; train_kl_reg_loss: 5899.3760; train_edge_recon_loss: 262349.6979; train_cond_contrastive_loss: 78735.6901; train_gene_expr_recon_loss: 105718.0456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452702.8021; train_optim_loss: 452702.8021; val_kl_reg_loss: 5822.7622; val_edge_recon_loss: 262788.2812; val_cond_contrastive_loss: 78418.1172; val_gene_expr_recon_loss: 105423.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452452.9375; val_optim_loss: 452452.9375
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9819; val_auprc_score: 0.9773; val_best_acc_score: 0.9400; val_best_f1_score: 0.9420; train_kl_reg_loss: 5945.9421; train_edge_recon_loss: 263027.2969; train_cond_contrastive_loss: 78732.9661; train_gene_expr_recon_loss: 105472.6745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453178.8750; train_optim_loss: 453178.8750; val_kl_reg_loss: 5936.1333; val_edge_recon_loss: 260936.7656; val_cond_contrastive_loss: 78416.3984; val_gene_expr_recon_loss: 105141.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450430.4688; val_optim_loss: 450430.4688
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9846; val_auprc_score: 0.9793; val_best_acc_score: 0.9447; val_best_f1_score: 0.9462; train_kl_reg_loss: 5962.9635; train_edge_recon_loss: 262913.6120; train_cond_contrastive_loss: 78742.4154; train_gene_expr_recon_loss: 105147.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452766.9219; train_optim_loss: 452766.9219; val_kl_reg_loss: 5838.3774; val_edge_recon_loss: 260607.9219; val_cond_contrastive_loss: 78417.0234; val_gene_expr_recon_loss: 104855.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449719.0312; val_optim_loss: 449719.0312
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9845; val_auprc_score: 0.9791; val_best_acc_score: 0.9486; val_best_f1_score: 0.9502; train_kl_reg_loss: 5915.0633; train_edge_recon_loss: 262205.6589; train_cond_contrastive_loss: 78759.0417; train_gene_expr_recon_loss: 105003.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451883.6406; train_optim_loss: 451883.6406; val_kl_reg_loss: 5896.5820; val_edge_recon_loss: 257574.4375; val_cond_contrastive_loss: 78418.3516; val_gene_expr_recon_loss: 104556.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446445.8125; val_optim_loss: 446445.8125
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9853; val_auprc_score: 0.9804; val_best_acc_score: 0.9477; val_best_f1_score: 0.9494; train_kl_reg_loss: 5957.4004; train_edge_recon_loss: 260998.9557; train_cond_contrastive_loss: 78748.6680; train_gene_expr_recon_loss: 104760.6875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450465.7031; train_optim_loss: 450465.7031; val_kl_reg_loss: 5862.0635; val_edge_recon_loss: 259829.0781; val_cond_contrastive_loss: 78416.6641; val_gene_expr_recon_loss: 104287.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448395.5625; val_optim_loss: 448395.5625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9867; val_auprc_score: 0.9826; val_best_acc_score: 0.9518; val_best_f1_score: 0.9526; train_kl_reg_loss: 5921.4184; train_edge_recon_loss: 260866.0573; train_cond_contrastive_loss: 78768.0508; train_gene_expr_recon_loss: 104520.0273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450075.5573; train_optim_loss: 450075.5573; val_kl_reg_loss: 5842.8047; val_edge_recon_loss: 259793.6406; val_cond_contrastive_loss: 78416.2031; val_gene_expr_recon_loss: 103977.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448030.0625; val_optim_loss: 448030.0625
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9862; val_auprc_score: 0.9809; val_best_acc_score: 0.9492; val_best_f1_score: 0.9502; train_kl_reg_loss: 5916.8789; train_edge_recon_loss: 261858.2995; train_cond_contrastive_loss: 78764.0365; train_gene_expr_recon_loss: 104135.1367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450674.3490; train_optim_loss: 450674.3490; val_kl_reg_loss: 5862.6006; val_edge_recon_loss: 261249.7812; val_cond_contrastive_loss: 78416.2656; val_gene_expr_recon_loss: 103706.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449235.1875; val_optim_loss: 449235.1875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9857; val_auprc_score: 0.9818; val_best_acc_score: 0.9506; val_best_f1_score: 0.9515; train_kl_reg_loss: 5925.6906; train_edge_recon_loss: 259666.7786; train_cond_contrastive_loss: 78761.5000; train_gene_expr_recon_loss: 103928.6706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448282.6406; train_optim_loss: 448282.6406; val_kl_reg_loss: 5831.2510; val_edge_recon_loss: 260417.4844; val_cond_contrastive_loss: 78416.3984; val_gene_expr_recon_loss: 103682.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448347.4375; val_optim_loss: 448347.4375
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9856; val_auprc_score: 0.9819; val_best_acc_score: 0.9511; val_best_f1_score: 0.9523; train_kl_reg_loss: 5895.4517; train_edge_recon_loss: 262041.4609; train_cond_contrastive_loss: 78767.5898; train_gene_expr_recon_loss: 103921.3164; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450625.8125; train_optim_loss: 450625.8125; val_kl_reg_loss: 5817.1348; val_edge_recon_loss: 257150.5938; val_cond_contrastive_loss: 78416.8672; val_gene_expr_recon_loss: 103650.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445035.2500; val_optim_loss: 445035.2500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9847; val_auprc_score: 0.9786; val_best_acc_score: 0.9499; val_best_f1_score: 0.9509; train_kl_reg_loss: 5887.9403; train_edge_recon_loss: 260487.3854; train_cond_contrastive_loss: 78767.0534; train_gene_expr_recon_loss: 103988.0234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449130.4010; train_optim_loss: 449130.4010; val_kl_reg_loss: 5812.4814; val_edge_recon_loss: 261726.3125; val_cond_contrastive_loss: 78416.3750; val_gene_expr_recon_loss: 103623.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449578.1875; val_optim_loss: 449578.1875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9868; val_auprc_score: 0.9821; val_best_acc_score: 0.9511; val_best_f1_score: 0.9524; train_kl_reg_loss: 5879.9001; train_edge_recon_loss: 260154.7552; train_cond_contrastive_loss: 78767.4271; train_gene_expr_recon_loss: 103664.8372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448466.9167; train_optim_loss: 448466.9167; val_kl_reg_loss: 5798.6104; val_edge_recon_loss: 257122.0156; val_cond_contrastive_loss: 78417.1484; val_gene_expr_recon_loss: 103605.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444943.3125; val_optim_loss: 444943.3125
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9877; val_auprc_score: 0.9837; val_best_acc_score: 0.9532; val_best_f1_score: 0.9542; train_kl_reg_loss: 5874.5706; train_edge_recon_loss: 262040.2448; train_cond_contrastive_loss: 78770.7708; train_gene_expr_recon_loss: 103734.5404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450420.1302; train_optim_loss: 450420.1302; val_kl_reg_loss: 5805.9429; val_edge_recon_loss: 258837.7344; val_cond_contrastive_loss: 78416.9297; val_gene_expr_recon_loss: 103576.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446637.4375; val_optim_loss: 446637.4375
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9854; val_auprc_score: 0.9821; val_best_acc_score: 0.9485; val_best_f1_score: 0.9501; train_kl_reg_loss: 5880.7798; train_edge_recon_loss: 260403.7578; train_cond_contrastive_loss: 78764.3451; train_gene_expr_recon_loss: 103813.7812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448862.6667; train_optim_loss: 448862.6667; val_kl_reg_loss: 5809.5381; val_edge_recon_loss: 259753.5312; val_cond_contrastive_loss: 78416.8281; val_gene_expr_recon_loss: 103549.5234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447529.4062; val_optim_loss: 447529.4062
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9850; val_auprc_score: 0.9794; val_best_acc_score: 0.9479; val_best_f1_score: 0.9494; train_kl_reg_loss: 5880.0934; train_edge_recon_loss: 259919.6615; train_cond_contrastive_loss: 78757.7096; train_gene_expr_recon_loss: 103919.8854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448477.3385; train_optim_loss: 448477.3385; val_kl_reg_loss: 5805.1045; val_edge_recon_loss: 261962.1406; val_cond_contrastive_loss: 78416.8594; val_gene_expr_recon_loss: 103526.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449710.6250; val_optim_loss: 449710.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9874; val_auprc_score: 0.9845; val_best_acc_score: 0.9523; val_best_f1_score: 0.9530; train_kl_reg_loss: 5876.6114; train_edge_recon_loss: 260852.0938; train_cond_contrastive_loss: 78756.2305; train_gene_expr_recon_loss: 103745.5013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449230.4323; train_optim_loss: 449230.4323; val_kl_reg_loss: 5805.4180; val_edge_recon_loss: 259575.5156; val_cond_contrastive_loss: 78416.7031; val_gene_expr_recon_loss: 103523.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447321.3125; val_optim_loss: 447321.3125
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9864; val_auprc_score: 0.9802; val_best_acc_score: 0.9530; val_best_f1_score: 0.9542; train_kl_reg_loss: 5877.2655; train_edge_recon_loss: 260027.7943; train_cond_contrastive_loss: 78758.2995; train_gene_expr_recon_loss: 103627.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448290.6510; train_optim_loss: 448290.6510; val_kl_reg_loss: 5803.6270; val_edge_recon_loss: 258350.4844; val_cond_contrastive_loss: 78417.2422; val_gene_expr_recon_loss: 103520.5938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446091.9688; val_optim_loss: 446091.9688
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9858; val_auprc_score: 0.9812; val_best_acc_score: 0.9497; val_best_f1_score: 0.9508; train_kl_reg_loss: 5874.6581; train_edge_recon_loss: 260173.0755; train_cond_contrastive_loss: 78758.3138; train_gene_expr_recon_loss: 103702.4297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448508.4740; train_optim_loss: 448508.4740; val_kl_reg_loss: 5802.1519; val_edge_recon_loss: 259630.5625; val_cond_contrastive_loss: 78416.9297; val_gene_expr_recon_loss: 103517.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447367.3750; val_optim_loss: 447367.3750

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 54 sec.
Using best model state, which was in epoch 31.

--- MODEL EVALUATION ---
Val AUROC score: 0.9864
Val AUPRC score: 0.9821
Val best accuracy score: 0.9485
Val best F1 score: 0.9502
Val gene expr MSE score: 1.6369
Duration of model training in run 5: 0 hours, 2 minutes and 58 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 85191
Number of validation edges: 9465
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7577; val_auprc_score: 0.7928; val_best_acc_score: 0.6793; val_best_f1_score: 0.7015; train_kl_reg_loss: 5496.2131; train_edge_recon_loss: 355152.7969; train_cond_contrastive_loss: 106881.2773; train_gene_expr_recon_loss: 132072.4245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 599602.7188; train_optim_loss: 599602.7188; val_kl_reg_loss: 10081.5781; val_edge_recon_loss: 403799.2188; val_cond_contrastive_loss: 78338.8516; val_gene_expr_recon_loss: 118174.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 610393.7500; val_optim_loss: 610393.7500
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7214; val_auprc_score: 0.7491; val_best_acc_score: 0.6410; val_best_f1_score: 0.7031; train_kl_reg_loss: 7368.9764; train_edge_recon_loss: 357103.6406; train_cond_contrastive_loss: 85709.2852; train_gene_expr_recon_loss: 117147.4492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567329.3438; train_optim_loss: 567329.3438; val_kl_reg_loss: 5468.0933; val_edge_recon_loss: 385202.1250; val_cond_contrastive_loss: 78376.4766; val_gene_expr_recon_loss: 115594.0703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 584640.7500; val_optim_loss: 584640.7500
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7087; val_auprc_score: 0.7320; val_best_acc_score: 0.6347; val_best_f1_score: 0.6944; train_kl_reg_loss: 4892.4844; train_edge_recon_loss: 345418.8646; train_cond_contrastive_loss: 87914.4336; train_gene_expr_recon_loss: 115454.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 553679.9375; train_optim_loss: 553679.9375; val_kl_reg_loss: 3805.7173; val_edge_recon_loss: 350238.7500; val_cond_contrastive_loss: 78421.2344; val_gene_expr_recon_loss: 114834.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 547299.8750; val_optim_loss: 547299.8750
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7170; val_auprc_score: 0.7437; val_best_acc_score: 0.6579; val_best_f1_score: 0.6903; train_kl_reg_loss: 4071.0488; train_edge_recon_loss: 325092.8177; train_cond_contrastive_loss: 85010.4466; train_gene_expr_recon_loss: 114694.8516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 528869.1771; train_optim_loss: 528869.1771; val_kl_reg_loss: 4639.1641; val_edge_recon_loss: 334928.4375; val_cond_contrastive_loss: 78370.0156; val_gene_expr_recon_loss: 114190.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 532127.9375; val_optim_loss: 532127.9375
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7615; val_auprc_score: 0.7730; val_best_acc_score: 0.6856; val_best_f1_score: 0.7176; train_kl_reg_loss: 4999.1806; train_edge_recon_loss: 317573.9792; train_cond_contrastive_loss: 79571.2383; train_gene_expr_recon_loss: 114019.2305; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 516163.6198; train_optim_loss: 516163.6198; val_kl_reg_loss: 5257.3145; val_edge_recon_loss: 313822.5938; val_cond_contrastive_loss: 78375.4297; val_gene_expr_recon_loss: 113488.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 510943.5312; val_optim_loss: 510943.5312
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8200; val_auprc_score: 0.8104; val_best_acc_score: 0.7319; val_best_f1_score: 0.7677; train_kl_reg_loss: 5525.8580; train_edge_recon_loss: 297848.6302; train_cond_contrastive_loss: 79060.1042; train_gene_expr_recon_loss: 113170.5690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 495605.1615; train_optim_loss: 495605.1615; val_kl_reg_loss: 5871.4590; val_edge_recon_loss: 294842.7500; val_cond_contrastive_loss: 78403.2812; val_gene_expr_recon_loss: 112706.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 491824.1562; val_optim_loss: 491824.1562
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8489; val_auprc_score: 0.8312; val_best_acc_score: 0.7679; val_best_f1_score: 0.7947; train_kl_reg_loss: 6220.9570; train_edge_recon_loss: 283629.5417; train_cond_contrastive_loss: 78889.5299; train_gene_expr_recon_loss: 112425.6797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481165.7135; train_optim_loss: 481165.7135; val_kl_reg_loss: 6452.2769; val_edge_recon_loss: 285025.6250; val_cond_contrastive_loss: 78399.0469; val_gene_expr_recon_loss: 112029.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481906.0938; val_optim_loss: 481906.0938
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8623; val_auprc_score: 0.8372; val_best_acc_score: 0.7902; val_best_f1_score: 0.8102; train_kl_reg_loss: 6581.6093; train_edge_recon_loss: 280852.5781; train_cond_contrastive_loss: 78866.0326; train_gene_expr_recon_loss: 111830.8503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478131.0677; train_optim_loss: 478131.0677; val_kl_reg_loss: 6420.4170; val_edge_recon_loss: 280079.9375; val_cond_contrastive_loss: 78393.5000; val_gene_expr_recon_loss: 111458.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476352.0000; val_optim_loss: 476352.0000
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8806; val_auprc_score: 0.8533; val_best_acc_score: 0.8113; val_best_f1_score: 0.8297; train_kl_reg_loss: 6456.7948; train_edge_recon_loss: 279048.8385; train_cond_contrastive_loss: 78927.1706; train_gene_expr_recon_loss: 111439.9857; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 475872.7969; train_optim_loss: 475872.7969; val_kl_reg_loss: 6283.3711; val_edge_recon_loss: 277272.7500; val_cond_contrastive_loss: 78395.9844; val_gene_expr_recon_loss: 110983.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472935.2188; val_optim_loss: 472935.2188
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8974; val_auprc_score: 0.8702; val_best_acc_score: 0.8265; val_best_f1_score: 0.8418; train_kl_reg_loss: 6425.6790; train_edge_recon_loss: 275302.8021; train_cond_contrastive_loss: 78913.8620; train_gene_expr_recon_loss: 110850.9401; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 471493.3021; train_optim_loss: 471493.3021; val_kl_reg_loss: 6327.0566; val_edge_recon_loss: 277756.3750; val_cond_contrastive_loss: 78409.5547; val_gene_expr_recon_loss: 110482.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472975.7812; val_optim_loss: 472975.7812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9092; val_auprc_score: 0.8915; val_best_acc_score: 0.8381; val_best_f1_score: 0.8529; train_kl_reg_loss: 6348.0173; train_edge_recon_loss: 272734.4583; train_cond_contrastive_loss: 78935.9635; train_gene_expr_recon_loss: 110439.9336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468458.3750; train_optim_loss: 468458.3750; val_kl_reg_loss: 6110.8574; val_edge_recon_loss: 273549.3750; val_cond_contrastive_loss: 78423.8203; val_gene_expr_recon_loss: 110137.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468221.7188; val_optim_loss: 468221.7188
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9304; val_auprc_score: 0.9152; val_best_acc_score: 0.8561; val_best_f1_score: 0.8634; train_kl_reg_loss: 6172.4600; train_edge_recon_loss: 271669.6406; train_cond_contrastive_loss: 78971.7669; train_gene_expr_recon_loss: 110040.3411; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466854.2031; train_optim_loss: 466854.2031; val_kl_reg_loss: 6100.1221; val_edge_recon_loss: 272395.8438; val_cond_contrastive_loss: 78431.9453; val_gene_expr_recon_loss: 109855.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466783.5000; val_optim_loss: 466783.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9380; val_auprc_score: 0.9251; val_best_acc_score: 0.8717; val_best_f1_score: 0.8772; train_kl_reg_loss: 6209.0699; train_edge_recon_loss: 269662.8281; train_cond_contrastive_loss: 78914.9401; train_gene_expr_recon_loss: 109637.7292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464424.5521; train_optim_loss: 464424.5521; val_kl_reg_loss: 6138.3496; val_edge_recon_loss: 272771.8125; val_cond_contrastive_loss: 78431.0156; val_gene_expr_recon_loss: 109593.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466934.2188; val_optim_loss: 466934.2188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9442; val_auprc_score: 0.9305; val_best_acc_score: 0.8810; val_best_f1_score: 0.8878; train_kl_reg_loss: 6195.2655; train_edge_recon_loss: 269775.7292; train_cond_contrastive_loss: 78831.2070; train_gene_expr_recon_loss: 109469.8789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464272.0781; train_optim_loss: 464272.0781; val_kl_reg_loss: 6083.2119; val_edge_recon_loss: 269326.5312; val_cond_contrastive_loss: 78426.4844; val_gene_expr_recon_loss: 109302.9609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 463139.2188; val_optim_loss: 463139.2188
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9495; val_auprc_score: 0.9377; val_best_acc_score: 0.8886; val_best_f1_score: 0.8944; train_kl_reg_loss: 6136.6716; train_edge_recon_loss: 268855.5573; train_cond_contrastive_loss: 78777.9674; train_gene_expr_recon_loss: 109203.3698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462973.5677; train_optim_loss: 462973.5677; val_kl_reg_loss: 6053.9404; val_edge_recon_loss: 268392.8750; val_cond_contrastive_loss: 78425.1875; val_gene_expr_recon_loss: 108966.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461838.0000; val_optim_loss: 461838.0000
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9571; val_auprc_score: 0.9478; val_best_acc_score: 0.8989; val_best_f1_score: 0.9027; train_kl_reg_loss: 6053.4104; train_edge_recon_loss: 269382.7344; train_cond_contrastive_loss: 78715.9596; train_gene_expr_recon_loss: 108846.9232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462999.0208; train_optim_loss: 462999.0208; val_kl_reg_loss: 5924.8037; val_edge_recon_loss: 269325.6875; val_cond_contrastive_loss: 78427.7500; val_gene_expr_recon_loss: 108649.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462327.7500; val_optim_loss: 462327.7500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9662; val_auprc_score: 0.9576; val_best_acc_score: 0.9133; val_best_f1_score: 0.9151; train_kl_reg_loss: 5934.9098; train_edge_recon_loss: 267353.9844; train_cond_contrastive_loss: 78719.1393; train_gene_expr_recon_loss: 108457.6901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460465.7188; train_optim_loss: 460465.7188; val_kl_reg_loss: 5861.5820; val_edge_recon_loss: 267603.0000; val_cond_contrastive_loss: 78431.4922; val_gene_expr_recon_loss: 108270.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460166.5000; val_optim_loss: 460166.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9747; val_auprc_score: 0.9680; val_best_acc_score: 0.9268; val_best_f1_score: 0.9283; train_kl_reg_loss: 5888.2767; train_edge_recon_loss: 265259.5573; train_cond_contrastive_loss: 78727.0495; train_gene_expr_recon_loss: 108021.9766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457896.8646; train_optim_loss: 457896.8646; val_kl_reg_loss: 5774.3564; val_edge_recon_loss: 265819.5625; val_cond_contrastive_loss: 78435.7891; val_gene_expr_recon_loss: 107914.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457944.0625; val_optim_loss: 457944.0625
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9774; val_auprc_score: 0.9721; val_best_acc_score: 0.9317; val_best_f1_score: 0.9334; train_kl_reg_loss: 5830.5029; train_edge_recon_loss: 266056.7292; train_cond_contrastive_loss: 78738.9857; train_gene_expr_recon_loss: 107792.3542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458418.5833; train_optim_loss: 458418.5833; val_kl_reg_loss: 5735.2939; val_edge_recon_loss: 264122.8125; val_cond_contrastive_loss: 78433.6953; val_gene_expr_recon_loss: 107621.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455913.0625; val_optim_loss: 455913.0625
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9776; val_auprc_score: 0.9716; val_best_acc_score: 0.9315; val_best_f1_score: 0.9324; train_kl_reg_loss: 5836.8643; train_edge_recon_loss: 262832.6693; train_cond_contrastive_loss: 78744.8464; train_gene_expr_recon_loss: 107620.2487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455034.6354; train_optim_loss: 455034.6354; val_kl_reg_loss: 5813.3555; val_edge_recon_loss: 266634.6875; val_cond_contrastive_loss: 78426.9922; val_gene_expr_recon_loss: 107331.5625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458206.5938; val_optim_loss: 458206.5938
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9810; val_auprc_score: 0.9767; val_best_acc_score: 0.9372; val_best_f1_score: 0.9391; train_kl_reg_loss: 5914.4560; train_edge_recon_loss: 262349.4505; train_cond_contrastive_loss: 78745.9583; train_gene_expr_recon_loss: 107242.8385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454252.7135; train_optim_loss: 454252.7135; val_kl_reg_loss: 5774.7021; val_edge_recon_loss: 262418.9062; val_cond_contrastive_loss: 78418.2969; val_gene_expr_recon_loss: 107056.7266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453668.5938; val_optim_loss: 453668.5938
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9821; val_auprc_score: 0.9760; val_best_acc_score: 0.9382; val_best_f1_score: 0.9394; train_kl_reg_loss: 5870.6140; train_edge_recon_loss: 261842.5312; train_cond_contrastive_loss: 78773.6823; train_gene_expr_recon_loss: 106906.3984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453393.2396; train_optim_loss: 453393.2396; val_kl_reg_loss: 5803.5791; val_edge_recon_loss: 263745.0938; val_cond_contrastive_loss: 78413.2266; val_gene_expr_recon_loss: 106781.3516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454743.2500; val_optim_loss: 454743.2500
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9819; val_auprc_score: 0.9758; val_best_acc_score: 0.9391; val_best_f1_score: 0.9401; train_kl_reg_loss: 5910.2851; train_edge_recon_loss: 261676.8854; train_cond_contrastive_loss: 78760.3698; train_gene_expr_recon_loss: 106594.7695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452942.3125; train_optim_loss: 452942.3125; val_kl_reg_loss: 5849.4116; val_edge_recon_loss: 265344.1875; val_cond_contrastive_loss: 78413.1328; val_gene_expr_recon_loss: 106498.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 456104.7188; val_optim_loss: 456104.7188
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9840; val_auprc_score: 0.9786; val_best_acc_score: 0.9440; val_best_f1_score: 0.9448; train_kl_reg_loss: 5917.4398; train_edge_recon_loss: 262301.9036; train_cond_contrastive_loss: 78760.3555; train_gene_expr_recon_loss: 106355.6419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453335.3438; train_optim_loss: 453335.3438; val_kl_reg_loss: 5813.1069; val_edge_recon_loss: 264821.4375; val_cond_contrastive_loss: 78413.6641; val_gene_expr_recon_loss: 106201.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455249.2188; val_optim_loss: 455249.2188

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9838; val_auprc_score: 0.9801; val_best_acc_score: 0.9432; val_best_f1_score: 0.9443; train_kl_reg_loss: 5884.8481; train_edge_recon_loss: 259944.5521; train_cond_contrastive_loss: 78775.3932; train_gene_expr_recon_loss: 106410.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451015.0521; train_optim_loss: 451015.0521; val_kl_reg_loss: 5790.6621; val_edge_recon_loss: 262500.5312; val_cond_contrastive_loss: 78413.9062; val_gene_expr_recon_loss: 106168.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452873.2812; val_optim_loss: 452873.2812
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9850; val_auprc_score: 0.9799; val_best_acc_score: 0.9477; val_best_f1_score: 0.9489; train_kl_reg_loss: 5885.6938; train_edge_recon_loss: 260506.8177; train_cond_contrastive_loss: 78765.1628; train_gene_expr_recon_loss: 105919.3125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451076.9948; train_optim_loss: 451076.9948; val_kl_reg_loss: 5815.9463; val_edge_recon_loss: 256795.6094; val_cond_contrastive_loss: 78413.3125; val_gene_expr_recon_loss: 106130.4375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447155.3125; val_optim_loss: 447155.3125
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9844; val_auprc_score: 0.9803; val_best_acc_score: 0.9470; val_best_f1_score: 0.9482; train_kl_reg_loss: 5921.0485; train_edge_recon_loss: 260728.7318; train_cond_contrastive_loss: 78757.7617; train_gene_expr_recon_loss: 106050.5404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451458.0729; train_optim_loss: 451458.0729; val_kl_reg_loss: 5826.4712; val_edge_recon_loss: 259030.0781; val_cond_contrastive_loss: 78413.1250; val_gene_expr_recon_loss: 106101.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449371.3125; val_optim_loss: 449371.3125
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9827; val_auprc_score: 0.9767; val_best_acc_score: 0.9425; val_best_f1_score: 0.9428; train_kl_reg_loss: 5912.7891; train_edge_recon_loss: 261546.1745; train_cond_contrastive_loss: 78757.4740; train_gene_expr_recon_loss: 106025.7253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452242.1615; train_optim_loss: 452242.1615; val_kl_reg_loss: 5805.7139; val_edge_recon_loss: 264483.2188; val_cond_contrastive_loss: 78412.1016; val_gene_expr_recon_loss: 106074.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454775.5625; val_optim_loss: 454775.5625
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9837; val_auprc_score: 0.9783; val_best_acc_score: 0.9441; val_best_f1_score: 0.9446; train_kl_reg_loss: 5893.4596; train_edge_recon_loss: 260591.3724; train_cond_contrastive_loss: 78757.2865; train_gene_expr_recon_loss: 106171.2122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451413.3281; train_optim_loss: 451413.3281; val_kl_reg_loss: 5798.0225; val_edge_recon_loss: 263002.6250; val_cond_contrastive_loss: 78411.3516; val_gene_expr_recon_loss: 106041.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453253.6250; val_optim_loss: 453253.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9847; val_auprc_score: 0.9822; val_best_acc_score: 0.9430; val_best_f1_score: 0.9440; train_kl_reg_loss: 5889.8010; train_edge_recon_loss: 261243.0234; train_cond_contrastive_loss: 78755.2044; train_gene_expr_recon_loss: 105949.7565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451837.7812; train_optim_loss: 451837.7812; val_kl_reg_loss: 5794.0850; val_edge_recon_loss: 260802.3594; val_cond_contrastive_loss: 78411.9141; val_gene_expr_recon_loss: 106038.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451047.0000; val_optim_loss: 451047.0000
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9828; val_auprc_score: 0.9739; val_best_acc_score: 0.9438; val_best_f1_score: 0.9444; train_kl_reg_loss: 5889.0758; train_edge_recon_loss: 260191.6875; train_cond_contrastive_loss: 78756.4648; train_gene_expr_recon_loss: 105918.2188; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450755.4427; train_optim_loss: 450755.4427; val_kl_reg_loss: 5790.2363; val_edge_recon_loss: 261425.2031; val_cond_contrastive_loss: 78411.7656; val_gene_expr_recon_loss: 106035.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451663.1250; val_optim_loss: 451663.1250
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9848; val_auprc_score: 0.9798; val_best_acc_score: 0.9476; val_best_f1_score: 0.9486; train_kl_reg_loss: 5886.3461; train_edge_recon_loss: 260744.7500; train_cond_contrastive_loss: 78758.4922; train_gene_expr_recon_loss: 105867.9531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451257.5365; train_optim_loss: 451257.5365; val_kl_reg_loss: 5793.3809; val_edge_recon_loss: 260400.2344; val_cond_contrastive_loss: 78412.0391; val_gene_expr_recon_loss: 106033.0547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450638.7188; val_optim_loss: 450638.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 2 min 28 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
Val AUROC score: 0.9828
Val AUPRC score: 0.9783
Val best accuracy score: 0.9428
Val best F1 score: 0.9433
Val gene expr MSE score: 1.7664
Duration of model training in run 6: 0 hours, 2 minutes and 31 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7614; val_auprc_score: 0.7937; val_best_acc_score: 0.6829; val_best_f1_score: 0.7064; train_kl_reg_loss: 5047.0607; train_edge_recon_loss: 356875.0089; train_cond_contrastive_loss: 104493.0647; train_gene_expr_recon_loss: 130462.1551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 596877.2857; train_optim_loss: 596877.2857; val_kl_reg_loss: 7642.2266; val_edge_recon_loss: 402937.0938; val_cond_contrastive_loss: 78335.9297; val_gene_expr_recon_loss: 117076.1719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 605991.4375; val_optim_loss: 605991.4375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7196; val_auprc_score: 0.7463; val_best_acc_score: 0.6396; val_best_f1_score: 0.7033; train_kl_reg_loss: 6492.4299; train_edge_recon_loss: 353608.5893; train_cond_contrastive_loss: 87876.8571; train_gene_expr_recon_loss: 116145.7578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 564123.6339; train_optim_loss: 564123.6339; val_kl_reg_loss: 4228.4121; val_edge_recon_loss: 377845.0625; val_cond_contrastive_loss: 78372.8906; val_gene_expr_recon_loss: 115145.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 575591.5625; val_optim_loss: 575591.5625
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7275; val_auprc_score: 0.7559; val_best_acc_score: 0.6581; val_best_f1_score: 0.7025; train_kl_reg_loss: 3564.6265; train_edge_recon_loss: 339897.1696; train_cond_contrastive_loss: 88082.9944; train_gene_expr_recon_loss: 114643.6261; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 546188.4196; train_optim_loss: 546188.4196; val_kl_reg_loss: 3305.9023; val_edge_recon_loss: 333619.2812; val_cond_contrastive_loss: 78362.3203; val_gene_expr_recon_loss: 114260.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 529548.2500; val_optim_loss: 529548.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7454; val_auprc_score: 0.7611; val_best_acc_score: 0.6727; val_best_f1_score: 0.7076; train_kl_reg_loss: 3995.4694; train_edge_recon_loss: 319982.1830; train_cond_contrastive_loss: 81212.5982; train_gene_expr_recon_loss: 113788.4230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 518978.6652; train_optim_loss: 518978.6652; val_kl_reg_loss: 4748.5088; val_edge_recon_loss: 321100.9688; val_cond_contrastive_loss: 78352.2891; val_gene_expr_recon_loss: 113310.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 517512.1250; val_optim_loss: 517512.1250
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8174; val_auprc_score: 0.8115; val_best_acc_score: 0.7305; val_best_f1_score: 0.7648; train_kl_reg_loss: 5209.5398; train_edge_recon_loss: 302816.5134; train_cond_contrastive_loss: 78917.3281; train_gene_expr_recon_loss: 112883.1998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 499826.5804; train_optim_loss: 499826.5804; val_kl_reg_loss: 5695.0137; val_edge_recon_loss: 294073.1250; val_cond_contrastive_loss: 78369.8203; val_gene_expr_recon_loss: 112607.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 490745.5625; val_optim_loss: 490745.5625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8517; val_auprc_score: 0.8374; val_best_acc_score: 0.7706; val_best_f1_score: 0.7955; train_kl_reg_loss: 6133.9025; train_edge_recon_loss: 284591.8839; train_cond_contrastive_loss: 78741.5859; train_gene_expr_recon_loss: 112515.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 481982.5625; train_optim_loss: 481982.5625; val_kl_reg_loss: 6346.7686; val_edge_recon_loss: 284058.7500; val_cond_contrastive_loss: 78371.1953; val_gene_expr_recon_loss: 111690.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 480467.5625; val_optim_loss: 480467.5625
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8641; val_auprc_score: 0.8414; val_best_acc_score: 0.7901; val_best_f1_score: 0.8105; train_kl_reg_loss: 6427.5285; train_edge_recon_loss: 279369.0312; train_cond_contrastive_loss: 78846.5167; train_gene_expr_recon_loss: 111678.9833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476322.0625; train_optim_loss: 476322.0625; val_kl_reg_loss: 6286.3145; val_edge_recon_loss: 283947.6250; val_cond_contrastive_loss: 78367.5938; val_gene_expr_recon_loss: 111049.4453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479650.9688; val_optim_loss: 479650.9688
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8860; val_auprc_score: 0.8610; val_best_acc_score: 0.8200; val_best_f1_score: 0.8338; train_kl_reg_loss: 6368.5773; train_edge_recon_loss: 276754.9196; train_cond_contrastive_loss: 78936.4397; train_gene_expr_recon_loss: 110817.6540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 472877.6027; train_optim_loss: 472877.6027; val_kl_reg_loss: 6242.9111; val_edge_recon_loss: 276757.4062; val_cond_contrastive_loss: 78372.8750; val_gene_expr_recon_loss: 110517.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 471890.2812; val_optim_loss: 471890.2812
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9054; val_auprc_score: 0.8842; val_best_acc_score: 0.8366; val_best_f1_score: 0.8495; train_kl_reg_loss: 6314.1056; train_edge_recon_loss: 272606.3170; train_cond_contrastive_loss: 78969.9475; train_gene_expr_recon_loss: 110078.4219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467968.7902; train_optim_loss: 467968.7902; val_kl_reg_loss: 6164.6084; val_edge_recon_loss: 273825.6250; val_cond_contrastive_loss: 78387.5547; val_gene_expr_recon_loss: 109976.6953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468354.4688; val_optim_loss: 468354.4688
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9341; val_auprc_score: 0.9229; val_best_acc_score: 0.8632; val_best_f1_score: 0.8727; train_kl_reg_loss: 6182.9417; train_edge_recon_loss: 271753.1473; train_cond_contrastive_loss: 78979.3348; train_gene_expr_recon_loss: 109717.2533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 466632.6875; train_optim_loss: 466632.6875; val_kl_reg_loss: 6033.8389; val_edge_recon_loss: 268342.2188; val_cond_contrastive_loss: 78404.6406; val_gene_expr_recon_loss: 109530.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462310.9688; val_optim_loss: 462310.9688
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9506; val_auprc_score: 0.9418; val_best_acc_score: 0.8846; val_best_f1_score: 0.8902; train_kl_reg_loss: 6134.0054; train_edge_recon_loss: 268840.1830; train_cond_contrastive_loss: 78895.4185; train_gene_expr_recon_loss: 109071.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462941.0580; train_optim_loss: 462941.0580; val_kl_reg_loss: 6146.1182; val_edge_recon_loss: 268937.0625; val_cond_contrastive_loss: 78407.8203; val_gene_expr_recon_loss: 109071.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462562.0312; val_optim_loss: 462562.0312
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9548; val_auprc_score: 0.9435; val_best_acc_score: 0.8928; val_best_f1_score: 0.8969; train_kl_reg_loss: 6220.6055; train_edge_recon_loss: 267674.1920; train_cond_contrastive_loss: 78779.2199; train_gene_expr_recon_loss: 109164.9185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461838.9420; train_optim_loss: 461838.9420; val_kl_reg_loss: 6239.6924; val_edge_recon_loss: 272270.1875; val_cond_contrastive_loss: 78403.6406; val_gene_expr_recon_loss: 108639.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465552.6250; val_optim_loss: 465552.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9629; val_auprc_score: 0.9522; val_best_acc_score: 0.9088; val_best_f1_score: 0.9111; train_kl_reg_loss: 6273.9421; train_edge_recon_loss: 266425.2589; train_cond_contrastive_loss: 78724.8560; train_gene_expr_recon_loss: 108450.9509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459875.0045; train_optim_loss: 459875.0045; val_kl_reg_loss: 6101.9707; val_edge_recon_loss: 268847.2188; val_cond_contrastive_loss: 78402.7578; val_gene_expr_recon_loss: 108218.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461570.3125; val_optim_loss: 461570.3125
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9690; val_auprc_score: 0.9603; val_best_acc_score: 0.9176; val_best_f1_score: 0.9195; train_kl_reg_loss: 6116.5510; train_edge_recon_loss: 265123.4509; train_cond_contrastive_loss: 78748.2221; train_gene_expr_recon_loss: 107822.4777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457810.7143; train_optim_loss: 457810.7143; val_kl_reg_loss: 5935.8130; val_edge_recon_loss: 267746.9062; val_cond_contrastive_loss: 78403.4219; val_gene_expr_recon_loss: 107785.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459871.1250; val_optim_loss: 459871.1250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9748; val_auprc_score: 0.9684; val_best_acc_score: 0.9274; val_best_f1_score: 0.9286; train_kl_reg_loss: 5991.9817; train_edge_recon_loss: 264717.1295; train_cond_contrastive_loss: 78774.8504; train_gene_expr_recon_loss: 107451.3728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456935.3393; train_optim_loss: 456935.3393; val_kl_reg_loss: 5931.8086; val_edge_recon_loss: 267598.4062; val_cond_contrastive_loss: 78404.4375; val_gene_expr_recon_loss: 107360.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459295.6250; val_optim_loss: 459295.6250
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9783; val_auprc_score: 0.9718; val_best_acc_score: 0.9329; val_best_f1_score: 0.9340; train_kl_reg_loss: 5962.8417; train_edge_recon_loss: 263383.4152; train_cond_contrastive_loss: 78770.4464; train_gene_expr_recon_loss: 107149.4275; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455266.1384; train_optim_loss: 455266.1384; val_kl_reg_loss: 5859.4990; val_edge_recon_loss: 264708.0625; val_cond_contrastive_loss: 78400.8828; val_gene_expr_recon_loss: 106992.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455961.1562; val_optim_loss: 455961.1562
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9809; val_auprc_score: 0.9759; val_best_acc_score: 0.9381; val_best_f1_score: 0.9394; train_kl_reg_loss: 5962.1691; train_edge_recon_loss: 262196.1853; train_cond_contrastive_loss: 78745.7154; train_gene_expr_recon_loss: 106844.8661; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453748.9330; train_optim_loss: 453748.9330; val_kl_reg_loss: 5901.0176; val_edge_recon_loss: 262790.4375; val_cond_contrastive_loss: 78397.6953; val_gene_expr_recon_loss: 106662.4844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453751.6250; val_optim_loss: 453751.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9834; val_auprc_score: 0.9760; val_best_acc_score: 0.9428; val_best_f1_score: 0.9444; train_kl_reg_loss: 5935.0004; train_edge_recon_loss: 261672.1250; train_cond_contrastive_loss: 78729.9208; train_gene_expr_recon_loss: 106270.1975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452607.2411; train_optim_loss: 452607.2411; val_kl_reg_loss: 5823.3887; val_edge_recon_loss: 260821.1406; val_cond_contrastive_loss: 78392.3984; val_gene_expr_recon_loss: 106316.1641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451353.0938; val_optim_loss: 451353.0938
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9834; val_auprc_score: 0.9762; val_best_acc_score: 0.9419; val_best_f1_score: 0.9429; train_kl_reg_loss: 5917.0956; train_edge_recon_loss: 260510.9442; train_cond_contrastive_loss: 78720.3884; train_gene_expr_recon_loss: 106189.9721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451338.4062; train_optim_loss: 451338.4062; val_kl_reg_loss: 5889.7500; val_edge_recon_loss: 264343.2500; val_cond_contrastive_loss: 78388.3594; val_gene_expr_recon_loss: 105980.2422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454601.6250; val_optim_loss: 454601.6250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9845; val_auprc_score: 0.9790; val_best_acc_score: 0.9448; val_best_f1_score: 0.9462; train_kl_reg_loss: 5905.6751; train_edge_recon_loss: 260739.5201; train_cond_contrastive_loss: 78718.2154; train_gene_expr_recon_loss: 105956.5536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451319.9643; train_optim_loss: 451319.9643; val_kl_reg_loss: 5841.4341; val_edge_recon_loss: 260930.1875; val_cond_contrastive_loss: 78386.3047; val_gene_expr_recon_loss: 105677.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450835.8750; val_optim_loss: 450835.8750
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9860; val_auprc_score: 0.9836; val_best_acc_score: 0.9473; val_best_f1_score: 0.9490; train_kl_reg_loss: 5912.1768; train_edge_recon_loss: 260181.3996; train_cond_contrastive_loss: 78711.4721; train_gene_expr_recon_loss: 105630.7913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450435.8527; train_optim_loss: 450435.8527; val_kl_reg_loss: 5793.4668; val_edge_recon_loss: 258962.8438; val_cond_contrastive_loss: 78383.7656; val_gene_expr_recon_loss: 105382.1328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448522.1875; val_optim_loss: 448522.1875
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9864; val_auprc_score: 0.9803; val_best_acc_score: 0.9511; val_best_f1_score: 0.9521; train_kl_reg_loss: 5890.8216; train_edge_recon_loss: 259705.8125; train_cond_contrastive_loss: 78719.2433; train_gene_expr_recon_loss: 105261.5257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449577.3929; train_optim_loss: 449577.3929; val_kl_reg_loss: 5861.5947; val_edge_recon_loss: 259493.6250; val_cond_contrastive_loss: 78381.4922; val_gene_expr_recon_loss: 105060.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448797.0000; val_optim_loss: 448797.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9874; val_auprc_score: 0.9813; val_best_acc_score: 0.9505; val_best_f1_score: 0.9514; train_kl_reg_loss: 5865.9387; train_edge_recon_loss: 258417.0045; train_cond_contrastive_loss: 78725.8516; train_gene_expr_recon_loss: 104981.2132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447990.0134; train_optim_loss: 447990.0134; val_kl_reg_loss: 5810.5015; val_edge_recon_loss: 261259.8906; val_cond_contrastive_loss: 78381.1250; val_gene_expr_recon_loss: 104754.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450205.9062; val_optim_loss: 450205.9062
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9874; val_auprc_score: 0.9824; val_best_acc_score: 0.9524; val_best_f1_score: 0.9532; train_kl_reg_loss: 5893.6689; train_edge_recon_loss: 259942.5290; train_cond_contrastive_loss: 78709.5781; train_gene_expr_recon_loss: 104956.7232; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449502.5045; train_optim_loss: 449502.5045; val_kl_reg_loss: 5798.0776; val_edge_recon_loss: 261355.1562; val_cond_contrastive_loss: 78383.7656; val_gene_expr_recon_loss: 104471.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450008.6875; val_optim_loss: 450008.6875

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9886; val_auprc_score: 0.9843; val_best_acc_score: 0.9534; val_best_f1_score: 0.9535; train_kl_reg_loss: 5852.4586; train_edge_recon_loss: 259930.1205; train_cond_contrastive_loss: 78717.5926; train_gene_expr_recon_loss: 104598.6518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449098.8214; train_optim_loss: 449098.8214; val_kl_reg_loss: 5790.1553; val_edge_recon_loss: 262414.3438; val_cond_contrastive_loss: 78383.6797; val_gene_expr_recon_loss: 104428.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451016.5625; val_optim_loss: 451016.5625
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9865; val_auprc_score: 0.9828; val_best_acc_score: 0.9508; val_best_f1_score: 0.9512; train_kl_reg_loss: 5856.3463; train_edge_recon_loss: 259372.5201; train_cond_contrastive_loss: 78710.6484; train_gene_expr_recon_loss: 104647.5156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448587.0402; train_optim_loss: 448587.0402; val_kl_reg_loss: 5782.2651; val_edge_recon_loss: 264728.0938; val_cond_contrastive_loss: 78383.6094; val_gene_expr_recon_loss: 104391.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453285.8438; val_optim_loss: 453285.8438
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9887; val_auprc_score: 0.9858; val_best_acc_score: 0.9540; val_best_f1_score: 0.9549; train_kl_reg_loss: 5847.6892; train_edge_recon_loss: 260244.3973; train_cond_contrastive_loss: 78715.3772; train_gene_expr_recon_loss: 104245.2768; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449052.7366; train_optim_loss: 449052.7366; val_kl_reg_loss: 5774.8535; val_edge_recon_loss: 258317.8906; val_cond_contrastive_loss: 78384.5938; val_gene_expr_recon_loss: 104362.7031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446840.0625; val_optim_loss: 446840.0625
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9895; val_auprc_score: 0.9862; val_best_acc_score: 0.9551; val_best_f1_score: 0.9554; train_kl_reg_loss: 5839.5553; train_edge_recon_loss: 260378.4799; train_cond_contrastive_loss: 78713.2723; train_gene_expr_recon_loss: 104161.3839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449092.6920; train_optim_loss: 449092.6920; val_kl_reg_loss: 5759.5688; val_edge_recon_loss: 259774.0000; val_cond_contrastive_loss: 78384.9531; val_gene_expr_recon_loss: 104333.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448251.5938; val_optim_loss: 448251.5938
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9885; val_auprc_score: 0.9845; val_best_acc_score: 0.9522; val_best_f1_score: 0.9533; train_kl_reg_loss: 5826.4743; train_edge_recon_loss: 259109.2768; train_cond_contrastive_loss: 78716.4978; train_gene_expr_recon_loss: 104239.8783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447892.1339; train_optim_loss: 447892.1339; val_kl_reg_loss: 5757.8301; val_edge_recon_loss: 260122.0000; val_cond_contrastive_loss: 78385.3203; val_gene_expr_recon_loss: 104301.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448566.4375; val_optim_loss: 448566.4375
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9896; val_auprc_score: 0.9862; val_best_acc_score: 0.9550; val_best_f1_score: 0.9559; train_kl_reg_loss: 5828.5973; train_edge_recon_loss: 259290.8616; train_cond_contrastive_loss: 78717.1507; train_gene_expr_recon_loss: 104355.7266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448192.3393; train_optim_loss: 448192.3393; val_kl_reg_loss: 5764.2227; val_edge_recon_loss: 259369.5469; val_cond_contrastive_loss: 78385.5781; val_gene_expr_recon_loss: 104272.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447792.0000; val_optim_loss: 447792.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9885; val_auprc_score: 0.9842; val_best_acc_score: 0.9528; val_best_f1_score: 0.9533; train_kl_reg_loss: 5832.1955; train_edge_recon_loss: 259544.5536; train_cond_contrastive_loss: 78713.5592; train_gene_expr_recon_loss: 104332.1551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448422.4688; train_optim_loss: 448422.4688; val_kl_reg_loss: 5762.3418; val_edge_recon_loss: 261369.7656; val_cond_contrastive_loss: 78385.4531; val_gene_expr_recon_loss: 104269.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449787.5000; val_optim_loss: 449787.5000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9884; val_auprc_score: 0.9830; val_best_acc_score: 0.9536; val_best_f1_score: 0.9536; train_kl_reg_loss: 5830.2079; train_edge_recon_loss: 259581.9062; train_cond_contrastive_loss: 78714.9464; train_gene_expr_recon_loss: 104015.5692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448142.6250; train_optim_loss: 448142.6250; val_kl_reg_loss: 5755.4229; val_edge_recon_loss: 262779.6562; val_cond_contrastive_loss: 78385.2188; val_gene_expr_recon_loss: 104267.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451187.3438; val_optim_loss: 451187.3438
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9879; val_auprc_score: 0.9818; val_best_acc_score: 0.9524; val_best_f1_score: 0.9526; train_kl_reg_loss: 5824.3217; train_edge_recon_loss: 259408.7812; train_cond_contrastive_loss: 78717.1585; train_gene_expr_recon_loss: 104090.1562; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448040.4241; train_optim_loss: 448040.4241; val_kl_reg_loss: 5756.6699; val_edge_recon_loss: 262289.6250; val_cond_contrastive_loss: 78385.4531; val_gene_expr_recon_loss: 104263.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450695.7188; val_optim_loss: 450695.7188

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 3 min 18 sec.
Using best model state, which was in epoch 27.

--- MODEL EVALUATION ---
Val AUROC score: 0.9890
Val AUPRC score: 0.9852
Val best accuracy score: 0.9528
Val best F1 score: 0.9538
Val gene expr MSE score: 1.6717
Duration of model training in run 7: 0 hours, 3 minutes and 23 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 113127
Number of validation edges: 12569
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7675; val_auprc_score: 0.8036; val_best_acc_score: 0.6883; val_best_f1_score: 0.7132; train_kl_reg_loss: 6169.2560; train_edge_recon_loss: 357192.2188; train_cond_contrastive_loss: 105545.6429; train_gene_expr_recon_loss: 134054.5826; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 602961.7054; train_optim_loss: 602961.7054; val_kl_reg_loss: 8854.1836; val_edge_recon_loss: 397655.2188; val_cond_contrastive_loss: 78333.3438; val_gene_expr_recon_loss: 118019.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 602862.5000; val_optim_loss: 602862.5000
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7288; val_auprc_score: 0.7533; val_best_acc_score: 0.6470; val_best_f1_score: 0.7090; train_kl_reg_loss: 7388.3977; train_edge_recon_loss: 354962.3170; train_cond_contrastive_loss: 87650.1060; train_gene_expr_recon_loss: 117455.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 567456.7589; train_optim_loss: 567456.7589; val_kl_reg_loss: 5206.9858; val_edge_recon_loss: 382117.2500; val_cond_contrastive_loss: 78360.7969; val_gene_expr_recon_loss: 114735.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 580420.3750; val_optim_loss: 580420.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7266; val_auprc_score: 0.7501; val_best_acc_score: 0.6537; val_best_f1_score: 0.7022; train_kl_reg_loss: 4108.5351; train_edge_recon_loss: 342031.1027; train_cond_contrastive_loss: 87883.0513; train_gene_expr_recon_loss: 115097.2679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 549119.9554; train_optim_loss: 549119.9554; val_kl_reg_loss: 3348.4443; val_edge_recon_loss: 335896.0938; val_cond_contrastive_loss: 78384.1875; val_gene_expr_recon_loss: 113818.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 531447.1250; val_optim_loss: 531447.1250
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.7346; val_auprc_score: 0.7643; val_best_acc_score: 0.6632; val_best_f1_score: 0.7044; train_kl_reg_loss: 3871.1808; train_edge_recon_loss: 321327.9732; train_cond_contrastive_loss: 81492.8772; train_gene_expr_recon_loss: 114130.0636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 520822.0938; train_optim_loss: 520822.0938; val_kl_reg_loss: 4414.6421; val_edge_recon_loss: 324075.6250; val_cond_contrastive_loss: 78355.7891; val_gene_expr_recon_loss: 112835.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 519681.0625; val_optim_loss: 519681.0625
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.7987; val_auprc_score: 0.8020; val_best_acc_score: 0.7117; val_best_f1_score: 0.7405; train_kl_reg_loss: 4535.7497; train_edge_recon_loss: 309527.6161; train_cond_contrastive_loss: 79038.4643; train_gene_expr_recon_loss: 113320.7109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 506422.5312; train_optim_loss: 506422.5312; val_kl_reg_loss: 4734.4399; val_edge_recon_loss: 301685.3125; val_cond_contrastive_loss: 78371.4453; val_gene_expr_recon_loss: 112204.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 496995.8750; val_optim_loss: 496995.8750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8490; val_auprc_score: 0.8371; val_best_acc_score: 0.7678; val_best_f1_score: 0.7956; train_kl_reg_loss: 5309.5140; train_edge_recon_loss: 289468.9330; train_cond_contrastive_loss: 78785.1652; train_gene_expr_recon_loss: 112494.9665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 486058.5848; train_optim_loss: 486058.5848; val_kl_reg_loss: 6129.7915; val_edge_recon_loss: 282803.3125; val_cond_contrastive_loss: 78384.8047; val_gene_expr_recon_loss: 111351.0391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 478668.9375; val_optim_loss: 478668.9375
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8635; val_auprc_score: 0.8373; val_best_acc_score: 0.7899; val_best_f1_score: 0.8133; train_kl_reg_loss: 6485.5024; train_edge_recon_loss: 281796.6071; train_cond_contrastive_loss: 78718.3170; train_gene_expr_recon_loss: 111661.9520; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 478662.3750; train_optim_loss: 478662.3750; val_kl_reg_loss: 6478.6416; val_edge_recon_loss: 281305.1562; val_cond_contrastive_loss: 78380.5312; val_gene_expr_recon_loss: 110656.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 476821.1562; val_optim_loss: 476821.1562
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8867; val_auprc_score: 0.8660; val_best_acc_score: 0.8165; val_best_f1_score: 0.8351; train_kl_reg_loss: 6306.6242; train_edge_recon_loss: 278178.4911; train_cond_contrastive_loss: 78892.5379; train_gene_expr_recon_loss: 111015.3806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474393.0357; train_optim_loss: 474393.0357; val_kl_reg_loss: 6006.5947; val_edge_recon_loss: 273927.7500; val_cond_contrastive_loss: 78381.5078; val_gene_expr_recon_loss: 110039.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468355.7500; val_optim_loss: 468355.7500
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8996; val_auprc_score: 0.8804; val_best_acc_score: 0.8316; val_best_f1_score: 0.8467; train_kl_reg_loss: 6124.9173; train_edge_recon_loss: 274857.3438; train_cond_contrastive_loss: 79003.1127; train_gene_expr_recon_loss: 110438.0681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470423.4464; train_optim_loss: 470423.4464; val_kl_reg_loss: 6173.6699; val_edge_recon_loss: 274647.1250; val_cond_contrastive_loss: 78390.5938; val_gene_expr_recon_loss: 109410.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468621.6562; val_optim_loss: 468621.6562
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9151; val_auprc_score: 0.9007; val_best_acc_score: 0.8442; val_best_f1_score: 0.8590; train_kl_reg_loss: 6245.4614; train_edge_recon_loss: 273497.5938; train_cond_contrastive_loss: 78949.5871; train_gene_expr_recon_loss: 109992.4208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 468685.0625; train_optim_loss: 468685.0625; val_kl_reg_loss: 6056.2471; val_edge_recon_loss: 271735.9375; val_cond_contrastive_loss: 78403.4297; val_gene_expr_recon_loss: 108944.4922; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 465140.1250; val_optim_loss: 465140.1250
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9366; val_auprc_score: 0.9229; val_best_acc_score: 0.8659; val_best_f1_score: 0.8729; train_kl_reg_loss: 6045.9256; train_edge_recon_loss: 271040.0134; train_cond_contrastive_loss: 78954.5893; train_gene_expr_recon_loss: 109519.7377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465560.2634; train_optim_loss: 465560.2634; val_kl_reg_loss: 5942.4956; val_edge_recon_loss: 271159.0625; val_cond_contrastive_loss: 78408.7500; val_gene_expr_recon_loss: 108533.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 464043.5000; val_optim_loss: 464043.5000
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9476; val_auprc_score: 0.9343; val_best_acc_score: 0.8814; val_best_f1_score: 0.8866; train_kl_reg_loss: 6030.6574; train_edge_recon_loss: 269674.7500; train_cond_contrastive_loss: 78836.2188; train_gene_expr_recon_loss: 109128.5368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463670.1518; train_optim_loss: 463670.1518; val_kl_reg_loss: 6016.6357; val_edge_recon_loss: 269816.9062; val_cond_contrastive_loss: 78404.6328; val_gene_expr_recon_loss: 108114.3438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462352.5000; val_optim_loss: 462352.5000
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9533; val_auprc_score: 0.9427; val_best_acc_score: 0.8920; val_best_f1_score: 0.8960; train_kl_reg_loss: 6145.3167; train_edge_recon_loss: 268136.2902; train_cond_contrastive_loss: 78742.1540; train_gene_expr_recon_loss: 108616.8315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461640.6027; train_optim_loss: 461640.6027; val_kl_reg_loss: 6086.3149; val_edge_recon_loss: 269681.0625; val_cond_contrastive_loss: 78397.6094; val_gene_expr_recon_loss: 107710.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 461875.5312; val_optim_loss: 461875.5312
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9608; val_auprc_score: 0.9527; val_best_acc_score: 0.9029; val_best_f1_score: 0.9071; train_kl_reg_loss: 6108.3143; train_edge_recon_loss: 267982.7455; train_cond_contrastive_loss: 78731.8393; train_gene_expr_recon_loss: 108144.5949; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460967.4955; train_optim_loss: 460967.4955; val_kl_reg_loss: 5942.6279; val_edge_recon_loss: 265934.7188; val_cond_contrastive_loss: 78395.8516; val_gene_expr_recon_loss: 107319.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457592.7500; val_optim_loss: 457592.7500
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9680; val_auprc_score: 0.9617; val_best_acc_score: 0.9170; val_best_f1_score: 0.9208; train_kl_reg_loss: 5988.7330; train_edge_recon_loss: 265861.3080; train_cond_contrastive_loss: 78735.3817; train_gene_expr_recon_loss: 107854.2734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458439.6875; train_optim_loss: 458439.6875; val_kl_reg_loss: 5835.1182; val_edge_recon_loss: 262489.2500; val_cond_contrastive_loss: 78398.8516; val_gene_expr_recon_loss: 106921.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453644.9062; val_optim_loss: 453644.9062
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9758; val_auprc_score: 0.9723; val_best_acc_score: 0.9278; val_best_f1_score: 0.9301; train_kl_reg_loss: 5902.5713; train_edge_recon_loss: 264399.1696; train_cond_contrastive_loss: 78736.1083; train_gene_expr_recon_loss: 107292.9241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456330.7812; train_optim_loss: 456330.7812; val_kl_reg_loss: 5718.1660; val_edge_recon_loss: 263348.4062; val_cond_contrastive_loss: 78400.4844; val_gene_expr_recon_loss: 106536.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454003.4062; val_optim_loss: 454003.4062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9784; val_auprc_score: 0.9717; val_best_acc_score: 0.9322; val_best_f1_score: 0.9338; train_kl_reg_loss: 5820.6816; train_edge_recon_loss: 264347.1696; train_cond_contrastive_loss: 78742.2958; train_gene_expr_recon_loss: 107054.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455964.6027; train_optim_loss: 455964.6027; val_kl_reg_loss: 5735.9170; val_edge_recon_loss: 263978.0625; val_cond_contrastive_loss: 78398.3984; val_gene_expr_recon_loss: 106207.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454319.6250; val_optim_loss: 454319.6250
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9794; val_auprc_score: 0.9728; val_best_acc_score: 0.9365; val_best_f1_score: 0.9384; train_kl_reg_loss: 5850.5555; train_edge_recon_loss: 263096.7902; train_cond_contrastive_loss: 78730.7902; train_gene_expr_recon_loss: 106834.6127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454512.7411; train_optim_loss: 454512.7411; val_kl_reg_loss: 5758.9844; val_edge_recon_loss: 263538.0000; val_cond_contrastive_loss: 78394.2891; val_gene_expr_recon_loss: 105903.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 453595.0000; val_optim_loss: 453595.0000
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9837; val_auprc_score: 0.9801; val_best_acc_score: 0.9447; val_best_f1_score: 0.9459; train_kl_reg_loss: 5846.9542; train_edge_recon_loss: 262011.7768; train_cond_contrastive_loss: 78734.5234; train_gene_expr_recon_loss: 106542.8694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453136.1205; train_optim_loss: 453136.1205; val_kl_reg_loss: 5757.1143; val_edge_recon_loss: 262034.3281; val_cond_contrastive_loss: 78391.2500; val_gene_expr_recon_loss: 105599.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451781.7812; val_optim_loss: 451781.7812
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9846; val_auprc_score: 0.9809; val_best_acc_score: 0.9456; val_best_f1_score: 0.9471; train_kl_reg_loss: 5850.5952; train_edge_recon_loss: 262120.6317; train_cond_contrastive_loss: 78736.1462; train_gene_expr_recon_loss: 106298.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453006.0670; train_optim_loss: 453006.0670; val_kl_reg_loss: 5759.0039; val_edge_recon_loss: 258780.2188; val_cond_contrastive_loss: 78389.7422; val_gene_expr_recon_loss: 105278.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448207.2500; val_optim_loss: 448207.2500
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9858; val_auprc_score: 0.9794; val_best_acc_score: 0.9471; val_best_f1_score: 0.9479; train_kl_reg_loss: 5857.1800; train_edge_recon_loss: 261153.6964; train_cond_contrastive_loss: 78745.2299; train_gene_expr_recon_loss: 106110.7868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451866.8973; train_optim_loss: 451866.8973; val_kl_reg_loss: 5745.2480; val_edge_recon_loss: 262147.5938; val_cond_contrastive_loss: 78389.4219; val_gene_expr_recon_loss: 104965.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451248.0625; val_optim_loss: 451248.0625
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9876; val_auprc_score: 0.9848; val_best_acc_score: 0.9485; val_best_f1_score: 0.9499; train_kl_reg_loss: 5841.6362; train_edge_recon_loss: 260571.6696; train_cond_contrastive_loss: 78743.7344; train_gene_expr_recon_loss: 105519.3873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450676.4420; train_optim_loss: 450676.4420; val_kl_reg_loss: 5784.9990; val_edge_recon_loss: 259326.5156; val_cond_contrastive_loss: 78389.9844; val_gene_expr_recon_loss: 104650.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448152.1875; val_optim_loss: 448152.1875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9865; val_auprc_score: 0.9831; val_best_acc_score: 0.9485; val_best_f1_score: 0.9499; train_kl_reg_loss: 5846.9213; train_edge_recon_loss: 259979.5960; train_cond_contrastive_loss: 78742.6685; train_gene_expr_recon_loss: 105082.8694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449652.0625; train_optim_loss: 449652.0625; val_kl_reg_loss: 5770.9365; val_edge_recon_loss: 258905.5000; val_cond_contrastive_loss: 78390.2891; val_gene_expr_recon_loss: 104342.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447409.4375; val_optim_loss: 447409.4375
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9867; val_auprc_score: 0.9841; val_best_acc_score: 0.9480; val_best_f1_score: 0.9492; train_kl_reg_loss: 5851.8838; train_edge_recon_loss: 260208.6875; train_cond_contrastive_loss: 78747.9074; train_gene_expr_recon_loss: 104888.4900; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449696.9598; train_optim_loss: 449696.9598; val_kl_reg_loss: 5766.2617; val_edge_recon_loss: 260671.6094; val_cond_contrastive_loss: 78390.4297; val_gene_expr_recon_loss: 104036.8438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448865.1562; val_optim_loss: 448865.1562
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9878; val_auprc_score: 0.9854; val_best_acc_score: 0.9508; val_best_f1_score: 0.9519; train_kl_reg_loss: 5865.5521; train_edge_recon_loss: 258736.8772; train_cond_contrastive_loss: 78744.1875; train_gene_expr_recon_loss: 104758.6016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448105.2232; train_optim_loss: 448105.2232; val_kl_reg_loss: 5781.9214; val_edge_recon_loss: 259184.7500; val_cond_contrastive_loss: 78391.9453; val_gene_expr_recon_loss: 103721.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447080.5000; val_optim_loss: 447080.5000
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9878; val_auprc_score: 0.9829; val_best_acc_score: 0.9530; val_best_f1_score: 0.9540; train_kl_reg_loss: 5866.7581; train_edge_recon_loss: 259499.8906; train_cond_contrastive_loss: 78742.6116; train_gene_expr_recon_loss: 104457.2612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448566.5179; train_optim_loss: 448566.5179; val_kl_reg_loss: 5733.0840; val_edge_recon_loss: 259104.1094; val_cond_contrastive_loss: 78392.5000; val_gene_expr_recon_loss: 103428.6797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446658.3750; val_optim_loss: 446658.3750
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9894; val_auprc_score: 0.9866; val_best_acc_score: 0.9556; val_best_f1_score: 0.9566; train_kl_reg_loss: 5807.9264; train_edge_recon_loss: 259895.6138; train_cond_contrastive_loss: 78743.5000; train_gene_expr_recon_loss: 104053.2846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448500.3393; train_optim_loss: 448500.3393; val_kl_reg_loss: 5714.1553; val_edge_recon_loss: 258351.5312; val_cond_contrastive_loss: 78393.5078; val_gene_expr_recon_loss: 103121.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445580.5938; val_optim_loss: 445580.5938
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9894; val_auprc_score: 0.9860; val_best_acc_score: 0.9532; val_best_f1_score: 0.9544; train_kl_reg_loss: 5821.8677; train_edge_recon_loss: 258832.7522; train_cond_contrastive_loss: 78734.8594; train_gene_expr_recon_loss: 103863.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447253.1339; train_optim_loss: 447253.1339; val_kl_reg_loss: 5715.9453; val_edge_recon_loss: 259607.2188; val_cond_contrastive_loss: 78396.6250; val_gene_expr_recon_loss: 102860.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446580.1250; val_optim_loss: 446580.1250
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9893; val_auprc_score: 0.9842; val_best_acc_score: 0.9567; val_best_f1_score: 0.9576; train_kl_reg_loss: 5799.7582; train_edge_recon_loss: 258977.9464; train_cond_contrastive_loss: 78733.5525; train_gene_expr_recon_loss: 103393.5915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446904.8482; train_optim_loss: 446904.8482; val_kl_reg_loss: 5692.4707; val_edge_recon_loss: 259151.9375; val_cond_contrastive_loss: 78399.5703; val_gene_expr_recon_loss: 102611.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445855.1562; val_optim_loss: 445855.1562
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9904; val_auprc_score: 0.9854; val_best_acc_score: 0.9599; val_best_f1_score: 0.9610; train_kl_reg_loss: 5836.2231; train_edge_recon_loss: 259195.6339; train_cond_contrastive_loss: 78734.1083; train_gene_expr_recon_loss: 103274.7868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447040.7455; train_optim_loss: 447040.7455; val_kl_reg_loss: 5719.7744; val_edge_recon_loss: 257905.8125; val_cond_contrastive_loss: 78403.7734; val_gene_expr_recon_loss: 102364.0312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444393.4062; val_optim_loss: 444393.4062
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9908; val_auprc_score: 0.9888; val_best_acc_score: 0.9574; val_best_f1_score: 0.9583; train_kl_reg_loss: 5788.1610; train_edge_recon_loss: 259087.5670; train_cond_contrastive_loss: 78746.3013; train_gene_expr_recon_loss: 103061.0011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446683.0223; train_optim_loss: 446683.0223; val_kl_reg_loss: 5706.6592; val_edge_recon_loss: 260560.2500; val_cond_contrastive_loss: 78406.0469; val_gene_expr_recon_loss: 102127.7969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446800.7500; val_optim_loss: 446800.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9907; val_auprc_score: 0.9874; val_best_acc_score: 0.9594; val_best_f1_score: 0.9606; train_kl_reg_loss: 5787.7238; train_edge_recon_loss: 258095.7924; train_cond_contrastive_loss: 78745.6105; train_gene_expr_recon_loss: 102656.3650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445285.4821; train_optim_loss: 445285.4821; val_kl_reg_loss: 5673.7207; val_edge_recon_loss: 257826.2656; val_cond_contrastive_loss: 78408.8438; val_gene_expr_recon_loss: 101918.7188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443827.5625; val_optim_loss: 443827.5625
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9912; val_auprc_score: 0.9872; val_best_acc_score: 0.9613; val_best_f1_score: 0.9619; train_kl_reg_loss: 5797.5790; train_edge_recon_loss: 257973.2210; train_cond_contrastive_loss: 78745.4386; train_gene_expr_recon_loss: 102672.1150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445188.3482; train_optim_loss: 445188.3482; val_kl_reg_loss: 5681.3301; val_edge_recon_loss: 258295.3281; val_cond_contrastive_loss: 78408.4766; val_gene_expr_recon_loss: 101713.2266; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444098.3438; val_optim_loss: 444098.3438
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9922; val_auprc_score: 0.9904; val_best_acc_score: 0.9629; val_best_f1_score: 0.9639; train_kl_reg_loss: 5788.9487; train_edge_recon_loss: 257893.4844; train_cond_contrastive_loss: 78737.9375; train_gene_expr_recon_loss: 102342.0324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444762.4018; train_optim_loss: 444762.4018; val_kl_reg_loss: 5696.3115; val_edge_recon_loss: 257071.2812; val_cond_contrastive_loss: 78410.4844; val_gene_expr_recon_loss: 101530.0625; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442708.1250; val_optim_loss: 442708.1250
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9915; val_auprc_score: 0.9899; val_best_acc_score: 0.9635; val_best_f1_score: 0.9645; train_kl_reg_loss: 5786.2695; train_edge_recon_loss: 257567.0402; train_cond_contrastive_loss: 78735.0558; train_gene_expr_recon_loss: 102355.5804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444443.9598; train_optim_loss: 444443.9598; val_kl_reg_loss: 5707.3291; val_edge_recon_loss: 256361.8438; val_cond_contrastive_loss: 78411.1797; val_gene_expr_recon_loss: 101374.5391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441854.8750; val_optim_loss: 441854.8750
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9928; val_auprc_score: 0.9909; val_best_acc_score: 0.9660; val_best_f1_score: 0.9668; train_kl_reg_loss: 5800.8997; train_edge_recon_loss: 257746.2902; train_cond_contrastive_loss: 78725.2712; train_gene_expr_recon_loss: 102046.4766; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444318.9375; train_optim_loss: 444318.9375; val_kl_reg_loss: 5678.7261; val_edge_recon_loss: 256216.5000; val_cond_contrastive_loss: 78411.8438; val_gene_expr_recon_loss: 101182.0469; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441489.1250; val_optim_loss: 441489.1250
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9924; val_auprc_score: 0.9905; val_best_acc_score: 0.9645; val_best_f1_score: 0.9651; train_kl_reg_loss: 5770.8411; train_edge_recon_loss: 258284.2188; train_cond_contrastive_loss: 78728.7567; train_gene_expr_recon_loss: 101882.0982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444665.9152; train_optim_loss: 444665.9152; val_kl_reg_loss: 5697.9775; val_edge_recon_loss: 258752.2500; val_cond_contrastive_loss: 78411.4141; val_gene_expr_recon_loss: 101035.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443896.6250; val_optim_loss: 443896.6250
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9916; val_auprc_score: 0.9868; val_best_acc_score: 0.9627; val_best_f1_score: 0.9633; train_kl_reg_loss: 5783.0991; train_edge_recon_loss: 256738.2054; train_cond_contrastive_loss: 78722.2500; train_gene_expr_recon_loss: 101755.4598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442999.0179; train_optim_loss: 442999.0179; val_kl_reg_loss: 5673.4658; val_edge_recon_loss: 259179.7344; val_cond_contrastive_loss: 78410.4453; val_gene_expr_recon_loss: 100856.4141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444120.0312; val_optim_loss: 444120.0312
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9922; val_auprc_score: 0.9895; val_best_acc_score: 0.9634; val_best_f1_score: 0.9638; train_kl_reg_loss: 5761.0465; train_edge_recon_loss: 257971.4420; train_cond_contrastive_loss: 78723.1652; train_gene_expr_recon_loss: 101469.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443925.5491; train_optim_loss: 443925.5491; val_kl_reg_loss: 5654.0020; val_edge_recon_loss: 261356.0781; val_cond_contrastive_loss: 78410.0703; val_gene_expr_recon_loss: 100706.6328; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446126.7812; val_optim_loss: 446126.7812

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9923; val_auprc_score: 0.9904; val_best_acc_score: 0.9629; val_best_f1_score: 0.9635; train_kl_reg_loss: 5747.5055; train_edge_recon_loss: 256535.2210; train_cond_contrastive_loss: 78726.3917; train_gene_expr_recon_loss: 101363.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442372.1295; train_optim_loss: 442372.1295; val_kl_reg_loss: 5666.7783; val_edge_recon_loss: 258111.2344; val_cond_contrastive_loss: 78410.7422; val_gene_expr_recon_loss: 100676.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442865.0625; val_optim_loss: 442865.0625
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9912; val_auprc_score: 0.9854; val_best_acc_score: 0.9643; val_best_f1_score: 0.9651; train_kl_reg_loss: 5763.8140; train_edge_recon_loss: 257797.4978; train_cond_contrastive_loss: 78717.7723; train_gene_expr_recon_loss: 101671.8549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443950.9286; train_optim_loss: 443950.9286; val_kl_reg_loss: 5671.3267; val_edge_recon_loss: 256314.3438; val_cond_contrastive_loss: 78411.8672; val_gene_expr_recon_loss: 100651.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441049.1875; val_optim_loss: 441049.1875
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9932; val_auprc_score: 0.9919; val_best_acc_score: 0.9643; val_best_f1_score: 0.9648; train_kl_reg_loss: 5762.7398; train_edge_recon_loss: 256725.8259; train_cond_contrastive_loss: 78721.9955; train_gene_expr_recon_loss: 101379.3002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442589.8616; train_optim_loss: 442589.8616; val_kl_reg_loss: 5667.0176; val_edge_recon_loss: 258575.6719; val_cond_contrastive_loss: 78411.3281; val_gene_expr_recon_loss: 100638.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443292.3750; val_optim_loss: 443292.3750
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9923; val_auprc_score: 0.9895; val_best_acc_score: 0.9649; val_best_f1_score: 0.9657; train_kl_reg_loss: 5772.6805; train_edge_recon_loss: 257600.5424; train_cond_contrastive_loss: 78716.3125; train_gene_expr_recon_loss: 101523.1507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443612.6830; train_optim_loss: 443612.6830; val_kl_reg_loss: 5674.3931; val_edge_recon_loss: 256183.3281; val_cond_contrastive_loss: 78412.0000; val_gene_expr_recon_loss: 100621.8359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440891.5625; val_optim_loss: 440891.5625
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9912; val_auprc_score: 0.9872; val_best_acc_score: 0.9639; val_best_f1_score: 0.9647; train_kl_reg_loss: 5756.1849; train_edge_recon_loss: 257561.4219; train_cond_contrastive_loss: 78719.4754; train_gene_expr_recon_loss: 101290.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443327.9152; train_optim_loss: 443327.9152; val_kl_reg_loss: 5657.0967; val_edge_recon_loss: 257229.7188; val_cond_contrastive_loss: 78412.1953; val_gene_expr_recon_loss: 100603.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441902.9062; val_optim_loss: 441902.9062
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9929; val_auprc_score: 0.9913; val_best_acc_score: 0.9648; val_best_f1_score: 0.9658; train_kl_reg_loss: 5743.7409; train_edge_recon_loss: 257272.8638; train_cond_contrastive_loss: 78720.4018; train_gene_expr_recon_loss: 101321.5982; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443058.6027; train_optim_loss: 443058.6027; val_kl_reg_loss: 5656.1084; val_edge_recon_loss: 256796.5156; val_cond_contrastive_loss: 78412.3828; val_gene_expr_recon_loss: 100588.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441453.0000; val_optim_loss: 441453.0000
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9930; val_auprc_score: 0.9915; val_best_acc_score: 0.9671; val_best_f1_score: 0.9677; train_kl_reg_loss: 5742.9120; train_edge_recon_loss: 257680.7232; train_cond_contrastive_loss: 78721.6886; train_gene_expr_recon_loss: 101465.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443611.0982; train_optim_loss: 443611.0982; val_kl_reg_loss: 5647.3740; val_edge_recon_loss: 256829.6562; val_cond_contrastive_loss: 78412.6406; val_gene_expr_recon_loss: 100575.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441465.0000; val_optim_loss: 441465.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9919; val_auprc_score: 0.9887; val_best_acc_score: 0.9643; val_best_f1_score: 0.9651; train_kl_reg_loss: 5737.1938; train_edge_recon_loss: 257020.5469; train_cond_contrastive_loss: 78722.8270; train_gene_expr_recon_loss: 101260.2924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442740.8571; train_optim_loss: 442740.8571; val_kl_reg_loss: 5648.2900; val_edge_recon_loss: 257201.1094; val_cond_contrastive_loss: 78412.8359; val_gene_expr_recon_loss: 100573.4531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441835.6875; val_optim_loss: 441835.6875
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9929; val_auprc_score: 0.9903; val_best_acc_score: 0.9644; val_best_f1_score: 0.9651; train_kl_reg_loss: 5741.0958; train_edge_recon_loss: 257384.2589; train_cond_contrastive_loss: 78720.4208; train_gene_expr_recon_loss: 101343.4475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443189.2188; train_optim_loss: 443189.2188; val_kl_reg_loss: 5653.9336; val_edge_recon_loss: 257039.4531; val_cond_contrastive_loss: 78412.5156; val_gene_expr_recon_loss: 100571.4219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441677.3125; val_optim_loss: 441677.3125
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9914; val_auprc_score: 0.9870; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 5745.0445; train_edge_recon_loss: 257332.8839; train_cond_contrastive_loss: 78719.4922; train_gene_expr_recon_loss: 101436.6607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443234.0893; train_optim_loss: 443234.0893; val_kl_reg_loss: 5658.5684; val_edge_recon_loss: 255700.6719; val_cond_contrastive_loss: 78412.9141; val_gene_expr_recon_loss: 100569.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 440341.9688; val_optim_loss: 440341.9688
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9918; val_auprc_score: 0.9889; val_best_acc_score: 0.9636; val_best_f1_score: 0.9644; train_kl_reg_loss: 5753.9249; train_edge_recon_loss: 257781.0982; train_cond_contrastive_loss: 78717.9420; train_gene_expr_recon_loss: 101397.3225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443650.2812; train_optim_loss: 443650.2812; val_kl_reg_loss: 5658.5771; val_edge_recon_loss: 257709.9531; val_cond_contrastive_loss: 78412.5234; val_gene_expr_recon_loss: 100568.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442349.1875; val_optim_loss: 442349.1875
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9941; val_auprc_score: 0.9928; val_best_acc_score: 0.9689; val_best_f1_score: 0.9695; train_kl_reg_loss: 5748.1536; train_edge_recon_loss: 256730.5491; train_cond_contrastive_loss: 78719.2020; train_gene_expr_recon_loss: 101418.3616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442616.2589; train_optim_loss: 442616.2589; val_kl_reg_loss: 5654.3442; val_edge_recon_loss: 254481.0469; val_cond_contrastive_loss: 78412.8750; val_gene_expr_recon_loss: 100566.1797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439114.4375; val_optim_loss: 439114.4375
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9917; val_auprc_score: 0.9899; val_best_acc_score: 0.9630; val_best_f1_score: 0.9639; train_kl_reg_loss: 5744.1761; train_edge_recon_loss: 256923.2009; train_cond_contrastive_loss: 78718.9208; train_gene_expr_recon_loss: 101425.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442811.9107; train_optim_loss: 442811.9107; val_kl_reg_loss: 5656.7549; val_edge_recon_loss: 258000.6719; val_cond_contrastive_loss: 78412.4922; val_gene_expr_recon_loss: 100564.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442634.3125; val_optim_loss: 442634.3125
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9925; val_auprc_score: 0.9891; val_best_acc_score: 0.9653; val_best_f1_score: 0.9657; train_kl_reg_loss: 5751.8218; train_edge_recon_loss: 256855.1451; train_cond_contrastive_loss: 78718.8828; train_gene_expr_recon_loss: 101517.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442843.4464; train_optim_loss: 442843.4464; val_kl_reg_loss: 5655.8506; val_edge_recon_loss: 258565.2188; val_cond_contrastive_loss: 78412.1797; val_gene_expr_recon_loss: 100562.9688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443196.2188; val_optim_loss: 443196.2188
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9922; val_auprc_score: 0.9886; val_best_acc_score: 0.9653; val_best_f1_score: 0.9661; train_kl_reg_loss: 5748.7899; train_edge_recon_loss: 256756.2433; train_cond_contrastive_loss: 78718.3683; train_gene_expr_recon_loss: 101139.4754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442362.8705; train_optim_loss: 442362.8705; val_kl_reg_loss: 5658.1475; val_edge_recon_loss: 254974.8125; val_cond_contrastive_loss: 78413.0859; val_gene_expr_recon_loss: 100561.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 439607.3750; val_optim_loss: 439607.3750

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9933; val_auprc_score: 0.9918; val_best_acc_score: 0.9668; val_best_f1_score: 0.9671; train_kl_reg_loss: 5749.7073; train_edge_recon_loss: 257578.5960; train_cond_contrastive_loss: 78716.9219; train_gene_expr_recon_loss: 101365.8783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443411.0982; train_optim_loss: 443411.0982; val_kl_reg_loss: 5659.4443; val_edge_recon_loss: 258746.1719; val_cond_contrastive_loss: 78411.4141; val_gene_expr_recon_loss: 100561.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443378.1875; val_optim_loss: 443378.1875
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9933; val_auprc_score: 0.9920; val_best_acc_score: 0.9656; val_best_f1_score: 0.9660; train_kl_reg_loss: 5750.2376; train_edge_recon_loss: 257267.4375; train_cond_contrastive_loss: 78718.4877; train_gene_expr_recon_loss: 101306.5033; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 443042.6696; train_optim_loss: 443042.6696; val_kl_reg_loss: 5655.9941; val_edge_recon_loss: 258145.4219; val_cond_contrastive_loss: 78412.3203; val_gene_expr_recon_loss: 100561.0078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442774.7188; val_optim_loss: 442774.7188
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9920; val_auprc_score: 0.9881; val_best_acc_score: 0.9645; val_best_f1_score: 0.9654; train_kl_reg_loss: 5751.2360; train_edge_recon_loss: 256912.3705; train_cond_contrastive_loss: 78718.7690; train_gene_expr_recon_loss: 101169.2422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 442551.6250; train_optim_loss: 442551.6250; val_kl_reg_loss: 5659.2471; val_edge_recon_loss: 257359.2344; val_cond_contrastive_loss: 78412.3047; val_gene_expr_recon_loss: 100560.8516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441991.6250; val_optim_loss: 441991.6250

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 6 min 1 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
Val AUROC score: 0.9918
Val AUPRC score: 0.9895
Val best accuracy score: 0.9646
Val best F1 score: 0.9652
Val gene expr MSE score: 1.4356
Duration of model training in run 8: 0 hours, 6 minutes and 5 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7631; val_auprc_score: 0.7886; val_best_acc_score: 0.6675; val_best_f1_score: 0.7175; train_kl_reg_loss: 6707.4266; train_edge_recon_loss: 355526.1493; train_cond_contrastive_loss: 102215.3212; train_gene_expr_recon_loss: 128956.0799; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 593404.9792; train_optim_loss: 593404.9792; val_kl_reg_loss: 7710.1479; val_edge_recon_loss: 396268.7812; val_cond_contrastive_loss: 78334.9062; val_gene_expr_recon_loss: 116259.3281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 598573.1875; val_optim_loss: 598573.1875
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7417; val_auprc_score: 0.7642; val_best_acc_score: 0.6561; val_best_f1_score: 0.7124; train_kl_reg_loss: 5926.3289; train_edge_recon_loss: 348855.7292; train_cond_contrastive_loss: 86750.2891; train_gene_expr_recon_loss: 116866.3507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 558398.6944; train_optim_loss: 558398.6944; val_kl_reg_loss: 3599.3164; val_edge_recon_loss: 343035.0625; val_cond_contrastive_loss: 78382.7266; val_gene_expr_recon_loss: 114152.9141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 539170.0000; val_optim_loss: 539170.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7490; val_auprc_score: 0.7711; val_best_acc_score: 0.6705; val_best_f1_score: 0.7072; train_kl_reg_loss: 3954.8039; train_edge_recon_loss: 321890.7604; train_cond_contrastive_loss: 82493.2161; train_gene_expr_recon_loss: 115160.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 523499.5417; train_optim_loss: 523499.5417; val_kl_reg_loss: 4557.6001; val_edge_recon_loss: 322962.9688; val_cond_contrastive_loss: 78343.0391; val_gene_expr_recon_loss: 113067.3828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 518930.9688; val_optim_loss: 518930.9688
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8233; val_auprc_score: 0.8226; val_best_acc_score: 0.7358; val_best_f1_score: 0.7636; train_kl_reg_loss: 4757.3779; train_edge_recon_loss: 305487.1944; train_cond_contrastive_loss: 78937.8082; train_gene_expr_recon_loss: 114112.0582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 503294.4236; train_optim_loss: 503294.4236; val_kl_reg_loss: 5015.8975; val_edge_recon_loss: 292171.3125; val_cond_contrastive_loss: 78354.9844; val_gene_expr_recon_loss: 112188.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 487730.2188; val_optim_loss: 487730.2188
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8589; val_auprc_score: 0.8416; val_best_acc_score: 0.7790; val_best_f1_score: 0.8009; train_kl_reg_loss: 5641.4518; train_edge_recon_loss: 285269.5590; train_cond_contrastive_loss: 78757.9627; train_gene_expr_recon_loss: 113137.0825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 482806.0660; train_optim_loss: 482806.0660; val_kl_reg_loss: 6115.6680; val_edge_recon_loss: 282288.2188; val_cond_contrastive_loss: 78361.5000; val_gene_expr_recon_loss: 111179.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 477944.3750; val_optim_loss: 477944.3750
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8778; val_auprc_score: 0.8517; val_best_acc_score: 0.8070; val_best_f1_score: 0.8235; train_kl_reg_loss: 6219.3204; train_edge_recon_loss: 279311.0833; train_cond_contrastive_loss: 78869.3620; train_gene_expr_recon_loss: 112168.8941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 476568.6632; train_optim_loss: 476568.6632; val_kl_reg_loss: 6131.6455; val_edge_recon_loss: 278995.6562; val_cond_contrastive_loss: 78365.3906; val_gene_expr_recon_loss: 110373.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 473865.9062; val_optim_loss: 473865.9062
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9035; val_auprc_score: 0.8828; val_best_acc_score: 0.8344; val_best_f1_score: 0.8483; train_kl_reg_loss: 6220.1560; train_edge_recon_loss: 273874.0417; train_cond_contrastive_loss: 78972.2769; train_gene_expr_recon_loss: 111511.0764; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 470577.5521; train_optim_loss: 470577.5521; val_kl_reg_loss: 6146.7578; val_edge_recon_loss: 273798.1875; val_cond_contrastive_loss: 78376.9141; val_gene_expr_recon_loss: 109802.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 468124.0625; val_optim_loss: 468124.0625
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9300; val_auprc_score: 0.9171; val_best_acc_score: 0.8605; val_best_f1_score: 0.8700; train_kl_reg_loss: 6150.1304; train_edge_recon_loss: 271016.6007; train_cond_contrastive_loss: 78964.1502; train_gene_expr_recon_loss: 110887.3924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 467018.2778; train_optim_loss: 467018.2778; val_kl_reg_loss: 6027.7588; val_edge_recon_loss: 272705.2188; val_cond_contrastive_loss: 78387.6328; val_gene_expr_recon_loss: 109194.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 466315.1875; val_optim_loss: 466315.1875
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9460; val_auprc_score: 0.9340; val_best_acc_score: 0.8805; val_best_f1_score: 0.8874; train_kl_reg_loss: 6083.2852; train_edge_recon_loss: 268873.1146; train_cond_contrastive_loss: 78828.1207; train_gene_expr_recon_loss: 110304.2665; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 464088.7882; train_optim_loss: 464088.7882; val_kl_reg_loss: 6076.5723; val_edge_recon_loss: 267258.5312; val_cond_contrastive_loss: 78388.2266; val_gene_expr_recon_loss: 108675.2188; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460398.5312; val_optim_loss: 460398.5312
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9565; val_auprc_score: 0.9457; val_best_acc_score: 0.8971; val_best_f1_score: 0.9004; train_kl_reg_loss: 6201.9467; train_edge_recon_loss: 267497.3056; train_cond_contrastive_loss: 78729.9983; train_gene_expr_recon_loss: 109893.9002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 462323.1528; train_optim_loss: 462323.1528; val_kl_reg_loss: 6163.4795; val_edge_recon_loss: 267495.8438; val_cond_contrastive_loss: 78382.7969; val_gene_expr_recon_loss: 108214.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460256.2812; val_optim_loss: 460256.2812
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9654; val_auprc_score: 0.9564; val_best_acc_score: 0.9093; val_best_f1_score: 0.9114; train_kl_reg_loss: 6153.3707; train_edge_recon_loss: 266300.7604; train_cond_contrastive_loss: 78732.6936; train_gene_expr_recon_loss: 109346.8377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 460533.6667; train_optim_loss: 460533.6667; val_kl_reg_loss: 6018.9126; val_edge_recon_loss: 265607.7188; val_cond_contrastive_loss: 78381.9141; val_gene_expr_recon_loss: 107733.0938; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 457741.6250; val_optim_loss: 457741.6250
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9711; val_auprc_score: 0.9637; val_best_acc_score: 0.9195; val_best_f1_score: 0.9220; train_kl_reg_loss: 5955.3541; train_edge_recon_loss: 265992.1736; train_cond_contrastive_loss: 78748.8785; train_gene_expr_recon_loss: 108904.9167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 459601.3194; train_optim_loss: 459601.3194; val_kl_reg_loss: 5744.3623; val_edge_recon_loss: 267749.7500; val_cond_contrastive_loss: 78384.7109; val_gene_expr_recon_loss: 107290.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 459169.6250; val_optim_loss: 459169.6250
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9768; val_auprc_score: 0.9715; val_best_acc_score: 0.9310; val_best_f1_score: 0.9328; train_kl_reg_loss: 5789.4591; train_edge_recon_loss: 264504.5938; train_cond_contrastive_loss: 78730.0069; train_gene_expr_recon_loss: 108404.2778; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457428.3403; train_optim_loss: 457428.3403; val_kl_reg_loss: 5724.1523; val_edge_recon_loss: 264508.2500; val_cond_contrastive_loss: 78386.4688; val_gene_expr_recon_loss: 106844.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455463.3438; val_optim_loss: 455463.3438
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9817; val_auprc_score: 0.9756; val_best_acc_score: 0.9370; val_best_f1_score: 0.9384; train_kl_reg_loss: 5758.3806; train_edge_recon_loss: 263216.0920; train_cond_contrastive_loss: 78700.2509; train_gene_expr_recon_loss: 107964.3715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 455639.1076; train_optim_loss: 455639.1076; val_kl_reg_loss: 5686.4316; val_edge_recon_loss: 264426.6562; val_cond_contrastive_loss: 78384.3359; val_gene_expr_recon_loss: 106441.1875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454938.6250; val_optim_loss: 454938.6250
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9853; val_auprc_score: 0.9824; val_best_acc_score: 0.9435; val_best_f1_score: 0.9444; train_kl_reg_loss: 5743.0528; train_edge_recon_loss: 262037.9705; train_cond_contrastive_loss: 78690.2526; train_gene_expr_recon_loss: 107564.1510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 454035.4306; train_optim_loss: 454035.4306; val_kl_reg_loss: 5643.2725; val_edge_recon_loss: 261060.8281; val_cond_contrastive_loss: 78381.2422; val_gene_expr_recon_loss: 106013.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451099.3125; val_optim_loss: 451099.3125
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9844; val_auprc_score: 0.9811; val_best_acc_score: 0.9442; val_best_f1_score: 0.9451; train_kl_reg_loss: 5749.7965; train_edge_recon_loss: 261211.7378; train_cond_contrastive_loss: 78681.3099; train_gene_expr_recon_loss: 107185.7370; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452828.5799; train_optim_loss: 452828.5799; val_kl_reg_loss: 5674.6304; val_edge_recon_loss: 262445.5625; val_cond_contrastive_loss: 78379.2031; val_gene_expr_recon_loss: 105597.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452097.1250; val_optim_loss: 452097.1250
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9876; val_auprc_score: 0.9856; val_best_acc_score: 0.9483; val_best_f1_score: 0.9496; train_kl_reg_loss: 5766.4839; train_edge_recon_loss: 260556.4201; train_cond_contrastive_loss: 78679.6120; train_gene_expr_recon_loss: 106711.1571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451713.6701; train_optim_loss: 451713.6701; val_kl_reg_loss: 5730.1016; val_edge_recon_loss: 257792.8281; val_cond_contrastive_loss: 78379.9219; val_gene_expr_recon_loss: 105143.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447046.2500; val_optim_loss: 447046.2500
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9863; val_auprc_score: 0.9824; val_best_acc_score: 0.9468; val_best_f1_score: 0.9480; train_kl_reg_loss: 5760.9349; train_edge_recon_loss: 259652.9288; train_cond_contrastive_loss: 78691.1050; train_gene_expr_recon_loss: 106343.2448; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450448.2222; train_optim_loss: 450448.2222; val_kl_reg_loss: 5717.3994; val_edge_recon_loss: 260514.6719; val_cond_contrastive_loss: 78379.0078; val_gene_expr_recon_loss: 104707.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449318.9375; val_optim_loss: 449318.9375
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9880; val_auprc_score: 0.9822; val_best_acc_score: 0.9508; val_best_f1_score: 0.9515; train_kl_reg_loss: 5766.8392; train_edge_recon_loss: 258803.1146; train_cond_contrastive_loss: 78701.6493; train_gene_expr_recon_loss: 105896.7231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449168.3333; train_optim_loss: 449168.3333; val_kl_reg_loss: 5706.4199; val_edge_recon_loss: 262641.7812; val_cond_contrastive_loss: 78380.3359; val_gene_expr_recon_loss: 104270.6094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450999.1250; val_optim_loss: 450999.1250
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9888; val_auprc_score: 0.9854; val_best_acc_score: 0.9527; val_best_f1_score: 0.9538; train_kl_reg_loss: 5795.1073; train_edge_recon_loss: 258748.8507; train_cond_contrastive_loss: 78689.1901; train_gene_expr_recon_loss: 105502.9965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448736.1493; train_optim_loss: 448736.1493; val_kl_reg_loss: 5717.6260; val_edge_recon_loss: 258946.6562; val_cond_contrastive_loss: 78380.3359; val_gene_expr_recon_loss: 103905.9531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446950.5625; val_optim_loss: 446950.5625
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9880; val_auprc_score: 0.9828; val_best_acc_score: 0.9512; val_best_f1_score: 0.9523; train_kl_reg_loss: 5764.6647; train_edge_recon_loss: 258986.1684; train_cond_contrastive_loss: 78688.3785; train_gene_expr_recon_loss: 105102.1007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448541.3125; train_optim_loss: 448541.3125; val_kl_reg_loss: 5730.4492; val_edge_recon_loss: 259026.8594; val_cond_contrastive_loss: 78380.6719; val_gene_expr_recon_loss: 103547.2812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446685.2812; val_optim_loss: 446685.2812
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9910; val_auprc_score: 0.9892; val_best_acc_score: 0.9582; val_best_f1_score: 0.9590; train_kl_reg_loss: 5784.2064; train_edge_recon_loss: 259169.2517; train_cond_contrastive_loss: 78690.9253; train_gene_expr_recon_loss: 104739.5556; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448383.9340; train_optim_loss: 448383.9340; val_kl_reg_loss: 5686.1108; val_edge_recon_loss: 258502.1875; val_cond_contrastive_loss: 78382.2891; val_gene_expr_recon_loss: 103204.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445775.1875; val_optim_loss: 445775.1875
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9904; val_auprc_score: 0.9875; val_best_acc_score: 0.9592; val_best_f1_score: 0.9600; train_kl_reg_loss: 5766.3765; train_edge_recon_loss: 257877.6476; train_cond_contrastive_loss: 78695.1458; train_gene_expr_recon_loss: 104370.1293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446709.3021; train_optim_loss: 446709.3021; val_kl_reg_loss: 5704.9238; val_edge_recon_loss: 258973.3906; val_cond_contrastive_loss: 78383.9531; val_gene_expr_recon_loss: 102899.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445962.1562; val_optim_loss: 445962.1562
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9922; val_auprc_score: 0.9888; val_best_acc_score: 0.9625; val_best_f1_score: 0.9632; train_kl_reg_loss: 5756.7852; train_edge_recon_loss: 258600.2500; train_cond_contrastive_loss: 78695.9601; train_gene_expr_recon_loss: 104150.6172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447203.6042; train_optim_loss: 447203.6042; val_kl_reg_loss: 5727.2969; val_edge_recon_loss: 256397.7188; val_cond_contrastive_loss: 78385.6484; val_gene_expr_recon_loss: 102595.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443106.5000; val_optim_loss: 443106.5000
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9915; val_auprc_score: 0.9878; val_best_acc_score: 0.9615; val_best_f1_score: 0.9627; train_kl_reg_loss: 5754.6306; train_edge_recon_loss: 257979.2552; train_cond_contrastive_loss: 78704.8108; train_gene_expr_recon_loss: 103834.6536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446273.3576; train_optim_loss: 446273.3576; val_kl_reg_loss: 5746.0654; val_edge_recon_loss: 257532.8594; val_cond_contrastive_loss: 78386.9766; val_gene_expr_recon_loss: 102308.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443974.6875; val_optim_loss: 443974.6875
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9905; val_auprc_score: 0.9874; val_best_acc_score: 0.9600; val_best_f1_score: 0.9609; train_kl_reg_loss: 5756.4134; train_edge_recon_loss: 257442.0399; train_cond_contrastive_loss: 78711.6762; train_gene_expr_recon_loss: 103518.8273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445428.9618; train_optim_loss: 445428.9618; val_kl_reg_loss: 5675.8652; val_edge_recon_loss: 259664.5312; val_cond_contrastive_loss: 78388.0469; val_gene_expr_recon_loss: 102088.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445816.7500; val_optim_loss: 445816.7500
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9924; val_auprc_score: 0.9894; val_best_acc_score: 0.9645; val_best_f1_score: 0.9651; train_kl_reg_loss: 5728.2514; train_edge_recon_loss: 257966.8993; train_cond_contrastive_loss: 78717.4427; train_gene_expr_recon_loss: 103248.8542; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445661.4444; train_optim_loss: 445661.4444; val_kl_reg_loss: 5672.5210; val_edge_recon_loss: 257903.2812; val_cond_contrastive_loss: 78389.0938; val_gene_expr_recon_loss: 101844.6719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443809.5625; val_optim_loss: 443809.5625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9912; val_auprc_score: 0.9871; val_best_acc_score: 0.9616; val_best_f1_score: 0.9624; train_kl_reg_loss: 5728.3691; train_edge_recon_loss: 257780.9219; train_cond_contrastive_loss: 78713.2873; train_gene_expr_recon_loss: 103140.2526; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445362.8264; train_optim_loss: 445362.8264; val_kl_reg_loss: 5641.4087; val_edge_recon_loss: 259068.0156; val_cond_contrastive_loss: 78388.6484; val_gene_expr_recon_loss: 101796.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444894.8438; val_optim_loss: 444894.8438
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9926; val_auprc_score: 0.9887; val_best_acc_score: 0.9664; val_best_f1_score: 0.9670; train_kl_reg_loss: 5719.4320; train_edge_recon_loss: 257290.7691; train_cond_contrastive_loss: 78716.1658; train_gene_expr_recon_loss: 103023.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444750.0104; train_optim_loss: 444750.0104; val_kl_reg_loss: 5651.7046; val_edge_recon_loss: 257558.1719; val_cond_contrastive_loss: 78388.8438; val_gene_expr_recon_loss: 101765.5547; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443364.2812; val_optim_loss: 443364.2812
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9929; val_auprc_score: 0.9903; val_best_acc_score: 0.9661; val_best_f1_score: 0.9672; train_kl_reg_loss: 5712.4824; train_edge_recon_loss: 257254.2639; train_cond_contrastive_loss: 78722.1997; train_gene_expr_recon_loss: 103039.8880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444728.8368; train_optim_loss: 444728.8368; val_kl_reg_loss: 5638.4902; val_edge_recon_loss: 255277.2500; val_cond_contrastive_loss: 78389.0547; val_gene_expr_recon_loss: 101741.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441046.6875; val_optim_loss: 441046.6875
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9927; val_auprc_score: 0.9903; val_best_acc_score: 0.9656; val_best_f1_score: 0.9662; train_kl_reg_loss: 5709.4532; train_edge_recon_loss: 257604.9931; train_cond_contrastive_loss: 78717.9175; train_gene_expr_recon_loss: 102906.5391; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444938.8958; train_optim_loss: 444938.8958; val_kl_reg_loss: 5633.7910; val_edge_recon_loss: 258595.7656; val_cond_contrastive_loss: 78388.8281; val_gene_expr_recon_loss: 101714.3906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444332.7500; val_optim_loss: 444332.7500
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9919; val_auprc_score: 0.9888; val_best_acc_score: 0.9641; val_best_f1_score: 0.9650; train_kl_reg_loss: 5706.7714; train_edge_recon_loss: 257229.6059; train_cond_contrastive_loss: 78720.8003; train_gene_expr_recon_loss: 102929.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444586.2535; train_optim_loss: 444586.2535; val_kl_reg_loss: 5640.5703; val_edge_recon_loss: 257794.5312; val_cond_contrastive_loss: 78389.2656; val_gene_expr_recon_loss: 101688.3125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443512.6875; val_optim_loss: 443512.6875
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9918; val_auprc_score: 0.9884; val_best_acc_score: 0.9639; val_best_f1_score: 0.9648; train_kl_reg_loss: 5704.0203; train_edge_recon_loss: 257757.6007; train_cond_contrastive_loss: 78721.4219; train_gene_expr_recon_loss: 102971.2708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445154.3194; train_optim_loss: 445154.3194; val_kl_reg_loss: 5624.8052; val_edge_recon_loss: 257026.6719; val_cond_contrastive_loss: 78389.1016; val_gene_expr_recon_loss: 101663.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442703.9375; val_optim_loss: 442703.9375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9926; val_auprc_score: 0.9888; val_best_acc_score: 0.9663; val_best_f1_score: 0.9671; train_kl_reg_loss: 5696.3621; train_edge_recon_loss: 256826.7101; train_cond_contrastive_loss: 78726.5556; train_gene_expr_recon_loss: 102897.4575; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444147.0868; train_optim_loss: 444147.0868; val_kl_reg_loss: 5624.6465; val_edge_recon_loss: 256949.1250; val_cond_contrastive_loss: 78389.1484; val_gene_expr_recon_loss: 101660.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442623.2812; val_optim_loss: 442623.2812
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9919; val_auprc_score: 0.9903; val_best_acc_score: 0.9630; val_best_f1_score: 0.9640; train_kl_reg_loss: 5698.0408; train_edge_recon_loss: 257746.7500; train_cond_contrastive_loss: 78725.7326; train_gene_expr_recon_loss: 102889.9523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445060.4826; train_optim_loss: 445060.4826; val_kl_reg_loss: 5628.0181; val_edge_recon_loss: 256607.3906; val_cond_contrastive_loss: 78389.3359; val_gene_expr_recon_loss: 101657.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 442282.6562; val_optim_loss: 442282.6562
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9911; val_auprc_score: 0.9877; val_best_acc_score: 0.9638; val_best_f1_score: 0.9649; train_kl_reg_loss: 5701.4735; train_edge_recon_loss: 257252.0260; train_cond_contrastive_loss: 78721.5122; train_gene_expr_recon_loss: 102878.0816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444553.0938; train_optim_loss: 444553.0938; val_kl_reg_loss: 5634.3652; val_edge_recon_loss: 255402.8594; val_cond_contrastive_loss: 78389.6016; val_gene_expr_recon_loss: 101655.5078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441082.3125; val_optim_loss: 441082.3125

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 4 min 40 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
Val AUROC score: 0.9918
Val AUPRC score: 0.9887
Val best accuracy score: 0.9621
Val best F1 score: 0.9628
Val gene expr MSE score: 1.4267
Duration of model training in run 9: 0 hours, 4 minutes and 45 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.05
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['encoder', 'gene_expr_decoder']
ENCODER -> n_input: 351, n_cond_embed_input: 351, n_layers: 1, n_hidden: 351, n_latent: 1358, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 0, n_cond_embed_output: 1358, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1358, n_cond_embed_input: 351, n_addon_input: 0, n_output: 702
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 141197
Number of validation edges: 15688
Edge batch size: 16384
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.7919; val_auprc_score: 0.8221; val_best_acc_score: 0.7102; val_best_f1_score: 0.7212; train_kl_reg_loss: 6337.2850; train_edge_recon_loss: 355183.7014; train_cond_contrastive_loss: 103400.2431; train_gene_expr_recon_loss: 128985.3186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 593906.5486; train_optim_loss: 593906.5486; val_kl_reg_loss: 7566.2617; val_edge_recon_loss: 399395.6562; val_cond_contrastive_loss: 78333.7969; val_gene_expr_recon_loss: 117198.2578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 602493.9375; val_optim_loss: 602493.9375
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.7629; val_auprc_score: 0.7830; val_best_acc_score: 0.6755; val_best_f1_score: 0.7218; train_kl_reg_loss: 5326.9248; train_edge_recon_loss: 351000.1736; train_cond_contrastive_loss: 87403.7977; train_gene_expr_recon_loss: 117277.9549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 561008.8611; train_optim_loss: 561008.8611; val_kl_reg_loss: 3080.6714; val_edge_recon_loss: 342773.0625; val_cond_contrastive_loss: 78396.5078; val_gene_expr_recon_loss: 115862.1406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 540112.3750; val_optim_loss: 540112.3750
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.7884; val_auprc_score: 0.8016; val_best_acc_score: 0.6997; val_best_f1_score: 0.7372; train_kl_reg_loss: 3619.6410; train_edge_recon_loss: 320050.7604; train_cond_contrastive_loss: 83331.4288; train_gene_expr_recon_loss: 115817.0122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 522818.8333; train_optim_loss: 522818.8333; val_kl_reg_loss: 4960.2266; val_edge_recon_loss: 303374.7500; val_cond_contrastive_loss: 78350.7266; val_gene_expr_recon_loss: 114588.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 501273.8125; val_optim_loss: 501273.8125
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8473; val_auprc_score: 0.8365; val_best_acc_score: 0.7648; val_best_f1_score: 0.7932; train_kl_reg_loss: 6074.1449; train_edge_recon_loss: 293310.2222; train_cond_contrastive_loss: 78638.0069; train_gene_expr_recon_loss: 114654.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 492677.3264; train_optim_loss: 492677.3264; val_kl_reg_loss: 6876.7314; val_edge_recon_loss: 282849.4062; val_cond_contrastive_loss: 78362.7734; val_gene_expr_recon_loss: 113567.4609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 481656.3750; val_optim_loss: 481656.3750
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8674; val_auprc_score: 0.8464; val_best_acc_score: 0.7886; val_best_f1_score: 0.8101; train_kl_reg_loss: 6643.9068; train_edge_recon_loss: 280624.1736; train_cond_contrastive_loss: 78666.6814; train_gene_expr_recon_loss: 113564.3064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 479499.0625; train_optim_loss: 479499.0625; val_kl_reg_loss: 6083.7314; val_edge_recon_loss: 282066.3750; val_cond_contrastive_loss: 78361.3984; val_gene_expr_recon_loss: 112522.5781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 479034.0625; val_optim_loss: 479034.0625
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8913; val_auprc_score: 0.8617; val_best_acc_score: 0.8247; val_best_f1_score: 0.8398; train_kl_reg_loss: 5923.1099; train_edge_recon_loss: 277166.1771; train_cond_contrastive_loss: 79016.2569; train_gene_expr_recon_loss: 112641.7005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 474747.2396; train_optim_loss: 474747.2396; val_kl_reg_loss: 6018.5596; val_edge_recon_loss: 276083.0000; val_cond_contrastive_loss: 78366.1250; val_gene_expr_recon_loss: 111853.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 472320.9688; val_optim_loss: 472320.9688
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9208; val_auprc_score: 0.9035; val_best_acc_score: 0.8507; val_best_f1_score: 0.8622; train_kl_reg_loss: 6241.4364; train_edge_recon_loss: 272664.3646; train_cond_contrastive_loss: 78948.9852; train_gene_expr_recon_loss: 112038.8273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 469893.6007; train_optim_loss: 469893.6007; val_kl_reg_loss: 6191.2056; val_edge_recon_loss: 271884.6562; val_cond_contrastive_loss: 78383.3281; val_gene_expr_recon_loss: 111264.8047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 467724.0000; val_optim_loss: 467724.0000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9421; val_auprc_score: 0.9317; val_best_acc_score: 0.8774; val_best_f1_score: 0.8843; train_kl_reg_loss: 6075.7647; train_edge_recon_loss: 269040.2882; train_cond_contrastive_loss: 78845.5825; train_gene_expr_recon_loss: 111463.7413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 465425.3750; train_optim_loss: 465425.3750; val_kl_reg_loss: 6058.6660; val_edge_recon_loss: 266873.0000; val_cond_contrastive_loss: 78395.3516; val_gene_expr_recon_loss: 110771.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462098.4688; val_optim_loss: 462098.4688
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9554; val_auprc_score: 0.9462; val_best_acc_score: 0.8945; val_best_f1_score: 0.8987; train_kl_reg_loss: 6216.7804; train_edge_recon_loss: 267618.7535; train_cond_contrastive_loss: 78732.4549; train_gene_expr_recon_loss: 111079.9479; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 463647.9340; train_optim_loss: 463647.9340; val_kl_reg_loss: 6318.9072; val_edge_recon_loss: 267344.7812; val_cond_contrastive_loss: 78392.8984; val_gene_expr_recon_loss: 110305.6484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 462362.2500; val_optim_loss: 462362.2500
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9608; val_auprc_score: 0.9526; val_best_acc_score: 0.9051; val_best_f1_score: 0.9093; train_kl_reg_loss: 6273.6270; train_edge_recon_loss: 265826.7882; train_cond_contrastive_loss: 78720.0356; train_gene_expr_recon_loss: 110582.9549; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461403.4132; train_optim_loss: 461403.4132; val_kl_reg_loss: 6173.3057; val_edge_recon_loss: 265617.7500; val_cond_contrastive_loss: 78389.8438; val_gene_expr_recon_loss: 109846.2969; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 460027.1875; val_optim_loss: 460027.1875
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9691; val_auprc_score: 0.9621; val_best_acc_score: 0.9193; val_best_f1_score: 0.9219; train_kl_reg_loss: 6061.4459; train_edge_recon_loss: 266284.6285; train_cond_contrastive_loss: 78770.6111; train_gene_expr_recon_loss: 110094.7847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 461211.4792; train_optim_loss: 461211.4792; val_kl_reg_loss: 5927.1816; val_edge_recon_loss: 264946.2812; val_cond_contrastive_loss: 78390.6250; val_gene_expr_recon_loss: 109382.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458646.2812; val_optim_loss: 458646.2812
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9753; val_auprc_score: 0.9695; val_best_acc_score: 0.9258; val_best_f1_score: 0.9282; train_kl_reg_loss: 5899.3892; train_edge_recon_loss: 264644.6285; train_cond_contrastive_loss: 78758.4340; train_gene_expr_recon_loss: 109628.9922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 458931.4410; train_optim_loss: 458931.4410; val_kl_reg_loss: 5811.2314; val_edge_recon_loss: 265041.5312; val_cond_contrastive_loss: 78391.7109; val_gene_expr_recon_loss: 108915.7344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 458160.1875; val_optim_loss: 458160.1875
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9796; val_auprc_score: 0.9752; val_best_acc_score: 0.9324; val_best_f1_score: 0.9353; train_kl_reg_loss: 5802.9918; train_edge_recon_loss: 263149.4983; train_cond_contrastive_loss: 78750.5035; train_gene_expr_recon_loss: 109302.8264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 457005.8125; train_optim_loss: 457005.8125; val_kl_reg_loss: 5788.7329; val_edge_recon_loss: 261922.8125; val_cond_contrastive_loss: 78392.7734; val_gene_expr_recon_loss: 108472.3047; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 454576.6250; val_optim_loss: 454576.6250
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9840; val_auprc_score: 0.9781; val_best_acc_score: 0.9422; val_best_f1_score: 0.9436; train_kl_reg_loss: 5825.6007; train_edge_recon_loss: 262751.1198; train_cond_contrastive_loss: 78732.0217; train_gene_expr_recon_loss: 108744.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 456053.0972; train_optim_loss: 456053.0972; val_kl_reg_loss: 5778.9927; val_edge_recon_loss: 263015.1875; val_cond_contrastive_loss: 78389.6406; val_gene_expr_recon_loss: 108026.1094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 455209.9375; val_optim_loss: 455209.9375
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9860; val_auprc_score: 0.9812; val_best_acc_score: 0.9478; val_best_f1_score: 0.9489; train_kl_reg_loss: 5844.4871; train_edge_recon_loss: 260392.1111; train_cond_contrastive_loss: 78713.9062; train_gene_expr_recon_loss: 108340.6415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 453291.1493; train_optim_loss: 453291.1493; val_kl_reg_loss: 5845.3496; val_edge_recon_loss: 261029.2188; val_cond_contrastive_loss: 78387.9531; val_gene_expr_recon_loss: 107645.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 452908.2500; val_optim_loss: 452908.2500
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9861; val_auprc_score: 0.9825; val_best_acc_score: 0.9480; val_best_f1_score: 0.9496; train_kl_reg_loss: 5834.6290; train_edge_recon_loss: 259697.3993; train_cond_contrastive_loss: 78702.5825; train_gene_expr_recon_loss: 107871.1050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452105.7118; train_optim_loss: 452105.7118; val_kl_reg_loss: 5857.3550; val_edge_recon_loss: 259551.7344; val_cond_contrastive_loss: 78385.6094; val_gene_expr_recon_loss: 107256.7109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 451051.4062; val_optim_loss: 451051.4062
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9865; val_auprc_score: 0.9824; val_best_acc_score: 0.9500; val_best_f1_score: 0.9516; train_kl_reg_loss: 5855.0334; train_edge_recon_loss: 260228.0035; train_cond_contrastive_loss: 78698.7769; train_gene_expr_recon_loss: 107534.3733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 452316.1771; train_optim_loss: 452316.1771; val_kl_reg_loss: 5778.3555; val_edge_recon_loss: 259540.3438; val_cond_contrastive_loss: 78383.3750; val_gene_expr_recon_loss: 106830.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450532.4375; val_optim_loss: 450532.4375
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9876; val_auprc_score: 0.9839; val_best_acc_score: 0.9512; val_best_f1_score: 0.9528; train_kl_reg_loss: 5853.5798; train_edge_recon_loss: 259865.3385; train_cond_contrastive_loss: 78701.4089; train_gene_expr_recon_loss: 107065.3073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 451485.6285; train_optim_loss: 451485.6285; val_kl_reg_loss: 5799.5811; val_edge_recon_loss: 259355.0938; val_cond_contrastive_loss: 78382.9844; val_gene_expr_recon_loss: 106412.9453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449950.6250; val_optim_loss: 449950.6250
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9880; val_auprc_score: 0.9833; val_best_acc_score: 0.9524; val_best_f1_score: 0.9533; train_kl_reg_loss: 5820.2249; train_edge_recon_loss: 259240.3472; train_cond_contrastive_loss: 78700.0556; train_gene_expr_recon_loss: 106616.4123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 450377.0417; train_optim_loss: 450377.0417; val_kl_reg_loss: 5802.5117; val_edge_recon_loss: 260587.3594; val_cond_contrastive_loss: 78383.8594; val_gene_expr_recon_loss: 105984.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 450758.5312; val_optim_loss: 450758.5312
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9889; val_auprc_score: 0.9855; val_best_acc_score: 0.9539; val_best_f1_score: 0.9554; train_kl_reg_loss: 5812.3069; train_edge_recon_loss: 258360.7326; train_cond_contrastive_loss: 78697.6285; train_gene_expr_recon_loss: 106349.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449220.0451; train_optim_loss: 449220.0451; val_kl_reg_loss: 5772.1812; val_edge_recon_loss: 256310.6094; val_cond_contrastive_loss: 78386.7422; val_gene_expr_recon_loss: 105606.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446076.4375; val_optim_loss: 446076.4375
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9898; val_auprc_score: 0.9853; val_best_acc_score: 0.9571; val_best_f1_score: 0.9581; train_kl_reg_loss: 5783.3112; train_edge_recon_loss: 258819.6302; train_cond_contrastive_loss: 78706.6649; train_gene_expr_recon_loss: 105948.0564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 449257.6701; train_optim_loss: 449257.6701; val_kl_reg_loss: 5711.4702; val_edge_recon_loss: 258668.8750; val_cond_contrastive_loss: 78391.0234; val_gene_expr_recon_loss: 105270.2656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 448041.6250; val_optim_loss: 448041.6250
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9889; val_auprc_score: 0.9843; val_best_acc_score: 0.9581; val_best_f1_score: 0.9589; train_kl_reg_loss: 5765.4752; train_edge_recon_loss: 258792.3924; train_cond_contrastive_loss: 78705.6172; train_gene_expr_recon_loss: 105595.1788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448858.6597; train_optim_loss: 448858.6597; val_kl_reg_loss: 5737.3159; val_edge_recon_loss: 260139.7656; val_cond_contrastive_loss: 78394.2422; val_gene_expr_recon_loss: 104932.2031; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 449203.5625; val_optim_loss: 449203.5625
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9904; val_auprc_score: 0.9870; val_best_acc_score: 0.9578; val_best_f1_score: 0.9589; train_kl_reg_loss: 5764.7817; train_edge_recon_loss: 258804.9306; train_cond_contrastive_loss: 78711.2595; train_gene_expr_recon_loss: 105309.9123; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 448590.8715; train_optim_loss: 448590.8715; val_kl_reg_loss: 5698.6523; val_edge_recon_loss: 256690.8594; val_cond_contrastive_loss: 78397.1172; val_gene_expr_recon_loss: 104608.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445395.3750; val_optim_loss: 445395.3750
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9913; val_auprc_score: 0.9891; val_best_acc_score: 0.9609; val_best_f1_score: 0.9618; train_kl_reg_loss: 5745.8821; train_edge_recon_loss: 257678.7396; train_cond_contrastive_loss: 78733.8333; train_gene_expr_recon_loss: 104970.0260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447128.4792; train_optim_loss: 447128.4792; val_kl_reg_loss: 5722.5371; val_edge_recon_loss: 258913.1875; val_cond_contrastive_loss: 78397.6719; val_gene_expr_recon_loss: 104298.7422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447332.1250; val_optim_loss: 447332.1250
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9922; val_auprc_score: 0.9894; val_best_acc_score: 0.9616; val_best_f1_score: 0.9624; train_kl_reg_loss: 5763.2008; train_edge_recon_loss: 257634.0434; train_cond_contrastive_loss: 78748.1727; train_gene_expr_recon_loss: 104631.3941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446776.8160; train_optim_loss: 446776.8160; val_kl_reg_loss: 5720.1221; val_edge_recon_loss: 257890.2500; val_cond_contrastive_loss: 78399.8828; val_gene_expr_recon_loss: 104024.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446034.4375; val_optim_loss: 446034.4375
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9913; val_auprc_score: 0.9892; val_best_acc_score: 0.9598; val_best_f1_score: 0.9606; train_kl_reg_loss: 5746.6050; train_edge_recon_loss: 257749.4809; train_cond_contrastive_loss: 78744.6415; train_gene_expr_recon_loss: 104437.4948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446678.2118; train_optim_loss: 446678.2118; val_kl_reg_loss: 5682.2119; val_edge_recon_loss: 258762.0625; val_cond_contrastive_loss: 78399.7969; val_gene_expr_recon_loss: 103753.9844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446598.0625; val_optim_loss: 446598.0625

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9915; val_auprc_score: 0.9881; val_best_acc_score: 0.9611; val_best_f1_score: 0.9620; train_kl_reg_loss: 5714.4661; train_edge_recon_loss: 258434.7222; train_cond_contrastive_loss: 78747.0312; train_gene_expr_recon_loss: 104259.1797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 447155.4028; train_optim_loss: 447155.4028; val_kl_reg_loss: 5654.4580; val_edge_recon_loss: 258457.2188; val_cond_contrastive_loss: 78399.0938; val_gene_expr_recon_loss: 103705.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446215.9688; val_optim_loss: 446215.9688
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9907; val_auprc_score: 0.9866; val_best_acc_score: 0.9609; val_best_f1_score: 0.9617; train_kl_reg_loss: 5716.2245; train_edge_recon_loss: 257136.6858; train_cond_contrastive_loss: 78746.2795; train_gene_expr_recon_loss: 104064.6623; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445663.8438; train_optim_loss: 445663.8438; val_kl_reg_loss: 5671.0244; val_edge_recon_loss: 258962.6250; val_cond_contrastive_loss: 78399.3438; val_gene_expr_recon_loss: 103670.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446703.8750; val_optim_loss: 446703.8750
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9909; val_auprc_score: 0.9877; val_best_acc_score: 0.9619; val_best_f1_score: 0.9628; train_kl_reg_loss: 5722.4773; train_edge_recon_loss: 257573.6615; train_cond_contrastive_loss: 78748.1068; train_gene_expr_recon_loss: 104169.0868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446213.3299; train_optim_loss: 446213.3299; val_kl_reg_loss: 5670.1187; val_edge_recon_loss: 256922.3281; val_cond_contrastive_loss: 78399.6328; val_gene_expr_recon_loss: 103645.4766; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444637.5312; val_optim_loss: 444637.5312
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9903; val_auprc_score: 0.9861; val_best_acc_score: 0.9611; val_best_f1_score: 0.9621; train_kl_reg_loss: 5712.8397; train_edge_recon_loss: 256771.8524; train_cond_contrastive_loss: 78744.0833; train_gene_expr_recon_loss: 104046.4609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445275.2396; train_optim_loss: 445275.2396; val_kl_reg_loss: 5642.5825; val_edge_recon_loss: 257653.5000; val_cond_contrastive_loss: 78399.5938; val_gene_expr_recon_loss: 103623.2109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445318.9062; val_optim_loss: 445318.9062
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9910; val_auprc_score: 0.9877; val_best_acc_score: 0.9629; val_best_f1_score: 0.9636; train_kl_reg_loss: 5691.8940; train_edge_recon_loss: 256780.4826; train_cond_contrastive_loss: 78753.2057; train_gene_expr_recon_loss: 104108.6814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445334.2708; train_optim_loss: 445334.2708; val_kl_reg_loss: 5643.8428; val_edge_recon_loss: 257187.8125; val_cond_contrastive_loss: 78400.0312; val_gene_expr_recon_loss: 103601.3359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444833.0312; val_optim_loss: 444833.0312
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9922; val_auprc_score: 0.9903; val_best_acc_score: 0.9644; val_best_f1_score: 0.9654; train_kl_reg_loss: 5698.9703; train_edge_recon_loss: 256946.1840; train_cond_contrastive_loss: 78746.1753; train_gene_expr_recon_loss: 104120.2500; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445511.5764; train_optim_loss: 445511.5764; val_kl_reg_loss: 5650.2505; val_edge_recon_loss: 256623.9844; val_cond_contrastive_loss: 78400.2266; val_gene_expr_recon_loss: 103578.7812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444253.2500; val_optim_loss: 444253.2500
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9910; val_auprc_score: 0.9874; val_best_acc_score: 0.9607; val_best_f1_score: 0.9618; train_kl_reg_loss: 5704.6102; train_edge_recon_loss: 256908.5538; train_cond_contrastive_loss: 78748.4444; train_gene_expr_recon_loss: 103989.9601; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445351.5729; train_optim_loss: 445351.5729; val_kl_reg_loss: 5658.6025; val_edge_recon_loss: 257233.2344; val_cond_contrastive_loss: 78400.1016; val_gene_expr_recon_loss: 103555.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444847.8750; val_optim_loss: 444847.8750
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9911; val_auprc_score: 0.9868; val_best_acc_score: 0.9630; val_best_f1_score: 0.9640; train_kl_reg_loss: 5712.8564; train_edge_recon_loss: 257977.3837; train_cond_contrastive_loss: 78740.7465; train_gene_expr_recon_loss: 104044.8585; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446475.8438; train_optim_loss: 446475.8438; val_kl_reg_loss: 5655.4966; val_edge_recon_loss: 257358.5781; val_cond_contrastive_loss: 78400.0156; val_gene_expr_recon_loss: 103530.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444944.7500; val_optim_loss: 444944.7500
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9903; val_auprc_score: 0.9858; val_best_acc_score: 0.9596; val_best_f1_score: 0.9606; train_kl_reg_loss: 5701.1328; train_edge_recon_loss: 257945.2153; train_cond_contrastive_loss: 78743.6988; train_gene_expr_recon_loss: 103972.6493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446362.6910; train_optim_loss: 446362.6910; val_kl_reg_loss: 5655.4316; val_edge_recon_loss: 260316.7344; val_cond_contrastive_loss: 78399.9766; val_gene_expr_recon_loss: 103506.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 447879.0000; val_optim_loss: 447879.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9915; val_auprc_score: 0.9869; val_best_acc_score: 0.9610; val_best_f1_score: 0.9622; train_kl_reg_loss: 5703.9814; train_edge_recon_loss: 257342.8247; train_cond_contrastive_loss: 78739.2127; train_gene_expr_recon_loss: 103991.1467; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445777.1562; train_optim_loss: 445777.1562; val_kl_reg_loss: 5651.2715; val_edge_recon_loss: 256621.9531; val_cond_contrastive_loss: 78400.3359; val_gene_expr_recon_loss: 103504.1953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444177.7500; val_optim_loss: 444177.7500
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9897; val_auprc_score: 0.9851; val_best_acc_score: 0.9601; val_best_f1_score: 0.9613; train_kl_reg_loss: 5698.2029; train_edge_recon_loss: 257703.6510; train_cond_contrastive_loss: 78741.3073; train_gene_expr_recon_loss: 104002.8359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446146.0000; train_optim_loss: 446146.0000; val_kl_reg_loss: 5646.0005; val_edge_recon_loss: 256500.0625; val_cond_contrastive_loss: 78400.3984; val_gene_expr_recon_loss: 103502.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444048.5000; val_optim_loss: 444048.5000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9901; val_auprc_score: 0.9876; val_best_acc_score: 0.9588; val_best_f1_score: 0.9598; train_kl_reg_loss: 5695.3662; train_edge_recon_loss: 257541.7639; train_cond_contrastive_loss: 78741.3759; train_gene_expr_recon_loss: 103937.3819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445915.8924; train_optim_loss: 445915.8924; val_kl_reg_loss: 5647.0928; val_edge_recon_loss: 258624.5000; val_cond_contrastive_loss: 78399.9531; val_gene_expr_recon_loss: 103499.6875; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446171.2500; val_optim_loss: 446171.2500
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9919; val_auprc_score: 0.9900; val_best_acc_score: 0.9625; val_best_f1_score: 0.9633; train_kl_reg_loss: 5697.8242; train_edge_recon_loss: 258545.2517; train_cond_contrastive_loss: 78739.4062; train_gene_expr_recon_loss: 104017.0694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446999.5486; train_optim_loss: 446999.5486; val_kl_reg_loss: 5650.1611; val_edge_recon_loss: 258526.0625; val_cond_contrastive_loss: 78399.8828; val_gene_expr_recon_loss: 103497.2891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446073.3750; val_optim_loss: 446073.3750
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9919; val_auprc_score: 0.9901; val_best_acc_score: 0.9626; val_best_f1_score: 0.9634; train_kl_reg_loss: 5699.8200; train_edge_recon_loss: 257761.5365; train_cond_contrastive_loss: 78742.6328; train_gene_expr_recon_loss: 103957.4245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446161.4097; train_optim_loss: 446161.4097; val_kl_reg_loss: 5652.2275; val_edge_recon_loss: 257774.2031; val_cond_contrastive_loss: 78400.2578; val_gene_expr_recon_loss: 103495.1484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445321.8438; val_optim_loss: 445321.8438

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9925; val_auprc_score: 0.9909; val_best_acc_score: 0.9648; val_best_f1_score: 0.9656; train_kl_reg_loss: 5698.4045; train_edge_recon_loss: 257228.4392; train_cond_contrastive_loss: 78741.1649; train_gene_expr_recon_loss: 103947.4939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445615.5069; train_optim_loss: 445615.5069; val_kl_reg_loss: 5651.8301; val_edge_recon_loss: 257091.3438; val_cond_contrastive_loss: 78400.0156; val_gene_expr_recon_loss: 103494.9375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444638.1250; val_optim_loss: 444638.1250
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9913; val_auprc_score: 0.9874; val_best_acc_score: 0.9628; val_best_f1_score: 0.9639; train_kl_reg_loss: 5698.4358; train_edge_recon_loss: 257501.4010; train_cond_contrastive_loss: 78742.9453; train_gene_expr_recon_loss: 103903.5365; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445846.3229; train_optim_loss: 445846.3229; val_kl_reg_loss: 5651.3730; val_edge_recon_loss: 255612.6094; val_cond_contrastive_loss: 78400.4375; val_gene_expr_recon_loss: 103494.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443159.0625; val_optim_loss: 443159.0625
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9912; val_auprc_score: 0.9865; val_best_acc_score: 0.9635; val_best_f1_score: 0.9641; train_kl_reg_loss: 5700.1050; train_edge_recon_loss: 257252.6875; train_cond_contrastive_loss: 78742.6693; train_gene_expr_recon_loss: 103969.1910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445664.6597; train_optim_loss: 445664.6597; val_kl_reg_loss: 5650.0078; val_edge_recon_loss: 259230.0781; val_cond_contrastive_loss: 78399.7578; val_gene_expr_recon_loss: 103494.3672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446774.2188; val_optim_loss: 446774.2188
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9912; val_auprc_score: 0.9863; val_best_acc_score: 0.9626; val_best_f1_score: 0.9635; train_kl_reg_loss: 5698.5823; train_edge_recon_loss: 256592.9549; train_cond_contrastive_loss: 78743.1207; train_gene_expr_recon_loss: 103979.5998; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445014.2535; train_optim_loss: 445014.2535; val_kl_reg_loss: 5648.0918; val_edge_recon_loss: 257347.2188; val_cond_contrastive_loss: 78400.0156; val_gene_expr_recon_loss: 103494.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444889.4688; val_optim_loss: 444889.4688
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9920; val_auprc_score: 0.9888; val_best_acc_score: 0.9645; val_best_f1_score: 0.9653; train_kl_reg_loss: 5700.3403; train_edge_recon_loss: 257071.9323; train_cond_contrastive_loss: 78741.6988; train_gene_expr_recon_loss: 103977.4002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445491.3681; train_optim_loss: 445491.3681; val_kl_reg_loss: 5646.7666; val_edge_recon_loss: 258571.7812; val_cond_contrastive_loss: 78399.9219; val_gene_expr_recon_loss: 103493.9219; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446112.4375; val_optim_loss: 446112.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9917; val_auprc_score: 0.9888; val_best_acc_score: 0.9647; val_best_f1_score: 0.9655; train_kl_reg_loss: 5699.6689; train_edge_recon_loss: 256814.4080; train_cond_contrastive_loss: 78741.8030; train_gene_expr_recon_loss: 103976.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445232.1944; train_optim_loss: 445232.1944; val_kl_reg_loss: 5651.0342; val_edge_recon_loss: 256665.7969; val_cond_contrastive_loss: 78400.1719; val_gene_expr_recon_loss: 103493.8906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444210.8750; val_optim_loss: 444210.8750
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9913; val_auprc_score: 0.9880; val_best_acc_score: 0.9623; val_best_f1_score: 0.9631; train_kl_reg_loss: 5700.2268; train_edge_recon_loss: 257990.8837; train_cond_contrastive_loss: 78740.7960; train_gene_expr_recon_loss: 103943.7057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 446375.6076; train_optim_loss: 446375.6076; val_kl_reg_loss: 5644.5273; val_edge_recon_loss: 259106.6719; val_cond_contrastive_loss: 78399.7969; val_gene_expr_recon_loss: 103493.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 446644.8750; val_optim_loss: 446644.8750
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9924; val_auprc_score: 0.9907; val_best_acc_score: 0.9642; val_best_f1_score: 0.9653; train_kl_reg_loss: 5701.4127; train_edge_recon_loss: 257478.5677; train_cond_contrastive_loss: 78742.1398; train_gene_expr_recon_loss: 103932.4505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445854.5694; train_optim_loss: 445854.5694; val_kl_reg_loss: 5649.9287; val_edge_recon_loss: 254182.4531; val_cond_contrastive_loss: 78400.0625; val_gene_expr_recon_loss: 103493.8594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 441726.3125; val_optim_loss: 441726.3125
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9912; val_auprc_score: 0.9859; val_best_acc_score: 0.9618; val_best_f1_score: 0.9628; train_kl_reg_loss: 5699.1969; train_edge_recon_loss: 256136.6528; train_cond_contrastive_loss: 78743.2700; train_gene_expr_recon_loss: 103943.3854; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 444522.5035; train_optim_loss: 444522.5035; val_kl_reg_loss: 5647.6128; val_edge_recon_loss: 257437.8594; val_cond_contrastive_loss: 78400.2656; val_gene_expr_recon_loss: 103493.8125; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444979.5625; val_optim_loss: 444979.5625
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9916; val_auprc_score: 0.9882; val_best_acc_score: 0.9621; val_best_f1_score: 0.9633; train_kl_reg_loss: 5701.1342; train_edge_recon_loss: 257152.6181; train_cond_contrastive_loss: 78743.4861; train_gene_expr_recon_loss: 103942.9757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445540.2049; train_optim_loss: 445540.2049; val_kl_reg_loss: 5649.9121; val_edge_recon_loss: 256173.0156; val_cond_contrastive_loss: 78400.4219; val_gene_expr_recon_loss: 103493.7891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 443717.1250; val_optim_loss: 443717.1250
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9924; val_auprc_score: 0.9909; val_best_acc_score: 0.9645; val_best_f1_score: 0.9652; train_kl_reg_loss: 5698.7886; train_edge_recon_loss: 257067.6458; train_cond_contrastive_loss: 78742.0573; train_gene_expr_recon_loss: 104061.0226; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445569.5208; train_optim_loss: 445569.5208; val_kl_reg_loss: 5648.7305; val_edge_recon_loss: 256730.5000; val_cond_contrastive_loss: 78400.4531; val_gene_expr_recon_loss: 103493.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 444273.4375; val_optim_loss: 444273.4375

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9919; val_auprc_score: 0.9881; val_best_acc_score: 0.9624; val_best_f1_score: 0.9634; train_kl_reg_loss: 5698.0849; train_edge_recon_loss: 256986.4722; train_cond_contrastive_loss: 78742.2248; train_gene_expr_recon_loss: 103930.2135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445356.9861; train_optim_loss: 445356.9861; val_kl_reg_loss: 5648.5327; val_edge_recon_loss: 257683.3438; val_cond_contrastive_loss: 78400.2734; val_gene_expr_recon_loss: 103493.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445225.9375; val_optim_loss: 445225.9375
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9917; val_auprc_score: 0.9900; val_best_acc_score: 0.9615; val_best_f1_score: 0.9624; train_kl_reg_loss: 5700.1508; train_edge_recon_loss: 257395.8906; train_cond_contrastive_loss: 78742.9861; train_gene_expr_recon_loss: 103960.7214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445799.7500; train_optim_loss: 445799.7500; val_kl_reg_loss: 5646.4316; val_edge_recon_loss: 257877.5312; val_cond_contrastive_loss: 78399.8906; val_gene_expr_recon_loss: 103493.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445417.6250; val_optim_loss: 445417.6250
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9921; val_auprc_score: 0.9883; val_best_acc_score: 0.9634; val_best_f1_score: 0.9642; train_kl_reg_loss: 5698.0031; train_edge_recon_loss: 256856.1753; train_cond_contrastive_loss: 78741.5825; train_gene_expr_recon_loss: 103976.3993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 445272.1597; train_optim_loss: 445272.1597; val_kl_reg_loss: 5645.8828; val_edge_recon_loss: 258001.2031; val_cond_contrastive_loss: 78400.1328; val_gene_expr_recon_loss: 103493.7656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 445541.0000; val_optim_loss: 445541.0000

Stopping early: metric has not improved more than 0.0 in the last 6 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 7 min 16 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
Val AUROC score: 0.9901
Val AUPRC score: 0.9871
Val best accuracy score: 0.9599
Val best F1 score: 0.9612
Val gene expr MSE score: 1.4613
Duration of model training in run 10: 0 hours, 7 minutes and 20 seconds.

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
