[True, False, True]
Run timestamp: 29092023_233507_101.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--lambda_l1_addon', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_101']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 480575
Number of validation nodes: 53397
Number of training edges: 1134287
Number of validation edges: 126031
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8899; val_auprc_score: 0.9741; val_best_acc_score: 0.9054; val_best_f1_score: 0.9465; train_kl_reg_loss: 16047.4785; train_edge_recon_loss: 834016.3955; train_cat_covariates_contrastive_loss: 950048.3797; train_gene_expr_recon_loss: 2753102.8685; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4553215.1179; train_optim_loss: 4553215.1179; val_kl_reg_loss: 16899.0822; val_edge_recon_loss: 832202.1784; val_cat_covariates_contrastive_loss: 950867.9112; val_gene_expr_recon_loss: 2442939.3492; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4242908.5192; val_optim_loss: 4242908.5192
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9148; val_auprc_score: 0.9807; val_best_acc_score: 0.9157; val_best_f1_score: 0.9517; train_kl_reg_loss: 19464.2110; train_edge_recon_loss: 797707.1558; train_cat_covariates_contrastive_loss: 950008.6659; train_gene_expr_recon_loss: 2282657.0291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4049837.0598; train_optim_loss: 4049837.0598; val_kl_reg_loss: 19246.4454; val_edge_recon_loss: 827203.2191; val_cat_covariates_contrastive_loss: 954056.5898; val_gene_expr_recon_loss: 2175829.5643; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3976335.8229; val_optim_loss: 3976335.8229
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9103; val_auprc_score: 0.9781; val_best_acc_score: 0.9186; val_best_f1_score: 0.9535; train_kl_reg_loss: 21566.6945; train_edge_recon_loss: 793625.1918; train_cat_covariates_contrastive_loss: 950346.4919; train_gene_expr_recon_loss: 2115145.1336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3880683.5147; train_optim_loss: 3880683.5147; val_kl_reg_loss: 24102.6696; val_edge_recon_loss: 820064.9137; val_cat_covariates_contrastive_loss: 947739.4294; val_gene_expr_recon_loss: 2076313.8300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3868220.8391; val_optim_loss: 3868220.8391
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9220; val_auprc_score: 0.9814; val_best_acc_score: 0.9252; val_best_f1_score: 0.9572; train_kl_reg_loss: 22434.2449; train_edge_recon_loss: 790063.7056; train_cat_covariates_contrastive_loss: 950246.0291; train_gene_expr_recon_loss: 2048015.7220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3810759.7049; train_optim_loss: 3810759.7049; val_kl_reg_loss: 22519.7417; val_edge_recon_loss: 815884.2424; val_cat_covariates_contrastive_loss: 950002.8178; val_gene_expr_recon_loss: 2030402.3062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3818809.1123; val_optim_loss: 3818809.1123
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9244; val_auprc_score: 0.9824; val_best_acc_score: 0.9243; val_best_f1_score: 0.9564; train_kl_reg_loss: 23018.3614; train_edge_recon_loss: 790946.6913; train_cat_covariates_contrastive_loss: 950295.2389; train_gene_expr_recon_loss: 2012732.1847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3776992.4772; train_optim_loss: 3776992.4772; val_kl_reg_loss: 22677.2533; val_edge_recon_loss: 815023.5572; val_cat_covariates_contrastive_loss: 952010.5228; val_gene_expr_recon_loss: 2003033.8279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3792745.1619; val_optim_loss: 3792745.1619
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9192; val_auprc_score: 0.9802; val_best_acc_score: 0.9277; val_best_f1_score: 0.9587; train_kl_reg_loss: 23426.3760; train_edge_recon_loss: 791650.4440; train_cat_covariates_contrastive_loss: 950321.7330; train_gene_expr_recon_loss: 1991197.6293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3756596.1843; train_optim_loss: 3756596.1843; val_kl_reg_loss: 23869.2523; val_edge_recon_loss: 807627.4365; val_cat_covariates_contrastive_loss: 949276.6513; val_gene_expr_recon_loss: 1996803.4560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3777576.7844; val_optim_loss: 3777576.7844
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9259; val_auprc_score: 0.9824; val_best_acc_score: 0.9258; val_best_f1_score: 0.9575; train_kl_reg_loss: 23795.2426; train_edge_recon_loss: 788180.4596; train_cat_covariates_contrastive_loss: 950400.2888; train_gene_expr_recon_loss: 1975587.9438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3737963.9316; train_optim_loss: 3737963.9316; val_kl_reg_loss: 23632.5084; val_edge_recon_loss: 809786.2796; val_cat_covariates_contrastive_loss: 950782.6546; val_gene_expr_recon_loss: 1975736.0552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3759937.5061; val_optim_loss: 3759937.5061
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9268; val_auprc_score: 0.9823; val_best_acc_score: 0.9263; val_best_f1_score: 0.9576; train_kl_reg_loss: 24072.7437; train_edge_recon_loss: 788028.0409; train_cat_covariates_contrastive_loss: 950358.3601; train_gene_expr_recon_loss: 1960846.4590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3723305.6039; train_optim_loss: 3723305.6039; val_kl_reg_loss: 24853.9403; val_edge_recon_loss: 814836.6144; val_cat_covariates_contrastive_loss: 949456.2826; val_gene_expr_recon_loss: 1965196.7551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3754343.5870; val_optim_loss: 3754343.5870
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9296; val_auprc_score: 0.9834; val_best_acc_score: 0.9287; val_best_f1_score: 0.9590; train_kl_reg_loss: 24368.8374; train_edge_recon_loss: 786926.7044; train_cat_covariates_contrastive_loss: 950427.8851; train_gene_expr_recon_loss: 1948820.8861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3710544.3135; train_optim_loss: 3710544.3135; val_kl_reg_loss: 24667.1364; val_edge_recon_loss: 805390.2002; val_cat_covariates_contrastive_loss: 950860.8692; val_gene_expr_recon_loss: 1949817.3952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3730735.6002; val_optim_loss: 3730735.6002
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9245; val_auprc_score: 0.9816; val_best_acc_score: 0.9285; val_best_f1_score: 0.9590; train_kl_reg_loss: 24628.4793; train_edge_recon_loss: 787141.2136; train_cat_covariates_contrastive_loss: 950513.3158; train_gene_expr_recon_loss: 1937754.1913; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3700037.1992; train_optim_loss: 3700037.1992; val_kl_reg_loss: 25570.1433; val_edge_recon_loss: 811951.6976; val_cat_covariates_contrastive_loss: 949098.4539; val_gene_expr_recon_loss: 1938954.7723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3725575.0587; val_optim_loss: 3725575.0587
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9246; val_auprc_score: 0.9819; val_best_acc_score: 0.9286; val_best_f1_score: 0.9591; train_kl_reg_loss: 24884.0907; train_edge_recon_loss: 784595.3466; train_cat_covariates_contrastive_loss: 950495.9232; train_gene_expr_recon_loss: 1930828.6918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3690804.0530; train_optim_loss: 3690804.0530; val_kl_reg_loss: 25575.6421; val_edge_recon_loss: 805267.4140; val_cat_covariates_contrastive_loss: 950571.6341; val_gene_expr_recon_loss: 1938505.9858; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3719920.6690; val_optim_loss: 3719920.6690
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9308; val_auprc_score: 0.9835; val_best_acc_score: 0.9311; val_best_f1_score: 0.9605; train_kl_reg_loss: 25225.7842; train_edge_recon_loss: 785353.5654; train_cat_covariates_contrastive_loss: 950569.4254; train_gene_expr_recon_loss: 1921678.2523; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3682827.0264; train_optim_loss: 3682827.0264; val_kl_reg_loss: 24586.2353; val_edge_recon_loss: 810484.3312; val_cat_covariates_contrastive_loss: 951878.1339; val_gene_expr_recon_loss: 1921146.8072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3708095.5061; val_optim_loss: 3708095.5061
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9249; val_auprc_score: 0.9812; val_best_acc_score: 0.9313; val_best_f1_score: 0.9606; train_kl_reg_loss: 25431.0908; train_edge_recon_loss: 784933.9000; train_cat_covariates_contrastive_loss: 950674.6322; train_gene_expr_recon_loss: 1913484.7967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3674524.4210; train_optim_loss: 3674524.4210; val_kl_reg_loss: 27178.2022; val_edge_recon_loss: 816300.1759; val_cat_covariates_contrastive_loss: 948491.1212; val_gene_expr_recon_loss: 1914873.0035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3706842.5030; val_optim_loss: 3706842.5030
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9315; val_auprc_score: 0.9838; val_best_acc_score: 0.9293; val_best_f1_score: 0.9595; train_kl_reg_loss: 25554.0321; train_edge_recon_loss: 784135.2704; train_cat_covariates_contrastive_loss: 950583.6367; train_gene_expr_recon_loss: 1905427.9915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3665700.9311; train_optim_loss: 3665700.9311; val_kl_reg_loss: 24272.4401; val_edge_recon_loss: 810831.9909; val_cat_covariates_contrastive_loss: 952785.3236; val_gene_expr_recon_loss: 1912929.2702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3700819.0192; val_optim_loss: 3700819.0192
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9303; val_auprc_score: 0.9833; val_best_acc_score: 0.9311; val_best_f1_score: 0.9604; train_kl_reg_loss: 25613.1143; train_edge_recon_loss: 784089.1108; train_cat_covariates_contrastive_loss: 950693.4399; train_gene_expr_recon_loss: 1901281.2363; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3661676.9013; train_optim_loss: 3661676.9013; val_kl_reg_loss: 24717.5329; val_edge_recon_loss: 805231.4074; val_cat_covariates_contrastive_loss: 951044.3196; val_gene_expr_recon_loss: 1904140.3203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3685133.5779; val_optim_loss: 3685133.5779
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9299; val_auprc_score: 0.9832; val_best_acc_score: 0.9271; val_best_f1_score: 0.9582; train_kl_reg_loss: 25805.1596; train_edge_recon_loss: 783401.2760; train_cat_covariates_contrastive_loss: 950642.1869; train_gene_expr_recon_loss: 1896632.6955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3656481.3205; train_optim_loss: 3656481.3205; val_kl_reg_loss: 24858.5199; val_edge_recon_loss: 811017.8877; val_cat_covariates_contrastive_loss: 952659.2958; val_gene_expr_recon_loss: 1901466.9960; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3690002.7024; val_optim_loss: 3690002.7024
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9332; val_auprc_score: 0.9842; val_best_acc_score: 0.9317; val_best_f1_score: 0.9608; train_kl_reg_loss: 25861.2057; train_edge_recon_loss: 782206.5827; train_cat_covariates_contrastive_loss: 950675.8852; train_gene_expr_recon_loss: 1888987.9825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3647731.6559; train_optim_loss: 3647731.6559; val_kl_reg_loss: 25508.0947; val_edge_recon_loss: 804050.2310; val_cat_covariates_contrastive_loss: 950806.8654; val_gene_expr_recon_loss: 1891636.8052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3672001.9868; val_optim_loss: 3672001.9868
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9293; val_auprc_score: 0.9827; val_best_acc_score: 0.9284; val_best_f1_score: 0.9589; train_kl_reg_loss: 25861.6823; train_edge_recon_loss: 784000.2580; train_cat_covariates_contrastive_loss: 950747.1908; train_gene_expr_recon_loss: 1889312.2067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3649921.3382; train_optim_loss: 3649921.3382; val_kl_reg_loss: 26589.2760; val_edge_recon_loss: 813024.2654; val_cat_covariates_contrastive_loss: 950253.8679; val_gene_expr_recon_loss: 1893257.7733; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3683125.1893; val_optim_loss: 3683125.1893
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9293; val_auprc_score: 0.9826; val_best_acc_score: 0.9303; val_best_f1_score: 0.9600; train_kl_reg_loss: 26020.4596; train_edge_recon_loss: 782812.0481; train_cat_covariates_contrastive_loss: 950672.2365; train_gene_expr_recon_loss: 1883922.0306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3643426.7763; train_optim_loss: 3643426.7763; val_kl_reg_loss: 27550.8279; val_edge_recon_loss: 813773.3499; val_cat_covariates_contrastive_loss: 949171.4747; val_gene_expr_recon_loss: 1887344.4884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3677840.1387; val_optim_loss: 3677840.1387
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9306; val_auprc_score: 0.9830; val_best_acc_score: 0.9340; val_best_f1_score: 0.9622; train_kl_reg_loss: 26166.6312; train_edge_recon_loss: 785974.8440; train_cat_covariates_contrastive_loss: 950669.7029; train_gene_expr_recon_loss: 1881497.9543; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3644309.1326; train_optim_loss: 3644309.1326; val_kl_reg_loss: 27218.3548; val_edge_recon_loss: 808357.5863; val_cat_covariates_contrastive_loss: 949157.9350; val_gene_expr_recon_loss: 1900597.0380; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3685330.9160; val_optim_loss: 3685330.9160
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9220; val_auprc_score: 0.9803; val_best_acc_score: 0.9273; val_best_f1_score: 0.9583; train_kl_reg_loss: 26153.2787; train_edge_recon_loss: 784500.8991; train_cat_covariates_contrastive_loss: 950800.4667; train_gene_expr_recon_loss: 1879830.7197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3641285.3639; train_optim_loss: 3641285.3639; val_kl_reg_loss: 28886.8261; val_edge_recon_loss: 812161.7963; val_cat_covariates_contrastive_loss: 947931.3155; val_gene_expr_recon_loss: 1886807.3927; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3675787.3431; val_optim_loss: 3675787.3431

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9331; val_auprc_score: 0.9836; val_best_acc_score: 0.9335; val_best_f1_score: 0.9617; train_kl_reg_loss: 26204.2838; train_edge_recon_loss: 782135.3121; train_cat_covariates_contrastive_loss: 950601.7073; train_gene_expr_recon_loss: 1844480.9622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3603422.2659; train_optim_loss: 3603422.2659; val_kl_reg_loss: 26471.9105; val_edge_recon_loss: 804087.0450; val_cat_covariates_contrastive_loss: 951519.5658; val_gene_expr_recon_loss: 1854848.0967; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3636926.6164; val_optim_loss: 3636926.6164
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9356; val_auprc_score: 0.9844; val_best_acc_score: 0.9358; val_best_f1_score: 0.9632; train_kl_reg_loss: 26038.6394; train_edge_recon_loss: 781177.9300; train_cat_covariates_contrastive_loss: 950406.7235; train_gene_expr_recon_loss: 1839586.2443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3597209.5382; train_optim_loss: 3597209.5382; val_kl_reg_loss: 26006.2197; val_edge_recon_loss: 793440.1581; val_cat_covariates_contrastive_loss: 951065.0008; val_gene_expr_recon_loss: 1852808.2201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3623319.6032; val_optim_loss: 3623319.6032
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9331; val_auprc_score: 0.9837; val_best_acc_score: 0.9330; val_best_f1_score: 0.9615; train_kl_reg_loss: 25882.9519; train_edge_recon_loss: 780158.3014; train_cat_covariates_contrastive_loss: 950362.3825; train_gene_expr_recon_loss: 1836530.2410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3592933.8756; train_optim_loss: 3592933.8756; val_kl_reg_loss: 25739.8295; val_edge_recon_loss: 802092.9438; val_cat_covariates_contrastive_loss: 950152.4658; val_gene_expr_recon_loss: 1849322.3952; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3627307.6407; val_optim_loss: 3627307.6407
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9313; val_auprc_score: 0.9830; val_best_acc_score: 0.9346; val_best_f1_score: 0.9625; train_kl_reg_loss: 25680.1575; train_edge_recon_loss: 780452.6803; train_cat_covariates_contrastive_loss: 950270.7963; train_gene_expr_recon_loss: 1835104.5710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3591508.2025; train_optim_loss: 3591508.2025; val_kl_reg_loss: 26323.5809; val_edge_recon_loss: 799537.0111; val_cat_covariates_contrastive_loss: 948961.3661; val_gene_expr_recon_loss: 1849983.6994; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3624805.6640; val_optim_loss: 3624805.6640
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9335; val_auprc_score: 0.9838; val_best_acc_score: 0.9342; val_best_f1_score: 0.9622; train_kl_reg_loss: 28412.7245; train_edge_recon_loss: 787379.7724; train_cat_covariates_contrastive_loss: 953638.1659; train_gene_expr_recon_loss: 1829177.1917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3598607.8550; train_optim_loss: 3598607.8550; val_kl_reg_loss: 20256.5073; val_edge_recon_loss: 807023.8403; val_cat_covariates_contrastive_loss: 952713.8419; val_gene_expr_recon_loss: 1842885.1179; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3622879.3016; val_optim_loss: 3622879.3016
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9325; val_auprc_score: 0.9830; val_best_acc_score: 0.9336; val_best_f1_score: 0.9619; train_kl_reg_loss: 26734.6094; train_edge_recon_loss: 785643.2282; train_cat_covariates_contrastive_loss: 951877.9897; train_gene_expr_recon_loss: 1827249.8330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3591505.6605; train_optim_loss: 3591505.6605; val_kl_reg_loss: 21291.1709; val_edge_recon_loss: 811212.4324; val_cat_covariates_contrastive_loss: 951598.5653; val_gene_expr_recon_loss: 1840784.0724; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3624886.2389; val_optim_loss: 3624886.2389
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9312; val_auprc_score: 0.9828; val_best_acc_score: 0.9318; val_best_f1_score: 0.9607; train_kl_reg_loss: 25459.6249; train_edge_recon_loss: 783581.1028; train_cat_covariates_contrastive_loss: 950925.0636; train_gene_expr_recon_loss: 1826103.0632; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3586068.8524; train_optim_loss: 3586068.8524; val_kl_reg_loss: 21991.0367; val_edge_recon_loss: 811866.7444; val_cat_covariates_contrastive_loss: 950443.1642; val_gene_expr_recon_loss: 1837294.0137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3621594.9524; val_optim_loss: 3621594.9524
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9329; val_auprc_score: 0.9835; val_best_acc_score: 0.9335; val_best_f1_score: 0.9618; train_kl_reg_loss: 24662.7937; train_edge_recon_loss: 781304.8418; train_cat_covariates_contrastive_loss: 950435.5855; train_gene_expr_recon_loss: 1825813.8861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3582217.1068; train_optim_loss: 3582217.1068; val_kl_reg_loss: 22806.9169; val_edge_recon_loss: 804253.2604; val_cat_covariates_contrastive_loss: 949674.3378; val_gene_expr_recon_loss: 1836669.4423; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3613403.9585; val_optim_loss: 3613403.9585
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9312; val_auprc_score: 0.9830; val_best_acc_score: 0.9319; val_best_f1_score: 0.9609; train_kl_reg_loss: 24060.5415; train_edge_recon_loss: 786208.2738; train_cat_covariates_contrastive_loss: 950231.6179; train_gene_expr_recon_loss: 1824395.6988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3584896.1339; train_optim_loss: 3584896.1339; val_kl_reg_loss: 22388.7824; val_edge_recon_loss: 811813.4838; val_cat_covariates_contrastive_loss: 949896.1146; val_gene_expr_recon_loss: 1836307.9241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3620406.2986; val_optim_loss: 3620406.2986
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9355; val_auprc_score: 0.9843; val_best_acc_score: 0.9340; val_best_f1_score: 0.9621; train_kl_reg_loss: 23822.3155; train_edge_recon_loss: 782263.7790; train_cat_covariates_contrastive_loss: 950028.7916; train_gene_expr_recon_loss: 1823880.7669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3579995.6516; train_optim_loss: 3579995.6516; val_kl_reg_loss: 22290.1055; val_edge_recon_loss: 803271.7809; val_cat_covariates_contrastive_loss: 950992.3451; val_gene_expr_recon_loss: 1838234.8426; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3614789.0759; val_optim_loss: 3614789.0759
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9319; val_auprc_score: 0.9832; val_best_acc_score: 0.9336; val_best_f1_score: 0.9619; train_kl_reg_loss: 23651.7177; train_edge_recon_loss: 781751.8987; train_cat_covariates_contrastive_loss: 949882.2556; train_gene_expr_recon_loss: 1822979.1379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578265.0097; train_optim_loss: 3578265.0097; val_kl_reg_loss: 22724.0743; val_edge_recon_loss: 804260.2740; val_cat_covariates_contrastive_loss: 949657.1804; val_gene_expr_recon_loss: 1836717.3755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3613358.9049; val_optim_loss: 3613358.9049
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9360; val_auprc_score: 0.9846; val_best_acc_score: 0.9353; val_best_f1_score: 0.9628; train_kl_reg_loss: 23477.6390; train_edge_recon_loss: 782724.2148; train_cat_covariates_contrastive_loss: 949866.5907; train_gene_expr_recon_loss: 1822095.2407; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578163.6828; train_optim_loss: 3578163.6828; val_kl_reg_loss: 23266.5131; val_edge_recon_loss: 803538.7280; val_cat_covariates_contrastive_loss: 951419.5453; val_gene_expr_recon_loss: 1841680.9352; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3619905.7115; val_optim_loss: 3619905.7115
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9339; val_auprc_score: 0.9839; val_best_acc_score: 0.9325; val_best_f1_score: 0.9612; train_kl_reg_loss: 23373.0525; train_edge_recon_loss: 783497.1391; train_cat_covariates_contrastive_loss: 949865.3740; train_gene_expr_recon_loss: 1821588.0334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578323.5972; train_optim_loss: 3578323.5972; val_kl_reg_loss: 22581.4021; val_edge_recon_loss: 805079.6351; val_cat_covariates_contrastive_loss: 950145.6640; val_gene_expr_recon_loss: 1835389.9899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3613196.6953; val_optim_loss: 3613196.6953
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9318; val_auprc_score: 0.9829; val_best_acc_score: 0.9338; val_best_f1_score: 0.9620; train_kl_reg_loss: 23310.6089; train_edge_recon_loss: 779604.1715; train_cat_covariates_contrastive_loss: 949784.4620; train_gene_expr_recon_loss: 1820913.2660; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3573612.5059; train_optim_loss: 3573612.5059; val_kl_reg_loss: 23232.1095; val_edge_recon_loss: 805596.6690; val_cat_covariates_contrastive_loss: 948761.5261; val_gene_expr_recon_loss: 1834638.1559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3612228.4605; val_optim_loss: 3612228.4605
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9346; val_auprc_score: 0.9838; val_best_acc_score: 0.9333; val_best_f1_score: 0.9616; train_kl_reg_loss: 23233.8938; train_edge_recon_loss: 780629.0710; train_cat_covariates_contrastive_loss: 949640.8790; train_gene_expr_recon_loss: 1820760.3317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3574264.1750; train_optim_loss: 3574264.1750; val_kl_reg_loss: 22819.9604; val_edge_recon_loss: 807635.8107; val_cat_covariates_contrastive_loss: 950162.7234; val_gene_expr_recon_loss: 1833047.0698; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3613665.5709; val_optim_loss: 3613665.5709
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9346; val_auprc_score: 0.9840; val_best_acc_score: 0.9342; val_best_f1_score: 0.9622; train_kl_reg_loss: 23331.7854; train_edge_recon_loss: 782486.2840; train_cat_covariates_contrastive_loss: 949723.6094; train_gene_expr_recon_loss: 1820841.6717; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3576383.3468; train_optim_loss: 3576383.3468; val_kl_reg_loss: 22533.5066; val_edge_recon_loss: 802017.7581; val_cat_covariates_contrastive_loss: 949690.9223; val_gene_expr_recon_loss: 1831803.5709; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3606045.7632; val_optim_loss: 3606045.7632
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9331; val_auprc_score: 0.9838; val_best_acc_score: 0.9334; val_best_f1_score: 0.9618; train_kl_reg_loss: 23129.9779; train_edge_recon_loss: 780058.5224; train_cat_covariates_contrastive_loss: 949706.7809; train_gene_expr_recon_loss: 1820227.8924; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3573123.1744; train_optim_loss: 3573123.1744; val_kl_reg_loss: 22722.3270; val_edge_recon_loss: 805011.1015; val_cat_covariates_contrastive_loss: 949553.4357; val_gene_expr_recon_loss: 1832944.1867; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3610231.0466; val_optim_loss: 3610231.0466
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9334; val_auprc_score: 0.9833; val_best_acc_score: 0.9348; val_best_f1_score: 0.9626; train_kl_reg_loss: 23034.8396; train_edge_recon_loss: 781483.6770; train_cat_covariates_contrastive_loss: 949479.0321; train_gene_expr_recon_loss: 1818759.7679; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3572757.3160; train_optim_loss: 3572757.3160; val_kl_reg_loss: 22554.1709; val_edge_recon_loss: 806049.6630; val_cat_covariates_contrastive_loss: 949234.5245; val_gene_expr_recon_loss: 1831884.2632; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3609722.6154; val_optim_loss: 3609722.6154
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9339; val_auprc_score: 0.9836; val_best_acc_score: 0.9339; val_best_f1_score: 0.9621; train_kl_reg_loss: 23025.9711; train_edge_recon_loss: 779472.1209; train_cat_covariates_contrastive_loss: 949353.5789; train_gene_expr_recon_loss: 1818835.8845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3570687.5560; train_optim_loss: 3570687.5560; val_kl_reg_loss: 22519.6861; val_edge_recon_loss: 808281.5615; val_cat_covariates_contrastive_loss: 949475.2391; val_gene_expr_recon_loss: 1832680.2014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3612956.6852; val_optim_loss: 3612956.6852
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9341; val_auprc_score: 0.9837; val_best_acc_score: 0.9343; val_best_f1_score: 0.9623; train_kl_reg_loss: 23120.0796; train_edge_recon_loss: 781230.7798; train_cat_covariates_contrastive_loss: 949631.5352; train_gene_expr_recon_loss: 1818410.4456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3572392.8408; train_optim_loss: 3572392.8408; val_kl_reg_loss: 22207.7747; val_edge_recon_loss: 801457.0901; val_cat_covariates_contrastive_loss: 949840.9965; val_gene_expr_recon_loss: 1832034.8102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3605540.6680; val_optim_loss: 3605540.6680
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9373; val_auprc_score: 0.9849; val_best_acc_score: 0.9357; val_best_f1_score: 0.9631; train_kl_reg_loss: 23028.8726; train_edge_recon_loss: 779720.6645; train_cat_covariates_contrastive_loss: 949605.2180; train_gene_expr_recon_loss: 1817852.6897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3570207.4484; train_optim_loss: 3570207.4484; val_kl_reg_loss: 22297.3151; val_edge_recon_loss: 796095.2389; val_cat_covariates_contrastive_loss: 950556.6786; val_gene_expr_recon_loss: 1832227.0541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3601176.2794; val_optim_loss: 3601176.2794
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9387; val_auprc_score: 0.9853; val_best_acc_score: 0.9351; val_best_f1_score: 0.9626; train_kl_reg_loss: 22902.9868; train_edge_recon_loss: 781178.9177; train_cat_covariates_contrastive_loss: 949360.4237; train_gene_expr_recon_loss: 1817026.8777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3570469.2071; train_optim_loss: 3570469.2071; val_kl_reg_loss: 21962.1396; val_edge_recon_loss: 805701.3338; val_cat_covariates_contrastive_loss: 950583.1184; val_gene_expr_recon_loss: 1830672.2682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3608918.8634; val_optim_loss: 3608918.8634
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9359; val_auprc_score: 0.9844; val_best_acc_score: 0.9345; val_best_f1_score: 0.9624; train_kl_reg_loss: 22792.6029; train_edge_recon_loss: 777503.4021; train_cat_covariates_contrastive_loss: 949310.0976; train_gene_expr_recon_loss: 1817495.4761; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3567101.5758; train_optim_loss: 3567101.5758; val_kl_reg_loss: 22496.6489; val_edge_recon_loss: 804800.4049; val_cat_covariates_contrastive_loss: 949124.2115; val_gene_expr_recon_loss: 1830315.2196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3606736.4889; val_optim_loss: 3606736.4889
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9358; val_auprc_score: 0.9838; val_best_acc_score: 0.9358; val_best_f1_score: 0.9631; train_kl_reg_loss: 22744.5704; train_edge_recon_loss: 778295.7074; train_cat_covariates_contrastive_loss: 949160.1434; train_gene_expr_recon_loss: 1816876.5110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3567076.9316; train_optim_loss: 3567076.9316; val_kl_reg_loss: 22833.0060; val_edge_recon_loss: 803708.2720; val_cat_covariates_contrastive_loss: 948626.6680; val_gene_expr_recon_loss: 1831675.7085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3606843.6619; val_optim_loss: 3606843.6619
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9357; val_auprc_score: 0.9844; val_best_acc_score: 0.9348; val_best_f1_score: 0.9626; train_kl_reg_loss: 22636.9750; train_edge_recon_loss: 779000.4065; train_cat_covariates_contrastive_loss: 949121.9945; train_gene_expr_recon_loss: 1816277.8954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3567037.2717; train_optim_loss: 3567037.2717; val_kl_reg_loss: 22457.5296; val_edge_recon_loss: 806723.9205; val_cat_covariates_contrastive_loss: 949185.8348; val_gene_expr_recon_loss: 1829370.3446; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3607737.6336; val_optim_loss: 3607737.6336

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9370; val_auprc_score: 0.9847; val_best_acc_score: 0.9360; val_best_f1_score: 0.9632; train_kl_reg_loss: 22554.1718; train_edge_recon_loss: 779910.6211; train_cat_covariates_contrastive_loss: 949043.3696; train_gene_expr_recon_loss: 1811296.3478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3562804.5091; train_optim_loss: 3562804.5091; val_kl_reg_loss: 22409.3742; val_edge_recon_loss: 799916.1242; val_cat_covariates_contrastive_loss: 949032.0453; val_gene_expr_recon_loss: 1829009.2976; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3600366.8401; val_optim_loss: 3600366.8401
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9389; val_auprc_score: 0.9852; val_best_acc_score: 0.9358; val_best_f1_score: 0.9631; train_kl_reg_loss: 22635.9064; train_edge_recon_loss: 778690.5265; train_cat_covariates_contrastive_loss: 949255.7164; train_gene_expr_recon_loss: 1811417.5612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3561999.7101; train_optim_loss: 3561999.7101; val_kl_reg_loss: 22348.9943; val_edge_recon_loss: 800637.2897; val_cat_covariates_contrastive_loss: 949219.1549; val_gene_expr_recon_loss: 1824727.2900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3596932.7247; val_optim_loss: 3596932.7247
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9342; val_auprc_score: 0.9836; val_best_acc_score: 0.9343; val_best_f1_score: 0.9622; train_kl_reg_loss: 22624.9287; train_edge_recon_loss: 781638.0755; train_cat_covariates_contrastive_loss: 949195.5985; train_gene_expr_recon_loss: 1811865.8252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3565324.4276; train_optim_loss: 3565324.4276; val_kl_reg_loss: 22348.3941; val_edge_recon_loss: 811454.8608; val_cat_covariates_contrastive_loss: 949072.3618; val_gene_expr_recon_loss: 1825168.3978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3608044.0111; val_optim_loss: 3608044.0111
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9367; val_auprc_score: 0.9844; val_best_acc_score: 0.9351; val_best_f1_score: 0.9627; train_kl_reg_loss: 22592.9417; train_edge_recon_loss: 780182.7602; train_cat_covariates_contrastive_loss: 949082.1378; train_gene_expr_recon_loss: 1811572.8830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3563430.7233; train_optim_loss: 3563430.7233; val_kl_reg_loss: 22370.4305; val_edge_recon_loss: 806454.7543; val_cat_covariates_contrastive_loss: 949123.6247; val_gene_expr_recon_loss: 1825068.9479; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3603017.7480; val_optim_loss: 3603017.7480
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9360; val_auprc_score: 0.9844; val_best_acc_score: 0.9352; val_best_f1_score: 0.9628; train_kl_reg_loss: 22577.4409; train_edge_recon_loss: 777289.2027; train_cat_covariates_contrastive_loss: 949059.1248; train_gene_expr_recon_loss: 1811542.9598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3560468.7282; train_optim_loss: 3560468.7282; val_kl_reg_loss: 22458.1434; val_edge_recon_loss: 805135.8001; val_cat_covariates_contrastive_loss: 949018.7629; val_gene_expr_recon_loss: 1825754.4221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3602367.1316; val_optim_loss: 3602367.1316
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9332; val_auprc_score: 0.9834; val_best_acc_score: 0.9346; val_best_f1_score: 0.9625; train_kl_reg_loss: 22643.4818; train_edge_recon_loss: 781013.6098; train_cat_covariates_contrastive_loss: 949217.9207; train_gene_expr_recon_loss: 1811722.4143; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564597.4277; train_optim_loss: 3564597.4277; val_kl_reg_loss: 22588.6649; val_edge_recon_loss: 807093.1313; val_cat_covariates_contrastive_loss: 948809.9481; val_gene_expr_recon_loss: 1825505.0111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3603996.7551; val_optim_loss: 3603996.7551

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9343; val_auprc_score: 0.9837; val_best_acc_score: 0.9346; val_best_f1_score: 0.9623; train_kl_reg_loss: 22642.3262; train_edge_recon_loss: 782083.4856; train_cat_covariates_contrastive_loss: 948877.2745; train_gene_expr_recon_loss: 1810634.9861; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564238.0741; train_optim_loss: 3564238.0741; val_kl_reg_loss: 22476.0599; val_edge_recon_loss: 811891.0225; val_cat_covariates_contrastive_loss: 948718.0868; val_gene_expr_recon_loss: 1828167.9772; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3611253.1417; val_optim_loss: 3611253.1417
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9368; val_auprc_score: 0.9842; val_best_acc_score: 0.9341; val_best_f1_score: 0.9621; train_kl_reg_loss: 22598.3204; train_edge_recon_loss: 781959.5705; train_cat_covariates_contrastive_loss: 949035.3939; train_gene_expr_recon_loss: 1810671.1553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3564264.4381; train_optim_loss: 3564264.4381; val_kl_reg_loss: 22410.8906; val_edge_recon_loss: 814618.5147; val_cat_covariates_contrastive_loss: 949265.5180; val_gene_expr_recon_loss: 1826306.9803; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3612601.9038; val_optim_loss: 3612601.9038
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9379; val_auprc_score: 0.9850; val_best_acc_score: 0.9360; val_best_f1_score: 0.9632; train_kl_reg_loss: 22605.6798; train_edge_recon_loss: 778489.9311; train_cat_covariates_contrastive_loss: 949036.9042; train_gene_expr_recon_loss: 1811103.9889; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3561236.5042; train_optim_loss: 3561236.5042; val_kl_reg_loss: 22380.8497; val_edge_recon_loss: 796331.5671; val_cat_covariates_contrastive_loss: 949114.5235; val_gene_expr_recon_loss: 1823674.0294; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3591500.9696; val_optim_loss: 3591500.9696
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9367; val_auprc_score: 0.9843; val_best_acc_score: 0.9350; val_best_f1_score: 0.9626; train_kl_reg_loss: 22602.4304; train_edge_recon_loss: 779120.7862; train_cat_covariates_contrastive_loss: 949118.9551; train_gene_expr_recon_loss: 1810916.3956; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3561758.5684; train_optim_loss: 3561758.5684; val_kl_reg_loss: 22422.1046; val_edge_recon_loss: 810987.7675; val_cat_covariates_contrastive_loss: 949148.0855; val_gene_expr_recon_loss: 1825937.8902; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3608495.8532; val_optim_loss: 3608495.8532
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9370; val_auprc_score: 0.9849; val_best_acc_score: 0.9354; val_best_f1_score: 0.9629; train_kl_reg_loss: 22586.0205; train_edge_recon_loss: 781462.3767; train_cat_covariates_contrastive_loss: 949012.8451; train_gene_expr_recon_loss: 1810513.7325; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3563574.9746; train_optim_loss: 3563574.9746; val_kl_reg_loss: 22412.1871; val_edge_recon_loss: 792191.1659; val_cat_covariates_contrastive_loss: 949151.9081; val_gene_expr_recon_loss: 1827416.4281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3591171.6862; val_optim_loss: 3591171.6862
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9334; val_auprc_score: 0.9836; val_best_acc_score: 0.9348; val_best_f1_score: 0.9625; train_kl_reg_loss: 22603.5583; train_edge_recon_loss: 780447.6941; train_cat_covariates_contrastive_loss: 949019.3449; train_gene_expr_recon_loss: 1811312.8786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3563383.4734; train_optim_loss: 3563383.4734; val_kl_reg_loss: 22402.7572; val_edge_recon_loss: 801523.1020; val_cat_covariates_contrastive_loss: 949306.7968; val_gene_expr_recon_loss: 1825817.2515; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3599049.9119; val_optim_loss: 3599049.9119
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9360; val_auprc_score: 0.9843; val_best_acc_score: 0.9352; val_best_f1_score: 0.9627; train_kl_reg_loss: 22578.7726; train_edge_recon_loss: 777324.4100; train_cat_covariates_contrastive_loss: 949173.5405; train_gene_expr_recon_loss: 1810770.4728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559847.1946; train_optim_loss: 3559847.1946; val_kl_reg_loss: 22418.2443; val_edge_recon_loss: 802639.6862; val_cat_covariates_contrastive_loss: 949025.5020; val_gene_expr_recon_loss: 1825243.8811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3599327.3158; val_optim_loss: 3599327.3158
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9357; val_auprc_score: 0.9845; val_best_acc_score: 0.9351; val_best_f1_score: 0.9627; train_kl_reg_loss: 22597.0137; train_edge_recon_loss: 780021.8107; train_cat_covariates_contrastive_loss: 949056.9940; train_gene_expr_recon_loss: 1810316.8619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3561992.6794; train_optim_loss: 3561992.6794; val_kl_reg_loss: 22466.5412; val_edge_recon_loss: 800815.5018; val_cat_covariates_contrastive_loss: 948762.4390; val_gene_expr_recon_loss: 1825800.4641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3597844.9413; val_optim_loss: 3597844.9413
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9365; val_auprc_score: 0.9844; val_best_acc_score: 0.9356; val_best_f1_score: 0.9630; train_kl_reg_loss: 22615.4767; train_edge_recon_loss: 776727.0810; train_cat_covariates_contrastive_loss: 949046.5262; train_gene_expr_recon_loss: 1810885.6504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559274.7351; train_optim_loss: 3559274.7351; val_kl_reg_loss: 22427.4214; val_edge_recon_loss: 801788.2411; val_cat_covariates_contrastive_loss: 949019.2862; val_gene_expr_recon_loss: 1825795.9180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3599030.8634; val_optim_loss: 3599030.8634

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9363; val_auprc_score: 0.9844; val_best_acc_score: 0.9355; val_best_f1_score: 0.9629; train_kl_reg_loss: 22598.3497; train_edge_recon_loss: 777565.2747; train_cat_covariates_contrastive_loss: 949090.3323; train_gene_expr_recon_loss: 1810017.7278; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3559271.6833; train_optim_loss: 3559271.6833; val_kl_reg_loss: 22419.9789; val_edge_recon_loss: 801788.6179; val_cat_covariates_contrastive_loss: 949208.0906; val_gene_expr_recon_loss: 1827602.5739; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3601019.2601; val_optim_loss: 3601019.2601
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9365; val_auprc_score: 0.9844; val_best_acc_score: 0.9348; val_best_f1_score: 0.9625; train_kl_reg_loss: 22605.7942; train_edge_recon_loss: 778593.0814; train_cat_covariates_contrastive_loss: 949054.3443; train_gene_expr_recon_loss: 1810481.2384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3560734.4594; train_optim_loss: 3560734.4594; val_kl_reg_loss: 22412.0684; val_edge_recon_loss: 809432.7272; val_cat_covariates_contrastive_loss: 949379.4727; val_gene_expr_recon_loss: 1823819.2819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3605043.5425; val_optim_loss: 3605043.5425
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9346; val_auprc_score: 0.9838; val_best_acc_score: 0.9352; val_best_f1_score: 0.9628; train_kl_reg_loss: 22600.8921; train_edge_recon_loss: 781662.1530; train_cat_covariates_contrastive_loss: 949060.8208; train_gene_expr_recon_loss: 1810020.9871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3563344.8521; train_optim_loss: 3563344.8521; val_kl_reg_loss: 22404.6576; val_edge_recon_loss: 806043.1695; val_cat_covariates_contrastive_loss: 949039.6554; val_gene_expr_recon_loss: 1824903.7642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3602391.2439; val_optim_loss: 3602391.2439
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9367; val_auprc_score: 0.9847; val_best_acc_score: 0.9355; val_best_f1_score: 0.9630; train_kl_reg_loss: 22607.8016; train_edge_recon_loss: 779067.0502; train_cat_covariates_contrastive_loss: 948949.7975; train_gene_expr_recon_loss: 1810623.2656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3561247.9161; train_optim_loss: 3561247.9161; val_kl_reg_loss: 22423.6689; val_edge_recon_loss: 798761.1017; val_cat_covariates_contrastive_loss: 949451.7098; val_gene_expr_recon_loss: 1823961.4560; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3594597.9342; val_optim_loss: 3594597.9342

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 618 min 54 sec.
Using best model state, which was in epoch 57.

--- MODEL EVALUATION ---
val AUROC score: 0.9216
val AUPRC score: 0.9771
val best accuracy score: 0.9329
val best F1 score: 0.9614
val target rna MSE score: 0.3912
val source rna MSE score: 0.1131
Val cat covariate0 mean sim diff: -0.0009
Val cat covariate1 mean sim diff: -0.0686
Val cat covariate2 mean sim diff: 0.0005

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
