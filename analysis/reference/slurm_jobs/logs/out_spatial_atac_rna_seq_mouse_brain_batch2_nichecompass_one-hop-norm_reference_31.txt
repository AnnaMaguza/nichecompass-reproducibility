[True]
Run timestamp: 09102023_204314_31.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_31']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6274; val_auprc_score: 0.6223; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 42053.5115; train_edge_recon_loss: 3504640.0530; train_gene_expr_recon_loss: 14179897.1970; train_masked_gp_l1_reg_loss: 46436.7842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5612529.5000; train_chrom_access_recon_loss: 2343153.5076; train_global_loss: 25728710.6061; train_optim_loss: 25728710.6061; val_kl_reg_loss: 89493.1260; val_edge_recon_loss: 4065278.6250; val_gene_expr_recon_loss: 13103854.0000; val_masked_gp_l1_reg_loss: 53148.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2635973.2500; val_chrom_access_recon_loss: 2231730.2500; val_global_loss: 22179478.5000; val_optim_loss: 22179478.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7336; val_auprc_score: 0.7071; val_best_acc_score: 0.5795; val_best_f1_score: 0.6987; train_kl_reg_loss: 78464.0495; train_edge_recon_loss: 3510382.7273; train_gene_expr_recon_loss: 12930214.0758; train_masked_gp_l1_reg_loss: 53686.1024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1242432.7775; train_chrom_access_recon_loss: 2232800.9508; train_global_loss: 20047980.6364; train_optim_loss: 20047980.6364; val_kl_reg_loss: 80635.1729; val_edge_recon_loss: 4060793.4375; val_gene_expr_recon_loss: 12722144.1250; val_masked_gp_l1_reg_loss: 55020.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 513663.2812; val_chrom_access_recon_loss: 2206803.5000; val_global_loss: 19639060.0000; val_optim_loss: 19639060.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7611; val_auprc_score: 0.7374; val_best_acc_score: 0.6851; val_best_f1_score: 0.7052; train_kl_reg_loss: 76938.7719; train_edge_recon_loss: 3504620.7614; train_gene_expr_recon_loss: 12723774.8182; train_masked_gp_l1_reg_loss: 56215.9117; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 343929.3786; train_chrom_access_recon_loss: 2206869.8390; train_global_loss: 18912349.2424; train_optim_loss: 18912349.2424; val_kl_reg_loss: 71948.9150; val_edge_recon_loss: 4020942.4688; val_gene_expr_recon_loss: 12594503.5000; val_masked_gp_l1_reg_loss: 57464.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 240725.5625; val_chrom_access_recon_loss: 2191712.9375; val_global_loss: 19177297.2500; val_optim_loss: 19177297.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8485; val_auprc_score: 0.8135; val_best_acc_score: 0.7727; val_best_f1_score: 0.7989; train_kl_reg_loss: 62765.2478; train_edge_recon_loss: 3451959.4053; train_gene_expr_recon_loss: 12639199.5455; train_masked_gp_l1_reg_loss: 59054.0060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199269.0109; train_chrom_access_recon_loss: 2193806.2235; train_global_loss: 18606053.3939; train_optim_loss: 18606053.3939; val_kl_reg_loss: 45164.5376; val_edge_recon_loss: 3348870.6250; val_gene_expr_recon_loss: 12624274.7500; val_masked_gp_l1_reg_loss: 61354.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170233.7031; val_chrom_access_recon_loss: 2186128.5000; val_global_loss: 18436027.2500; val_optim_loss: 18436027.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8414; val_auprc_score: 0.8117; val_best_acc_score: 0.7456; val_best_f1_score: 0.7856; train_kl_reg_loss: 83741.5617; train_edge_recon_loss: 3009180.2803; train_gene_expr_recon_loss: 12573328.8788; train_masked_gp_l1_reg_loss: 65634.2727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155423.3532; train_chrom_access_recon_loss: 2182024.4621; train_global_loss: 18069332.7879; train_optim_loss: 18069332.7879; val_kl_reg_loss: 109336.2744; val_edge_recon_loss: 2973225.4688; val_gene_expr_recon_loss: 12408467.2500; val_masked_gp_l1_reg_loss: 68358.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142685.7812; val_chrom_access_recon_loss: 2155697.2812; val_global_loss: 17857770.0000; val_optim_loss: 17857770.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8538; val_auprc_score: 0.8170; val_best_acc_score: 0.7808; val_best_f1_score: 0.8079; train_kl_reg_loss: 94328.2023; train_edge_recon_loss: 2918095.8788; train_gene_expr_recon_loss: 12480968.8485; train_masked_gp_l1_reg_loss: 69538.5729; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135342.0473; train_chrom_access_recon_loss: 2167422.0398; train_global_loss: 17865695.4848; train_optim_loss: 17865695.4848; val_kl_reg_loss: 91248.2295; val_edge_recon_loss: 2919179.1250; val_gene_expr_recon_loss: 12326602.0000; val_masked_gp_l1_reg_loss: 70780.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128347.0469; val_chrom_access_recon_loss: 2154248.4531; val_global_loss: 17690404.7500; val_optim_loss: 17690404.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8604; val_auprc_score: 0.8191; val_best_acc_score: 0.7947; val_best_f1_score: 0.8155; train_kl_reg_loss: 91231.5638; train_edge_recon_loss: 2858817.9470; train_gene_expr_recon_loss: 12405807.9697; train_masked_gp_l1_reg_loss: 71994.8048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123192.7628; train_chrom_access_recon_loss: 2153647.5928; train_global_loss: 17704692.6061; train_optim_loss: 17704692.6061; val_kl_reg_loss: 91658.1172; val_edge_recon_loss: 2929985.9688; val_gene_expr_recon_loss: 12284722.8750; val_masked_gp_l1_reg_loss: 73277.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118455.2344; val_chrom_access_recon_loss: 2118195.8594; val_global_loss: 17616294.7500; val_optim_loss: 17616294.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8781; val_auprc_score: 0.8361; val_best_acc_score: 0.8103; val_best_f1_score: 0.8256; train_kl_reg_loss: 96878.4394; train_edge_recon_loss: 2843633.6136; train_gene_expr_recon_loss: 12345909.8788; train_masked_gp_l1_reg_loss: 74330.0346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115835.5528; train_chrom_access_recon_loss: 2145536.1193; train_global_loss: 17622123.6667; train_optim_loss: 17622123.6667; val_kl_reg_loss: 95069.2412; val_edge_recon_loss: 2867458.2500; val_gene_expr_recon_loss: 12325750.2500; val_masked_gp_l1_reg_loss: 75447.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114313.5625; val_chrom_access_recon_loss: 2147850.6562; val_global_loss: 17625890.2500; val_optim_loss: 17625890.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8725; val_auprc_score: 0.8329; val_best_acc_score: 0.8071; val_best_f1_score: 0.8270; train_kl_reg_loss: 95457.0848; train_edge_recon_loss: 2821781.2083; train_gene_expr_recon_loss: 12279369.9091; train_masked_gp_l1_reg_loss: 76302.7045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112833.5755; train_chrom_access_recon_loss: 2135480.6439; train_global_loss: 17521225.0909; train_optim_loss: 17521225.0909; val_kl_reg_loss: 91582.9678; val_edge_recon_loss: 2852563.3750; val_gene_expr_recon_loss: 12183810.7500; val_masked_gp_l1_reg_loss: 77376.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112000.3203; val_chrom_access_recon_loss: 2109075.0312; val_global_loss: 17426407.7500; val_optim_loss: 17426407.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9002; val_auprc_score: 0.8726; val_best_acc_score: 0.8305; val_best_f1_score: 0.8438; train_kl_reg_loss: 92218.9305; train_edge_recon_loss: 2818295.9773; train_gene_expr_recon_loss: 12229522.2576; train_masked_gp_l1_reg_loss: 78105.1876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110502.4007; train_chrom_access_recon_loss: 2128199.9924; train_global_loss: 17456844.6515; train_optim_loss: 17456844.6515; val_kl_reg_loss: 93582.7129; val_edge_recon_loss: 2797835.7188; val_gene_expr_recon_loss: 12201655.2500; val_masked_gp_l1_reg_loss: 78892.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108425.5547; val_chrom_access_recon_loss: 2106723.8438; val_global_loss: 17387115.2500; val_optim_loss: 17387115.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8953; val_auprc_score: 0.8677; val_best_acc_score: 0.8280; val_best_f1_score: 0.8446; train_kl_reg_loss: 92341.9344; train_edge_recon_loss: 2804118.6932; train_gene_expr_recon_loss: 12176727.5152; train_masked_gp_l1_reg_loss: 79677.2308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106645.3569; train_chrom_access_recon_loss: 2119949.3939; train_global_loss: 17379460.1364; train_optim_loss: 17379460.1364; val_kl_reg_loss: 93492.9648; val_edge_recon_loss: 2838565.4062; val_gene_expr_recon_loss: 12061734.1250; val_masked_gp_l1_reg_loss: 80328.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104903.0156; val_chrom_access_recon_loss: 2100294.9375; val_global_loss: 17279319.5000; val_optim_loss: 17279319.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9070; val_auprc_score: 0.8754; val_best_acc_score: 0.8428; val_best_f1_score: 0.8541; train_kl_reg_loss: 90076.3137; train_edge_recon_loss: 2788546.1818; train_gene_expr_recon_loss: 12131844.8636; train_masked_gp_l1_reg_loss: 80998.0708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103850.6510; train_chrom_access_recon_loss: 2111283.5852; train_global_loss: 17306599.6364; train_optim_loss: 17306599.6364; val_kl_reg_loss: 89517.0176; val_edge_recon_loss: 2792301.9062; val_gene_expr_recon_loss: 12088560.0000; val_masked_gp_l1_reg_loss: 81704.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101566.5000; val_chrom_access_recon_loss: 2109276.8750; val_global_loss: 17262927.5000; val_optim_loss: 17262927.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9091; val_auprc_score: 0.8753; val_best_acc_score: 0.8474; val_best_f1_score: 0.8586; train_kl_reg_loss: 89334.7889; train_edge_recon_loss: 2775580.8636; train_gene_expr_recon_loss: 12093891.3182; train_masked_gp_l1_reg_loss: 82116.9403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100961.6327; train_chrom_access_recon_loss: 2105394.4205; train_global_loss: 17247280.0455; train_optim_loss: 17247280.0455; val_kl_reg_loss: 88590.6191; val_edge_recon_loss: 2830016.5938; val_gene_expr_recon_loss: 12049589.6250; val_masked_gp_l1_reg_loss: 82868.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100746.5547; val_chrom_access_recon_loss: 2097611.3594; val_global_loss: 17249424.0000; val_optim_loss: 17249424.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.8989; val_auprc_score: 0.8563; val_best_acc_score: 0.8404; val_best_f1_score: 0.8544; train_kl_reg_loss: 88042.6680; train_edge_recon_loss: 2762402.2614; train_gene_expr_recon_loss: 12060355.9545; train_masked_gp_l1_reg_loss: 83349.4309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99348.4143; train_chrom_access_recon_loss: 2100119.2462; train_global_loss: 17193617.8333; train_optim_loss: 17193617.8333; val_kl_reg_loss: 86981.8682; val_edge_recon_loss: 2832050.7188; val_gene_expr_recon_loss: 11915097.0000; val_masked_gp_l1_reg_loss: 83865.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98261.4453; val_chrom_access_recon_loss: 2061009.5156; val_global_loss: 17077265.8750; val_optim_loss: 17077265.8750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9123; val_auprc_score: 0.8875; val_best_acc_score: 0.8528; val_best_f1_score: 0.8612; train_kl_reg_loss: 89455.3492; train_edge_recon_loss: 2768820.9091; train_gene_expr_recon_loss: 12016752.8030; train_masked_gp_l1_reg_loss: 84288.7855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97254.2206; train_chrom_access_recon_loss: 2092832.7178; train_global_loss: 17149404.8485; train_optim_loss: 17149404.8485; val_kl_reg_loss: 88297.1699; val_edge_recon_loss: 2785680.0938; val_gene_expr_recon_loss: 11960271.7500; val_masked_gp_l1_reg_loss: 84819.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96718.1562; val_chrom_access_recon_loss: 2094659.2344; val_global_loss: 17110445.2500; val_optim_loss: 17110445.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9150; val_auprc_score: 0.8854; val_best_acc_score: 0.8573; val_best_f1_score: 0.8671; train_kl_reg_loss: 86916.7051; train_edge_recon_loss: 2770026.6629; train_gene_expr_recon_loss: 11983126.1364; train_masked_gp_l1_reg_loss: 85153.1201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95993.4220; train_chrom_access_recon_loss: 2086556.7348; train_global_loss: 17107772.7424; train_optim_loss: 17107772.7424; val_kl_reg_loss: 86803.7148; val_edge_recon_loss: 2810339.0000; val_gene_expr_recon_loss: 11920614.3750; val_masked_gp_l1_reg_loss: 85482.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95731.6016; val_chrom_access_recon_loss: 2087928.1094; val_global_loss: 17086898.8750; val_optim_loss: 17086898.8750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9209; val_auprc_score: 0.8927; val_best_acc_score: 0.8595; val_best_f1_score: 0.8674; train_kl_reg_loss: 87119.6638; train_edge_recon_loss: 2754224.9470; train_gene_expr_recon_loss: 11941681.3788; train_masked_gp_l1_reg_loss: 85757.7311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94739.8723; train_chrom_access_recon_loss: 2080704.4451; train_global_loss: 17044228.2121; train_optim_loss: 17044228.2121; val_kl_reg_loss: 81764.6562; val_edge_recon_loss: 2774655.4062; val_gene_expr_recon_loss: 11853414.5000; val_masked_gp_l1_reg_loss: 86095.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94610.6875; val_chrom_access_recon_loss: 2056433.7969; val_global_loss: 16946974.5000; val_optim_loss: 16946974.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9203; val_auprc_score: 0.8879; val_best_acc_score: 0.8581; val_best_f1_score: 0.8692; train_kl_reg_loss: 86488.2920; train_edge_recon_loss: 2750012.6970; train_gene_expr_recon_loss: 11928943.4545; train_masked_gp_l1_reg_loss: 86525.7347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94029.7448; train_chrom_access_recon_loss: 2075783.1761; train_global_loss: 17021783.1818; train_optim_loss: 17021783.1818; val_kl_reg_loss: 85969.1680; val_edge_recon_loss: 2768524.2812; val_gene_expr_recon_loss: 11868828.1250; val_masked_gp_l1_reg_loss: 86855.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93862.7812; val_chrom_access_recon_loss: 2060315.9531; val_global_loss: 16964355.5000; val_optim_loss: 16964355.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9179; val_auprc_score: 0.8913; val_best_acc_score: 0.8557; val_best_f1_score: 0.8660; train_kl_reg_loss: 86082.4238; train_edge_recon_loss: 2735676.7311; train_gene_expr_recon_loss: 11893019.8485; train_masked_gp_l1_reg_loss: 87199.9654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93446.0903; train_chrom_access_recon_loss: 2068681.8636; train_global_loss: 16964106.9091; train_optim_loss: 16964106.9091; val_kl_reg_loss: 84534.0195; val_edge_recon_loss: 2817745.8125; val_gene_expr_recon_loss: 11843430.5000; val_masked_gp_l1_reg_loss: 87374.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92868.6953; val_chrom_access_recon_loss: 2061065.6562; val_global_loss: 16987019.8750; val_optim_loss: 16987019.8750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9183; val_auprc_score: 0.8863; val_best_acc_score: 0.8573; val_best_f1_score: 0.8679; train_kl_reg_loss: 86403.9448; train_edge_recon_loss: 2753926.1553; train_gene_expr_recon_loss: 11869023.6515; train_masked_gp_l1_reg_loss: 87626.5728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92646.4774; train_chrom_access_recon_loss: 2063351.9678; train_global_loss: 16952978.7424; train_optim_loss: 16952978.7424; val_kl_reg_loss: 88802.5811; val_edge_recon_loss: 2798088.4062; val_gene_expr_recon_loss: 11797436.0000; val_masked_gp_l1_reg_loss: 87993.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92264.6953; val_chrom_access_recon_loss: 2046449.9062; val_global_loss: 16911035.2500; val_optim_loss: 16911035.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9229; val_auprc_score: 0.8921; val_best_acc_score: 0.8614; val_best_f1_score: 0.8703; train_kl_reg_loss: 84810.5444; train_edge_recon_loss: 2743493.3750; train_gene_expr_recon_loss: 11843676.4242; train_masked_gp_l1_reg_loss: 88011.3082; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92467.5240; train_chrom_access_recon_loss: 2061918.4981; train_global_loss: 16914377.8182; train_optim_loss: 16914377.8182; val_kl_reg_loss: 81895.5986; val_edge_recon_loss: 2783992.5312; val_gene_expr_recon_loss: 11689407.6250; val_masked_gp_l1_reg_loss: 88417.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93419.7969; val_chrom_access_recon_loss: 2031937.7812; val_global_loss: 16769071.6250; val_optim_loss: 16769071.6250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9372; val_auprc_score: 0.9133; val_best_acc_score: 0.8748; val_best_f1_score: 0.8818; train_kl_reg_loss: 84188.5642; train_edge_recon_loss: 2731375.8636; train_gene_expr_recon_loss: 11814364.6061; train_masked_gp_l1_reg_loss: 88546.3042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92691.3975; train_chrom_access_recon_loss: 2055216.1364; train_global_loss: 16866382.8939; train_optim_loss: 16866382.8939; val_kl_reg_loss: 83014.5654; val_edge_recon_loss: 2752703.5312; val_gene_expr_recon_loss: 11773779.8750; val_masked_gp_l1_reg_loss: 88855.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93153.1484; val_chrom_access_recon_loss: 2031142.6250; val_global_loss: 16822648.3750; val_optim_loss: 16822648.3750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9364; val_auprc_score: 0.9142; val_best_acc_score: 0.8767; val_best_f1_score: 0.8812; train_kl_reg_loss: 83173.3325; train_edge_recon_loss: 2730419.7765; train_gene_expr_recon_loss: 11790929.6970; train_masked_gp_l1_reg_loss: 89030.7990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93199.8504; train_chrom_access_recon_loss: 2050394.1989; train_global_loss: 16837147.6212; train_optim_loss: 16837147.6212; val_kl_reg_loss: 82739.5713; val_edge_recon_loss: 2744421.5000; val_gene_expr_recon_loss: 11708243.5000; val_masked_gp_l1_reg_loss: 89216.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93342.9141; val_chrom_access_recon_loss: 2042025.0938; val_global_loss: 16759988.6250; val_optim_loss: 16759988.6250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9309; val_auprc_score: 0.9054; val_best_acc_score: 0.8710; val_best_f1_score: 0.8776; train_kl_reg_loss: 82670.2926; train_edge_recon_loss: 2735150.4242; train_gene_expr_recon_loss: 11769888.9394; train_masked_gp_l1_reg_loss: 89410.8512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93338.9083; train_chrom_access_recon_loss: 2045666.2292; train_global_loss: 16816125.7727; train_optim_loss: 16816125.7727; val_kl_reg_loss: 83552.3457; val_edge_recon_loss: 2761660.4375; val_gene_expr_recon_loss: 11822422.5000; val_masked_gp_l1_reg_loss: 89550.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93753.0938; val_chrom_access_recon_loss: 2065476.7188; val_global_loss: 16916414.8750; val_optim_loss: 16916414.8750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9376; val_auprc_score: 0.9114; val_best_acc_score: 0.8743; val_best_f1_score: 0.8797; train_kl_reg_loss: 83251.2513; train_edge_recon_loss: 2723423.5871; train_gene_expr_recon_loss: 11736860.4697; train_masked_gp_l1_reg_loss: 89610.9323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93475.6420; train_chrom_access_recon_loss: 2040891.4280; train_global_loss: 16767513.3182; train_optim_loss: 16767513.3182; val_kl_reg_loss: 81985.5361; val_edge_recon_loss: 2748115.3125; val_gene_expr_recon_loss: 11622545.3750; val_masked_gp_l1_reg_loss: 89767.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93720.8125; val_chrom_access_recon_loss: 2018190.6094; val_global_loss: 16654325.6250; val_optim_loss: 16654325.6250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9295; val_auprc_score: 0.9032; val_best_acc_score: 0.8651; val_best_f1_score: 0.8713; train_kl_reg_loss: 101396.7461; train_edge_recon_loss: 2824475.5303; train_gene_expr_recon_loss: 10743137.6515; train_masked_gp_l1_reg_loss: 89651.8338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89952.7047; train_chrom_access_recon_loss: 1894933.4508; train_global_loss: 15743547.8333; train_optim_loss: 15743547.8333; val_kl_reg_loss: 31630.2986; val_edge_recon_loss: 2817957.2500; val_gene_expr_recon_loss: 10673634.2500; val_masked_gp_l1_reg_loss: 89496.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90085.4062; val_chrom_access_recon_loss: 1848160.5938; val_global_loss: 15550964.5000; val_optim_loss: 15550964.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9245; val_auprc_score: 0.8853; val_best_acc_score: 0.8649; val_best_f1_score: 0.8716; train_kl_reg_loss: 86128.7094; train_edge_recon_loss: 2760715.0189; train_gene_expr_recon_loss: 10683010.2121; train_masked_gp_l1_reg_loss: 89026.9780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90353.9783; train_chrom_access_recon_loss: 1863268.6402; train_global_loss: 15572503.5606; train_optim_loss: 15572503.5606; val_kl_reg_loss: 37694.0117; val_edge_recon_loss: 2790944.5625; val_gene_expr_recon_loss: 10597850.7500; val_masked_gp_l1_reg_loss: 88243.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90703.7344; val_chrom_access_recon_loss: 1849825.8750; val_global_loss: 15455262.5000; val_optim_loss: 15455262.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9318; val_auprc_score: 0.9053; val_best_acc_score: 0.8694; val_best_f1_score: 0.8749; train_kl_reg_loss: 75327.8346; train_edge_recon_loss: 2741033.2197; train_gene_expr_recon_loss: 10662776.8788; train_masked_gp_l1_reg_loss: 87376.1371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90405.4702; train_chrom_access_recon_loss: 1858523.6458; train_global_loss: 15515443.2727; train_optim_loss: 15515443.2727; val_kl_reg_loss: 38500.0405; val_edge_recon_loss: 2753597.3438; val_gene_expr_recon_loss: 10575521.5000; val_masked_gp_l1_reg_loss: 86533.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90706.7734; val_chrom_access_recon_loss: 1833817.9844; val_global_loss: 15378677.7500; val_optim_loss: 15378677.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9225; val_auprc_score: 0.8883; val_best_acc_score: 0.8654; val_best_f1_score: 0.8723; train_kl_reg_loss: 70234.7646; train_edge_recon_loss: 2735947.3182; train_gene_expr_recon_loss: 10640955.5303; train_masked_gp_l1_reg_loss: 85573.7988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90007.7713; train_chrom_access_recon_loss: 1853372.1231; train_global_loss: 15476091.3636; train_optim_loss: 15476091.3636; val_kl_reg_loss: 45889.9346; val_edge_recon_loss: 2810424.8125; val_gene_expr_recon_loss: 10584700.5000; val_masked_gp_l1_reg_loss: 84680.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89711.2266; val_chrom_access_recon_loss: 1859559.5156; val_global_loss: 15474966.8750; val_optim_loss: 15474966.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9345; val_auprc_score: 0.9086; val_best_acc_score: 0.8673; val_best_f1_score: 0.8743; train_kl_reg_loss: 67189.4278; train_edge_recon_loss: 2715318.8333; train_gene_expr_recon_loss: 10632741.6818; train_masked_gp_l1_reg_loss: 83943.5678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89318.0671; train_chrom_access_recon_loss: 1852132.4735; train_global_loss: 15440643.9697; train_optim_loss: 15440643.9697; val_kl_reg_loss: 50024.7842; val_edge_recon_loss: 2757774.3438; val_gene_expr_recon_loss: 10600317.2500; val_masked_gp_l1_reg_loss: 83104.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89278.3047; val_chrom_access_recon_loss: 1853219.3750; val_global_loss: 15433718.7500; val_optim_loss: 15433718.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9403; val_auprc_score: 0.9148; val_best_acc_score: 0.8786; val_best_f1_score: 0.8864; train_kl_reg_loss: 64086.0882; train_edge_recon_loss: 2718433.4091; train_gene_expr_recon_loss: 10600703.7424; train_masked_gp_l1_reg_loss: 82269.9651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89075.1043; train_chrom_access_recon_loss: 1845772.3390; train_global_loss: 15400340.6818; train_optim_loss: 15400340.6818; val_kl_reg_loss: 50523.9805; val_edge_recon_loss: 2715393.6875; val_gene_expr_recon_loss: 10501272.5000; val_masked_gp_l1_reg_loss: 81423.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88725.2344; val_chrom_access_recon_loss: 1836307.9375; val_global_loss: 15273647.0000; val_optim_loss: 15273647.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9341; val_auprc_score: 0.9022; val_best_acc_score: 0.8791; val_best_f1_score: 0.8847; train_kl_reg_loss: 63734.1019; train_edge_recon_loss: 2719793.4015; train_gene_expr_recon_loss: 10580307.8485; train_masked_gp_l1_reg_loss: 80707.3441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88675.6210; train_chrom_access_recon_loss: 1843231.1402; train_global_loss: 15376449.5000; train_optim_loss: 15376449.5000; val_kl_reg_loss: 52242.8521; val_edge_recon_loss: 2735007.6562; val_gene_expr_recon_loss: 10482087.0000; val_masked_gp_l1_reg_loss: 80053.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88674.7656; val_chrom_access_recon_loss: 1825209.0625; val_global_loss: 15263275.5000; val_optim_loss: 15263275.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9362; val_auprc_score: 0.9132; val_best_acc_score: 0.8745; val_best_f1_score: 0.8795; train_kl_reg_loss: 60678.6900; train_edge_recon_loss: 2710373.6326; train_gene_expr_recon_loss: 10577030.0606; train_masked_gp_l1_reg_loss: 79501.2143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88414.0991; train_chrom_access_recon_loss: 1842809.8277; train_global_loss: 15358807.5606; train_optim_loss: 15358807.5606; val_kl_reg_loss: 52794.2925; val_edge_recon_loss: 2770124.7812; val_gene_expr_recon_loss: 10391086.8750; val_masked_gp_l1_reg_loss: 78926.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87880.7344; val_chrom_access_recon_loss: 1811667.6406; val_global_loss: 15192481.3750; val_optim_loss: 15192481.3750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9318; val_auprc_score: 0.9015; val_best_acc_score: 0.8775; val_best_f1_score: 0.8840; train_kl_reg_loss: 63199.8242; train_edge_recon_loss: 2720108.5303; train_gene_expr_recon_loss: 10537879.0000; train_masked_gp_l1_reg_loss: 78523.1293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87979.6599; train_chrom_access_recon_loss: 1833629.2841; train_global_loss: 15321319.4091; train_optim_loss: 15321319.4091; val_kl_reg_loss: 52264.3179; val_edge_recon_loss: 2775776.0312; val_gene_expr_recon_loss: 10490515.1250; val_masked_gp_l1_reg_loss: 78009.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87714.7266; val_chrom_access_recon_loss: 1833756.5000; val_global_loss: 15318036.1250; val_optim_loss: 15318036.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9384; val_auprc_score: 0.9115; val_best_acc_score: 0.8786; val_best_f1_score: 0.8855; train_kl_reg_loss: 62303.6733; train_edge_recon_loss: 2704804.2121; train_gene_expr_recon_loss: 10512111.5909; train_masked_gp_l1_reg_loss: 77606.8016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88229.2669; train_chrom_access_recon_loss: 1833492.6875; train_global_loss: 15278548.2879; train_optim_loss: 15278548.2879; val_kl_reg_loss: 54345.2056; val_edge_recon_loss: 2751887.6875; val_gene_expr_recon_loss: 10484348.0000; val_masked_gp_l1_reg_loss: 77133.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88632.3984; val_chrom_access_recon_loss: 1817490.0938; val_global_loss: 15273836.7500; val_optim_loss: 15273836.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9395; val_auprc_score: 0.9180; val_best_acc_score: 0.8796; val_best_f1_score: 0.8857; train_kl_reg_loss: 63135.2897; train_edge_recon_loss: 2700341.9545; train_gene_expr_recon_loss: 10507914.0303; train_masked_gp_l1_reg_loss: 76703.7081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88379.2418; train_chrom_access_recon_loss: 1830032.7083; train_global_loss: 15266506.8485; train_optim_loss: 15266506.8485; val_kl_reg_loss: 52984.2256; val_edge_recon_loss: 2755740.0312; val_gene_expr_recon_loss: 10328414.8750; val_masked_gp_l1_reg_loss: 76298.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87988.2578; val_chrom_access_recon_loss: 1800594.8438; val_global_loss: 15102021.2500; val_optim_loss: 15102021.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9382; val_auprc_score: 0.9111; val_best_acc_score: 0.8826; val_best_f1_score: 0.8888; train_kl_reg_loss: 63775.3117; train_edge_recon_loss: 2704890.3068; train_gene_expr_recon_loss: 10486838.6515; train_masked_gp_l1_reg_loss: 76010.8627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88368.4496; train_chrom_access_recon_loss: 1826247.2235; train_global_loss: 15246130.7879; train_optim_loss: 15246130.7879; val_kl_reg_loss: 53947.3867; val_edge_recon_loss: 2780419.7812; val_gene_expr_recon_loss: 10465321.5000; val_masked_gp_l1_reg_loss: 75673.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88623.7031; val_chrom_access_recon_loss: 1826248.6719; val_global_loss: 15290234.5000; val_optim_loss: 15290234.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9436; val_auprc_score: 0.9202; val_best_acc_score: 0.8893; val_best_f1_score: 0.8952; train_kl_reg_loss: 61803.4688; train_edge_recon_loss: 2708015.0341; train_gene_expr_recon_loss: 10471921.7576; train_masked_gp_l1_reg_loss: 75420.1441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88809.3601; train_chrom_access_recon_loss: 1823063.0852; train_global_loss: 15229032.8030; train_optim_loss: 15229032.8030; val_kl_reg_loss: 52748.6943; val_edge_recon_loss: 2722359.8750; val_gene_expr_recon_loss: 10459803.5000; val_masked_gp_l1_reg_loss: 75210.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88822.9375; val_chrom_access_recon_loss: 1820684.3125; val_global_loss: 15219630.3750; val_optim_loss: 15219630.3750
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9437; val_auprc_score: 0.9186; val_best_acc_score: 0.8858; val_best_f1_score: 0.8908; train_kl_reg_loss: 61580.6718; train_edge_recon_loss: 2706439.2008; train_gene_expr_recon_loss: 10461558.1364; train_masked_gp_l1_reg_loss: 74947.6319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89119.9697; train_chrom_access_recon_loss: 1820528.5095; train_global_loss: 15214174.1667; train_optim_loss: 15214174.1667; val_kl_reg_loss: 53762.5679; val_edge_recon_loss: 2742270.4062; val_gene_expr_recon_loss: 10359106.5000; val_masked_gp_l1_reg_loss: 74725.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89554.6172; val_chrom_access_recon_loss: 1811151.1875; val_global_loss: 15130570.5000; val_optim_loss: 15130570.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9353; val_auprc_score: 0.9060; val_best_acc_score: 0.8826; val_best_f1_score: 0.8895; train_kl_reg_loss: 61720.8771; train_edge_recon_loss: 2689189.7992; train_gene_expr_recon_loss: 10455734.3636; train_masked_gp_l1_reg_loss: 74458.7267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89973.6109; train_chrom_access_recon_loss: 1818032.0398; train_global_loss: 15189109.3939; train_optim_loss: 15189109.3939; val_kl_reg_loss: 52780.0645; val_edge_recon_loss: 2745336.1250; val_gene_expr_recon_loss: 10303396.7500; val_masked_gp_l1_reg_loss: 74234.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90359.4844; val_chrom_access_recon_loss: 1799995.2188; val_global_loss: 15066101.1250; val_optim_loss: 15066101.1250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9399; val_auprc_score: 0.9143; val_best_acc_score: 0.8893; val_best_f1_score: 0.8964; train_kl_reg_loss: 60512.6089; train_edge_recon_loss: 2692816.7727; train_gene_expr_recon_loss: 10449409.5455; train_masked_gp_l1_reg_loss: 74080.3649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90281.9609; train_chrom_access_recon_loss: 1818061.4072; train_global_loss: 15185162.5758; train_optim_loss: 15185162.5758; val_kl_reg_loss: 58485.6807; val_edge_recon_loss: 2747432.0312; val_gene_expr_recon_loss: 10398109.8750; val_masked_gp_l1_reg_loss: 73925.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89804.6953; val_chrom_access_recon_loss: 1815347.4688; val_global_loss: 15183105.0000; val_optim_loss: 15183105.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9453; val_auprc_score: 0.9169; val_best_acc_score: 0.8958; val_best_f1_score: 0.9009; train_kl_reg_loss: 61639.5723; train_edge_recon_loss: 2694140.0644; train_gene_expr_recon_loss: 10438979.1818; train_masked_gp_l1_reg_loss: 73587.8667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90241.9558; train_chrom_access_recon_loss: 1814790.5852; train_global_loss: 15173379.2273; train_optim_loss: 15173379.2273; val_kl_reg_loss: 54446.8062; val_edge_recon_loss: 2730079.3438; val_gene_expr_recon_loss: 10309472.3750; val_masked_gp_l1_reg_loss: 73375.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89925.7969; val_chrom_access_recon_loss: 1796803.1562; val_global_loss: 15054102.7500; val_optim_loss: 15054102.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9438; val_auprc_score: 0.9261; val_best_acc_score: 0.8923; val_best_f1_score: 0.8990; train_kl_reg_loss: 61053.6033; train_edge_recon_loss: 2689391.8523; train_gene_expr_recon_loss: 10418016.4545; train_masked_gp_l1_reg_loss: 73157.2617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89967.8003; train_chrom_access_recon_loss: 1809473.8636; train_global_loss: 15141060.8182; train_optim_loss: 15141060.8182; val_kl_reg_loss: 55916.7251; val_edge_recon_loss: 2721581.2500; val_gene_expr_recon_loss: 10416167.5000; val_masked_gp_l1_reg_loss: 72929.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90122.5469; val_chrom_access_recon_loss: 1807858.7969; val_global_loss: 15164577.5000; val_optim_loss: 15164577.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9479; val_auprc_score: 0.9223; val_best_acc_score: 0.8992; val_best_f1_score: 0.9054; train_kl_reg_loss: 61568.9179; train_edge_recon_loss: 2682148.1932; train_gene_expr_recon_loss: 10388999.8788; train_masked_gp_l1_reg_loss: 72634.8333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89936.1946; train_chrom_access_recon_loss: 1806635.6932; train_global_loss: 15101923.7879; train_optim_loss: 15101923.7879; val_kl_reg_loss: 58125.8555; val_edge_recon_loss: 2691161.3750; val_gene_expr_recon_loss: 10341007.0000; val_masked_gp_l1_reg_loss: 72549.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89483.8438; val_chrom_access_recon_loss: 1794147.0625; val_global_loss: 15046474.1250; val_optim_loss: 15046474.1250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9480; val_auprc_score: 0.9275; val_best_acc_score: 0.8979; val_best_f1_score: 0.9036; train_kl_reg_loss: 60618.3143; train_edge_recon_loss: 2688898.3598; train_gene_expr_recon_loss: 10374430.6212; train_masked_gp_l1_reg_loss: 72279.4976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89625.3822; train_chrom_access_recon_loss: 1804336.0208; train_global_loss: 15090188.1212; train_optim_loss: 15090188.1212; val_kl_reg_loss: 56541.7739; val_edge_recon_loss: 2706729.9062; val_gene_expr_recon_loss: 10325565.3750; val_masked_gp_l1_reg_loss: 71993.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89279.1797; val_chrom_access_recon_loss: 1800952.4688; val_global_loss: 15051061.3750; val_optim_loss: 15051061.3750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9472; val_auprc_score: 0.9208; val_best_acc_score: 0.8974; val_best_f1_score: 0.9028; train_kl_reg_loss: 61251.3555; train_edge_recon_loss: 2689824.6818; train_gene_expr_recon_loss: 10374811.7879; train_masked_gp_l1_reg_loss: 71748.1317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89569.7511; train_chrom_access_recon_loss: 1802428.6004; train_global_loss: 15089634.2576; train_optim_loss: 15089634.2576; val_kl_reg_loss: 55385.6543; val_edge_recon_loss: 2701144.1250; val_gene_expr_recon_loss: 10351468.5000; val_masked_gp_l1_reg_loss: 71540.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89907.1641; val_chrom_access_recon_loss: 1779849.9688; val_global_loss: 15049295.2500; val_optim_loss: 15049295.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9484; val_auprc_score: 0.9228; val_best_acc_score: 0.9022; val_best_f1_score: 0.9075; train_kl_reg_loss: 60366.2422; train_edge_recon_loss: 2685691.8902; train_gene_expr_recon_loss: 10359757.0303; train_masked_gp_l1_reg_loss: 71379.8050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89448.1706; train_chrom_access_recon_loss: 1800344.4072; train_global_loss: 15066987.4697; train_optim_loss: 15066987.4697; val_kl_reg_loss: 56764.8672; val_edge_recon_loss: 2697271.4375; val_gene_expr_recon_loss: 10149359.7500; val_masked_gp_l1_reg_loss: 71308.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89431.6562; val_chrom_access_recon_loss: 1767066.4219; val_global_loss: 14831202.5000; val_optim_loss: 14831202.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9525; val_auprc_score: 0.9376; val_best_acc_score: 0.8974; val_best_f1_score: 0.9028; train_kl_reg_loss: 59878.1987; train_edge_recon_loss: 2681347.1553; train_gene_expr_recon_loss: 10366284.2727; train_masked_gp_l1_reg_loss: 71085.6351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89146.7364; train_chrom_access_recon_loss: 1802398.5189; train_global_loss: 15070140.5303; train_optim_loss: 15070140.5303; val_kl_reg_loss: 56924.3647; val_edge_recon_loss: 2730029.8750; val_gene_expr_recon_loss: 10341765.0000; val_masked_gp_l1_reg_loss: 71008.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89340.6484; val_chrom_access_recon_loss: 1798985.3438; val_global_loss: 15088054.3750; val_optim_loss: 15088054.3750
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9521; val_auprc_score: 0.9325; val_best_acc_score: 0.9022; val_best_f1_score: 0.9071; train_kl_reg_loss: 60688.0319; train_edge_recon_loss: 2675895.2803; train_gene_expr_recon_loss: 10347166.3485; train_masked_gp_l1_reg_loss: 70896.1502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88907.8666; train_chrom_access_recon_loss: 1798282.5473; train_global_loss: 15041836.0303; train_optim_loss: 15041836.0303; val_kl_reg_loss: 56519.9365; val_edge_recon_loss: 2696913.3750; val_gene_expr_recon_loss: 10349665.3750; val_masked_gp_l1_reg_loss: 70702.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88938.7500; val_chrom_access_recon_loss: 1813850.4688; val_global_loss: 15076590.2500; val_optim_loss: 15076590.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9554; val_auprc_score: 0.9347; val_best_acc_score: 0.9062; val_best_f1_score: 0.9099; train_kl_reg_loss: 58999.8680; train_edge_recon_loss: 2692288.7765; train_gene_expr_recon_loss: 10336079.6667; train_masked_gp_l1_reg_loss: 70584.5490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88939.2696; train_chrom_access_recon_loss: 1796439.2424; train_global_loss: 15043331.2879; train_optim_loss: 15043331.2879; val_kl_reg_loss: 56051.9424; val_edge_recon_loss: 2723736.9688; val_gene_expr_recon_loss: 10192401.7500; val_masked_gp_l1_reg_loss: 70514.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88790.1641; val_chrom_access_recon_loss: 1794901.1562; val_global_loss: 14926395.8750; val_optim_loss: 14926395.8750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9496; val_auprc_score: 0.9242; val_best_acc_score: 0.9003; val_best_f1_score: 0.9041; train_kl_reg_loss: 58133.3095; train_edge_recon_loss: 2682559.8485; train_gene_expr_recon_loss: 10330966.2576; train_masked_gp_l1_reg_loss: 70453.9266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88824.2925; train_chrom_access_recon_loss: 1795920.6383; train_global_loss: 15026858.3939; train_optim_loss: 15026858.3939; val_kl_reg_loss: 55317.3213; val_edge_recon_loss: 2711978.0000; val_gene_expr_recon_loss: 10271240.1250; val_masked_gp_l1_reg_loss: 70441.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89295.0469; val_chrom_access_recon_loss: 1780247.7500; val_global_loss: 14978519.2500; val_optim_loss: 14978519.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9462; val_auprc_score: 0.9246; val_best_acc_score: 0.8933; val_best_f1_score: 0.8990; train_kl_reg_loss: 58180.5563; train_edge_recon_loss: 2679468.4735; train_gene_expr_recon_loss: 10311417.3182; train_masked_gp_l1_reg_loss: 69852.0945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73397.8381; train_chrom_access_recon_loss: 1793688.2576; train_global_loss: 14986004.5606; train_optim_loss: 14986004.5606; val_kl_reg_loss: 56413.3584; val_edge_recon_loss: 2737217.9688; val_gene_expr_recon_loss: 10198504.2500; val_masked_gp_l1_reg_loss: 69635.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69956.9922; val_chrom_access_recon_loss: 1771163.7344; val_global_loss: 14902891.5000; val_optim_loss: 14902891.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9513; val_auprc_score: 0.9303; val_best_acc_score: 0.8995; val_best_f1_score: 0.9059; train_kl_reg_loss: 59722.8111; train_edge_recon_loss: 2678077.9280; train_gene_expr_recon_loss: 10302665.1061; train_masked_gp_l1_reg_loss: 69589.4109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69524.0075; train_chrom_access_recon_loss: 1792266.2197; train_global_loss: 14971845.5303; train_optim_loss: 14971845.5303; val_kl_reg_loss: 56828.6621; val_edge_recon_loss: 2728436.7500; val_gene_expr_recon_loss: 10186172.5000; val_masked_gp_l1_reg_loss: 69537.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69112.0312; val_chrom_access_recon_loss: 1773517.1562; val_global_loss: 14883604.7500; val_optim_loss: 14883604.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9537; val_auprc_score: 0.9287; val_best_acc_score: 0.9049; val_best_f1_score: 0.9084; train_kl_reg_loss: 60224.0578; train_edge_recon_loss: 2685357.6932; train_gene_expr_recon_loss: 10301751.7576; train_masked_gp_l1_reg_loss: 69504.5236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68876.9044; train_chrom_access_recon_loss: 1792135.4034; train_global_loss: 14977850.3636; train_optim_loss: 14977850.3636; val_kl_reg_loss: 57997.6025; val_edge_recon_loss: 2695967.6250; val_gene_expr_recon_loss: 10201991.3750; val_masked_gp_l1_reg_loss: 69472.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68659.3203; val_chrom_access_recon_loss: 1782713.2344; val_global_loss: 14876801.7500; val_optim_loss: 14876801.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9556; val_auprc_score: 0.9337; val_best_acc_score: 0.9062; val_best_f1_score: 0.9100; train_kl_reg_loss: 60817.5570; train_edge_recon_loss: 2681879.4848; train_gene_expr_recon_loss: 10293951.1364; train_masked_gp_l1_reg_loss: 69447.5717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68549.1218; train_chrom_access_recon_loss: 1792469.9432; train_global_loss: 14967114.8030; train_optim_loss: 14967114.8030; val_kl_reg_loss: 57353.0728; val_edge_recon_loss: 2685867.7500; val_gene_expr_recon_loss: 10245274.8750; val_masked_gp_l1_reg_loss: 69420.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68377.2109; val_chrom_access_recon_loss: 1778896.0469; val_global_loss: 14905188.6250; val_optim_loss: 14905188.6250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 51 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9490
val AUPRC score: 0.9274
val best accuracy score: 0.9003
val best F1 score: 0.9047
val target rna MSE score: 1.7968
val source rna MSE score: 0.8112
val target atac MSE score: 0.3219
val source atac MSE score: 0.1361
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
