[True]
Run timestamp: 10102023_082331_202.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_202']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7903; val_auprc_score: 0.8076; val_best_acc_score: 0.6390; val_best_f1_score: 0.7234; train_kl_reg_loss: 67009.3862; train_edge_recon_loss: 743657.2314; train_gene_expr_recon_loss: 22065573.4046; train_masked_gp_l1_reg_loss: 133816.1497; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3160801.1947; train_chrom_access_recon_loss: 2846895.8359; train_global_loss: 29017753.2214; train_optim_loss: 29017753.2214; val_kl_reg_loss: 83010.0479; val_edge_recon_loss: 811321.4500; val_gene_expr_recon_loss: 21189933.0667; val_masked_gp_l1_reg_loss: 107416.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 673004.8750; val_chrom_access_recon_loss: 2761160.0833; val_global_loss: 25625844.5333; val_optim_loss: 25625844.5333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8651; val_auprc_score: 0.8701; val_best_acc_score: 0.7767; val_best_f1_score: 0.7561; train_kl_reg_loss: 76426.8195; train_edge_recon_loss: 734036.8349; train_gene_expr_recon_loss: 20945660.5496; train_masked_gp_l1_reg_loss: 105514.4563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 348462.7842; train_chrom_access_recon_loss: 2759497.1698; train_global_loss: 24969598.5344; train_optim_loss: 24969598.5344; val_kl_reg_loss: 75331.6115; val_edge_recon_loss: 788918.4458; val_gene_expr_recon_loss: 20872982.2667; val_masked_gp_l1_reg_loss: 105955.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 204422.9688; val_chrom_access_recon_loss: 2731897.1333; val_global_loss: 24779507.3333; val_optim_loss: 24779507.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9129; val_auprc_score: 0.9020; val_best_acc_score: 0.8385; val_best_f1_score: 0.8441; train_kl_reg_loss: 69047.5590; train_edge_recon_loss: 701722.0749; train_gene_expr_recon_loss: 20657723.4351; train_masked_gp_l1_reg_loss: 106783.8234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 166311.9271; train_chrom_access_recon_loss: 2729211.8282; train_global_loss: 24430800.7328; train_optim_loss: 24430800.7328; val_kl_reg_loss: 70293.7667; val_edge_recon_loss: 667611.1833; val_gene_expr_recon_loss: 20604993.3333; val_masked_gp_l1_reg_loss: 108671.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142863.3750; val_chrom_access_recon_loss: 2709759.5000; val_global_loss: 24304194.1333; val_optim_loss: 24304194.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9368; val_auprc_score: 0.9255; val_best_acc_score: 0.8670; val_best_f1_score: 0.8717; train_kl_reg_loss: 79168.8726; train_edge_recon_loss: 634852.1727; train_gene_expr_recon_loss: 20415205.8168; train_masked_gp_l1_reg_loss: 109852.1076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129478.8595; train_chrom_access_recon_loss: 2701995.1870; train_global_loss: 24070552.9618; train_optim_loss: 24070552.9618; val_kl_reg_loss: 78025.2964; val_edge_recon_loss: 622931.4375; val_gene_expr_recon_loss: 20394654.5333; val_masked_gp_l1_reg_loss: 112212.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121904.9062; val_chrom_access_recon_loss: 2686724.4500; val_global_loss: 24016451.7333; val_optim_loss: 24016451.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9371; val_auprc_score: 0.9197; val_best_acc_score: 0.8707; val_best_f1_score: 0.8779; train_kl_reg_loss: 79056.6438; train_edge_recon_loss: 617428.7519; train_gene_expr_recon_loss: 20207931.0076; train_masked_gp_l1_reg_loss: 113120.0342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112719.0274; train_chrom_access_recon_loss: 2682323.2347; train_global_loss: 23812578.7634; train_optim_loss: 23812578.7634; val_kl_reg_loss: 80090.1203; val_edge_recon_loss: 612909.5958; val_gene_expr_recon_loss: 20170872.6667; val_masked_gp_l1_reg_loss: 114740.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107234.6953; val_chrom_access_recon_loss: 2666337.8500; val_global_loss: 23752184.5333; val_optim_loss: 23752184.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9434; val_auprc_score: 0.9305; val_best_acc_score: 0.8809; val_best_f1_score: 0.8849; train_kl_reg_loss: 77591.3937; train_edge_recon_loss: 609723.0811; train_gene_expr_recon_loss: 20067321.7405; train_masked_gp_l1_reg_loss: 115493.9758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101929.5440; train_chrom_access_recon_loss: 2660313.3855; train_global_loss: 23632373.2366; train_optim_loss: 23632373.2366; val_kl_reg_loss: 79067.9073; val_edge_recon_loss: 610445.8875; val_gene_expr_recon_loss: 19976461.2000; val_masked_gp_l1_reg_loss: 116573.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100005.3750; val_chrom_access_recon_loss: 2639936.0667; val_global_loss: 23522491.2000; val_optim_loss: 23522491.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9456; val_auprc_score: 0.9345; val_best_acc_score: 0.8806; val_best_f1_score: 0.8868; train_kl_reg_loss: 75173.0810; train_edge_recon_loss: 606276.4079; train_gene_expr_recon_loss: 19904432.1679; train_masked_gp_l1_reg_loss: 117184.9175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96892.2349; train_chrom_access_recon_loss: 2638411.0916; train_global_loss: 23438369.8626; train_optim_loss: 23438369.8626; val_kl_reg_loss: 76591.7036; val_edge_recon_loss: 604821.7292; val_gene_expr_recon_loss: 19983890.8000; val_masked_gp_l1_reg_loss: 117710.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96742.6797; val_chrom_access_recon_loss: 2630161.7833; val_global_loss: 23509918.2667; val_optim_loss: 23509918.2667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9505; val_auprc_score: 0.9396; val_best_acc_score: 0.8890; val_best_f1_score: 0.8953; train_kl_reg_loss: 73846.4209; train_edge_recon_loss: 602685.6980; train_gene_expr_recon_loss: 19767328.5649; train_masked_gp_l1_reg_loss: 118256.5135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95749.0600; train_chrom_access_recon_loss: 2622631.9809; train_global_loss: 23280498.3817; train_optim_loss: 23280498.3817; val_kl_reg_loss: 70826.0938; val_edge_recon_loss: 601574.9125; val_gene_expr_recon_loss: 19709072.5333; val_masked_gp_l1_reg_loss: 119013.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96087.4766; val_chrom_access_recon_loss: 2598210.4667; val_global_loss: 23194786.0000; val_optim_loss: 23194786.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9538; val_auprc_score: 0.9408; val_best_acc_score: 0.8910; val_best_f1_score: 0.8968; train_kl_reg_loss: 72899.7229; train_edge_recon_loss: 598513.2457; train_gene_expr_recon_loss: 19661450.5649; train_masked_gp_l1_reg_loss: 119161.1597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93402.8665; train_chrom_access_recon_loss: 2608087.1641; train_global_loss: 23153514.5191; train_optim_loss: 23153514.5191; val_kl_reg_loss: 75280.5443; val_edge_recon_loss: 602268.0583; val_gene_expr_recon_loss: 19628136.4000; val_masked_gp_l1_reg_loss: 119817.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92813.6953; val_chrom_access_recon_loss: 2587082.8000; val_global_loss: 23105400.0000; val_optim_loss: 23105400.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9579; val_auprc_score: 0.9479; val_best_acc_score: 0.8963; val_best_f1_score: 0.8999; train_kl_reg_loss: 71287.8252; train_edge_recon_loss: 598447.7171; train_gene_expr_recon_loss: 19561153.5878; train_masked_gp_l1_reg_loss: 120134.9441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90526.3103; train_chrom_access_recon_loss: 2592611.5821; train_global_loss: 23034161.9695; train_optim_loss: 23034161.9695; val_kl_reg_loss: 70277.4250; val_edge_recon_loss: 593733.8083; val_gene_expr_recon_loss: 19639386.5333; val_masked_gp_l1_reg_loss: 120510.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88730.8125; val_chrom_access_recon_loss: 2578287.7333; val_global_loss: 23090925.4667; val_optim_loss: 23090925.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9563; val_auprc_score: 0.9464; val_best_acc_score: 0.8950; val_best_f1_score: 0.8999; train_kl_reg_loss: 70704.9328; train_edge_recon_loss: 594270.4189; train_gene_expr_recon_loss: 19439730.5191; train_masked_gp_l1_reg_loss: 121010.5202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87637.4765; train_chrom_access_recon_loss: 2576348.1756; train_global_loss: 22889701.9084; train_optim_loss: 22889701.9084; val_kl_reg_loss: 69092.5464; val_edge_recon_loss: 598300.3250; val_gene_expr_recon_loss: 19483151.3333; val_masked_gp_l1_reg_loss: 121766.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86976.2734; val_chrom_access_recon_loss: 2553251.4000; val_global_loss: 22912537.3333; val_optim_loss: 22912537.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9636; val_auprc_score: 0.9545; val_best_acc_score: 0.9077; val_best_f1_score: 0.9100; train_kl_reg_loss: 70047.8724; train_edge_recon_loss: 592267.4485; train_gene_expr_recon_loss: 19366409.6489; train_masked_gp_l1_reg_loss: 122036.5143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85701.1994; train_chrom_access_recon_loss: 2563437.7309; train_global_loss: 22799900.3664; train_optim_loss: 22799900.3664; val_kl_reg_loss: 68657.3245; val_edge_recon_loss: 592000.6125; val_gene_expr_recon_loss: 19418381.2000; val_masked_gp_l1_reg_loss: 122684.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85091.5078; val_chrom_access_recon_loss: 2570146.7833; val_global_loss: 22856962.0000; val_optim_loss: 22856962.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9590; val_auprc_score: 0.9473; val_best_acc_score: 0.9004; val_best_f1_score: 0.9040; train_kl_reg_loss: 69046.6625; train_edge_recon_loss: 591881.7758; train_gene_expr_recon_loss: 19298794.0153; train_masked_gp_l1_reg_loss: 123129.8371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84014.4596; train_chrom_access_recon_loss: 2552350.1450; train_global_loss: 22719217.1603; train_optim_loss: 22719217.1603; val_kl_reg_loss: 69530.2312; val_edge_recon_loss: 594455.0375; val_gene_expr_recon_loss: 19287111.6000; val_masked_gp_l1_reg_loss: 123889.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83633.5859; val_chrom_access_recon_loss: 2537893.5833; val_global_loss: 22696514.5333; val_optim_loss: 22696514.5333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9623; val_auprc_score: 0.9518; val_best_acc_score: 0.9029; val_best_f1_score: 0.9061; train_kl_reg_loss: 68621.4264; train_edge_recon_loss: 589445.7290; train_gene_expr_recon_loss: 19203370.1374; train_masked_gp_l1_reg_loss: 124443.9458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82720.2149; train_chrom_access_recon_loss: 2537305.3454; train_global_loss: 22605906.7023; train_optim_loss: 22605906.7023; val_kl_reg_loss: 68889.7339; val_edge_recon_loss: 594394.8542; val_gene_expr_recon_loss: 19240086.5333; val_masked_gp_l1_reg_loss: 125522.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83244.7344; val_chrom_access_recon_loss: 2536349.1000; val_global_loss: 22648486.2667; val_optim_loss: 22648486.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9644; val_auprc_score: 0.9562; val_best_acc_score: 0.9085; val_best_f1_score: 0.9121; train_kl_reg_loss: 67802.5831; train_edge_recon_loss: 588827.9962; train_gene_expr_recon_loss: 19142153.9084; train_masked_gp_l1_reg_loss: 125889.0706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81898.8229; train_chrom_access_recon_loss: 2525468.4027; train_global_loss: 22532040.8855; train_optim_loss: 22532040.8855; val_kl_reg_loss: 69851.8375; val_edge_recon_loss: 590094.9292; val_gene_expr_recon_loss: 19241188.0000; val_masked_gp_l1_reg_loss: 126950.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81510.1797; val_chrom_access_recon_loss: 2530987.3333; val_global_loss: 22640582.4000; val_optim_loss: 22640582.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9648; val_auprc_score: 0.9567; val_best_acc_score: 0.9097; val_best_f1_score: 0.9133; train_kl_reg_loss: 67293.7651; train_edge_recon_loss: 589400.9399; train_gene_expr_recon_loss: 19055398.5191; train_masked_gp_l1_reg_loss: 127467.0598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81037.0868; train_chrom_access_recon_loss: 2510796.9752; train_global_loss: 22431394.2748; train_optim_loss: 22431394.2748; val_kl_reg_loss: 66695.9396; val_edge_recon_loss: 588081.2125; val_gene_expr_recon_loss: 19149888.2667; val_masked_gp_l1_reg_loss: 128507.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81714.4219; val_chrom_access_recon_loss: 2514334.2333; val_global_loss: 22529221.6000; val_optim_loss: 22529221.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9596; val_auprc_score: 0.9467; val_best_acc_score: 0.9043; val_best_f1_score: 0.9088; train_kl_reg_loss: 66714.5048; train_edge_recon_loss: 589693.2066; train_gene_expr_recon_loss: 18985885.9389; train_masked_gp_l1_reg_loss: 129384.9279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80949.3021; train_chrom_access_recon_loss: 2499225.1622; train_global_loss: 22351852.9618; train_optim_loss: 22351852.9618; val_kl_reg_loss: 65416.4763; val_edge_recon_loss: 592948.0708; val_gene_expr_recon_loss: 19025558.5333; val_masked_gp_l1_reg_loss: 130560.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81505.7500; val_chrom_access_recon_loss: 2486847.4167; val_global_loss: 22382836.4000; val_optim_loss: 22382836.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9624; val_auprc_score: 0.9493; val_best_acc_score: 0.9103; val_best_f1_score: 0.9138; train_kl_reg_loss: 66314.9804; train_edge_recon_loss: 590562.7467; train_gene_expr_recon_loss: 18893660.6718; train_masked_gp_l1_reg_loss: 131339.3927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80589.8128; train_chrom_access_recon_loss: 2483851.3378; train_global_loss: 22246318.7176; train_optim_loss: 22246318.7176; val_kl_reg_loss: 68108.2333; val_edge_recon_loss: 591015.6500; val_gene_expr_recon_loss: 19044846.0000; val_masked_gp_l1_reg_loss: 132584.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80808.2891; val_chrom_access_recon_loss: 2495294.0333; val_global_loss: 22412656.1333; val_optim_loss: 22412656.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9619; val_auprc_score: 0.9509; val_best_acc_score: 0.9078; val_best_f1_score: 0.9113; train_kl_reg_loss: 66660.6629; train_edge_recon_loss: 588439.0864; train_gene_expr_recon_loss: 18810793.0076; train_masked_gp_l1_reg_loss: 133443.5033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80549.4893; train_chrom_access_recon_loss: 2471964.5439; train_global_loss: 22151850.3359; train_optim_loss: 22151850.3359; val_kl_reg_loss: 66498.3997; val_edge_recon_loss: 592818.7625; val_gene_expr_recon_loss: 18998007.8667; val_masked_gp_l1_reg_loss: 134488.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80510.7109; val_chrom_access_recon_loss: 2485808.8333; val_global_loss: 22358132.0000; val_optim_loss: 22358132.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9592; val_auprc_score: 0.9453; val_best_acc_score: 0.9064; val_best_f1_score: 0.9108; train_kl_reg_loss: 66570.2387; train_edge_recon_loss: 587417.2271; train_gene_expr_recon_loss: 18744073.6947; train_masked_gp_l1_reg_loss: 135525.9748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80828.2648; train_chrom_access_recon_loss: 2456776.9370; train_global_loss: 22071192.3206; train_optim_loss: 22071192.3206; val_kl_reg_loss: 68518.2281; val_edge_recon_loss: 592757.4000; val_gene_expr_recon_loss: 18904139.8667; val_masked_gp_l1_reg_loss: 136022.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81071.0703; val_chrom_access_recon_loss: 2499020.1833; val_global_loss: 22281529.8667; val_optim_loss: 22281529.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9630; val_auprc_score: 0.9531; val_best_acc_score: 0.9078; val_best_f1_score: 0.9126; train_kl_reg_loss: 66988.5858; train_edge_recon_loss: 587788.3764; train_gene_expr_recon_loss: 18658957.8321; train_masked_gp_l1_reg_loss: 137234.2284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81073.9235; train_chrom_access_recon_loss: 2443442.0210; train_global_loss: 21975485.0534; train_optim_loss: 21975485.0534; val_kl_reg_loss: 67595.4766; val_edge_recon_loss: 590982.5625; val_gene_expr_recon_loss: 18920099.3333; val_masked_gp_l1_reg_loss: 138190.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81498.8359; val_chrom_access_recon_loss: 2475889.0333; val_global_loss: 22274254.6667; val_optim_loss: 22274254.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9551; val_auprc_score: 0.9399; val_best_acc_score: 0.8973; val_best_f1_score: 0.9022; train_kl_reg_loss: 67722.9510; train_edge_recon_loss: 586643.8946; train_gene_expr_recon_loss: 18597062.7481; train_masked_gp_l1_reg_loss: 138868.2242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81411.6304; train_chrom_access_recon_loss: 2433275.8874; train_global_loss: 21904985.3130; train_optim_loss: 21904985.3130; val_kl_reg_loss: 68139.4531; val_edge_recon_loss: 594948.2583; val_gene_expr_recon_loss: 18809736.9333; val_masked_gp_l1_reg_loss: 139843.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82560.8516; val_chrom_access_recon_loss: 2449651.9833; val_global_loss: 22144880.4000; val_optim_loss: 22144880.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9569; val_auprc_score: 0.9438; val_best_acc_score: 0.9034; val_best_f1_score: 0.9079; train_kl_reg_loss: 68052.0634; train_edge_recon_loss: 588107.5296; train_gene_expr_recon_loss: 18525306.5344; train_masked_gp_l1_reg_loss: 140314.1817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82245.1193; train_chrom_access_recon_loss: 2419459.4103; train_global_loss: 21823484.8092; train_optim_loss: 21823484.8092; val_kl_reg_loss: 69398.7943; val_edge_recon_loss: 595162.2833; val_gene_expr_recon_loss: 18653329.8667; val_masked_gp_l1_reg_loss: 140553.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82823.5938; val_chrom_access_recon_loss: 2425690.8333; val_global_loss: 21966959.8667; val_optim_loss: 21966959.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9606; val_auprc_score: 0.9502; val_best_acc_score: 0.9095; val_best_f1_score: 0.9129; train_kl_reg_loss: 68881.8813; train_edge_recon_loss: 587245.3492; train_gene_expr_recon_loss: 18440836.1374; train_masked_gp_l1_reg_loss: 141227.6419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82740.7235; train_chrom_access_recon_loss: 2403152.5840; train_global_loss: 21724084.5344; train_optim_loss: 21724084.5344; val_kl_reg_loss: 69876.8000; val_edge_recon_loss: 591860.8750; val_gene_expr_recon_loss: 18584928.9333; val_masked_gp_l1_reg_loss: 142154.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83913.2969; val_chrom_access_recon_loss: 2431142.7500; val_global_loss: 21903877.6000; val_optim_loss: 21903877.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9586; val_auprc_score: 0.9453; val_best_acc_score: 0.9089; val_best_f1_score: 0.9134; train_kl_reg_loss: 69224.9543; train_edge_recon_loss: 587486.6584; train_gene_expr_recon_loss: 18367455.9084; train_masked_gp_l1_reg_loss: 142755.4740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83334.4495; train_chrom_access_recon_loss: 2391380.4065; train_global_loss: 21641637.6947; train_optim_loss: 21641637.6947; val_kl_reg_loss: 68810.3714; val_edge_recon_loss: 590100.3167; val_gene_expr_recon_loss: 18524140.6667; val_masked_gp_l1_reg_loss: 143313.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84363.0547; val_chrom_access_recon_loss: 2415644.1333; val_global_loss: 21826373.3333; val_optim_loss: 21826373.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9074; val_auprc_score: 0.9011; val_best_acc_score: 0.8197; val_best_f1_score: 0.8199; train_kl_reg_loss: 80875.6147; train_edge_recon_loss: 774162.8473; train_gene_expr_recon_loss: 18102335.3282; train_masked_gp_l1_reg_loss: 131269.3176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74258.2016; train_chrom_access_recon_loss: 2354430.5782; train_global_loss: 21517331.9389; train_optim_loss: 21517331.9389; val_kl_reg_loss: 52703.2549; val_edge_recon_loss: 785624.9792; val_gene_expr_recon_loss: 17539729.0667; val_masked_gp_l1_reg_loss: 117203.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73935.7656; val_chrom_access_recon_loss: 2333842.3500; val_global_loss: 20903039.8667; val_optim_loss: 20903039.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9190; val_auprc_score: 0.9073; val_best_acc_score: 0.8482; val_best_f1_score: 0.8549; train_kl_reg_loss: 56380.1390; train_edge_recon_loss: 755438.0167; train_gene_expr_recon_loss: 17434437.4809; train_masked_gp_l1_reg_loss: 110554.1928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73707.0292; train_chrom_access_recon_loss: 2325250.8874; train_global_loss: 20755767.6794; train_optim_loss: 20755767.6794; val_kl_reg_loss: 36089.7685; val_edge_recon_loss: 716739.9375; val_gene_expr_recon_loss: 17464465.7333; val_masked_gp_l1_reg_loss: 106485.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73788.4688; val_chrom_access_recon_loss: 2314738.5667; val_global_loss: 20712307.7333; val_optim_loss: 20712307.7333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8842; val_auprc_score: 0.8730; val_best_acc_score: 0.8071; val_best_f1_score: 0.8188; train_kl_reg_loss: 62001.9218; train_edge_recon_loss: 706063.9680; train_gene_expr_recon_loss: 17440308.7405; train_masked_gp_l1_reg_loss: 105124.0970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74051.9572; train_chrom_access_recon_loss: 2325182.1698; train_global_loss: 20712732.8550; train_optim_loss: 20712732.8550; val_kl_reg_loss: 49141.9042; val_edge_recon_loss: 687006.5917; val_gene_expr_recon_loss: 17341512.0000; val_masked_gp_l1_reg_loss: 103563.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73766.8984; val_chrom_access_recon_loss: 2310487.3000; val_global_loss: 20565477.7333; val_optim_loss: 20565477.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8933; val_auprc_score: 0.8800; val_best_acc_score: 0.8180; val_best_f1_score: 0.8319; train_kl_reg_loss: 54645.1623; train_edge_recon_loss: 670221.0091; train_gene_expr_recon_loss: 17306495.2443; train_masked_gp_l1_reg_loss: 102390.2801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73011.0258; train_chrom_access_recon_loss: 2313758.0534; train_global_loss: 20520520.5954; train_optim_loss: 20520520.5954; val_kl_reg_loss: 44369.9685; val_edge_recon_loss: 660822.0583; val_gene_expr_recon_loss: 17355576.9333; val_masked_gp_l1_reg_loss: 101068.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72248.3750; val_chrom_access_recon_loss: 2302379.2167; val_global_loss: 20536464.2667; val_optim_loss: 20536464.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8877; val_auprc_score: 0.8726; val_best_acc_score: 0.8085; val_best_f1_score: 0.8207; train_kl_reg_loss: 20408767272.8656; train_edge_recon_loss: 660944.8483; train_gene_expr_recon_loss: 17362400.3206; train_masked_gp_l1_reg_loss: 99588.3270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74425.9546; train_chrom_access_recon_loss: 2318949.9027; train_global_loss: 20429284930.2748; train_optim_loss: 20429284930.2748; val_kl_reg_loss: 56514.3927; val_edge_recon_loss: 670431.1458; val_gene_expr_recon_loss: 17395016.0000; val_masked_gp_l1_reg_loss: 97781.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78153.2969; val_chrom_access_recon_loss: 2307928.2167; val_global_loss: 20605825.8667; val_optim_loss: 20605825.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8756; val_auprc_score: 0.8628; val_best_acc_score: 0.7949; val_best_f1_score: 0.8093; train_kl_reg_loss: 70397.4448; train_edge_recon_loss: 649826.3593; train_gene_expr_recon_loss: 17246618.9313; train_masked_gp_l1_reg_loss: 96468.1779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76215.9720; train_chrom_access_recon_loss: 2301339.9656; train_global_loss: 20440866.7939; train_optim_loss: 20440866.7939; val_kl_reg_loss: 60158.4789; val_edge_recon_loss: 653349.9250; val_gene_expr_recon_loss: 17332082.6000; val_masked_gp_l1_reg_loss: 95415.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75293.7031; val_chrom_access_recon_loss: 2301134.8917; val_global_loss: 20517436.0000; val_optim_loss: 20517436.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8915; val_auprc_score: 0.8759; val_best_acc_score: 0.8126; val_best_f1_score: 0.8245; train_kl_reg_loss: 64082.4167; train_edge_recon_loss: 633598.8774; train_gene_expr_recon_loss: 17232380.7099; train_masked_gp_l1_reg_loss: 94771.6690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74405.9033; train_chrom_access_recon_loss: 2304588.7586; train_global_loss: 20403828.3969; train_optim_loss: 20403828.3969; val_kl_reg_loss: 57800.8005; val_edge_recon_loss: 628323.4000; val_gene_expr_recon_loss: 17268910.3333; val_masked_gp_l1_reg_loss: 94202.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73399.7812; val_chrom_access_recon_loss: 2296456.9000; val_global_loss: 20419093.3333; val_optim_loss: 20419093.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8474; val_auprc_score: 0.8504; val_best_acc_score: 0.7617; val_best_f1_score: 0.7706; train_kl_reg_loss: 536545218850015870976.0000; train_edge_recon_loss: 663672.4876; train_gene_expr_recon_loss: 17719460.2214; train_masked_gp_l1_reg_loss: 92734.9686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77915.1964; train_chrom_access_recon_loss: 2332511.3378; train_global_loss: 536545218850036187136.0000; train_optim_loss: 536545218850036187136.0000; val_kl_reg_loss: 106897.3932; val_edge_recon_loss: 673746.5708; val_gene_expr_recon_loss: 17315547.0667; val_masked_gp_l1_reg_loss: 91730.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82424.9844; val_chrom_access_recon_loss: 2297214.7833; val_global_loss: 20567560.2667; val_optim_loss: 20567560.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8671; val_auprc_score: 0.8600; val_best_acc_score: 0.7781; val_best_f1_score: 0.7965; train_kl_reg_loss: 94135.5231; train_edge_recon_loss: 669156.7013; train_gene_expr_recon_loss: 17248111.4122; train_masked_gp_l1_reg_loss: 89757.1057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82112.4457; train_chrom_access_recon_loss: 2300399.8321; train_global_loss: 20483672.9008; train_optim_loss: 20483672.9008; val_kl_reg_loss: 487532.1643; val_edge_recon_loss: 653866.2792; val_gene_expr_recon_loss: 17357576.5333; val_masked_gp_l1_reg_loss: 88357.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80384.5703; val_chrom_access_recon_loss: 2308851.2000; val_global_loss: 20976568.4000; val_optim_loss: 20976568.4000
