[True]
Run timestamp: 09102023_213016_43.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_43']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6687; val_auprc_score: 0.6423; val_best_acc_score: 0.5035; val_best_f1_score: 0.6681; train_kl_reg_loss: 47939.5190; train_edge_recon_loss: 3501640.1629; train_gene_expr_recon_loss: 13916662.6970; train_masked_gp_l1_reg_loss: 45102.2162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5462053.2689; train_chrom_access_recon_loss: 995879.8561; train_global_loss: 23969277.7273; train_optim_loss: 23969277.7273; val_kl_reg_loss: 124183.6680; val_edge_recon_loss: 4065030.2188; val_gene_expr_recon_loss: 13071031.0000; val_masked_gp_l1_reg_loss: 51070.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2459459.0000; val_chrom_access_recon_loss: 973508.5859; val_global_loss: 20744282.2500; val_optim_loss: 20744282.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6940; val_auprc_score: 0.6697; val_best_acc_score: 0.6282; val_best_f1_score: 0.6945; train_kl_reg_loss: 84412.0759; train_edge_recon_loss: 3511538.0227; train_gene_expr_recon_loss: 12897597.6818; train_masked_gp_l1_reg_loss: 53358.1039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1115255.5398; train_chrom_access_recon_loss: 950731.9593; train_global_loss: 18612893.4242; train_optim_loss: 18612893.4242; val_kl_reg_loss: 73679.4424; val_edge_recon_loss: 4054424.2188; val_gene_expr_recon_loss: 12864818.0000; val_masked_gp_l1_reg_loss: 55598.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 441191.5312; val_chrom_access_recon_loss: 949812.2891; val_global_loss: 18439523.7500; val_optim_loss: 18439523.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7532; val_auprc_score: 0.7220; val_best_acc_score: 0.6808; val_best_f1_score: 0.7302; train_kl_reg_loss: 76414.6500; train_edge_recon_loss: 3499930.9886; train_gene_expr_recon_loss: 12746722.6212; train_masked_gp_l1_reg_loss: 58954.8816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 303289.8757; train_chrom_access_recon_loss: 940932.0047; train_global_loss: 17626245.0152; train_optim_loss: 17626245.0152; val_kl_reg_loss: 69852.3242; val_edge_recon_loss: 3939460.0312; val_gene_expr_recon_loss: 12807553.3750; val_masked_gp_l1_reg_loss: 60622.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216692.3906; val_chrom_access_recon_loss: 941544.0938; val_global_loss: 18035724.7500; val_optim_loss: 18035724.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7926; val_auprc_score: 0.7820; val_best_acc_score: 0.7007; val_best_f1_score: 0.7462; train_kl_reg_loss: 61967.9637; train_edge_recon_loss: 3297934.6667; train_gene_expr_recon_loss: 12688447.4242; train_masked_gp_l1_reg_loss: 62836.5542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181294.8558; train_chrom_access_recon_loss: 938033.4138; train_global_loss: 17230514.9242; train_optim_loss: 17230514.9242; val_kl_reg_loss: 83884.3672; val_edge_recon_loss: 3206200.3438; val_gene_expr_recon_loss: 12723574.7500; val_masked_gp_l1_reg_loss: 65907.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155601.3594; val_chrom_access_recon_loss: 944274.7422; val_global_loss: 17179442.8750; val_optim_loss: 17179442.8750
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8227; val_auprc_score: 0.8095; val_best_acc_score: 0.7356; val_best_f1_score: 0.7699; train_kl_reg_loss: 89221.5368; train_edge_recon_loss: 3089179.8636; train_gene_expr_recon_loss: 12619372.8788; train_masked_gp_l1_reg_loss: 67616.4097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140755.1925; train_chrom_access_recon_loss: 931922.7311; train_global_loss: 16938068.5606; train_optim_loss: 16938068.5606; val_kl_reg_loss: 88727.3760; val_edge_recon_loss: 3113881.6562; val_gene_expr_recon_loss: 12574714.5000; val_masked_gp_l1_reg_loss: 69194.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129555.1484; val_chrom_access_recon_loss: 933041.7656; val_global_loss: 16909115.5000; val_optim_loss: 16909115.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8403; val_auprc_score: 0.8151; val_best_acc_score: 0.7496; val_best_f1_score: 0.7857; train_kl_reg_loss: 93478.8501; train_edge_recon_loss: 2991059.7879; train_gene_expr_recon_loss: 12528171.4848; train_masked_gp_l1_reg_loss: 70688.5140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124368.4278; train_chrom_access_recon_loss: 927666.7055; train_global_loss: 16735433.9091; train_optim_loss: 16735433.9091; val_kl_reg_loss: 91845.0039; val_edge_recon_loss: 2991189.8750; val_gene_expr_recon_loss: 12539006.7500; val_masked_gp_l1_reg_loss: 72387.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121450.3047; val_chrom_access_recon_loss: 940172.2422; val_global_loss: 16756052.1250; val_optim_loss: 16756052.1250
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8553; val_auprc_score: 0.8174; val_best_acc_score: 0.7837; val_best_f1_score: 0.8087; train_kl_reg_loss: 91867.6420; train_edge_recon_loss: 2901601.6667; train_gene_expr_recon_loss: 12427573.7121; train_masked_gp_l1_reg_loss: 73770.8881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117166.9774; train_chrom_access_recon_loss: 920531.1809; train_global_loss: 16532512.0152; train_optim_loss: 16532512.0152; val_kl_reg_loss: 88294.5527; val_edge_recon_loss: 2951618.9688; val_gene_expr_recon_loss: 12434859.3750; val_masked_gp_l1_reg_loss: 75322.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113044.0938; val_chrom_access_recon_loss: 933333.8828; val_global_loss: 16596472.6250; val_optim_loss: 16596472.6250
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8763; val_auprc_score: 0.8422; val_best_acc_score: 0.8095; val_best_f1_score: 0.8293; train_kl_reg_loss: 93434.9226; train_edge_recon_loss: 2846581.3561; train_gene_expr_recon_loss: 12369838.0303; train_masked_gp_l1_reg_loss: 76637.4582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111149.7660; train_chrom_access_recon_loss: 917733.3693; train_global_loss: 16415374.8636; train_optim_loss: 16415374.8636; val_kl_reg_loss: 96110.9434; val_edge_recon_loss: 2852296.5000; val_gene_expr_recon_loss: 12478364.2500; val_masked_gp_l1_reg_loss: 78029.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109927.7734; val_chrom_access_recon_loss: 933374.4219; val_global_loss: 16548102.7500; val_optim_loss: 16548102.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8847; val_auprc_score: 0.8364; val_best_acc_score: 0.8302; val_best_f1_score: 0.8437; train_kl_reg_loss: 92642.6676; train_edge_recon_loss: 2829330.1856; train_gene_expr_recon_loss: 12315186.3788; train_masked_gp_l1_reg_loss: 78931.8329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108951.3480; train_chrom_access_recon_loss: 914094.5597; train_global_loss: 16339136.9242; train_optim_loss: 16339136.9242; val_kl_reg_loss: 88803.9434; val_edge_recon_loss: 2838397.8750; val_gene_expr_recon_loss: 12388818.1250; val_masked_gp_l1_reg_loss: 80160.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107472.1641; val_chrom_access_recon_loss: 927148.1953; val_global_loss: 16430800.1250; val_optim_loss: 16430800.1250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8841; val_auprc_score: 0.8444; val_best_acc_score: 0.8243; val_best_f1_score: 0.8405; train_kl_reg_loss: 93369.1102; train_edge_recon_loss: 2803395.1818; train_gene_expr_recon_loss: 12241791.1212; train_masked_gp_l1_reg_loss: 81118.6942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105253.9001; train_chrom_access_recon_loss: 909496.9280; train_global_loss: 16234424.9545; train_optim_loss: 16234424.9545; val_kl_reg_loss: 92521.3066; val_edge_recon_loss: 2848006.6250; val_gene_expr_recon_loss: 12286378.1250; val_masked_gp_l1_reg_loss: 82000.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103945.7500; val_chrom_access_recon_loss: 923210.4219; val_global_loss: 16336062.3750; val_optim_loss: 16336062.3750
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8995; val_auprc_score: 0.8703; val_best_acc_score: 0.8297; val_best_f1_score: 0.8442; train_kl_reg_loss: 90648.5741; train_edge_recon_loss: 2806354.7045; train_gene_expr_recon_loss: 12204337.7273; train_masked_gp_l1_reg_loss: 82778.2937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101827.9097; train_chrom_access_recon_loss: 908156.0900; train_global_loss: 16194103.3485; train_optim_loss: 16194103.3485; val_kl_reg_loss: 89461.5996; val_edge_recon_loss: 2836020.2812; val_gene_expr_recon_loss: 12137926.2500; val_masked_gp_l1_reg_loss: 83709.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100492.6562; val_chrom_access_recon_loss: 922975.7188; val_global_loss: 16170585.8750; val_optim_loss: 16170585.8750
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8977; val_auprc_score: 0.8653; val_best_acc_score: 0.8345; val_best_f1_score: 0.8454; train_kl_reg_loss: 92463.3205; train_edge_recon_loss: 2775773.8409; train_gene_expr_recon_loss: 12155171.0000; train_masked_gp_l1_reg_loss: 84399.6925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98574.2203; train_chrom_access_recon_loss: 903761.3456; train_global_loss: 16110143.3788; train_optim_loss: 16110143.3788; val_kl_reg_loss: 91502.7246; val_edge_recon_loss: 2844491.0625; val_gene_expr_recon_loss: 12170612.3750; val_masked_gp_l1_reg_loss: 85187.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97956.7109; val_chrom_access_recon_loss: 907217.7109; val_global_loss: 16196967.7500; val_optim_loss: 16196967.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9076; val_auprc_score: 0.8711; val_best_acc_score: 0.8487; val_best_f1_score: 0.8590; train_kl_reg_loss: 89579.8430; train_edge_recon_loss: 2773376.3674; train_gene_expr_recon_loss: 12116973.0758; train_masked_gp_l1_reg_loss: 85829.4328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95942.6146; train_chrom_access_recon_loss: 901147.1098; train_global_loss: 16062848.4545; train_optim_loss: 16062848.4545; val_kl_reg_loss: 87724.1973; val_edge_recon_loss: 2807782.5938; val_gene_expr_recon_loss: 12161582.5000; val_masked_gp_l1_reg_loss: 86381.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94756.0859; val_chrom_access_recon_loss: 908754.7344; val_global_loss: 16146981.7500; val_optim_loss: 16146981.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9157; val_auprc_score: 0.8858; val_best_acc_score: 0.8544; val_best_f1_score: 0.8664; train_kl_reg_loss: 88343.3812; train_edge_recon_loss: 2772573.2614; train_gene_expr_recon_loss: 12075686.8030; train_masked_gp_l1_reg_loss: 87010.7317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93278.1315; train_chrom_access_recon_loss: 898611.1080; train_global_loss: 16015503.4394; train_optim_loss: 16015503.4394; val_kl_reg_loss: 91619.1074; val_edge_recon_loss: 2784215.5625; val_gene_expr_recon_loss: 12171613.0000; val_masked_gp_l1_reg_loss: 87644.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92170.1797; val_chrom_access_recon_loss: 917090.8203; val_global_loss: 16144352.3750; val_optim_loss: 16144352.3750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9172; val_auprc_score: 0.8856; val_best_acc_score: 0.8571; val_best_f1_score: 0.8673; train_kl_reg_loss: 89449.7219; train_edge_recon_loss: 2768796.7955; train_gene_expr_recon_loss: 12043150.1667; train_masked_gp_l1_reg_loss: 87973.1294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91111.9502; train_chrom_access_recon_loss: 895754.4072; train_global_loss: 15976236.1667; train_optim_loss: 15976236.1667; val_kl_reg_loss: 89087.1172; val_edge_recon_loss: 2801055.4062; val_gene_expr_recon_loss: 12039962.0000; val_masked_gp_l1_reg_loss: 88455.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90996.6484; val_chrom_access_recon_loss: 902836.8906; val_global_loss: 16012394.3750; val_optim_loss: 16012394.3750
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9181; val_auprc_score: 0.8863; val_best_acc_score: 0.8614; val_best_f1_score: 0.8710; train_kl_reg_loss: 90461.5848; train_edge_recon_loss: 2745441.2121; train_gene_expr_recon_loss: 12005441.9545; train_masked_gp_l1_reg_loss: 88693.9903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89755.8383; train_chrom_access_recon_loss: 892492.7386; train_global_loss: 15912287.3485; train_optim_loss: 15912287.3485; val_kl_reg_loss: 87803.7471; val_edge_recon_loss: 2760366.6875; val_gene_expr_recon_loss: 12052202.1250; val_masked_gp_l1_reg_loss: 88895.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89227.9375; val_chrom_access_recon_loss: 899131.2422; val_global_loss: 15977626.6250; val_optim_loss: 15977626.6250
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9212; val_auprc_score: 0.8895; val_best_acc_score: 0.8592; val_best_f1_score: 0.8677; train_kl_reg_loss: 87737.8791; train_edge_recon_loss: 2749316.4129; train_gene_expr_recon_loss: 11978175.3788; train_masked_gp_l1_reg_loss: 89271.3782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88761.4671; train_chrom_access_recon_loss: 890222.9877; train_global_loss: 15883485.4394; train_optim_loss: 15883485.4394; val_kl_reg_loss: 89919.4580; val_edge_recon_loss: 2777715.0625; val_gene_expr_recon_loss: 12051554.3750; val_masked_gp_l1_reg_loss: 89538.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88414.4453; val_chrom_access_recon_loss: 891091.0781; val_global_loss: 15988233.1250; val_optim_loss: 15988233.1250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9247; val_auprc_score: 0.9000; val_best_acc_score: 0.8606; val_best_f1_score: 0.8695; train_kl_reg_loss: 87005.8745; train_edge_recon_loss: 2749948.7348; train_gene_expr_recon_loss: 11934309.9242; train_masked_gp_l1_reg_loss: 89786.3074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87881.2370; train_chrom_access_recon_loss: 887131.4621; train_global_loss: 15836063.5455; train_optim_loss: 15836063.5455; val_kl_reg_loss: 88349.5586; val_edge_recon_loss: 2785303.4375; val_gene_expr_recon_loss: 12016788.1250; val_masked_gp_l1_reg_loss: 90089.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87417.3828; val_chrom_access_recon_loss: 911283.7109; val_global_loss: 15979230.8750; val_optim_loss: 15979230.8750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9318; val_auprc_score: 0.9108; val_best_acc_score: 0.8705; val_best_f1_score: 0.8786; train_kl_reg_loss: 87211.5678; train_edge_recon_loss: 2738108.8220; train_gene_expr_recon_loss: 11902179.6970; train_masked_gp_l1_reg_loss: 90328.5353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87253.8436; train_chrom_access_recon_loss: 885046.1780; train_global_loss: 15790128.5303; train_optim_loss: 15790128.5303; val_kl_reg_loss: 86920.6914; val_edge_recon_loss: 2737732.3125; val_gene_expr_recon_loss: 11861792.0000; val_masked_gp_l1_reg_loss: 90680.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87516.5625; val_chrom_access_recon_loss: 892452.8906; val_global_loss: 15757096.0000; val_optim_loss: 15757096.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9264; val_auprc_score: 0.8964; val_best_acc_score: 0.8702; val_best_f1_score: 0.8766; train_kl_reg_loss: 85269.4732; train_edge_recon_loss: 2740170.5038; train_gene_expr_recon_loss: 11873732.9697; train_masked_gp_l1_reg_loss: 90827.5961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87314.5347; train_chrom_access_recon_loss: 882544.0455; train_global_loss: 15759859.1061; train_optim_loss: 15759859.1061; val_kl_reg_loss: 86078.1396; val_edge_recon_loss: 2753723.4688; val_gene_expr_recon_loss: 11923389.2500; val_masked_gp_l1_reg_loss: 90988.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87161.1328; val_chrom_access_recon_loss: 896268.0000; val_global_loss: 15837607.8750; val_optim_loss: 15837607.8750
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9308; val_auprc_score: 0.9006; val_best_acc_score: 0.8772; val_best_f1_score: 0.8825; train_kl_reg_loss: 85019.9521; train_edge_recon_loss: 2736795.5189; train_gene_expr_recon_loss: 11839253.8485; train_masked_gp_l1_reg_loss: 91118.6870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87302.6181; train_chrom_access_recon_loss: 880799.5549; train_global_loss: 15720290.1818; train_optim_loss: 15720290.1818; val_kl_reg_loss: 86540.5098; val_edge_recon_loss: 2765494.2812; val_gene_expr_recon_loss: 11937407.0000; val_masked_gp_l1_reg_loss: 91277.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87383.6641; val_chrom_access_recon_loss: 896420.5547; val_global_loss: 15864523.3750; val_optim_loss: 15864523.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9296; val_auprc_score: 0.9057; val_best_acc_score: 0.8702; val_best_f1_score: 0.8811; train_kl_reg_loss: 84490.3285; train_edge_recon_loss: 2738725.9735; train_gene_expr_recon_loss: 11812256.6212; train_masked_gp_l1_reg_loss: 91436.8165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87574.9613; train_chrom_access_recon_loss: 878603.2491; train_global_loss: 15693087.8788; train_optim_loss: 15693087.8788; val_kl_reg_loss: 84669.0225; val_edge_recon_loss: 2762541.2500; val_gene_expr_recon_loss: 11892733.2500; val_masked_gp_l1_reg_loss: 91626.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88638.0156; val_chrom_access_recon_loss: 889900.3359; val_global_loss: 15810108.0000; val_optim_loss: 15810108.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9388; val_auprc_score: 0.9137; val_best_acc_score: 0.8901; val_best_f1_score: 0.8952; train_kl_reg_loss: 83755.3951; train_edge_recon_loss: 2734304.5833; train_gene_expr_recon_loss: 11791120.7273; train_masked_gp_l1_reg_loss: 91726.7597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88769.9167; train_chrom_access_recon_loss: 876768.0218; train_global_loss: 15666445.5152; train_optim_loss: 15666445.5152; val_kl_reg_loss: 82755.2217; val_edge_recon_loss: 2745502.7188; val_gene_expr_recon_loss: 11885514.2500; val_masked_gp_l1_reg_loss: 91865.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89303.0703; val_chrom_access_recon_loss: 900448.3828; val_global_loss: 15795388.6250; val_optim_loss: 15795388.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9339; val_auprc_score: 0.9076; val_best_acc_score: 0.8778; val_best_f1_score: 0.8845; train_kl_reg_loss: 83662.0889; train_edge_recon_loss: 2715982.4470; train_gene_expr_recon_loss: 11769298.6667; train_masked_gp_l1_reg_loss: 90843.0228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69363.3289; train_chrom_access_recon_loss: 875437.4697; train_global_loss: 15604587.0606; train_optim_loss: 15604587.0606; val_kl_reg_loss: 83402.6729; val_edge_recon_loss: 2775240.0625; val_gene_expr_recon_loss: 11830532.3750; val_masked_gp_l1_reg_loss: 90375.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65068.2305; val_chrom_access_recon_loss: 892912.2812; val_global_loss: 15737531.3750; val_optim_loss: 15737531.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9364; val_auprc_score: 0.9077; val_best_acc_score: 0.8788; val_best_f1_score: 0.8850; train_kl_reg_loss: 84223.5781; train_edge_recon_loss: 2730004.2424; train_gene_expr_recon_loss: 11771697.3939; train_masked_gp_l1_reg_loss: 90290.3202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64754.7944; train_chrom_access_recon_loss: 875382.0994; train_global_loss: 15616352.4394; train_optim_loss: 15616352.4394; val_kl_reg_loss: 85017.7373; val_edge_recon_loss: 2762590.1875; val_gene_expr_recon_loss: 11833774.7500; val_masked_gp_l1_reg_loss: 90243.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64541.5664; val_chrom_access_recon_loss: 901577.7969; val_global_loss: 15737745.6250; val_optim_loss: 15737745.6250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9382; val_auprc_score: 0.9113; val_best_acc_score: 0.8769; val_best_f1_score: 0.8857; train_kl_reg_loss: 85419.8961; train_edge_recon_loss: 2717868.6023; train_gene_expr_recon_loss: 11757370.4697; train_masked_gp_l1_reg_loss: 90224.0328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64382.8120; train_chrom_access_recon_loss: 874399.4441; train_global_loss: 15589665.3788; train_optim_loss: 15589665.3788; val_kl_reg_loss: 85161.2412; val_edge_recon_loss: 2747202.2500; val_gene_expr_recon_loss: 11880547.3750; val_masked_gp_l1_reg_loss: 90202.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64142.2344; val_chrom_access_recon_loss: 883558.1875; val_global_loss: 15750814.0000; val_optim_loss: 15750814.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9312; val_auprc_score: 0.9015; val_best_acc_score: 0.8799; val_best_f1_score: 0.8882; train_kl_reg_loss: 84907.4268; train_edge_recon_loss: 2719108.1098; train_gene_expr_recon_loss: 11762705.1364; train_masked_gp_l1_reg_loss: 90203.1967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64021.9863; train_chrom_access_recon_loss: 874720.6212; train_global_loss: 15595666.5606; train_optim_loss: 15595666.5606; val_kl_reg_loss: 84624.4170; val_edge_recon_loss: 2764314.8750; val_gene_expr_recon_loss: 11870832.6250; val_masked_gp_l1_reg_loss: 90208.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63923.1484; val_chrom_access_recon_loss: 887073.6328; val_global_loss: 15760976.6250; val_optim_loss: 15760976.6250
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9390; val_auprc_score: 0.9134; val_best_acc_score: 0.8829; val_best_f1_score: 0.8893; train_kl_reg_loss: 85022.2891; train_edge_recon_loss: 2719042.9962; train_gene_expr_recon_loss: 11758300.0000; train_masked_gp_l1_reg_loss: 90204.7661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63854.7319; train_chrom_access_recon_loss: 874015.6913; train_global_loss: 15590440.5303; train_optim_loss: 15590440.5303; val_kl_reg_loss: 85031.8018; val_edge_recon_loss: 2760304.4062; val_gene_expr_recon_loss: 11742138.5000; val_masked_gp_l1_reg_loss: 90212.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63772.8320; val_chrom_access_recon_loss: 883866.9453; val_global_loss: 15625326.6250; val_optim_loss: 15625326.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9432; val_auprc_score: 0.9214; val_best_acc_score: 0.8920; val_best_f1_score: 0.8982; train_kl_reg_loss: 84572.0018; train_edge_recon_loss: 2719684.2008; train_gene_expr_recon_loss: 11753253.3939; train_masked_gp_l1_reg_loss: 90208.0244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63679.5896; train_chrom_access_recon_loss: 873482.6903; train_global_loss: 15584879.8030; train_optim_loss: 15584879.8030; val_kl_reg_loss: 84797.6660; val_edge_recon_loss: 2710008.5312; val_gene_expr_recon_loss: 11748195.5000; val_masked_gp_l1_reg_loss: 90228.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63653.2227; val_chrom_access_recon_loss: 884324.2266; val_global_loss: 15581208.1250; val_optim_loss: 15581208.1250
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9407; val_auprc_score: 0.9129; val_best_acc_score: 0.8858; val_best_f1_score: 0.8912; train_kl_reg_loss: 84760.0752; train_edge_recon_loss: 2716875.4659; train_gene_expr_recon_loss: 11749891.9697; train_masked_gp_l1_reg_loss: 90245.2776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63533.6368; train_chrom_access_recon_loss: 873838.1117; train_global_loss: 15579144.5758; train_optim_loss: 15579144.5758; val_kl_reg_loss: 84453.7393; val_edge_recon_loss: 2740446.6562; val_gene_expr_recon_loss: 11855986.0000; val_masked_gp_l1_reg_loss: 90251.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63476.8984; val_chrom_access_recon_loss: 884613.1406; val_global_loss: 15719227.2500; val_optim_loss: 15719227.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9486; val_auprc_score: 0.9288; val_best_acc_score: 0.8925; val_best_f1_score: 0.8957; train_kl_reg_loss: 84145.3726; train_edge_recon_loss: 2718960.7424; train_gene_expr_recon_loss: 11738600.8939; train_masked_gp_l1_reg_loss: 90261.3626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63463.8952; train_chrom_access_recon_loss: 872356.1487; train_global_loss: 15567788.4848; train_optim_loss: 15567788.4848; val_kl_reg_loss: 84516.2998; val_edge_recon_loss: 2721095.0625; val_gene_expr_recon_loss: 11876336.3750; val_masked_gp_l1_reg_loss: 90272.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63386.2578; val_chrom_access_recon_loss: 898475.3281; val_global_loss: 15734080.8750; val_optim_loss: 15734080.8750
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9413; val_auprc_score: 0.9158; val_best_acc_score: 0.8882; val_best_f1_score: 0.8949; train_kl_reg_loss: 84299.5947; train_edge_recon_loss: 2716800.9659; train_gene_expr_recon_loss: 11750560.2879; train_masked_gp_l1_reg_loss: 90281.9582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63332.9622; train_chrom_access_recon_loss: 873274.9792; train_global_loss: 15578550.7576; train_optim_loss: 15578550.7576; val_kl_reg_loss: 84554.2178; val_edge_recon_loss: 2756456.2812; val_gene_expr_recon_loss: 11808992.2500; val_masked_gp_l1_reg_loss: 90285.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63270.5977; val_chrom_access_recon_loss: 890099.2891; val_global_loss: 15693659.0000; val_optim_loss: 15693659.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9405; val_auprc_score: 0.9165; val_best_acc_score: 0.8861; val_best_f1_score: 0.8906; train_kl_reg_loss: 84362.0624; train_edge_recon_loss: 2716613.5720; train_gene_expr_recon_loss: 11743596.7424; train_masked_gp_l1_reg_loss: 90305.5423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63254.3929; train_chrom_access_recon_loss: 873012.8210; train_global_loss: 15571145.0758; train_optim_loss: 15571145.0758; val_kl_reg_loss: 84719.5820; val_edge_recon_loss: 2778210.5312; val_gene_expr_recon_loss: 11737273.7500; val_masked_gp_l1_reg_loss: 90317.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63150.3906; val_chrom_access_recon_loss: 878179.5469; val_global_loss: 15631851.2500; val_optim_loss: 15631851.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9382; val_auprc_score: 0.9114; val_best_acc_score: 0.8869; val_best_f1_score: 0.8911; train_kl_reg_loss: 84538.5792; train_edge_recon_loss: 2716105.2538; train_gene_expr_recon_loss: 11747235.2273; train_masked_gp_l1_reg_loss: 90217.6302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61168.7186; train_chrom_access_recon_loss: 872504.8750; train_global_loss: 15571770.2576; train_optim_loss: 15571770.2576; val_kl_reg_loss: 84987.5762; val_edge_recon_loss: 2733954.0625; val_gene_expr_recon_loss: 11846017.2500; val_masked_gp_l1_reg_loss: 90168.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60755.8281; val_chrom_access_recon_loss: 885952.4844; val_global_loss: 15701835.3750; val_optim_loss: 15701835.3750
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9391; val_auprc_score: 0.9168; val_best_acc_score: 0.8818; val_best_f1_score: 0.8871; train_kl_reg_loss: 84643.2829; train_edge_recon_loss: 2706294.7689; train_gene_expr_recon_loss: 11737357.5606; train_masked_gp_l1_reg_loss: 90154.1496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60713.0378; train_chrom_access_recon_loss: 872986.9328; train_global_loss: 15552149.7121; train_optim_loss: 15552149.7121; val_kl_reg_loss: 85393.6504; val_edge_recon_loss: 2768887.1875; val_gene_expr_recon_loss: 11802080.6250; val_masked_gp_l1_reg_loss: 90144.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60685.9375; val_chrom_access_recon_loss: 884928.4609; val_global_loss: 15692120.8750; val_optim_loss: 15692120.8750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9368; val_auprc_score: 0.9152; val_best_acc_score: 0.8821; val_best_f1_score: 0.8897; train_kl_reg_loss: 84615.9098; train_edge_recon_loss: 2717196.1742; train_gene_expr_recon_loss: 11738706.9697; train_masked_gp_l1_reg_loss: 90141.6720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60666.2108; train_chrom_access_recon_loss: 872918.2775; train_global_loss: 15564245.1970; train_optim_loss: 15564245.1970; val_kl_reg_loss: 84865.3525; val_edge_recon_loss: 2754799.6562; val_gene_expr_recon_loss: 11938700.8750; val_masked_gp_l1_reg_loss: 90138.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60653.4570; val_chrom_access_recon_loss: 888520.1094; val_global_loss: 15817678.0000; val_optim_loss: 15817678.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9398; val_auprc_score: 0.9132; val_best_acc_score: 0.8858; val_best_f1_score: 0.8917; train_kl_reg_loss: 84581.8175; train_edge_recon_loss: 2720461.8220; train_gene_expr_recon_loss: 11745793.9848; train_masked_gp_l1_reg_loss: 90136.7586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60637.5809; train_chrom_access_recon_loss: 872776.6070; train_global_loss: 15574388.5758; train_optim_loss: 15574388.5758; val_kl_reg_loss: 85159.5000; val_edge_recon_loss: 2739024.6562; val_gene_expr_recon_loss: 11820626.0000; val_masked_gp_l1_reg_loss: 90134.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60621.7578; val_chrom_access_recon_loss: 884522.0938; val_global_loss: 15680088.2500; val_optim_loss: 15680088.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 10 min 37 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.9401
val AUPRC score: 0.9140
val best accuracy score: 0.8839
val best F1 score: 0.8911
val target rna MSE score: 1.2821
val source rna MSE score: 1.1241
val target atac MSE score: 0.4817
val source atac MSE score: 0.2039
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
