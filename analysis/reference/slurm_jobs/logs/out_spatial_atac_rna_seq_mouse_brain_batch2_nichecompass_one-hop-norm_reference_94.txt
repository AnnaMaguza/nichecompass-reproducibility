[True]
Run timestamp: 10102023_010434_94.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_94']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7573; val_auprc_score: 0.7833; val_best_acc_score: 0.5365; val_best_f1_score: 0.6808; train_kl_reg_loss: 54925.7351; train_edge_recon_loss: 3513008.4198; train_gene_expr_recon_loss: 13441336.5878; train_masked_gp_l1_reg_loss: 126421.9756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2764640.0279; train_chrom_access_recon_loss: 6753775.9466; train_global_loss: 26654108.5954; train_optim_loss: 26654108.5954; val_kl_reg_loss: 90429.6083; val_edge_recon_loss: 4062943.3000; val_gene_expr_recon_loss: 12526097.6667; val_masked_gp_l1_reg_loss: 110289.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 395433.8125; val_chrom_access_recon_loss: 6507274.1000; val_global_loss: 23692468.4000; val_optim_loss: 23692468.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8152; val_auprc_score: 0.8328; val_best_acc_score: 0.7289; val_best_f1_score: 0.7271; train_kl_reg_loss: 81256.4380; train_edge_recon_loss: 3500347.8836; train_gene_expr_recon_loss: 12610143.9847; train_masked_gp_l1_reg_loss: 106917.6496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217385.0587; train_chrom_access_recon_loss: 6494873.4542; train_global_loss: 23010924.5344; train_optim_loss: 23010924.5344; val_kl_reg_loss: 78723.5422; val_edge_recon_loss: 4007841.2667; val_gene_expr_recon_loss: 12341857.4667; val_masked_gp_l1_reg_loss: 106313.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141421.3281; val_chrom_access_recon_loss: 6430250.2333; val_global_loss: 23106407.8667; val_optim_loss: 23106407.8667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8872; val_auprc_score: 0.8824; val_best_acc_score: 0.7891; val_best_f1_score: 0.8038; train_kl_reg_loss: 74129.5971; train_edge_recon_loss: 3261484.2042; train_gene_expr_recon_loss: 12440826.1832; train_masked_gp_l1_reg_loss: 114083.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116711.5058; train_chrom_access_recon_loss: 6404752.2977; train_global_loss: 22411987.1908; train_optim_loss: 22411987.1908; val_kl_reg_loss: 94176.6380; val_edge_recon_loss: 2994444.7167; val_gene_expr_recon_loss: 12184246.0000; val_masked_gp_l1_reg_loss: 128066.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102743.6406; val_chrom_access_recon_loss: 6312842.3333; val_global_loss: 21816519.7333; val_optim_loss: 21816519.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9085; val_auprc_score: 0.8967; val_best_acc_score: 0.8313; val_best_f1_score: 0.8408; train_kl_reg_loss: 97642.7756; train_edge_recon_loss: 2925427.1927; train_gene_expr_recon_loss: 12313809.0763; train_masked_gp_l1_reg_loss: 128060.0779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96525.7032; train_chrom_access_recon_loss: 6336660.1756; train_global_loss: 21898124.8702; train_optim_loss: 21898124.8702; val_kl_reg_loss: 96304.5271; val_edge_recon_loss: 2870916.4667; val_gene_expr_recon_loss: 12044871.6000; val_masked_gp_l1_reg_loss: 128856.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93158.8438; val_chrom_access_recon_loss: 6258595.1333; val_global_loss: 21492702.9333; val_optim_loss: 21492702.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9200; val_auprc_score: 0.9034; val_best_acc_score: 0.8463; val_best_f1_score: 0.8575; train_kl_reg_loss: 100576.7666; train_edge_recon_loss: 2837877.3111; train_gene_expr_recon_loss: 12194605.6031; train_masked_gp_l1_reg_loss: 129149.7885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90887.4314; train_chrom_access_recon_loss: 6283079.4160; train_global_loss: 21636176.2901; train_optim_loss: 21636176.2901; val_kl_reg_loss: 101211.2922; val_edge_recon_loss: 2842207.0500; val_gene_expr_recon_loss: 11954590.8667; val_masked_gp_l1_reg_loss: 128919.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89971.9922; val_chrom_access_recon_loss: 6218852.9333; val_global_loss: 21335753.2000; val_optim_loss: 21335753.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9248; val_auprc_score: 0.9123; val_best_acc_score: 0.8490; val_best_f1_score: 0.8597; train_kl_reg_loss: 98146.1892; train_edge_recon_loss: 2822952.3607; train_gene_expr_recon_loss: 12095302.6031; train_masked_gp_l1_reg_loss: 129485.5238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88563.2305; train_chrom_access_recon_loss: 6240077.4847; train_global_loss: 21474527.4962; train_optim_loss: 21474527.4962; val_kl_reg_loss: 96632.5203; val_edge_recon_loss: 2835101.9333; val_gene_expr_recon_loss: 11921413.4000; val_masked_gp_l1_reg_loss: 130200.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87853.6484; val_chrom_access_recon_loss: 6213500.3667; val_global_loss: 21284702.1333; val_optim_loss: 21284702.1333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9295; val_auprc_score: 0.9161; val_best_acc_score: 0.8562; val_best_f1_score: 0.8651; train_kl_reg_loss: 97860.4786; train_edge_recon_loss: 2799697.8130; train_gene_expr_recon_loss: 12001397.5420; train_masked_gp_l1_reg_loss: 130012.6815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85868.9860; train_chrom_access_recon_loss: 6193280.7977; train_global_loss: 21308118.1985; train_optim_loss: 21308118.1985; val_kl_reg_loss: 96481.5938; val_edge_recon_loss: 2821303.2000; val_gene_expr_recon_loss: 11798763.7333; val_masked_gp_l1_reg_loss: 130058.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84432.7266; val_chrom_access_recon_loss: 6148209.0000; val_global_loss: 21079249.8667; val_optim_loss: 21079249.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9386; val_auprc_score: 0.9255; val_best_acc_score: 0.8689; val_best_f1_score: 0.8754; train_kl_reg_loss: 92503.4225; train_edge_recon_loss: 2793416.0782; train_gene_expr_recon_loss: 11928988.9084; train_masked_gp_l1_reg_loss: 129845.7870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83094.4129; train_chrom_access_recon_loss: 6152445.3893; train_global_loss: 21180294.1221; train_optim_loss: 21180294.1221; val_kl_reg_loss: 91121.7609; val_edge_recon_loss: 2783277.3500; val_gene_expr_recon_loss: 11734137.7333; val_masked_gp_l1_reg_loss: 129586.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81860.5156; val_chrom_access_recon_loss: 6091117.6000; val_global_loss: 20911102.5333; val_optim_loss: 20911102.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9422; val_auprc_score: 0.9280; val_best_acc_score: 0.8762; val_best_f1_score: 0.8825; train_kl_reg_loss: 91082.3093; train_edge_recon_loss: 2776932.8664; train_gene_expr_recon_loss: 11868430.7863; train_masked_gp_l1_reg_loss: 129729.6611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81020.3334; train_chrom_access_recon_loss: 6120801.9122; train_global_loss: 21067997.8321; train_optim_loss: 21067997.8321; val_kl_reg_loss: 91242.3984; val_edge_recon_loss: 2785724.7333; val_gene_expr_recon_loss: 11617576.2000; val_masked_gp_l1_reg_loss: 130174.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80610.0781; val_chrom_access_recon_loss: 6075885.8333; val_global_loss: 20781214.0000; val_optim_loss: 20781214.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9484; val_auprc_score: 0.9384; val_best_acc_score: 0.8777; val_best_f1_score: 0.8849; train_kl_reg_loss: 92321.6369; train_edge_recon_loss: 2756868.2424; train_gene_expr_recon_loss: 11811327.3511; train_masked_gp_l1_reg_loss: 129873.0745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79351.2327; train_chrom_access_recon_loss: 6091886.9733; train_global_loss: 20961628.4733; train_optim_loss: 20961628.4733; val_kl_reg_loss: 91977.1339; val_edge_recon_loss: 2753062.8000; val_gene_expr_recon_loss: 11651463.6667; val_masked_gp_l1_reg_loss: 130350.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78676.5781; val_chrom_access_recon_loss: 6046385.5667; val_global_loss: 20751917.0667; val_optim_loss: 20751917.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9497; val_auprc_score: 0.9344; val_best_acc_score: 0.8864; val_best_f1_score: 0.8908; train_kl_reg_loss: 92282.8406; train_edge_recon_loss: 2752398.7214; train_gene_expr_recon_loss: 11753544.0916; train_masked_gp_l1_reg_loss: 130178.4422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78046.1407; train_chrom_access_recon_loss: 6053922.3015; train_global_loss: 20860372.5954; train_optim_loss: 20860372.5954; val_kl_reg_loss: 95651.4932; val_edge_recon_loss: 2739716.5167; val_gene_expr_recon_loss: 11580471.4000; val_masked_gp_l1_reg_loss: 130238.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77626.1172; val_chrom_access_recon_loss: 6043004.2667; val_global_loss: 20666708.8000; val_optim_loss: 20666708.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9535; val_auprc_score: 0.9411; val_best_acc_score: 0.8918; val_best_f1_score: 0.8952; train_kl_reg_loss: 91427.4420; train_edge_recon_loss: 2744055.3531; train_gene_expr_recon_loss: 11717114.5038; train_masked_gp_l1_reg_loss: 130199.6003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77085.4159; train_chrom_access_recon_loss: 6034259.7672; train_global_loss: 20794141.9695; train_optim_loss: 20794141.9695; val_kl_reg_loss: 92067.1406; val_edge_recon_loss: 2747752.4667; val_gene_expr_recon_loss: 11512646.0000; val_masked_gp_l1_reg_loss: 130509.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76733.3438; val_chrom_access_recon_loss: 5987151.6667; val_global_loss: 20546859.2000; val_optim_loss: 20546859.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9521; val_auprc_score: 0.9412; val_best_acc_score: 0.8888; val_best_f1_score: 0.8941; train_kl_reg_loss: 89955.9143; train_edge_recon_loss: 2736926.2805; train_gene_expr_recon_loss: 11673474.1145; train_masked_gp_l1_reg_loss: 130295.2957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76357.7176; train_chrom_access_recon_loss: 6009220.2710; train_global_loss: 20716229.5725; train_optim_loss: 20716229.5725; val_kl_reg_loss: 89985.1370; val_edge_recon_loss: 2751287.9833; val_gene_expr_recon_loss: 11530365.0667; val_masked_gp_l1_reg_loss: 130285.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76189.6797; val_chrom_access_recon_loss: 5973832.4000; val_global_loss: 20551945.8667; val_optim_loss: 20551945.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9560; val_auprc_score: 0.9437; val_best_acc_score: 0.8952; val_best_f1_score: 0.8984; train_kl_reg_loss: 87819.4321; train_edge_recon_loss: 2729378.4103; train_gene_expr_recon_loss: 11630360.2748; train_masked_gp_l1_reg_loss: 130022.4661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75477.8605; train_chrom_access_recon_loss: 5975732.3244; train_global_loss: 20628790.7634; train_optim_loss: 20628790.7634; val_kl_reg_loss: 89602.8792; val_edge_recon_loss: 2736398.3167; val_gene_expr_recon_loss: 11505751.2000; val_masked_gp_l1_reg_loss: 129545.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74975.7578; val_chrom_access_recon_loss: 5978279.0667; val_global_loss: 20514553.3333; val_optim_loss: 20514553.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9596; val_auprc_score: 0.9503; val_best_acc_score: 0.9000; val_best_f1_score: 0.9043; train_kl_reg_loss: 88340.3592; train_edge_recon_loss: 2733511.8550; train_gene_expr_recon_loss: 11610036.9618; train_masked_gp_l1_reg_loss: 129766.4769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74857.4357; train_chrom_access_recon_loss: 5967061.7061; train_global_loss: 20603574.8855; train_optim_loss: 20603574.8855; val_kl_reg_loss: 85811.2896; val_edge_recon_loss: 2717436.0833; val_gene_expr_recon_loss: 11450086.6667; val_masked_gp_l1_reg_loss: 129837.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75323.9062; val_chrom_access_recon_loss: 5921054.6667; val_global_loss: 20379550.4000; val_optim_loss: 20379550.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9605; val_auprc_score: 0.9488; val_best_acc_score: 0.8996; val_best_f1_score: 0.9051; train_kl_reg_loss: 86762.3591; train_edge_recon_loss: 2725104.7576; train_gene_expr_recon_loss: 11565885.3359; train_masked_gp_l1_reg_loss: 129818.4432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74855.2424; train_chrom_access_recon_loss: 5939801.5458; train_global_loss: 20522227.7099; train_optim_loss: 20522227.7099; val_kl_reg_loss: 86448.2745; val_edge_recon_loss: 2731333.2333; val_gene_expr_recon_loss: 11404629.8000; val_masked_gp_l1_reg_loss: 129569.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74588.2812; val_chrom_access_recon_loss: 5920787.8000; val_global_loss: 20347356.0000; val_optim_loss: 20347356.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9636; val_auprc_score: 0.9538; val_best_acc_score: 0.9049; val_best_f1_score: 0.9089; train_kl_reg_loss: 86400.8835; train_edge_recon_loss: 2720930.9695; train_gene_expr_recon_loss: 11540470.3282; train_masked_gp_l1_reg_loss: 129549.0834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74675.8519; train_chrom_access_recon_loss: 5925484.1298; train_global_loss: 20477511.1298; train_optim_loss: 20477511.1298; val_kl_reg_loss: 87048.9411; val_edge_recon_loss: 2737245.0667; val_gene_expr_recon_loss: 11328682.3333; val_masked_gp_l1_reg_loss: 129672.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74550.0312; val_chrom_access_recon_loss: 5871250.4333; val_global_loss: 20228449.8667; val_optim_loss: 20228449.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9618; val_auprc_score: 0.9514; val_best_acc_score: 0.9066; val_best_f1_score: 0.9112; train_kl_reg_loss: 86682.7282; train_edge_recon_loss: 2719663.6870; train_gene_expr_recon_loss: 11507561.9389; train_masked_gp_l1_reg_loss: 129299.7044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75012.8305; train_chrom_access_recon_loss: 5901690.8893; train_global_loss: 20419911.6794; train_optim_loss: 20419911.6794; val_kl_reg_loss: 87571.3385; val_edge_recon_loss: 2724188.4500; val_gene_expr_recon_loss: 11382047.2667; val_masked_gp_l1_reg_loss: 128784.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75222.6250; val_chrom_access_recon_loss: 5904836.0667; val_global_loss: 20302650.1333; val_optim_loss: 20302650.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9647; val_auprc_score: 0.9575; val_best_acc_score: 0.9042; val_best_f1_score: 0.9086; train_kl_reg_loss: 87500.3462; train_edge_recon_loss: 2717074.7653; train_gene_expr_recon_loss: 11487062.1908; train_masked_gp_l1_reg_loss: 128577.1905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75704.4832; train_chrom_access_recon_loss: 5896720.5038; train_global_loss: 20392639.3893; train_optim_loss: 20392639.3893; val_kl_reg_loss: 86717.0536; val_edge_recon_loss: 2738154.0167; val_gene_expr_recon_loss: 11298332.0667; val_masked_gp_l1_reg_loss: 128355.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75833.4766; val_chrom_access_recon_loss: 5837979.0667; val_global_loss: 20165370.0000; val_optim_loss: 20165370.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9660; val_auprc_score: 0.9565; val_best_acc_score: 0.9120; val_best_f1_score: 0.9157; train_kl_reg_loss: 85403.2393; train_edge_recon_loss: 2709698.4924; train_gene_expr_recon_loss: 11458970.6031; train_masked_gp_l1_reg_loss: 128242.8387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76366.2061; train_chrom_access_recon_loss: 5876183.2634; train_global_loss: 20334864.6260; train_optim_loss: 20334864.6260; val_kl_reg_loss: 85974.0437; val_edge_recon_loss: 2711539.7667; val_gene_expr_recon_loss: 11282128.4000; val_masked_gp_l1_reg_loss: 128265.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76492.9062; val_chrom_access_recon_loss: 5865921.5333; val_global_loss: 20150323.0667; val_optim_loss: 20150323.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9673; val_auprc_score: 0.9569; val_best_acc_score: 0.9167; val_best_f1_score: 0.9201; train_kl_reg_loss: 86858.0580; train_edge_recon_loss: 2702627.1145; train_gene_expr_recon_loss: 11431229.8550; train_masked_gp_l1_reg_loss: 128085.6687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76970.6085; train_chrom_access_recon_loss: 5855384.7214; train_global_loss: 20281156.0305; train_optim_loss: 20281156.0305; val_kl_reg_loss: 84324.3766; val_edge_recon_loss: 2718029.3000; val_gene_expr_recon_loss: 11315752.4000; val_masked_gp_l1_reg_loss: 127587.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76898.3516; val_chrom_access_recon_loss: 5875404.0000; val_global_loss: 20197995.0667; val_optim_loss: 20197995.0667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9642; val_auprc_score: 0.9531; val_best_acc_score: 0.9112; val_best_f1_score: 0.9145; train_kl_reg_loss: 85412.5355; train_edge_recon_loss: 2710661.7214; train_gene_expr_recon_loss: 11429376.2214; train_masked_gp_l1_reg_loss: 127322.7794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77433.6330; train_chrom_access_recon_loss: 5853027.3626; train_global_loss: 20283234.2290; train_optim_loss: 20283234.2290; val_kl_reg_loss: 84868.7063; val_edge_recon_loss: 2742469.3167; val_gene_expr_recon_loss: 11245111.1333; val_masked_gp_l1_reg_loss: 127081.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77470.5391; val_chrom_access_recon_loss: 5815227.0000; val_global_loss: 20092228.2667; val_optim_loss: 20092228.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9668; val_auprc_score: 0.9549; val_best_acc_score: 0.9153; val_best_f1_score: 0.9185; train_kl_reg_loss: 84894.2232; train_edge_recon_loss: 2708807.8931; train_gene_expr_recon_loss: 11402187.8855; train_masked_gp_l1_reg_loss: 126836.6074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77537.7705; train_chrom_access_recon_loss: 5834818.8702; train_global_loss: 20235083.2061; train_optim_loss: 20235083.2061; val_kl_reg_loss: 87404.8635; val_edge_recon_loss: 2723734.7333; val_gene_expr_recon_loss: 11278994.9333; val_masked_gp_l1_reg_loss: 126575.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78123.1172; val_chrom_access_recon_loss: 5848345.6667; val_global_loss: 20143178.4000; val_optim_loss: 20143178.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9701; val_auprc_score: 0.9626; val_best_acc_score: 0.9206; val_best_f1_score: 0.9232; train_kl_reg_loss: 83917.5318; train_edge_recon_loss: 2710113.4408; train_gene_expr_recon_loss: 11391955.0229; train_masked_gp_l1_reg_loss: 126234.9649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77781.0258; train_chrom_access_recon_loss: 5825233.7061; train_global_loss: 20215235.8626; train_optim_loss: 20215235.8626; val_kl_reg_loss: 84768.0052; val_edge_recon_loss: 2729611.9833; val_gene_expr_recon_loss: 11283380.8000; val_masked_gp_l1_reg_loss: 126157.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77280.1641; val_chrom_access_recon_loss: 5848801.2000; val_global_loss: 20149998.6667; val_optim_loss: 20149998.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9728; val_auprc_score: 0.9651; val_best_acc_score: 0.9221; val_best_f1_score: 0.9249; train_kl_reg_loss: 84797.7295; train_edge_recon_loss: 2702213.8588; train_gene_expr_recon_loss: 11376544.5496; train_masked_gp_l1_reg_loss: 125831.4924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77462.8327; train_chrom_access_recon_loss: 5813330.5076; train_global_loss: 20180180.9008; train_optim_loss: 20180180.9008; val_kl_reg_loss: 82408.2630; val_edge_recon_loss: 2708535.4667; val_gene_expr_recon_loss: 11225785.6000; val_masked_gp_l1_reg_loss: 125520.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77207.8594; val_chrom_access_recon_loss: 5800294.6000; val_global_loss: 20019751.8667; val_optim_loss: 20019751.8667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9703; val_auprc_score: 0.9605; val_best_acc_score: 0.9233; val_best_f1_score: 0.9262; train_kl_reg_loss: 84278.7248; train_edge_recon_loss: 2699305.8550; train_gene_expr_recon_loss: 11362843.7023; train_masked_gp_l1_reg_loss: 125223.5618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77606.1297; train_chrom_access_recon_loss: 5799036.2176; train_global_loss: 20148294.1679; train_optim_loss: 20148294.1679; val_kl_reg_loss: 82196.0839; val_edge_recon_loss: 2708916.5000; val_gene_expr_recon_loss: 11213195.2000; val_masked_gp_l1_reg_loss: 124827.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77617.5703; val_chrom_access_recon_loss: 5791269.2333; val_global_loss: 19998022.8000; val_optim_loss: 19998022.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9743; val_auprc_score: 0.9677; val_best_acc_score: 0.9303; val_best_f1_score: 0.9324; train_kl_reg_loss: 84668.7504; train_edge_recon_loss: 2700689.0935; train_gene_expr_recon_loss: 11348222.0611; train_masked_gp_l1_reg_loss: 124596.1865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77570.3999; train_chrom_access_recon_loss: 5794977.6603; train_global_loss: 20130724.0611; train_optim_loss: 20130724.0611; val_kl_reg_loss: 84420.9818; val_edge_recon_loss: 2702467.2500; val_gene_expr_recon_loss: 11199990.8000; val_masked_gp_l1_reg_loss: 124222.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77315.5938; val_chrom_access_recon_loss: 5770225.1333; val_global_loss: 19958642.1333; val_optim_loss: 19958642.1333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9707; val_auprc_score: 0.9589; val_best_acc_score: 0.9248; val_best_f1_score: 0.9276; train_kl_reg_loss: 83900.4888; train_edge_recon_loss: 2701527.1298; train_gene_expr_recon_loss: 11335787.1069; train_masked_gp_l1_reg_loss: 123985.7490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77460.6362; train_chrom_access_recon_loss: 5780449.3206; train_global_loss: 20103110.3969; train_optim_loss: 20103110.3969; val_kl_reg_loss: 83591.3292; val_edge_recon_loss: 2709803.7000; val_gene_expr_recon_loss: 11206091.4667; val_masked_gp_l1_reg_loss: 123744.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77365.7422; val_chrom_access_recon_loss: 5775488.7000; val_global_loss: 19976085.4667; val_optim_loss: 19976085.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9719; val_auprc_score: 0.9614; val_best_acc_score: 0.9248; val_best_f1_score: 0.9278; train_kl_reg_loss: 84548.4744; train_edge_recon_loss: 2694568.0592; train_gene_expr_recon_loss: 11327283.6260; train_masked_gp_l1_reg_loss: 123282.0234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77492.3996; train_chrom_access_recon_loss: 5774300.9237; train_global_loss: 20081475.4962; train_optim_loss: 20081475.4962; val_kl_reg_loss: 86381.1005; val_edge_recon_loss: 2708827.9333; val_gene_expr_recon_loss: 11150140.4000; val_masked_gp_l1_reg_loss: 123095.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77745.1328; val_chrom_access_recon_loss: 5744143.2000; val_global_loss: 19890332.5333; val_optim_loss: 19890332.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9738; val_auprc_score: 0.9646; val_best_acc_score: 0.9262; val_best_f1_score: 0.9291; train_kl_reg_loss: 83247.2597; train_edge_recon_loss: 2698106.6107; train_gene_expr_recon_loss: 11320855.4580; train_masked_gp_l1_reg_loss: 122801.1167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77697.0667; train_chrom_access_recon_loss: 5762682.1183; train_global_loss: 20065389.5420; train_optim_loss: 20065389.5420; val_kl_reg_loss: 82816.4234; val_edge_recon_loss: 2699259.4333; val_gene_expr_recon_loss: 11173131.6667; val_masked_gp_l1_reg_loss: 122451.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77561.1406; val_chrom_access_recon_loss: 5762586.3333; val_global_loss: 19917806.5333; val_optim_loss: 19917806.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9741; val_auprc_score: 0.9666; val_best_acc_score: 0.9248; val_best_f1_score: 0.9268; train_kl_reg_loss: 83315.2017; train_edge_recon_loss: 2692051.3874; train_gene_expr_recon_loss: 11302165.1985; train_masked_gp_l1_reg_loss: 122278.6419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77604.0281; train_chrom_access_recon_loss: 5752345.7710; train_global_loss: 20029760.3359; train_optim_loss: 20029760.3359; val_kl_reg_loss: 82505.7094; val_edge_recon_loss: 2717725.2667; val_gene_expr_recon_loss: 11153155.2000; val_masked_gp_l1_reg_loss: 122058.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77686.6016; val_chrom_access_recon_loss: 5748952.9667; val_global_loss: 19902085.3333; val_optim_loss: 19902085.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9733; val_auprc_score: 0.9679; val_best_acc_score: 0.9232; val_best_f1_score: 0.9262; train_kl_reg_loss: 81975.0326; train_edge_recon_loss: 2701115.2462; train_gene_expr_recon_loss: 11296746.7939; train_masked_gp_l1_reg_loss: 121784.2467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77854.6543; train_chrom_access_recon_loss: 5748545.8397; train_global_loss: 20028022.0000; train_optim_loss: 20028022.0000; val_kl_reg_loss: 79192.5583; val_edge_recon_loss: 2719670.0333; val_gene_expr_recon_loss: 11103836.0667; val_masked_gp_l1_reg_loss: 121458.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77842.6172; val_chrom_access_recon_loss: 5716930.9667; val_global_loss: 19818931.4667; val_optim_loss: 19818931.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9748; val_auprc_score: 0.9674; val_best_acc_score: 0.9295; val_best_f1_score: 0.9316; train_kl_reg_loss: 81661.4413; train_edge_recon_loss: 2696665.6947; train_gene_expr_recon_loss: 11288955.8015; train_masked_gp_l1_reg_loss: 121047.2521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78031.9232; train_chrom_access_recon_loss: 5733533.7443; train_global_loss: 19999895.9237; train_optim_loss: 19999895.9237; val_kl_reg_loss: 82728.9766; val_edge_recon_loss: 2703295.8167; val_gene_expr_recon_loss: 11153812.4667; val_masked_gp_l1_reg_loss: 120944.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78126.7422; val_chrom_access_recon_loss: 5738420.8667; val_global_loss: 19877329.0667; val_optim_loss: 19877329.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9754; val_auprc_score: 0.9659; val_best_acc_score: 0.9321; val_best_f1_score: 0.9340; train_kl_reg_loss: 81465.7928; train_edge_recon_loss: 2693989.1679; train_gene_expr_recon_loss: 11281539.2748; train_masked_gp_l1_reg_loss: 120595.8858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78170.0242; train_chrom_access_recon_loss: 5730932.0992; train_global_loss: 19986692.2901; train_optim_loss: 19986692.2901; val_kl_reg_loss: 80984.0057; val_edge_recon_loss: 2703028.5500; val_gene_expr_recon_loss: 11163456.6667; val_masked_gp_l1_reg_loss: 120311.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77963.3203; val_chrom_access_recon_loss: 5721548.5000; val_global_loss: 19867291.7333; val_optim_loss: 19867291.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9790; val_auprc_score: 0.9747; val_best_acc_score: 0.9340; val_best_f1_score: 0.9353; train_kl_reg_loss: 81678.8678; train_edge_recon_loss: 2692420.3779; train_gene_expr_recon_loss: 11275981.3359; train_masked_gp_l1_reg_loss: 120082.5007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78160.3890; train_chrom_access_recon_loss: 5720638.4656; train_global_loss: 19968961.8931; train_optim_loss: 19968961.8931; val_kl_reg_loss: 82240.8281; val_edge_recon_loss: 2694603.4167; val_gene_expr_recon_loss: 11133047.9333; val_masked_gp_l1_reg_loss: 119783.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78475.5469; val_chrom_access_recon_loss: 5719246.5000; val_global_loss: 19827398.2667; val_optim_loss: 19827398.2667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9762; val_auprc_score: 0.9683; val_best_acc_score: 0.9283; val_best_f1_score: 0.9305; train_kl_reg_loss: 81734.8516; train_edge_recon_loss: 2690140.7309; train_gene_expr_recon_loss: 11268719.0611; train_masked_gp_l1_reg_loss: 119482.7537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78135.6374; train_chrom_access_recon_loss: 5710094.5458; train_global_loss: 19948307.6947; train_optim_loss: 19948307.6947; val_kl_reg_loss: 80407.5776; val_edge_recon_loss: 2708880.0333; val_gene_expr_recon_loss: 11131160.6667; val_masked_gp_l1_reg_loss: 119525.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79010.8125; val_chrom_access_recon_loss: 5760040.8000; val_global_loss: 19879024.9333; val_optim_loss: 19879024.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9792; val_auprc_score: 0.9721; val_best_acc_score: 0.9365; val_best_f1_score: 0.9381; train_kl_reg_loss: 81881.9223; train_edge_recon_loss: 2681170.7863; train_gene_expr_recon_loss: 11253059.6107; train_masked_gp_l1_reg_loss: 114051.7390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60484.4018; train_chrom_access_recon_loss: 5693245.3588; train_global_loss: 19883893.6336; train_optim_loss: 19883893.6336; val_kl_reg_loss: 82517.4922; val_edge_recon_loss: 2691707.9500; val_gene_expr_recon_loss: 11096676.4000; val_masked_gp_l1_reg_loss: 112861.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58059.1523; val_chrom_access_recon_loss: 5712986.3667; val_global_loss: 19754809.4667; val_optim_loss: 19754809.4667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9771; val_auprc_score: 0.9681; val_best_acc_score: 0.9333; val_best_f1_score: 0.9348; train_kl_reg_loss: 83257.8615; train_edge_recon_loss: 2686308.4542; train_gene_expr_recon_loss: 11259634.9008; train_masked_gp_l1_reg_loss: 112676.1534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57575.8316; train_chrom_access_recon_loss: 5695350.8817; train_global_loss: 19894804.1374; train_optim_loss: 19894804.1374; val_kl_reg_loss: 84057.5870; val_edge_recon_loss: 2707024.4500; val_gene_expr_recon_loss: 11095648.3333; val_masked_gp_l1_reg_loss: 112617.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57380.1289; val_chrom_access_recon_loss: 5694453.6333; val_global_loss: 19751182.0000; val_optim_loss: 19751182.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9756; val_auprc_score: 0.9671; val_best_acc_score: 0.9303; val_best_f1_score: 0.9327; train_kl_reg_loss: 83932.6093; train_edge_recon_loss: 2681305.0477; train_gene_expr_recon_loss: 11236851.9008; train_masked_gp_l1_reg_loss: 112500.8959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57084.3176; train_chrom_access_recon_loss: 5685434.6565; train_global_loss: 19857109.3893; train_optim_loss: 19857109.3893; val_kl_reg_loss: 84647.2188; val_edge_recon_loss: 2699509.8000; val_gene_expr_recon_loss: 11141078.8667; val_masked_gp_l1_reg_loss: 112429.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56850.0312; val_chrom_access_recon_loss: 5706053.4333; val_global_loss: 19800568.5333; val_optim_loss: 19800568.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9785; val_auprc_score: 0.9716; val_best_acc_score: 0.9359; val_best_f1_score: 0.9373; train_kl_reg_loss: 84755.1882; train_edge_recon_loss: 2686956.0515; train_gene_expr_recon_loss: 11244603.0687; train_masked_gp_l1_reg_loss: 112343.1042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56658.9128; train_chrom_access_recon_loss: 5684893.1336; train_global_loss: 19870209.4962; train_optim_loss: 19870209.4962; val_kl_reg_loss: 83814.3120; val_edge_recon_loss: 2700924.7500; val_gene_expr_recon_loss: 11155525.6000; val_masked_gp_l1_reg_loss: 112312.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56471.4805; val_chrom_access_recon_loss: 5711498.0000; val_global_loss: 19820546.6667; val_optim_loss: 19820546.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9795; val_auprc_score: 0.9713; val_best_acc_score: 0.9419; val_best_f1_score: 0.9428; train_kl_reg_loss: 84120.0583; train_edge_recon_loss: 2686501.2996; train_gene_expr_recon_loss: 11252110.6565; train_masked_gp_l1_reg_loss: 112242.4978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56344.7109; train_chrom_access_recon_loss: 5690414.3588; train_global_loss: 19881733.4198; train_optim_loss: 19881733.4198; val_kl_reg_loss: 84260.3396; val_edge_recon_loss: 2667061.8833; val_gene_expr_recon_loss: 11114423.6000; val_masked_gp_l1_reg_loss: 112154.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56176.2539; val_chrom_access_recon_loss: 5691819.1333; val_global_loss: 19725895.8667; val_optim_loss: 19725895.8667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9769; val_auprc_score: 0.9691; val_best_acc_score: 0.9373; val_best_f1_score: 0.9389; train_kl_reg_loss: 84614.9181; train_edge_recon_loss: 2685273.5153; train_gene_expr_recon_loss: 11241921.2901; train_masked_gp_l1_reg_loss: 112127.5963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55918.9053; train_chrom_access_recon_loss: 5682874.2595; train_global_loss: 19862730.4275; train_optim_loss: 19862730.4275; val_kl_reg_loss: 84963.1198; val_edge_recon_loss: 2693869.9833; val_gene_expr_recon_loss: 11143036.7333; val_masked_gp_l1_reg_loss: 112091.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55959.8750; val_chrom_access_recon_loss: 5702724.1333; val_global_loss: 19792646.4000; val_optim_loss: 19792646.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9800; val_auprc_score: 0.9753; val_best_acc_score: 0.9341; val_best_f1_score: 0.9355; train_kl_reg_loss: 84514.6592; train_edge_recon_loss: 2689480.4485; train_gene_expr_recon_loss: 11245534.7863; train_masked_gp_l1_reg_loss: 112026.4860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55759.7804; train_chrom_access_recon_loss: 5684483.1183; train_global_loss: 19871799.2061; train_optim_loss: 19871799.2061; val_kl_reg_loss: 84657.9812; val_edge_recon_loss: 2703469.1333; val_gene_expr_recon_loss: 11155143.8667; val_masked_gp_l1_reg_loss: 111965.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55616.2070; val_chrom_access_recon_loss: 5712510.1000; val_global_loss: 19823363.2000; val_optim_loss: 19823363.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9795; val_auprc_score: 0.9729; val_best_acc_score: 0.9376; val_best_f1_score: 0.9393; train_kl_reg_loss: 84317.6817; train_edge_recon_loss: 2685110.2385; train_gene_expr_recon_loss: 11240280.6489; train_masked_gp_l1_reg_loss: 111918.5529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55513.3601; train_chrom_access_recon_loss: 5678273.2634; train_global_loss: 19855413.6794; train_optim_loss: 19855413.6794; val_kl_reg_loss: 84307.4214; val_edge_recon_loss: 2702810.0167; val_gene_expr_recon_loss: 11138918.3333; val_masked_gp_l1_reg_loss: 111889.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55380.1211; val_chrom_access_recon_loss: 5717367.7667; val_global_loss: 19810672.6667; val_optim_loss: 19810672.6667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9812; val_auprc_score: 0.9761; val_best_acc_score: 0.9395; val_best_f1_score: 0.9409; train_kl_reg_loss: 84620.4430; train_edge_recon_loss: 2683973.6660; train_gene_expr_recon_loss: 11240886.3740; train_masked_gp_l1_reg_loss: 111843.2934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55262.5107; train_chrom_access_recon_loss: 5686012.7214; train_global_loss: 19862599.0840; train_optim_loss: 19862599.0840; val_kl_reg_loss: 85099.7214; val_edge_recon_loss: 2687040.6667; val_gene_expr_recon_loss: 11169637.5333; val_masked_gp_l1_reg_loss: 111821.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55146.7266; val_chrom_access_recon_loss: 5731384.8667; val_global_loss: 19840130.6667; val_optim_loss: 19840130.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9794; val_auprc_score: 0.9737; val_best_acc_score: 0.9373; val_best_f1_score: 0.9393; train_kl_reg_loss: 84445.7793; train_edge_recon_loss: 2681254.8053; train_gene_expr_recon_loss: 11241387.8931; train_masked_gp_l1_reg_loss: 111230.2625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53341.4322; train_chrom_access_recon_loss: 5675890.1756; train_global_loss: 19847550.3969; train_optim_loss: 19847550.3969; val_kl_reg_loss: 85068.5734; val_edge_recon_loss: 2706653.9667; val_gene_expr_recon_loss: 11118326.6000; val_masked_gp_l1_reg_loss: 111073.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53114.1211; val_chrom_access_recon_loss: 5699284.9000; val_global_loss: 19773522.4000; val_optim_loss: 19773522.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9778; val_auprc_score: 0.9709; val_best_acc_score: 0.9338; val_best_f1_score: 0.9357; train_kl_reg_loss: 84460.3490; train_edge_recon_loss: 2681135.5687; train_gene_expr_recon_loss: 11237457.1756; train_masked_gp_l1_reg_loss: 111037.5546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53069.3037; train_chrom_access_recon_loss: 5680949.9084; train_global_loss: 19848109.8931; train_optim_loss: 19848109.8931; val_kl_reg_loss: 84753.6260; val_edge_recon_loss: 2702312.1500; val_gene_expr_recon_loss: 11098530.5333; val_masked_gp_l1_reg_loss: 111011.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53031.4141; val_chrom_access_recon_loss: 5691919.7000; val_global_loss: 19741558.0000; val_optim_loss: 19741558.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9790; val_auprc_score: 0.9727; val_best_acc_score: 0.9372; val_best_f1_score: 0.9387; train_kl_reg_loss: 84889.2548; train_edge_recon_loss: 2684735.4027; train_gene_expr_recon_loss: 11238489.1832; train_masked_gp_l1_reg_loss: 110994.1801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52994.1730; train_chrom_access_recon_loss: 5680190.1565; train_global_loss: 19852292.3206; train_optim_loss: 19852292.3206; val_kl_reg_loss: 85208.3328; val_edge_recon_loss: 2719986.6500; val_gene_expr_recon_loss: 11139348.0000; val_masked_gp_l1_reg_loss: 110976.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52966.7031; val_chrom_access_recon_loss: 5692126.5667; val_global_loss: 19800612.6667; val_optim_loss: 19800612.6667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9781; val_auprc_score: 0.9690; val_best_acc_score: 0.9355; val_best_f1_score: 0.9374; train_kl_reg_loss: 84750.4039; train_edge_recon_loss: 2676312.2557; train_gene_expr_recon_loss: 11244533.1298; train_masked_gp_l1_reg_loss: 110967.9720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52936.0557; train_chrom_access_recon_loss: 5683292.1794; train_global_loss: 19852792.0305; train_optim_loss: 19852792.0305; val_kl_reg_loss: 84712.7188; val_edge_recon_loss: 2703889.7167; val_gene_expr_recon_loss: 11096503.6000; val_masked_gp_l1_reg_loss: 110959.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52910.5625; val_chrom_access_recon_loss: 5678650.9000; val_global_loss: 19727626.8000; val_optim_loss: 19727626.8000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 12 sec.
Using best model state, which was in epoch 41.

--- MODEL EVALUATION ---
val AUROC score: 0.9784
val AUPRC score: 0.9715
val best accuracy score: 0.9326
val best F1 score: 0.9351
val target rna MSE score: 1.2382
val source rna MSE score: 0.4775
val target atac MSE score: 0.3353
val source atac MSE score: 0.0968
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
