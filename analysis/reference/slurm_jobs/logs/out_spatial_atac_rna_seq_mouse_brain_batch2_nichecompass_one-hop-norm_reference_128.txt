[True]
Run timestamp: 10102023_032958_128.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_128']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6777; val_auprc_score: 0.6674; val_best_acc_score: 0.5118; val_best_f1_score: 0.6710; train_kl_reg_loss: 39440.9000; train_edge_recon_loss: 3521537.2765; train_gene_expr_recon_loss: 14372008.1515; train_masked_gp_l1_reg_loss: 124189.0739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4563799.6477; train_chrom_access_recon_loss: 11662167.5303; train_global_loss: 34283142.8788; train_optim_loss: 34283142.8788; val_kl_reg_loss: 38459.9731; val_edge_recon_loss: 4064757.0938; val_gene_expr_recon_loss: 13263052.7500; val_masked_gp_l1_reg_loss: 107282.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2161812.5000; val_chrom_access_recon_loss: 11090311.1250; val_global_loss: 30725675.2500; val_optim_loss: 30725675.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6744; val_auprc_score: 0.6672; val_best_acc_score: 0.5269; val_best_f1_score: 0.6736; train_kl_reg_loss: 86875.6897; train_edge_recon_loss: 3522188.8371; train_gene_expr_recon_loss: 12963002.2273; train_masked_gp_l1_reg_loss: 104919.3307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1024676.3788; train_chrom_access_recon_loss: 11072914.0758; train_global_loss: 28774576.4848; train_optim_loss: 28774576.4848; val_kl_reg_loss: 89658.4854; val_edge_recon_loss: 4062868.4375; val_gene_expr_recon_loss: 12702167.5000; val_masked_gp_l1_reg_loss: 101741.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 431477.4062; val_chrom_access_recon_loss: 10787454.5000; val_global_loss: 28175368.5000; val_optim_loss: 28175368.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7028; val_auprc_score: 0.6929; val_best_acc_score: 0.6268; val_best_f1_score: 0.6928; train_kl_reg_loss: 91769.7514; train_edge_recon_loss: 3515493.8106; train_gene_expr_recon_loss: 12720592.2727; train_masked_gp_l1_reg_loss: 100734.3027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 297136.5807; train_chrom_access_recon_loss: 10943643.1515; train_global_loss: 27669369.7576; train_optim_loss: 27669369.7576; val_kl_reg_loss: 96480.0615; val_edge_recon_loss: 4043086.5625; val_gene_expr_recon_loss: 12676295.8750; val_masked_gp_l1_reg_loss: 100947.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 214503.6562; val_chrom_access_recon_loss: 10726899.3750; val_global_loss: 27858213.5000; val_optim_loss: 27858213.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7778; val_auprc_score: 0.7446; val_best_acc_score: 0.7082; val_best_f1_score: 0.7463; train_kl_reg_loss: 81376.8797; train_edge_recon_loss: 3486582.8485; train_gene_expr_recon_loss: 12619523.5606; train_masked_gp_l1_reg_loss: 102229.2828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 178357.8577; train_chrom_access_recon_loss: 10880959.8030; train_global_loss: 27349030.4242; train_optim_loss: 27349030.4242; val_kl_reg_loss: 71637.9082; val_edge_recon_loss: 3681214.2188; val_gene_expr_recon_loss: 12477083.2500; val_masked_gp_l1_reg_loss: 104861.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151023.9844; val_chrom_access_recon_loss: 10588255.5000; val_global_loss: 27074075.7500; val_optim_loss: 27074075.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8126; val_auprc_score: 0.7600; val_best_acc_score: 0.7426; val_best_f1_score: 0.7866; train_kl_reg_loss: 91604.7638; train_edge_recon_loss: 3125975.6288; train_gene_expr_recon_loss: 12556668.5606; train_masked_gp_l1_reg_loss: 110638.3641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 134885.0510; train_chrom_access_recon_loss: 10826074.2879; train_global_loss: 26845846.5455; train_optim_loss: 26845846.5455; val_kl_reg_loss: 102545.9238; val_edge_recon_loss: 3035591.6250; val_gene_expr_recon_loss: 12497899.1250; val_masked_gp_l1_reg_loss: 114763.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121802.5938; val_chrom_access_recon_loss: 10581806.2500; val_global_loss: 26454410.2500; val_optim_loss: 26454410.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8408; val_auprc_score: 0.8022; val_best_acc_score: 0.7507; val_best_f1_score: 0.7930; train_kl_reg_loss: 105639.2902; train_edge_recon_loss: 2967016.5152; train_gene_expr_recon_loss: 12473839.4545; train_masked_gp_l1_reg_loss: 115904.4079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113852.5036; train_chrom_access_recon_loss: 10747450.5455; train_global_loss: 26523702.7879; train_optim_loss: 26523702.7879; val_kl_reg_loss: 105666.5439; val_edge_recon_loss: 2941066.9062; val_gene_expr_recon_loss: 12447801.6250; val_masked_gp_l1_reg_loss: 117142.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107213.9453; val_chrom_access_recon_loss: 10563554.2500; val_global_loss: 26282445.5000; val_optim_loss: 26282445.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8325; val_auprc_score: 0.7861; val_best_acc_score: 0.7587; val_best_f1_score: 0.7929; train_kl_reg_loss: 105429.8643; train_edge_recon_loss: 2943412.7841; train_gene_expr_recon_loss: 12399240.3485; train_masked_gp_l1_reg_loss: 117700.2402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102863.3098; train_chrom_access_recon_loss: 10688718.4848; train_global_loss: 26357365.1212; train_optim_loss: 26357365.1212; val_kl_reg_loss: 102157.8545; val_edge_recon_loss: 2959353.5312; val_gene_expr_recon_loss: 12425098.5000; val_masked_gp_l1_reg_loss: 118430.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98937.2578; val_chrom_access_recon_loss: 10400963.6250; val_global_loss: 26104941.0000; val_optim_loss: 26104941.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8567; val_auprc_score: 0.8182; val_best_acc_score: 0.7800; val_best_f1_score: 0.8037; train_kl_reg_loss: 104174.6230; train_edge_recon_loss: 2924211.3636; train_gene_expr_recon_loss: 12332720.7727; train_masked_gp_l1_reg_loss: 119017.5578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97298.8292; train_chrom_access_recon_loss: 10652051.8939; train_global_loss: 26229475.1515; train_optim_loss: 26229475.1515; val_kl_reg_loss: 98528.3330; val_edge_recon_loss: 2944381.9062; val_gene_expr_recon_loss: 12227425.0000; val_masked_gp_l1_reg_loss: 119893.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96070.7734; val_chrom_access_recon_loss: 10395683.3750; val_global_loss: 25881983.5000; val_optim_loss: 25881983.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8574; val_auprc_score: 0.8212; val_best_acc_score: 0.7773; val_best_f1_score: 0.7972; train_kl_reg_loss: 99571.5266; train_edge_recon_loss: 2912111.7235; train_gene_expr_recon_loss: 12270718.6061; train_masked_gp_l1_reg_loss: 120212.6224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94834.2300; train_chrom_access_recon_loss: 10603529.3788; train_global_loss: 26100978.1212; train_optim_loss: 26100978.1212; val_kl_reg_loss: 104881.8633; val_edge_recon_loss: 2990342.5938; val_gene_expr_recon_loss: 12319799.8750; val_masked_gp_l1_reg_loss: 120758.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93289.7031; val_chrom_access_recon_loss: 10517080.0000; val_global_loss: 26146152.0000; val_optim_loss: 26146152.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8821; val_auprc_score: 0.8460; val_best_acc_score: 0.8090; val_best_f1_score: 0.8201; train_kl_reg_loss: 100326.2921; train_edge_recon_loss: 2898746.6856; train_gene_expr_recon_loss: 12229120.1364; train_masked_gp_l1_reg_loss: 121495.1656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92289.3944; train_chrom_access_recon_loss: 10568207.2273; train_global_loss: 26010184.8182; train_optim_loss: 26010184.8182; val_kl_reg_loss: 95799.1924; val_edge_recon_loss: 2854865.9688; val_gene_expr_recon_loss: 12171178.6250; val_masked_gp_l1_reg_loss: 122135.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91841.1875; val_chrom_access_recon_loss: 10378384.8750; val_global_loss: 25714204.5000; val_optim_loss: 25714204.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8799; val_auprc_score: 0.8346; val_best_acc_score: 0.8106; val_best_f1_score: 0.8269; train_kl_reg_loss: 95317.2812; train_edge_recon_loss: 2862086.8220; train_gene_expr_recon_loss: 12185982.1667; train_masked_gp_l1_reg_loss: 123116.4631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90765.7481; train_chrom_access_recon_loss: 10535361.3636; train_global_loss: 25892629.8182; train_optim_loss: 25892629.8182; val_kl_reg_loss: 95356.1562; val_edge_recon_loss: 2896068.1562; val_gene_expr_recon_loss: 12219632.1250; val_masked_gp_l1_reg_loss: 124075.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90251.5938; val_chrom_access_recon_loss: 10393650.3750; val_global_loss: 25819033.5000; val_optim_loss: 25819033.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9020; val_auprc_score: 0.8683; val_best_acc_score: 0.8375; val_best_f1_score: 0.8492; train_kl_reg_loss: 97793.9768; train_edge_recon_loss: 2834284.7273; train_gene_expr_recon_loss: 12143531.5455; train_masked_gp_l1_reg_loss: 124858.8517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89177.3010; train_chrom_access_recon_loss: 10507793.7576; train_global_loss: 25797440.1212; train_optim_loss: 25797440.1212; val_kl_reg_loss: 97002.7314; val_edge_recon_loss: 2865983.4688; val_gene_expr_recon_loss: 12062222.2500; val_masked_gp_l1_reg_loss: 126004.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88430.0547; val_chrom_access_recon_loss: 10224883.1250; val_global_loss: 25464525.5000; val_optim_loss: 25464525.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9107; val_auprc_score: 0.8796; val_best_acc_score: 0.8434; val_best_f1_score: 0.8544; train_kl_reg_loss: 101103.2528; train_edge_recon_loss: 2805685.2197; train_gene_expr_recon_loss: 12109871.1364; train_masked_gp_l1_reg_loss: 126374.4014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87684.3466; train_chrom_access_recon_loss: 10469657.8333; train_global_loss: 25700376.0909; train_optim_loss: 25700376.0909; val_kl_reg_loss: 100309.5225; val_edge_recon_loss: 2825692.3125; val_gene_expr_recon_loss: 12063381.8750; val_masked_gp_l1_reg_loss: 127045.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87258.3281; val_chrom_access_recon_loss: 10183863.3750; val_global_loss: 25387550.2500; val_optim_loss: 25387550.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9098; val_auprc_score: 0.8810; val_best_acc_score: 0.8525; val_best_f1_score: 0.8608; train_kl_reg_loss: 101937.5709; train_edge_recon_loss: 2792728.8485; train_gene_expr_recon_loss: 12070847.8030; train_masked_gp_l1_reg_loss: 127252.7029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86445.5333; train_chrom_access_recon_loss: 10446481.1818; train_global_loss: 25625693.5455; train_optim_loss: 25625693.5455; val_kl_reg_loss: 99132.6846; val_edge_recon_loss: 2826310.1562; val_gene_expr_recon_loss: 12026276.7500; val_masked_gp_l1_reg_loss: 127662.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85927.0625; val_chrom_access_recon_loss: 10173419.7500; val_global_loss: 25338729.0000; val_optim_loss: 25338729.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9094; val_auprc_score: 0.8790; val_best_acc_score: 0.8501; val_best_f1_score: 0.8610; train_kl_reg_loss: 100970.7930; train_edge_recon_loss: 2788366.4015; train_gene_expr_recon_loss: 12028845.3333; train_masked_gp_l1_reg_loss: 127926.9800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85446.2782; train_chrom_access_recon_loss: 10408067.5152; train_global_loss: 25539623.4848; train_optim_loss: 25539623.4848; val_kl_reg_loss: 100700.4902; val_edge_recon_loss: 2798724.3125; val_gene_expr_recon_loss: 11988507.6250; val_masked_gp_l1_reg_loss: 128102.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85069.1562; val_chrom_access_recon_loss: 10202287.7500; val_global_loss: 25303392.0000; val_optim_loss: 25303392.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9211; val_auprc_score: 0.8933; val_best_acc_score: 0.8624; val_best_f1_score: 0.8710; train_kl_reg_loss: 100229.1057; train_edge_recon_loss: 2780872.8371; train_gene_expr_recon_loss: 11990151.4091; train_masked_gp_l1_reg_loss: 128470.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84690.6007; train_chrom_access_recon_loss: 10370153.0455; train_global_loss: 25454567.8788; train_optim_loss: 25454567.8788; val_kl_reg_loss: 95930.4434; val_edge_recon_loss: 2815090.9062; val_gene_expr_recon_loss: 12033645.7500; val_masked_gp_l1_reg_loss: 128634.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83715.5469; val_chrom_access_recon_loss: 10242971.8750; val_global_loss: 25399989.2500; val_optim_loss: 25399989.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9231; val_auprc_score: 0.8924; val_best_acc_score: 0.8632; val_best_f1_score: 0.8712; train_kl_reg_loss: 100527.1972; train_edge_recon_loss: 2771135.7689; train_gene_expr_recon_loss: 11956022.8333; train_masked_gp_l1_reg_loss: 128888.3493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83473.6186; train_chrom_access_recon_loss: 10338765.4242; train_global_loss: 25378813.1818; train_optim_loss: 25378813.1818; val_kl_reg_loss: 97826.1807; val_edge_recon_loss: 2766307.4375; val_gene_expr_recon_loss: 12076014.8750; val_masked_gp_l1_reg_loss: 129218.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83420.1016; val_chrom_access_recon_loss: 10231102.7500; val_global_loss: 25383889.2500; val_optim_loss: 25383889.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9170; val_auprc_score: 0.8874; val_best_acc_score: 0.8549; val_best_f1_score: 0.8622; train_kl_reg_loss: 101599.7462; train_edge_recon_loss: 2754107.8864; train_gene_expr_recon_loss: 11928506.7121; train_masked_gp_l1_reg_loss: 129324.2428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82900.8372; train_chrom_access_recon_loss: 10319763.2727; train_global_loss: 25316202.5758; train_optim_loss: 25316202.5758; val_kl_reg_loss: 98616.6055; val_edge_recon_loss: 2825982.4062; val_gene_expr_recon_loss: 12145150.3750; val_masked_gp_l1_reg_loss: 129157.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82615.0312; val_chrom_access_recon_loss: 10310101.7500; val_global_loss: 25591624.5000; val_optim_loss: 25591624.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9208; val_auprc_score: 0.8928; val_best_acc_score: 0.8560; val_best_f1_score: 0.8651; train_kl_reg_loss: 99483.5202; train_edge_recon_loss: 2757125.7917; train_gene_expr_recon_loss: 11905852.4848; train_masked_gp_l1_reg_loss: 129648.6192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82303.9087; train_chrom_access_recon_loss: 10295200.5000; train_global_loss: 25269614.6061; train_optim_loss: 25269614.6061; val_kl_reg_loss: 101772.6445; val_edge_recon_loss: 2802837.9688; val_gene_expr_recon_loss: 11905472.6250; val_masked_gp_l1_reg_loss: 129592.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81907.9453; val_chrom_access_recon_loss: 10180741.3750; val_global_loss: 25202326.2500; val_optim_loss: 25202326.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9251; val_auprc_score: 0.8978; val_best_acc_score: 0.8624; val_best_f1_score: 0.8715; train_kl_reg_loss: 97066.2798; train_edge_recon_loss: 2756043.2008; train_gene_expr_recon_loss: 11882063.9091; train_masked_gp_l1_reg_loss: 129696.7151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81948.4216; train_chrom_access_recon_loss: 10264335.3485; train_global_loss: 25211153.8485; train_optim_loss: 25211153.8485; val_kl_reg_loss: 96180.0908; val_edge_recon_loss: 2782015.1562; val_gene_expr_recon_loss: 11829156.7500; val_masked_gp_l1_reg_loss: 130057.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81412.4453; val_chrom_access_recon_loss: 10041968.2500; val_global_loss: 24960789.0000; val_optim_loss: 24960789.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9274; val_auprc_score: 0.9051; val_best_acc_score: 0.8649; val_best_f1_score: 0.8713; train_kl_reg_loss: 98397.9927; train_edge_recon_loss: 2754494.9318; train_gene_expr_recon_loss: 11853792.0758; train_masked_gp_l1_reg_loss: 130199.7726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81330.6014; train_chrom_access_recon_loss: 10243233.0455; train_global_loss: 25161448.5455; train_optim_loss: 25161448.5455; val_kl_reg_loss: 100347.1895; val_edge_recon_loss: 2801840.2188; val_gene_expr_recon_loss: 11955634.7500; val_masked_gp_l1_reg_loss: 130387.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81272.6328; val_chrom_access_recon_loss: 10115973.6250; val_global_loss: 25185455.7500; val_optim_loss: 25185455.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9210; val_auprc_score: 0.8960; val_best_acc_score: 0.8603; val_best_f1_score: 0.8678; train_kl_reg_loss: 98441.3719; train_edge_recon_loss: 2752491.5114; train_gene_expr_recon_loss: 11831336.2121; train_masked_gp_l1_reg_loss: 130521.0895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81069.3369; train_chrom_access_recon_loss: 10222943.9697; train_global_loss: 25116803.2727; train_optim_loss: 25116803.2727; val_kl_reg_loss: 96251.9385; val_edge_recon_loss: 2803076.1562; val_gene_expr_recon_loss: 11851644.8750; val_masked_gp_l1_reg_loss: 130833.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81097.3203; val_chrom_access_recon_loss: 10045059.1250; val_global_loss: 25007963.2500; val_optim_loss: 25007963.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9251; val_auprc_score: 0.8954; val_best_acc_score: 0.8638; val_best_f1_score: 0.8718; train_kl_reg_loss: 95114.3152; train_edge_recon_loss: 2749100.1515; train_gene_expr_recon_loss: 11792404.2727; train_masked_gp_l1_reg_loss: 130667.4515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81176.0653; train_chrom_access_recon_loss: 10185121.2879; train_global_loss: 25033583.7576; train_optim_loss: 25033583.7576; val_kl_reg_loss: 96397.3359; val_edge_recon_loss: 2796562.4375; val_gene_expr_recon_loss: 11755254.1250; val_masked_gp_l1_reg_loss: 130760.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80574.2109; val_chrom_access_recon_loss: 9994787.3750; val_global_loss: 24854335.0000; val_optim_loss: 24854335.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9292; val_auprc_score: 0.9073; val_best_acc_score: 0.8619; val_best_f1_score: 0.8687; train_kl_reg_loss: 97371.2412; train_edge_recon_loss: 2745843.9205; train_gene_expr_recon_loss: 11767048.0758; train_masked_gp_l1_reg_loss: 130817.2227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80778.7682; train_chrom_access_recon_loss: 10162194.6667; train_global_loss: 24984053.9394; train_optim_loss: 24984053.9394; val_kl_reg_loss: 98947.4883; val_edge_recon_loss: 2772549.5625; val_gene_expr_recon_loss: 11858065.8750; val_masked_gp_l1_reg_loss: 130926.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80677.9297; val_chrom_access_recon_loss: 10089866.1250; val_global_loss: 25031034.0000; val_optim_loss: 25031034.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9289; val_auprc_score: 0.9057; val_best_acc_score: 0.8606; val_best_f1_score: 0.8700; train_kl_reg_loss: 95863.0913; train_edge_recon_loss: 2747064.0682; train_gene_expr_recon_loss: 11769070.8939; train_masked_gp_l1_reg_loss: 130874.5347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80696.5586; train_chrom_access_recon_loss: 10160562.6515; train_global_loss: 24984131.9394; train_optim_loss: 24984131.9394; val_kl_reg_loss: 93824.3838; val_edge_recon_loss: 2786872.4375; val_gene_expr_recon_loss: 11712829.8750; val_masked_gp_l1_reg_loss: 130933.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80691.5859; val_chrom_access_recon_loss: 10064479.7500; val_global_loss: 24869632.2500; val_optim_loss: 24869632.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9233; val_auprc_score: 0.8902; val_best_acc_score: 0.8595; val_best_f1_score: 0.8666; train_kl_reg_loss: 121556.3619; train_edge_recon_loss: 2895806.1856; train_gene_expr_recon_loss: 11090522.8939; train_masked_gp_l1_reg_loss: 132564.3658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82363.9577; train_chrom_access_recon_loss: 9779299.1970; train_global_loss: 24102112.9091; train_optim_loss: 24102112.9091; val_kl_reg_loss: 38895.7280; val_edge_recon_loss: 2847330.0938; val_gene_expr_recon_loss: 11078311.1250; val_masked_gp_l1_reg_loss: 133570.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83031.2344; val_chrom_access_recon_loss: 9544914.5000; val_global_loss: 23726052.5000; val_optim_loss: 23726052.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9298; val_auprc_score: 0.8976; val_best_acc_score: 0.8721; val_best_f1_score: 0.8790; train_kl_reg_loss: 112280.5360; train_edge_recon_loss: 2782857.1439; train_gene_expr_recon_loss: 11028576.2576; train_masked_gp_l1_reg_loss: 133340.3260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81320.3277; train_chrom_access_recon_loss: 9631031.7273; train_global_loss: 23769406.4545; train_optim_loss: 23769406.4545; val_kl_reg_loss: 47212.3774; val_edge_recon_loss: 2782372.3125; val_gene_expr_recon_loss: 11150157.0000; val_masked_gp_l1_reg_loss: 133010.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80339.3984; val_chrom_access_recon_loss: 9627670.7500; val_global_loss: 23820762.7500; val_optim_loss: 23820762.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9313; val_auprc_score: 0.9049; val_best_acc_score: 0.8657; val_best_f1_score: 0.8722; train_kl_reg_loss: 94172.4972; train_edge_recon_loss: 2755383.5985; train_gene_expr_recon_loss: 10998288.9545; train_masked_gp_l1_reg_loss: 132406.3501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79392.7051; train_chrom_access_recon_loss: 9600137.3333; train_global_loss: 23659781.4545; train_optim_loss: 23659781.4545; val_kl_reg_loss: 53774.8096; val_edge_recon_loss: 2792217.5312; val_gene_expr_recon_loss: 10976304.0000; val_masked_gp_l1_reg_loss: 131680.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78763.8828; val_chrom_access_recon_loss: 9374505.1250; val_global_loss: 23407245.2500; val_optim_loss: 23407245.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9294; val_auprc_score: 0.8993; val_best_acc_score: 0.8716; val_best_f1_score: 0.8778; train_kl_reg_loss: 85764.9424; train_edge_recon_loss: 2745160.3788; train_gene_expr_recon_loss: 10978686.4545; train_masked_gp_l1_reg_loss: 130807.0765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78237.8980; train_chrom_access_recon_loss: 9586767.8788; train_global_loss: 23605424.6364; train_optim_loss: 23605424.6364; val_kl_reg_loss: 58764.6582; val_edge_recon_loss: 2773492.1562; val_gene_expr_recon_loss: 11002950.5000; val_masked_gp_l1_reg_loss: 129943.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77969.7109; val_chrom_access_recon_loss: 9502232.0000; val_global_loss: 23545352.7500; val_optim_loss: 23545352.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9356; val_auprc_score: 0.9125; val_best_acc_score: 0.8724; val_best_f1_score: 0.8796; train_kl_reg_loss: 80080.1532; train_edge_recon_loss: 2737930.9811; train_gene_expr_recon_loss: 10956999.9242; train_masked_gp_l1_reg_loss: 129158.8426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77445.5327; train_chrom_access_recon_loss: 9561585.9242; train_global_loss: 23543201.3636; train_optim_loss: 23543201.3636; val_kl_reg_loss: 59394.6963; val_edge_recon_loss: 2755394.4375; val_gene_expr_recon_loss: 10978398.6250; val_masked_gp_l1_reg_loss: 128376.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76972.5000; val_chrom_access_recon_loss: 9504927.6250; val_global_loss: 23503465.2500; val_optim_loss: 23503465.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9371; val_auprc_score: 0.9126; val_best_acc_score: 0.8751; val_best_f1_score: 0.8807; train_kl_reg_loss: 75813.9073; train_edge_recon_loss: 2739687.3258; train_gene_expr_recon_loss: 10929013.8333; train_masked_gp_l1_reg_loss: 127750.6632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76771.6242; train_chrom_access_recon_loss: 9522069.7121; train_global_loss: 23471107.0000; train_optim_loss: 23471107.0000; val_kl_reg_loss: 59162.1777; val_edge_recon_loss: 2765665.3438; val_gene_expr_recon_loss: 10847726.2500; val_masked_gp_l1_reg_loss: 127036.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76401.1719; val_chrom_access_recon_loss: 9347189.8750; val_global_loss: 23223181.7500; val_optim_loss: 23223181.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9364; val_auprc_score: 0.9103; val_best_acc_score: 0.8764; val_best_f1_score: 0.8841; train_kl_reg_loss: 78675.4899; train_edge_recon_loss: 2724715.7538; train_gene_expr_recon_loss: 10917533.2273; train_masked_gp_l1_reg_loss: 126401.9755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76081.5194; train_chrom_access_recon_loss: 9510573.1061; train_global_loss: 23433980.9091; train_optim_loss: 23433980.9091; val_kl_reg_loss: 65466.4136; val_edge_recon_loss: 2744363.5625; val_gene_expr_recon_loss: 10951969.7500; val_masked_gp_l1_reg_loss: 125922.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76162.3047; val_chrom_access_recon_loss: 9431810.6250; val_global_loss: 23395695.2500; val_optim_loss: 23395695.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9321; val_auprc_score: 0.9000; val_best_acc_score: 0.8726; val_best_f1_score: 0.8802; train_kl_reg_loss: 77624.6399; train_edge_recon_loss: 2724940.7955; train_gene_expr_recon_loss: 10900834.9394; train_masked_gp_l1_reg_loss: 125171.6178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75918.5665; train_chrom_access_recon_loss: 9503519.4091; train_global_loss: 23408009.8788; train_optim_loss: 23408009.8788; val_kl_reg_loss: 64266.7451; val_edge_recon_loss: 2776462.9688; val_gene_expr_recon_loss: 10879796.2500; val_masked_gp_l1_reg_loss: 124742.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75540.3828; val_chrom_access_recon_loss: 9399642.7500; val_global_loss: 23320451.5000; val_optim_loss: 23320451.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9443; val_auprc_score: 0.9212; val_best_acc_score: 0.8888; val_best_f1_score: 0.8944; train_kl_reg_loss: 76370.4096; train_edge_recon_loss: 2719883.5492; train_gene_expr_recon_loss: 10886773.8939; train_masked_gp_l1_reg_loss: 124195.5863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75405.2757; train_chrom_access_recon_loss: 9488766.2879; train_global_loss: 23371394.9697; train_optim_loss: 23371394.9697; val_kl_reg_loss: 65167.3599; val_edge_recon_loss: 2726524.0938; val_gene_expr_recon_loss: 10889744.5000; val_masked_gp_l1_reg_loss: 123772.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75174.3906; val_chrom_access_recon_loss: 9394225.2500; val_global_loss: 23274607.7500; val_optim_loss: 23274607.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9415; val_auprc_score: 0.9187; val_best_acc_score: 0.8861; val_best_f1_score: 0.8912; train_kl_reg_loss: 75197.1263; train_edge_recon_loss: 2723453.8371; train_gene_expr_recon_loss: 10873623.9091; train_masked_gp_l1_reg_loss: 123301.0652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75264.0430; train_chrom_access_recon_loss: 9474391.9848; train_global_loss: 23345231.9394; train_optim_loss: 23345231.9394; val_kl_reg_loss: 66378.9658; val_edge_recon_loss: 2754849.8750; val_gene_expr_recon_loss: 10892237.2500; val_masked_gp_l1_reg_loss: 122844.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75020.0391; val_chrom_access_recon_loss: 9333317.7500; val_global_loss: 23244647.5000; val_optim_loss: 23244647.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9370; val_auprc_score: 0.9092; val_best_acc_score: 0.8810; val_best_f1_score: 0.8883; train_kl_reg_loss: 74874.2005; train_edge_recon_loss: 2715449.9280; train_gene_expr_recon_loss: 10853504.7273; train_masked_gp_l1_reg_loss: 119885.6327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62598.8750; train_chrom_access_recon_loss: 9462769.2879; train_global_loss: 23289082.7879; train_optim_loss: 23289082.7879; val_kl_reg_loss: 67330.7588; val_edge_recon_loss: 2765438.2812; val_gene_expr_recon_loss: 10918462.7500; val_masked_gp_l1_reg_loss: 118988.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60147.9414; val_chrom_access_recon_loss: 9307610.1250; val_global_loss: 23237978.7500; val_optim_loss: 23237978.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9435; val_auprc_score: 0.9207; val_best_acc_score: 0.8845; val_best_f1_score: 0.8893; train_kl_reg_loss: 76265.0656; train_edge_recon_loss: 2709337.7879; train_gene_expr_recon_loss: 10849832.4697; train_masked_gp_l1_reg_loss: 118847.8996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59890.3825; train_chrom_access_recon_loss: 9461169.8030; train_global_loss: 23275343.2727; train_optim_loss: 23275343.2727; val_kl_reg_loss: 67451.1074; val_edge_recon_loss: 2744618.2812; val_gene_expr_recon_loss: 10903217.0000; val_masked_gp_l1_reg_loss: 118735.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59694.1992; val_chrom_access_recon_loss: 9350004.0000; val_global_loss: 23243719.5000; val_optim_loss: 23243719.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9392; val_auprc_score: 0.9111; val_best_acc_score: 0.8845; val_best_f1_score: 0.8905; train_kl_reg_loss: 76418.0916; train_edge_recon_loss: 2708732.6932; train_gene_expr_recon_loss: 10858589.4697; train_masked_gp_l1_reg_loss: 118643.3395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59497.7282; train_chrom_access_recon_loss: 9463700.7424; train_global_loss: 23285582.2727; train_optim_loss: 23285582.2727; val_kl_reg_loss: 68777.2344; val_edge_recon_loss: 2730837.5000; val_gene_expr_recon_loss: 10917410.5000; val_masked_gp_l1_reg_loss: 118590.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59368.4609; val_chrom_access_recon_loss: 9300288.5000; val_global_loss: 23195273.0000; val_optim_loss: 23195273.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9357; val_auprc_score: 0.9054; val_best_acc_score: 0.8783; val_best_f1_score: 0.8849; train_kl_reg_loss: 77180.5472; train_edge_recon_loss: 2712661.2045; train_gene_expr_recon_loss: 10853167.5455; train_masked_gp_l1_reg_loss: 118550.1809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59268.5475; train_chrom_access_recon_loss: 9458596.1818; train_global_loss: 23279424.4545; train_optim_loss: 23279424.4545; val_kl_reg_loss: 69713.9541; val_edge_recon_loss: 2750935.2812; val_gene_expr_recon_loss: 10938183.0000; val_masked_gp_l1_reg_loss: 118492.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59165.7266; val_chrom_access_recon_loss: 9385799.2500; val_global_loss: 23322289.2500; val_optim_loss: 23322289.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9389; val_auprc_score: 0.9125; val_best_acc_score: 0.8796; val_best_f1_score: 0.8866; train_kl_reg_loss: 77503.7886; train_edge_recon_loss: 2715692.9545; train_gene_expr_recon_loss: 10842224.4697; train_masked_gp_l1_reg_loss: 118440.5178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59067.4240; train_chrom_access_recon_loss: 9447000.7879; train_global_loss: 23259929.9697; train_optim_loss: 23259929.9697; val_kl_reg_loss: 70149.9082; val_edge_recon_loss: 2759052.6562; val_gene_expr_recon_loss: 10889549.0000; val_masked_gp_l1_reg_loss: 118376.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58995.3906; val_chrom_access_recon_loss: 9290043.2500; val_global_loss: 23186166.5000; val_optim_loss: 23186166.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9325; val_auprc_score: 0.9073; val_best_acc_score: 0.8697; val_best_f1_score: 0.8785; train_kl_reg_loss: 78056.1610; train_edge_recon_loss: 2705001.9962; train_gene_expr_recon_loss: 10841284.9394; train_masked_gp_l1_reg_loss: 118317.7330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58816.7627; train_chrom_access_recon_loss: 9451513.7121; train_global_loss: 23252991.3939; train_optim_loss: 23252991.3939; val_kl_reg_loss: 70259.2275; val_edge_recon_loss: 2781475.5312; val_gene_expr_recon_loss: 10973290.0000; val_masked_gp_l1_reg_loss: 118283.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58745.8789; val_chrom_access_recon_loss: 9382996.5000; val_global_loss: 23385051.0000; val_optim_loss: 23385051.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9415; val_auprc_score: 0.9216; val_best_acc_score: 0.8845; val_best_f1_score: 0.8885; train_kl_reg_loss: 77584.8196; train_edge_recon_loss: 2719106.2538; train_gene_expr_recon_loss: 10850782.5455; train_masked_gp_l1_reg_loss: 118210.8800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58655.3230; train_chrom_access_recon_loss: 9471243.7424; train_global_loss: 23295583.6667; train_optim_loss: 23295583.6667; val_kl_reg_loss: 70130.1436; val_edge_recon_loss: 2758769.6875; val_gene_expr_recon_loss: 10951479.6250; val_masked_gp_l1_reg_loss: 118160.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58608.5977; val_chrom_access_recon_loss: 9470023.8750; val_global_loss: 23427172.7500; val_optim_loss: 23427172.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9349; val_auprc_score: 0.9061; val_best_acc_score: 0.8780; val_best_f1_score: 0.8846; train_kl_reg_loss: 77748.3503; train_edge_recon_loss: 2709034.9697; train_gene_expr_recon_loss: 10846898.3030; train_masked_gp_l1_reg_loss: 118128.8388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58520.3240; train_chrom_access_recon_loss: 9452569.5909; train_global_loss: 23262900.3636; train_optim_loss: 23262900.3636; val_kl_reg_loss: 69972.8213; val_edge_recon_loss: 2762335.7188; val_gene_expr_recon_loss: 10878757.8750; val_masked_gp_l1_reg_loss: 118077.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58392.6172; val_chrom_access_recon_loss: 9296118.8750; val_global_loss: 23183655.5000; val_optim_loss: 23183655.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9326; val_auprc_score: 0.9106; val_best_acc_score: 0.8726; val_best_f1_score: 0.8816; train_kl_reg_loss: 78196.4188; train_edge_recon_loss: 2715465.8333; train_gene_expr_recon_loss: 10850227.8636; train_masked_gp_l1_reg_loss: 118019.6985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58340.9147; train_chrom_access_recon_loss: 9455359.1061; train_global_loss: 23275609.9091; train_optim_loss: 23275609.9091; val_kl_reg_loss: 71075.3760; val_edge_recon_loss: 2778125.6250; val_gene_expr_recon_loss: 10789903.7500; val_masked_gp_l1_reg_loss: 117959.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58242.7188; val_chrom_access_recon_loss: 9231679.5000; val_global_loss: 23046987.2500; val_optim_loss: 23046987.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9434; val_auprc_score: 0.9249; val_best_acc_score: 0.8837; val_best_f1_score: 0.8883; train_kl_reg_loss: 78702.1355; train_edge_recon_loss: 2708649.7197; train_gene_expr_recon_loss: 10839403.2576; train_masked_gp_l1_reg_loss: 117911.3335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58120.6992; train_chrom_access_recon_loss: 9448245.6364; train_global_loss: 23251032.6061; train_optim_loss: 23251032.6061; val_kl_reg_loss: 71260.2451; val_edge_recon_loss: 2747803.6562; val_gene_expr_recon_loss: 10792321.3750; val_masked_gp_l1_reg_loss: 117851.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58021.2578; val_chrom_access_recon_loss: 9291459.5000; val_global_loss: 23078717.5000; val_optim_loss: 23078717.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9408; val_auprc_score: 0.9161; val_best_acc_score: 0.8834; val_best_f1_score: 0.8878; train_kl_reg_loss: 78485.4110; train_edge_recon_loss: 2711042.0606; train_gene_expr_recon_loss: 10834310.1061; train_masked_gp_l1_reg_loss: 117800.0651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57889.0233; train_chrom_access_recon_loss: 9450108.6818; train_global_loss: 23249635.0303; train_optim_loss: 23249635.0303; val_kl_reg_loss: 70998.0078; val_edge_recon_loss: 2751771.0625; val_gene_expr_recon_loss: 10867853.0000; val_masked_gp_l1_reg_loss: 117741.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57792.6484; val_chrom_access_recon_loss: 9416348.7500; val_global_loss: 23282506.0000; val_optim_loss: 23282506.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9362; val_auprc_score: 0.9117; val_best_acc_score: 0.8810; val_best_f1_score: 0.8878; train_kl_reg_loss: 78323.6587; train_edge_recon_loss: 2717487.3295; train_gene_expr_recon_loss: 10844352.9697; train_masked_gp_l1_reg_loss: 117672.6638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57788.1609; train_chrom_access_recon_loss: 9456060.1364; train_global_loss: 23271684.8182; train_optim_loss: 23271684.8182; val_kl_reg_loss: 72023.0469; val_edge_recon_loss: 2766648.9062; val_gene_expr_recon_loss: 10893619.0000; val_masked_gp_l1_reg_loss: 117616.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57727.1328; val_chrom_access_recon_loss: 9318552.0000; val_global_loss: 23226187.2500; val_optim_loss: 23226187.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9395; val_auprc_score: 0.9180; val_best_acc_score: 0.8807; val_best_f1_score: 0.8877; train_kl_reg_loss: 78311.3294; train_edge_recon_loss: 2708795.4129; train_gene_expr_recon_loss: 10819277.1212; train_masked_gp_l1_reg_loss: 117563.3310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57631.2911; train_chrom_access_recon_loss: 9431960.5000; train_global_loss: 23213538.9091; train_optim_loss: 23213538.9091; val_kl_reg_loss: 71280.6660; val_edge_recon_loss: 2753429.8438; val_gene_expr_recon_loss: 10757568.3750; val_masked_gp_l1_reg_loss: 117511.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57499.6875; val_chrom_access_recon_loss: 9312362.0000; val_global_loss: 23069651.7500; val_optim_loss: 23069651.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9450; val_auprc_score: 0.9205; val_best_acc_score: 0.8909; val_best_f1_score: 0.8964; train_kl_reg_loss: 78297.8195; train_edge_recon_loss: 2703573.4318; train_gene_expr_recon_loss: 10838428.9394; train_masked_gp_l1_reg_loss: 117198.6506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56175.3807; train_chrom_access_recon_loss: 9450152.9697; train_global_loss: 23243827.1818; train_optim_loss: 23243827.1818; val_kl_reg_loss: 71292.1982; val_edge_recon_loss: 2722850.6562; val_gene_expr_recon_loss: 10914027.2500; val_masked_gp_l1_reg_loss: 117093.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55919.8164; val_chrom_access_recon_loss: 9335056.5000; val_global_loss: 23216240.0000; val_optim_loss: 23216240.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9488; val_auprc_score: 0.9345; val_best_acc_score: 0.8858; val_best_f1_score: 0.8919; train_kl_reg_loss: 78289.5429; train_edge_recon_loss: 2714115.5833; train_gene_expr_recon_loss: 10843006.1364; train_masked_gp_l1_reg_loss: 117065.8355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55890.6676; train_chrom_access_recon_loss: 9454759.2273; train_global_loss: 23263127.0606; train_optim_loss: 23263127.0606; val_kl_reg_loss: 71227.2275; val_edge_recon_loss: 2753046.1562; val_gene_expr_recon_loss: 10844299.2500; val_masked_gp_l1_reg_loss: 117045.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55869.0625; val_chrom_access_recon_loss: 9297089.8750; val_global_loss: 23138576.7500; val_optim_loss: 23138576.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9386; val_auprc_score: 0.9062; val_best_acc_score: 0.8866; val_best_f1_score: 0.8918; train_kl_reg_loss: 78087.3574; train_edge_recon_loss: 2706388.0038; train_gene_expr_recon_loss: 10838503.4848; train_masked_gp_l1_reg_loss: 117032.7591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55849.3391; train_chrom_access_recon_loss: 9443867.0000; train_global_loss: 23239727.9697; train_optim_loss: 23239727.9697; val_kl_reg_loss: 71618.2383; val_edge_recon_loss: 2719830.1562; val_gene_expr_recon_loss: 10805030.1250; val_masked_gp_l1_reg_loss: 117018.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55830.3359; val_chrom_access_recon_loss: 9237332.2500; val_global_loss: 23006659.5000; val_optim_loss: 23006659.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9449; val_auprc_score: 0.9274; val_best_acc_score: 0.8842; val_best_f1_score: 0.8905; train_kl_reg_loss: 78107.4355; train_edge_recon_loss: 2712397.2538; train_gene_expr_recon_loss: 10832184.1818; train_masked_gp_l1_reg_loss: 117010.1465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55818.6610; train_chrom_access_recon_loss: 9443374.2121; train_global_loss: 23238891.8182; train_optim_loss: 23238891.8182; val_kl_reg_loss: 71430.4189; val_edge_recon_loss: 2752453.7812; val_gene_expr_recon_loss: 10794726.8750; val_masked_gp_l1_reg_loss: 116999.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55802.8320; val_chrom_access_recon_loss: 9324092.2500; val_global_loss: 23115505.2500; val_optim_loss: 23115505.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9433; val_auprc_score: 0.9245; val_best_acc_score: 0.8853; val_best_f1_score: 0.8926; train_kl_reg_loss: 78512.0208; train_edge_recon_loss: 2706930.0417; train_gene_expr_recon_loss: 10841231.0000; train_masked_gp_l1_reg_loss: 116990.3904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55787.8956; train_chrom_access_recon_loss: 9457645.4394; train_global_loss: 23257096.6364; train_optim_loss: 23257096.6364; val_kl_reg_loss: 71283.3184; val_edge_recon_loss: 2740053.8438; val_gene_expr_recon_loss: 10756692.3750; val_masked_gp_l1_reg_loss: 116984.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55782.6992; val_chrom_access_recon_loss: 9244663.5000; val_global_loss: 22985459.5000; val_optim_loss: 22985459.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9482; val_auprc_score: 0.9319; val_best_acc_score: 0.8915; val_best_f1_score: 0.8958; train_kl_reg_loss: 78302.9728; train_edge_recon_loss: 2717097.2235; train_gene_expr_recon_loss: 10833413.0152; train_masked_gp_l1_reg_loss: 116974.3280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55768.9703; train_chrom_access_recon_loss: 9440405.0455; train_global_loss: 23241961.6364; train_optim_loss: 23241961.6364; val_kl_reg_loss: 71829.9307; val_edge_recon_loss: 2728590.0938; val_gene_expr_recon_loss: 10879077.6250; val_masked_gp_l1_reg_loss: 116965.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55758.5312; val_chrom_access_recon_loss: 9301293.3750; val_global_loss: 23153514.7500; val_optim_loss: 23153514.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9406; val_auprc_score: 0.9163; val_best_acc_score: 0.8815; val_best_f1_score: 0.8887; train_kl_reg_loss: 78121.0188; train_edge_recon_loss: 2707987.0303; train_gene_expr_recon_loss: 10833808.5606; train_masked_gp_l1_reg_loss: 116958.5992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55746.5373; train_chrom_access_recon_loss: 9443333.6818; train_global_loss: 23235955.4242; train_optim_loss: 23235955.4242; val_kl_reg_loss: 71840.3184; val_edge_recon_loss: 2734038.1562; val_gene_expr_recon_loss: 10937342.3750; val_masked_gp_l1_reg_loss: 116952.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55733.4727; val_chrom_access_recon_loss: 9371622.0000; val_global_loss: 23287527.7500; val_optim_loss: 23287527.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9360; val_auprc_score: 0.9054; val_best_acc_score: 0.8791; val_best_f1_score: 0.8863; train_kl_reg_loss: 78199.2786; train_edge_recon_loss: 2707369.2614; train_gene_expr_recon_loss: 10842813.8485; train_masked_gp_l1_reg_loss: 116944.8774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55725.9502; train_chrom_access_recon_loss: 9446067.3182; train_global_loss: 23247120.5152; train_optim_loss: 23247120.5152; val_kl_reg_loss: 71540.6143; val_edge_recon_loss: 2770743.6562; val_gene_expr_recon_loss: 10855201.8750; val_masked_gp_l1_reg_loss: 116938.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55712.8477; val_chrom_access_recon_loss: 9314852.7500; val_global_loss: 23184990.5000; val_optim_loss: 23184990.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9440; val_auprc_score: 0.9198; val_best_acc_score: 0.8896; val_best_f1_score: 0.8942; train_kl_reg_loss: 78204.3958; train_edge_recon_loss: 2715407.4621; train_gene_expr_recon_loss: 10833235.3636; train_masked_gp_l1_reg_loss: 116930.3165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55702.7480; train_chrom_access_recon_loss: 9452662.3182; train_global_loss: 23252142.6667; train_optim_loss: 23252142.6667; val_kl_reg_loss: 71831.5205; val_edge_recon_loss: 2740515.2812; val_gene_expr_recon_loss: 10784048.1250; val_masked_gp_l1_reg_loss: 116924.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55696.5312; val_chrom_access_recon_loss: 9243989.8750; val_global_loss: 23013006.7500; val_optim_loss: 23013006.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9435; val_auprc_score: 0.9200; val_best_acc_score: 0.8853; val_best_f1_score: 0.8914; train_kl_reg_loss: 78262.3361; train_edge_recon_loss: 2708508.4924; train_gene_expr_recon_loss: 10830796.9697; train_masked_gp_l1_reg_loss: 116892.4250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55558.5792; train_chrom_access_recon_loss: 9444744.2879; train_global_loss: 23234762.9091; train_optim_loss: 23234762.9091; val_kl_reg_loss: 70881.5068; val_edge_recon_loss: 2749208.5000; val_gene_expr_recon_loss: 10788613.6250; val_masked_gp_l1_reg_loss: 116881.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55532.3086; val_chrom_access_recon_loss: 9225489.5000; val_global_loss: 23006606.0000; val_optim_loss: 23006606.0000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9418; val_auprc_score: 0.9183; val_best_acc_score: 0.8794; val_best_f1_score: 0.8863; train_kl_reg_loss: 78342.8346; train_edge_recon_loss: 2705805.8333; train_gene_expr_recon_loss: 10820710.2879; train_masked_gp_l1_reg_loss: 116877.9222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55529.6371; train_chrom_access_recon_loss: 9446584.7121; train_global_loss: 23223851.4545; train_optim_loss: 23223851.4545; val_kl_reg_loss: 71509.2715; val_edge_recon_loss: 2740097.3750; val_gene_expr_recon_loss: 10806446.8750; val_masked_gp_l1_reg_loss: 116875.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55527.5547; val_chrom_access_recon_loss: 9310424.6250; val_global_loss: 23100882.2500; val_optim_loss: 23100882.2500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9437; val_auprc_score: 0.9149; val_best_acc_score: 0.8907; val_best_f1_score: 0.8960; train_kl_reg_loss: 78212.2324; train_edge_recon_loss: 2698258.4318; train_gene_expr_recon_loss: 10820241.2576; train_masked_gp_l1_reg_loss: 116873.8397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55525.7717; train_chrom_access_recon_loss: 9439194.3788; train_global_loss: 23208305.8788; train_optim_loss: 23208305.8788; val_kl_reg_loss: 71568.7207; val_edge_recon_loss: 2709259.0938; val_gene_expr_recon_loss: 10787861.7500; val_masked_gp_l1_reg_loss: 116872.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55523.6367; val_chrom_access_recon_loss: 9270719.0000; val_global_loss: 23011804.7500; val_optim_loss: 23011804.7500
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9345; val_auprc_score: 0.9041; val_best_acc_score: 0.8788; val_best_f1_score: 0.8842; train_kl_reg_loss: 78287.4421; train_edge_recon_loss: 2714068.0492; train_gene_expr_recon_loss: 10824254.9394; train_masked_gp_l1_reg_loss: 116870.5838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55522.5656; train_chrom_access_recon_loss: 9449194.3030; train_global_loss: 23238198.1515; train_optim_loss: 23238198.1515; val_kl_reg_loss: 71873.7178; val_edge_recon_loss: 2767666.1875; val_gene_expr_recon_loss: 10827740.8750; val_masked_gp_l1_reg_loss: 116869.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55520.9062; val_chrom_access_recon_loss: 9358171.3750; val_global_loss: 23197842.2500; val_optim_loss: 23197842.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 20 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9433
val AUPRC score: 0.9110
val best accuracy score: 0.8880
val best F1 score: 0.8930
val target rna MSE score: 2.1094
val source rna MSE score: 1.0008
val target atac MSE score: 0.3127
val source atac MSE score: 0.1304
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
