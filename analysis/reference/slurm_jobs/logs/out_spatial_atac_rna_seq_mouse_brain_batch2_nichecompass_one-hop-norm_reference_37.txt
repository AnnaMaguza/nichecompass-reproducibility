[True]
Run timestamp: 09102023_210816_37.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_37']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7769; val_auprc_score: 0.7898; val_best_acc_score: 0.6893; val_best_f1_score: 0.7127; train_kl_reg_loss: 67145.4425; train_edge_recon_loss: 3500152.9924; train_gene_expr_recon_loss: 13254202.2137; train_masked_gp_l1_reg_loss: 34057.3975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2424922.0854; train_chrom_access_recon_loss: 2232559.2786; train_global_loss: 21513039.3435; train_optim_loss: 21513039.3435; val_kl_reg_loss: 90559.7823; val_edge_recon_loss: 4036091.9167; val_gene_expr_recon_loss: 12840324.0000; val_masked_gp_l1_reg_loss: 40841.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 589358.5625; val_chrom_access_recon_loss: 2207167.0583; val_global_loss: 19804342.8000; val_optim_loss: 19804342.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8039; val_auprc_score: 0.8073; val_best_acc_score: 0.7144; val_best_f1_score: 0.7466; train_kl_reg_loss: 81219.4441; train_edge_recon_loss: 3315486.3683; train_gene_expr_recon_loss: 12556242.6794; train_masked_gp_l1_reg_loss: 44328.1763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 304969.1925; train_chrom_access_recon_loss: 2160895.2672; train_global_loss: 18463141.1145; train_optim_loss: 18463141.1145; val_kl_reg_loss: 103357.2333; val_edge_recon_loss: 3244135.4000; val_gene_expr_recon_loss: 12698411.3333; val_masked_gp_l1_reg_loss: 48015.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 170417.3906; val_chrom_access_recon_loss: 2176424.5000; val_global_loss: 18440761.3333; val_optim_loss: 18440761.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8485; val_auprc_score: 0.8515; val_best_acc_score: 0.7555; val_best_f1_score: 0.7747; train_kl_reg_loss: 94322.9682; train_edge_recon_loss: 3084649.7595; train_gene_expr_recon_loss: 12407426.2366; train_masked_gp_l1_reg_loss: 50720.7893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135238.6486; train_chrom_access_recon_loss: 2136968.8550; train_global_loss: 17909327.2519; train_optim_loss: 17909327.2519; val_kl_reg_loss: 89814.9677; val_edge_recon_loss: 3051715.6500; val_gene_expr_recon_loss: 12524008.3333; val_masked_gp_l1_reg_loss: 53455.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115314.3828; val_chrom_access_recon_loss: 2148626.0583; val_global_loss: 17982935.0667; val_optim_loss: 17982935.0667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9183; val_auprc_score: 0.9036; val_best_acc_score: 0.8418; val_best_f1_score: 0.8524; train_kl_reg_loss: 90251.4036; train_edge_recon_loss: 2884070.8302; train_gene_expr_recon_loss: 12245380.7786; train_masked_gp_l1_reg_loss: 56589.5564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107279.4392; train_chrom_access_recon_loss: 2112650.7920; train_global_loss: 17496222.7939; train_optim_loss: 17496222.7939; val_kl_reg_loss: 94769.9089; val_edge_recon_loss: 2839947.2333; val_gene_expr_recon_loss: 12375894.0000; val_masked_gp_l1_reg_loss: 59200.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99087.6719; val_chrom_access_recon_loss: 2127683.9333; val_global_loss: 17596583.0667; val_optim_loss: 17596583.0667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9347; val_auprc_score: 0.9213; val_best_acc_score: 0.8681; val_best_f1_score: 0.8758; train_kl_reg_loss: 93281.9827; train_edge_recon_loss: 2775091.0840; train_gene_expr_recon_loss: 12113481.3053; train_masked_gp_l1_reg_loss: 60958.0820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91333.6286; train_chrom_access_recon_loss: 2091385.5916; train_global_loss: 17225531.7863; train_optim_loss: 17225531.7863; val_kl_reg_loss: 90317.1620; val_edge_recon_loss: 2784846.6500; val_gene_expr_recon_loss: 12218439.2667; val_masked_gp_l1_reg_loss: 62597.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85217.5078; val_chrom_access_recon_loss: 2098834.2083; val_global_loss: 17340253.4000; val_optim_loss: 17340253.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9323; val_auprc_score: 0.9181; val_best_acc_score: 0.8636; val_best_f1_score: 0.8732; train_kl_reg_loss: 88443.9473; train_edge_recon_loss: 2760473.9370; train_gene_expr_recon_loss: 12012298.9084; train_masked_gp_l1_reg_loss: 63867.2836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81228.7193; train_chrom_access_recon_loss: 2076945.9628; train_global_loss: 17083258.8168; train_optim_loss: 17083258.8168; val_kl_reg_loss: 90559.6505; val_edge_recon_loss: 2784069.4833; val_gene_expr_recon_loss: 12140235.6000; val_masked_gp_l1_reg_loss: 65155.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77982.4375; val_chrom_access_recon_loss: 2087788.8833; val_global_loss: 17245790.3333; val_optim_loss: 17245790.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9384; val_auprc_score: 0.9220; val_best_acc_score: 0.8742; val_best_f1_score: 0.8804; train_kl_reg_loss: 85891.0461; train_edge_recon_loss: 2750518.3053; train_gene_expr_recon_loss: 11936772.8092; train_masked_gp_l1_reg_loss: 66073.5576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75762.9624; train_chrom_access_recon_loss: 2062153.6288; train_global_loss: 16977172.2519; train_optim_loss: 16977172.2519; val_kl_reg_loss: 82559.7297; val_edge_recon_loss: 2773967.8333; val_gene_expr_recon_loss: 12117406.6667; val_masked_gp_l1_reg_loss: 67026.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73973.5781; val_chrom_access_recon_loss: 2085927.8333; val_global_loss: 17200862.2667; val_optim_loss: 17200862.2667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9452; val_auprc_score: 0.9332; val_best_acc_score: 0.8855; val_best_f1_score: 0.8918; train_kl_reg_loss: 82263.1375; train_edge_recon_loss: 2739836.0573; train_gene_expr_recon_loss: 11864325.8855; train_masked_gp_l1_reg_loss: 67931.8364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72240.0237; train_chrom_access_recon_loss: 2051080.3588; train_global_loss: 16877677.3359; train_optim_loss: 16877677.3359; val_kl_reg_loss: 77069.1115; val_edge_recon_loss: 2760526.6333; val_gene_expr_recon_loss: 11983601.0000; val_masked_gp_l1_reg_loss: 68651.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71038.0391; val_chrom_access_recon_loss: 2054604.0000; val_global_loss: 17015490.8000; val_optim_loss: 17015490.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9521; val_auprc_score: 0.9413; val_best_acc_score: 0.8910; val_best_f1_score: 0.8970; train_kl_reg_loss: 79137.8162; train_edge_recon_loss: 2728724.5630; train_gene_expr_recon_loss: 11786553.8321; train_masked_gp_l1_reg_loss: 69440.5143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70235.5615; train_chrom_access_recon_loss: 2036647.3731; train_global_loss: 16770739.7939; train_optim_loss: 16770739.7939; val_kl_reg_loss: 81161.2672; val_edge_recon_loss: 2738657.5833; val_gene_expr_recon_loss: 11940380.5333; val_masked_gp_l1_reg_loss: 70183.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70864.9141; val_chrom_access_recon_loss: 2056774.8250; val_global_loss: 16958023.2000; val_optim_loss: 16958023.2000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9584; val_auprc_score: 0.9482; val_best_acc_score: 0.8963; val_best_f1_score: 0.9012; train_kl_reg_loss: 78867.1290; train_edge_recon_loss: 2724950.4714; train_gene_expr_recon_loss: 11736390.7939; train_masked_gp_l1_reg_loss: 70673.0661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71221.9024; train_chrom_access_recon_loss: 2027734.4771; train_global_loss: 16709837.7557; train_optim_loss: 16709837.7557; val_kl_reg_loss: 79146.7312; val_edge_recon_loss: 2719691.4667; val_gene_expr_recon_loss: 11872308.9333; val_masked_gp_l1_reg_loss: 71108.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71997.4922; val_chrom_access_recon_loss: 2045407.4000; val_global_loss: 16859660.5333; val_optim_loss: 16859660.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9568; val_auprc_score: 0.9451; val_best_acc_score: 0.8987; val_best_f1_score: 0.9041; train_kl_reg_loss: 76764.6576; train_edge_recon_loss: 2721085.8111; train_gene_expr_recon_loss: 11671071.7939; train_masked_gp_l1_reg_loss: 71566.1075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71833.1042; train_chrom_access_recon_loss: 2015714.7929; train_global_loss: 16628036.2748; train_optim_loss: 16628036.2748; val_kl_reg_loss: 77683.9115; val_edge_recon_loss: 2728093.1167; val_gene_expr_recon_loss: 11829134.6000; val_masked_gp_l1_reg_loss: 72047.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72308.7188; val_chrom_access_recon_loss: 2034775.5333; val_global_loss: 16814043.0000; val_optim_loss: 16814043.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9602; val_auprc_score: 0.9510; val_best_acc_score: 0.8999; val_best_f1_score: 0.9049; train_kl_reg_loss: 74058.7911; train_edge_recon_loss: 2707196.1813; train_gene_expr_recon_loss: 11626196.0458; train_masked_gp_l1_reg_loss: 72439.2417; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71404.6262; train_chrom_access_recon_loss: 2009363.9094; train_global_loss: 16560658.8168; train_optim_loss: 16560658.8168; val_kl_reg_loss: 76051.6193; val_edge_recon_loss: 2716418.6167; val_gene_expr_recon_loss: 11769517.0000; val_masked_gp_l1_reg_loss: 72770.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70260.2266; val_chrom_access_recon_loss: 2029958.9667; val_global_loss: 16734976.1333; val_optim_loss: 16734976.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9611; val_auprc_score: 0.9502; val_best_acc_score: 0.9061; val_best_f1_score: 0.9107; train_kl_reg_loss: 73484.9920; train_edge_recon_loss: 2706255.9714; train_gene_expr_recon_loss: 11590335.0992; train_masked_gp_l1_reg_loss: 73108.2343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70611.3931; train_chrom_access_recon_loss: 2002433.9198; train_global_loss: 16516229.6336; train_optim_loss: 16516229.6336; val_kl_reg_loss: 71541.9818; val_edge_recon_loss: 2730028.2500; val_gene_expr_recon_loss: 11742843.6000; val_masked_gp_l1_reg_loss: 73567.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70659.8125; val_chrom_access_recon_loss: 2026022.8583; val_global_loss: 16714665.0667; val_optim_loss: 16714665.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9604; val_auprc_score: 0.9473; val_best_acc_score: 0.9056; val_best_f1_score: 0.9095; train_kl_reg_loss: 73475.1707; train_edge_recon_loss: 2695317.2844; train_gene_expr_recon_loss: 11542033.1069; train_masked_gp_l1_reg_loss: 73786.6021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69942.2997; train_chrom_access_recon_loss: 1991121.4933; train_global_loss: 16445675.9466; train_optim_loss: 16445675.9466; val_kl_reg_loss: 73162.3094; val_edge_recon_loss: 2713185.3167; val_gene_expr_recon_loss: 11692248.6667; val_masked_gp_l1_reg_loss: 74093.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70489.3906; val_chrom_access_recon_loss: 2013529.9917; val_global_loss: 16636709.2000; val_optim_loss: 16636709.2000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9645; val_auprc_score: 0.9542; val_best_acc_score: 0.9105; val_best_f1_score: 0.9139; train_kl_reg_loss: 71907.1405; train_edge_recon_loss: 2696761.3760; train_gene_expr_recon_loss: 11506496.7786; train_masked_gp_l1_reg_loss: 74380.2688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70089.4744; train_chrom_access_recon_loss: 1985831.7357; train_global_loss: 16405466.7405; train_optim_loss: 16405466.7405; val_kl_reg_loss: 72509.0052; val_edge_recon_loss: 2700131.4667; val_gene_expr_recon_loss: 11673092.5333; val_masked_gp_l1_reg_loss: 74647.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70257.8359; val_chrom_access_recon_loss: 1999063.4417; val_global_loss: 16589702.4000; val_optim_loss: 16589702.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9675; val_auprc_score: 0.9605; val_best_acc_score: 0.9104; val_best_f1_score: 0.9135; train_kl_reg_loss: 71528.9993; train_edge_recon_loss: 2692949.5324; train_gene_expr_recon_loss: 11483414.0992; train_masked_gp_l1_reg_loss: 74899.3300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70056.3437; train_chrom_access_recon_loss: 1980406.9361; train_global_loss: 16373255.2137; train_optim_loss: 16373255.2137; val_kl_reg_loss: 69824.4010; val_edge_recon_loss: 2715977.6500; val_gene_expr_recon_loss: 11704862.0667; val_masked_gp_l1_reg_loss: 75119.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70282.6797; val_chrom_access_recon_loss: 2010854.7333; val_global_loss: 16646920.7333; val_optim_loss: 16646920.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9673; val_auprc_score: 0.9586; val_best_acc_score: 0.9150; val_best_f1_score: 0.9179; train_kl_reg_loss: 70593.1346; train_edge_recon_loss: 2696812.2118; train_gene_expr_recon_loss: 11453089.7710; train_masked_gp_l1_reg_loss: 75311.6677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70258.3826; train_chrom_access_recon_loss: 1974913.8111; train_global_loss: 16340979.0916; train_optim_loss: 16340979.0916; val_kl_reg_loss: 69975.8120; val_edge_recon_loss: 2707048.4167; val_gene_expr_recon_loss: 11631359.5333; val_masked_gp_l1_reg_loss: 75344.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70284.9531; val_chrom_access_recon_loss: 1992073.6500; val_global_loss: 16546086.4667; val_optim_loss: 16546086.4667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9667; val_auprc_score: 0.9542; val_best_acc_score: 0.9157; val_best_f1_score: 0.9189; train_kl_reg_loss: 69882.0427; train_edge_recon_loss: 2694028.5763; train_gene_expr_recon_loss: 11412246.7176; train_masked_gp_l1_reg_loss: 75520.6877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70013.1279; train_chrom_access_recon_loss: 1967393.4036; train_global_loss: 16289084.6183; train_optim_loss: 16289084.6183; val_kl_reg_loss: 69794.4948; val_edge_recon_loss: 2703555.3000; val_gene_expr_recon_loss: 11604678.0667; val_masked_gp_l1_reg_loss: 75686.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70808.8984; val_chrom_access_recon_loss: 1990695.6583; val_global_loss: 16515219.7333; val_optim_loss: 16515219.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9680; val_auprc_score: 0.9552; val_best_acc_score: 0.9204; val_best_f1_score: 0.9236; train_kl_reg_loss: 69143.1297; train_edge_recon_loss: 2687623.4847; train_gene_expr_recon_loss: 11408888.3893; train_masked_gp_l1_reg_loss: 75663.5995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70197.2538; train_chrom_access_recon_loss: 1965827.6355; train_global_loss: 16277343.5115; train_optim_loss: 16277343.5115; val_kl_reg_loss: 69964.5016; val_edge_recon_loss: 2692552.7500; val_gene_expr_recon_loss: 11562670.7333; val_masked_gp_l1_reg_loss: 75820.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70402.6328; val_chrom_access_recon_loss: 1983408.7333; val_global_loss: 16454820.8000; val_optim_loss: 16454820.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9701; val_auprc_score: 0.9596; val_best_acc_score: 0.9185; val_best_f1_score: 0.9217; train_kl_reg_loss: 68193.1514; train_edge_recon_loss: 2683772.4599; train_gene_expr_recon_loss: 11378431.2366; train_masked_gp_l1_reg_loss: 75921.7135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70131.7940; train_chrom_access_recon_loss: 1958660.2739; train_global_loss: 16235110.8244; train_optim_loss: 16235110.8244; val_kl_reg_loss: 69705.6292; val_edge_recon_loss: 2683595.8167; val_gene_expr_recon_loss: 11592046.2667; val_masked_gp_l1_reg_loss: 76062.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70214.0156; val_chrom_access_recon_loss: 1989021.4667; val_global_loss: 16480645.1333; val_optim_loss: 16480645.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9705; val_auprc_score: 0.9614; val_best_acc_score: 0.9219; val_best_f1_score: 0.9244; train_kl_reg_loss: 67958.9493; train_edge_recon_loss: 2681114.4294; train_gene_expr_recon_loss: 11358526.6718; train_masked_gp_l1_reg_loss: 76031.2578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70381.6191; train_chrom_access_recon_loss: 1954656.3254; train_global_loss: 16208669.1908; train_optim_loss: 16208669.1908; val_kl_reg_loss: 65506.7172; val_edge_recon_loss: 2704280.4667; val_gene_expr_recon_loss: 11547543.5333; val_masked_gp_l1_reg_loss: 76220.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70405.4688; val_chrom_access_recon_loss: 1971965.5917; val_global_loss: 16435922.4000; val_optim_loss: 16435922.4000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9730; val_auprc_score: 0.9660; val_best_acc_score: 0.9274; val_best_f1_score: 0.9298; train_kl_reg_loss: 66893.4265; train_edge_recon_loss: 2678823.3454; train_gene_expr_recon_loss: 11341572.7252; train_masked_gp_l1_reg_loss: 76133.9382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70568.7077; train_chrom_access_recon_loss: 1950819.5926; train_global_loss: 16184811.7557; train_optim_loss: 16184811.7557; val_kl_reg_loss: 69119.8214; val_edge_recon_loss: 2687081.1000; val_gene_expr_recon_loss: 11506591.0000; val_masked_gp_l1_reg_loss: 76260.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71007.7031; val_chrom_access_recon_loss: 1977480.8833; val_global_loss: 16387541.9333; val_optim_loss: 16387541.9333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9733; val_auprc_score: 0.9642; val_best_acc_score: 0.9263; val_best_f1_score: 0.9279; train_kl_reg_loss: 67185.6737; train_edge_recon_loss: 2669563.2462; train_gene_expr_recon_loss: 11318286.0229; train_masked_gp_l1_reg_loss: 76154.5847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70745.0631; train_chrom_access_recon_loss: 1945903.8950; train_global_loss: 16147838.5115; train_optim_loss: 16147838.5115; val_kl_reg_loss: 67549.1599; val_edge_recon_loss: 2689375.2667; val_gene_expr_recon_loss: 11505938.1333; val_masked_gp_l1_reg_loss: 76228.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71398.6484; val_chrom_access_recon_loss: 1976103.2750; val_global_loss: 16386593.4667; val_optim_loss: 16386593.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9725; val_auprc_score: 0.9637; val_best_acc_score: 0.9254; val_best_f1_score: 0.9278; train_kl_reg_loss: 66816.7402; train_edge_recon_loss: 2669244.8015; train_gene_expr_recon_loss: 11306364.0458; train_masked_gp_l1_reg_loss: 76198.1437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71027.4686; train_chrom_access_recon_loss: 1944507.6269; train_global_loss: 16134158.7863; train_optim_loss: 16134158.7863; val_kl_reg_loss: 66924.9312; val_edge_recon_loss: 2694141.1667; val_gene_expr_recon_loss: 11525329.7333; val_masked_gp_l1_reg_loss: 76252.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71312.2188; val_chrom_access_recon_loss: 1976582.2750; val_global_loss: 16410543.0667; val_optim_loss: 16410543.0667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9739; val_auprc_score: 0.9640; val_best_acc_score: 0.9314; val_best_f1_score: 0.9328; train_kl_reg_loss: 65854.1985; train_edge_recon_loss: 2677295.4008; train_gene_expr_recon_loss: 11292907.1908; train_masked_gp_l1_reg_loss: 76261.8748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71384.4757; train_chrom_access_recon_loss: 1941542.3578; train_global_loss: 16125245.4885; train_optim_loss: 16125245.4885; val_kl_reg_loss: 64014.9484; val_edge_recon_loss: 2684596.1333; val_gene_expr_recon_loss: 11408611.0000; val_masked_gp_l1_reg_loss: 76115.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71549.8750; val_chrom_access_recon_loss: 1949015.0167; val_global_loss: 16253902.2000; val_optim_loss: 16253902.2000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9732; val_auprc_score: 0.9632; val_best_acc_score: 0.9252; val_best_f1_score: 0.9277; train_kl_reg_loss: 65145.8436; train_edge_recon_loss: 2678209.6947; train_gene_expr_recon_loss: 11282946.9084; train_masked_gp_l1_reg_loss: 76163.4973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71571.3759; train_chrom_access_recon_loss: 1939117.0315; train_global_loss: 16113154.4275; train_optim_loss: 16113154.4275; val_kl_reg_loss: 67045.0432; val_edge_recon_loss: 2685326.8167; val_gene_expr_recon_loss: 11518550.0000; val_masked_gp_l1_reg_loss: 76112.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71676.2422; val_chrom_access_recon_loss: 1973097.0417; val_global_loss: 16391807.8000; val_optim_loss: 16391807.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9773; val_auprc_score: 0.9681; val_best_acc_score: 0.9369; val_best_f1_score: 0.9384; train_kl_reg_loss: 64854.7235; train_edge_recon_loss: 2668778.6393; train_gene_expr_recon_loss: 11266906.2443; train_masked_gp_l1_reg_loss: 76156.8550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71552.6481; train_chrom_access_recon_loss: 1935370.9866; train_global_loss: 16083620.0763; train_optim_loss: 16083620.0763; val_kl_reg_loss: 63392.9935; val_edge_recon_loss: 2673127.6167; val_gene_expr_recon_loss: 11390465.1333; val_masked_gp_l1_reg_loss: 76188.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71787.6250; val_chrom_access_recon_loss: 1949230.5333; val_global_loss: 16224193.2000; val_optim_loss: 16224193.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9766; val_auprc_score: 0.9679; val_best_acc_score: 0.9328; val_best_f1_score: 0.9347; train_kl_reg_loss: 65330.1718; train_edge_recon_loss: 2663750.7634; train_gene_expr_recon_loss: 11248199.6412; train_masked_gp_l1_reg_loss: 76173.3232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71684.2060; train_chrom_access_recon_loss: 1930757.7395; train_global_loss: 16055895.8244; train_optim_loss: 16055895.8244; val_kl_reg_loss: 64937.9703; val_edge_recon_loss: 2691747.8167; val_gene_expr_recon_loss: 11392792.0000; val_masked_gp_l1_reg_loss: 76098.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72383.4766; val_chrom_access_recon_loss: 1955724.6250; val_global_loss: 16253683.2000; val_optim_loss: 16253683.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9782; val_auprc_score: 0.9703; val_best_acc_score: 0.9360; val_best_f1_score: 0.9382; train_kl_reg_loss: 64784.2411; train_edge_recon_loss: 2666839.3836; train_gene_expr_recon_loss: 11235110.7863; train_masked_gp_l1_reg_loss: 75958.0904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71972.1724; train_chrom_access_recon_loss: 1928934.2853; train_global_loss: 16043598.9237; train_optim_loss: 16043598.9237; val_kl_reg_loss: 63395.1461; val_edge_recon_loss: 2676868.6500; val_gene_expr_recon_loss: 11375395.8667; val_masked_gp_l1_reg_loss: 75932.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72548.5781; val_chrom_access_recon_loss: 1946258.0250; val_global_loss: 16210399.5333; val_optim_loss: 16210399.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9794; val_auprc_score: 0.9725; val_best_acc_score: 0.9365; val_best_f1_score: 0.9387; train_kl_reg_loss: 64013.6955; train_edge_recon_loss: 2665466.1870; train_gene_expr_recon_loss: 11236113.6794; train_masked_gp_l1_reg_loss: 75854.5999; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72308.9733; train_chrom_access_recon_loss: 1928610.6737; train_global_loss: 16042367.8397; train_optim_loss: 16042367.8397; val_kl_reg_loss: 64579.9521; val_edge_recon_loss: 2691530.8833; val_gene_expr_recon_loss: 11401361.8000; val_masked_gp_l1_reg_loss: 75895.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73302.4297; val_chrom_access_recon_loss: 1945922.7667; val_global_loss: 16252592.5333; val_optim_loss: 16252592.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9799; val_auprc_score: 0.9735; val_best_acc_score: 0.9421; val_best_f1_score: 0.9435; train_kl_reg_loss: 64564.1356; train_edge_recon_loss: 2658736.0992; train_gene_expr_recon_loss: 11214712.6718; train_masked_gp_l1_reg_loss: 75758.1509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72657.5801; train_chrom_access_recon_loss: 1924442.9523; train_global_loss: 16010871.7023; train_optim_loss: 16010871.7023; val_kl_reg_loss: 65541.0906; val_edge_recon_loss: 2672153.6833; val_gene_expr_recon_loss: 11410320.4667; val_masked_gp_l1_reg_loss: 75455.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72446.1953; val_chrom_access_recon_loss: 1946706.0917; val_global_loss: 16242622.4000; val_optim_loss: 16242622.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9819; val_auprc_score: 0.9761; val_best_acc_score: 0.9418; val_best_f1_score: 0.9436; train_kl_reg_loss: 64489.8579; train_edge_recon_loss: 2660663.1489; train_gene_expr_recon_loss: 11218084.0458; train_masked_gp_l1_reg_loss: 75292.6469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72520.1644; train_chrom_access_recon_loss: 1923030.7844; train_global_loss: 16014080.7405; train_optim_loss: 16014080.7405; val_kl_reg_loss: 65901.3854; val_edge_recon_loss: 2665805.0000; val_gene_expr_recon_loss: 11409742.2667; val_masked_gp_l1_reg_loss: 75136.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72499.2266; val_chrom_access_recon_loss: 1959506.7583; val_global_loss: 16248590.3333; val_optim_loss: 16248590.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9833; val_auprc_score: 0.9777; val_best_acc_score: 0.9450; val_best_f1_score: 0.9468; train_kl_reg_loss: 64459.3451; train_edge_recon_loss: 2660746.1107; train_gene_expr_recon_loss: 11197312.6489; train_masked_gp_l1_reg_loss: 75005.8203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72596.7139; train_chrom_access_recon_loss: 1917500.6832; train_global_loss: 15987621.3435; train_optim_loss: 15987621.3435; val_kl_reg_loss: 66167.9266; val_edge_recon_loss: 2665145.3333; val_gene_expr_recon_loss: 11425337.5333; val_masked_gp_l1_reg_loss: 74810.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72558.7188; val_chrom_access_recon_loss: 1954579.4667; val_global_loss: 16258600.0667; val_optim_loss: 16258600.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9814; val_auprc_score: 0.9741; val_best_acc_score: 0.9415; val_best_f1_score: 0.9429; train_kl_reg_loss: 65162.0581; train_edge_recon_loss: 2660211.8034; train_gene_expr_recon_loss: 11175352.9847; train_masked_gp_l1_reg_loss: 73785.7703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57743.4297; train_chrom_access_recon_loss: 1914021.6221; train_global_loss: 15946277.7405; train_optim_loss: 15946277.7405; val_kl_reg_loss: 65567.2578; val_edge_recon_loss: 2672471.6000; val_gene_expr_recon_loss: 11373895.2667; val_masked_gp_l1_reg_loss: 73407.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55232.3633; val_chrom_access_recon_loss: 1945767.2250; val_global_loss: 16186341.4667; val_optim_loss: 16186341.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9811; val_auprc_score: 0.9762; val_best_acc_score: 0.9382; val_best_f1_score: 0.9396; train_kl_reg_loss: 65983.1993; train_edge_recon_loss: 2657217.0153; train_gene_expr_recon_loss: 11176416.6260; train_masked_gp_l1_reg_loss: 73320.9808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54706.8762; train_chrom_access_recon_loss: 1913839.3225; train_global_loss: 15941483.9618; train_optim_loss: 15941483.9618; val_kl_reg_loss: 66672.2594; val_edge_recon_loss: 2690125.7000; val_gene_expr_recon_loss: 11392867.9333; val_masked_gp_l1_reg_loss: 73272.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54337.6016; val_chrom_access_recon_loss: 1948418.8417; val_global_loss: 16225694.7333; val_optim_loss: 16225694.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9832; val_auprc_score: 0.9767; val_best_acc_score: 0.9442; val_best_f1_score: 0.9460; train_kl_reg_loss: 66528.8592; train_edge_recon_loss: 2657655.4981; train_gene_expr_recon_loss: 11176746.0992; train_masked_gp_l1_reg_loss: 73249.8289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54014.5854; train_chrom_access_recon_loss: 1912264.8721; train_global_loss: 15940459.7710; train_optim_loss: 15940459.7710; val_kl_reg_loss: 66576.0083; val_edge_recon_loss: 2672791.5000; val_gene_expr_recon_loss: 11364292.0667; val_masked_gp_l1_reg_loss: 73213.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53760.6367; val_chrom_access_recon_loss: 1938658.3083; val_global_loss: 16169293.0667; val_optim_loss: 16169293.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9816; val_auprc_score: 0.9745; val_best_acc_score: 0.9426; val_best_f1_score: 0.9438; train_kl_reg_loss: 66935.7587; train_edge_recon_loss: 2648705.3454; train_gene_expr_recon_loss: 11171943.7405; train_masked_gp_l1_reg_loss: 73192.3760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53495.5964; train_chrom_access_recon_loss: 1910040.0172; train_global_loss: 15924312.8626; train_optim_loss: 15924312.8626; val_kl_reg_loss: 67212.8109; val_edge_recon_loss: 2670642.7667; val_gene_expr_recon_loss: 11387922.4667; val_masked_gp_l1_reg_loss: 73178.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53325.0469; val_chrom_access_recon_loss: 1938209.6083; val_global_loss: 16190490.5333; val_optim_loss: 16190490.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9851; val_auprc_score: 0.9811; val_best_acc_score: 0.9472; val_best_f1_score: 0.9477; train_kl_reg_loss: 67074.2086; train_edge_recon_loss: 2648900.3244; train_gene_expr_recon_loss: 11176435.8092; train_masked_gp_l1_reg_loss: 73165.6394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53144.0428; train_chrom_access_recon_loss: 1911445.6489; train_global_loss: 15930165.6718; train_optim_loss: 15930165.6718; val_kl_reg_loss: 67225.9846; val_edge_recon_loss: 2664842.7833; val_gene_expr_recon_loss: 11342479.8667; val_masked_gp_l1_reg_loss: 73156.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52944.5430; val_chrom_access_recon_loss: 1944350.5250; val_global_loss: 16145000.2000; val_optim_loss: 16145000.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9822; val_auprc_score: 0.9775; val_best_acc_score: 0.9435; val_best_f1_score: 0.9453; train_kl_reg_loss: 66795.8143; train_edge_recon_loss: 2652922.8760; train_gene_expr_recon_loss: 11165141.3969; train_masked_gp_l1_reg_loss: 73128.2787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52816.0553; train_chrom_access_recon_loss: 1907920.4265; train_global_loss: 15918724.8779; train_optim_loss: 15918724.8779; val_kl_reg_loss: 67218.0406; val_edge_recon_loss: 2662937.3500; val_gene_expr_recon_loss: 11406374.4000; val_masked_gp_l1_reg_loss: 73110.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52603.8438; val_chrom_access_recon_loss: 1951508.9583; val_global_loss: 16213753.8667; val_optim_loss: 16213753.8667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9831; val_auprc_score: 0.9779; val_best_acc_score: 0.9460; val_best_f1_score: 0.9466; train_kl_reg_loss: 66876.4485; train_edge_recon_loss: 2647124.5859; train_gene_expr_recon_loss: 11171308.5496; train_masked_gp_l1_reg_loss: 73095.2254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52439.4138; train_chrom_access_recon_loss: 1911623.5630; train_global_loss: 15922467.9008; train_optim_loss: 15922467.9008; val_kl_reg_loss: 67752.8031; val_edge_recon_loss: 2671061.2333; val_gene_expr_recon_loss: 11426102.9333; val_masked_gp_l1_reg_loss: 73091.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52353.2031; val_chrom_access_recon_loss: 1947192.0500; val_global_loss: 16237552.8667; val_optim_loss: 16237552.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9831; val_auprc_score: 0.9781; val_best_acc_score: 0.9476; val_best_f1_score: 0.9489; train_kl_reg_loss: 66511.6036; train_edge_recon_loss: 2652935.1603; train_gene_expr_recon_loss: 11169789.4504; train_masked_gp_l1_reg_loss: 73084.3079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52261.6393; train_chrom_access_recon_loss: 1910883.5553; train_global_loss: 15925465.7481; train_optim_loss: 15925465.7481; val_kl_reg_loss: 66681.4464; val_edge_recon_loss: 2657329.4833; val_gene_expr_recon_loss: 11360796.0000; val_masked_gp_l1_reg_loss: 73077.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52080.9648; val_chrom_access_recon_loss: 1944184.6417; val_global_loss: 16154150.6667; val_optim_loss: 16154150.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9827; val_auprc_score: 0.9773; val_best_acc_score: 0.9477; val_best_f1_score: 0.9492; train_kl_reg_loss: 66644.1741; train_edge_recon_loss: 2657437.4408; train_gene_expr_recon_loss: 11151358.1527; train_masked_gp_l1_reg_loss: 73053.5575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51912.0295; train_chrom_access_recon_loss: 1906516.2815; train_global_loss: 15906921.6183; train_optim_loss: 15906921.6183; val_kl_reg_loss: 67126.4141; val_edge_recon_loss: 2665460.1333; val_gene_expr_recon_loss: 11384915.5333; val_masked_gp_l1_reg_loss: 73055.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51784.2578; val_chrom_access_recon_loss: 1942271.8833; val_global_loss: 16184613.0000; val_optim_loss: 16184613.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9837; val_auprc_score: 0.9784; val_best_acc_score: 0.9437; val_best_f1_score: 0.9447; train_kl_reg_loss: 66567.6564; train_edge_recon_loss: 2644550.9237; train_gene_expr_recon_loss: 11162402.2137; train_masked_gp_l1_reg_loss: 72943.7899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50301.4827; train_chrom_access_recon_loss: 1907797.0916; train_global_loss: 15904563.1221; train_optim_loss: 15904563.1221; val_kl_reg_loss: 67338.9534; val_edge_recon_loss: 2668597.9833; val_gene_expr_recon_loss: 11358575.4667; val_masked_gp_l1_reg_loss: 72891.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50060.9922; val_chrom_access_recon_loss: 1938698.3917; val_global_loss: 16156162.7333; val_optim_loss: 16156162.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9826; val_auprc_score: 0.9751; val_best_acc_score: 0.9456; val_best_f1_score: 0.9466; train_kl_reg_loss: 66783.6520; train_edge_recon_loss: 2646027.7137; train_gene_expr_recon_loss: 11160932.5878; train_masked_gp_l1_reg_loss: 72876.6476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49985.4589; train_chrom_access_recon_loss: 1907137.1384; train_global_loss: 15903743.2901; train_optim_loss: 15903743.2901; val_kl_reg_loss: 67367.0146; val_edge_recon_loss: 2648482.6167; val_gene_expr_recon_loss: 11360561.0667; val_masked_gp_l1_reg_loss: 72864.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49933.1562; val_chrom_access_recon_loss: 1939910.1083; val_global_loss: 16139117.7333; val_optim_loss: 16139117.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9833; val_auprc_score: 0.9752; val_best_acc_score: 0.9458; val_best_f1_score: 0.9469; train_kl_reg_loss: 66751.8717; train_edge_recon_loss: 2651854.0840; train_gene_expr_recon_loss: 11164660.3359; train_masked_gp_l1_reg_loss: 72857.7326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49884.7336; train_chrom_access_recon_loss: 1909982.8120; train_global_loss: 15915991.4809; train_optim_loss: 15915991.4809; val_kl_reg_loss: 67712.2385; val_edge_recon_loss: 2654161.7833; val_gene_expr_recon_loss: 11411320.0667; val_masked_gp_l1_reg_loss: 72849.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49840.4766; val_chrom_access_recon_loss: 1944222.5917; val_global_loss: 16200106.7333; val_optim_loss: 16200106.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9828; val_auprc_score: 0.9768; val_best_acc_score: 0.9413; val_best_f1_score: 0.9427; train_kl_reg_loss: 66755.3608; train_edge_recon_loss: 2649163.4809; train_gene_expr_recon_loss: 11162507.6412; train_masked_gp_l1_reg_loss: 72846.5951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49814.1393; train_chrom_access_recon_loss: 1908854.0134; train_global_loss: 15909941.2748; train_optim_loss: 15909941.2748; val_kl_reg_loss: 67337.3062; val_edge_recon_loss: 2674285.9500; val_gene_expr_recon_loss: 11361543.1333; val_masked_gp_l1_reg_loss: 72845.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49777.3633; val_chrom_access_recon_loss: 1932029.0417; val_global_loss: 16157817.4000; val_optim_loss: 16157817.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9845; val_auprc_score: 0.9795; val_best_acc_score: 0.9479; val_best_f1_score: 0.9492; train_kl_reg_loss: 66856.4795; train_edge_recon_loss: 2644572.9733; train_gene_expr_recon_loss: 11156873.3588; train_masked_gp_l1_reg_loss: 72839.0394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49751.3972; train_chrom_access_recon_loss: 1908212.3311; train_global_loss: 15899105.4962; train_optim_loss: 15899105.4962; val_kl_reg_loss: 67949.3474; val_edge_recon_loss: 2665650.0333; val_gene_expr_recon_loss: 11349918.6000; val_masked_gp_l1_reg_loss: 72836.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49717.4297; val_chrom_access_recon_loss: 1930939.6750; val_global_loss: 16137011.7333; val_optim_loss: 16137011.7333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9831; val_auprc_score: 0.9765; val_best_acc_score: 0.9445; val_best_f1_score: 0.9461; train_kl_reg_loss: 66980.8082; train_edge_recon_loss: 2645769.6603; train_gene_expr_recon_loss: 11163881.9084; train_masked_gp_l1_reg_loss: 72831.3719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49687.8152; train_chrom_access_recon_loss: 1908256.9714; train_global_loss: 15907408.5802; train_optim_loss: 15907408.5802; val_kl_reg_loss: 67634.4365; val_edge_recon_loss: 2688582.0667; val_gene_expr_recon_loss: 11387216.2000; val_masked_gp_l1_reg_loss: 72829.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49664.2812; val_chrom_access_recon_loss: 1933122.9500; val_global_loss: 16199048.6000; val_optim_loss: 16199048.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9841; val_auprc_score: 0.9788; val_best_acc_score: 0.9480; val_best_f1_score: 0.9491; train_kl_reg_loss: 67066.7774; train_edge_recon_loss: 2647419.6794; train_gene_expr_recon_loss: 11163010.7863; train_masked_gp_l1_reg_loss: 72828.4901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49633.0158; train_chrom_access_recon_loss: 1908507.9676; train_global_loss: 15908466.6794; train_optim_loss: 15908466.6794; val_kl_reg_loss: 67527.7474; val_edge_recon_loss: 2662865.6167; val_gene_expr_recon_loss: 11370715.7333; val_masked_gp_l1_reg_loss: 72822.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49609.1914; val_chrom_access_recon_loss: 1949660.7417; val_global_loss: 16173201.0667; val_optim_loss: 16173201.0667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9817; val_auprc_score: 0.9767; val_best_acc_score: 0.9441; val_best_f1_score: 0.9454; train_kl_reg_loss: 66879.2210; train_edge_recon_loss: 2651042.0382; train_gene_expr_recon_loss: 11153658.5420; train_masked_gp_l1_reg_loss: 72820.7566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49594.6838; train_chrom_access_recon_loss: 1907653.6708; train_global_loss: 15901648.9771; train_optim_loss: 15901648.9771; val_kl_reg_loss: 67516.4164; val_edge_recon_loss: 2678829.7167; val_gene_expr_recon_loss: 11386359.6667; val_masked_gp_l1_reg_loss: 72820.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49565.8438; val_chrom_access_recon_loss: 1941670.7833; val_global_loss: 16196763.6000; val_optim_loss: 16196763.6000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9821; val_auprc_score: 0.9754; val_best_acc_score: 0.9434; val_best_f1_score: 0.9444; train_kl_reg_loss: 66953.0711; train_edge_recon_loss: 2648375.7595; train_gene_expr_recon_loss: 11158456.5191; train_masked_gp_l1_reg_loss: 72817.9682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49540.2114; train_chrom_access_recon_loss: 1907127.7815; train_global_loss: 15903271.4275; train_optim_loss: 15903271.4275; val_kl_reg_loss: 67519.1349; val_edge_recon_loss: 2676961.5833; val_gene_expr_recon_loss: 11359605.2667; val_masked_gp_l1_reg_loss: 72816.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49525.7109; val_chrom_access_recon_loss: 1943190.5250; val_global_loss: 16169618.4667; val_optim_loss: 16169618.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9848; val_auprc_score: 0.9813; val_best_acc_score: 0.9481; val_best_f1_score: 0.9495; train_kl_reg_loss: 67004.5811; train_edge_recon_loss: 2646354.5134; train_gene_expr_recon_loss: 11151266.3435; train_masked_gp_l1_reg_loss: 72804.9280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49377.7533; train_chrom_access_recon_loss: 1904929.5840; train_global_loss: 15891737.7405; train_optim_loss: 15891737.7405; val_kl_reg_loss: 67812.3307; val_edge_recon_loss: 2668819.2000; val_gene_expr_recon_loss: 11406208.7333; val_masked_gp_l1_reg_loss: 72799.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49355.3555; val_chrom_access_recon_loss: 1945304.4500; val_global_loss: 16210299.6000; val_optim_loss: 16210299.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9822; val_auprc_score: 0.9765; val_best_acc_score: 0.9485; val_best_f1_score: 0.9495; train_kl_reg_loss: 67057.3362; train_edge_recon_loss: 2651426.6660; train_gene_expr_recon_loss: 11159111.0916; train_masked_gp_l1_reg_loss: 72798.3956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49348.9286; train_chrom_access_recon_loss: 1907407.5210; train_global_loss: 15907149.8321; train_optim_loss: 15907149.8321; val_kl_reg_loss: 67778.0344; val_edge_recon_loss: 2658282.0667; val_gene_expr_recon_loss: 11330183.2667; val_masked_gp_l1_reg_loss: 72797.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49343.1758; val_chrom_access_recon_loss: 1938708.0667; val_global_loss: 16117091.5333; val_optim_loss: 16117091.5333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9808; val_auprc_score: 0.9739; val_best_acc_score: 0.9407; val_best_f1_score: 0.9421; train_kl_reg_loss: 67087.3275; train_edge_recon_loss: 2648578.9809; train_gene_expr_recon_loss: 11167823.0305; train_masked_gp_l1_reg_loss: 72796.2379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49338.6727; train_chrom_access_recon_loss: 1909247.8292; train_global_loss: 15914872.1985; train_optim_loss: 15914872.1985; val_kl_reg_loss: 67573.1875; val_edge_recon_loss: 2679625.5833; val_gene_expr_recon_loss: 11400512.5333; val_masked_gp_l1_reg_loss: 72795.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49334.4727; val_chrom_access_recon_loss: 1941107.5167; val_global_loss: 16210948.9333; val_optim_loss: 16210948.9333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9826; val_auprc_score: 0.9748; val_best_acc_score: 0.9466; val_best_f1_score: 0.9481; train_kl_reg_loss: 67046.7496; train_edge_recon_loss: 2652322.4847; train_gene_expr_recon_loss: 11163059.7328; train_masked_gp_l1_reg_loss: 72795.0756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49329.9508; train_chrom_access_recon_loss: 1908324.4094; train_global_loss: 15912878.5115; train_optim_loss: 15912878.5115; val_kl_reg_loss: 68184.3698; val_edge_recon_loss: 2664407.9000; val_gene_expr_recon_loss: 11384800.9333; val_masked_gp_l1_reg_loss: 72794.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49326.9102; val_chrom_access_recon_loss: 1941621.3167; val_global_loss: 16181135.4000; val_optim_loss: 16181135.4000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9853; val_auprc_score: 0.9807; val_best_acc_score: 0.9484; val_best_f1_score: 0.9495; train_kl_reg_loss: 67068.8484; train_edge_recon_loss: 2647292.3378; train_gene_expr_recon_loss: 11155496.7481; train_masked_gp_l1_reg_loss: 72794.1443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49323.7185; train_chrom_access_recon_loss: 1906560.0363; train_global_loss: 15898535.8855; train_optim_loss: 15898535.8855; val_kl_reg_loss: 67826.0120; val_edge_recon_loss: 2667361.3667; val_gene_expr_recon_loss: 11341857.3333; val_masked_gp_l1_reg_loss: 72793.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49319.4805; val_chrom_access_recon_loss: 1933542.8667; val_global_loss: 16132700.5333; val_optim_loss: 16132700.5333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9850; val_auprc_score: 0.9798; val_best_acc_score: 0.9481; val_best_f1_score: 0.9491; train_kl_reg_loss: 67205.7160; train_edge_recon_loss: 2652466.4447; train_gene_expr_recon_loss: 11162583.6947; train_masked_gp_l1_reg_loss: 72793.3659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49316.3641; train_chrom_access_recon_loss: 1909644.6527; train_global_loss: 15914010.3435; train_optim_loss: 15914010.3435; val_kl_reg_loss: 67366.3352; val_edge_recon_loss: 2658131.3333; val_gene_expr_recon_loss: 11402499.7333; val_masked_gp_l1_reg_loss: 72792.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49312.6094; val_chrom_access_recon_loss: 1943600.4833; val_global_loss: 16193703.8667; val_optim_loss: 16193703.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9831; val_auprc_score: 0.9759; val_best_acc_score: 0.9453; val_best_f1_score: 0.9467; train_kl_reg_loss: 67049.2815; train_edge_recon_loss: 2650997.0592; train_gene_expr_recon_loss: 11165112.1298; train_masked_gp_l1_reg_loss: 72791.7885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49298.1157; train_chrom_access_recon_loss: 1908946.4656; train_global_loss: 15914194.7863; train_optim_loss: 15914194.7863; val_kl_reg_loss: 67914.5969; val_edge_recon_loss: 2659854.8000; val_gene_expr_recon_loss: 11368970.3333; val_masked_gp_l1_reg_loss: 72791.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49295.9922; val_chrom_access_recon_loss: 1940018.4250; val_global_loss: 16158845.2000; val_optim_loss: 16158845.2000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9833; val_auprc_score: 0.9795; val_best_acc_score: 0.9435; val_best_f1_score: 0.9450; train_kl_reg_loss: 67018.1731; train_edge_recon_loss: 2650568.5172; train_gene_expr_recon_loss: 11151472.6947; train_masked_gp_l1_reg_loss: 72791.0897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49295.3209; train_chrom_access_recon_loss: 1907959.6803; train_global_loss: 15899105.3893; train_optim_loss: 15899105.3893; val_kl_reg_loss: 67724.5255; val_edge_recon_loss: 2674411.8667; val_gene_expr_recon_loss: 11372210.1333; val_masked_gp_l1_reg_loss: 72790.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49294.7383; val_chrom_access_recon_loss: 1947824.7667; val_global_loss: 16184257.4000; val_optim_loss: 16184257.4000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9832; val_auprc_score: 0.9789; val_best_acc_score: 0.9458; val_best_f1_score: 0.9475; train_kl_reg_loss: 67075.5990; train_edge_recon_loss: 2657531.3206; train_gene_expr_recon_loss: 11157398.7710; train_masked_gp_l1_reg_loss: 72790.8400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49294.2837; train_chrom_access_recon_loss: 1906892.7500; train_global_loss: 15910983.6641; train_optim_loss: 15910983.6641; val_kl_reg_loss: 67681.5940; val_edge_recon_loss: 2666266.9833; val_gene_expr_recon_loss: 11394893.1333; val_masked_gp_l1_reg_loss: 72790.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49293.8867; val_chrom_access_recon_loss: 1946515.8583; val_global_loss: 16197442.6000; val_optim_loss: 16197442.6000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9821; val_auprc_score: 0.9739; val_best_acc_score: 0.9438; val_best_f1_score: 0.9443; train_kl_reg_loss: 67141.8145; train_edge_recon_loss: 2650175.6660; train_gene_expr_recon_loss: 11157061.2748; train_masked_gp_l1_reg_loss: 72790.7072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49293.5307; train_chrom_access_recon_loss: 1908150.9618; train_global_loss: 15904614.2824; train_optim_loss: 15904614.2824; val_kl_reg_loss: 67884.7891; val_edge_recon_loss: 2669237.6167; val_gene_expr_recon_loss: 11381057.2667; val_masked_gp_l1_reg_loss: 72790.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49293.0820; val_chrom_access_recon_loss: 1945814.3833; val_global_loss: 16186078.0000; val_optim_loss: 16186078.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 53 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9839
val AUPRC score: 0.9801
val best accuracy score: 0.9453
val best F1 score: 0.9468
val target rna MSE score: 1.2269
val source rna MSE score: 0.4333
val target atac MSE score: 0.3449
val source atac MSE score: 0.0997
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
