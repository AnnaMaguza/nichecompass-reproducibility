[True]
Run timestamp: 10102023_073713_189.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_189']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7747; val_auprc_score: 0.8025; val_best_acc_score: 0.5914; val_best_f1_score: 0.7031; train_kl_reg_loss: 89052.6897; train_edge_recon_loss: 751729.7572; train_gene_expr_recon_loss: 21840422.1221; train_masked_gp_l1_reg_loss: 56405.5502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4022716.0243; train_chrom_access_recon_loss: 2227094.7538; train_global_loss: 28987420.9771; train_optim_loss: 28987420.9771; val_kl_reg_loss: 94719.2818; val_edge_recon_loss: 812125.9208; val_gene_expr_recon_loss: 20986571.2000; val_masked_gp_l1_reg_loss: 58768.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 963544.8750; val_chrom_access_recon_loss: 2165325.6250; val_global_loss: 25081054.4000; val_optim_loss: 25081054.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9080; val_auprc_score: 0.9033; val_best_acc_score: 0.8325; val_best_f1_score: 0.8334; train_kl_reg_loss: 79826.2064; train_edge_recon_loss: 730584.2352; train_gene_expr_recon_loss: 20814098.9160; train_masked_gp_l1_reg_loss: 60940.0342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 484303.4761; train_chrom_access_recon_loss: 2161766.2548; train_global_loss: 24331519.3435; train_optim_loss: 24331519.3435; val_kl_reg_loss: 74602.0714; val_edge_recon_loss: 751432.5333; val_gene_expr_recon_loss: 20714392.4000; val_masked_gp_l1_reg_loss: 63559.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 267358.4688; val_chrom_access_recon_loss: 2141608.3833; val_global_loss: 24012953.3333; val_optim_loss: 24012953.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9314; val_auprc_score: 0.9213; val_best_acc_score: 0.8587; val_best_f1_score: 0.8637; train_kl_reg_loss: 79862.0635; train_edge_recon_loss: 657052.9699; train_gene_expr_recon_loss: 20530097.5267; train_masked_gp_l1_reg_loss: 66321.2756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216804.3925; train_chrom_access_recon_loss: 2134021.2156; train_global_loss: 23684159.5115; train_optim_loss: 23684159.5115; val_kl_reg_loss: 83869.5177; val_edge_recon_loss: 628589.6083; val_gene_expr_recon_loss: 20416135.3333; val_masked_gp_l1_reg_loss: 69408.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 186521.2812; val_chrom_access_recon_loss: 2118533.1167; val_global_loss: 23503057.4667; val_optim_loss: 23503057.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9344; val_auprc_score: 0.9219; val_best_acc_score: 0.8666; val_best_f1_score: 0.8726; train_kl_reg_loss: 82176.7876; train_edge_recon_loss: 617303.1598; train_gene_expr_recon_loss: 20255742.4122; train_masked_gp_l1_reg_loss: 71788.4533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165465.2354; train_chrom_access_recon_loss: 2110953.5687; train_global_loss: 23303429.7557; train_optim_loss: 23303429.7557; val_kl_reg_loss: 80630.9594; val_edge_recon_loss: 614845.2542; val_gene_expr_recon_loss: 20246399.0667; val_masked_gp_l1_reg_loss: 73718.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150214.0781; val_chrom_access_recon_loss: 2102236.7500; val_global_loss: 23268043.3333; val_optim_loss: 23268043.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9428; val_auprc_score: 0.9329; val_best_acc_score: 0.8777; val_best_f1_score: 0.8812; train_kl_reg_loss: 77472.2142; train_edge_recon_loss: 610543.3192; train_gene_expr_recon_loss: 20096680.9313; train_masked_gp_l1_reg_loss: 75181.9337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141558.2721; train_chrom_access_recon_loss: 2095803.0563; train_global_loss: 23097239.7863; train_optim_loss: 23097239.7863; val_kl_reg_loss: 76372.4615; val_edge_recon_loss: 615621.4250; val_gene_expr_recon_loss: 20053643.8667; val_masked_gp_l1_reg_loss: 76585.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135943.4375; val_chrom_access_recon_loss: 2078034.4667; val_global_loss: 23036202.4000; val_optim_loss: 23036202.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9510; val_auprc_score: 0.9419; val_best_acc_score: 0.8852; val_best_f1_score: 0.8907; train_kl_reg_loss: 74200.0924; train_edge_recon_loss: 603567.8373; train_gene_expr_recon_loss: 19962292.6107; train_masked_gp_l1_reg_loss: 77722.7446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129371.5668; train_chrom_access_recon_loss: 2083440.0477; train_global_loss: 22930594.9466; train_optim_loss: 22930594.9466; val_kl_reg_loss: 70186.5375; val_edge_recon_loss: 603920.9125; val_gene_expr_recon_loss: 19996749.3333; val_masked_gp_l1_reg_loss: 78660.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124649.6953; val_chrom_access_recon_loss: 2066556.6667; val_global_loss: 22940723.7333; val_optim_loss: 22940723.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9569; val_auprc_score: 0.9488; val_best_acc_score: 0.8968; val_best_f1_score: 0.8994; train_kl_reg_loss: 72188.8505; train_edge_recon_loss: 597612.5849; train_gene_expr_recon_loss: 19818571.3588; train_masked_gp_l1_reg_loss: 79695.2922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120491.0336; train_chrom_access_recon_loss: 2067823.5534; train_global_loss: 22756382.6870; train_optim_loss: 22756382.6870; val_kl_reg_loss: 71652.7802; val_edge_recon_loss: 595435.2458; val_gene_expr_recon_loss: 19817667.2000; val_masked_gp_l1_reg_loss: 80665.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116494.7500; val_chrom_access_recon_loss: 2044923.0167; val_global_loss: 22726838.5333; val_optim_loss: 22726838.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9597; val_auprc_score: 0.9487; val_best_acc_score: 0.9003; val_best_f1_score: 0.9033; train_kl_reg_loss: 70176.8088; train_edge_recon_loss: 594302.2977; train_gene_expr_recon_loss: 19683868.3664; train_masked_gp_l1_reg_loss: 81430.3525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113900.9669; train_chrom_access_recon_loss: 2054324.1288; train_global_loss: 22598002.8702; train_optim_loss: 22598002.8702; val_kl_reg_loss: 71427.8354; val_edge_recon_loss: 594448.3292; val_gene_expr_recon_loss: 19637044.4000; val_masked_gp_l1_reg_loss: 82068.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110498.9141; val_chrom_access_recon_loss: 2035069.5667; val_global_loss: 22530556.0000; val_optim_loss: 22530556.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9620; val_auprc_score: 0.9540; val_best_acc_score: 0.9046; val_best_f1_score: 0.9080; train_kl_reg_loss: 68673.4781; train_edge_recon_loss: 591144.5243; train_gene_expr_recon_loss: 19588913.9847; train_masked_gp_l1_reg_loss: 82851.6124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109138.9197; train_chrom_access_recon_loss: 2041525.3922; train_global_loss: 22482247.8779; train_optim_loss: 22482247.8779; val_kl_reg_loss: 70117.2807; val_edge_recon_loss: 592493.7167; val_gene_expr_recon_loss: 19590218.0000; val_masked_gp_l1_reg_loss: 83667.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107620.3438; val_chrom_access_recon_loss: 2031023.4167; val_global_loss: 22475140.6667; val_optim_loss: 22475140.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9614; val_auprc_score: 0.9520; val_best_acc_score: 0.9049; val_best_f1_score: 0.9090; train_kl_reg_loss: 67911.7127; train_edge_recon_loss: 588192.8745; train_gene_expr_recon_loss: 19498201.3740; train_masked_gp_l1_reg_loss: 84132.5185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106574.6859; train_chrom_access_recon_loss: 2032446.7615; train_global_loss: 22377459.9389; train_optim_loss: 22377459.9389; val_kl_reg_loss: 67247.2464; val_edge_recon_loss: 590081.8375; val_gene_expr_recon_loss: 19561581.0667; val_masked_gp_l1_reg_loss: 84675.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105499.0156; val_chrom_access_recon_loss: 2031798.5917; val_global_loss: 22440884.9333; val_optim_loss: 22440884.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9637; val_auprc_score: 0.9520; val_best_acc_score: 0.9072; val_best_f1_score: 0.9103; train_kl_reg_loss: 66261.3374; train_edge_recon_loss: 587442.1126; train_gene_expr_recon_loss: 19394932.4885; train_masked_gp_l1_reg_loss: 85401.6533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104398.4978; train_chrom_access_recon_loss: 2021105.9885; train_global_loss: 22259542.1527; train_optim_loss: 22259542.1527; val_kl_reg_loss: 64621.2445; val_edge_recon_loss: 589038.9958; val_gene_expr_recon_loss: 19405953.6000; val_masked_gp_l1_reg_loss: 86086.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104628.1953; val_chrom_access_recon_loss: 2004191.1250; val_global_loss: 22254518.5333; val_optim_loss: 22254518.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9658; val_auprc_score: 0.9577; val_best_acc_score: 0.9136; val_best_f1_score: 0.9165; train_kl_reg_loss: 65211.4270; train_edge_recon_loss: 586774.0859; train_gene_expr_recon_loss: 19308078.6260; train_masked_gp_l1_reg_loss: 86644.3362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103859.4998; train_chrom_access_recon_loss: 2011407.2634; train_global_loss: 22161975.3588; train_optim_loss: 22161975.3588; val_kl_reg_loss: 67250.8047; val_edge_recon_loss: 590869.9542; val_gene_expr_recon_loss: 19395826.0000; val_masked_gp_l1_reg_loss: 87205.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103507.0312; val_chrom_access_recon_loss: 2000573.2750; val_global_loss: 22245234.0000; val_optim_loss: 22245234.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9672; val_auprc_score: 0.9580; val_best_acc_score: 0.9146; val_best_f1_score: 0.9168; train_kl_reg_loss: 64628.2233; train_edge_recon_loss: 583866.1546; train_gene_expr_recon_loss: 19232211.9695; train_masked_gp_l1_reg_loss: 87883.9542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103242.4329; train_chrom_access_recon_loss: 2003201.6384; train_global_loss: 22075034.2137; train_optim_loss: 22075034.2137; val_kl_reg_loss: 64849.6758; val_edge_recon_loss: 585388.6958; val_gene_expr_recon_loss: 19317214.5333; val_masked_gp_l1_reg_loss: 88439.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102924.9141; val_chrom_access_recon_loss: 1999094.1750; val_global_loss: 22157911.0667; val_optim_loss: 22157911.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9710; val_auprc_score: 0.9620; val_best_acc_score: 0.9219; val_best_f1_score: 0.9251; train_kl_reg_loss: 63948.4609; train_edge_recon_loss: 582037.0396; train_gene_expr_recon_loss: 19162604.4733; train_masked_gp_l1_reg_loss: 89274.2957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102218.5036; train_chrom_access_recon_loss: 1995604.5677; train_global_loss: 21995687.3588; train_optim_loss: 21995687.3588; val_kl_reg_loss: 61770.0740; val_edge_recon_loss: 580803.1292; val_gene_expr_recon_loss: 19169097.7333; val_masked_gp_l1_reg_loss: 89928.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102027.7266; val_chrom_access_recon_loss: 1981101.7667; val_global_loss: 21984728.9333; val_optim_loss: 21984728.9333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9704; val_auprc_score: 0.9641; val_best_acc_score: 0.9198; val_best_f1_score: 0.9223; train_kl_reg_loss: 63145.6803; train_edge_recon_loss: 581134.4924; train_gene_expr_recon_loss: 19085451.1450; train_masked_gp_l1_reg_loss: 90719.3983; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101839.4558; train_chrom_access_recon_loss: 1986909.3244; train_global_loss: 21909199.4809; train_optim_loss: 21909199.4809; val_kl_reg_loss: 62207.2487; val_edge_recon_loss: 579917.7917; val_gene_expr_recon_loss: 19206326.0000; val_masked_gp_l1_reg_loss: 91402.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103087.6641; val_chrom_access_recon_loss: 1981862.0833; val_global_loss: 22024803.4667; val_optim_loss: 22024803.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9732; val_auprc_score: 0.9636; val_best_acc_score: 0.9245; val_best_f1_score: 0.9265; train_kl_reg_loss: 62309.8103; train_edge_recon_loss: 580550.2204; train_gene_expr_recon_loss: 19013682.9924; train_masked_gp_l1_reg_loss: 92393.0929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101733.1515; train_chrom_access_recon_loss: 1982263.8511; train_global_loss: 21832933.2672; train_optim_loss: 21832933.2672; val_kl_reg_loss: 63472.6901; val_edge_recon_loss: 581047.4625; val_gene_expr_recon_loss: 19120652.8000; val_masked_gp_l1_reg_loss: 93358.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102412.0938; val_chrom_access_recon_loss: 1971777.8750; val_global_loss: 21932720.8000; val_optim_loss: 21932720.8000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9695; val_auprc_score: 0.9602; val_best_acc_score: 0.9209; val_best_f1_score: 0.9238; train_kl_reg_loss: 61570.2594; train_edge_recon_loss: 580785.1422; train_gene_expr_recon_loss: 18925862.4580; train_masked_gp_l1_reg_loss: 94277.4935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101689.6188; train_chrom_access_recon_loss: 1971921.7271; train_global_loss: 21736106.7328; train_optim_loss: 21736106.7328; val_kl_reg_loss: 62423.6872; val_edge_recon_loss: 581240.3250; val_gene_expr_recon_loss: 19018788.1333; val_masked_gp_l1_reg_loss: 95150.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102816.0156; val_chrom_access_recon_loss: 1967950.0417; val_global_loss: 21828368.0000; val_optim_loss: 21828368.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9703; val_auprc_score: 0.9639; val_best_acc_score: 0.9173; val_best_f1_score: 0.9199; train_kl_reg_loss: 61499.3791; train_edge_recon_loss: 578100.4203; train_gene_expr_recon_loss: 18856701.2977; train_masked_gp_l1_reg_loss: 96079.0697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101953.2328; train_chrom_access_recon_loss: 1967999.5553; train_global_loss: 21662333.0840; train_optim_loss: 21662333.0840; val_kl_reg_loss: 61276.9104; val_edge_recon_loss: 581807.3792; val_gene_expr_recon_loss: 18998799.2000; val_masked_gp_l1_reg_loss: 96939.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102130.5625; val_chrom_access_recon_loss: 1961451.9583; val_global_loss: 21802405.2000; val_optim_loss: 21802405.2000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9689; val_auprc_score: 0.9596; val_best_acc_score: 0.9196; val_best_f1_score: 0.9226; train_kl_reg_loss: 61178.0222; train_edge_recon_loss: 580422.4113; train_gene_expr_recon_loss: 18781492.5344; train_masked_gp_l1_reg_loss: 97712.7019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102205.3915; train_chrom_access_recon_loss: 1962709.8769; train_global_loss: 21585720.7939; train_optim_loss: 21585720.7939; val_kl_reg_loss: 59831.2576; val_edge_recon_loss: 580377.2542; val_gene_expr_recon_loss: 18928926.0000; val_masked_gp_l1_reg_loss: 98468.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102627.3984; val_chrom_access_recon_loss: 1953690.8333; val_global_loss: 21723921.3333; val_optim_loss: 21723921.3333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9666; val_auprc_score: 0.9570; val_best_acc_score: 0.9153; val_best_f1_score: 0.9178; train_kl_reg_loss: 61476.3417; train_edge_recon_loss: 579923.3383; train_gene_expr_recon_loss: 18702180.6107; train_masked_gp_l1_reg_loss: 99211.1208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102037.1572; train_chrom_access_recon_loss: 1955286.5410; train_global_loss: 21500115.1756; train_optim_loss: 21500115.1756; val_kl_reg_loss: 61400.3409; val_edge_recon_loss: 582625.6625; val_gene_expr_recon_loss: 18857139.0667; val_masked_gp_l1_reg_loss: 99914.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102323.3984; val_chrom_access_recon_loss: 1951790.1000; val_global_loss: 21655192.8000; val_optim_loss: 21655192.8000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9620; val_auprc_score: 0.9477; val_best_acc_score: 0.9099; val_best_f1_score: 0.9141; train_kl_reg_loss: 62033.8127; train_edge_recon_loss: 581615.0587; train_gene_expr_recon_loss: 18640641.3893; train_masked_gp_l1_reg_loss: 100496.1354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102294.4235; train_chrom_access_recon_loss: 1951291.9418; train_global_loss: 21438372.6718; train_optim_loss: 21438372.6718; val_kl_reg_loss: 63409.6661; val_edge_recon_loss: 585578.1917; val_gene_expr_recon_loss: 18779962.4000; val_masked_gp_l1_reg_loss: 100857.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101718.4766; val_chrom_access_recon_loss: 1944194.8250; val_global_loss: 21575721.2000; val_optim_loss: 21575721.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9616; val_auprc_score: 0.9514; val_best_acc_score: 0.9095; val_best_f1_score: 0.9116; train_kl_reg_loss: 61855.0842; train_edge_recon_loss: 581797.7963; train_gene_expr_recon_loss: 18551634.2137; train_masked_gp_l1_reg_loss: 101605.1787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102094.8764; train_chrom_access_recon_loss: 1946459.3750; train_global_loss: 21345446.4427; train_optim_loss: 21345446.4427; val_kl_reg_loss: 60876.1745; val_edge_recon_loss: 586470.2792; val_gene_expr_recon_loss: 18734125.6000; val_masked_gp_l1_reg_loss: 102371.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102392.4297; val_chrom_access_recon_loss: 1941978.7250; val_global_loss: 21528214.9333; val_optim_loss: 21528214.9333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9630; val_auprc_score: 0.9538; val_best_acc_score: 0.9074; val_best_f1_score: 0.9113; train_kl_reg_loss: 62608.8085; train_edge_recon_loss: 580782.4036; train_gene_expr_recon_loss: 18461560.4275; train_masked_gp_l1_reg_loss: 102952.4245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102053.1683; train_chrom_access_recon_loss: 1939002.5496; train_global_loss: 21248959.6794; train_optim_loss: 21248959.6794; val_kl_reg_loss: 62052.1740; val_edge_recon_loss: 585112.4917; val_gene_expr_recon_loss: 18675529.7333; val_masked_gp_l1_reg_loss: 103474.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101554.4297; val_chrom_access_recon_loss: 1939467.1583; val_global_loss: 21467189.7333; val_optim_loss: 21467189.7333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9612; val_auprc_score: 0.9486; val_best_acc_score: 0.9053; val_best_f1_score: 0.9102; train_kl_reg_loss: 63140.5599; train_edge_recon_loss: 581854.1274; train_gene_expr_recon_loss: 18419610.5344; train_masked_gp_l1_reg_loss: 104223.8288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101955.2164; train_chrom_access_recon_loss: 1938794.4504; train_global_loss: 21209578.6260; train_optim_loss: 21209578.6260; val_kl_reg_loss: 63742.9560; val_edge_recon_loss: 587384.7667; val_gene_expr_recon_loss: 18711871.4667; val_masked_gp_l1_reg_loss: 104754.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101858.3281; val_chrom_access_recon_loss: 1940304.7083; val_global_loss: 21509915.7333; val_optim_loss: 21509915.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9620; val_auprc_score: 0.9522; val_best_acc_score: 0.9073; val_best_f1_score: 0.9118; train_kl_reg_loss: 63637.7022; train_edge_recon_loss: 584986.0716; train_gene_expr_recon_loss: 18393077.1145; train_masked_gp_l1_reg_loss: 104970.8321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102486.1357; train_chrom_access_recon_loss: 1935741.9399; train_global_loss: 21184899.6183; train_optim_loss: 21184899.6183; val_kl_reg_loss: 64842.7383; val_edge_recon_loss: 588450.9083; val_gene_expr_recon_loss: 18721422.4000; val_masked_gp_l1_reg_loss: 104424.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102508.6719; val_chrom_access_recon_loss: 1941683.5333; val_global_loss: 21523331.8667; val_optim_loss: 21523331.8667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8905; val_auprc_score: 0.8902; val_best_acc_score: 0.8026; val_best_f1_score: 0.8178; train_kl_reg_loss: 3260133.8504; train_edge_recon_loss: 631327.0844; train_gene_expr_recon_loss: 19698726.3969; train_masked_gp_l1_reg_loss: 103831.7814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127305.4547; train_chrom_access_recon_loss: 2036538.7443; train_global_loss: 25857863.4046; train_optim_loss: 25857863.4046; val_kl_reg_loss: 293450053.3042; val_edge_recon_loss: 769096.5292; val_gene_expr_recon_loss: 20046463.0667; val_masked_gp_l1_reg_loss: 114921.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 265817.6875; val_chrom_access_recon_loss: 2193784.3000; val_global_loss: 316840085.8667; val_optim_loss: 316840085.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8190; val_auprc_score: 0.8359; val_best_acc_score: 0.7378; val_best_f1_score: 0.7409; train_kl_reg_loss: 1334121245.1711; train_edge_recon_loss: 775790.2781; train_gene_expr_recon_loss: 20671166.4275; train_masked_gp_l1_reg_loss: 107882.3600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 238044.1552; train_chrom_access_recon_loss: 2140146.2586; train_global_loss: 1358054182.0153; train_optim_loss: 1358054182.0153; val_kl_reg_loss: 227621.1646; val_edge_recon_loss: 787598.3625; val_gene_expr_recon_loss: 19400216.8000; val_masked_gp_l1_reg_loss: 104933.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 159664.8281; val_chrom_access_recon_loss: 1979285.8500; val_global_loss: 22659320.1333; val_optim_loss: 22659320.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8188; val_auprc_score: 0.8358; val_best_acc_score: 0.7273; val_best_f1_score: 0.7416; train_kl_reg_loss: 205549.1044; train_edge_recon_loss: 780701.3402; train_gene_expr_recon_loss: 19190814.7786; train_masked_gp_l1_reg_loss: 103070.5886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120165.8348; train_chrom_access_recon_loss: 1971935.4571; train_global_loss: 22372237.0534; train_optim_loss: 22372237.0534; val_kl_reg_loss: 185031.7510; val_edge_recon_loss: 778205.3167; val_gene_expr_recon_loss: 19250847.7333; val_masked_gp_l1_reg_loss: 101959.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111372.0312; val_chrom_access_recon_loss: 1967896.2583; val_global_loss: 22395312.9333; val_optim_loss: 22395312.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8326; val_auprc_score: 0.8469; val_best_acc_score: 0.7379; val_best_f1_score: 0.7558; train_kl_reg_loss: 164154.6326; train_edge_recon_loss: 764260.3096; train_gene_expr_recon_loss: 19114566.5038; train_masked_gp_l1_reg_loss: 101242.1483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109294.7300; train_chrom_access_recon_loss: 1967434.0267; train_global_loss: 22220952.5038; train_optim_loss: 22220952.5038; val_kl_reg_loss: 146155.1240; val_edge_recon_loss: 763829.1917; val_gene_expr_recon_loss: 19097893.7333; val_masked_gp_l1_reg_loss: 100672.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107167.1719; val_chrom_access_recon_loss: 1948049.6583; val_global_loss: 22163767.8667; val_optim_loss: 22163767.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8452; val_auprc_score: 0.8534; val_best_acc_score: 0.7565; val_best_f1_score: 0.7713; train_kl_reg_loss: 135534.8791; train_edge_recon_loss: 741346.1574; train_gene_expr_recon_loss: 19108284.6565; train_masked_gp_l1_reg_loss: 100197.7396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105518.9512; train_chrom_access_recon_loss: 1963443.7729; train_global_loss: 22154326.1985; train_optim_loss: 22154326.1985; val_kl_reg_loss: 127914.7224; val_edge_recon_loss: 748612.1375; val_gene_expr_recon_loss: 19137579.3333; val_masked_gp_l1_reg_loss: 99778.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103571.2344; val_chrom_access_recon_loss: 1949937.0750; val_global_loss: 22167393.2000; val_optim_loss: 22167393.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8552; val_auprc_score: 0.8653; val_best_acc_score: 0.7660; val_best_f1_score: 0.7760; train_kl_reg_loss: 117674.3826; train_edge_recon_loss: 720577.8049; train_gene_expr_recon_loss: 19069672.6718; train_masked_gp_l1_reg_loss: 99424.8031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101954.1970; train_chrom_access_recon_loss: 1963921.7748; train_global_loss: 22073225.5725; train_optim_loss: 22073225.5725; val_kl_reg_loss: 111264.0229; val_edge_recon_loss: 733912.7500; val_gene_expr_recon_loss: 19142241.0667; val_masked_gp_l1_reg_loss: 99048.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100629.6484; val_chrom_access_recon_loss: 1955247.2750; val_global_loss: 22142342.9333; val_optim_loss: 22142342.9333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 2 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9614
val AUPRC score: 0.9478
val best accuracy score: 0.9070
val best F1 score: 0.9108
val target rna MSE score: 1.3390
val source rna MSE score: 0.4572
val target atac MSE score: 0.3358
val source atac MSE score: 0.1019
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
