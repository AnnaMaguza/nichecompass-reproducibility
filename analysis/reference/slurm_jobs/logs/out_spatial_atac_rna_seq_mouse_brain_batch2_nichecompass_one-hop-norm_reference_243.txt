[True]
Run timestamp: 10102023_110416_243.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_243']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6952; val_auprc_score: 0.6643; val_best_acc_score: 0.5008; val_best_f1_score: 0.6670; train_kl_reg_loss: 77445.4087; train_edge_recon_loss: 760911.8475; train_gene_expr_recon_loss: 23267667.0000; train_masked_gp_l1_reg_loss: 35881.9116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4030949.7462; train_chrom_access_recon_loss: 4927056.0455; train_global_loss: 33099912.1515; train_optim_loss: 33099912.1515; val_kl_reg_loss: 109794.7754; val_edge_recon_loss: 813111.7969; val_gene_expr_recon_loss: 21455855.0000; val_masked_gp_l1_reg_loss: 38229.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2702982.5000; val_chrom_access_recon_loss: 4734799.5000; val_global_loss: 29854773.7500; val_optim_loss: 29854773.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7067; val_auprc_score: 0.6814; val_best_acc_score: 0.6402; val_best_f1_score: 0.7008; train_kl_reg_loss: 97592.5504; train_edge_recon_loss: 749664.8939; train_gene_expr_recon_loss: 21229242.7273; train_masked_gp_l1_reg_loss: 38750.8733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1747967.2585; train_chrom_access_recon_loss: 4699542.5152; train_global_loss: 28562760.6970; train_optim_loss: 28562760.6970; val_kl_reg_loss: 91513.1338; val_edge_recon_loss: 810533.8828; val_gene_expr_recon_loss: 21189708.2500; val_masked_gp_l1_reg_loss: 39514.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1033516.6875; val_chrom_access_recon_loss: 4706762.6250; val_global_loss: 27871548.0000; val_optim_loss: 27871548.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7531; val_auprc_score: 0.7246; val_best_acc_score: 0.6722; val_best_f1_score: 0.7198; train_kl_reg_loss: 84031.5414; train_edge_recon_loss: 737737.4545; train_gene_expr_recon_loss: 21006626.3636; train_masked_gp_l1_reg_loss: 40485.1738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 711648.9115; train_chrom_access_recon_loss: 4667245.9924; train_global_loss: 27247775.4545; train_optim_loss: 27247775.4545; val_kl_reg_loss: 76963.5479; val_edge_recon_loss: 801919.0547; val_gene_expr_recon_loss: 20819575.5000; val_masked_gp_l1_reg_loss: 41572.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 483192.5312; val_chrom_access_recon_loss: 4665581.0625; val_global_loss: 26888803.5000; val_optim_loss: 26888803.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8145; val_auprc_score: 0.8012; val_best_acc_score: 0.7276; val_best_f1_score: 0.7563; train_kl_reg_loss: 74495.9076; train_edge_recon_loss: 726121.0095; train_gene_expr_recon_loss: 20869269.7576; train_masked_gp_l1_reg_loss: 42676.0045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 373200.8106; train_chrom_access_recon_loss: 4644956.6742; train_global_loss: 26730720.0909; train_optim_loss: 26730720.0909; val_kl_reg_loss: 68890.2412; val_edge_recon_loss: 767556.0859; val_gene_expr_recon_loss: 20833435.7500; val_masked_gp_l1_reg_loss: 43772.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 291147.5000; val_chrom_access_recon_loss: 4655168.6250; val_global_loss: 26659970.5000; val_optim_loss: 26659970.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8516; val_auprc_score: 0.8279; val_best_acc_score: 0.7808; val_best_f1_score: 0.7933; train_kl_reg_loss: 69289.4474; train_edge_recon_loss: 702611.6903; train_gene_expr_recon_loss: 20725630.7879; train_masked_gp_l1_reg_loss: 44896.5391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 250767.4782; train_chrom_access_recon_loss: 4616888.8182; train_global_loss: 26410084.8485; train_optim_loss: 26410084.8485; val_kl_reg_loss: 68934.5225; val_edge_recon_loss: 705137.5469; val_gene_expr_recon_loss: 20576286.0000; val_masked_gp_l1_reg_loss: 46006.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 219467.1094; val_chrom_access_recon_loss: 4608716.3125; val_global_loss: 26224548.5000; val_optim_loss: 26224548.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8784; val_auprc_score: 0.8481; val_best_acc_score: 0.8109; val_best_f1_score: 0.8287; train_kl_reg_loss: 72690.8416; train_edge_recon_loss: 663157.2992; train_gene_expr_recon_loss: 20596837.2727; train_masked_gp_l1_reg_loss: 47190.7011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201079.1574; train_chrom_access_recon_loss: 4600332.1818; train_global_loss: 26181287.6364; train_optim_loss: 26181287.6364; val_kl_reg_loss: 75981.1279; val_edge_recon_loss: 650627.5938; val_gene_expr_recon_loss: 20355458.5000; val_masked_gp_l1_reg_loss: 48496.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183637.1562; val_chrom_access_recon_loss: 4559117.3750; val_global_loss: 25873318.0000; val_optim_loss: 25873318.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8947; val_auprc_score: 0.8616; val_best_acc_score: 0.8313; val_best_f1_score: 0.8443; train_kl_reg_loss: 79680.8736; train_edge_recon_loss: 629048.4034; train_gene_expr_recon_loss: 20483700.5152; train_masked_gp_l1_reg_loss: 49570.7805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170928.3329; train_chrom_access_recon_loss: 4575997.8333; train_global_loss: 25988926.5455; train_optim_loss: 25988926.5455; val_kl_reg_loss: 79173.1064; val_edge_recon_loss: 624199.3984; val_gene_expr_recon_loss: 20545573.2500; val_masked_gp_l1_reg_loss: 50681.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158357.8906; val_chrom_access_recon_loss: 4640711.3750; val_global_loss: 26098697.5000; val_optim_loss: 26098697.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8952; val_auprc_score: 0.8703; val_best_acc_score: 0.8286; val_best_f1_score: 0.8421; train_kl_reg_loss: 78946.6723; train_edge_recon_loss: 618158.8532; train_gene_expr_recon_loss: 20379798.4545; train_masked_gp_l1_reg_loss: 51504.7420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149290.1858; train_chrom_access_recon_loss: 4554923.1212; train_global_loss: 25832622.5758; train_optim_loss: 25832622.5758; val_kl_reg_loss: 76954.6465; val_edge_recon_loss: 618786.0781; val_gene_expr_recon_loss: 20184541.5000; val_masked_gp_l1_reg_loss: 52421.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141637.0000; val_chrom_access_recon_loss: 4502501.8750; val_global_loss: 25576842.7500; val_optim_loss: 25576842.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8933; val_auprc_score: 0.8537; val_best_acc_score: 0.8323; val_best_f1_score: 0.8423; train_kl_reg_loss: 76423.5939; train_edge_recon_loss: 613145.4290; train_gene_expr_recon_loss: 20301737.1515; train_masked_gp_l1_reg_loss: 53164.1383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135024.1006; train_chrom_access_recon_loss: 4540807.6742; train_global_loss: 25720301.9697; train_optim_loss: 25720301.9697; val_kl_reg_loss: 75213.6719; val_edge_recon_loss: 618662.7109; val_gene_expr_recon_loss: 20181804.7500; val_masked_gp_l1_reg_loss: 53835.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129489.3281; val_chrom_access_recon_loss: 4546904.5625; val_global_loss: 25605911.5000; val_optim_loss: 25605911.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9110; val_auprc_score: 0.8841; val_best_acc_score: 0.8393; val_best_f1_score: 0.8485; train_kl_reg_loss: 73683.9992; train_edge_recon_loss: 610705.3277; train_gene_expr_recon_loss: 20192667.3939; train_masked_gp_l1_reg_loss: 54570.5505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125091.5861; train_chrom_access_recon_loss: 4517593.2121; train_global_loss: 25574311.9697; train_optim_loss: 25574311.9697; val_kl_reg_loss: 70937.9150; val_edge_recon_loss: 613124.7656; val_gene_expr_recon_loss: 20033742.0000; val_masked_gp_l1_reg_loss: 55317.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121550.4297; val_chrom_access_recon_loss: 4489873.4375; val_global_loss: 25384546.0000; val_optim_loss: 25384546.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9108; val_auprc_score: 0.8871; val_best_acc_score: 0.8428; val_best_f1_score: 0.8526; train_kl_reg_loss: 72320.3907; train_edge_recon_loss: 604664.3390; train_gene_expr_recon_loss: 20134524.1212; train_masked_gp_l1_reg_loss: 55875.8039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117596.3438; train_chrom_access_recon_loss: 4510876.4697; train_global_loss: 25495857.4242; train_optim_loss: 25495857.4242; val_kl_reg_loss: 69543.9473; val_edge_recon_loss: 614413.6406; val_gene_expr_recon_loss: 20056306.5000; val_masked_gp_l1_reg_loss: 56607.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114922.9062; val_chrom_access_recon_loss: 4514533.9375; val_global_loss: 25426327.7500; val_optim_loss: 25426327.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9167; val_auprc_score: 0.8934; val_best_acc_score: 0.8485; val_best_f1_score: 0.8600; train_kl_reg_loss: 70244.8916; train_edge_recon_loss: 602352.1610; train_gene_expr_recon_loss: 20059694.3030; train_masked_gp_l1_reg_loss: 57151.4031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111752.4310; train_chrom_access_recon_loss: 4491664.3712; train_global_loss: 25392859.5152; train_optim_loss: 25392859.5152; val_kl_reg_loss: 69158.3867; val_edge_recon_loss: 606497.2500; val_gene_expr_recon_loss: 20063762.7500; val_masked_gp_l1_reg_loss: 57723.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109254.8203; val_chrom_access_recon_loss: 4482945.6875; val_global_loss: 25389342.0000; val_optim_loss: 25389342.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9199; val_auprc_score: 0.8993; val_best_acc_score: 0.8536; val_best_f1_score: 0.8641; train_kl_reg_loss: 68613.8627; train_edge_recon_loss: 601214.9451; train_gene_expr_recon_loss: 19979436.2727; train_masked_gp_l1_reg_loss: 58181.0571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107026.2688; train_chrom_access_recon_loss: 4473998.6439; train_global_loss: 25288471.2121; train_optim_loss: 25288471.2121; val_kl_reg_loss: 67709.1680; val_edge_recon_loss: 600299.2734; val_gene_expr_recon_loss: 19938483.7500; val_masked_gp_l1_reg_loss: 58780.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104586.2578; val_chrom_access_recon_loss: 4460422.4375; val_global_loss: 25230280.5000; val_optim_loss: 25230280.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9197; val_auprc_score: 0.8954; val_best_acc_score: 0.8565; val_best_f1_score: 0.8659; train_kl_reg_loss: 66546.6368; train_edge_recon_loss: 600592.9460; train_gene_expr_recon_loss: 19920661.9091; train_masked_gp_l1_reg_loss: 59204.9413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102731.3435; train_chrom_access_recon_loss: 4459310.2273; train_global_loss: 25209047.6667; train_optim_loss: 25209047.6667; val_kl_reg_loss: 67307.5566; val_edge_recon_loss: 603097.0234; val_gene_expr_recon_loss: 19947539.0000; val_masked_gp_l1_reg_loss: 59711.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101201.5703; val_chrom_access_recon_loss: 4475649.0625; val_global_loss: 25254506.2500; val_optim_loss: 25254506.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9241; val_auprc_score: 0.9005; val_best_acc_score: 0.8592; val_best_f1_score: 0.8677; train_kl_reg_loss: 65917.4675; train_edge_recon_loss: 596835.3475; train_gene_expr_recon_loss: 19880004.0606; train_masked_gp_l1_reg_loss: 60223.6934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99348.7740; train_chrom_access_recon_loss: 4450083.6439; train_global_loss: 25152412.8788; train_optim_loss: 25152412.8788; val_kl_reg_loss: 65379.3574; val_edge_recon_loss: 607922.6797; val_gene_expr_recon_loss: 19741298.5000; val_masked_gp_l1_reg_loss: 60662.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97572.2891; val_chrom_access_recon_loss: 4457984.3750; val_global_loss: 25030818.7500; val_optim_loss: 25030818.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9283; val_auprc_score: 0.9052; val_best_acc_score: 0.8681; val_best_f1_score: 0.8741; train_kl_reg_loss: 64404.7515; train_edge_recon_loss: 594994.9839; train_gene_expr_recon_loss: 19801446.7576; train_masked_gp_l1_reg_loss: 61144.9997; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96184.2925; train_chrom_access_recon_loss: 4429191.7121; train_global_loss: 25047367.5455; train_optim_loss: 25047367.5455; val_kl_reg_loss: 64903.2080; val_edge_recon_loss: 597312.3438; val_gene_expr_recon_loss: 19790812.5000; val_masked_gp_l1_reg_loss: 61561.1523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95429.0938; val_chrom_access_recon_loss: 4440482.5625; val_global_loss: 25050503.0000; val_optim_loss: 25050503.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9364; val_auprc_score: 0.9197; val_best_acc_score: 0.8713; val_best_f1_score: 0.8759; train_kl_reg_loss: 64106.3989; train_edge_recon_loss: 591986.0104; train_gene_expr_recon_loss: 19744723.8182; train_masked_gp_l1_reg_loss: 61974.8445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93966.7946; train_chrom_access_recon_loss: 4412750.0909; train_global_loss: 24969507.7879; train_optim_loss: 24969507.7879; val_kl_reg_loss: 64602.5972; val_edge_recon_loss: 600254.2734; val_gene_expr_recon_loss: 19589158.0000; val_masked_gp_l1_reg_loss: 62439.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92775.6172; val_chrom_access_recon_loss: 4391927.5625; val_global_loss: 24801158.7500; val_optim_loss: 24801158.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9387; val_auprc_score: 0.9210; val_best_acc_score: 0.8761; val_best_f1_score: 0.8818; train_kl_reg_loss: 63229.2009; train_edge_recon_loss: 590227.8153; train_gene_expr_recon_loss: 19706899.7576; train_masked_gp_l1_reg_loss: 62886.8377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91954.0546; train_chrom_access_recon_loss: 4399172.7576; train_global_loss: 24914370.6364; train_optim_loss: 24914370.6364; val_kl_reg_loss: 62963.6689; val_edge_recon_loss: 596509.7578; val_gene_expr_recon_loss: 19680362.7500; val_masked_gp_l1_reg_loss: 63373.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91552.0312; val_chrom_access_recon_loss: 4371882.7188; val_global_loss: 24866644.7500; val_optim_loss: 24866644.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9463; val_auprc_score: 0.9299; val_best_acc_score: 0.8845; val_best_f1_score: 0.8893; train_kl_reg_loss: 62517.8059; train_edge_recon_loss: 587822.9820; train_gene_expr_recon_loss: 19662515.2121; train_masked_gp_l1_reg_loss: 63797.4656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90619.2087; train_chrom_access_recon_loss: 4389539.1250; train_global_loss: 24856811.7879; train_optim_loss: 24856811.7879; val_kl_reg_loss: 61134.3721; val_edge_recon_loss: 590068.4219; val_gene_expr_recon_loss: 19540417.0000; val_masked_gp_l1_reg_loss: 64234.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89949.6641; val_chrom_access_recon_loss: 4416778.6250; val_global_loss: 24762582.7500; val_optim_loss: 24762582.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9450; val_auprc_score: 0.9258; val_best_acc_score: 0.8869; val_best_f1_score: 0.8902; train_kl_reg_loss: 61342.5249; train_edge_recon_loss: 586954.0473; train_gene_expr_recon_loss: 19602541.8485; train_masked_gp_l1_reg_loss: 64683.4139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89240.3497; train_chrom_access_recon_loss: 4373413.5833; train_global_loss: 24778175.6667; train_optim_loss: 24778175.6667; val_kl_reg_loss: 62362.8955; val_edge_recon_loss: 587155.7578; val_gene_expr_recon_loss: 19598174.7500; val_masked_gp_l1_reg_loss: 65180.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88804.7266; val_chrom_access_recon_loss: 4390650.1250; val_global_loss: 24792327.2500; val_optim_loss: 24792327.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9446; val_auprc_score: 0.9297; val_best_acc_score: 0.8861; val_best_f1_score: 0.8911; train_kl_reg_loss: 61023.5339; train_edge_recon_loss: 586028.1676; train_gene_expr_recon_loss: 19556636.4545; train_masked_gp_l1_reg_loss: 65612.0304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88013.5801; train_chrom_access_recon_loss: 4361457.8712; train_global_loss: 24718771.5455; train_optim_loss: 24718771.5455; val_kl_reg_loss: 59803.9517; val_edge_recon_loss: 589285.1562; val_gene_expr_recon_loss: 19387696.7500; val_masked_gp_l1_reg_loss: 66113.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87768.5000; val_chrom_access_recon_loss: 4353195.8750; val_global_loss: 24543863.7500; val_optim_loss: 24543863.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9480; val_auprc_score: 0.9328; val_best_acc_score: 0.8917; val_best_f1_score: 0.8958; train_kl_reg_loss: 60266.2388; train_edge_recon_loss: 583145.5767; train_gene_expr_recon_loss: 19505696.1515; train_masked_gp_l1_reg_loss: 66567.9865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87298.3287; train_chrom_access_recon_loss: 4340288.7348; train_global_loss: 24643262.8788; train_optim_loss: 24643262.8788; val_kl_reg_loss: 59488.1245; val_edge_recon_loss: 588544.7578; val_gene_expr_recon_loss: 19545902.0000; val_masked_gp_l1_reg_loss: 67013.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86658.7188; val_chrom_access_recon_loss: 4340198.8750; val_global_loss: 24687805.7500; val_optim_loss: 24687805.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9423; val_auprc_score: 0.9220; val_best_acc_score: 0.8858; val_best_f1_score: 0.8914; train_kl_reg_loss: 59539.0047; train_edge_recon_loss: 583176.6932; train_gene_expr_recon_loss: 19477382.0909; train_masked_gp_l1_reg_loss: 67503.0327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86233.9245; train_chrom_access_recon_loss: 4332173.9811; train_global_loss: 24606008.6364; train_optim_loss: 24606008.6364; val_kl_reg_loss: 59063.7783; val_edge_recon_loss: 592991.5156; val_gene_expr_recon_loss: 19295474.7500; val_masked_gp_l1_reg_loss: 68017.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86363.5703; val_chrom_access_recon_loss: 4285945.6250; val_global_loss: 24387857.2500; val_optim_loss: 24387857.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9495; val_auprc_score: 0.9317; val_best_acc_score: 0.8936; val_best_f1_score: 0.8981; train_kl_reg_loss: 59081.9962; train_edge_recon_loss: 581895.7784; train_gene_expr_recon_loss: 19415124.3333; train_masked_gp_l1_reg_loss: 68473.6766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85957.2358; train_chrom_access_recon_loss: 4311930.2197; train_global_loss: 24522463.0000; train_optim_loss: 24522463.0000; val_kl_reg_loss: 58946.6865; val_edge_recon_loss: 584404.4844; val_gene_expr_recon_loss: 19338858.7500; val_masked_gp_l1_reg_loss: 69038.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85573.3672; val_chrom_access_recon_loss: 4330036.6875; val_global_loss: 24466858.7500; val_optim_loss: 24466858.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9502; val_auprc_score: 0.9341; val_best_acc_score: 0.8955; val_best_f1_score: 0.9009; train_kl_reg_loss: 57985.5484; train_edge_recon_loss: 582415.1193; train_gene_expr_recon_loss: 19368399.8182; train_masked_gp_l1_reg_loss: 69549.1863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85375.2174; train_chrom_access_recon_loss: 4296897.7386; train_global_loss: 24460622.6061; train_optim_loss: 24460622.6061; val_kl_reg_loss: 58718.8359; val_edge_recon_loss: 580385.2500; val_gene_expr_recon_loss: 19317400.5000; val_masked_gp_l1_reg_loss: 70118.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85175.2812; val_chrom_access_recon_loss: 4300199.5625; val_global_loss: 24411998.0000; val_optim_loss: 24411998.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8594; val_auprc_score: 0.8275; val_best_acc_score: 0.7706; val_best_f1_score: 0.7543; train_kl_reg_loss: 22227.2468; train_edge_recon_loss: 770370.8816; train_gene_expr_recon_loss: 18324047.9394; train_masked_gp_l1_reg_loss: 71472.3982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92567.9789; train_chrom_access_recon_loss: 4080782.0682; train_global_loss: 23361468.4545; train_optim_loss: 23361468.4545; val_kl_reg_loss: 11185.4084; val_edge_recon_loss: 804815.4688; val_gene_expr_recon_loss: 17619623.7500; val_masked_gp_l1_reg_loss: 72749.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99500.4062; val_chrom_access_recon_loss: 4013366.8125; val_global_loss: 22621241.2500; val_optim_loss: 22621241.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8495; val_auprc_score: 0.8050; val_best_acc_score: 0.7692; val_best_f1_score: 0.8066; train_kl_reg_loss: 11334.2177; train_edge_recon_loss: 774041.5729; train_gene_expr_recon_loss: 17803183.9394; train_masked_gp_l1_reg_loss: 72549.6173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100775.5017; train_chrom_access_recon_loss: 4008362.5379; train_global_loss: 22770247.3636; train_optim_loss: 22770247.3636; val_kl_reg_loss: 6321.6237; val_edge_recon_loss: 793334.5781; val_gene_expr_recon_loss: 17508121.2500; val_masked_gp_l1_reg_loss: 72937.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107481.7344; val_chrom_access_recon_loss: 3991598.5312; val_global_loss: 22479796.5000; val_optim_loss: 22479796.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8477; val_auprc_score: 0.7968; val_best_acc_score: 0.7410; val_best_f1_score: 0.7900; train_kl_reg_loss: 9090.8615; train_edge_recon_loss: 770459.0114; train_gene_expr_recon_loss: 17758436.9697; train_masked_gp_l1_reg_loss: 73144.3435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107435.3700; train_chrom_access_recon_loss: 3998412.8371; train_global_loss: 22716979.4545; train_optim_loss: 22716979.4545; val_kl_reg_loss: 8299.9486; val_edge_recon_loss: 798525.3359; val_gene_expr_recon_loss: 17564473.0000; val_masked_gp_l1_reg_loss: 72351.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103887.5234; val_chrom_access_recon_loss: 3970551.0312; val_global_loss: 22518089.2500; val_optim_loss: 22518089.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8496; val_auprc_score: 0.8024; val_best_acc_score: 0.7845; val_best_f1_score: 0.8125; train_kl_reg_loss: 10922.7466; train_edge_recon_loss: 767611.1326; train_gene_expr_recon_loss: 17712100.1970; train_masked_gp_l1_reg_loss: 71204.0762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102806.7302; train_chrom_access_recon_loss: 3987340.6061; train_global_loss: 22651985.6667; train_optim_loss: 22651985.6667; val_kl_reg_loss: 8224.7905; val_edge_recon_loss: 786738.2578; val_gene_expr_recon_loss: 17433036.8750; val_masked_gp_l1_reg_loss: 69672.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99822.8203; val_chrom_access_recon_loss: 3960815.9688; val_global_loss: 22358310.5000; val_optim_loss: 22358310.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8543; val_auprc_score: 0.8075; val_best_acc_score: 0.7945; val_best_f1_score: 0.8175; train_kl_reg_loss: 10583.0024; train_edge_recon_loss: 762958.4508; train_gene_expr_recon_loss: 17561864.7879; train_masked_gp_l1_reg_loss: 68279.0384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99296.0202; train_chrom_access_recon_loss: 3971558.6250; train_global_loss: 22474540.0303; train_optim_loss: 22474540.0303; val_kl_reg_loss: 9369.6757; val_edge_recon_loss: 771963.2500; val_gene_expr_recon_loss: 17496696.5000; val_masked_gp_l1_reg_loss: 67068.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98703.3047; val_chrom_access_recon_loss: 3979540.8438; val_global_loss: 22423342.5000; val_optim_loss: 22423342.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8519; val_auprc_score: 0.8047; val_best_acc_score: 0.7843; val_best_f1_score: 0.8120; train_kl_reg_loss: 11078.0109; train_edge_recon_loss: 742722.9631; train_gene_expr_recon_loss: 17520088.0152; train_masked_gp_l1_reg_loss: 66013.2504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98067.8411; train_chrom_access_recon_loss: 3968383.1932; train_global_loss: 22406353.2424; train_optim_loss: 22406353.2424; val_kl_reg_loss: 10478.0867; val_edge_recon_loss: 768101.7031; val_gene_expr_recon_loss: 17484636.7500; val_masked_gp_l1_reg_loss: 65122.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97233.9766; val_chrom_access_recon_loss: 3963663.1250; val_global_loss: 22389236.0000; val_optim_loss: 22389236.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8532; val_auprc_score: 0.8018; val_best_acc_score: 0.7926; val_best_f1_score: 0.8189; train_kl_reg_loss: 10503.1518; train_edge_recon_loss: 744118.0218; train_gene_expr_recon_loss: 17486420.6515; train_masked_gp_l1_reg_loss: 64403.5845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96563.1437; train_chrom_access_recon_loss: 3954851.4318; train_global_loss: 22356859.9091; train_optim_loss: 22356859.9091; val_kl_reg_loss: 9064.4720; val_edge_recon_loss: 753344.3125; val_gene_expr_recon_loss: 17361643.7500; val_masked_gp_l1_reg_loss: 63614.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95813.7109; val_chrom_access_recon_loss: 3939535.9062; val_global_loss: 22223016.5000; val_optim_loss: 22223016.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8646; val_auprc_score: 0.8182; val_best_acc_score: 0.8060; val_best_f1_score: 0.8317; train_kl_reg_loss: 11722.3496; train_edge_recon_loss: 729226.0369; train_gene_expr_recon_loss: 17428017.9697; train_masked_gp_l1_reg_loss: 62626.3147; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94260.3800; train_chrom_access_recon_loss: 3945606.2803; train_global_loss: 22271459.3030; train_optim_loss: 22271459.3030; val_kl_reg_loss: 12649.3134; val_edge_recon_loss: 732410.0078; val_gene_expr_recon_loss: 17357147.0000; val_masked_gp_l1_reg_loss: 61641.8477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92916.8047; val_chrom_access_recon_loss: 3928550.7812; val_global_loss: 22185314.7500; val_optim_loss: 22185314.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8660; val_auprc_score: 0.8196; val_best_acc_score: 0.8015; val_best_f1_score: 0.8218; train_kl_reg_loss: 10559.0422; train_edge_recon_loss: 736848.7699; train_gene_expr_recon_loss: 17468152.7121; train_masked_gp_l1_reg_loss: 61356.6291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93555.9259; train_chrom_access_recon_loss: 3948299.3636; train_global_loss: 22318772.3636; train_optim_loss: 22318772.3636; val_kl_reg_loss: 8093.8275; val_edge_recon_loss: 737193.8047; val_gene_expr_recon_loss: 17561553.7500; val_masked_gp_l1_reg_loss: 60976.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92797.4453; val_chrom_access_recon_loss: 3943185.9688; val_global_loss: 22403800.7500; val_optim_loss: 22403800.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8534; val_auprc_score: 0.7998; val_best_acc_score: 0.8033; val_best_f1_score: 0.8291; train_kl_reg_loss: 10689.1379; train_edge_recon_loss: 718524.2434; train_gene_expr_recon_loss: 17397959.6212; train_masked_gp_l1_reg_loss: 60709.7846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92404.8147; train_chrom_access_recon_loss: 3937900.7955; train_global_loss: 22218188.2727; train_optim_loss: 22218188.2727; val_kl_reg_loss: 9875.8638; val_edge_recon_loss: 704697.0312; val_gene_expr_recon_loss: 17265405.8750; val_masked_gp_l1_reg_loss: 60204.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90702.0938; val_chrom_access_recon_loss: 3899380.4375; val_global_loss: 22030265.2500; val_optim_loss: 22030265.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8436; val_auprc_score: 0.7866; val_best_acc_score: 0.7993; val_best_f1_score: 0.8290; train_kl_reg_loss: 13076.1240; train_edge_recon_loss: 693064.1572; train_gene_expr_recon_loss: 17374206.2727; train_masked_gp_l1_reg_loss: 59527.2155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89030.6894; train_chrom_access_recon_loss: 3933190.5985; train_global_loss: 22162095.1212; train_optim_loss: 22162095.1212; val_kl_reg_loss: 10782.6599; val_edge_recon_loss: 695483.1953; val_gene_expr_recon_loss: 17290618.2500; val_masked_gp_l1_reg_loss: 58915.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87220.1328; val_chrom_access_recon_loss: 3944059.0000; val_global_loss: 22087079.7500; val_optim_loss: 22087079.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8556; val_auprc_score: 0.8075; val_best_acc_score: 0.8041; val_best_f1_score: 0.8264; train_kl_reg_loss: 13837.2134; train_edge_recon_loss: 679248.4612; train_gene_expr_recon_loss: 17328846.5152; train_masked_gp_l1_reg_loss: 58399.2911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86089.0522; train_chrom_access_recon_loss: 3923786.0795; train_global_loss: 22090206.6667; train_optim_loss: 22090206.6667; val_kl_reg_loss: 11382.7798; val_edge_recon_loss: 681020.9766; val_gene_expr_recon_loss: 17090214.8750; val_masked_gp_l1_reg_loss: 58003.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85288.9531; val_chrom_access_recon_loss: 3916342.6875; val_global_loss: 21842253.2500; val_optim_loss: 21842253.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8536; val_auprc_score: 0.8081; val_best_acc_score: 0.8036; val_best_f1_score: 0.8288; train_kl_reg_loss: 13741.9258; train_edge_recon_loss: 668790.7102; train_gene_expr_recon_loss: 17307323.3636; train_masked_gp_l1_reg_loss: 57705.2111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84659.2562; train_chrom_access_recon_loss: 3919090.5000; train_global_loss: 22051311.1818; train_optim_loss: 22051311.1818; val_kl_reg_loss: 12363.8953; val_edge_recon_loss: 659429.4844; val_gene_expr_recon_loss: 17298158.7500; val_masked_gp_l1_reg_loss: 57506.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84451.7188; val_chrom_access_recon_loss: 3919408.5625; val_global_loss: 22031318.2500; val_optim_loss: 22031318.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8422; val_auprc_score: 0.7926; val_best_acc_score: 0.7907; val_best_f1_score: 0.8206; train_kl_reg_loss: 16049.4332; train_edge_recon_loss: 651611.2339; train_gene_expr_recon_loss: 17282338.5152; train_masked_gp_l1_reg_loss: 57183.9078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82991.7029; train_chrom_access_recon_loss: 3920029.1667; train_global_loss: 22010204.0000; train_optim_loss: 22010204.0000; val_kl_reg_loss: 12456.2805; val_edge_recon_loss: 658405.4609; val_gene_expr_recon_loss: 17217628.7500; val_masked_gp_l1_reg_loss: 56877.1758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82186.4141; val_chrom_access_recon_loss: 3899772.8438; val_global_loss: 21927327.0000; val_optim_loss: 21927327.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8497; val_auprc_score: 0.8043; val_best_acc_score: 0.7969; val_best_f1_score: 0.8248; train_kl_reg_loss: 16780.1481; train_edge_recon_loss: 642417.4328; train_gene_expr_recon_loss: 17237593.8636; train_masked_gp_l1_reg_loss: 56641.9764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81611.6482; train_chrom_access_recon_loss: 3912359.5606; train_global_loss: 21947404.7576; train_optim_loss: 21947404.7576; val_kl_reg_loss: 14413.3607; val_edge_recon_loss: 638879.1328; val_gene_expr_recon_loss: 17087979.7500; val_masked_gp_l1_reg_loss: 56336.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80569.2969; val_chrom_access_recon_loss: 3902621.9062; val_global_loss: 21780800.2500; val_optim_loss: 21780800.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8638; val_auprc_score: 0.8179; val_best_acc_score: 0.8098; val_best_f1_score: 0.8333; train_kl_reg_loss: 17608.9091; train_edge_recon_loss: 637162.5606; train_gene_expr_recon_loss: 17222264.9242; train_masked_gp_l1_reg_loss: 56110.1630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79776.8384; train_chrom_access_recon_loss: 3914070.9129; train_global_loss: 21926994.4242; train_optim_loss: 21926994.4242; val_kl_reg_loss: 11338.2950; val_edge_recon_loss: 652996.7578; val_gene_expr_recon_loss: 17294497.0000; val_masked_gp_l1_reg_loss: 55988.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80443.1641; val_chrom_access_recon_loss: 3902533.0625; val_global_loss: 21997796.7500; val_optim_loss: 21997796.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8397; val_auprc_score: 0.7861; val_best_acc_score: 0.7982; val_best_f1_score: 0.8259; train_kl_reg_loss: 16394.0391; train_edge_recon_loss: 639572.0720; train_gene_expr_recon_loss: 17192419.0758; train_masked_gp_l1_reg_loss: 55877.0388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79935.0864; train_chrom_access_recon_loss: 3911650.6477; train_global_loss: 21895847.9697; train_optim_loss: 21895847.9697; val_kl_reg_loss: 14003.2535; val_edge_recon_loss: 637219.7109; val_gene_expr_recon_loss: 17147249.7500; val_masked_gp_l1_reg_loss: 55649.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78548.9375; val_chrom_access_recon_loss: 3887821.3438; val_global_loss: 21820492.0000; val_optim_loss: 21820492.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8557; val_auprc_score: 0.8074; val_best_acc_score: 0.7985; val_best_f1_score: 0.8253; train_kl_reg_loss: 18556.5901; train_edge_recon_loss: 625898.1686; train_gene_expr_recon_loss: 17146249.0909; train_masked_gp_l1_reg_loss: 55535.7556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77732.8157; train_chrom_access_recon_loss: 3900953.0871; train_global_loss: 21824925.3636; train_optim_loss: 21824925.3636; val_kl_reg_loss: 15575.5741; val_edge_recon_loss: 616507.6641; val_gene_expr_recon_loss: 17022869.7500; val_masked_gp_l1_reg_loss: 55410.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76782.6719; val_chrom_access_recon_loss: 3885592.5000; val_global_loss: 21672737.0000; val_optim_loss: 21672737.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8409; val_auprc_score: 0.7854; val_best_acc_score: 0.7915; val_best_f1_score: 0.8197; train_kl_reg_loss: 20251.4068; train_edge_recon_loss: 612840.6098; train_gene_expr_recon_loss: 17125620.3636; train_masked_gp_l1_reg_loss: 55236.4629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76169.9948; train_chrom_access_recon_loss: 3903034.9508; train_global_loss: 21793153.6970; train_optim_loss: 21793153.6970; val_kl_reg_loss: 17261.0292; val_edge_recon_loss: 618940.4766; val_gene_expr_recon_loss: 16871787.8750; val_masked_gp_l1_reg_loss: 55068.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75593.1953; val_chrom_access_recon_loss: 3825208.5312; val_global_loss: 21463859.5000; val_optim_loss: 21463859.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8502; val_auprc_score: 0.8033; val_best_acc_score: 0.8020; val_best_f1_score: 0.8283; train_kl_reg_loss: 21955.2601; train_edge_recon_loss: 606660.9972; train_gene_expr_recon_loss: 17117308.5909; train_masked_gp_l1_reg_loss: 54920.4058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74990.3407; train_chrom_access_recon_loss: 3900080.4318; train_global_loss: 21775916.0303; train_optim_loss: 21775916.0303; val_kl_reg_loss: 19634.5767; val_edge_recon_loss: 601938.3203; val_gene_expr_recon_loss: 16999466.5000; val_masked_gp_l1_reg_loss: 54739.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74131.7969; val_chrom_access_recon_loss: 3883868.7188; val_global_loss: 21633780.5000; val_optim_loss: 21633780.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8564; val_auprc_score: 0.8048; val_best_acc_score: 0.8052; val_best_f1_score: 0.8295; train_kl_reg_loss: 23964.8602; train_edge_recon_loss: 600894.3920; train_gene_expr_recon_loss: 17094613.4848; train_masked_gp_l1_reg_loss: 54525.7673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73721.7776; train_chrom_access_recon_loss: 3895715.7348; train_global_loss: 21743436.0606; train_optim_loss: 21743436.0606; val_kl_reg_loss: 21298.5095; val_edge_recon_loss: 599544.7734; val_gene_expr_recon_loss: 17276261.0000; val_masked_gp_l1_reg_loss: 54394.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73406.3906; val_chrom_access_recon_loss: 3918705.5938; val_global_loss: 21943609.7500; val_optim_loss: 21943609.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8610; val_auprc_score: 0.8201; val_best_acc_score: 0.8057; val_best_f1_score: 0.8298; train_kl_reg_loss: 25848.1261; train_edge_recon_loss: 595409.0019; train_gene_expr_recon_loss: 17087209.3182; train_masked_gp_l1_reg_loss: 54158.6691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72784.3491; train_chrom_access_recon_loss: 3897255.7197; train_global_loss: 21732665.2727; train_optim_loss: 21732665.2727; val_kl_reg_loss: 23321.6528; val_edge_recon_loss: 591051.0312; val_gene_expr_recon_loss: 17047826.5000; val_masked_gp_l1_reg_loss: 53930.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72306.5469; val_chrom_access_recon_loss: 3871190.2188; val_global_loss: 21659624.7500; val_optim_loss: 21659624.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8461; val_auprc_score: 0.7943; val_best_acc_score: 0.7894; val_best_f1_score: 0.8180; train_kl_reg_loss: 26842.0233; train_edge_recon_loss: 590170.8939; train_gene_expr_recon_loss: 17057793.4091; train_masked_gp_l1_reg_loss: 53709.5106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71997.1410; train_chrom_access_recon_loss: 3888040.2765; train_global_loss: 21688553.1818; train_optim_loss: 21688553.1818; val_kl_reg_loss: 24420.1030; val_edge_recon_loss: 600820.6719; val_gene_expr_recon_loss: 16953067.8750; val_masked_gp_l1_reg_loss: 53492.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71623.0625; val_chrom_access_recon_loss: 3861332.6562; val_global_loss: 21564757.5000; val_optim_loss: 21564757.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8569; val_auprc_score: 0.8132; val_best_acc_score: 0.8039; val_best_f1_score: 0.8287; train_kl_reg_loss: 27239.0305; train_edge_recon_loss: 589000.6667; train_gene_expr_recon_loss: 17043424.9394; train_masked_gp_l1_reg_loss: 53192.0652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62597.5974; train_chrom_access_recon_loss: 3886599.9621; train_global_loss: 21662054.2424; train_optim_loss: 21662054.2424; val_kl_reg_loss: 24551.5659; val_edge_recon_loss: 585763.7656; val_gene_expr_recon_loss: 17040399.3750; val_masked_gp_l1_reg_loss: 53042.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60542.3672; val_chrom_access_recon_loss: 3948116.4062; val_global_loss: 21712415.2500; val_optim_loss: 21712415.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8522; val_auprc_score: 0.8009; val_best_acc_score: 0.7988; val_best_f1_score: 0.8254; train_kl_reg_loss: 27478.5041; train_edge_recon_loss: 589394.6098; train_gene_expr_recon_loss: 17033840.4697; train_masked_gp_l1_reg_loss: 52990.1584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60211.7549; train_chrom_access_recon_loss: 3880183.2992; train_global_loss: 21644098.7273; train_optim_loss: 21644098.7273; val_kl_reg_loss: 24993.7202; val_edge_recon_loss: 589556.9219; val_gene_expr_recon_loss: 17074361.6250; val_masked_gp_l1_reg_loss: 52941.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59945.7227; val_chrom_access_recon_loss: 3911151.8750; val_global_loss: 21712952.0000; val_optim_loss: 21712952.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8431; val_auprc_score: 0.7918; val_best_acc_score: 0.7939; val_best_f1_score: 0.8213; train_kl_reg_loss: 27614.7493; train_edge_recon_loss: 591736.8011; train_gene_expr_recon_loss: 17046039.3939; train_masked_gp_l1_reg_loss: 52902.9518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59751.5783; train_chrom_access_recon_loss: 3883314.3409; train_global_loss: 21661359.8788; train_optim_loss: 21661359.8788; val_kl_reg_loss: 25096.1348; val_edge_recon_loss: 592701.3047; val_gene_expr_recon_loss: 16949581.7500; val_masked_gp_l1_reg_loss: 52860.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59559.6719; val_chrom_access_recon_loss: 3845766.5312; val_global_loss: 21525565.7500; val_optim_loss: 21525565.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8594; val_auprc_score: 0.8096; val_best_acc_score: 0.8074; val_best_f1_score: 0.8313; train_kl_reg_loss: 27592.3597; train_edge_recon_loss: 589956.1629; train_gene_expr_recon_loss: 17034183.5758; train_masked_gp_l1_reg_loss: 52830.1500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59455.3571; train_chrom_access_recon_loss: 3880973.7235; train_global_loss: 21644991.3030; train_optim_loss: 21644991.3030; val_kl_reg_loss: 25081.3308; val_edge_recon_loss: 587293.8594; val_gene_expr_recon_loss: 16888517.3750; val_masked_gp_l1_reg_loss: 52796.7148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59285.1328; val_chrom_access_recon_loss: 3842295.1562; val_global_loss: 21455269.2500; val_optim_loss: 21455269.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8410; val_auprc_score: 0.7948; val_best_acc_score: 0.7915; val_best_f1_score: 0.8205; train_kl_reg_loss: 27890.8306; train_edge_recon_loss: 586928.9943; train_gene_expr_recon_loss: 17033050.9394; train_masked_gp_l1_reg_loss: 52762.5534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59191.0950; train_chrom_access_recon_loss: 3880041.6780; train_global_loss: 21639865.8485; train_optim_loss: 21639865.8485; val_kl_reg_loss: 25646.1360; val_edge_recon_loss: 596216.5312; val_gene_expr_recon_loss: 16964225.3750; val_masked_gp_l1_reg_loss: 52726.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59101.6289; val_chrom_access_recon_loss: 3861397.9688; val_global_loss: 21559313.7500; val_optim_loss: 21559313.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8594; val_auprc_score: 0.8109; val_best_acc_score: 0.8057; val_best_f1_score: 0.8302; train_kl_reg_loss: 28044.3133; train_edge_recon_loss: 587824.0028; train_gene_expr_recon_loss: 17029573.5000; train_masked_gp_l1_reg_loss: 52700.4775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58973.4690; train_chrom_access_recon_loss: 3882225.9205; train_global_loss: 21639341.5455; train_optim_loss: 21639341.5455; val_kl_reg_loss: 25347.2847; val_edge_recon_loss: 591698.2422; val_gene_expr_recon_loss: 16981450.8750; val_masked_gp_l1_reg_loss: 52664.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58845.0703; val_chrom_access_recon_loss: 3877321.7188; val_global_loss: 21587327.5000; val_optim_loss: 21587327.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8512; val_auprc_score: 0.7963; val_best_acc_score: 0.8004; val_best_f1_score: 0.8260; train_kl_reg_loss: 27886.5452; train_edge_recon_loss: 591713.8551; train_gene_expr_recon_loss: 17028833.6212; train_masked_gp_l1_reg_loss: 52630.3529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58757.2192; train_chrom_access_recon_loss: 3881197.9129; train_global_loss: 21641019.3939; train_optim_loss: 21641019.3939; val_kl_reg_loss: 25394.5737; val_edge_recon_loss: 593802.1328; val_gene_expr_recon_loss: 16909767.2500; val_masked_gp_l1_reg_loss: 52600.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58635.1836; val_chrom_access_recon_loss: 3867336.2812; val_global_loss: 21507536.0000; val_optim_loss: 21507536.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8512; val_auprc_score: 0.7994; val_best_acc_score: 0.7950; val_best_f1_score: 0.8222; train_kl_reg_loss: 27908.6330; train_edge_recon_loss: 591354.8002; train_gene_expr_recon_loss: 17034727.8030; train_masked_gp_l1_reg_loss: 52573.4469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58561.7862; train_chrom_access_recon_loss: 3882660.0076; train_global_loss: 21647786.4545; train_optim_loss: 21647786.4545; val_kl_reg_loss: 25689.2722; val_edge_recon_loss: 593639.9141; val_gene_expr_recon_loss: 17010226.2500; val_masked_gp_l1_reg_loss: 52536.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58433.5586; val_chrom_access_recon_loss: 3890296.0938; val_global_loss: 21630821.2500; val_optim_loss: 21630821.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8566; val_auprc_score: 0.8079; val_best_acc_score: 0.8001; val_best_f1_score: 0.8246; train_kl_reg_loss: 27950.5483; train_edge_recon_loss: 589299.1979; train_gene_expr_recon_loss: 17024802.9091; train_masked_gp_l1_reg_loss: 52505.8085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57510.0502; train_chrom_access_recon_loss: 3876647.9773; train_global_loss: 21628716.5758; train_optim_loss: 21628716.5758; val_kl_reg_loss: 25651.3159; val_edge_recon_loss: 590139.0078; val_gene_expr_recon_loss: 16987665.5000; val_masked_gp_l1_reg_loss: 52489.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57316.7227; val_chrom_access_recon_loss: 3900965.3125; val_global_loss: 21614227.2500; val_optim_loss: 21614227.2500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8569; val_auprc_score: 0.8126; val_best_acc_score: 0.8020; val_best_f1_score: 0.8260; train_kl_reg_loss: 27973.0495; train_edge_recon_loss: 588812.7150; train_gene_expr_recon_loss: 17020170.1667; train_masked_gp_l1_reg_loss: 52482.3048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57286.6245; train_chrom_access_recon_loss: 3879246.8030; train_global_loss: 21625971.5758; train_optim_loss: 21625971.5758; val_kl_reg_loss: 25581.0417; val_edge_recon_loss: 586631.6016; val_gene_expr_recon_loss: 16964302.2500; val_masked_gp_l1_reg_loss: 52474.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57257.3047; val_chrom_access_recon_loss: 3863891.2188; val_global_loss: 21550138.2500; val_optim_loss: 21550138.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8545; val_auprc_score: 0.8083; val_best_acc_score: 0.7993; val_best_f1_score: 0.8241; train_kl_reg_loss: 27998.7623; train_edge_recon_loss: 591633.7311; train_gene_expr_recon_loss: 17040159.1970; train_masked_gp_l1_reg_loss: 52468.8833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57233.9180; train_chrom_access_recon_loss: 3881306.8977; train_global_loss: 21650801.3636; train_optim_loss: 21650801.3636; val_kl_reg_loss: 25787.0779; val_edge_recon_loss: 597815.6484; val_gene_expr_recon_loss: 16900305.6250; val_masked_gp_l1_reg_loss: 52463.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57210.8086; val_chrom_access_recon_loss: 3875330.0312; val_global_loss: 21508912.2500; val_optim_loss: 21508912.2500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8540; val_auprc_score: 0.8002; val_best_acc_score: 0.7969; val_best_f1_score: 0.8234; train_kl_reg_loss: 27995.5455; train_edge_recon_loss: 589446.1288; train_gene_expr_recon_loss: 17020526.9697; train_masked_gp_l1_reg_loss: 52459.3646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57196.8517; train_chrom_access_recon_loss: 3881201.9470; train_global_loss: 21628827.1515; train_optim_loss: 21628827.1515; val_kl_reg_loss: 25828.8125; val_edge_recon_loss: 592424.2969; val_gene_expr_recon_loss: 17014021.5000; val_masked_gp_l1_reg_loss: 52455.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57178.1172; val_chrom_access_recon_loss: 3893155.4688; val_global_loss: 21635063.7500; val_optim_loss: 21635063.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 41 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.8577
val AUPRC score: 0.8155
val best accuracy score: 0.8028
val best F1 score: 0.8270
val target rna MSE score: 2.1348
val source rna MSE score: 1.1505
val target atac MSE score: 0.4968
val source atac MSE score: 0.2010
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
