[True]
Run timestamp: 10102023_055801_163.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_163']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7193; val_auprc_score: 0.6870; val_best_acc_score: 0.5204; val_best_f1_score: 0.6753; train_kl_reg_loss: 83763.1507; train_edge_recon_loss: 757391.1837; train_gene_expr_recon_loss: 22817474.8182; train_masked_gp_l1_reg_loss: 35817.9352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4064552.2803; train_chrom_access_recon_loss: 993856.1534; train_global_loss: 28752855.6667; train_optim_loss: 28752855.6667; val_kl_reg_loss: 115150.4688; val_edge_recon_loss: 812827.3359; val_gene_expr_recon_loss: 21304870.2500; val_masked_gp_l1_reg_loss: 38080.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2776228.5000; val_chrom_access_recon_loss: 945408.3984; val_global_loss: 25992563.7500; val_optim_loss: 25992563.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7454; val_auprc_score: 0.7264; val_best_acc_score: 0.6682; val_best_f1_score: 0.7172; train_kl_reg_loss: 97987.3523; train_edge_recon_loss: 747001.8996; train_gene_expr_recon_loss: 21152235.6061; train_masked_gp_l1_reg_loss: 38711.8763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1840589.3485; train_chrom_access_recon_loss: 944434.3381; train_global_loss: 24820960.4848; train_optim_loss: 24820960.4848; val_kl_reg_loss: 90637.8604; val_edge_recon_loss: 809797.0781; val_gene_expr_recon_loss: 21118638.0000; val_masked_gp_l1_reg_loss: 39687.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1124975.3750; val_chrom_access_recon_loss: 930009.5391; val_global_loss: 24113746.7500; val_optim_loss: 24113746.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8196; val_auprc_score: 0.7929; val_best_acc_score: 0.7028; val_best_f1_score: 0.7566; train_kl_reg_loss: 81890.1146; train_edge_recon_loss: 735031.6477; train_gene_expr_recon_loss: 20941269.4545; train_masked_gp_l1_reg_loss: 40949.1986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 785681.4384; train_chrom_access_recon_loss: 936806.2614; train_global_loss: 23521627.8788; train_optim_loss: 23521627.8788; val_kl_reg_loss: 73919.8145; val_edge_recon_loss: 792711.3125; val_gene_expr_recon_loss: 21071354.7500; val_masked_gp_l1_reg_loss: 42374.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 539744.4375; val_chrom_access_recon_loss: 928817.4844; val_global_loss: 23448921.5000; val_optim_loss: 23448921.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8635; val_auprc_score: 0.8333; val_best_acc_score: 0.7961; val_best_f1_score: 0.8074; train_kl_reg_loss: 72542.2907; train_edge_recon_loss: 719137.0473; train_gene_expr_recon_loss: 20803108.2121; train_masked_gp_l1_reg_loss: 43669.8023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 419992.2022; train_chrom_access_recon_loss: 932670.3570; train_global_loss: 22991120.0303; train_optim_loss: 22991120.0303; val_kl_reg_loss: 74732.6602; val_edge_recon_loss: 744280.3438; val_gene_expr_recon_loss: 20789089.2500; val_masked_gp_l1_reg_loss: 44933.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 329197.5625; val_chrom_access_recon_loss: 922668.5078; val_global_loss: 22904902.5000; val_optim_loss: 22904902.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8834; val_auprc_score: 0.8483; val_best_acc_score: 0.8160; val_best_f1_score: 0.8312; train_kl_reg_loss: 71221.5465; train_edge_recon_loss: 679726.6591; train_gene_expr_recon_loss: 20654015.3030; train_masked_gp_l1_reg_loss: 46137.2361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 278718.4666; train_chrom_access_recon_loss: 927560.0672; train_global_loss: 22657379.2424; train_optim_loss: 22657379.2424; val_kl_reg_loss: 77708.5342; val_edge_recon_loss: 649699.1562; val_gene_expr_recon_loss: 20756298.7500; val_masked_gp_l1_reg_loss: 47392.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237407.2656; val_chrom_access_recon_loss: 921306.8906; val_global_loss: 22689813.0000; val_optim_loss: 22689813.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9013; val_auprc_score: 0.8674; val_best_acc_score: 0.8418; val_best_f1_score: 0.8536; train_kl_reg_loss: 80676.7823; train_edge_recon_loss: 632852.5246; train_gene_expr_recon_loss: 20526018.7879; train_masked_gp_l1_reg_loss: 48646.2142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 210728.7557; train_chrom_access_recon_loss: 922352.0303; train_global_loss: 22421275.1515; train_optim_loss: 22421275.1515; val_kl_reg_loss: 78383.6182; val_edge_recon_loss: 624473.2500; val_gene_expr_recon_loss: 20462081.0000; val_masked_gp_l1_reg_loss: 50144.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 188080.7188; val_chrom_access_recon_loss: 910207.6875; val_global_loss: 22313369.5000; val_optim_loss: 22313369.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9062; val_auprc_score: 0.8754; val_best_acc_score: 0.8399; val_best_f1_score: 0.8509; train_kl_reg_loss: 79706.8537; train_edge_recon_loss: 617490.8400; train_gene_expr_recon_loss: 20432373.1818; train_masked_gp_l1_reg_loss: 51123.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170742.3099; train_chrom_access_recon_loss: 918597.6080; train_global_loss: 22270034.1818; train_optim_loss: 22270034.1818; val_kl_reg_loss: 78782.1104; val_edge_recon_loss: 619329.8047; val_gene_expr_recon_loss: 20621028.5000; val_masked_gp_l1_reg_loss: 52149.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157317.0469; val_chrom_access_recon_loss: 915222.0859; val_global_loss: 22443830.0000; val_optim_loss: 22443830.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9031; val_auprc_score: 0.8732; val_best_acc_score: 0.8404; val_best_f1_score: 0.8519; train_kl_reg_loss: 77059.1436; train_edge_recon_loss: 612689.7273; train_gene_expr_recon_loss: 20336219.9697; train_masked_gp_l1_reg_loss: 53197.5872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146931.4321; train_chrom_access_recon_loss: 914906.1884; train_global_loss: 22141004.2424; train_optim_loss: 22141004.2424; val_kl_reg_loss: 77454.2764; val_edge_recon_loss: 615813.5703; val_gene_expr_recon_loss: 20416326.5000; val_masked_gp_l1_reg_loss: 54270.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138111.2031; val_chrom_access_recon_loss: 916141.8906; val_global_loss: 22218118.0000; val_optim_loss: 22218118.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9193; val_auprc_score: 0.9013; val_best_acc_score: 0.8560; val_best_f1_score: 0.8634; train_kl_reg_loss: 74305.4768; train_edge_recon_loss: 609822.0881; train_gene_expr_recon_loss: 20244598.8788; train_masked_gp_l1_reg_loss: 54984.0210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132191.3234; train_chrom_access_recon_loss: 911223.5900; train_global_loss: 22027125.5455; train_optim_loss: 22027125.5455; val_kl_reg_loss: 74647.9199; val_edge_recon_loss: 606664.6719; val_gene_expr_recon_loss: 20301893.0000; val_masked_gp_l1_reg_loss: 55774.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127165.2656; val_chrom_access_recon_loss: 915865.7031; val_global_loss: 22082011.2500; val_optim_loss: 22082011.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9135; val_auprc_score: 0.8876; val_best_acc_score: 0.8490; val_best_f1_score: 0.8612; train_kl_reg_loss: 72490.7410; train_edge_recon_loss: 604211.9697; train_gene_expr_recon_loss: 20165662.9091; train_masked_gp_l1_reg_loss: 56503.8115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123583.4188; train_chrom_access_recon_loss: 908267.7756; train_global_loss: 21930720.7576; train_optim_loss: 21930720.7576; val_kl_reg_loss: 73206.3438; val_edge_recon_loss: 609116.4062; val_gene_expr_recon_loss: 20293105.2500; val_masked_gp_l1_reg_loss: 57193.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120331.8594; val_chrom_access_recon_loss: 902945.4609; val_global_loss: 22055899.0000; val_optim_loss: 22055899.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9242; val_auprc_score: 0.8999; val_best_acc_score: 0.8603; val_best_f1_score: 0.8693; train_kl_reg_loss: 71134.5207; train_edge_recon_loss: 600786.3608; train_gene_expr_recon_loss: 20110666.3333; train_masked_gp_l1_reg_loss: 57855.4786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116835.7637; train_chrom_access_recon_loss: 905296.3968; train_global_loss: 21862574.8788; train_optim_loss: 21862574.8788; val_kl_reg_loss: 69312.1191; val_edge_recon_loss: 603043.9062; val_gene_expr_recon_loss: 20285598.7500; val_masked_gp_l1_reg_loss: 58472.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113625.7969; val_chrom_access_recon_loss: 893481.2812; val_global_loss: 22023534.2500; val_optim_loss: 22023534.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9218; val_auprc_score: 0.8988; val_best_acc_score: 0.8592; val_best_f1_score: 0.8673; train_kl_reg_loss: 69059.4447; train_edge_recon_loss: 598694.7178; train_gene_expr_recon_loss: 20023674.3030; train_masked_gp_l1_reg_loss: 59056.6657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110883.0745; train_chrom_access_recon_loss: 902910.8949; train_global_loss: 21764279.3030; train_optim_loss: 21764279.3030; val_kl_reg_loss: 69588.8252; val_edge_recon_loss: 609334.3516; val_gene_expr_recon_loss: 20053416.0000; val_masked_gp_l1_reg_loss: 59687.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109639.8984; val_chrom_access_recon_loss: 899038.6484; val_global_loss: 21800705.7500; val_optim_loss: 21800705.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9365; val_auprc_score: 0.9211; val_best_acc_score: 0.8753; val_best_f1_score: 0.8790; train_kl_reg_loss: 67730.1692; train_edge_recon_loss: 595417.2794; train_gene_expr_recon_loss: 19953827.6667; train_masked_gp_l1_reg_loss: 60257.3426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106563.5728; train_chrom_access_recon_loss: 898634.6032; train_global_loss: 21682430.5455; train_optim_loss: 21682430.5455; val_kl_reg_loss: 70254.4131; val_edge_recon_loss: 596748.7734; val_gene_expr_recon_loss: 20017148.0000; val_masked_gp_l1_reg_loss: 60911.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105217.2266; val_chrom_access_recon_loss: 905893.1641; val_global_loss: 21756174.5000; val_optim_loss: 21756174.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9350; val_auprc_score: 0.9159; val_best_acc_score: 0.8694; val_best_f1_score: 0.8760; train_kl_reg_loss: 66716.0684; train_edge_recon_loss: 593128.4725; train_gene_expr_recon_loss: 19882843.1212; train_masked_gp_l1_reg_loss: 61350.7235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103029.9878; train_chrom_access_recon_loss: 895018.2680; train_global_loss: 21602086.3939; train_optim_loss: 21602086.3939; val_kl_reg_loss: 63717.9590; val_edge_recon_loss: 599913.0391; val_gene_expr_recon_loss: 19958137.7500; val_masked_gp_l1_reg_loss: 61971.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102046.3828; val_chrom_access_recon_loss: 894203.3125; val_global_loss: 21679990.2500; val_optim_loss: 21679990.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9454; val_auprc_score: 0.9326; val_best_acc_score: 0.8853; val_best_f1_score: 0.8893; train_kl_reg_loss: 65219.9369; train_edge_recon_loss: 591653.6004; train_gene_expr_recon_loss: 19815360.0303; train_masked_gp_l1_reg_loss: 62482.2977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100267.4128; train_chrom_access_recon_loss: 893384.7093; train_global_loss: 21528368.0000; train_optim_loss: 21528368.0000; val_kl_reg_loss: 64983.2212; val_edge_recon_loss: 589625.5234; val_gene_expr_recon_loss: 19861891.0000; val_masked_gp_l1_reg_loss: 62951.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99748.7031; val_chrom_access_recon_loss: 882041.0547; val_global_loss: 21561240.7500; val_optim_loss: 21561240.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9482; val_auprc_score: 0.9294; val_best_acc_score: 0.8912; val_best_f1_score: 0.8976; train_kl_reg_loss: 63963.9680; train_edge_recon_loss: 590171.0009; train_gene_expr_recon_loss: 19759909.1212; train_masked_gp_l1_reg_loss: 63592.0005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98151.6622; train_chrom_access_recon_loss: 890919.3097; train_global_loss: 21466707.2121; train_optim_loss: 21466707.2121; val_kl_reg_loss: 65165.3804; val_edge_recon_loss: 589084.0547; val_gene_expr_recon_loss: 19881855.0000; val_masked_gp_l1_reg_loss: 64232.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96434.1797; val_chrom_access_recon_loss: 888148.4453; val_global_loss: 21584919.0000; val_optim_loss: 21584919.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9447; val_auprc_score: 0.9259; val_best_acc_score: 0.8880; val_best_f1_score: 0.8916; train_kl_reg_loss: 63360.7825; train_edge_recon_loss: 587808.8125; train_gene_expr_recon_loss: 19694312.3636; train_masked_gp_l1_reg_loss: 64749.9642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95836.5202; train_chrom_access_recon_loss: 888383.3570; train_global_loss: 21394451.5152; train_optim_loss: 21394451.5152; val_kl_reg_loss: 63038.7461; val_edge_recon_loss: 591033.3359; val_gene_expr_recon_loss: 19837127.2500; val_masked_gp_l1_reg_loss: 65376.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95013.7578; val_chrom_access_recon_loss: 887569.6250; val_global_loss: 21539158.7500; val_optim_loss: 21539158.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9449; val_auprc_score: 0.9289; val_best_acc_score: 0.8823; val_best_f1_score: 0.8881; train_kl_reg_loss: 62082.6014; train_edge_recon_loss: 587435.5294; train_gene_expr_recon_loss: 19650628.6970; train_masked_gp_l1_reg_loss: 65921.6224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94096.5838; train_chrom_access_recon_loss: 887088.0549; train_global_loss: 21347253.1515; train_optim_loss: 21347253.1515; val_kl_reg_loss: 63756.1333; val_edge_recon_loss: 589372.8047; val_gene_expr_recon_loss: 19766603.2500; val_masked_gp_l1_reg_loss: 66565.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93184.1875; val_chrom_access_recon_loss: 874248.2500; val_global_loss: 21453730.2500; val_optim_loss: 21453730.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9509; val_auprc_score: 0.9374; val_best_acc_score: 0.8947; val_best_f1_score: 0.8988; train_kl_reg_loss: 61007.2573; train_edge_recon_loss: 585234.1837; train_gene_expr_recon_loss: 19596461.4848; train_masked_gp_l1_reg_loss: 67119.8646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92141.7049; train_chrom_access_recon_loss: 884628.0502; train_global_loss: 21286592.4848; train_optim_loss: 21286592.4848; val_kl_reg_loss: 64114.2407; val_edge_recon_loss: 585536.7266; val_gene_expr_recon_loss: 19728441.5000; val_masked_gp_l1_reg_loss: 67831.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91467.9531; val_chrom_access_recon_loss: 879445.3828; val_global_loss: 21416837.5000; val_optim_loss: 21416837.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9513; val_auprc_score: 0.9384; val_best_acc_score: 0.8933; val_best_f1_score: 0.8985; train_kl_reg_loss: 60314.6138; train_edge_recon_loss: 583776.7595; train_gene_expr_recon_loss: 19526912.2424; train_masked_gp_l1_reg_loss: 68476.4334; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90637.7764; train_chrom_access_recon_loss: 882573.7273; train_global_loss: 21212691.6061; train_optim_loss: 21212691.6061; val_kl_reg_loss: 59715.9209; val_edge_recon_loss: 585830.2188; val_gene_expr_recon_loss: 19550267.0000; val_masked_gp_l1_reg_loss: 69170.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90497.0156; val_chrom_access_recon_loss: 874132.9766; val_global_loss: 21229613.7500; val_optim_loss: 21229613.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9466; val_auprc_score: 0.9257; val_best_acc_score: 0.8890; val_best_f1_score: 0.8948; train_kl_reg_loss: 59435.6322; train_edge_recon_loss: 582594.4744; train_gene_expr_recon_loss: 19469640.5758; train_masked_gp_l1_reg_loss: 69794.5955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89254.8610; train_chrom_access_recon_loss: 880061.3371; train_global_loss: 21150781.6364; train_optim_loss: 21150781.6364; val_kl_reg_loss: 58781.8779; val_edge_recon_loss: 583398.1094; val_gene_expr_recon_loss: 19541680.0000; val_masked_gp_l1_reg_loss: 70661.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88681.0859; val_chrom_access_recon_loss: 869786.7109; val_global_loss: 21212990.5000; val_optim_loss: 21212990.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9483; val_auprc_score: 0.9349; val_best_acc_score: 0.8877; val_best_f1_score: 0.8918; train_kl_reg_loss: 58791.9705; train_edge_recon_loss: 580895.5331; train_gene_expr_recon_loss: 19424142.4545; train_masked_gp_l1_reg_loss: 71362.2152; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87633.2080; train_chrom_access_recon_loss: 878172.9517; train_global_loss: 21100998.0909; train_optim_loss: 21100998.0909; val_kl_reg_loss: 59220.9121; val_edge_recon_loss: 588054.3906; val_gene_expr_recon_loss: 19468659.2500; val_masked_gp_l1_reg_loss: 72139.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86468.8281; val_chrom_access_recon_loss: 870527.8281; val_global_loss: 21145070.2500; val_optim_loss: 21145070.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9510; val_auprc_score: 0.9350; val_best_acc_score: 0.8952; val_best_f1_score: 0.8998; train_kl_reg_loss: 58093.0540; train_edge_recon_loss: 581491.1297; train_gene_expr_recon_loss: 19366046.2121; train_masked_gp_l1_reg_loss: 72781.6979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85853.6478; train_chrom_access_recon_loss: 875642.7121; train_global_loss: 21039908.3333; train_optim_loss: 21039908.3333; val_kl_reg_loss: 59788.4028; val_edge_recon_loss: 587467.3125; val_gene_expr_recon_loss: 19568817.2500; val_masked_gp_l1_reg_loss: 73537.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85745.7734; val_chrom_access_recon_loss: 876177.0938; val_global_loss: 21251534.2500; val_optim_loss: 21251534.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9548; val_auprc_score: 0.9384; val_best_acc_score: 0.9009; val_best_f1_score: 0.9060; train_kl_reg_loss: 57957.7421; train_edge_recon_loss: 577411.0644; train_gene_expr_recon_loss: 19289631.4848; train_masked_gp_l1_reg_loss: 74335.9573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84916.6506; train_chrom_access_recon_loss: 874173.4669; train_global_loss: 20958426.5152; train_optim_loss: 20958426.5152; val_kl_reg_loss: 58118.6509; val_edge_recon_loss: 582598.4609; val_gene_expr_recon_loss: 19363425.0000; val_masked_gp_l1_reg_loss: 75156.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84189.3672; val_chrom_access_recon_loss: 876790.5547; val_global_loss: 21040279.0000; val_optim_loss: 21040279.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9557; val_auprc_score: 0.9403; val_best_acc_score: 0.9033; val_best_f1_score: 0.9074; train_kl_reg_loss: 57218.4231; train_edge_recon_loss: 579216.2377; train_gene_expr_recon_loss: 19242819.2727; train_masked_gp_l1_reg_loss: 75935.1438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83593.7701; train_chrom_access_recon_loss: 872557.3153; train_global_loss: 20911340.2727; train_optim_loss: 20911340.2727; val_kl_reg_loss: 55941.8145; val_edge_recon_loss: 578445.3594; val_gene_expr_recon_loss: 19301870.0000; val_masked_gp_l1_reg_loss: 76732.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82888.5078; val_chrom_access_recon_loss: 861139.3906; val_global_loss: 20957016.2500; val_optim_loss: 20957016.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8954; val_auprc_score: 0.8642; val_best_acc_score: 0.8275; val_best_f1_score: 0.8430; train_kl_reg_loss: 31291.7668; train_edge_recon_loss: 716825.0947; train_gene_expr_recon_loss: 18663029.3939; train_masked_gp_l1_reg_loss: 78715.7341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101605.2273; train_chrom_access_recon_loss: 834037.1278; train_global_loss: 20425504.3636; train_optim_loss: 20425504.3636; val_kl_reg_loss: 14933.2009; val_edge_recon_loss: 766330.8750; val_gene_expr_recon_loss: 18238708.0000; val_masked_gp_l1_reg_loss: 81321.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129172.7500; val_chrom_access_recon_loss: 807821.5703; val_global_loss: 20038287.7500; val_optim_loss: 20038287.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8870; val_auprc_score: 0.8562; val_best_acc_score: 0.8111; val_best_f1_score: 0.8342; train_kl_reg_loss: 22412.5757; train_edge_recon_loss: 712540.6695; train_gene_expr_recon_loss: 18193568.6667; train_masked_gp_l1_reg_loss: 80489.2259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121327.7391; train_chrom_access_recon_loss: 820061.7386; train_global_loss: 19950400.3939; train_optim_loss: 19950400.3939; val_kl_reg_loss: 20536.1426; val_edge_recon_loss: 740323.6172; val_gene_expr_recon_loss: 18256205.5000; val_masked_gp_l1_reg_loss: 79198.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110646.2969; val_chrom_access_recon_loss: 815211.6094; val_global_loss: 20022121.0000; val_optim_loss: 20022121.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8983; val_auprc_score: 0.8709; val_best_acc_score: 0.8213; val_best_f1_score: 0.8394; train_kl_reg_loss: 21175.8682; train_edge_recon_loss: 695741.9271; train_gene_expr_recon_loss: 18105006.1515; train_masked_gp_l1_reg_loss: 77902.1423; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104449.8938; train_chrom_access_recon_loss: 818043.1837; train_global_loss: 19822319.3333; train_optim_loss: 19822319.3333; val_kl_reg_loss: 16404.0162; val_edge_recon_loss: 699317.2891; val_gene_expr_recon_loss: 18127026.5000; val_masked_gp_l1_reg_loss: 76781.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99872.2812; val_chrom_access_recon_loss: 816960.0234; val_global_loss: 19836361.5000; val_optim_loss: 19836361.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8841; val_auprc_score: 0.8442; val_best_acc_score: 0.8178; val_best_f1_score: 0.8365; train_kl_reg_loss: 19616.8781; train_edge_recon_loss: 672572.8788; train_gene_expr_recon_loss: 18054407.7576; train_masked_gp_l1_reg_loss: 75849.9105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99637.0619; train_chrom_access_recon_loss: 815400.6989; train_global_loss: 19737485.2424; train_optim_loss: 19737485.2424; val_kl_reg_loss: 16273.1274; val_edge_recon_loss: 657270.9297; val_gene_expr_recon_loss: 18275891.0000; val_masked_gp_l1_reg_loss: 74921.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97647.7500; val_chrom_access_recon_loss: 824846.8047; val_global_loss: 19946852.2500; val_optim_loss: 19946852.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8798; val_auprc_score: 0.8445; val_best_acc_score: 0.8111; val_best_f1_score: 0.8295; train_kl_reg_loss: 22693.2398; train_edge_recon_loss: 634842.0208; train_gene_expr_recon_loss: 17997308.6364; train_masked_gp_l1_reg_loss: 73850.2822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93467.7150; train_chrom_access_recon_loss: 815648.5038; train_global_loss: 19637810.7273; train_optim_loss: 19637810.7273; val_kl_reg_loss: 21842.0208; val_edge_recon_loss: 618391.4922; val_gene_expr_recon_loss: 18166075.7500; val_masked_gp_l1_reg_loss: 72895.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90321.6328; val_chrom_access_recon_loss: 811437.7266; val_global_loss: 19780964.7500; val_optim_loss: 19780964.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8843; val_auprc_score: 0.8543; val_best_acc_score: 0.8076; val_best_f1_score: 0.8302; train_kl_reg_loss: 27586.9103; train_edge_recon_loss: 611178.4242; train_gene_expr_recon_loss: 17941312.6364; train_masked_gp_l1_reg_loss: 72125.8440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88387.9067; train_chrom_access_recon_loss: 812279.7254; train_global_loss: 19552871.4545; train_optim_loss: 19552871.4545; val_kl_reg_loss: 26738.0859; val_edge_recon_loss: 610501.2422; val_gene_expr_recon_loss: 17993398.0000; val_masked_gp_l1_reg_loss: 71344.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86553.5703; val_chrom_access_recon_loss: 809363.6328; val_global_loss: 19597899.0000; val_optim_loss: 19597899.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8900; val_auprc_score: 0.8592; val_best_acc_score: 0.8186; val_best_f1_score: 0.8344; train_kl_reg_loss: 30614.5627; train_edge_recon_loss: 602432.9006; train_gene_expr_recon_loss: 17889582.8485; train_masked_gp_l1_reg_loss: 70609.5861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84925.6732; train_chrom_access_recon_loss: 810147.8750; train_global_loss: 19488313.3636; train_optim_loss: 19488313.3636; val_kl_reg_loss: 30075.3984; val_edge_recon_loss: 600607.1328; val_gene_expr_recon_loss: 17956949.2500; val_masked_gp_l1_reg_loss: 69861.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83641.1094; val_chrom_access_recon_loss: 811051.4219; val_global_loss: 19552187.5000; val_optim_loss: 19552187.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8925; val_auprc_score: 0.8552; val_best_acc_score: 0.8235; val_best_f1_score: 0.8403; train_kl_reg_loss: 33167.1635; train_edge_recon_loss: 593372.0407; train_gene_expr_recon_loss: 17865855.3636; train_masked_gp_l1_reg_loss: 69131.3898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82177.1893; train_chrom_access_recon_loss: 809154.0114; train_global_loss: 19452857.0000; train_optim_loss: 19452857.0000; val_kl_reg_loss: 32104.4446; val_edge_recon_loss: 595210.0312; val_gene_expr_recon_loss: 17958063.2500; val_masked_gp_l1_reg_loss: 68458.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81159.6797; val_chrom_access_recon_loss: 803741.1016; val_global_loss: 19538736.5000; val_optim_loss: 19538736.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9061; val_auprc_score: 0.8748; val_best_acc_score: 0.8458; val_best_f1_score: 0.8570; train_kl_reg_loss: 34293.0669; train_edge_recon_loss: 590889.1193; train_gene_expr_recon_loss: 17849303.4545; train_masked_gp_l1_reg_loss: 67861.4002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80167.9099; train_chrom_access_recon_loss: 809430.8854; train_global_loss: 19431945.6364; train_optim_loss: 19431945.6364; val_kl_reg_loss: 32619.1301; val_edge_recon_loss: 588097.0078; val_gene_expr_recon_loss: 17870619.5000; val_masked_gp_l1_reg_loss: 67292.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79240.8906; val_chrom_access_recon_loss: 804752.8438; val_global_loss: 19442620.2500; val_optim_loss: 19442620.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9178; val_auprc_score: 0.8886; val_best_acc_score: 0.8514; val_best_f1_score: 0.8617; train_kl_reg_loss: 35448.9810; train_edge_recon_loss: 585753.4934; train_gene_expr_recon_loss: 17811961.8333; train_masked_gp_l1_reg_loss: 66752.0629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78320.3700; train_chrom_access_recon_loss: 807957.1288; train_global_loss: 19386193.8182; train_optim_loss: 19386193.8182; val_kl_reg_loss: 34700.3149; val_edge_recon_loss: 582203.9141; val_gene_expr_recon_loss: 17923970.7500; val_masked_gp_l1_reg_loss: 66238.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77566.6719; val_chrom_access_recon_loss: 798359.5859; val_global_loss: 19483038.0000; val_optim_loss: 19483038.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9169; val_auprc_score: 0.8944; val_best_acc_score: 0.8503; val_best_f1_score: 0.8609; train_kl_reg_loss: 36405.6586; train_edge_recon_loss: 584110.3428; train_gene_expr_recon_loss: 17787428.0606; train_masked_gp_l1_reg_loss: 65742.7611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76968.4605; train_chrom_access_recon_loss: 805826.2812; train_global_loss: 19356481.6061; train_optim_loss: 19356481.6061; val_kl_reg_loss: 34807.0332; val_edge_recon_loss: 582620.3438; val_gene_expr_recon_loss: 17858979.7500; val_masked_gp_l1_reg_loss: 65319.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76326.0859; val_chrom_access_recon_loss: 796629.3438; val_global_loss: 19414682.5000; val_optim_loss: 19414682.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9128; val_auprc_score: 0.8864; val_best_acc_score: 0.8493; val_best_f1_score: 0.8575; train_kl_reg_loss: 37247.0772; train_edge_recon_loss: 583058.9489; train_gene_expr_recon_loss: 17777633.2727; train_masked_gp_l1_reg_loss: 64798.7464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75153.6276; train_chrom_access_recon_loss: 805606.1998; train_global_loss: 19343497.8182; train_optim_loss: 19343497.8182; val_kl_reg_loss: 35767.1299; val_edge_recon_loss: 592996.8906; val_gene_expr_recon_loss: 17688220.7500; val_masked_gp_l1_reg_loss: 64417.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74440.8438; val_chrom_access_recon_loss: 796482.6641; val_global_loss: 19252325.7500; val_optim_loss: 19252325.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9183; val_auprc_score: 0.8884; val_best_acc_score: 0.8598; val_best_f1_score: 0.8684; train_kl_reg_loss: 37918.2417; train_edge_recon_loss: 580217.5199; train_gene_expr_recon_loss: 17735970.0000; train_masked_gp_l1_reg_loss: 64078.2988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73955.1044; train_chrom_access_recon_loss: 803212.1108; train_global_loss: 19295351.2121; train_optim_loss: 19295351.2121; val_kl_reg_loss: 36073.2944; val_edge_recon_loss: 578334.0703; val_gene_expr_recon_loss: 17718235.2500; val_masked_gp_l1_reg_loss: 63814.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73386.7578; val_chrom_access_recon_loss: 787984.5312; val_global_loss: 19257827.0000; val_optim_loss: 19257827.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9257; val_auprc_score: 0.9083; val_best_acc_score: 0.8595; val_best_f1_score: 0.8679; train_kl_reg_loss: 38437.7373; train_edge_recon_loss: 577804.3078; train_gene_expr_recon_loss: 17708323.5758; train_masked_gp_l1_reg_loss: 63476.1022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73023.7268; train_chrom_access_recon_loss: 801570.1477; train_global_loss: 19262635.3939; train_optim_loss: 19262635.3939; val_kl_reg_loss: 36809.5879; val_edge_recon_loss: 586168.0703; val_gene_expr_recon_loss: 17759738.7500; val_masked_gp_l1_reg_loss: 63145.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72756.1172; val_chrom_access_recon_loss: 794759.3203; val_global_loss: 19313377.7500; val_optim_loss: 19313377.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9249; val_auprc_score: 0.8980; val_best_acc_score: 0.8662; val_best_f1_score: 0.8743; train_kl_reg_loss: 38794.4085; train_edge_recon_loss: 578245.3504; train_gene_expr_recon_loss: 17698353.8939; train_masked_gp_l1_reg_loss: 62908.9615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72281.7738; train_chrom_access_recon_loss: 801264.1316; train_global_loss: 19251848.6364; train_optim_loss: 19251848.6364; val_kl_reg_loss: 36361.7119; val_edge_recon_loss: 581288.3359; val_gene_expr_recon_loss: 17595033.7500; val_masked_gp_l1_reg_loss: 62612.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72024.4453; val_chrom_access_recon_loss: 787264.1641; val_global_loss: 19134584.0000; val_optim_loss: 19134584.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9326; val_auprc_score: 0.9122; val_best_acc_score: 0.8702; val_best_f1_score: 0.8764; train_kl_reg_loss: 39032.5362; train_edge_recon_loss: 576824.8902; train_gene_expr_recon_loss: 17670981.4242; train_masked_gp_l1_reg_loss: 62400.6598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71519.0239; train_chrom_access_recon_loss: 800291.2339; train_global_loss: 19221049.7576; train_optim_loss: 19221049.7576; val_kl_reg_loss: 37064.9341; val_edge_recon_loss: 576494.2266; val_gene_expr_recon_loss: 17715367.0000; val_masked_gp_l1_reg_loss: 62239.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71440.2188; val_chrom_access_recon_loss: 795990.3906; val_global_loss: 19258597.0000; val_optim_loss: 19258597.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9306; val_auprc_score: 0.9056; val_best_acc_score: 0.8713; val_best_f1_score: 0.8775; train_kl_reg_loss: 39076.7950; train_edge_recon_loss: 574894.4915; train_gene_expr_recon_loss: 17645162.4545; train_masked_gp_l1_reg_loss: 62074.8803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70937.7002; train_chrom_access_recon_loss: 798990.9621; train_global_loss: 19191137.4545; train_optim_loss: 19191137.4545; val_kl_reg_loss: 37663.4434; val_edge_recon_loss: 580228.1094; val_gene_expr_recon_loss: 17710920.5000; val_masked_gp_l1_reg_loss: 61898.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70980.8516; val_chrom_access_recon_loss: 799129.8828; val_global_loss: 19260820.0000; val_optim_loss: 19260820.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9336; val_auprc_score: 0.9175; val_best_acc_score: 0.8702; val_best_f1_score: 0.8751; train_kl_reg_loss: 39355.2262; train_edge_recon_loss: 574050.8324; train_gene_expr_recon_loss: 17636094.6364; train_masked_gp_l1_reg_loss: 61744.2371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70605.4579; train_chrom_access_recon_loss: 798800.2775; train_global_loss: 19180650.5758; train_optim_loss: 19180650.5758; val_kl_reg_loss: 37864.7397; val_edge_recon_loss: 581644.9219; val_gene_expr_recon_loss: 17530105.2500; val_masked_gp_l1_reg_loss: 61677.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70142.6016; val_chrom_access_recon_loss: 790624.9688; val_global_loss: 19072059.5000; val_optim_loss: 19072059.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9352; val_auprc_score: 0.9138; val_best_acc_score: 0.8737; val_best_f1_score: 0.8789; train_kl_reg_loss: 39331.4015; train_edge_recon_loss: 575720.4953; train_gene_expr_recon_loss: 17616480.2121; train_masked_gp_l1_reg_loss: 61412.2060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69265.9897; train_chrom_access_recon_loss: 799290.9479; train_global_loss: 19161501.2121; train_optim_loss: 19161501.2121; val_kl_reg_loss: 38262.9458; val_edge_recon_loss: 575921.0078; val_gene_expr_recon_loss: 17756353.7500; val_masked_gp_l1_reg_loss: 61251.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68767.8438; val_chrom_access_recon_loss: 795120.4531; val_global_loss: 19295678.5000; val_optim_loss: 19295678.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9299; val_auprc_score: 0.9084; val_best_acc_score: 0.8678; val_best_f1_score: 0.8747; train_kl_reg_loss: 39192.7754; train_edge_recon_loss: 574637.4186; train_gene_expr_recon_loss: 17615186.8636; train_masked_gp_l1_reg_loss: 61154.5205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68612.4684; train_chrom_access_recon_loss: 798391.9697; train_global_loss: 19157176.1212; train_optim_loss: 19157176.1212; val_kl_reg_loss: 38352.0762; val_edge_recon_loss: 585035.7031; val_gene_expr_recon_loss: 17830403.2500; val_masked_gp_l1_reg_loss: 61091.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68360.2812; val_chrom_access_recon_loss: 800402.1172; val_global_loss: 19383645.0000; val_optim_loss: 19383645.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9369; val_auprc_score: 0.9176; val_best_acc_score: 0.8748; val_best_f1_score: 0.8806; train_kl_reg_loss: 39300.2580; train_edge_recon_loss: 573120.3295; train_gene_expr_recon_loss: 17598598.0455; train_masked_gp_l1_reg_loss: 61012.5135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68341.3153; train_chrom_access_recon_loss: 798304.5312; train_global_loss: 19138677.1212; train_optim_loss: 19138677.1212; val_kl_reg_loss: 38726.8999; val_edge_recon_loss: 576480.4297; val_gene_expr_recon_loss: 17754005.7500; val_masked_gp_l1_reg_loss: 60946.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68153.6797; val_chrom_access_recon_loss: 793509.8047; val_global_loss: 19291822.7500; val_optim_loss: 19291822.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9374; val_auprc_score: 0.9161; val_best_acc_score: 0.8743; val_best_f1_score: 0.8812; train_kl_reg_loss: 39325.5845; train_edge_recon_loss: 572817.1004; train_gene_expr_recon_loss: 17569631.9091; train_masked_gp_l1_reg_loss: 60907.1200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68047.1692; train_chrom_access_recon_loss: 796928.8580; train_global_loss: 19107657.6364; train_optim_loss: 19107657.6364; val_kl_reg_loss: 38357.5029; val_edge_recon_loss: 579911.1797; val_gene_expr_recon_loss: 17781409.2500; val_masked_gp_l1_reg_loss: 60814.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68116.1797; val_chrom_access_recon_loss: 795392.5703; val_global_loss: 19324000.2500; val_optim_loss: 19324000.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9355; val_auprc_score: 0.9162; val_best_acc_score: 0.8726; val_best_f1_score: 0.8777; train_kl_reg_loss: 39564.2068; train_edge_recon_loss: 571286.1136; train_gene_expr_recon_loss: 17556664.0303; train_masked_gp_l1_reg_loss: 60501.4750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58895.2230; train_chrom_access_recon_loss: 797343.9403; train_global_loss: 19084254.8788; train_optim_loss: 19084254.8788; val_kl_reg_loss: 38695.6777; val_edge_recon_loss: 582384.5000; val_gene_expr_recon_loss: 17569912.2500; val_masked_gp_l1_reg_loss: 60344.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56549.6289; val_chrom_access_recon_loss: 792570.7266; val_global_loss: 19100456.7500; val_optim_loss: 19100456.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9372; val_auprc_score: 0.9133; val_best_acc_score: 0.8778; val_best_f1_score: 0.8834; train_kl_reg_loss: 39795.0287; train_edge_recon_loss: 572620.6042; train_gene_expr_recon_loss: 17539697.3939; train_masked_gp_l1_reg_loss: 60296.8896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56046.6040; train_chrom_access_recon_loss: 796600.1960; train_global_loss: 19065056.6061; train_optim_loss: 19065056.6061; val_kl_reg_loss: 38706.8970; val_edge_recon_loss: 575276.0234; val_gene_expr_recon_loss: 17522925.6250; val_masked_gp_l1_reg_loss: 60256.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55626.4062; val_chrom_access_recon_loss: 786814.4062; val_global_loss: 19039604.5000; val_optim_loss: 19039604.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9406; val_auprc_score: 0.9218; val_best_acc_score: 0.8764; val_best_f1_score: 0.8822; train_kl_reg_loss: 39908.9150; train_edge_recon_loss: 571060.8968; train_gene_expr_recon_loss: 17538055.8485; train_masked_gp_l1_reg_loss: 60236.9886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55371.1806; train_chrom_access_recon_loss: 794937.7301; train_global_loss: 19059571.4545; train_optim_loss: 19059571.4545; val_kl_reg_loss: 39169.1572; val_edge_recon_loss: 576171.9219; val_gene_expr_recon_loss: 17666624.7500; val_masked_gp_l1_reg_loss: 60220.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55072.3281; val_chrom_access_recon_loss: 787256.2344; val_global_loss: 19184514.2500; val_optim_loss: 19184514.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9428; val_auprc_score: 0.9225; val_best_acc_score: 0.8831; val_best_f1_score: 0.8885; train_kl_reg_loss: 40038.8271; train_edge_recon_loss: 568848.3570; train_gene_expr_recon_loss: 17551499.3636; train_masked_gp_l1_reg_loss: 60208.0859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54921.6167; train_chrom_access_recon_loss: 796040.3617; train_global_loss: 19071556.6061; train_optim_loss: 19071556.6061; val_kl_reg_loss: 39055.0933; val_edge_recon_loss: 572774.6016; val_gene_expr_recon_loss: 17628868.2500; val_masked_gp_l1_reg_loss: 60191.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54721.5117; val_chrom_access_recon_loss: 794195.3203; val_global_loss: 19149807.5000; val_optim_loss: 19149807.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9401; val_auprc_score: 0.9225; val_best_acc_score: 0.8764; val_best_f1_score: 0.8812; train_kl_reg_loss: 40193.9055; train_edge_recon_loss: 571299.6335; train_gene_expr_recon_loss: 17542755.5152; train_masked_gp_l1_reg_loss: 60178.3292; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54572.5824; train_chrom_access_recon_loss: 795603.7472; train_global_loss: 19064603.5455; train_optim_loss: 19064603.5455; val_kl_reg_loss: 39243.4751; val_edge_recon_loss: 576820.0625; val_gene_expr_recon_loss: 17626827.0000; val_masked_gp_l1_reg_loss: 60162.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54480.8320; val_chrom_access_recon_loss: 789431.2422; val_global_loss: 19146963.7500; val_optim_loss: 19146963.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9352; val_auprc_score: 0.9107; val_best_acc_score: 0.8751; val_best_f1_score: 0.8817; train_kl_reg_loss: 40276.6738; train_edge_recon_loss: 569060.5985; train_gene_expr_recon_loss: 17554669.8030; train_masked_gp_l1_reg_loss: 60148.3501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54327.0636; train_chrom_access_recon_loss: 796445.2462; train_global_loss: 19074927.8485; train_optim_loss: 19074927.8485; val_kl_reg_loss: 39353.9883; val_edge_recon_loss: 572339.2578; val_gene_expr_recon_loss: 17554071.3750; val_masked_gp_l1_reg_loss: 60135.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54174.3438; val_chrom_access_recon_loss: 794682.4844; val_global_loss: 19074757.0000; val_optim_loss: 19074757.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9374; val_auprc_score: 0.9159; val_best_acc_score: 0.8756; val_best_f1_score: 0.8787; train_kl_reg_loss: 40388.3168; train_edge_recon_loss: 571028.0502; train_gene_expr_recon_loss: 17535371.5758; train_masked_gp_l1_reg_loss: 60102.4101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53254.3374; train_chrom_access_recon_loss: 795077.1023; train_global_loss: 19055221.6970; train_optim_loss: 19055221.6970; val_kl_reg_loss: 39362.8608; val_edge_recon_loss: 578776.4531; val_gene_expr_recon_loss: 17667243.0000; val_masked_gp_l1_reg_loss: 60084.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53050.0469; val_chrom_access_recon_loss: 789483.5625; val_global_loss: 19188000.0000; val_optim_loss: 19188000.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9449; val_auprc_score: 0.9256; val_best_acc_score: 0.8858; val_best_f1_score: 0.8892; train_kl_reg_loss: 40363.8693; train_edge_recon_loss: 572244.5066; train_gene_expr_recon_loss: 17536988.5455; train_masked_gp_l1_reg_loss: 60077.3205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53010.8329; train_chrom_access_recon_loss: 796107.7263; train_global_loss: 19058792.7273; train_optim_loss: 19058792.7273; val_kl_reg_loss: 39283.5498; val_edge_recon_loss: 569599.0625; val_gene_expr_recon_loss: 17621633.2500; val_masked_gp_l1_reg_loss: 60070.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52972.2461; val_chrom_access_recon_loss: 789987.8828; val_global_loss: 19133546.5000; val_optim_loss: 19133546.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9381; val_auprc_score: 0.9198; val_best_acc_score: 0.8740; val_best_f1_score: 0.8785; train_kl_reg_loss: 40353.7553; train_edge_recon_loss: 570104.5540; train_gene_expr_recon_loss: 17540611.6061; train_masked_gp_l1_reg_loss: 60066.1502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52939.7567; train_chrom_access_recon_loss: 796579.3911; train_global_loss: 19060655.0000; train_optim_loss: 19060655.0000; val_kl_reg_loss: 39637.0098; val_edge_recon_loss: 580312.8359; val_gene_expr_recon_loss: 17720686.7500; val_masked_gp_l1_reg_loss: 60062.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52909.0547; val_chrom_access_recon_loss: 798363.4141; val_global_loss: 19251971.5000; val_optim_loss: 19251971.5000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9360; val_auprc_score: 0.9131; val_best_acc_score: 0.8767; val_best_f1_score: 0.8813; train_kl_reg_loss: 40393.4167; train_edge_recon_loss: 570170.6866; train_gene_expr_recon_loss: 17532343.2424; train_masked_gp_l1_reg_loss: 60058.9962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52892.0053; train_chrom_access_recon_loss: 795456.1799; train_global_loss: 19051314.6364; train_optim_loss: 19051314.6364; val_kl_reg_loss: 39347.4155; val_edge_recon_loss: 575609.3125; val_gene_expr_recon_loss: 17615116.2500; val_masked_gp_l1_reg_loss: 60056.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52867.4297; val_chrom_access_recon_loss: 786704.1719; val_global_loss: 19129701.2500; val_optim_loss: 19129701.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 10 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9467
val AUPRC score: 0.9334
val best accuracy score: 0.8866
val best F1 score: 0.8883
val target rna MSE score: 1.6299
val source rna MSE score: 0.7856
val target atac MSE score: 0.4757
val source atac MSE score: 0.1987
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
