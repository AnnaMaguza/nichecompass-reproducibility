[True]
Run timestamp: 10102023_132024_278.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_278']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7981; val_auprc_score: 0.8131; val_best_acc_score: 0.5218; val_best_f1_score: 0.6754; train_kl_reg_loss: 61826.6829; train_edge_recon_loss: 740845.6245; train_gene_expr_recon_loss: 22134777.3130; train_masked_gp_l1_reg_loss: 95222.2323; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2409854.5468; train_chrom_access_recon_loss: 11186608.3893; train_global_loss: 36629134.8397; train_optim_loss: 36629134.8397; val_kl_reg_loss: 82247.8344; val_edge_recon_loss: 812765.1125; val_gene_expr_recon_loss: 21171535.4667; val_masked_gp_l1_reg_loss: 77699.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 908528.5625; val_chrom_access_recon_loss: 10933504.4000; val_global_loss: 33986281.0667; val_optim_loss: 33986281.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8919; val_auprc_score: 0.8909; val_best_acc_score: 0.8054; val_best_f1_score: 0.8227; train_kl_reg_loss: 72396.6701; train_edge_recon_loss: 732461.6942; train_gene_expr_recon_loss: 20862809.1298; train_masked_gp_l1_reg_loss: 75745.4108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 489716.4022; train_chrom_access_recon_loss: 10799641.9771; train_global_loss: 33032771.5115; train_optim_loss: 33032771.5115; val_kl_reg_loss: 67539.1500; val_edge_recon_loss: 806005.5833; val_gene_expr_recon_loss: 20898420.4000; val_masked_gp_l1_reg_loss: 75785.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 272705.9375; val_chrom_access_recon_loss: 10822891.8667; val_global_loss: 32943348.8000; val_optim_loss: 32943348.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9048; val_auprc_score: 0.8991; val_best_acc_score: 0.8178; val_best_f1_score: 0.8315; train_kl_reg_loss: 62203.3930; train_edge_recon_loss: 720078.9885; train_gene_expr_recon_loss: 20554378.8244; train_masked_gp_l1_reg_loss: 78034.3838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 214615.3686; train_chrom_access_recon_loss: 10652265.6183; train_global_loss: 32281576.6565; train_optim_loss: 32281576.6565; val_kl_reg_loss: 56847.3281; val_edge_recon_loss: 759875.2917; val_gene_expr_recon_loss: 20496475.0667; val_masked_gp_l1_reg_loss: 80506.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174859.2344; val_chrom_access_recon_loss: 10629998.9333; val_global_loss: 32198562.4000; val_optim_loss: 32198562.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8981; val_auprc_score: 0.8870; val_best_acc_score: 0.8147; val_best_f1_score: 0.8305; train_kl_reg_loss: 58674.3320; train_edge_recon_loss: 676696.9122; train_gene_expr_recon_loss: 20317756.7634; train_masked_gp_l1_reg_loss: 82659.8067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151601.3241; train_chrom_access_recon_loss: 10551366.7786; train_global_loss: 31838755.9237; train_optim_loss: 31838755.9237; val_kl_reg_loss: 64195.2143; val_edge_recon_loss: 645684.2417; val_gene_expr_recon_loss: 20392332.1333; val_masked_gp_l1_reg_loss: 84523.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131356.5469; val_chrom_access_recon_loss: 10573710.9333; val_global_loss: 31891802.2667; val_optim_loss: 31891802.2667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9063; val_auprc_score: 0.8926; val_best_acc_score: 0.8234; val_best_f1_score: 0.8381; train_kl_reg_loss: 66987.2749; train_edge_recon_loss: 629434.0945; train_gene_expr_recon_loss: 20150573.3588; train_masked_gp_l1_reg_loss: 86227.8196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120255.0603; train_chrom_access_recon_loss: 10470799.4046; train_global_loss: 31524277.1450; train_optim_loss: 31524277.1450; val_kl_reg_loss: 65593.3438; val_edge_recon_loss: 620609.9833; val_gene_expr_recon_loss: 20213712.4000; val_masked_gp_l1_reg_loss: 87573.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110925.1562; val_chrom_access_recon_loss: 10510387.8667; val_global_loss: 31608803.3333; val_optim_loss: 31608803.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9111; val_auprc_score: 0.8997; val_best_acc_score: 0.8244; val_best_f1_score: 0.8388; train_kl_reg_loss: 66809.9513; train_edge_recon_loss: 617110.8168; train_gene_expr_recon_loss: 19974392.9313; train_masked_gp_l1_reg_loss: 88588.4829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104235.9373; train_chrom_access_recon_loss: 10384289.3435; train_global_loss: 31235427.3435; train_optim_loss: 31235427.3435; val_kl_reg_loss: 68640.8073; val_edge_recon_loss: 616928.5167; val_gene_expr_recon_loss: 20053619.8667; val_masked_gp_l1_reg_loss: 89792.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98768.6250; val_chrom_access_recon_loss: 10389730.7333; val_global_loss: 31317480.1333; val_optim_loss: 31317480.1333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9237; val_auprc_score: 0.9128; val_best_acc_score: 0.8473; val_best_f1_score: 0.8566; train_kl_reg_loss: 65757.0995; train_edge_recon_loss: 608443.5864; train_gene_expr_recon_loss: 19867824.8702; train_masked_gp_l1_reg_loss: 90405.6219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95075.0346; train_chrom_access_recon_loss: 10319640.1145; train_global_loss: 31047146.3511; train_optim_loss: 31047146.3511; val_kl_reg_loss: 65971.1820; val_edge_recon_loss: 606443.6792; val_gene_expr_recon_loss: 19974838.0000; val_masked_gp_l1_reg_loss: 91480.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92777.1250; val_chrom_access_recon_loss: 10388950.2667; val_global_loss: 31220461.0667; val_optim_loss: 31220461.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9334; val_auprc_score: 0.9222; val_best_acc_score: 0.8607; val_best_f1_score: 0.8680; train_kl_reg_loss: 64576.1091; train_edge_recon_loss: 603394.0243; train_gene_expr_recon_loss: 19718487.0840; train_masked_gp_l1_reg_loss: 91860.3253; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90892.7505; train_chrom_access_recon_loss: 10250997.5954; train_global_loss: 30820207.9237; train_optim_loss: 30820207.9237; val_kl_reg_loss: 62579.8383; val_edge_recon_loss: 597562.6125; val_gene_expr_recon_loss: 19816566.4000; val_masked_gp_l1_reg_loss: 92107.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88382.4531; val_chrom_access_recon_loss: 10269329.0667; val_global_loss: 30926527.8667; val_optim_loss: 30926527.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9379; val_auprc_score: 0.9266; val_best_acc_score: 0.8612; val_best_f1_score: 0.8695; train_kl_reg_loss: 63511.4004; train_edge_recon_loss: 599417.9962; train_gene_expr_recon_loss: 19602480.0916; train_masked_gp_l1_reg_loss: 93028.0793; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87738.3848; train_chrom_access_recon_loss: 10173668.6336; train_global_loss: 30619844.2901; train_optim_loss: 30619844.2901; val_kl_reg_loss: 62495.0516; val_edge_recon_loss: 599028.0000; val_gene_expr_recon_loss: 19778101.3333; val_masked_gp_l1_reg_loss: 93530.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86376.5312; val_chrom_access_recon_loss: 10262743.6667; val_global_loss: 30882274.0000; val_optim_loss: 30882274.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9444; val_auprc_score: 0.9352; val_best_acc_score: 0.8778; val_best_f1_score: 0.8820; train_kl_reg_loss: 62418.4475; train_edge_recon_loss: 596549.4141; train_gene_expr_recon_loss: 19494404.1374; train_masked_gp_l1_reg_loss: 94122.9030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85280.1310; train_chrom_access_recon_loss: 10118183.9084; train_global_loss: 30450958.9313; train_optim_loss: 30450958.9313; val_kl_reg_loss: 61725.3193; val_edge_recon_loss: 592920.9833; val_gene_expr_recon_loss: 19564322.6667; val_masked_gp_l1_reg_loss: 94445.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84045.2188; val_chrom_access_recon_loss: 10144436.6667; val_global_loss: 30541898.0000; val_optim_loss: 30541898.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9499; val_auprc_score: 0.9382; val_best_acc_score: 0.8859; val_best_f1_score: 0.8909; train_kl_reg_loss: 61994.7712; train_edge_recon_loss: 592435.6331; train_gene_expr_recon_loss: 19407179.0229; train_masked_gp_l1_reg_loss: 95008.7971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83130.6240; train_chrom_access_recon_loss: 10061808.0611; train_global_loss: 30301556.7481; train_optim_loss: 30301556.7481; val_kl_reg_loss: 60755.9708; val_edge_recon_loss: 593415.3958; val_gene_expr_recon_loss: 19467975.4667; val_masked_gp_l1_reg_loss: 95617.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82708.2578; val_chrom_access_recon_loss: 10122670.0667; val_global_loss: 30423142.5333; val_optim_loss: 30423142.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9532; val_auprc_score: 0.9451; val_best_acc_score: 0.8899; val_best_f1_score: 0.8938; train_kl_reg_loss: 61118.8757; train_edge_recon_loss: 589809.8483; train_gene_expr_recon_loss: 19356270.7176; train_masked_gp_l1_reg_loss: 95947.6706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81454.8357; train_chrom_access_recon_loss: 10031219.1450; train_global_loss: 30215821.1145; train_optim_loss: 30215821.1145; val_kl_reg_loss: 60023.9055; val_edge_recon_loss: 590015.9375; val_gene_expr_recon_loss: 19502224.9333; val_masked_gp_l1_reg_loss: 96487.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80958.7734; val_chrom_access_recon_loss: 10115886.1333; val_global_loss: 30445596.8000; val_optim_loss: 30445596.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9530; val_auprc_score: 0.9436; val_best_acc_score: 0.8899; val_best_f1_score: 0.8933; train_kl_reg_loss: 60452.1655; train_edge_recon_loss: 587631.9146; train_gene_expr_recon_loss: 19252652.2290; train_masked_gp_l1_reg_loss: 96815.2293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80206.0568; train_chrom_access_recon_loss: 9949551.0153; train_global_loss: 30027308.7939; train_optim_loss: 30027308.7939; val_kl_reg_loss: 58771.0073; val_edge_recon_loss: 591193.4125; val_gene_expr_recon_loss: 19452179.6000; val_masked_gp_l1_reg_loss: 97493.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80376.9922; val_chrom_access_recon_loss: 10011205.9333; val_global_loss: 30291219.8667; val_optim_loss: 30291219.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9572; val_auprc_score: 0.9486; val_best_acc_score: 0.8948; val_best_f1_score: 0.8991; train_kl_reg_loss: 60068.1512; train_edge_recon_loss: 584700.3411; train_gene_expr_recon_loss: 19187995.8931; train_masked_gp_l1_reg_loss: 97705.9555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79481.8505; train_chrom_access_recon_loss: 9896518.0153; train_global_loss: 29906470.3969; train_optim_loss: 29906470.3969; val_kl_reg_loss: 58000.1987; val_edge_recon_loss: 587840.5583; val_gene_expr_recon_loss: 19358750.6667; val_masked_gp_l1_reg_loss: 98041.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79324.7344; val_chrom_access_recon_loss: 9958868.3333; val_global_loss: 30140825.7333; val_optim_loss: 30140825.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9596; val_auprc_score: 0.9515; val_best_acc_score: 0.9000; val_best_f1_score: 0.9017; train_kl_reg_loss: 59132.7271; train_edge_recon_loss: 585472.0229; train_gene_expr_recon_loss: 19120313.6794; train_masked_gp_l1_reg_loss: 98662.3968; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78772.3808; train_chrom_access_recon_loss: 9853268.5725; train_global_loss: 29795621.7710; train_optim_loss: 29795621.7710; val_kl_reg_loss: 59057.4464; val_edge_recon_loss: 584394.4542; val_gene_expr_recon_loss: 19270621.2000; val_masked_gp_l1_reg_loss: 99351.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79096.8359; val_chrom_access_recon_loss: 9923328.3333; val_global_loss: 30015849.6000; val_optim_loss: 30015849.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9583; val_auprc_score: 0.9507; val_best_acc_score: 0.8972; val_best_f1_score: 0.9002; train_kl_reg_loss: 59045.2716; train_edge_recon_loss: 583716.9528; train_gene_expr_recon_loss: 19049689.7099; train_masked_gp_l1_reg_loss: 99772.8966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78613.8768; train_chrom_access_recon_loss: 9798132.1374; train_global_loss: 29668970.9008; train_optim_loss: 29668970.9008; val_kl_reg_loss: 58791.5969; val_edge_recon_loss: 588558.6500; val_gene_expr_recon_loss: 19178006.4000; val_masked_gp_l1_reg_loss: 100216.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78535.7969; val_chrom_access_recon_loss: 9886407.2000; val_global_loss: 29890515.6000; val_optim_loss: 29890515.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9598; val_auprc_score: 0.9521; val_best_acc_score: 0.8996; val_best_f1_score: 0.9042; train_kl_reg_loss: 58582.2124; train_edge_recon_loss: 582116.6613; train_gene_expr_recon_loss: 18978594.7939; train_masked_gp_l1_reg_loss: 100874.5393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78566.8958; train_chrom_access_recon_loss: 9728364.9847; train_global_loss: 29527100.1832; train_optim_loss: 29527100.1832; val_kl_reg_loss: 56250.4784; val_edge_recon_loss: 586488.2208; val_gene_expr_recon_loss: 19177013.3333; val_masked_gp_l1_reg_loss: 101682.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78872.1797; val_chrom_access_recon_loss: 9889221.0667; val_global_loss: 29889527.2000; val_optim_loss: 29889527.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9595; val_auprc_score: 0.9498; val_best_acc_score: 0.9019; val_best_f1_score: 0.9047; train_kl_reg_loss: 58210.5655; train_edge_recon_loss: 582365.3030; train_gene_expr_recon_loss: 18948765.6794; train_masked_gp_l1_reg_loss: 102353.9953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78650.0033; train_chrom_access_recon_loss: 9696253.6107; train_global_loss: 29466599.1298; train_optim_loss: 29466599.1298; val_kl_reg_loss: 57864.7714; val_edge_recon_loss: 584688.9042; val_gene_expr_recon_loss: 19055856.2667; val_masked_gp_l1_reg_loss: 102996.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78999.1328; val_chrom_access_recon_loss: 9766720.2000; val_global_loss: 29647126.0000; val_optim_loss: 29647126.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9598; val_auprc_score: 0.9489; val_best_acc_score: 0.9022; val_best_f1_score: 0.9055; train_kl_reg_loss: 58071.9554; train_edge_recon_loss: 580317.3354; train_gene_expr_recon_loss: 18888791.2214; train_masked_gp_l1_reg_loss: 103692.4319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78935.0979; train_chrom_access_recon_loss: 9637861.9924; train_global_loss: 29347670.0000; train_optim_loss: 29347670.0000; val_kl_reg_loss: 58879.0487; val_edge_recon_loss: 582412.7417; val_gene_expr_recon_loss: 19013779.3333; val_masked_gp_l1_reg_loss: 104507.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79970.9141; val_chrom_access_recon_loss: 9702314.6667; val_global_loss: 29541863.8667; val_optim_loss: 29541863.8667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9596; val_auprc_score: 0.9518; val_best_acc_score: 0.9008; val_best_f1_score: 0.9047; train_kl_reg_loss: 58008.1601; train_edge_recon_loss: 581836.7567; train_gene_expr_recon_loss: 18825411.1450; train_masked_gp_l1_reg_loss: 105056.9015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79268.9866; train_chrom_access_recon_loss: 9591587.6794; train_global_loss: 29241169.6794; train_optim_loss: 29241169.6794; val_kl_reg_loss: 58575.0898; val_edge_recon_loss: 585778.5875; val_gene_expr_recon_loss: 18956016.1333; val_masked_gp_l1_reg_loss: 105587.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79303.9141; val_chrom_access_recon_loss: 9682360.3333; val_global_loss: 29467622.1333; val_optim_loss: 29467622.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9621; val_auprc_score: 0.9512; val_best_acc_score: 0.9095; val_best_f1_score: 0.9126; train_kl_reg_loss: 57783.7185; train_edge_recon_loss: 580820.2152; train_gene_expr_recon_loss: 18769073.2366; train_masked_gp_l1_reg_loss: 106271.1948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79452.2960; train_chrom_access_recon_loss: 9540192.9847; train_global_loss: 29133593.7099; train_optim_loss: 29133593.7099; val_kl_reg_loss: 57650.7656; val_edge_recon_loss: 583049.1208; val_gene_expr_recon_loss: 18958597.4667; val_masked_gp_l1_reg_loss: 106750.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80019.8125; val_chrom_access_recon_loss: 9673488.1333; val_global_loss: 29459555.4667; val_optim_loss: 29459555.4667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9623; val_auprc_score: 0.9519; val_best_acc_score: 0.9050; val_best_f1_score: 0.9095; train_kl_reg_loss: 57912.8995; train_edge_recon_loss: 579136.4418; train_gene_expr_recon_loss: 18723001.8168; train_masked_gp_l1_reg_loss: 107462.6961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79663.6610; train_chrom_access_recon_loss: 9499837.9313; train_global_loss: 29047015.4656; train_optim_loss: 29047015.4656; val_kl_reg_loss: 57659.0755; val_edge_recon_loss: 584702.4417; val_gene_expr_recon_loss: 18874164.4000; val_masked_gp_l1_reg_loss: 107806.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79142.0234; val_chrom_access_recon_loss: 9632609.4667; val_global_loss: 29336083.4667; val_optim_loss: 29336083.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9598; val_auprc_score: 0.9473; val_best_acc_score: 0.9050; val_best_f1_score: 0.9081; train_kl_reg_loss: 57795.8762; train_edge_recon_loss: 580373.0792; train_gene_expr_recon_loss: 18672297.6489; train_masked_gp_l1_reg_loss: 108580.4259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79787.8417; train_chrom_access_recon_loss: 9447215.0916; train_global_loss: 28946049.9084; train_optim_loss: 28946049.9084; val_kl_reg_loss: 56867.0732; val_edge_recon_loss: 584126.9500; val_gene_expr_recon_loss: 18889494.8000; val_masked_gp_l1_reg_loss: 109180.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79818.5703; val_chrom_access_recon_loss: 9625240.7333; val_global_loss: 29344727.4667; val_optim_loss: 29344727.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9632; val_auprc_score: 0.9535; val_best_acc_score: 0.9091; val_best_f1_score: 0.9114; train_kl_reg_loss: 57980.8279; train_edge_recon_loss: 579237.3845; train_gene_expr_recon_loss: 18626652.0916; train_masked_gp_l1_reg_loss: 109722.8380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80036.5582; train_chrom_access_recon_loss: 9411822.6336; train_global_loss: 28865452.3511; train_optim_loss: 28865452.3511; val_kl_reg_loss: 58759.8229; val_edge_recon_loss: 582809.5375; val_gene_expr_recon_loss: 18863541.0667; val_masked_gp_l1_reg_loss: 110223.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80133.9531; val_chrom_access_recon_loss: 9661208.9333; val_global_loss: 29356677.3333; val_optim_loss: 29356677.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9622; val_auprc_score: 0.9516; val_best_acc_score: 0.9057; val_best_f1_score: 0.9100; train_kl_reg_loss: 58476.5435; train_edge_recon_loss: 579635.4609; train_gene_expr_recon_loss: 18575478.0458; train_masked_gp_l1_reg_loss: 110655.2682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80483.4720; train_chrom_access_recon_loss: 9374656.5802; train_global_loss: 28779385.4351; train_optim_loss: 28779385.4351; val_kl_reg_loss: 58588.5065; val_edge_recon_loss: 584999.3167; val_gene_expr_recon_loss: 18780976.2667; val_masked_gp_l1_reg_loss: 110964.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81107.3281; val_chrom_access_recon_loss: 9543557.9333; val_global_loss: 29160193.8667; val_optim_loss: 29160193.8667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9635; val_auprc_score: 0.9537; val_best_acc_score: 0.9111; val_best_f1_score: 0.9150; train_kl_reg_loss: 58942.9717; train_edge_recon_loss: 580164.3435; train_gene_expr_recon_loss: 18555260.6565; train_masked_gp_l1_reg_loss: 111270.1385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80748.0848; train_chrom_access_recon_loss: 9360961.5725; train_global_loss: 28747347.5725; train_optim_loss: 28747347.5725; val_kl_reg_loss: 60645.8938; val_edge_recon_loss: 583178.6458; val_gene_expr_recon_loss: 18784897.8667; val_masked_gp_l1_reg_loss: 112746.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80647.6875; val_chrom_access_recon_loss: 9541635.8667; val_global_loss: 29163752.1333; val_optim_loss: 29163752.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9623; val_auprc_score: 0.9528; val_best_acc_score: 0.9099; val_best_f1_score: 0.9139; train_kl_reg_loss: 59801.8681; train_edge_recon_loss: 580195.6312; train_gene_expr_recon_loss: 18517209.7710; train_masked_gp_l1_reg_loss: 112313.3438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80732.2934; train_chrom_access_recon_loss: 9333080.9389; train_global_loss: 28683333.9389; train_optim_loss: 28683333.9389; val_kl_reg_loss: 58691.7318; val_edge_recon_loss: 585071.0208; val_gene_expr_recon_loss: 18808820.0000; val_masked_gp_l1_reg_loss: 112244.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81685.6953; val_chrom_access_recon_loss: 9561641.7333; val_global_loss: 29208154.5333; val_optim_loss: 29208154.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9629; val_auprc_score: 0.9517; val_best_acc_score: 0.9084; val_best_f1_score: 0.9117; train_kl_reg_loss: 58803.1785; train_edge_recon_loss: 582364.6617; train_gene_expr_recon_loss: 18496848.0153; train_masked_gp_l1_reg_loss: 113084.1054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81480.2648; train_chrom_access_recon_loss: 9325643.9351; train_global_loss: 28658224.0611; train_optim_loss: 28658224.0611; val_kl_reg_loss: 61061.5779; val_edge_recon_loss: 584274.1125; val_gene_expr_recon_loss: 18746269.4667; val_masked_gp_l1_reg_loss: 114118.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81945.2578; val_chrom_access_recon_loss: 9510799.2667; val_global_loss: 29098468.5333; val_optim_loss: 29098468.5333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9660; val_auprc_score: 0.9574; val_best_acc_score: 0.9143; val_best_f1_score: 0.9179; train_kl_reg_loss: 59300.6912; train_edge_recon_loss: 583319.4871; train_gene_expr_recon_loss: 18602005.2672; train_masked_gp_l1_reg_loss: 114404.3356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82802.4193; train_chrom_access_recon_loss: 9406384.9466; train_global_loss: 28848217.1298; train_optim_loss: 28848217.1298; val_kl_reg_loss: 61125.0391; val_edge_recon_loss: 580555.3250; val_gene_expr_recon_loss: 18716564.0000; val_masked_gp_l1_reg_loss: 112717.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82514.1172; val_chrom_access_recon_loss: 9572407.8667; val_global_loss: 29125884.2667; val_optim_loss: 29125884.2667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9656; val_auprc_score: 0.9576; val_best_acc_score: 0.9116; val_best_f1_score: 0.9152; train_kl_reg_loss: 60643.3206; train_edge_recon_loss: 582983.4895; train_gene_expr_recon_loss: 18509081.6641; train_masked_gp_l1_reg_loss: 112961.1329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81596.8784; train_chrom_access_recon_loss: 9382655.2977; train_global_loss: 28729921.7863; train_optim_loss: 28729921.7863; val_kl_reg_loss: 59064.5284; val_edge_recon_loss: 590691.8250; val_gene_expr_recon_loss: 18766663.6000; val_masked_gp_l1_reg_loss: 115954.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81969.3438; val_chrom_access_recon_loss: 9557506.1333; val_global_loss: 29171850.1333; val_optim_loss: 29171850.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9605; val_auprc_score: 0.9501; val_best_acc_score: 0.9029; val_best_f1_score: 0.9078; train_kl_reg_loss: 63866.5839; train_edge_recon_loss: 583432.8531; train_gene_expr_recon_loss: 18555913.1603; train_masked_gp_l1_reg_loss: 114208.6447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83264.1109; train_chrom_access_recon_loss: 9431219.5038; train_global_loss: 28831904.6260; train_optim_loss: 28831904.6260; val_kl_reg_loss: 55647.6435; val_edge_recon_loss: 585102.2833; val_gene_expr_recon_loss: 18839803.3333; val_masked_gp_l1_reg_loss: 111559.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82913.3984; val_chrom_access_recon_loss: 9621002.7333; val_global_loss: 29296030.0000; val_optim_loss: 29296030.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8903; val_auprc_score: 0.8866; val_best_acc_score: 0.8034; val_best_f1_score: 0.8159; train_kl_reg_loss: 67792289.9725; train_edge_recon_loss: 696685.2662; train_gene_expr_recon_loss: 19478714.4275; train_masked_gp_l1_reg_loss: 152367.2626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108817.4132; train_chrom_access_recon_loss: 10357364.5115; train_global_loss: 98586237.6489; train_optim_loss: 98586237.6489; val_kl_reg_loss: 134906.3297; val_edge_recon_loss: 758976.7583; val_gene_expr_recon_loss: 19831426.2667; val_masked_gp_l1_reg_loss: 210494.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110728.5000; val_chrom_access_recon_loss: 10524216.4000; val_global_loss: 31570747.6000; val_optim_loss: 31570747.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8990; val_auprc_score: 0.8928; val_best_acc_score: 0.8145; val_best_f1_score: 0.8228; train_kl_reg_loss: 128066.1356; train_edge_recon_loss: 746162.3984; train_gene_expr_recon_loss: 19496715.3282; train_masked_gp_l1_reg_loss: 203049.5484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79121.7722; train_chrom_access_recon_loss: 10188450.3359; train_global_loss: 30841565.5115; train_optim_loss: 30841565.5115; val_kl_reg_loss: 124566.1146; val_edge_recon_loss: 742969.7250; val_gene_expr_recon_loss: 19510314.5333; val_masked_gp_l1_reg_loss: 196901.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69652.1562; val_chrom_access_recon_loss: 10191578.2000; val_global_loss: 30835982.4000; val_optim_loss: 30835982.4000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9062; val_auprc_score: 0.8984; val_best_acc_score: 0.8239; val_best_f1_score: 0.8342; train_kl_reg_loss: 110075.5810; train_edge_recon_loss: 729750.7190; train_gene_expr_recon_loss: 19265671.4351; train_masked_gp_l1_reg_loss: 192631.3282; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67191.3363; train_chrom_access_recon_loss: 10042284.6260; train_global_loss: 30407605.1145; train_optim_loss: 30407605.1145; val_kl_reg_loss: 138178.6693; val_edge_recon_loss: 728349.3875; val_gene_expr_recon_loss: 19301981.2000; val_masked_gp_l1_reg_loss: 188793.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65503.9531; val_chrom_access_recon_loss: 10097587.2667; val_global_loss: 30520394.6667; val_optim_loss: 30520394.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9070; val_auprc_score: 0.9004; val_best_acc_score: 0.8244; val_best_f1_score: 0.8341; train_kl_reg_loss: 171161.9082; train_edge_recon_loss: 714744.3717; train_gene_expr_recon_loss: 19253146.2748; train_masked_gp_l1_reg_loss: 185536.0204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64199.8746; train_chrom_access_recon_loss: 10037008.8626; train_global_loss: 30425797.3435; train_optim_loss: 30425797.3435; val_kl_reg_loss: 95085.3464; val_edge_recon_loss: 716531.3083; val_gene_expr_recon_loss: 19194512.8000; val_masked_gp_l1_reg_loss: 182478.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63241.1836; val_chrom_access_recon_loss: 10060475.8667; val_global_loss: 30312325.2000; val_optim_loss: 30312325.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9078; val_auprc_score: 0.8995; val_best_acc_score: 0.8263; val_best_f1_score: 0.8376; train_kl_reg_loss: 92472.6416; train_edge_recon_loss: 702375.2529; train_gene_expr_recon_loss: 19196454.4427; train_masked_gp_l1_reg_loss: 179816.7835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62285.3497; train_chrom_access_recon_loss: 9981112.7099; train_global_loss: 30214517.2672; train_optim_loss: 30214517.2672; val_kl_reg_loss: 91134.7807; val_edge_recon_loss: 703103.3583; val_gene_expr_recon_loss: 19361547.3333; val_masked_gp_l1_reg_loss: 177307.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61527.2461; val_chrom_access_recon_loss: 10123562.8000; val_global_loss: 30518184.0000; val_optim_loss: 30518184.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 28 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9644
val AUPRC score: 0.9573
val best accuracy score: 0.9095
val best F1 score: 0.9133
val target rna MSE score: 1.2516
val source rna MSE score: 0.6543
val target atac MSE score: 0.3707
val source atac MSE score: 0.1088
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
