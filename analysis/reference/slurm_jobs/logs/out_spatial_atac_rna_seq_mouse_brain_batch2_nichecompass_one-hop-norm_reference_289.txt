[True]
Run timestamp: 07092023_070354_289.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '0', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '100.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_289']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 19031 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 21756, n_cat_covariates_embed_input: 0, n_hidden: 2312, n_latent: 2212, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2725
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19031
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2212, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 19031

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8035; val_auprc_score: 0.8218; val_best_acc_score: 0.5904; val_best_f1_score: 0.7036; train_kl_reg_loss: 97572.4964; train_edge_recon_loss: 3564893.7538; train_gene_expr_recon_loss: 12853609.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 694521.0589; train_chrom_access_recon_loss: 42943448.2443; train_global_loss: 60154045.1603; train_optim_loss: 60154045.1603; val_kl_reg_loss: 134908.3745; val_edge_recon_loss: 4060275.9167; val_gene_expr_recon_loss: 11798936.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 410414.0000; val_chrom_access_recon_loss: 41191200.2667; val_global_loss: 57595735.4667; val_optim_loss: 57595735.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8604; val_auprc_score: 0.8537; val_best_acc_score: 0.7642; val_best_f1_score: 0.7907; train_kl_reg_loss: 108211.7702; train_edge_recon_loss: 3512857.3244; train_gene_expr_recon_loss: 11765493.5878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 264382.2703; train_chrom_access_recon_loss: 41099361.1603; train_global_loss: 56750306.0458; train_optim_loss: 56750306.0458; val_kl_reg_loss: 78672.9240; val_edge_recon_loss: 3503990.8000; val_gene_expr_recon_loss: 11633027.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171199.3906; val_chrom_access_recon_loss: 40816629.0667; val_global_loss: 56203519.2000; val_optim_loss: 56203519.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8718; val_auprc_score: 0.8608; val_best_acc_score: 0.7759; val_best_f1_score: 0.8032; train_kl_reg_loss: 111663.8687; train_edge_recon_loss: 3063472.9676; train_gene_expr_recon_loss: 11587786.5573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132719.9698; train_chrom_access_recon_loss: 40570401.1603; train_global_loss: 55466044.5496; train_optim_loss: 55466044.5496; val_kl_reg_loss: 122348.4688; val_edge_recon_loss: 3000345.0333; val_gene_expr_recon_loss: 11463438.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104940.1641; val_chrom_access_recon_loss: 40249978.9333; val_global_loss: 54941050.4000; val_optim_loss: 54941050.4000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8879; val_auprc_score: 0.8733; val_best_acc_score: 0.7996; val_best_f1_score: 0.8147; train_kl_reg_loss: 117436.3767; train_edge_recon_loss: 2954029.1927; train_gene_expr_recon_loss: 11443321.0687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89707.5106; train_chrom_access_recon_loss: 40189235.9389; train_global_loss: 54793729.8321; train_optim_loss: 54793729.8321; val_kl_reg_loss: 102706.1401; val_edge_recon_loss: 2958415.6167; val_gene_expr_recon_loss: 11323912.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78087.0938; val_chrom_access_recon_loss: 39905173.8667; val_global_loss: 54368295.7333; val_optim_loss: 54368295.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8979; val_auprc_score: 0.8799; val_best_acc_score: 0.8188; val_best_f1_score: 0.8317; train_kl_reg_loss: 106730.6565; train_edge_recon_loss: 2912106.4351; train_gene_expr_recon_loss: 11328799.2824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70435.6999; train_chrom_access_recon_loss: 39820546.1374; train_global_loss: 54238618.2595; train_optim_loss: 54238618.2595; val_kl_reg_loss: 105319.7786; val_edge_recon_loss: 2896552.7333; val_gene_expr_recon_loss: 11218186.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64229.0391; val_chrom_access_recon_loss: 39650766.4000; val_global_loss: 53935054.6667; val_optim_loss: 53935054.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9142; val_auprc_score: 0.8946; val_best_acc_score: 0.8405; val_best_f1_score: 0.8511; train_kl_reg_loss: 102745.0949; train_edge_recon_loss: 2872245.7710; train_gene_expr_recon_loss: 11224778.5115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60016.7065; train_chrom_access_recon_loss: 39477195.7252; train_global_loss: 53736981.7405; train_optim_loss: 53736981.7405; val_kl_reg_loss: 99761.3057; val_edge_recon_loss: 2859647.3667; val_gene_expr_recon_loss: 11098873.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56537.4023; val_chrom_access_recon_loss: 39295615.7333; val_global_loss: 53410434.9333; val_optim_loss: 53410434.9333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9346; val_auprc_score: 0.9196; val_best_acc_score: 0.8689; val_best_f1_score: 0.8749; train_kl_reg_loss: 102214.8802; train_edge_recon_loss: 2813429.7156; train_gene_expr_recon_loss: 11131774.3817; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53767.3766; train_chrom_access_recon_loss: 39171253.7710; train_global_loss: 53272440.1221; train_optim_loss: 53272440.1221; val_kl_reg_loss: 105237.3609; val_edge_recon_loss: 2793567.0167; val_gene_expr_recon_loss: 11040451.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51201.3555; val_chrom_access_recon_loss: 38959730.4000; val_global_loss: 52950186.9333; val_optim_loss: 52950186.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9321; val_auprc_score: 0.9147; val_best_acc_score: 0.8658; val_best_f1_score: 0.8736; train_kl_reg_loss: 101896.2878; train_edge_recon_loss: 2782838.3302; train_gene_expr_recon_loss: 11058254.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49232.7607; train_chrom_access_recon_loss: 38978025.7405; train_global_loss: 52970247.7252; train_optim_loss: 52970247.7252; val_kl_reg_loss: 100402.4354; val_edge_recon_loss: 2792456.8667; val_gene_expr_recon_loss: 10993003.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47282.5742; val_chrom_access_recon_loss: 38843598.1333; val_global_loss: 52776744.2667; val_optim_loss: 52776744.2667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9345; val_auprc_score: 0.9147; val_best_acc_score: 0.8736; val_best_f1_score: 0.8804; train_kl_reg_loss: 100446.0833; train_edge_recon_loss: 2766278.9027; train_gene_expr_recon_loss: 10979310.8473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45678.4297; train_chrom_access_recon_loss: 38663339.5725; train_global_loss: 52555053.8626; train_optim_loss: 52555053.8626; val_kl_reg_loss: 98939.6646; val_edge_recon_loss: 2769613.9000; val_gene_expr_recon_loss: 10871963.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44408.4609; val_chrom_access_recon_loss: 38566365.6000; val_global_loss: 52351291.2000; val_optim_loss: 52351291.2000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9348; val_auprc_score: 0.9123; val_best_acc_score: 0.8769; val_best_f1_score: 0.8851; train_kl_reg_loss: 98344.6441; train_edge_recon_loss: 2749939.1832; train_gene_expr_recon_loss: 10915429.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42975.8827; train_chrom_access_recon_loss: 38424683.6031; train_global_loss: 52231372.4885; train_optim_loss: 52231372.4885; val_kl_reg_loss: 96591.4307; val_edge_recon_loss: 2777159.4500; val_gene_expr_recon_loss: 10852493.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42047.0742; val_chrom_access_recon_loss: 38237260.5333; val_global_loss: 52005552.8000; val_optim_loss: 52005552.8000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9497; val_auprc_score: 0.9357; val_best_acc_score: 0.8887; val_best_f1_score: 0.8944; train_kl_reg_loss: 95715.2477; train_edge_recon_loss: 2735815.6622; train_gene_expr_recon_loss: 10859593.8321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41015.1833; train_chrom_access_recon_loss: 38199415.3282; train_global_loss: 51931555.3282; train_optim_loss: 51931555.3282; val_kl_reg_loss: 93223.6661; val_edge_recon_loss: 2736120.0667; val_gene_expr_recon_loss: 10789512.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 40053.5234; val_chrom_access_recon_loss: 38102392.8000; val_global_loss: 51761303.2000; val_optim_loss: 51761303.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9471; val_auprc_score: 0.9324; val_best_acc_score: 0.8868; val_best_f1_score: 0.8925; train_kl_reg_loss: 91578.3319; train_edge_recon_loss: 2736014.5725; train_gene_expr_recon_loss: 10804011.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 39378.5522; train_chrom_access_recon_loss: 37966387.9084; train_global_loss: 51637371.2672; train_optim_loss: 51637371.2672; val_kl_reg_loss: 90790.8333; val_edge_recon_loss: 2752292.1500; val_gene_expr_recon_loss: 10729670.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 38708.4961; val_chrom_access_recon_loss: 37855503.7333; val_global_loss: 51466965.3333; val_optim_loss: 51466965.3333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9496; val_auprc_score: 0.9340; val_best_acc_score: 0.8922; val_best_f1_score: 0.8984; train_kl_reg_loss: 88806.1936; train_edge_recon_loss: 2731239.5248; train_gene_expr_recon_loss: 10759645.3206; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 38242.0967; train_chrom_access_recon_loss: 37770939.5725; train_global_loss: 51388872.4580; train_optim_loss: 51388872.4580; val_kl_reg_loss: 88810.8260; val_edge_recon_loss: 2733752.8333; val_gene_expr_recon_loss: 10724641.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37821.5703; val_chrom_access_recon_loss: 37748829.0667; val_global_loss: 51333856.2667; val_optim_loss: 51333856.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9577; val_auprc_score: 0.9462; val_best_acc_score: 0.8983; val_best_f1_score: 0.9041; train_kl_reg_loss: 88576.1975; train_edge_recon_loss: 2723036.7195; train_gene_expr_recon_loss: 10717465.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37533.7659; train_chrom_access_recon_loss: 37582030.6260; train_global_loss: 51148642.5954; train_optim_loss: 51148642.5954; val_kl_reg_loss: 88801.7776; val_edge_recon_loss: 2718671.2000; val_gene_expr_recon_loss: 10660409.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 37257.6250; val_chrom_access_recon_loss: 37626389.3333; val_global_loss: 51131530.1333; val_optim_loss: 51131530.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9565; val_auprc_score: 0.9419; val_best_acc_score: 0.8998; val_best_f1_score: 0.9050; train_kl_reg_loss: 85582.3683; train_edge_recon_loss: 2725934.0095; train_gene_expr_recon_loss: 10672615.1221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37063.9209; train_chrom_access_recon_loss: 37357884.1221; train_global_loss: 50879079.5420; train_optim_loss: 50879079.5420; val_kl_reg_loss: 83394.0224; val_edge_recon_loss: 2738227.9667; val_gene_expr_recon_loss: 10626477.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36813.7344; val_chrom_access_recon_loss: 37316265.8667; val_global_loss: 50801179.2000; val_optim_loss: 50801179.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9606; val_auprc_score: 0.9493; val_best_acc_score: 0.9045; val_best_f1_score: 0.9090; train_kl_reg_loss: 82308.6063; train_edge_recon_loss: 2717083.5821; train_gene_expr_recon_loss: 10643093.3053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36722.9665; train_chrom_access_recon_loss: 37172937.3130; train_global_loss: 50652145.7405; train_optim_loss: 50652145.7405; val_kl_reg_loss: 82920.6833; val_edge_recon_loss: 2722762.8333; val_gene_expr_recon_loss: 10603505.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36735.3984; val_chrom_access_recon_loss: 37262024.8000; val_global_loss: 50707949.3333; val_optim_loss: 50707949.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9616; val_auprc_score: 0.9518; val_best_acc_score: 0.9065; val_best_f1_score: 0.9112; train_kl_reg_loss: 81580.5761; train_edge_recon_loss: 2711995.3492; train_gene_expr_recon_loss: 10609069.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36586.4438; train_chrom_access_recon_loss: 37002326.0153; train_global_loss: 50441557.6794; train_optim_loss: 50441557.6794; val_kl_reg_loss: 80765.2073; val_edge_recon_loss: 2719507.4667; val_gene_expr_recon_loss: 10589501.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36503.3555; val_chrom_access_recon_loss: 37051306.4000; val_global_loss: 50477584.2667; val_optim_loss: 50477584.2667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9659; val_auprc_score: 0.9543; val_best_acc_score: 0.9130; val_best_f1_score: 0.9165; train_kl_reg_loss: 81252.9795; train_edge_recon_loss: 2694493.0706; train_gene_expr_recon_loss: 10570819.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36461.7162; train_chrom_access_recon_loss: 36806214.7176; train_global_loss: 50189242.4122; train_optim_loss: 50189242.4122; val_kl_reg_loss: 78839.3646; val_edge_recon_loss: 2722983.9667; val_gene_expr_recon_loss: 10516089.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36515.7500; val_chrom_access_recon_loss: 36849427.4667; val_global_loss: 50203856.8000; val_optim_loss: 50203856.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9654; val_auprc_score: 0.9567; val_best_acc_score: 0.9132; val_best_f1_score: 0.9167; train_kl_reg_loss: 77155.9345; train_edge_recon_loss: 2715600.7252; train_gene_expr_recon_loss: 10574419.5725; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36519.2237; train_chrom_access_recon_loss: 36704448.8855; train_global_loss: 50108144.2748; train_optim_loss: 50108144.2748; val_kl_reg_loss: 77889.5620; val_edge_recon_loss: 2722159.6667; val_gene_expr_recon_loss: 10536880.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36584.8320; val_chrom_access_recon_loss: 36875879.7333; val_global_loss: 50249394.9333; val_optim_loss: 50249394.9333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9618; val_auprc_score: 0.9532; val_best_acc_score: 0.9039; val_best_f1_score: 0.9095; train_kl_reg_loss: 86591.2789; train_edge_recon_loss: 2713076.0935; train_gene_expr_recon_loss: 10590608.5420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36698.7607; train_chrom_access_recon_loss: 36701542.3511; train_global_loss: 50128517.0382; train_optim_loss: 50128517.0382; val_kl_reg_loss: 75242.8766; val_edge_recon_loss: 2722217.8000; val_gene_expr_recon_loss: 10527903.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36715.5039; val_chrom_access_recon_loss: 36788192.2667; val_global_loss: 50150272.5333; val_optim_loss: 50150272.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9659; val_auprc_score: 0.9574; val_best_acc_score: 0.9107; val_best_f1_score: 0.9146; train_kl_reg_loss: 92687.1786; train_edge_recon_loss: 2698696.2099; train_gene_expr_recon_loss: 10557696.8015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36649.0444; train_chrom_access_recon_loss: 36553438.0916; train_global_loss: 49939167.4504; train_optim_loss: 49939167.4504; val_kl_reg_loss: 79163.8271; val_edge_recon_loss: 2713114.0000; val_gene_expr_recon_loss: 10491819.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36682.2344; val_chrom_access_recon_loss: 36480972.8000; val_global_loss: 49801752.0000; val_optim_loss: 49801752.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9677; val_auprc_score: 0.9596; val_best_acc_score: 0.9163; val_best_f1_score: 0.9195; train_kl_reg_loss: 82376.6988; train_edge_recon_loss: 2694140.6031; train_gene_expr_recon_loss: 10520695.4351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36602.1189; train_chrom_access_recon_loss: 36467957.2519; train_global_loss: 49801772.0611; train_optim_loss: 49801772.0611; val_kl_reg_loss: 80224.0031; val_edge_recon_loss: 2713022.2333; val_gene_expr_recon_loss: 10436646.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36502.1992; val_chrom_access_recon_loss: 36446828.0000; val_global_loss: 49713222.4000; val_optim_loss: 49713222.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9706; val_auprc_score: 0.9637; val_best_acc_score: 0.9202; val_best_f1_score: 0.9225; train_kl_reg_loss: 454073.3664; train_edge_recon_loss: 2706357.2634; train_gene_expr_recon_loss: 10489401.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36538.7550; train_chrom_access_recon_loss: 36332500.3664; train_global_loss: 50018871.0534; train_optim_loss: 50018871.0534; val_kl_reg_loss: 71650.2745; val_edge_recon_loss: 2717852.6000; val_gene_expr_recon_loss: 10472036.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36329.2500; val_chrom_access_recon_loss: 36450256.5333; val_global_loss: 49748125.0667; val_optim_loss: 49748125.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9672; val_auprc_score: 0.9591; val_best_acc_score: 0.9126; val_best_f1_score: 0.9168; train_kl_reg_loss: 77444.0784; train_edge_recon_loss: 2709688.8893; train_gene_expr_recon_loss: 10492104.9008; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 36557.0665; train_chrom_access_recon_loss: 36308926.9466; train_global_loss: 49624721.9237; train_optim_loss: 49624721.9237; val_kl_reg_loss: 72582.1469; val_edge_recon_loss: 2723380.7500; val_gene_expr_recon_loss: 10460362.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36634.4102; val_chrom_access_recon_loss: 36352384.0000; val_global_loss: 49645343.7333; val_optim_loss: 49645343.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9676; val_auprc_score: 0.9564; val_best_acc_score: 0.9159; val_best_f1_score: 0.9195; train_kl_reg_loss: 238739.9562; train_edge_recon_loss: 2710722.0344; train_gene_expr_recon_loss: 10503701.1908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 37031.6350; train_chrom_access_recon_loss: 36253059.3893; train_global_loss: 49743254.1069; train_optim_loss: 49743254.1069; val_kl_reg_loss: 76212.3427; val_edge_recon_loss: 2708006.4167; val_gene_expr_recon_loss: 10441342.5333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 36484.1367; val_chrom_access_recon_loss: 36231169.2000; val_global_loss: 49493214.4000; val_optim_loss: 49493214.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9747; val_auprc_score: 0.9667; val_best_acc_score: 0.9248; val_best_f1_score: 0.9274; train_kl_reg_loss: 83593.5267; train_edge_recon_loss: 2723414.9962; train_gene_expr_recon_loss: 10120605.0763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27561.0588; train_chrom_access_recon_loss: 35528096.6718; train_global_loss: 48483271.2061; train_optim_loss: 48483271.2061; val_kl_reg_loss: 98120.1823; val_edge_recon_loss: 2714974.7333; val_gene_expr_recon_loss: 10019814.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25491.8086; val_chrom_access_recon_loss: 35360911.7333; val_global_loss: 48219313.6000; val_optim_loss: 48219313.6000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9727; val_auprc_score: 0.9679; val_best_acc_score: 0.9205; val_best_f1_score: 0.9237; train_kl_reg_loss: 90839.9139; train_edge_recon_loss: 2709547.9809; train_gene_expr_recon_loss: 10072299.6489; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25338.8255; train_chrom_access_recon_loss: 35333714.8397; train_global_loss: 48231741.0687; train_optim_loss: 48231741.0687; val_kl_reg_loss: 53610.2201; val_edge_recon_loss: 2734128.0333; val_gene_expr_recon_loss: 10019039.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25187.3086; val_chrom_access_recon_loss: 35277358.4000; val_global_loss: 48109322.9333; val_optim_loss: 48109322.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9722; val_auprc_score: 0.9666; val_best_acc_score: 0.9204; val_best_f1_score: 0.9231; train_kl_reg_loss: 81441.0230; train_edge_recon_loss: 2699284.0878; train_gene_expr_recon_loss: 10079153.0992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25234.5101; train_chrom_access_recon_loss: 35317852.1832; train_global_loss: 48202964.8855; train_optim_loss: 48202964.8855; val_kl_reg_loss: 49472.4841; val_edge_recon_loss: 2719239.6333; val_gene_expr_recon_loss: 10029453.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25270.4629; val_chrom_access_recon_loss: 35125393.3333; val_global_loss: 47948828.5333; val_optim_loss: 47948828.5333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9718; val_auprc_score: 0.9642; val_best_acc_score: 0.9214; val_best_f1_score: 0.9248; train_kl_reg_loss: 77402.0014; train_edge_recon_loss: 2706751.4046; train_gene_expr_recon_loss: 10067130.8168; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25234.6290; train_chrom_access_recon_loss: 35288134.1679; train_global_loss: 48164652.8855; train_optim_loss: 48164652.8855; val_kl_reg_loss: 53012.3279; val_edge_recon_loss: 2698634.5000; val_gene_expr_recon_loss: 9975668.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25337.7617; val_chrom_access_recon_loss: 35044208.2667; val_global_loss: 47796861.0667; val_optim_loss: 47796861.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9754; val_auprc_score: 0.9700; val_best_acc_score: 0.9268; val_best_f1_score: 0.9291; train_kl_reg_loss: 76779.2861; train_edge_recon_loss: 2691718.3473; train_gene_expr_recon_loss: 10039997.1603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25323.0610; train_chrom_access_recon_loss: 35156377.3130; train_global_loss: 47990195.2366; train_optim_loss: 47990195.2366; val_kl_reg_loss: 52856.1385; val_edge_recon_loss: 2671536.7167; val_gene_expr_recon_loss: 10018494.9333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25376.9766; val_chrom_access_recon_loss: 35174890.1333; val_global_loss: 47943154.6667; val_optim_loss: 47943154.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9760; val_auprc_score: 0.9684; val_best_acc_score: 0.9279; val_best_f1_score: 0.9305; train_kl_reg_loss: 73628.7154; train_edge_recon_loss: 2687264.3817; train_gene_expr_recon_loss: 10019935.0076; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25428.3158; train_chrom_access_recon_loss: 35073967.7557; train_global_loss: 47880224.2748; train_optim_loss: 47880224.2748; val_kl_reg_loss: 52946.9836; val_edge_recon_loss: 2690516.4167; val_gene_expr_recon_loss: 9955689.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25626.0137; val_chrom_access_recon_loss: 35161842.4000; val_global_loss: 47886621.6000; val_optim_loss: 47886621.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9771; val_auprc_score: 0.9704; val_best_acc_score: 0.9317; val_best_f1_score: 0.9333; train_kl_reg_loss: 71912.4290; train_edge_recon_loss: 2668525.0172; train_gene_expr_recon_loss: 10007390.7481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25677.1957; train_chrom_access_recon_loss: 35013572.9771; train_global_loss: 47787078.3817; train_optim_loss: 47787078.3817; val_kl_reg_loss: 53055.8292; val_edge_recon_loss: 2690745.1667; val_gene_expr_recon_loss: 9939352.0667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25832.5801; val_chrom_access_recon_loss: 34831869.7333; val_global_loss: 47540855.4667; val_optim_loss: 47540855.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9782; val_auprc_score: 0.9721; val_best_acc_score: 0.9290; val_best_f1_score: 0.9319; train_kl_reg_loss: 69084.7118; train_edge_recon_loss: 2681199.9847; train_gene_expr_recon_loss: 9996282.2290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25886.1069; train_chrom_access_recon_loss: 34953354.5038; train_global_loss: 47725807.4504; train_optim_loss: 47725807.4504; val_kl_reg_loss: 53773.8453; val_edge_recon_loss: 2687610.0500; val_gene_expr_recon_loss: 9960056.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26015.6562; val_chrom_access_recon_loss: 34884121.8667; val_global_loss: 47611577.0667; val_optim_loss: 47611577.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9790; val_auprc_score: 0.9725; val_best_acc_score: 0.9326; val_best_f1_score: 0.9345; train_kl_reg_loss: 67668.5647; train_edge_recon_loss: 2674828.4733; train_gene_expr_recon_loss: 9987781.5802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26085.7283; train_chrom_access_recon_loss: 34909134.2137; train_global_loss: 47665498.5344; train_optim_loss: 47665498.5344; val_kl_reg_loss: 53085.4383; val_edge_recon_loss: 2685160.2000; val_gene_expr_recon_loss: 9965661.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26300.9707; val_chrom_access_recon_loss: 34887427.3333; val_global_loss: 47617634.6667; val_optim_loss: 47617634.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9789; val_auprc_score: 0.9737; val_best_acc_score: 0.9321; val_best_f1_score: 0.9348; train_kl_reg_loss: 64892.8494; train_edge_recon_loss: 2670442.6489; train_gene_expr_recon_loss: 9983705.4885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26312.7355; train_chrom_access_recon_loss: 34889093.3282; train_global_loss: 47634446.8397; train_optim_loss: 47634446.8397; val_kl_reg_loss: 53502.3018; val_edge_recon_loss: 2678772.0167; val_gene_expr_recon_loss: 9929042.8667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26511.8379; val_chrom_access_recon_loss: 34805045.6000; val_global_loss: 47492874.6667; val_optim_loss: 47492874.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9809; val_auprc_score: 0.9760; val_best_acc_score: 0.9353; val_best_f1_score: 0.9375; train_kl_reg_loss: 64198.2828; train_edge_recon_loss: 2662928.5782; train_gene_expr_recon_loss: 9977306.9847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26561.9576; train_chrom_access_recon_loss: 34866547.1450; train_global_loss: 47597542.8092; train_optim_loss: 47597542.8092; val_kl_reg_loss: 52782.7089; val_edge_recon_loss: 2649618.8333; val_gene_expr_recon_loss: 9953606.4667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26682.6270; val_chrom_access_recon_loss: 34845154.1333; val_global_loss: 47527845.0667; val_optim_loss: 47527845.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9778; val_auprc_score: 0.9690; val_best_acc_score: 0.9318; val_best_f1_score: 0.9332; train_kl_reg_loss: 62695.7512; train_edge_recon_loss: 2660539.4103; train_gene_expr_recon_loss: 9965009.8397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26784.5066; train_chrom_access_recon_loss: 34805881.8015; train_global_loss: 47520911.4504; train_optim_loss: 47520911.4504; val_kl_reg_loss: 51609.3315; val_edge_recon_loss: 2677964.5333; val_gene_expr_recon_loss: 9890851.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26944.7969; val_chrom_access_recon_loss: 34598118.1333; val_global_loss: 47245487.7333; val_optim_loss: 47245487.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9803; val_auprc_score: 0.9748; val_best_acc_score: 0.9356; val_best_f1_score: 0.9379; train_kl_reg_loss: 61428.3007; train_edge_recon_loss: 2661773.2023; train_gene_expr_recon_loss: 9950850.7710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26978.6882; train_chrom_access_recon_loss: 34720449.6794; train_global_loss: 47421480.4275; train_optim_loss: 47421480.4275; val_kl_reg_loss: 53621.0198; val_edge_recon_loss: 2659319.5500; val_gene_expr_recon_loss: 9943343.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27055.8477; val_chrom_access_recon_loss: 34811736.9333; val_global_loss: 47495077.0667; val_optim_loss: 47495077.0667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9814; val_auprc_score: 0.9758; val_best_acc_score: 0.9400; val_best_f1_score: 0.9422; train_kl_reg_loss: 60690.5327; train_edge_recon_loss: 2657579.5019; train_gene_expr_recon_loss: 9944206.4046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27181.0783; train_chrom_access_recon_loss: 34709394.4885; train_global_loss: 47399052.1832; train_optim_loss: 47399052.1832; val_kl_reg_loss: 51904.1115; val_edge_recon_loss: 2674960.2833; val_gene_expr_recon_loss: 9918150.8000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27208.7090; val_chrom_access_recon_loss: 34611421.0667; val_global_loss: 47283644.5333; val_optim_loss: 47283644.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9834; val_auprc_score: 0.9770; val_best_acc_score: 0.9435; val_best_f1_score: 0.9441; train_kl_reg_loss: 59150.4602; train_edge_recon_loss: 2654875.1050; train_gene_expr_recon_loss: 9939945.2748; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27240.0503; train_chrom_access_recon_loss: 34670343.2214; train_global_loss: 47351554.2290; train_optim_loss: 47351554.2290; val_kl_reg_loss: 51456.4875; val_edge_recon_loss: 2669901.7167; val_gene_expr_recon_loss: 9890946.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27345.5840; val_chrom_access_recon_loss: 34780248.2667; val_global_loss: 47419898.9333; val_optim_loss: 47419898.9333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9823; val_auprc_score: 0.9775; val_best_acc_score: 0.9413; val_best_f1_score: 0.9433; train_kl_reg_loss: 58819.5461; train_edge_recon_loss: 2651705.6336; train_gene_expr_recon_loss: 9940357.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 27398.2602; train_chrom_access_recon_loss: 34661907.2366; train_global_loss: 47340187.7557; train_optim_loss: 47340187.7557; val_kl_reg_loss: 50974.9115; val_edge_recon_loss: 2659393.5833; val_gene_expr_recon_loss: 9914711.2000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27360.2773; val_chrom_access_recon_loss: 34820382.0000; val_global_loss: 47472821.8667; val_optim_loss: 47472821.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9819; val_auprc_score: 0.9772; val_best_acc_score: 0.9395; val_best_f1_score: 0.9410; train_kl_reg_loss: 58661.6501; train_edge_recon_loss: 2655768.6870; train_gene_expr_recon_loss: 9920903.3893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25480.5200; train_chrom_access_recon_loss: 34597314.2901; train_global_loss: 47258128.3664; train_optim_loss: 47258128.3664; val_kl_reg_loss: 52065.4781; val_edge_recon_loss: 2668602.7833; val_gene_expr_recon_loss: 9902552.2667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25258.0254; val_chrom_access_recon_loss: 34862080.0000; val_global_loss: 47510558.1333; val_optim_loss: 47510558.1333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9825; val_auprc_score: 0.9756; val_best_acc_score: 0.9395; val_best_f1_score: 0.9416; train_kl_reg_loss: 59301.5882; train_edge_recon_loss: 2657640.2290; train_gene_expr_recon_loss: 9920208.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25212.5786; train_chrom_access_recon_loss: 34625419.7405; train_global_loss: 47287782.6870; train_optim_loss: 47287782.6870; val_kl_reg_loss: 52460.4729; val_edge_recon_loss: 2662603.8333; val_gene_expr_recon_loss: 9903084.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25170.3984; val_chrom_access_recon_loss: 34606093.6000; val_global_loss: 47249412.8000; val_optim_loss: 47249412.8000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9857; val_auprc_score: 0.9791; val_best_acc_score: 0.9456; val_best_f1_score: 0.9468; train_kl_reg_loss: 59544.8491; train_edge_recon_loss: 2647827.3340; train_gene_expr_recon_loss: 9915332.8931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25138.1610; train_chrom_access_recon_loss: 34597302.9771; train_global_loss: 47245146.2595; train_optim_loss: 47245146.2595; val_kl_reg_loss: 52167.1557; val_edge_recon_loss: 2658026.1000; val_gene_expr_recon_loss: 9915032.1333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25112.0840; val_chrom_access_recon_loss: 34667588.8000; val_global_loss: 47317926.6667; val_optim_loss: 47317926.6667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9828; val_auprc_score: 0.9774; val_best_acc_score: 0.9414; val_best_f1_score: 0.9433; train_kl_reg_loss: 59428.2791; train_edge_recon_loss: 2654961.0363; train_gene_expr_recon_loss: 9915857.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25076.1493; train_chrom_access_recon_loss: 34583129.1450; train_global_loss: 47238451.8779; train_optim_loss: 47238451.8779; val_kl_reg_loss: 52333.7557; val_edge_recon_loss: 2665153.5333; val_gene_expr_recon_loss: 9903823.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25064.4961; val_chrom_access_recon_loss: 34768651.7333; val_global_loss: 47415025.8667; val_optim_loss: 47415025.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 105 min 10 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9826
val AUPRC score: 0.9790
val best accuracy score: 0.9396
val best F1 score: 0.9413
val target rna MSE score: 1.3581
val source rna MSE score: 0.4756
val target atac MSE score: 0.1210
val source atac MSE score: 0.0204
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
