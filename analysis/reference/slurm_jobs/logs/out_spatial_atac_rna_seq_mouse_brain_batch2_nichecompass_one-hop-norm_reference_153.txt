[True]
Run timestamp: 10102023_051105_153.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_153']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7581; val_auprc_score: 0.7831; val_best_acc_score: 0.6314; val_best_f1_score: 0.7122; train_kl_reg_loss: 96131.5668; train_edge_recon_loss: 755747.3158; train_gene_expr_recon_loss: 21861362.2595; train_masked_gp_l1_reg_loss: 51284.0666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4043447.1880; train_chrom_access_recon_loss: 942238.3430; train_global_loss: 27750210.6107; train_optim_loss: 27750210.6107; val_kl_reg_loss: 77290.0583; val_edge_recon_loss: 811286.4417; val_gene_expr_recon_loss: 21046924.8000; val_masked_gp_l1_reg_loss: 54334.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 990078.8125; val_chrom_access_recon_loss: 923667.2125; val_global_loss: 23903580.5333; val_optim_loss: 23903580.5333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8727; val_auprc_score: 0.8754; val_best_acc_score: 0.7848; val_best_f1_score: 0.7922; train_kl_reg_loss: 81098.2136; train_edge_recon_loss: 728901.5434; train_gene_expr_recon_loss: 20859978.7939; train_masked_gp_l1_reg_loss: 57014.9196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 494933.0425; train_chrom_access_recon_loss: 914811.2972; train_global_loss: 23136737.9389; train_optim_loss: 23136737.9389; val_kl_reg_loss: 74498.5292; val_edge_recon_loss: 739245.5167; val_gene_expr_recon_loss: 20873845.7333; val_masked_gp_l1_reg_loss: 60134.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 267463.4375; val_chrom_access_recon_loss: 921078.9833; val_global_loss: 22936267.0667; val_optim_loss: 22936267.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9216; val_auprc_score: 0.9082; val_best_acc_score: 0.8533; val_best_f1_score: 0.8610; train_kl_reg_loss: 79076.5808; train_edge_recon_loss: 658564.7032; train_gene_expr_recon_loss: 20592426.7634; train_masked_gp_l1_reg_loss: 63592.1860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 206757.3542; train_chrom_access_recon_loss: 905173.2505; train_global_loss: 22505591.0076; train_optim_loss: 22505591.0076; val_kl_reg_loss: 82594.4880; val_edge_recon_loss: 629013.3667; val_gene_expr_recon_loss: 20613046.1333; val_masked_gp_l1_reg_loss: 67097.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 176141.3125; val_chrom_access_recon_loss: 909372.7042; val_global_loss: 22477266.8000; val_optim_loss: 22477266.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9344; val_auprc_score: 0.9219; val_best_acc_score: 0.8697; val_best_f1_score: 0.8746; train_kl_reg_loss: 82765.5109; train_edge_recon_loss: 617694.5930; train_gene_expr_recon_loss: 20319046.6870; train_masked_gp_l1_reg_loss: 69621.0257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165561.1931; train_chrom_access_recon_loss: 895653.1875; train_global_loss: 22150342.3053; train_optim_loss: 22150342.3053; val_kl_reg_loss: 76155.8219; val_edge_recon_loss: 619553.0000; val_gene_expr_recon_loss: 20336094.0000; val_masked_gp_l1_reg_loss: 71818.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152547.7344; val_chrom_access_recon_loss: 896478.5167; val_global_loss: 22152647.3333; val_optim_loss: 22152647.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9429; val_auprc_score: 0.9326; val_best_acc_score: 0.8800; val_best_f1_score: 0.8841; train_kl_reg_loss: 76789.7486; train_edge_recon_loss: 608980.7495; train_gene_expr_recon_loss: 20160878.7023; train_masked_gp_l1_reg_loss: 73575.0646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141619.5386; train_chrom_access_recon_loss: 888694.6546; train_global_loss: 21950538.4885; train_optim_loss: 21950538.4885; val_kl_reg_loss: 72455.9990; val_edge_recon_loss: 610551.1583; val_gene_expr_recon_loss: 20167192.6667; val_masked_gp_l1_reg_loss: 75009.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134122.7656; val_chrom_access_recon_loss: 887782.4292; val_global_loss: 21947114.5333; val_optim_loss: 21947114.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9464; val_auprc_score: 0.9366; val_best_acc_score: 0.8822; val_best_f1_score: 0.8875; train_kl_reg_loss: 73713.9987; train_edge_recon_loss: 605307.2419; train_gene_expr_recon_loss: 20009428.6260; train_masked_gp_l1_reg_loss: 76198.2854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127869.6135; train_chrom_access_recon_loss: 884299.4881; train_global_loss: 21776817.3435; train_optim_loss: 21776817.3435; val_kl_reg_loss: 71598.2375; val_edge_recon_loss: 603702.9958; val_gene_expr_recon_loss: 19986416.8000; val_masked_gp_l1_reg_loss: 77374.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123985.0859; val_chrom_access_recon_loss: 883433.0958; val_global_loss: 21746511.2000; val_optim_loss: 21746511.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9562; val_auprc_score: 0.9476; val_best_acc_score: 0.8913; val_best_f1_score: 0.8955; train_kl_reg_loss: 71608.9377; train_edge_recon_loss: 600593.3955; train_gene_expr_recon_loss: 19854647.4198; train_masked_gp_l1_reg_loss: 78390.7777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121798.8847; train_chrom_access_recon_loss: 877280.5868; train_global_loss: 21604319.9389; train_optim_loss: 21604319.9389; val_kl_reg_loss: 69761.5057; val_edge_recon_loss: 597321.3750; val_gene_expr_recon_loss: 19911348.6667; val_masked_gp_l1_reg_loss: 79394.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121554.5078; val_chrom_access_recon_loss: 876445.1167; val_global_loss: 21655824.5333; val_optim_loss: 21655824.5333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9573; val_auprc_score: 0.9494; val_best_acc_score: 0.8979; val_best_f1_score: 0.9010; train_kl_reg_loss: 70272.5532; train_edge_recon_loss: 593890.9633; train_gene_expr_recon_loss: 19739791.4046; train_masked_gp_l1_reg_loss: 80141.5332; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120902.9051; train_chrom_access_recon_loss: 872843.7777; train_global_loss: 21477843.1298; train_optim_loss: 21477843.1298; val_kl_reg_loss: 68059.7156; val_edge_recon_loss: 595252.3375; val_gene_expr_recon_loss: 19831545.3333; val_masked_gp_l1_reg_loss: 80957.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120048.3750; val_chrom_access_recon_loss: 875944.6083; val_global_loss: 21571808.2667; val_optim_loss: 21571808.2667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9603; val_auprc_score: 0.9525; val_best_acc_score: 0.8957; val_best_f1_score: 0.9003; train_kl_reg_loss: 68742.6693; train_edge_recon_loss: 592765.6613; train_gene_expr_recon_loss: 19621827.6947; train_masked_gp_l1_reg_loss: 81646.8461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118634.9414; train_chrom_access_recon_loss: 867664.1283; train_global_loss: 21351281.8321; train_optim_loss: 21351281.8321; val_kl_reg_loss: 68031.4510; val_edge_recon_loss: 595046.4375; val_gene_expr_recon_loss: 19667322.0000; val_masked_gp_l1_reg_loss: 82231.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117964.1562; val_chrom_access_recon_loss: 869721.2708; val_global_loss: 21400317.2000; val_optim_loss: 21400317.2000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9603; val_auprc_score: 0.9505; val_best_acc_score: 0.9030; val_best_f1_score: 0.9065; train_kl_reg_loss: 66789.2454; train_edge_recon_loss: 595151.8125; train_gene_expr_recon_loss: 19557596.3053; train_masked_gp_l1_reg_loss: 82526.7566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117599.0975; train_chrom_access_recon_loss: 865687.4656; train_global_loss: 21285350.6565; train_optim_loss: 21285350.6565; val_kl_reg_loss: 68209.2849; val_edge_recon_loss: 593469.6500; val_gene_expr_recon_loss: 19670790.9333; val_masked_gp_l1_reg_loss: 82552.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115259.2578; val_chrom_access_recon_loss: 867757.8833; val_global_loss: 21398039.6000; val_optim_loss: 21398039.6000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9636; val_auprc_score: 0.9590; val_best_acc_score: 0.9026; val_best_f1_score: 0.9048; train_kl_reg_loss: 66118.0909; train_edge_recon_loss: 591187.5196; train_gene_expr_recon_loss: 19452606.3511; train_masked_gp_l1_reg_loss: 83172.4785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113888.2202; train_chrom_access_recon_loss: 860763.2013; train_global_loss: 21167735.7405; train_optim_loss: 21167735.7405; val_kl_reg_loss: 65170.7318; val_edge_recon_loss: 591955.2125; val_gene_expr_recon_loss: 19489169.4667; val_masked_gp_l1_reg_loss: 83714.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113580.6719; val_chrom_access_recon_loss: 861049.4083; val_global_loss: 21204638.9333; val_optim_loss: 21204638.9333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9621; val_auprc_score: 0.9516; val_best_acc_score: 0.9047; val_best_f1_score: 0.9081; train_kl_reg_loss: 65434.3548; train_edge_recon_loss: 587058.5124; train_gene_expr_recon_loss: 19356518.1679; train_masked_gp_l1_reg_loss: 84256.2103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112186.0779; train_chrom_access_recon_loss: 857014.4380; train_global_loss: 21062467.7710; train_optim_loss: 21062467.7710; val_kl_reg_loss: 62663.3299; val_edge_recon_loss: 587344.7958; val_gene_expr_recon_loss: 19345422.9333; val_masked_gp_l1_reg_loss: 84727.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112470.3594; val_chrom_access_recon_loss: 857431.6792; val_global_loss: 21050061.2000; val_optim_loss: 21050061.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9633; val_auprc_score: 0.9545; val_best_acc_score: 0.9038; val_best_f1_score: 0.9068; train_kl_reg_loss: 64616.4756; train_edge_recon_loss: 585630.7261; train_gene_expr_recon_loss: 19259746.2748; train_masked_gp_l1_reg_loss: 85300.2711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110615.5923; train_chrom_access_recon_loss: 851862.8960; train_global_loss: 20957772.3359; train_optim_loss: 20957772.3359; val_kl_reg_loss: 64790.8695; val_edge_recon_loss: 586894.3958; val_gene_expr_recon_loss: 19356027.6000; val_masked_gp_l1_reg_loss: 85686.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109962.9922; val_chrom_access_recon_loss: 856562.4458; val_global_loss: 21059923.4667; val_optim_loss: 21059923.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9683; val_auprc_score: 0.9605; val_best_acc_score: 0.9173; val_best_f1_score: 0.9191; train_kl_reg_loss: 63206.6715; train_edge_recon_loss: 585597.7953; train_gene_expr_recon_loss: 19203475.8321; train_masked_gp_l1_reg_loss: 86138.9265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109580.8601; train_chrom_access_recon_loss: 849379.3473; train_global_loss: 20897379.3740; train_optim_loss: 20897379.3740; val_kl_reg_loss: 61118.0563; val_edge_recon_loss: 583087.5583; val_gene_expr_recon_loss: 19272875.8667; val_masked_gp_l1_reg_loss: 86842.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110468.5625; val_chrom_access_recon_loss: 849151.7250; val_global_loss: 20963542.6667; val_optim_loss: 20963542.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9692; val_auprc_score: 0.9633; val_best_acc_score: 0.9175; val_best_f1_score: 0.9193; train_kl_reg_loss: 62694.9353; train_edge_recon_loss: 583395.3149; train_gene_expr_recon_loss: 19132407.5115; train_masked_gp_l1_reg_loss: 87341.0516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108078.7238; train_chrom_access_recon_loss: 846982.2309; train_global_loss: 20820899.9084; train_optim_loss: 20820899.9084; val_kl_reg_loss: 62678.3620; val_edge_recon_loss: 585324.8083; val_gene_expr_recon_loss: 19204665.0667; val_masked_gp_l1_reg_loss: 87781.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107670.7344; val_chrom_access_recon_loss: 849769.4833; val_global_loss: 20897889.6000; val_optim_loss: 20897889.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9708; val_auprc_score: 0.9649; val_best_acc_score: 0.9209; val_best_f1_score: 0.9224; train_kl_reg_loss: 62090.7161; train_edge_recon_loss: 581736.9179; train_gene_expr_recon_loss: 19056397.4962; train_masked_gp_l1_reg_loss: 88458.3918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106854.1826; train_chrom_access_recon_loss: 843079.9323; train_global_loss: 20738617.7099; train_optim_loss: 20738617.7099; val_kl_reg_loss: 61839.1612; val_edge_recon_loss: 583218.2750; val_gene_expr_recon_loss: 19148470.5333; val_masked_gp_l1_reg_loss: 88999.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107138.0938; val_chrom_access_recon_loss: 847375.5375; val_global_loss: 20837041.7333; val_optim_loss: 20837041.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9669; val_auprc_score: 0.9560; val_best_acc_score: 0.9140; val_best_f1_score: 0.9167; train_kl_reg_loss: 130839.9907; train_edge_recon_loss: 592696.7886; train_gene_expr_recon_loss: 19115007.1298; train_masked_gp_l1_reg_loss: 89130.0740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110474.4889; train_chrom_access_recon_loss: 849455.0267; train_global_loss: 20887603.3893; train_optim_loss: 20887603.3893; val_kl_reg_loss: 64711.8844; val_edge_recon_loss: 603289.4333; val_gene_expr_recon_loss: 19293418.9333; val_masked_gp_l1_reg_loss: 87135.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112081.9844; val_chrom_access_recon_loss: 863080.0667; val_global_loss: 21023718.1333; val_optim_loss: 21023718.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9618; val_auprc_score: 0.9542; val_best_acc_score: 0.9043; val_best_f1_score: 0.9083; train_kl_reg_loss: 74470.9539; train_edge_recon_loss: 596974.5539; train_gene_expr_recon_loss: 19153650.6870; train_masked_gp_l1_reg_loss: 85754.7069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113767.5500; train_chrom_access_recon_loss: 851733.6279; train_global_loss: 20876352.1221; train_optim_loss: 20876352.1221; val_kl_reg_loss: 67651.4904; val_edge_recon_loss: 598640.3333; val_gene_expr_recon_loss: 19210381.7333; val_masked_gp_l1_reg_loss: 84013.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112742.0781; val_chrom_access_recon_loss: 848020.1667; val_global_loss: 20921449.0667; val_optim_loss: 20921449.0667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9586; val_auprc_score: 0.9507; val_best_acc_score: 0.8985; val_best_f1_score: 0.9015; train_kl_reg_loss: 65332.6581; train_edge_recon_loss: 597419.4375; train_gene_expr_recon_loss: 19080985.6489; train_masked_gp_l1_reg_loss: 83902.6702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113571.6573; train_chrom_access_recon_loss: 845665.9943; train_global_loss: 20786878.0916; train_optim_loss: 20786878.0916; val_kl_reg_loss: 61989.1802; val_edge_recon_loss: 602170.9042; val_gene_expr_recon_loss: 19173308.1333; val_masked_gp_l1_reg_loss: 84361.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112561.9375; val_chrom_access_recon_loss: 847819.7750; val_global_loss: 20882212.0000; val_optim_loss: 20882212.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9608; val_auprc_score: 0.9531; val_best_acc_score: 0.9007; val_best_f1_score: 0.9040; train_kl_reg_loss: 70872.1552; train_edge_recon_loss: 589843.7405; train_gene_expr_recon_loss: 18987911.0840; train_masked_gp_l1_reg_loss: 84325.2223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108079.6831; train_chrom_access_recon_loss: 839235.0611; train_global_loss: 20680266.8702; train_optim_loss: 20680266.8702; val_kl_reg_loss: 65646.0497; val_edge_recon_loss: 596999.0083; val_gene_expr_recon_loss: 19155345.2000; val_masked_gp_l1_reg_loss: 84454.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108999.6172; val_chrom_access_recon_loss: 849166.9500; val_global_loss: 20860610.9333; val_optim_loss: 20860610.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9596; val_auprc_score: 0.9521; val_best_acc_score: 0.8981; val_best_f1_score: 0.9015; train_kl_reg_loss: 65802.7363; train_edge_recon_loss: 587235.7758; train_gene_expr_recon_loss: 18925220.5191; train_masked_gp_l1_reg_loss: 82790.1839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75029.3033; train_chrom_access_recon_loss: 836271.3268; train_global_loss: 20572349.8321; train_optim_loss: 20572349.8321; val_kl_reg_loss: 65217.1568; val_edge_recon_loss: 590958.9667; val_gene_expr_recon_loss: 18928563.3333; val_masked_gp_l1_reg_loss: 82245.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69119.9219; val_chrom_access_recon_loss: 836336.1417; val_global_loss: 20572441.7333; val_optim_loss: 20572441.7333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9618; val_auprc_score: 0.9553; val_best_acc_score: 0.9049; val_best_f1_score: 0.9071; train_kl_reg_loss: 65772.3983; train_edge_recon_loss: 585247.5468; train_gene_expr_recon_loss: 18922962.7176; train_masked_gp_l1_reg_loss: 82198.3799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68343.9125; train_chrom_access_recon_loss: 835441.5534; train_global_loss: 20559966.4733; train_optim_loss: 20559966.4733; val_kl_reg_loss: 65635.5362; val_edge_recon_loss: 589557.7917; val_gene_expr_recon_loss: 19024233.8667; val_masked_gp_l1_reg_loss: 82181.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67686.7500; val_chrom_access_recon_loss: 843050.1250; val_global_loss: 20672345.8667; val_optim_loss: 20672345.8667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9631; val_auprc_score: 0.9562; val_best_acc_score: 0.9043; val_best_f1_score: 0.9068; train_kl_reg_loss: 65687.0927; train_edge_recon_loss: 584457.9785; train_gene_expr_recon_loss: 18883856.2595; train_masked_gp_l1_reg_loss: 82211.0685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67223.9915; train_chrom_access_recon_loss: 833930.2510; train_global_loss: 20517366.7786; train_optim_loss: 20517366.7786; val_kl_reg_loss: 65850.0148; val_edge_recon_loss: 586246.6792; val_gene_expr_recon_loss: 19024266.6667; val_masked_gp_l1_reg_loss: 82212.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66826.7188; val_chrom_access_recon_loss: 837678.0792; val_global_loss: 20663079.2000; val_optim_loss: 20663079.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9628; val_auprc_score: 0.9550; val_best_acc_score: 0.9030; val_best_f1_score: 0.9067; train_kl_reg_loss: 65875.0553; train_edge_recon_loss: 585245.9618; train_gene_expr_recon_loss: 18889096.3053; train_masked_gp_l1_reg_loss: 82289.6183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66533.6000; train_chrom_access_recon_loss: 834441.3297; train_global_loss: 20523481.8931; train_optim_loss: 20523481.8931; val_kl_reg_loss: 65693.1646; val_edge_recon_loss: 585848.3500; val_gene_expr_recon_loss: 19019221.0667; val_masked_gp_l1_reg_loss: 82353.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66317.7344; val_chrom_access_recon_loss: 840177.8208; val_global_loss: 20659612.5333; val_optim_loss: 20659612.5333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9578; val_auprc_score: 0.9477; val_best_acc_score: 0.9015; val_best_f1_score: 0.9053; train_kl_reg_loss: 67094.8757; train_edge_recon_loss: 583800.8631; train_gene_expr_recon_loss: 18912913.4962; train_masked_gp_l1_reg_loss: 82365.8140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66028.5699; train_chrom_access_recon_loss: 834343.7352; train_global_loss: 20546547.4198; train_optim_loss: 20546547.4198; val_kl_reg_loss: 66442.9062; val_edge_recon_loss: 587579.7542; val_gene_expr_recon_loss: 19018628.0000; val_masked_gp_l1_reg_loss: 82386.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65815.7812; val_chrom_access_recon_loss: 839143.9708; val_global_loss: 20659996.5333; val_optim_loss: 20659996.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9547; val_auprc_score: 0.9439; val_best_acc_score: 0.8891; val_best_f1_score: 0.8912; train_kl_reg_loss: 66253.0756; train_edge_recon_loss: 716917.5902; train_gene_expr_recon_loss: 17289563.1679; train_masked_gp_l1_reg_loss: 82171.0247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62336.6131; train_chrom_access_recon_loss: 791063.6994; train_global_loss: 19008305.2366; train_optim_loss: 19008305.2366; val_kl_reg_loss: 18705.3452; val_edge_recon_loss: 718510.2000; val_gene_expr_recon_loss: 17221887.3333; val_masked_gp_l1_reg_loss: 82066.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61638.2344; val_chrom_access_recon_loss: 781613.4333; val_global_loss: 18884420.4000; val_optim_loss: 18884420.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9523; val_auprc_score: 0.9398; val_best_acc_score: 0.8843; val_best_f1_score: 0.8853; train_kl_reg_loss: 74182.7094; train_edge_recon_loss: 705735.9833; train_gene_expr_recon_loss: 17344539.5344; train_masked_gp_l1_reg_loss: 82023.2550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61424.1195; train_chrom_access_recon_loss: 783016.7872; train_global_loss: 19050922.4733; train_optim_loss: 19050922.4733; val_kl_reg_loss: 23141.8820; val_edge_recon_loss: 717074.8875; val_gene_expr_recon_loss: 17367369.0000; val_masked_gp_l1_reg_loss: 81983.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61233.7422; val_chrom_access_recon_loss: 788998.5458; val_global_loss: 19039802.2667; val_optim_loss: 19039802.2667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9503; val_auprc_score: 0.9390; val_best_acc_score: 0.8831; val_best_f1_score: 0.8857; train_kl_reg_loss: 69998.3360; train_edge_recon_loss: 702855.6350; train_gene_expr_recon_loss: 17326523.5038; train_masked_gp_l1_reg_loss: 81952.0584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61095.9319; train_chrom_access_recon_loss: 777914.1035; train_global_loss: 19020339.5267; train_optim_loss: 19020339.5267; val_kl_reg_loss: 24596.8833; val_edge_recon_loss: 722097.5708; val_gene_expr_recon_loss: 17352868.5333; val_masked_gp_l1_reg_loss: 81911.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60952.4766; val_chrom_access_recon_loss: 779096.6375; val_global_loss: 19021523.6000; val_optim_loss: 19021523.6000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9540; val_auprc_score: 0.9448; val_best_acc_score: 0.8879; val_best_f1_score: 0.8940; train_kl_reg_loss: 70342.2508; train_edge_recon_loss: 700852.6283; train_gene_expr_recon_loss: 17320245.0458; train_masked_gp_l1_reg_loss: 81867.5227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60845.4913; train_chrom_access_recon_loss: 774627.7815; train_global_loss: 19008780.7023; train_optim_loss: 19008780.7023; val_kl_reg_loss: 23340.2865; val_edge_recon_loss: 719090.5958; val_gene_expr_recon_loss: 17299308.2667; val_masked_gp_l1_reg_loss: 81822.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60726.9297; val_chrom_access_recon_loss: 773898.1917; val_global_loss: 18958185.2000; val_optim_loss: 18958185.2000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9560; val_auprc_score: 0.9477; val_best_acc_score: 0.8903; val_best_f1_score: 0.8957; train_kl_reg_loss: 78571.2974; train_edge_recon_loss: 699969.0262; train_gene_expr_recon_loss: 17265014.2672; train_masked_gp_l1_reg_loss: 81774.6858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60625.0917; train_chrom_access_recon_loss: 772724.1908; train_global_loss: 18958678.6260; train_optim_loss: 18958678.6260; val_kl_reg_loss: 23220.5117; val_edge_recon_loss: 718742.5542; val_gene_expr_recon_loss: 17339688.2667; val_masked_gp_l1_reg_loss: 81724.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60530.4883; val_chrom_access_recon_loss: 774825.0500; val_global_loss: 18998730.5333; val_optim_loss: 18998730.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9532; val_auprc_score: 0.9450; val_best_acc_score: 0.8902; val_best_f1_score: 0.8907; train_kl_reg_loss: 71098.5617; train_edge_recon_loss: 700384.0763; train_gene_expr_recon_loss: 17249136.4580; train_masked_gp_l1_reg_loss: 81713.7973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60351.7538; train_chrom_access_recon_loss: 772469.5215; train_global_loss: 18935154.3206; train_optim_loss: 18935154.3206; val_kl_reg_loss: 23027.7603; val_edge_recon_loss: 721224.2500; val_gene_expr_recon_loss: 17335894.4000; val_masked_gp_l1_reg_loss: 81705.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60321.5781; val_chrom_access_recon_loss: 777158.3583; val_global_loss: 18999333.0667; val_optim_loss: 18999333.0667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9518; val_auprc_score: 0.9435; val_best_acc_score: 0.8874; val_best_f1_score: 0.8889; train_kl_reg_loss: 69523.1066; train_edge_recon_loss: 700135.3760; train_gene_expr_recon_loss: 17261537.7634; train_masked_gp_l1_reg_loss: 81698.6941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60308.8345; train_chrom_access_recon_loss: 769937.3602; train_global_loss: 18943141.1603; train_optim_loss: 18943141.1603; val_kl_reg_loss: 23049.0956; val_edge_recon_loss: 720040.1333; val_gene_expr_recon_loss: 17330494.1333; val_masked_gp_l1_reg_loss: 81691.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60296.1172; val_chrom_access_recon_loss: 776738.7917; val_global_loss: 18992310.2667; val_optim_loss: 18992310.2667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9526; val_auprc_score: 0.9462; val_best_acc_score: 0.8851; val_best_f1_score: 0.8862; train_kl_reg_loss: 68056.4415; train_edge_recon_loss: 699494.6212; train_gene_expr_recon_loss: 17260987.9084; train_masked_gp_l1_reg_loss: 81684.8764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60283.6322; train_chrom_access_recon_loss: 770690.0286; train_global_loss: 18941197.4198; train_optim_loss: 18941197.4198; val_kl_reg_loss: 23073.2760; val_edge_recon_loss: 722281.1708; val_gene_expr_recon_loss: 17338240.4000; val_masked_gp_l1_reg_loss: 81678.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60271.3086; val_chrom_access_recon_loss: 777530.0417; val_global_loss: 19003074.8000; val_optim_loss: 19003074.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9543; val_auprc_score: 0.9464; val_best_acc_score: 0.8848; val_best_f1_score: 0.8883; train_kl_reg_loss: 67517.2533; train_edge_recon_loss: 700033.8965; train_gene_expr_recon_loss: 17228352.1756; train_masked_gp_l1_reg_loss: 81670.8509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60259.5158; train_chrom_access_recon_loss: 769363.9852; train_global_loss: 18907197.7252; train_optim_loss: 18907197.7252; val_kl_reg_loss: 23096.3379; val_edge_recon_loss: 721041.8833; val_gene_expr_recon_loss: 17245965.8000; val_masked_gp_l1_reg_loss: 81663.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60248.1016; val_chrom_access_recon_loss: 772885.8125; val_global_loss: 18904902.0000; val_optim_loss: 18904902.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 28 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.9524
val AUPRC score: 0.9420
val best accuracy score: 0.8871
val best F1 score: 0.8916
val target rna MSE score: 2.3088
val source rna MSE score: 2.0884
val target atac MSE score: 0.5452
val source atac MSE score: 0.1967
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
