[True]
Run timestamp: 09102023_213519_45.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_45']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7968; val_auprc_score: 0.8091; val_best_acc_score: 0.5831; val_best_f1_score: 0.7007; train_kl_reg_loss: 67523.3732; train_edge_recon_loss: 3501922.0649; train_gene_expr_recon_loss: 13454158.5038; train_masked_gp_l1_reg_loss: 43629.2706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3454202.0959; train_chrom_access_recon_loss: 2252113.5553; train_global_loss: 22773548.8855; train_optim_loss: 22773548.8855; val_kl_reg_loss: 97966.6516; val_edge_recon_loss: 4060479.6333; val_gene_expr_recon_loss: 12895955.7333; val_masked_gp_l1_reg_loss: 49421.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 536406.0625; val_chrom_access_recon_loss: 2181551.5500; val_global_loss: 19821781.4667; val_optim_loss: 19821781.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8662; val_auprc_score: 0.8634; val_best_acc_score: 0.7898; val_best_f1_score: 0.7966; train_kl_reg_loss: 70825.9980; train_edge_recon_loss: 3444579.5191; train_gene_expr_recon_loss: 12602923.3893; train_masked_gp_l1_reg_loss: 52980.7112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 285482.7735; train_chrom_access_recon_loss: 2168987.0887; train_global_loss: 18625779.3740; train_optim_loss: 18625779.3740; val_kl_reg_loss: 59348.7268; val_edge_recon_loss: 3195028.7833; val_gene_expr_recon_loss: 12665706.9333; val_masked_gp_l1_reg_loss: 57889.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178402.3438; val_chrom_access_recon_loss: 2150991.5917; val_global_loss: 18307368.0000; val_optim_loss: 18307368.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9172; val_auprc_score: 0.8997; val_best_acc_score: 0.8476; val_best_f1_score: 0.8580; train_kl_reg_loss: 93787.2161; train_edge_recon_loss: 2897162.5840; train_gene_expr_recon_loss: 12480916.4275; train_masked_gp_l1_reg_loss: 64779.9533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 149693.9706; train_chrom_access_recon_loss: 2146216.8111; train_global_loss: 17832556.8779; train_optim_loss: 17832556.8779; val_kl_reg_loss: 97530.5979; val_edge_recon_loss: 2849542.5000; val_gene_expr_recon_loss: 12545316.4667; val_masked_gp_l1_reg_loss: 69968.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131162.9531; val_chrom_access_recon_loss: 2124300.4667; val_global_loss: 17817822.1333; val_optim_loss: 17817822.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9286; val_auprc_score: 0.9123; val_best_acc_score: 0.8610; val_best_f1_score: 0.8700; train_kl_reg_loss: 99495.6367; train_edge_recon_loss: 2807659.3206; train_gene_expr_recon_loss: 12315994.3053; train_masked_gp_l1_reg_loss: 72097.9916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125417.7347; train_chrom_access_recon_loss: 2118703.3817; train_global_loss: 17539368.3969; train_optim_loss: 17539368.3969; val_kl_reg_loss: 95841.5958; val_edge_recon_loss: 2824863.8833; val_gene_expr_recon_loss: 12432212.6667; val_masked_gp_l1_reg_loss: 74015.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120064.1172; val_chrom_access_recon_loss: 2110770.6250; val_global_loss: 17657768.8000; val_optim_loss: 17657768.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9331; val_auprc_score: 0.9198; val_best_acc_score: 0.8708; val_best_f1_score: 0.8778; train_kl_reg_loss: 96115.7801; train_edge_recon_loss: 2787968.5916; train_gene_expr_recon_loss: 12190103.3053; train_masked_gp_l1_reg_loss: 74976.7590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115679.1551; train_chrom_access_recon_loss: 2100486.7185; train_global_loss: 17365330.3359; train_optim_loss: 17365330.3359; val_kl_reg_loss: 98930.1521; val_edge_recon_loss: 2782554.6333; val_gene_expr_recon_loss: 12260852.2000; val_masked_gp_l1_reg_loss: 76152.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113407.9453; val_chrom_access_recon_loss: 2081909.8083; val_global_loss: 17413806.6000; val_optim_loss: 17413806.6000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9286; val_auprc_score: 0.9079; val_best_acc_score: 0.8645; val_best_f1_score: 0.8726; train_kl_reg_loss: 93553.1123; train_edge_recon_loss: 2792827.6317; train_gene_expr_recon_loss: 12085168.9008; train_masked_gp_l1_reg_loss: 76780.7315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110872.1068; train_chrom_access_recon_loss: 2086006.2071; train_global_loss: 17245208.7176; train_optim_loss: 17245208.7176; val_kl_reg_loss: 92972.3490; val_edge_recon_loss: 2799248.0167; val_gene_expr_recon_loss: 12152866.0667; val_masked_gp_l1_reg_loss: 77700.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110390.7344; val_chrom_access_recon_loss: 2066877.9750; val_global_loss: 17300056.4667; val_optim_loss: 17300056.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9384; val_auprc_score: 0.9202; val_best_acc_score: 0.8740; val_best_f1_score: 0.8810; train_kl_reg_loss: 88926.9117; train_edge_recon_loss: 2783763.3473; train_gene_expr_recon_loss: 12011855.9924; train_masked_gp_l1_reg_loss: 78551.7752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106826.3154; train_chrom_access_recon_loss: 2073219.3015; train_global_loss: 17143143.6031; train_optim_loss: 17143143.6031; val_kl_reg_loss: 87963.8125; val_edge_recon_loss: 2811471.9333; val_gene_expr_recon_loss: 12043143.1333; val_masked_gp_l1_reg_loss: 79560.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104647.2969; val_chrom_access_recon_loss: 2052651.9083; val_global_loss: 17179438.6667; val_optim_loss: 17179438.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9455; val_auprc_score: 0.9348; val_best_acc_score: 0.8833; val_best_f1_score: 0.8904; train_kl_reg_loss: 87243.9069; train_edge_recon_loss: 2765978.8282; train_gene_expr_recon_loss: 11921981.5420; train_masked_gp_l1_reg_loss: 80437.7139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102479.1158; train_chrom_access_recon_loss: 2058822.1279; train_global_loss: 17016943.1756; train_optim_loss: 17016943.1756; val_kl_reg_loss: 86340.3318; val_edge_recon_loss: 2761074.5667; val_gene_expr_recon_loss: 12008514.6000; val_masked_gp_l1_reg_loss: 81113.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100711.8438; val_chrom_access_recon_loss: 2044014.8750; val_global_loss: 17081770.4000; val_optim_loss: 17081770.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9478; val_auprc_score: 0.9354; val_best_acc_score: 0.8867; val_best_f1_score: 0.8927; train_kl_reg_loss: 83642.1820; train_edge_recon_loss: 2766251.2137; train_gene_expr_recon_loss: 11855105.4275; train_masked_gp_l1_reg_loss: 82018.2889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99324.0806; train_chrom_access_recon_loss: 2046283.6803; train_global_loss: 16932624.7710; train_optim_loss: 16932624.7710; val_kl_reg_loss: 85437.4589; val_edge_recon_loss: 2755471.1833; val_gene_expr_recon_loss: 12001179.3333; val_masked_gp_l1_reg_loss: 82842.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98224.2969; val_chrom_access_recon_loss: 2037882.3750; val_global_loss: 17061036.6000; val_optim_loss: 17061036.6000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9499; val_auprc_score: 0.9361; val_best_acc_score: 0.8892; val_best_f1_score: 0.8938; train_kl_reg_loss: 83550.5342; train_edge_recon_loss: 2748862.6737; train_gene_expr_recon_loss: 11788646.8550; train_masked_gp_l1_reg_loss: 83412.8585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96956.2501; train_chrom_access_recon_loss: 2034460.3006; train_global_loss: 16835889.5496; train_optim_loss: 16835889.5496; val_kl_reg_loss: 85051.5630; val_edge_recon_loss: 2754803.0333; val_gene_expr_recon_loss: 11867922.2000; val_masked_gp_l1_reg_loss: 83907.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96884.2656; val_chrom_access_recon_loss: 2019227.6333; val_global_loss: 16907796.2000; val_optim_loss: 16907796.2000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9483; val_auprc_score: 0.9344; val_best_acc_score: 0.8851; val_best_f1_score: 0.8923; train_kl_reg_loss: 82310.6242; train_edge_recon_loss: 2740879.6450; train_gene_expr_recon_loss: 11733225.6412; train_masked_gp_l1_reg_loss: 84423.5565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95812.3987; train_chrom_access_recon_loss: 2027842.6431; train_global_loss: 16764494.5344; train_optim_loss: 16764494.5344; val_kl_reg_loss: 81332.5828; val_edge_recon_loss: 2753925.5167; val_gene_expr_recon_loss: 11861932.0000; val_masked_gp_l1_reg_loss: 85102.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96333.1328; val_chrom_access_recon_loss: 2024155.1250; val_global_loss: 16902780.0000; val_optim_loss: 16902780.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9531; val_auprc_score: 0.9398; val_best_acc_score: 0.8915; val_best_f1_score: 0.8954; train_kl_reg_loss: 81507.4498; train_edge_recon_loss: 2724990.5210; train_gene_expr_recon_loss: 11684282.0687; train_masked_gp_l1_reg_loss: 85263.0958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95353.9318; train_chrom_access_recon_loss: 2016982.8779; train_global_loss: 16688379.9008; train_optim_loss: 16688379.9008; val_kl_reg_loss: 81846.5458; val_edge_recon_loss: 2742459.5833; val_gene_expr_recon_loss: 11783173.2667; val_masked_gp_l1_reg_loss: 85794.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96508.6250; val_chrom_access_recon_loss: 2005325.6750; val_global_loss: 16795109.2000; val_optim_loss: 16795109.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9580; val_auprc_score: 0.9450; val_best_acc_score: 0.9008; val_best_f1_score: 0.9046; train_kl_reg_loss: 80999.2424; train_edge_recon_loss: 2723953.7195; train_gene_expr_recon_loss: 11641520.4275; train_masked_gp_l1_reg_loss: 85890.3735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95194.0727; train_chrom_access_recon_loss: 2009834.8998; train_global_loss: 16637392.7939; train_optim_loss: 16637392.7939; val_kl_reg_loss: 79300.9828; val_edge_recon_loss: 2733074.5000; val_gene_expr_recon_loss: 11730496.2667; val_masked_gp_l1_reg_loss: 86326.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95229.0312; val_chrom_access_recon_loss: 2002056.7583; val_global_loss: 16726483.3333; val_optim_loss: 16726483.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9615; val_auprc_score: 0.9514; val_best_acc_score: 0.9077; val_best_f1_score: 0.9110; train_kl_reg_loss: 79641.4781; train_edge_recon_loss: 2712527.4637; train_gene_expr_recon_loss: 11608094.3893; train_masked_gp_l1_reg_loss: 86562.3331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95162.0544; train_chrom_access_recon_loss: 2005239.9361; train_global_loss: 16587227.6947; train_optim_loss: 16587227.6947; val_kl_reg_loss: 82247.8344; val_edge_recon_loss: 2724942.7833; val_gene_expr_recon_loss: 11715633.1333; val_masked_gp_l1_reg_loss: 87009.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96284.8203; val_chrom_access_recon_loss: 1995733.2167; val_global_loss: 16701851.8667; val_optim_loss: 16701851.8667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9585; val_auprc_score: 0.9459; val_best_acc_score: 0.9033; val_best_f1_score: 0.9084; train_kl_reg_loss: 77862.4139; train_edge_recon_loss: 2713175.8702; train_gene_expr_recon_loss: 11556521.9084; train_masked_gp_l1_reg_loss: 87092.1594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95278.2671; train_chrom_access_recon_loss: 1993051.9361; train_global_loss: 16522982.5420; train_optim_loss: 16522982.5420; val_kl_reg_loss: 76736.6323; val_edge_recon_loss: 2724888.9833; val_gene_expr_recon_loss: 11673251.4000; val_masked_gp_l1_reg_loss: 87383.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95465.1797; val_chrom_access_recon_loss: 1985457.8917; val_global_loss: 16643184.0667; val_optim_loss: 16643184.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9636; val_auprc_score: 0.9541; val_best_acc_score: 0.9060; val_best_f1_score: 0.9089; train_kl_reg_loss: 77688.5327; train_edge_recon_loss: 2709659.2424; train_gene_expr_recon_loss: 11541357.6031; train_masked_gp_l1_reg_loss: 87531.5924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95002.2963; train_chrom_access_recon_loss: 1990224.9160; train_global_loss: 16501464.1450; train_optim_loss: 16501464.1450; val_kl_reg_loss: 76503.8901; val_edge_recon_loss: 2712207.9000; val_gene_expr_recon_loss: 11698919.8667; val_masked_gp_l1_reg_loss: 87501.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94912.2031; val_chrom_access_recon_loss: 1993577.4417; val_global_loss: 16663623.2000; val_optim_loss: 16663623.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9653; val_auprc_score: 0.9565; val_best_acc_score: 0.9099; val_best_f1_score: 0.9124; train_kl_reg_loss: 78170.3832; train_edge_recon_loss: 2708359.1221; train_gene_expr_recon_loss: 11501515.4122; train_masked_gp_l1_reg_loss: 87693.2118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94665.4741; train_chrom_access_recon_loss: 1982558.8912; train_global_loss: 16452962.5954; train_optim_loss: 16452962.5954; val_kl_reg_loss: 75199.1281; val_edge_recon_loss: 2714573.9333; val_gene_expr_recon_loss: 11587705.6000; val_masked_gp_l1_reg_loss: 87803.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94906.9922; val_chrom_access_recon_loss: 1966424.4833; val_global_loss: 16526614.3333; val_optim_loss: 16526614.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9635; val_auprc_score: 0.9542; val_best_acc_score: 0.9096; val_best_f1_score: 0.9107; train_kl_reg_loss: 76460.8619; train_edge_recon_loss: 2705809.4427; train_gene_expr_recon_loss: 11477358.6565; train_masked_gp_l1_reg_loss: 87814.6385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94445.1488; train_chrom_access_recon_loss: 1977903.7309; train_global_loss: 16419792.4504; train_optim_loss: 16419792.4504; val_kl_reg_loss: 76954.4172; val_edge_recon_loss: 2722776.0333; val_gene_expr_recon_loss: 11557798.8667; val_masked_gp_l1_reg_loss: 87999.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95440.4297; val_chrom_access_recon_loss: 1961313.1417; val_global_loss: 16502281.2667; val_optim_loss: 16502281.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9664; val_auprc_score: 0.9571; val_best_acc_score: 0.9123; val_best_f1_score: 0.9152; train_kl_reg_loss: 76107.5207; train_edge_recon_loss: 2696623.2156; train_gene_expr_recon_loss: 11443750.2366; train_masked_gp_l1_reg_loss: 87993.1626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94534.9331; train_chrom_access_recon_loss: 1973405.4895; train_global_loss: 16372414.5954; train_optim_loss: 16372414.5954; val_kl_reg_loss: 79154.2932; val_edge_recon_loss: 2718755.2500; val_gene_expr_recon_loss: 11591942.2667; val_masked_gp_l1_reg_loss: 87932.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94191.4453; val_chrom_access_recon_loss: 1972212.4083; val_global_loss: 16544187.0667; val_optim_loss: 16544187.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9682; val_auprc_score: 0.9593; val_best_acc_score: 0.9170; val_best_f1_score: 0.9196; train_kl_reg_loss: 75812.7598; train_edge_recon_loss: 2692095.3626; train_gene_expr_recon_loss: 11411086.8092; train_masked_gp_l1_reg_loss: 87981.7453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94139.4067; train_chrom_access_recon_loss: 1966854.3903; train_global_loss: 16327970.4962; train_optim_loss: 16327970.4962; val_kl_reg_loss: 77581.3349; val_edge_recon_loss: 2698188.4333; val_gene_expr_recon_loss: 11531481.0667; val_masked_gp_l1_reg_loss: 87911.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94072.8906; val_chrom_access_recon_loss: 1958870.3000; val_global_loss: 16448105.1333; val_optim_loss: 16448105.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9677; val_auprc_score: 0.9575; val_best_acc_score: 0.9174; val_best_f1_score: 0.9209; train_kl_reg_loss: 74858.9094; train_edge_recon_loss: 2686646.2634; train_gene_expr_recon_loss: 11394385.4046; train_masked_gp_l1_reg_loss: 87952.2401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93980.2084; train_chrom_access_recon_loss: 1962190.7863; train_global_loss: 16300013.7710; train_optim_loss: 16300013.7710; val_kl_reg_loss: 73829.1031; val_edge_recon_loss: 2704450.8833; val_gene_expr_recon_loss: 11529379.8667; val_masked_gp_l1_reg_loss: 88155.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94326.9531; val_chrom_access_recon_loss: 1965522.5417; val_global_loss: 16455664.4000; val_optim_loss: 16455664.4000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9698; val_auprc_score: 0.9613; val_best_acc_score: 0.9221; val_best_f1_score: 0.9250; train_kl_reg_loss: 73237.5723; train_edge_recon_loss: 2692151.3645; train_gene_expr_recon_loss: 11385475.4733; train_masked_gp_l1_reg_loss: 88062.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94047.9723; train_chrom_access_recon_loss: 1959581.0000; train_global_loss: 16292556.0916; train_optim_loss: 16292556.0916; val_kl_reg_loss: 71155.0068; val_edge_recon_loss: 2709275.4833; val_gene_expr_recon_loss: 11485969.2000; val_masked_gp_l1_reg_loss: 88041.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95110.9844; val_chrom_access_recon_loss: 1953046.2667; val_global_loss: 16402598.8000; val_optim_loss: 16402598.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9714; val_auprc_score: 0.9606; val_best_acc_score: 0.9189; val_best_f1_score: 0.9203; train_kl_reg_loss: 73152.8463; train_edge_recon_loss: 2700088.4122; train_gene_expr_recon_loss: 11376943.9771; train_masked_gp_l1_reg_loss: 88125.8823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94305.6176; train_chrom_access_recon_loss: 1958415.7433; train_global_loss: 16291032.4733; train_optim_loss: 16291032.4733; val_kl_reg_loss: 73530.4104; val_edge_recon_loss: 2710349.5333; val_gene_expr_recon_loss: 11449602.4667; val_masked_gp_l1_reg_loss: 87903.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94444.4141; val_chrom_access_recon_loss: 1945182.7417; val_global_loss: 16361012.1333; val_optim_loss: 16361012.1333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9759; val_auprc_score: 0.9686; val_best_acc_score: 0.9291; val_best_f1_score: 0.9315; train_kl_reg_loss: 74056.3366; train_edge_recon_loss: 2689399.1031; train_gene_expr_recon_loss: 11352644.4504; train_masked_gp_l1_reg_loss: 87786.9974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94003.5871; train_chrom_access_recon_loss: 1952305.0935; train_global_loss: 16250195.5344; train_optim_loss: 16250195.5344; val_kl_reg_loss: 73036.2651; val_edge_recon_loss: 2681930.6667; val_gene_expr_recon_loss: 11445232.9333; val_masked_gp_l1_reg_loss: 87613.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93623.6406; val_chrom_access_recon_loss: 1942041.4000; val_global_loss: 16323478.4000; val_optim_loss: 16323478.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9746; val_auprc_score: 0.9675; val_best_acc_score: 0.9286; val_best_f1_score: 0.9302; train_kl_reg_loss: 72637.3440; train_edge_recon_loss: 2690449.2634; train_gene_expr_recon_loss: 11331318.3206; train_masked_gp_l1_reg_loss: 87517.3664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93815.4129; train_chrom_access_recon_loss: 1949283.1756; train_global_loss: 16225020.8473; train_optim_loss: 16225020.8473; val_kl_reg_loss: 72324.0740; val_edge_recon_loss: 2702095.6833; val_gene_expr_recon_loss: 11422541.7333; val_masked_gp_l1_reg_loss: 87478.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95365.2266; val_chrom_access_recon_loss: 1933390.0417; val_global_loss: 16313195.8667; val_optim_loss: 16313195.8667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9697; val_auprc_score: 0.9611; val_best_acc_score: 0.9219; val_best_f1_score: 0.9245; train_kl_reg_loss: 73449.3830; train_edge_recon_loss: 2680130.4981; train_gene_expr_recon_loss: 11318533.2137; train_masked_gp_l1_reg_loss: 87209.0265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94056.4458; train_chrom_access_recon_loss: 1947690.8607; train_global_loss: 16201069.3893; train_optim_loss: 16201069.3893; val_kl_reg_loss: 76980.1411; val_edge_recon_loss: 2714277.6000; val_gene_expr_recon_loss: 11414598.2667; val_masked_gp_l1_reg_loss: 87075.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93419.0781; val_chrom_access_recon_loss: 1931327.5000; val_global_loss: 16317677.4667; val_optim_loss: 16317677.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9728; val_auprc_score: 0.9627; val_best_acc_score: 0.9275; val_best_f1_score: 0.9298; train_kl_reg_loss: 73368.8754; train_edge_recon_loss: 2685896.0763; train_gene_expr_recon_loss: 11311156.8779; train_masked_gp_l1_reg_loss: 86938.9389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93941.9045; train_chrom_access_recon_loss: 1946898.6708; train_global_loss: 16198201.3588; train_optim_loss: 16198201.3588; val_kl_reg_loss: 73084.7724; val_edge_recon_loss: 2708366.9667; val_gene_expr_recon_loss: 11511739.5333; val_masked_gp_l1_reg_loss: 86954.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94386.0938; val_chrom_access_recon_loss: 1947412.8417; val_global_loss: 16421944.2667; val_optim_loss: 16421944.2667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9739; val_auprc_score: 0.9644; val_best_acc_score: 0.9321; val_best_f1_score: 0.9345; train_kl_reg_loss: 72419.4434; train_edge_recon_loss: 2679653.6489; train_gene_expr_recon_loss: 11302334.2595; train_masked_gp_l1_reg_loss: 86678.4608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93960.1549; train_chrom_access_recon_loss: 1943750.8397; train_global_loss: 16178796.9084; train_optim_loss: 16178796.9084; val_kl_reg_loss: 72572.6349; val_edge_recon_loss: 2684504.3333; val_gene_expr_recon_loss: 11429821.0667; val_masked_gp_l1_reg_loss: 86448.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94532.4922; val_chrom_access_recon_loss: 1934011.8333; val_global_loss: 16301889.8667; val_optim_loss: 16301889.8667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9761; val_auprc_score: 0.9683; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 72746.9433; train_edge_recon_loss: 2677492.6660; train_gene_expr_recon_loss: 11288927.9084; train_masked_gp_l1_reg_loss: 86289.1861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94089.1976; train_chrom_access_recon_loss: 1940323.1116; train_global_loss: 16159869.0000; train_optim_loss: 16159869.0000; val_kl_reg_loss: 73172.1396; val_edge_recon_loss: 2692102.1333; val_gene_expr_recon_loss: 11429512.8667; val_masked_gp_l1_reg_loss: 86120.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93620.2656; val_chrom_access_recon_loss: 1941321.2750; val_global_loss: 16315849.5333; val_optim_loss: 16315849.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9755; val_auprc_score: 0.9666; val_best_acc_score: 0.9316; val_best_f1_score: 0.9335; train_kl_reg_loss: 72141.3356; train_edge_recon_loss: 2674815.1698; train_gene_expr_recon_loss: 11277674.2824; train_masked_gp_l1_reg_loss: 86023.3349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93925.0991; train_chrom_access_recon_loss: 1937307.7634; train_global_loss: 16141886.9542; train_optim_loss: 16141886.9542; val_kl_reg_loss: 70783.9099; val_edge_recon_loss: 2692977.8000; val_gene_expr_recon_loss: 11384676.5333; val_masked_gp_l1_reg_loss: 85839.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93918.0625; val_chrom_access_recon_loss: 1930522.6667; val_global_loss: 16258719.0667; val_optim_loss: 16258719.0667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9800; val_auprc_score: 0.9740; val_best_acc_score: 0.9365; val_best_f1_score: 0.9388; train_kl_reg_loss: 73341.6216; train_edge_recon_loss: 2673834.9943; train_gene_expr_recon_loss: 11268634.5496; train_masked_gp_l1_reg_loss: 85644.5946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93976.3471; train_chrom_access_recon_loss: 1935565.5372; train_global_loss: 16130997.5878; train_optim_loss: 16130997.5878; val_kl_reg_loss: 72511.6089; val_edge_recon_loss: 2676966.0000; val_gene_expr_recon_loss: 11389904.2667; val_masked_gp_l1_reg_loss: 85452.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93957.3125; val_chrom_access_recon_loss: 1933294.4667; val_global_loss: 16252086.4000; val_optim_loss: 16252086.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9770; val_auprc_score: 0.9691; val_best_acc_score: 0.9376; val_best_f1_score: 0.9397; train_kl_reg_loss: 72166.9926; train_edge_recon_loss: 2674331.5458; train_gene_expr_recon_loss: 11257402.5725; train_masked_gp_l1_reg_loss: 85327.4482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93933.8842; train_chrom_access_recon_loss: 1933217.4198; train_global_loss: 16116379.7863; train_optim_loss: 16116379.7863; val_kl_reg_loss: 72922.7411; val_edge_recon_loss: 2674403.7833; val_gene_expr_recon_loss: 11371317.7333; val_masked_gp_l1_reg_loss: 85187.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94203.0938; val_chrom_access_recon_loss: 1923526.0250; val_global_loss: 16221560.3333; val_optim_loss: 16221560.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9792; val_auprc_score: 0.9716; val_best_acc_score: 0.9373; val_best_f1_score: 0.9400; train_kl_reg_loss: 71634.2044; train_edge_recon_loss: 2668775.1737; train_gene_expr_recon_loss: 11245412.7252; train_masked_gp_l1_reg_loss: 85041.4158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94089.9513; train_chrom_access_recon_loss: 1931494.5592; train_global_loss: 16096447.9771; train_optim_loss: 16096447.9771; val_kl_reg_loss: 72540.0594; val_edge_recon_loss: 2683368.3500; val_gene_expr_recon_loss: 11406128.0000; val_masked_gp_l1_reg_loss: 85084.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94126.7344; val_chrom_access_recon_loss: 1932193.3333; val_global_loss: 16273441.6667; val_optim_loss: 16273441.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9767; val_auprc_score: 0.9671; val_best_acc_score: 0.9353; val_best_f1_score: 0.9375; train_kl_reg_loss: 70590.9046; train_edge_recon_loss: 2671062.4218; train_gene_expr_recon_loss: 11241719.2977; train_masked_gp_l1_reg_loss: 84874.3619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94016.3748; train_chrom_access_recon_loss: 1930556.1403; train_global_loss: 16092819.5420; train_optim_loss: 16092819.5420; val_kl_reg_loss: 70428.3328; val_edge_recon_loss: 2683683.5333; val_gene_expr_recon_loss: 11346643.8000; val_masked_gp_l1_reg_loss: 84989.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94716.0000; val_chrom_access_recon_loss: 1919184.2333; val_global_loss: 16199645.0667; val_optim_loss: 16199645.0667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9804; val_auprc_score: 0.9716; val_best_acc_score: 0.9392; val_best_f1_score: 0.9414; train_kl_reg_loss: 71290.2312; train_edge_recon_loss: 2669034.9294; train_gene_expr_recon_loss: 11234468.7481; train_masked_gp_l1_reg_loss: 84735.5283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94353.4348; train_chrom_access_recon_loss: 1928472.1823; train_global_loss: 16082355.0916; train_optim_loss: 16082355.0916; val_kl_reg_loss: 71814.4073; val_edge_recon_loss: 2690190.0833; val_gene_expr_recon_loss: 11362610.4000; val_masked_gp_l1_reg_loss: 84515.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94567.8125; val_chrom_access_recon_loss: 1924670.2167; val_global_loss: 16228368.0000; val_optim_loss: 16228368.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9814; val_auprc_score: 0.9746; val_best_acc_score: 0.9431; val_best_f1_score: 0.9447; train_kl_reg_loss: 70522.0270; train_edge_recon_loss: 2669536.1660; train_gene_expr_recon_loss: 11212684.1069; train_masked_gp_l1_reg_loss: 84343.1716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94252.4193; train_chrom_access_recon_loss: 1923786.9017; train_global_loss: 16055124.7710; train_optim_loss: 16055124.7710; val_kl_reg_loss: 72684.0526; val_edge_recon_loss: 2670663.0667; val_gene_expr_recon_loss: 11327919.6000; val_masked_gp_l1_reg_loss: 84278.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93800.5156; val_chrom_access_recon_loss: 1915583.3167; val_global_loss: 16164930.1333; val_optim_loss: 16164930.1333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9807; val_auprc_score: 0.9713; val_best_acc_score: 0.9418; val_best_f1_score: 0.9435; train_kl_reg_loss: 70472.2283; train_edge_recon_loss: 2670324.6641; train_gene_expr_recon_loss: 11213780.6565; train_masked_gp_l1_reg_loss: 84169.0389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94202.1133; train_chrom_access_recon_loss: 1923998.7739; train_global_loss: 16056947.5802; train_optim_loss: 16056947.5802; val_kl_reg_loss: 71012.1979; val_edge_recon_loss: 2673206.6167; val_gene_expr_recon_loss: 11381999.1333; val_masked_gp_l1_reg_loss: 84063.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94951.1797; val_chrom_access_recon_loss: 1931838.2583; val_global_loss: 16237071.3333; val_optim_loss: 16237071.3333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9850; val_auprc_score: 0.9807; val_best_acc_score: 0.9484; val_best_f1_score: 0.9496; train_kl_reg_loss: 70387.8391; train_edge_recon_loss: 2664490.8225; train_gene_expr_recon_loss: 11209152.1679; train_masked_gp_l1_reg_loss: 83860.3681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94514.6654; train_chrom_access_recon_loss: 1922687.5706; train_global_loss: 16045093.4656; train_optim_loss: 16045093.4656; val_kl_reg_loss: 71032.1990; val_edge_recon_loss: 2659553.5500; val_gene_expr_recon_loss: 11326568.8667; val_masked_gp_l1_reg_loss: 83728.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94576.1094; val_chrom_access_recon_loss: 1914274.0250; val_global_loss: 16149733.6000; val_optim_loss: 16149733.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9821; val_auprc_score: 0.9752; val_best_acc_score: 0.9460; val_best_f1_score: 0.9475; train_kl_reg_loss: 70200.4414; train_edge_recon_loss: 2666630.4122; train_gene_expr_recon_loss: 11206234.6031; train_masked_gp_l1_reg_loss: 83640.5346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94681.5150; train_chrom_access_recon_loss: 1920040.9113; train_global_loss: 16041428.3130; train_optim_loss: 16041428.3130; val_kl_reg_loss: 70680.6510; val_edge_recon_loss: 2669146.4333; val_gene_expr_recon_loss: 11334973.7333; val_masked_gp_l1_reg_loss: 83232.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94553.8438; val_chrom_access_recon_loss: 1918709.7583; val_global_loss: 16171297.4000; val_optim_loss: 16171297.4000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9841; val_auprc_score: 0.9774; val_best_acc_score: 0.9477; val_best_f1_score: 0.9491; train_kl_reg_loss: 69173.8503; train_edge_recon_loss: 2664575.9905; train_gene_expr_recon_loss: 11196630.0229; train_masked_gp_l1_reg_loss: 83180.1023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94815.6308; train_chrom_access_recon_loss: 1918231.2948; train_global_loss: 16026606.9389; train_optim_loss: 16026606.9389; val_kl_reg_loss: 73181.0844; val_edge_recon_loss: 2682238.7833; val_gene_expr_recon_loss: 11372352.6667; val_masked_gp_l1_reg_loss: 82856.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94854.2344; val_chrom_access_recon_loss: 1923545.9750; val_global_loss: 16229029.5333; val_optim_loss: 16229029.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9837; val_auprc_score: 0.9777; val_best_acc_score: 0.9501; val_best_f1_score: 0.9512; train_kl_reg_loss: 69452.7380; train_edge_recon_loss: 2661032.3531; train_gene_expr_recon_loss: 11194220.2137; train_masked_gp_l1_reg_loss: 82676.5072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94981.8624; train_chrom_access_recon_loss: 1916823.8473; train_global_loss: 16019187.6031; train_optim_loss: 16019187.6031; val_kl_reg_loss: 71067.4333; val_edge_recon_loss: 2674610.2333; val_gene_expr_recon_loss: 11313669.0667; val_masked_gp_l1_reg_loss: 82713.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95030.3594; val_chrom_access_recon_loss: 1908483.9250; val_global_loss: 16145573.5333; val_optim_loss: 16145573.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9821; val_auprc_score: 0.9728; val_best_acc_score: 0.9479; val_best_f1_score: 0.9491; train_kl_reg_loss: 69631.4485; train_edge_recon_loss: 2660696.0057; train_gene_expr_recon_loss: 11179024.5802; train_masked_gp_l1_reg_loss: 82314.3516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95053.1741; train_chrom_access_recon_loss: 1912543.6374; train_global_loss: 15999263.1374; train_optim_loss: 15999263.1374; val_kl_reg_loss: 69906.4057; val_edge_recon_loss: 2670498.8667; val_gene_expr_recon_loss: 11363771.0667; val_masked_gp_l1_reg_loss: 82146.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95340.0703; val_chrom_access_recon_loss: 1924920.7000; val_global_loss: 16206583.0000; val_optim_loss: 16206583.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9840; val_auprc_score: 0.9792; val_best_acc_score: 0.9479; val_best_f1_score: 0.9493; train_kl_reg_loss: 68932.6720; train_edge_recon_loss: 2661979.4008; train_gene_expr_recon_loss: 11194049.9313; train_masked_gp_l1_reg_loss: 81964.6054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95305.6538; train_chrom_access_recon_loss: 1917224.3111; train_global_loss: 16019456.5115; train_optim_loss: 16019456.5115; val_kl_reg_loss: 70642.5792; val_edge_recon_loss: 2669548.1167; val_gene_expr_recon_loss: 11311382.4667; val_masked_gp_l1_reg_loss: 81869.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95740.2266; val_chrom_access_recon_loss: 1906930.6167; val_global_loss: 16136113.7333; val_optim_loss: 16136113.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9851; val_auprc_score: 0.9785; val_best_acc_score: 0.9475; val_best_f1_score: 0.9489; train_kl_reg_loss: 69724.8814; train_edge_recon_loss: 2658356.7901; train_gene_expr_recon_loss: 11185222.7863; train_masked_gp_l1_reg_loss: 81638.1923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95453.5701; train_chrom_access_recon_loss: 1913055.3798; train_global_loss: 16003451.5191; train_optim_loss: 16003451.5191; val_kl_reg_loss: 71032.0776; val_edge_recon_loss: 2678907.7500; val_gene_expr_recon_loss: 11312756.6667; val_masked_gp_l1_reg_loss: 81532.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95554.3984; val_chrom_access_recon_loss: 1909183.5083; val_global_loss: 16148967.1333; val_optim_loss: 16148967.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9832; val_auprc_score: 0.9770; val_best_acc_score: 0.9523; val_best_f1_score: 0.9537; train_kl_reg_loss: 69108.1760; train_edge_recon_loss: 2654990.8607; train_gene_expr_recon_loss: 11169096.1679; train_masked_gp_l1_reg_loss: 81345.4242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95584.6670; train_chrom_access_recon_loss: 1911075.0048; train_global_loss: 15981200.3740; train_optim_loss: 15981200.3740; val_kl_reg_loss: 69944.9781; val_edge_recon_loss: 2680990.2000; val_gene_expr_recon_loss: 11323392.5333; val_masked_gp_l1_reg_loss: 81484.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96128.6953; val_chrom_access_recon_loss: 1912356.8167; val_global_loss: 16164298.7333; val_optim_loss: 16164298.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9866; val_auprc_score: 0.9798; val_best_acc_score: 0.9555; val_best_f1_score: 0.9568; train_kl_reg_loss: 70445.8637; train_edge_recon_loss: 2656151.9103; train_gene_expr_recon_loss: 11168622.8550; train_masked_gp_l1_reg_loss: 81146.5413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95994.8783; train_chrom_access_recon_loss: 1911255.4609; train_global_loss: 15983617.4962; train_optim_loss: 15983617.4962; val_kl_reg_loss: 72858.7406; val_edge_recon_loss: 2663067.8667; val_gene_expr_recon_loss: 11298689.3333; val_masked_gp_l1_reg_loss: 80956.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95591.7891; val_chrom_access_recon_loss: 1902046.6417; val_global_loss: 16113211.6667; val_optim_loss: 16113211.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9848; val_auprc_score: 0.9797; val_best_acc_score: 0.9500; val_best_f1_score: 0.9516; train_kl_reg_loss: 69795.8951; train_edge_recon_loss: 2654766.9103; train_gene_expr_recon_loss: 11169973.2443; train_masked_gp_l1_reg_loss: 80739.1026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95913.1429; train_chrom_access_recon_loss: 1909523.6212; train_global_loss: 15980711.8244; train_optim_loss: 15980711.8244; val_kl_reg_loss: 72065.7714; val_edge_recon_loss: 2672028.3333; val_gene_expr_recon_loss: 11324991.8667; val_masked_gp_l1_reg_loss: 80783.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96131.7734; val_chrom_access_recon_loss: 1911410.5917; val_global_loss: 16157411.4667; val_optim_loss: 16157411.4667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9865; val_auprc_score: 0.9777; val_best_acc_score: 0.9554; val_best_f1_score: 0.9557; train_kl_reg_loss: 70394.4378; train_edge_recon_loss: 2653939.7729; train_gene_expr_recon_loss: 11153380.1527; train_masked_gp_l1_reg_loss: 80646.8081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95943.0175; train_chrom_access_recon_loss: 1905621.1966; train_global_loss: 15959925.3511; train_optim_loss: 15959925.3511; val_kl_reg_loss: 69685.0844; val_edge_recon_loss: 2673403.7000; val_gene_expr_recon_loss: 11361962.4667; val_masked_gp_l1_reg_loss: 80445.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96202.7734; val_chrom_access_recon_loss: 1911823.6000; val_global_loss: 16193523.8000; val_optim_loss: 16193523.8000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9823; val_auprc_score: 0.9715; val_best_acc_score: 0.9475; val_best_f1_score: 0.9486; train_kl_reg_loss: 69338.7191; train_edge_recon_loss: 2654902.2653; train_gene_expr_recon_loss: 11160801.3893; train_masked_gp_l1_reg_loss: 80458.5001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96156.9230; train_chrom_access_recon_loss: 1906536.9017; train_global_loss: 15968194.7405; train_optim_loss: 15968194.7405; val_kl_reg_loss: 69008.3427; val_edge_recon_loss: 2690392.7333; val_gene_expr_recon_loss: 11298107.7333; val_masked_gp_l1_reg_loss: 80341.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96436.0625; val_chrom_access_recon_loss: 1911509.0417; val_global_loss: 16145795.9333; val_optim_loss: 16145795.9333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9861; val_auprc_score: 0.9813; val_best_acc_score: 0.9522; val_best_f1_score: 0.9531; train_kl_reg_loss: 69238.6181; train_edge_recon_loss: 2656615.2786; train_gene_expr_recon_loss: 11158035.9466; train_masked_gp_l1_reg_loss: 80304.2480; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96501.4408; train_chrom_access_recon_loss: 1906503.8750; train_global_loss: 15967199.4504; train_optim_loss: 15967199.4504; val_kl_reg_loss: 68113.2031; val_edge_recon_loss: 2669655.3000; val_gene_expr_recon_loss: 11306946.6667; val_masked_gp_l1_reg_loss: 80365.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97090.6562; val_chrom_access_recon_loss: 1912752.6333; val_global_loss: 16134924.8000; val_optim_loss: 16134924.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9860; val_auprc_score: 0.9808; val_best_acc_score: 0.9565; val_best_f1_score: 0.9575; train_kl_reg_loss: 68870.2185; train_edge_recon_loss: 2652842.3187; train_gene_expr_recon_loss: 11137718.5267; train_masked_gp_l1_reg_loss: 78960.0055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73626.8386; train_chrom_access_recon_loss: 1900208.6431; train_global_loss: 15912226.5267; train_optim_loss: 15912226.5267; val_kl_reg_loss: 70715.5068; val_edge_recon_loss: 2660212.4833; val_gene_expr_recon_loss: 11304069.0667; val_masked_gp_l1_reg_loss: 78579.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70117.1875; val_chrom_access_recon_loss: 1910442.9083; val_global_loss: 16094137.0667; val_optim_loss: 16094137.0667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9874; val_auprc_score: 0.9830; val_best_acc_score: 0.9585; val_best_f1_score: 0.9595; train_kl_reg_loss: 70971.6227; train_edge_recon_loss: 2653709.8053; train_gene_expr_recon_loss: 11134102.6489; train_masked_gp_l1_reg_loss: 78498.0431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69494.0994; train_chrom_access_recon_loss: 1900428.4036; train_global_loss: 15907204.6412; train_optim_loss: 15907204.6412; val_kl_reg_loss: 72148.0344; val_edge_recon_loss: 2651264.2167; val_gene_expr_recon_loss: 11306087.8667; val_masked_gp_l1_reg_loss: 78403.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69037.9297; val_chrom_access_recon_loss: 1909861.2667; val_global_loss: 16086802.4000; val_optim_loss: 16086802.4000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9862; val_auprc_score: 0.9808; val_best_acc_score: 0.9538; val_best_f1_score: 0.9546; train_kl_reg_loss: 71959.0563; train_edge_recon_loss: 2653877.7309; train_gene_expr_recon_loss: 11127510.2290; train_masked_gp_l1_reg_loss: 78349.5549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68689.5667; train_chrom_access_recon_loss: 1897057.8884; train_global_loss: 15897443.9924; train_optim_loss: 15897443.9924; val_kl_reg_loss: 73300.5177; val_edge_recon_loss: 2659629.1167; val_gene_expr_recon_loss: 11288617.2667; val_masked_gp_l1_reg_loss: 78323.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68451.0078; val_chrom_access_recon_loss: 1899967.0083; val_global_loss: 16068288.0000; val_optim_loss: 16068288.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9864; val_auprc_score: 0.9821; val_best_acc_score: 0.9522; val_best_f1_score: 0.9534; train_kl_reg_loss: 72212.3465; train_edge_recon_loss: 2645048.7710; train_gene_expr_recon_loss: 11129005.3053; train_masked_gp_l1_reg_loss: 78264.0762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68169.1851; train_chrom_access_recon_loss: 1896849.9466; train_global_loss: 15889549.6947; train_optim_loss: 15889549.6947; val_kl_reg_loss: 73024.4187; val_edge_recon_loss: 2667192.9167; val_gene_expr_recon_loss: 11247884.6000; val_masked_gp_l1_reg_loss: 78262.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67958.1641; val_chrom_access_recon_loss: 1898374.9417; val_global_loss: 16032697.6000; val_optim_loss: 16032697.6000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9860; val_auprc_score: 0.9797; val_best_acc_score: 0.9553; val_best_f1_score: 0.9564; train_kl_reg_loss: 72736.3365; train_edge_recon_loss: 2649872.4733; train_gene_expr_recon_loss: 11136135.2595; train_masked_gp_l1_reg_loss: 78226.8820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67657.6836; train_chrom_access_recon_loss: 1898164.6059; train_global_loss: 15902793.1756; train_optim_loss: 15902793.1756; val_kl_reg_loss: 73049.6661; val_edge_recon_loss: 2668625.9333; val_gene_expr_recon_loss: 11273759.0000; val_masked_gp_l1_reg_loss: 78175.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67524.0938; val_chrom_access_recon_loss: 1905424.5417; val_global_loss: 16066558.3333; val_optim_loss: 16066558.3333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9829; val_auprc_score: 0.9767; val_best_acc_score: 0.9492; val_best_f1_score: 0.9507; train_kl_reg_loss: 72565.0149; train_edge_recon_loss: 2650699.9351; train_gene_expr_recon_loss: 11135454.4198; train_masked_gp_l1_reg_loss: 78154.8047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67311.2985; train_chrom_access_recon_loss: 1898149.9504; train_global_loss: 15902335.3893; train_optim_loss: 15902335.3893; val_kl_reg_loss: 73296.3542; val_edge_recon_loss: 2677185.5833; val_gene_expr_recon_loss: 11287194.7333; val_masked_gp_l1_reg_loss: 78129.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67076.9375; val_chrom_access_recon_loss: 1902698.5750; val_global_loss: 16085581.1333; val_optim_loss: 16085581.1333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9879; val_auprc_score: 0.9846; val_best_acc_score: 0.9576; val_best_f1_score: 0.9582; train_kl_reg_loss: 72748.5878; train_edge_recon_loss: 2654563.5210; train_gene_expr_recon_loss: 11138459.8626; train_masked_gp_l1_reg_loss: 78123.3011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66973.1916; train_chrom_access_recon_loss: 1898783.2271; train_global_loss: 15909651.7328; train_optim_loss: 15909651.7328; val_kl_reg_loss: 73260.8062; val_edge_recon_loss: 2661704.5667; val_gene_expr_recon_loss: 11270911.1333; val_masked_gp_l1_reg_loss: 78080.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66753.0859; val_chrom_access_recon_loss: 1905680.2750; val_global_loss: 16056389.8000; val_optim_loss: 16056389.8000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9869; val_auprc_score: 0.9807; val_best_acc_score: 0.9542; val_best_f1_score: 0.9550; train_kl_reg_loss: 72749.6298; train_edge_recon_loss: 2644407.0973; train_gene_expr_recon_loss: 11129004.7863; train_masked_gp_l1_reg_loss: 78071.5242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66578.2001; train_chrom_access_recon_loss: 1897134.1374; train_global_loss: 15887945.3893; train_optim_loss: 15887945.3893; val_kl_reg_loss: 73881.2260; val_edge_recon_loss: 2660397.5333; val_gene_expr_recon_loss: 11294449.2667; val_masked_gp_l1_reg_loss: 78033.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66457.1172; val_chrom_access_recon_loss: 1906292.3250; val_global_loss: 16079511.2667; val_optim_loss: 16079511.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9861; val_auprc_score: 0.9803; val_best_acc_score: 0.9524; val_best_f1_score: 0.9536; train_kl_reg_loss: 73289.8516; train_edge_recon_loss: 2651474.0344; train_gene_expr_recon_loss: 11129795.3053; train_masked_gp_l1_reg_loss: 77883.7731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64149.0070; train_chrom_access_recon_loss: 1897943.1183; train_global_loss: 15894535.1374; train_optim_loss: 15894535.1374; val_kl_reg_loss: 73612.3990; val_edge_recon_loss: 2646278.0667; val_gene_expr_recon_loss: 11297997.6000; val_masked_gp_l1_reg_loss: 77825.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63797.0938; val_chrom_access_recon_loss: 1904725.5417; val_global_loss: 16064236.5333; val_optim_loss: 16064236.5333
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9876; val_auprc_score: 0.9829; val_best_acc_score: 0.9543; val_best_f1_score: 0.9550; train_kl_reg_loss: 73140.9785; train_edge_recon_loss: 2647450.4523; train_gene_expr_recon_loss: 11121175.2366; train_masked_gp_l1_reg_loss: 77813.2087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63706.5685; train_chrom_access_recon_loss: 1895397.5544; train_global_loss: 15878683.9466; train_optim_loss: 15878683.9466; val_kl_reg_loss: 73963.0318; val_edge_recon_loss: 2657871.6333; val_gene_expr_recon_loss: 11313293.2000; val_masked_gp_l1_reg_loss: 77800.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63620.7539; val_chrom_access_recon_loss: 1916273.0917; val_global_loss: 16102823.0000; val_optim_loss: 16102823.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9866; val_auprc_score: 0.9820; val_best_acc_score: 0.9547; val_best_f1_score: 0.9558; train_kl_reg_loss: 73075.4675; train_edge_recon_loss: 2647986.6298; train_gene_expr_recon_loss: 11124235.9466; train_masked_gp_l1_reg_loss: 77794.3213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63560.2996; train_chrom_access_recon_loss: 1895560.9456; train_global_loss: 15882213.6031; train_optim_loss: 15882213.6031; val_kl_reg_loss: 73814.8516; val_edge_recon_loss: 2661367.1000; val_gene_expr_recon_loss: 11302503.5333; val_masked_gp_l1_reg_loss: 77786.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63513.7266; val_chrom_access_recon_loss: 1904242.9000; val_global_loss: 16083228.3333; val_optim_loss: 16083228.3333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9883; val_auprc_score: 0.9850; val_best_acc_score: 0.9601; val_best_f1_score: 0.9610; train_kl_reg_loss: 73140.2921; train_edge_recon_loss: 2651360.0477; train_gene_expr_recon_loss: 11134240.5649; train_masked_gp_l1_reg_loss: 77783.1620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63479.0953; train_chrom_access_recon_loss: 1897022.7739; train_global_loss: 15897025.8779; train_optim_loss: 15897025.8779; val_kl_reg_loss: 74130.3583; val_edge_recon_loss: 2637735.9000; val_gene_expr_recon_loss: 11285145.8000; val_masked_gp_l1_reg_loss: 77777.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63430.1445; val_chrom_access_recon_loss: 1903964.7250; val_global_loss: 16042184.6667; val_optim_loss: 16042184.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 40 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9841
val AUPRC score: 0.9784
val best accuracy score: 0.9531
val best F1 score: 0.9546
val target rna MSE score: 1.2078
val source rna MSE score: 0.3966
val target atac MSE score: 0.3342
val source atac MSE score: 0.0970
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
