[True]
Run timestamp: 10102023_063209_173.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_173']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7653; val_auprc_score: 0.7911; val_best_acc_score: 0.5581; val_best_f1_score: 0.6883; train_kl_reg_loss: 80116.7107; train_edge_recon_loss: 748872.7519; train_gene_expr_recon_loss: 21927139.7557; train_masked_gp_l1_reg_loss: 60073.1956; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4033658.1803; train_chrom_access_recon_loss: 2222099.0363; train_global_loss: 29071959.5115; train_optim_loss: 29071959.5115; val_kl_reg_loss: 80000.7193; val_edge_recon_loss: 812325.7208; val_gene_expr_recon_loss: 21248474.9333; val_masked_gp_l1_reg_loss: 63921.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 992428.1875; val_chrom_access_recon_loss: 2200635.7167; val_global_loss: 25397786.9333; val_optim_loss: 25397786.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8813; val_auprc_score: 0.8792; val_best_acc_score: 0.7587; val_best_f1_score: 0.7871; train_kl_reg_loss: 77287.7687; train_edge_recon_loss: 733461.4647; train_gene_expr_recon_loss: 20791183.2214; train_masked_gp_l1_reg_loss: 65374.3311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 505258.0136; train_chrom_access_recon_loss: 2153830.6985; train_global_loss: 24326395.4504; train_optim_loss: 24326395.4504; val_kl_reg_loss: 70328.1255; val_edge_recon_loss: 791251.2000; val_gene_expr_recon_loss: 20872916.8000; val_masked_gp_l1_reg_loss: 67269.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 280581.5312; val_chrom_access_recon_loss: 2166952.2500; val_global_loss: 24249300.0000; val_optim_loss: 24249300.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9055; val_auprc_score: 0.8985; val_best_acc_score: 0.8200; val_best_f1_score: 0.8334; train_kl_reg_loss: 70245.0063; train_edge_recon_loss: 684876.0262; train_gene_expr_recon_loss: 20509967.6794; train_masked_gp_l1_reg_loss: 70111.7428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 231438.3941; train_chrom_access_recon_loss: 2129654.8826; train_global_loss: 23696293.8168; train_optim_loss: 23696293.8168; val_kl_reg_loss: 79784.1849; val_edge_recon_loss: 641914.0917; val_gene_expr_recon_loss: 20638358.8000; val_masked_gp_l1_reg_loss: 72848.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 197597.8906; val_chrom_access_recon_loss: 2153277.8583; val_global_loss: 23783780.9333; val_optim_loss: 23783780.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9310; val_auprc_score: 0.9184; val_best_acc_score: 0.8538; val_best_f1_score: 0.8609; train_kl_reg_loss: 77110.8691; train_edge_recon_loss: 628654.5100; train_gene_expr_recon_loss: 20262739.0534; train_masked_gp_l1_reg_loss: 74886.1050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177377.6689; train_chrom_access_recon_loss: 2109170.6050; train_global_loss: 23329938.7176; train_optim_loss: 23329938.7176; val_kl_reg_loss: 74660.2016; val_edge_recon_loss: 626499.9458; val_gene_expr_recon_loss: 20469269.8667; val_masked_gp_l1_reg_loss: 76974.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 160151.1094; val_chrom_access_recon_loss: 2128807.7500; val_global_loss: 23536364.1333; val_optim_loss: 23536364.1333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9318; val_auprc_score: 0.9208; val_best_acc_score: 0.8550; val_best_f1_score: 0.8648; train_kl_reg_loss: 74254.8610; train_edge_recon_loss: 615143.1093; train_gene_expr_recon_loss: 20093277.9389; train_masked_gp_l1_reg_loss: 78302.1828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147316.4187; train_chrom_access_recon_loss: 2088910.5630; train_global_loss: 23097205.1450; train_optim_loss: 23097205.1450; val_kl_reg_loss: 73192.8724; val_edge_recon_loss: 611585.0417; val_gene_expr_recon_loss: 20261188.0000; val_masked_gp_l1_reg_loss: 79380.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137528.5938; val_chrom_access_recon_loss: 2118868.3583; val_global_loss: 23281742.5333; val_optim_loss: 23281742.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9377; val_auprc_score: 0.9256; val_best_acc_score: 0.8682; val_best_f1_score: 0.8744; train_kl_reg_loss: 71846.1536; train_edge_recon_loss: 607462.4733; train_gene_expr_recon_loss: 19934153.6336; train_masked_gp_l1_reg_loss: 80501.6414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131699.7418; train_chrom_access_recon_loss: 2075878.1145; train_global_loss: 22901541.6947; train_optim_loss: 22901541.6947; val_kl_reg_loss: 67304.4849; val_edge_recon_loss: 606034.6458; val_gene_expr_recon_loss: 20160028.5333; val_masked_gp_l1_reg_loss: 81429.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127965.1953; val_chrom_access_recon_loss: 2098602.6167; val_global_loss: 23141366.1333; val_optim_loss: 23141366.1333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9443; val_auprc_score: 0.9336; val_best_acc_score: 0.8746; val_best_f1_score: 0.8813; train_kl_reg_loss: 69489.4133; train_edge_recon_loss: 602248.2696; train_gene_expr_recon_loss: 19773496.1832; train_masked_gp_l1_reg_loss: 82237.9180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125015.9854; train_chrom_access_recon_loss: 2060825.4113; train_global_loss: 22713313.2366; train_optim_loss: 22713313.2366; val_kl_reg_loss: 68185.5422; val_edge_recon_loss: 605796.5083; val_gene_expr_recon_loss: 19950630.8000; val_masked_gp_l1_reg_loss: 83091.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123183.1172; val_chrom_access_recon_loss: 2079779.3000; val_global_loss: 22910668.0000; val_optim_loss: 22910668.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9549; val_auprc_score: 0.9472; val_best_acc_score: 0.8903; val_best_f1_score: 0.8966; train_kl_reg_loss: 67926.2268; train_edge_recon_loss: 597274.3254; train_gene_expr_recon_loss: 19667829.3130; train_masked_gp_l1_reg_loss: 83584.2137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119955.3028; train_chrom_access_recon_loss: 2047726.1765; train_global_loss: 22584295.4351; train_optim_loss: 22584295.4351; val_kl_reg_loss: 65687.0458; val_edge_recon_loss: 594266.6125; val_gene_expr_recon_loss: 19916195.6000; val_masked_gp_l1_reg_loss: 84233.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117558.1953; val_chrom_access_recon_loss: 2090609.4583; val_global_loss: 22868550.4000; val_optim_loss: 22868550.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9577; val_auprc_score: 0.9511; val_best_acc_score: 0.8938; val_best_f1_score: 0.8979; train_kl_reg_loss: 66854.2366; train_edge_recon_loss: 594438.4389; train_gene_expr_recon_loss: 19574508.4885; train_masked_gp_l1_reg_loss: 84672.8525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116215.6504; train_chrom_access_recon_loss: 2037801.0010; train_global_loss: 22474490.6718; train_optim_loss: 22474490.6718; val_kl_reg_loss: 66269.3784; val_edge_recon_loss: 596191.4333; val_gene_expr_recon_loss: 19773289.0667; val_masked_gp_l1_reg_loss: 85012.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115229.0469; val_chrom_access_recon_loss: 2059603.7583; val_global_loss: 22695595.8667; val_optim_loss: 22695595.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9609; val_auprc_score: 0.9522; val_best_acc_score: 0.9031; val_best_f1_score: 0.9060; train_kl_reg_loss: 65730.2006; train_edge_recon_loss: 590795.1536; train_gene_expr_recon_loss: 19468436.7634; train_masked_gp_l1_reg_loss: 85549.9848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113121.3251; train_chrom_access_recon_loss: 2026553.9323; train_global_loss: 22350187.4046; train_optim_loss: 22350187.4046; val_kl_reg_loss: 65097.3206; val_edge_recon_loss: 590063.1667; val_gene_expr_recon_loss: 19626164.8000; val_masked_gp_l1_reg_loss: 86006.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112194.0156; val_chrom_access_recon_loss: 2050631.0250; val_global_loss: 22530156.5333; val_optim_loss: 22530156.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9663; val_auprc_score: 0.9594; val_best_acc_score: 0.9086; val_best_f1_score: 0.9112; train_kl_reg_loss: 64893.2696; train_edge_recon_loss: 588012.2228; train_gene_expr_recon_loss: 19368438.5191; train_masked_gp_l1_reg_loss: 86525.5049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110636.4893; train_chrom_access_recon_loss: 2016840.7662; train_global_loss: 22235346.6718; train_optim_loss: 22235346.6718; val_kl_reg_loss: 65721.8591; val_edge_recon_loss: 590459.5667; val_gene_expr_recon_loss: 19549597.0667; val_masked_gp_l1_reg_loss: 86795.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109710.4922; val_chrom_access_recon_loss: 2040448.5167; val_global_loss: 22442732.8000; val_optim_loss: 22442732.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9658; val_auprc_score: 0.9571; val_best_acc_score: 0.9151; val_best_f1_score: 0.9167; train_kl_reg_loss: 64126.1433; train_edge_recon_loss: 585744.2128; train_gene_expr_recon_loss: 19304185.2977; train_masked_gp_l1_reg_loss: 87271.9040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109029.7125; train_chrom_access_recon_loss: 2009742.0076; train_global_loss: 22160099.2061; train_optim_loss: 22160099.2061; val_kl_reg_loss: 63337.3216; val_edge_recon_loss: 586449.5792; val_gene_expr_recon_loss: 19642289.7333; val_masked_gp_l1_reg_loss: 87606.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110060.5469; val_chrom_access_recon_loss: 2046264.2667; val_global_loss: 22536007.2000; val_optim_loss: 22536007.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9687; val_auprc_score: 0.9615; val_best_acc_score: 0.9138; val_best_f1_score: 0.9164; train_kl_reg_loss: 63391.2380; train_edge_recon_loss: 583612.8225; train_gene_expr_recon_loss: 19223067.0534; train_masked_gp_l1_reg_loss: 87988.4376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108467.1625; train_chrom_access_recon_loss: 2001134.8416; train_global_loss: 22067661.5573; train_optim_loss: 22067661.5573; val_kl_reg_loss: 61939.0141; val_edge_recon_loss: 585031.7125; val_gene_expr_recon_loss: 19482979.2000; val_masked_gp_l1_reg_loss: 88487.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107864.1250; val_chrom_access_recon_loss: 2031379.8500; val_global_loss: 22357681.7333; val_optim_loss: 22357681.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9637; val_auprc_score: 0.9504; val_best_acc_score: 0.9115; val_best_f1_score: 0.9152; train_kl_reg_loss: 58908.1481; train_edge_recon_loss: 593419.1069; train_gene_expr_recon_loss: 19268794.5496; train_masked_gp_l1_reg_loss: 88091.2301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112460.6028; train_chrom_access_recon_loss: 2008469.5954; train_global_loss: 22130143.2519; train_optim_loss: 22130143.2519; val_kl_reg_loss: 62599.1990; val_edge_recon_loss: 586368.5750; val_gene_expr_recon_loss: 19517576.5333; val_masked_gp_l1_reg_loss: 87796.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106966.7891; val_chrom_access_recon_loss: 2027614.7333; val_global_loss: 22388921.3333; val_optim_loss: 22388921.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9653; val_auprc_score: 0.9567; val_best_acc_score: 0.9109; val_best_f1_score: 0.9152; train_kl_reg_loss: 62843.4070; train_edge_recon_loss: 584889.6169; train_gene_expr_recon_loss: 19113604.4733; train_masked_gp_l1_reg_loss: 87706.3377; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105721.7523; train_chrom_access_recon_loss: 1985846.3397; train_global_loss: 21940611.9695; train_optim_loss: 21940611.9695; val_kl_reg_loss: 63093.6867; val_edge_recon_loss: 584511.1375; val_gene_expr_recon_loss: 19359865.0667; val_masked_gp_l1_reg_loss: 87812.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105124.3438; val_chrom_access_recon_loss: 2014424.2000; val_global_loss: 22214830.1333; val_optim_loss: 22214830.1333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9639; val_auprc_score: 0.9545; val_best_acc_score: 0.9100; val_best_f1_score: 0.9124; train_kl_reg_loss: 62847.1745; train_edge_recon_loss: 583445.9552; train_gene_expr_recon_loss: 19064399.4962; train_masked_gp_l1_reg_loss: 88077.8157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104483.4578; train_chrom_access_recon_loss: 1981163.6603; train_global_loss: 21884417.6794; train_optim_loss: 21884417.6794; val_kl_reg_loss: 63478.0576; val_edge_recon_loss: 587104.7583; val_gene_expr_recon_loss: 19308855.6000; val_masked_gp_l1_reg_loss: 88392.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104347.3672; val_chrom_access_recon_loss: 2014580.7417; val_global_loss: 22166759.0667; val_optim_loss: 22166759.0667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9566; val_auprc_score: 0.9438; val_best_acc_score: 0.9026; val_best_f1_score: 0.9076; train_kl_reg_loss: 66598.1106; train_edge_recon_loss: 595275.6746; train_gene_expr_recon_loss: 19136344.9466; train_masked_gp_l1_reg_loss: 87254.0102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107272.5253; train_chrom_access_recon_loss: 1993170.3492; train_global_loss: 21985915.7710; train_optim_loss: 21985915.7710; val_kl_reg_loss: 65276.1568; val_edge_recon_loss: 615746.8083; val_gene_expr_recon_loss: 19282541.6000; val_masked_gp_l1_reg_loss: 86103.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109148.3281; val_chrom_access_recon_loss: 2015488.4750; val_global_loss: 22174305.2000; val_optim_loss: 22174305.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9652; val_auprc_score: 0.9598; val_best_acc_score: 0.9086; val_best_f1_score: 0.9115; train_kl_reg_loss: 68182.7051; train_edge_recon_loss: 589712.4051; train_gene_expr_recon_loss: 19084785.8931; train_masked_gp_l1_reg_loss: 85600.6233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110751.5688; train_chrom_access_recon_loss: 1989201.4742; train_global_loss: 21928234.5802; train_optim_loss: 21928234.5802; val_kl_reg_loss: 72486.4682; val_edge_recon_loss: 590306.7167; val_gene_expr_recon_loss: 19375134.9333; val_masked_gp_l1_reg_loss: 84938.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114240.0703; val_chrom_access_recon_loss: 2014825.5500; val_global_loss: 22251931.4667; val_optim_loss: 22251931.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9669; val_auprc_score: 0.9557; val_best_acc_score: 0.9165; val_best_f1_score: 0.9193; train_kl_reg_loss: 69468.3467; train_edge_recon_loss: 584893.6827; train_gene_expr_recon_loss: 18992542.0458; train_masked_gp_l1_reg_loss: 84751.8452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106530.4395; train_chrom_access_recon_loss: 1971116.0048; train_global_loss: 21809302.4122; train_optim_loss: 21809302.4122; val_kl_reg_loss: 65324008.2031; val_edge_recon_loss: 582318.2458; val_gene_expr_recon_loss: 19224348.0000; val_masked_gp_l1_reg_loss: 84929.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105636.5156; val_chrom_access_recon_loss: 2000491.9917; val_global_loss: 87321738.4000; val_optim_loss: 87321738.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9675; val_auprc_score: 0.9623; val_best_acc_score: 0.9146; val_best_f1_score: 0.9179; train_kl_reg_loss: 88649.3565; train_edge_recon_loss: 589619.0577; train_gene_expr_recon_loss: 19010869.2214; train_masked_gp_l1_reg_loss: 84605.1865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106033.8019; train_chrom_access_recon_loss: 1976505.2987; train_global_loss: 21856282.0458; train_optim_loss: 21856282.0458; val_kl_reg_loss: 68010.1677; val_edge_recon_loss: 585771.8042; val_gene_expr_recon_loss: 19224823.2000; val_masked_gp_l1_reg_loss: 84651.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103449.0312; val_chrom_access_recon_loss: 2000237.9500; val_global_loss: 22066945.2000; val_optim_loss: 22066945.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9664; val_auprc_score: 0.9558; val_best_acc_score: 0.9174; val_best_f1_score: 0.9199; train_kl_reg_loss: 89701.3263; train_edge_recon_loss: 586493.2968; train_gene_expr_recon_loss: 18971908.2748; train_masked_gp_l1_reg_loss: 84552.1421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104008.4716; train_chrom_access_recon_loss: 1964450.2910; train_global_loss: 21801113.8321; train_optim_loss: 21801113.8321; val_kl_reg_loss: 63676.2370; val_edge_recon_loss: 589421.5958; val_gene_expr_recon_loss: 19185489.4667; val_masked_gp_l1_reg_loss: 84677.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104362.5625; val_chrom_access_recon_loss: 1997101.3417; val_global_loss: 22024728.8000; val_optim_loss: 22024728.8000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9676; val_auprc_score: 0.9560; val_best_acc_score: 0.9188; val_best_f1_score: 0.9223; train_kl_reg_loss: 66431.4315; train_edge_recon_loss: 583603.1407; train_gene_expr_recon_loss: 18862736.4733; train_masked_gp_l1_reg_loss: 84649.7508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103486.6044; train_chrom_access_recon_loss: 1956434.4198; train_global_loss: 21657341.8626; train_optim_loss: 21657341.8626; val_kl_reg_loss: 66441.1081; val_edge_recon_loss: 583865.1125; val_gene_expr_recon_loss: 19085639.7333; val_masked_gp_l1_reg_loss: 84850.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103687.8594; val_chrom_access_recon_loss: 1988944.4667; val_global_loss: 21913428.2667; val_optim_loss: 21913428.2667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9595; val_auprc_score: 0.9505; val_best_acc_score: 0.9004; val_best_f1_score: 0.9044; train_kl_reg_loss: 336163.9219; train_edge_recon_loss: 585368.0162; train_gene_expr_recon_loss: 18885019.2824; train_masked_gp_l1_reg_loss: 85056.6217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104915.3813; train_chrom_access_recon_loss: 1962688.1918; train_global_loss: 21959211.4809; train_optim_loss: 21959211.4809; val_kl_reg_loss: 65890.2563; val_edge_recon_loss: 600545.1750; val_gene_expr_recon_loss: 19164432.1333; val_masked_gp_l1_reg_loss: 85218.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110385.5859; val_chrom_access_recon_loss: 1998551.6500; val_global_loss: 22025023.2000; val_optim_loss: 22025023.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9540; val_auprc_score: 0.9440; val_best_acc_score: 0.8971; val_best_f1_score: 0.9013; train_kl_reg_loss: 8261867104.7694; train_edge_recon_loss: 607930.2719; train_gene_expr_recon_loss: 19019926.3969; train_masked_gp_l1_reg_loss: 84602.4032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112980.4016; train_chrom_access_recon_loss: 1971912.3855; train_global_loss: 8283664401.1756; train_optim_loss: 8283664401.1756; val_kl_reg_loss: 72028.9297; val_edge_recon_loss: 602168.2792; val_gene_expr_recon_loss: 19160903.8667; val_masked_gp_l1_reg_loss: 83660.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119170.4922; val_chrom_access_recon_loss: 2000026.8750; val_global_loss: 22037958.0000; val_optim_loss: 22037958.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9613; val_auprc_score: 0.9530; val_best_acc_score: 0.9056; val_best_f1_score: 0.9083; train_kl_reg_loss: 161669.3702; train_edge_recon_loss: 593092.1512; train_gene_expr_recon_loss: 18955430.3053; train_masked_gp_l1_reg_loss: 83564.6070; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109332.5824; train_chrom_access_recon_loss: 1971450.5592; train_global_loss: 21874539.4656; train_optim_loss: 21874539.4656; val_kl_reg_loss: 70535.5010; val_edge_recon_loss: 590688.7208; val_gene_expr_recon_loss: 19070797.4667; val_masked_gp_l1_reg_loss: 83915.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105756.4141; val_chrom_access_recon_loss: 1986714.9833; val_global_loss: 21908408.4000; val_optim_loss: 21908408.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9467; val_auprc_score: 0.9387; val_best_acc_score: 0.8804; val_best_f1_score: 0.8849; train_kl_reg_loss: 144620194.9929; train_edge_recon_loss: 742878.5873; train_gene_expr_recon_loss: 18150932.2748; train_masked_gp_l1_reg_loss: 81671.0987; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99288.9005; train_chrom_access_recon_loss: 1845764.2567; train_global_loss: 165540750.4885; train_optim_loss: 165540750.4885; val_kl_reg_loss: 41219.7508; val_edge_recon_loss: 723898.6667; val_gene_expr_recon_loss: 17837566.4000; val_masked_gp_l1_reg_loss: 79291.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100349.6797; val_chrom_access_recon_loss: 1863253.3667; val_global_loss: 20645580.1333; val_optim_loss: 20645580.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9265; val_auprc_score: 0.9170; val_best_acc_score: 0.8514; val_best_f1_score: 0.8593; train_kl_reg_loss: 49317.8399; train_edge_recon_loss: 694478.5358; train_gene_expr_recon_loss: 17611858.7786; train_masked_gp_l1_reg_loss: 77307.8597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99390.3789; train_chrom_access_recon_loss: 1824091.3521; train_global_loss: 20356444.6870; train_optim_loss: 20356444.6870; val_kl_reg_loss: 34751.3276; val_edge_recon_loss: 659044.3083; val_gene_expr_recon_loss: 17796924.8000; val_masked_gp_l1_reg_loss: 76178.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97842.0312; val_chrom_access_recon_loss: 1853102.6083; val_global_loss: 20517842.9333; val_optim_loss: 20517842.9333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9323; val_auprc_score: 0.9226; val_best_acc_score: 0.8570; val_best_f1_score: 0.8668; train_kl_reg_loss: 47985.5212; train_edge_recon_loss: 626595.1698; train_gene_expr_recon_loss: 17546578.0534; train_masked_gp_l1_reg_loss: 75857.7978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96956.0133; train_chrom_access_recon_loss: 1820486.1403; train_global_loss: 20214458.8550; train_optim_loss: 20214458.8550; val_kl_reg_loss: 43970.2096; val_edge_recon_loss: 611456.9667; val_gene_expr_recon_loss: 17760817.7333; val_masked_gp_l1_reg_loss: 75474.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95695.6406; val_chrom_access_recon_loss: 1855783.3333; val_global_loss: 20443198.1333; val_optim_loss: 20443198.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9215; val_auprc_score: 0.9087; val_best_acc_score: 0.8494; val_best_f1_score: 0.8585; train_kl_reg_loss: 312278417.4589; train_edge_recon_loss: 615765.9146; train_gene_expr_recon_loss: 17585456.3969; train_masked_gp_l1_reg_loss: 74945.6196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96906.2685; train_chrom_access_recon_loss: 1820358.9237; train_global_loss: 332471813.7557; train_optim_loss: 332471813.7557; val_kl_reg_loss: 41544.3271; val_edge_recon_loss: 612371.1833; val_gene_expr_recon_loss: 17679783.0667; val_masked_gp_l1_reg_loss: 74677.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99896.4375; val_chrom_access_recon_loss: 1849766.4333; val_global_loss: 20358039.0667; val_optim_loss: 20358039.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9243; val_auprc_score: 0.9073; val_best_acc_score: 0.8619; val_best_f1_score: 0.8682; train_kl_reg_loss: 161988.2576; train_edge_recon_loss: 607352.5592; train_gene_expr_recon_loss: 17497572.5954; train_masked_gp_l1_reg_loss: 74450.5544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99626.9675; train_chrom_access_recon_loss: 1815858.7481; train_global_loss: 20256849.7252; train_optim_loss: 20256849.7252; val_kl_reg_loss: 47612.0885; val_edge_recon_loss: 607468.7750; val_gene_expr_recon_loss: 17598044.8000; val_masked_gp_l1_reg_loss: 74164.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100341.1172; val_chrom_access_recon_loss: 1833738.8000; val_global_loss: 20261370.2667; val_optim_loss: 20261370.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9227; val_auprc_score: 0.9090; val_best_acc_score: 0.8503; val_best_f1_score: 0.8618; train_kl_reg_loss: 20000508.6961; train_edge_recon_loss: 601885.4103; train_gene_expr_recon_loss: 17447243.7328; train_masked_gp_l1_reg_loss: 73870.5041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99413.6896; train_chrom_access_recon_loss: 1811708.2261; train_global_loss: 40034630.5344; train_optim_loss: 40034630.5344; val_kl_reg_loss: 46665.3109; val_edge_recon_loss: 604620.9000; val_gene_expr_recon_loss: 17654665.7333; val_masked_gp_l1_reg_loss: 73271.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98421.8750; val_chrom_access_recon_loss: 1838565.2583; val_global_loss: 20316211.2000; val_optim_loss: 20316211.2000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9257; val_auprc_score: 0.9050; val_best_acc_score: 0.8603; val_best_f1_score: 0.8701; train_kl_reg_loss: 51637.6050; train_edge_recon_loss: 596310.3550; train_gene_expr_recon_loss: 17407959.9008; train_masked_gp_l1_reg_loss: 72737.5930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98068.8696; train_chrom_access_recon_loss: 1807782.2996; train_global_loss: 20034496.3817; train_optim_loss: 20034496.3817; val_kl_reg_loss: 47764.5521; val_edge_recon_loss: 597356.1417; val_gene_expr_recon_loss: 17647835.3333; val_masked_gp_l1_reg_loss: 72283.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97110.9922; val_chrom_access_recon_loss: 1840329.1000; val_global_loss: 20302679.2000; val_optim_loss: 20302679.2000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9381; val_auprc_score: 0.9271; val_best_acc_score: 0.8681; val_best_f1_score: 0.8776; train_kl_reg_loss: 53812.8957; train_edge_recon_loss: 594326.8244; train_gene_expr_recon_loss: 17351418.7481; train_masked_gp_l1_reg_loss: 71759.8196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97262.8226; train_chrom_access_recon_loss: 1802403.4809; train_global_loss: 19970984.7786; train_optim_loss: 19970984.7786; val_kl_reg_loss: 44467.7516; val_edge_recon_loss: 601131.1625; val_gene_expr_recon_loss: 17473855.2000; val_masked_gp_l1_reg_loss: 71313.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97627.1016; val_chrom_access_recon_loss: 1829318.0333; val_global_loss: 20117714.1333; val_optim_loss: 20117714.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9330; val_auprc_score: 0.9150; val_best_acc_score: 0.8645; val_best_f1_score: 0.8724; train_kl_reg_loss: 53035.8982; train_edge_recon_loss: 591225.0119; train_gene_expr_recon_loss: 17224927.7252; train_masked_gp_l1_reg_loss: 70841.0168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96944.6111; train_chrom_access_recon_loss: 1791555.0792; train_global_loss: 19828529.4504; train_optim_loss: 19828529.4504; val_kl_reg_loss: 48414.3901; val_edge_recon_loss: 590204.5167; val_gene_expr_recon_loss: 17388462.1333; val_masked_gp_l1_reg_loss: 70346.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97018.3516; val_chrom_access_recon_loss: 1811488.1500; val_global_loss: 20005932.9333; val_optim_loss: 20005932.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9386; val_auprc_score: 0.9271; val_best_acc_score: 0.8701; val_best_f1_score: 0.8765; train_kl_reg_loss: 6347247313112672.0000; train_edge_recon_loss: 598735.7114; train_gene_expr_recon_loss: 17222480.1832; train_masked_gp_l1_reg_loss: 69754.3006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96797.1206; train_chrom_access_recon_loss: 1789656.8740; train_global_loss: 6347247332737977.0000; train_optim_loss: 6347247332737977.0000; val_kl_reg_loss: 80653.9271; val_edge_recon_loss: 646318.1458; val_gene_expr_recon_loss: 17541484.6667; val_masked_gp_l1_reg_loss: 69143.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98000.5781; val_chrom_access_recon_loss: 1840731.2750; val_global_loss: 20276332.0000; val_optim_loss: 20276332.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9295; val_auprc_score: 0.9139; val_best_acc_score: 0.8642; val_best_f1_score: 0.8726; train_kl_reg_loss: 757296.0140; train_edge_recon_loss: 610092.1918; train_gene_expr_recon_loss: 17281223.6107; train_masked_gp_l1_reg_loss: 68600.2389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96944.2062; train_chrom_access_recon_loss: 1791769.0992; train_global_loss: 20605925.1603; train_optim_loss: 20605925.1603; val_kl_reg_loss: 69281.2188; val_edge_recon_loss: 609154.4042; val_gene_expr_recon_loss: 17442472.4000; val_masked_gp_l1_reg_loss: 67897.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96671.1953; val_chrom_access_recon_loss: 1826466.8833; val_global_loss: 20111945.0667; val_optim_loss: 20111945.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9358; val_auprc_score: 0.9271; val_best_acc_score: 0.8636; val_best_f1_score: 0.8722; train_kl_reg_loss: 513476857.4413; train_edge_recon_loss: 607135.2166; train_gene_expr_recon_loss: 17268218.3893; train_masked_gp_l1_reg_loss: 67474.9717; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97536.7783; train_chrom_access_recon_loss: 1792346.8387; train_global_loss: 533309556.4885; train_optim_loss: 533309556.4885; val_kl_reg_loss: 55864.4745; val_edge_recon_loss: 610589.6375; val_gene_expr_recon_loss: 17344959.2000; val_masked_gp_l1_reg_loss: 66526.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97124.2656; val_chrom_access_recon_loss: 1807825.4833; val_global_loss: 19982889.0667; val_optim_loss: 19982889.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9361; val_auprc_score: 0.9252; val_best_acc_score: 0.8673; val_best_f1_score: 0.8756; train_kl_reg_loss: 74170.9581; train_edge_recon_loss: 603647.1264; train_gene_expr_recon_loss: 17160492.0153; train_masked_gp_l1_reg_loss: 66054.6669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97310.6792; train_chrom_access_recon_loss: 1779342.4475; train_global_loss: 19781017.9084; train_optim_loss: 19781017.9084; val_kl_reg_loss: 52052.2659; val_edge_recon_loss: 612573.9458; val_gene_expr_recon_loss: 17385642.4667; val_masked_gp_l1_reg_loss: 65245.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96114.1016; val_chrom_access_recon_loss: 1814444.0500; val_global_loss: 20026072.9333; val_optim_loss: 20026072.9333
