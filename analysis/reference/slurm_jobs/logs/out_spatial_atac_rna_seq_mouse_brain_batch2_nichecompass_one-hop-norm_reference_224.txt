[True]
Run timestamp: 10102023_095711_224.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_224']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6112; val_auprc_score: 0.6107; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 37672.8690; train_edge_recon_loss: 737181.7140; train_gene_expr_recon_loss: 23539464.0000; train_masked_gp_l1_reg_loss: 149392.5934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5098315.2992; train_chrom_access_recon_loss: 6991257.5303; train_global_loss: 36553284.1515; train_optim_loss: 36553284.1515; val_kl_reg_loss: 60701.8955; val_edge_recon_loss: 813206.1484; val_gene_expr_recon_loss: 21553820.0000; val_masked_gp_l1_reg_loss: 120212.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2981876.5000; val_chrom_access_recon_loss: 6569035.8750; val_global_loss: 32098852.2500; val_optim_loss: 32098852.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6742; val_auprc_score: 0.6516; val_best_acc_score: 0.5218; val_best_f1_score: 0.6742; train_kl_reg_loss: 78894.3406; train_edge_recon_loss: 744480.8977; train_gene_expr_recon_loss: 21386497.5758; train_masked_gp_l1_reg_loss: 110945.8603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1686749.3277; train_chrom_access_recon_loss: 6608356.0985; train_global_loss: 30615923.9091; train_optim_loss: 30615923.9091; val_kl_reg_loss: 77809.0889; val_edge_recon_loss: 812808.8125; val_gene_expr_recon_loss: 21159104.5000; val_masked_gp_l1_reg_loss: 106329.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 840923.1250; val_chrom_access_recon_loss: 6532086.3750; val_global_loss: 29529062.7500; val_optim_loss: 29529062.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7024; val_auprc_score: 0.6964; val_best_acc_score: 0.5575; val_best_f1_score: 0.6848; train_kl_reg_loss: 79192.5997; train_edge_recon_loss: 737792.2093; train_gene_expr_recon_loss: 21120233.2727; train_masked_gp_l1_reg_loss: 104224.7714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 555902.2893; train_chrom_access_recon_loss: 6557164.0833; train_global_loss: 29154509.0303; train_optim_loss: 29154509.0303; val_kl_reg_loss: 74199.1650; val_edge_recon_loss: 812303.6641; val_gene_expr_recon_loss: 20767040.2500; val_masked_gp_l1_reg_loss: 102774.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 369957.7500; val_chrom_access_recon_loss: 6484110.0000; val_global_loss: 28610385.7500; val_optim_loss: 28610385.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8128; val_auprc_score: 0.7959; val_best_acc_score: 0.7453; val_best_f1_score: 0.7579; train_kl_reg_loss: 73942.0009; train_edge_recon_loss: 733320.0180; train_gene_expr_recon_loss: 20959932.6667; train_masked_gp_l1_reg_loss: 102297.2402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 288515.1915; train_chrom_access_recon_loss: 6517505.6970; train_global_loss: 28675512.9394; train_optim_loss: 28675512.9394; val_kl_reg_loss: 76512.3408; val_edge_recon_loss: 805967.6094; val_gene_expr_recon_loss: 20754740.5000; val_masked_gp_l1_reg_loss: 102511.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 229558.8125; val_chrom_access_recon_loss: 6477611.0625; val_global_loss: 28446901.5000; val_optim_loss: 28446901.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8407; val_auprc_score: 0.8110; val_best_acc_score: 0.7456; val_best_f1_score: 0.7806; train_kl_reg_loss: 69575.6715; train_edge_recon_loss: 726048.2633; train_gene_expr_recon_loss: 20797575.6667; train_masked_gp_l1_reg_loss: 103683.9064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 200232.4787; train_chrom_access_recon_loss: 6469327.0303; train_global_loss: 28366442.8788; train_optim_loss: 28366442.8788; val_kl_reg_loss: 73897.6826; val_edge_recon_loss: 783103.7500; val_gene_expr_recon_loss: 20512228.0000; val_masked_gp_l1_reg_loss: 105121.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179186.5469; val_chrom_access_recon_loss: 6378786.8125; val_global_loss: 28032324.2500; val_optim_loss: 28032324.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8562; val_auprc_score: 0.8216; val_best_acc_score: 0.7891; val_best_f1_score: 0.8050; train_kl_reg_loss: 66526.7674; train_edge_recon_loss: 711281.7898; train_gene_expr_recon_loss: 20664935.9394; train_masked_gp_l1_reg_loss: 106418.4326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 167864.7022; train_chrom_access_recon_loss: 6432703.5909; train_global_loss: 28149731.3636; train_optim_loss: 28149731.3636; val_kl_reg_loss: 64588.5845; val_edge_recon_loss: 729072.5703; val_gene_expr_recon_loss: 20224473.0000; val_masked_gp_l1_reg_loss: 107973.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158026.4219; val_chrom_access_recon_loss: 6318329.3750; val_global_loss: 27602463.5000; val_optim_loss: 27602463.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8637; val_auprc_score: 0.8274; val_best_acc_score: 0.7980; val_best_f1_score: 0.8193; train_kl_reg_loss: 69684.6778; train_edge_recon_loss: 675095.8958; train_gene_expr_recon_loss: 20535591.5455; train_masked_gp_l1_reg_loss: 109576.6606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148777.0980; train_chrom_access_recon_loss: 6402677.6970; train_global_loss: 27941403.4848; train_optim_loss: 27941403.4848; val_kl_reg_loss: 75132.2871; val_edge_recon_loss: 654647.4766; val_gene_expr_recon_loss: 20361877.2500; val_masked_gp_l1_reg_loss: 111296.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140861.4688; val_chrom_access_recon_loss: 6393351.5000; val_global_loss: 27737166.7500; val_optim_loss: 27737166.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8667; val_auprc_score: 0.8292; val_best_acc_score: 0.8039; val_best_f1_score: 0.8238; train_kl_reg_loss: 77214.9258; train_edge_recon_loss: 643223.5284; train_gene_expr_recon_loss: 20442969.6061; train_masked_gp_l1_reg_loss: 112258.5782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133746.3649; train_chrom_access_recon_loss: 6384105.4394; train_global_loss: 27793518.4242; train_optim_loss: 27793518.4242; val_kl_reg_loss: 78294.8584; val_edge_recon_loss: 631886.9609; val_gene_expr_recon_loss: 20326781.2500; val_masked_gp_l1_reg_loss: 113507.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127469.5391; val_chrom_access_recon_loss: 6313903.8750; val_global_loss: 27591844.5000; val_optim_loss: 27591844.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8700; val_auprc_score: 0.8375; val_best_acc_score: 0.7961; val_best_f1_score: 0.8230; train_kl_reg_loss: 78142.7596; train_edge_recon_loss: 634142.6032; train_gene_expr_recon_loss: 20328861.2424; train_masked_gp_l1_reg_loss: 114208.1748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122336.6228; train_chrom_access_recon_loss: 6351352.2273; train_global_loss: 27629043.5455; train_optim_loss: 27629043.5455; val_kl_reg_loss: 78011.1709; val_edge_recon_loss: 639494.9688; val_gene_expr_recon_loss: 20205022.2500; val_masked_gp_l1_reg_loss: 114877.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117378.8906; val_chrom_access_recon_loss: 6290949.6250; val_global_loss: 27445733.2500; val_optim_loss: 27445733.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8765; val_auprc_score: 0.8387; val_best_acc_score: 0.8055; val_best_f1_score: 0.8285; train_kl_reg_loss: 77090.5180; train_edge_recon_loss: 630276.7812; train_gene_expr_recon_loss: 20271998.2121; train_masked_gp_l1_reg_loss: 115454.3415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113415.6806; train_chrom_access_recon_loss: 6331160.2879; train_global_loss: 27539395.7576; train_optim_loss: 27539395.7576; val_kl_reg_loss: 76048.2578; val_edge_recon_loss: 628658.8359; val_gene_expr_recon_loss: 20161393.2500; val_masked_gp_l1_reg_loss: 116391.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111010.4609; val_chrom_access_recon_loss: 6308444.6250; val_global_loss: 27401946.7500; val_optim_loss: 27401946.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8882; val_auprc_score: 0.8524; val_best_acc_score: 0.8170; val_best_f1_score: 0.8357; train_kl_reg_loss: 76534.4330; train_edge_recon_loss: 622543.9659; train_gene_expr_recon_loss: 20179717.2424; train_masked_gp_l1_reg_loss: 116518.9364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107148.5423; train_chrom_access_recon_loss: 6306344.9394; train_global_loss: 27408808.1818; train_optim_loss: 27408808.1818; val_kl_reg_loss: 75154.6592; val_edge_recon_loss: 618199.7109; val_gene_expr_recon_loss: 19808338.7500; val_masked_gp_l1_reg_loss: 116855.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104492.1719; val_chrom_access_recon_loss: 6212722.3750; val_global_loss: 26935763.7500; val_optim_loss: 26935763.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8977; val_auprc_score: 0.8695; val_best_acc_score: 0.8184; val_best_f1_score: 0.8334; train_kl_reg_loss: 76052.2807; train_edge_recon_loss: 619607.4451; train_gene_expr_recon_loss: 20125363.5152; train_masked_gp_l1_reg_loss: 117295.9564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102430.2410; train_chrom_access_recon_loss: 6286595.0985; train_global_loss: 27327344.5152; train_optim_loss: 27327344.5152; val_kl_reg_loss: 73182.2080; val_edge_recon_loss: 623032.8672; val_gene_expr_recon_loss: 20153864.0000; val_masked_gp_l1_reg_loss: 117730.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100423.3438; val_chrom_access_recon_loss: 6289668.0625; val_global_loss: 27357901.5000; val_optim_loss: 27357901.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8943; val_auprc_score: 0.8606; val_best_acc_score: 0.8211; val_best_f1_score: 0.8359; train_kl_reg_loss: 74459.7789; train_edge_recon_loss: 620262.9441; train_gene_expr_recon_loss: 20064641.1515; train_masked_gp_l1_reg_loss: 118137.3041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98752.9963; train_chrom_access_recon_loss: 6267561.0152; train_global_loss: 27243815.0303; train_optim_loss: 27243815.0303; val_kl_reg_loss: 74748.9736; val_edge_recon_loss: 625375.5859; val_gene_expr_recon_loss: 19919892.2500; val_masked_gp_l1_reg_loss: 118879.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97245.0703; val_chrom_access_recon_loss: 6243018.0625; val_global_loss: 27079161.0000; val_optim_loss: 27079161.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9066; val_auprc_score: 0.8808; val_best_acc_score: 0.8372; val_best_f1_score: 0.8480; train_kl_reg_loss: 74284.9920; train_edge_recon_loss: 616531.1212; train_gene_expr_recon_loss: 19984234.4242; train_masked_gp_l1_reg_loss: 118940.9300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96375.2782; train_chrom_access_recon_loss: 6238184.6591; train_global_loss: 27128551.4848; train_optim_loss: 27128551.4848; val_kl_reg_loss: 75783.7285; val_edge_recon_loss: 618412.8047; val_gene_expr_recon_loss: 19857336.5000; val_masked_gp_l1_reg_loss: 118861.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95176.8828; val_chrom_access_recon_loss: 6285913.5000; val_global_loss: 27051484.5000; val_optim_loss: 27051484.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9089; val_auprc_score: 0.8863; val_best_acc_score: 0.8356; val_best_f1_score: 0.8482; train_kl_reg_loss: 74196.1741; train_edge_recon_loss: 611497.7812; train_gene_expr_recon_loss: 19923986.4242; train_masked_gp_l1_reg_loss: 119283.0084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94398.3786; train_chrom_access_recon_loss: 6227754.7500; train_global_loss: 27051116.3939; train_optim_loss: 27051116.3939; val_kl_reg_loss: 75341.2422; val_edge_recon_loss: 610229.9297; val_gene_expr_recon_loss: 19575382.0000; val_masked_gp_l1_reg_loss: 119680.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93892.3125; val_chrom_access_recon_loss: 6168144.3125; val_global_loss: 26642669.7500; val_optim_loss: 26642669.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9224; val_auprc_score: 0.8962; val_best_acc_score: 0.8552; val_best_f1_score: 0.8651; train_kl_reg_loss: 73631.9824; train_edge_recon_loss: 608693.6534; train_gene_expr_recon_loss: 19870779.5455; train_masked_gp_l1_reg_loss: 119992.0750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93272.2491; train_chrom_access_recon_loss: 6213123.6288; train_global_loss: 26979493.2424; train_optim_loss: 26979493.2424; val_kl_reg_loss: 72621.2520; val_edge_recon_loss: 603888.6484; val_gene_expr_recon_loss: 19704343.0000; val_masked_gp_l1_reg_loss: 120151.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92742.8750; val_chrom_access_recon_loss: 6168521.4375; val_global_loss: 26762268.5000; val_optim_loss: 26762268.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9205; val_auprc_score: 0.8910; val_best_acc_score: 0.8514; val_best_f1_score: 0.8628; train_kl_reg_loss: 73378.1050; train_edge_recon_loss: 608780.3229; train_gene_expr_recon_loss: 19797495.9697; train_masked_gp_l1_reg_loss: 120417.5176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92121.4092; train_chrom_access_recon_loss: 6186503.8636; train_global_loss: 26878697.1515; train_optim_loss: 26878697.1515; val_kl_reg_loss: 73807.0654; val_edge_recon_loss: 606641.1641; val_gene_expr_recon_loss: 19475989.5000; val_masked_gp_l1_reg_loss: 120803.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91888.1406; val_chrom_access_recon_loss: 6135659.3125; val_global_loss: 26504789.2500; val_optim_loss: 26504789.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9288; val_auprc_score: 0.9095; val_best_acc_score: 0.8603; val_best_f1_score: 0.8695; train_kl_reg_loss: 72721.3961; train_edge_recon_loss: 606689.9697; train_gene_expr_recon_loss: 19757547.9394; train_masked_gp_l1_reg_loss: 120964.2826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91149.0898; train_chrom_access_recon_loss: 6173055.5909; train_global_loss: 26822128.2424; train_optim_loss: 26822128.2424; val_kl_reg_loss: 73310.9707; val_edge_recon_loss: 603101.6484; val_gene_expr_recon_loss: 19601667.0000; val_masked_gp_l1_reg_loss: 121496.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91886.0156; val_chrom_access_recon_loss: 6089319.4375; val_global_loss: 26580781.0000; val_optim_loss: 26580781.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9278; val_auprc_score: 0.9068; val_best_acc_score: 0.8581; val_best_f1_score: 0.8674; train_kl_reg_loss: 72680.6022; train_edge_recon_loss: 604045.4583; train_gene_expr_recon_loss: 19691553.1515; train_masked_gp_l1_reg_loss: 121508.7665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90227.8986; train_chrom_access_recon_loss: 6153402.0000; train_global_loss: 26733418.0000; train_optim_loss: 26733418.0000; val_kl_reg_loss: 71935.7871; val_edge_recon_loss: 610846.7031; val_gene_expr_recon_loss: 19489933.0000; val_masked_gp_l1_reg_loss: 121678.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89782.5859; val_chrom_access_recon_loss: 6133768.3125; val_global_loss: 26517943.7500; val_optim_loss: 26517943.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9286; val_auprc_score: 0.9049; val_best_acc_score: 0.8630; val_best_f1_score: 0.8707; train_kl_reg_loss: 72422.0850; train_edge_recon_loss: 602075.2822; train_gene_expr_recon_loss: 19666514.0303; train_masked_gp_l1_reg_loss: 122125.5948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88685.2878; train_chrom_access_recon_loss: 6142490.8712; train_global_loss: 26694313.2424; train_optim_loss: 26694313.2424; val_kl_reg_loss: 73082.3799; val_edge_recon_loss: 607924.7031; val_gene_expr_recon_loss: 19426844.7500; val_masked_gp_l1_reg_loss: 122488.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88294.1094; val_chrom_access_recon_loss: 6081383.5000; val_global_loss: 26400017.2500; val_optim_loss: 26400017.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9294; val_auprc_score: 0.9068; val_best_acc_score: 0.8614; val_best_f1_score: 0.8699; train_kl_reg_loss: 72140.6334; train_edge_recon_loss: 600893.5208; train_gene_expr_recon_loss: 19618901.6061; train_masked_gp_l1_reg_loss: 122554.4087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87576.9162; train_chrom_access_recon_loss: 6127160.7045; train_global_loss: 26629227.7879; train_optim_loss: 26629227.7879; val_kl_reg_loss: 70765.0293; val_edge_recon_loss: 606887.7969; val_gene_expr_recon_loss: 19405635.7500; val_masked_gp_l1_reg_loss: 122819.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87115.9766; val_chrom_access_recon_loss: 6140979.0625; val_global_loss: 26434203.7500; val_optim_loss: 26434203.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9302; val_auprc_score: 0.9107; val_best_acc_score: 0.8622; val_best_f1_score: 0.8721; train_kl_reg_loss: 71942.7217; train_edge_recon_loss: 597722.9119; train_gene_expr_recon_loss: 19569161.0909; train_masked_gp_l1_reg_loss: 123113.8467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86592.0401; train_chrom_access_recon_loss: 6112857.2727; train_global_loss: 26561390.0303; train_optim_loss: 26561390.0303; val_kl_reg_loss: 72041.6699; val_edge_recon_loss: 602066.1016; val_gene_expr_recon_loss: 19404214.2500; val_masked_gp_l1_reg_loss: 123595.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85826.0625; val_chrom_access_recon_loss: 6109040.1250; val_global_loss: 26396784.0000; val_optim_loss: 26396784.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9318; val_auprc_score: 0.9088; val_best_acc_score: 0.8665; val_best_f1_score: 0.8743; train_kl_reg_loss: 71757.8254; train_edge_recon_loss: 597985.0009; train_gene_expr_recon_loss: 19533088.3030; train_masked_gp_l1_reg_loss: 123712.3172; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85561.6705; train_chrom_access_recon_loss: 6097076.4545; train_global_loss: 26509181.5758; train_optim_loss: 26509181.5758; val_kl_reg_loss: 72597.9873; val_edge_recon_loss: 605762.5859; val_gene_expr_recon_loss: 19423880.2500; val_masked_gp_l1_reg_loss: 124112.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85543.8047; val_chrom_access_recon_loss: 6053890.3750; val_global_loss: 26365787.2500; val_optim_loss: 26365787.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9313; val_auprc_score: 0.9101; val_best_acc_score: 0.8646; val_best_f1_score: 0.8719; train_kl_reg_loss: 71169.0175; train_edge_recon_loss: 597377.6316; train_gene_expr_recon_loss: 19491482.4242; train_masked_gp_l1_reg_loss: 124135.3039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84718.4112; train_chrom_access_recon_loss: 6076712.5455; train_global_loss: 26445595.3333; train_optim_loss: 26445595.3333; val_kl_reg_loss: 71922.6719; val_edge_recon_loss: 604156.7734; val_gene_expr_recon_loss: 19387871.0000; val_masked_gp_l1_reg_loss: 124494.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84720.0938; val_chrom_access_recon_loss: 6040465.9375; val_global_loss: 26313630.5000; val_optim_loss: 26313630.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9306; val_auprc_score: 0.9027; val_best_acc_score: 0.8632; val_best_f1_score: 0.8712; train_kl_reg_loss: 71197.9974; train_edge_recon_loss: 595651.7500; train_gene_expr_recon_loss: 19467576.0303; train_masked_gp_l1_reg_loss: 124623.6594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84200.9240; train_chrom_access_recon_loss: 6065164.9167; train_global_loss: 26408415.3636; train_optim_loss: 26408415.3636; val_kl_reg_loss: 71534.4316; val_edge_recon_loss: 611369.9844; val_gene_expr_recon_loss: 19330214.2500; val_masked_gp_l1_reg_loss: 125098.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83978.9141; val_chrom_access_recon_loss: 6014023.8750; val_global_loss: 26236218.7500; val_optim_loss: 26236218.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8845; val_auprc_score: 0.8475; val_best_acc_score: 0.8119; val_best_f1_score: 0.8313; train_kl_reg_loss: 48922.7756; train_edge_recon_loss: 717158.2244; train_gene_expr_recon_loss: 18775241.0303; train_masked_gp_l1_reg_loss: 127158.1011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87985.2978; train_chrom_access_recon_loss: 5866289.8182; train_global_loss: 25622755.2121; train_optim_loss: 25622755.2121; val_kl_reg_loss: 18118.7512; val_edge_recon_loss: 720684.7344; val_gene_expr_recon_loss: 18582616.2500; val_masked_gp_l1_reg_loss: 131040.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94814.2109; val_chrom_access_recon_loss: 5822632.2500; val_global_loss: 25369906.0000; val_optim_loss: 25369906.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8803; val_auprc_score: 0.8514; val_best_acc_score: 0.8092; val_best_f1_score: 0.8337; train_kl_reg_loss: 40663.4120; train_edge_recon_loss: 695842.0265; train_gene_expr_recon_loss: 18482572.7879; train_masked_gp_l1_reg_loss: 130392.9174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93609.1829; train_chrom_access_recon_loss: 5785361.9091; train_global_loss: 25228442.4848; train_optim_loss: 25228442.4848; val_kl_reg_loss: 24222.1218; val_edge_recon_loss: 690873.6484; val_gene_expr_recon_loss: 18242362.7500; val_masked_gp_l1_reg_loss: 127973.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91352.6641; val_chrom_access_recon_loss: 5724274.7500; val_global_loss: 24901059.5000; val_optim_loss: 24901059.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8736; val_auprc_score: 0.8357; val_best_acc_score: 0.8066; val_best_f1_score: 0.8300; train_kl_reg_loss: 43639.4705; train_edge_recon_loss: 664357.3002; train_gene_expr_recon_loss: 18422764.6970; train_masked_gp_l1_reg_loss: 126562.4688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90004.1352; train_chrom_access_recon_loss: 5773997.5455; train_global_loss: 25121325.7273; train_optim_loss: 25121325.7273; val_kl_reg_loss: 28151.9146; val_edge_recon_loss: 653460.0938; val_gene_expr_recon_loss: 18248465.7500; val_masked_gp_l1_reg_loss: 125124.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88429.7422; val_chrom_access_recon_loss: 5727816.7500; val_global_loss: 24871448.5000; val_optim_loss: 24871448.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8784; val_auprc_score: 0.8493; val_best_acc_score: 0.8103; val_best_f1_score: 0.8348; train_kl_reg_loss: 46264.3150; train_edge_recon_loss: 636335.8163; train_gene_expr_recon_loss: 18351144.1818; train_masked_gp_l1_reg_loss: 123618.9338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87426.7013; train_chrom_access_recon_loss: 5757788.5000; train_global_loss: 25002578.4545; train_optim_loss: 25002578.4545; val_kl_reg_loss: 33848.6235; val_edge_recon_loss: 630661.4531; val_gene_expr_recon_loss: 18222212.7500; val_masked_gp_l1_reg_loss: 122367.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86330.5625; val_chrom_access_recon_loss: 5762233.2500; val_global_loss: 24857654.2500; val_optim_loss: 24857654.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8689; val_auprc_score: 0.8346; val_best_acc_score: 0.8041; val_best_f1_score: 0.8282; train_kl_reg_loss: 47593.7796; train_edge_recon_loss: 621253.8466; train_gene_expr_recon_loss: 18332970.6364; train_masked_gp_l1_reg_loss: 121135.3905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85855.3602; train_chrom_access_recon_loss: 5752422.7576; train_global_loss: 24961231.8182; train_optim_loss: 24961231.8182; val_kl_reg_loss: 39047.9346; val_edge_recon_loss: 624750.4922; val_gene_expr_recon_loss: 18112345.7500; val_masked_gp_l1_reg_loss: 120125.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85522.8125; val_chrom_access_recon_loss: 5753134.5625; val_global_loss: 24734926.5000; val_optim_loss: 24734926.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8725; val_auprc_score: 0.8393; val_best_acc_score: 0.8071; val_best_f1_score: 0.8298; train_kl_reg_loss: 48857.0429; train_edge_recon_loss: 615294.9119; train_gene_expr_recon_loss: 18284369.3939; train_masked_gp_l1_reg_loss: 118968.6934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84748.3351; train_chrom_access_recon_loss: 5744737.7727; train_global_loss: 24896976.0909; train_optim_loss: 24896976.0909; val_kl_reg_loss: 42751.2939; val_edge_recon_loss: 619672.7188; val_gene_expr_recon_loss: 18091225.0000; val_masked_gp_l1_reg_loss: 118018.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83929.9688; val_chrom_access_recon_loss: 5749422.8125; val_global_loss: 24705020.0000; val_optim_loss: 24705020.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8669; val_auprc_score: 0.8292; val_best_acc_score: 0.8057; val_best_f1_score: 0.8294; train_kl_reg_loss: 50455.7561; train_edge_recon_loss: 610005.3826; train_gene_expr_recon_loss: 18265949.8788; train_masked_gp_l1_reg_loss: 116882.3852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83369.3123; train_chrom_access_recon_loss: 5732415.4015; train_global_loss: 24859078.2121; train_optim_loss: 24859078.2121; val_kl_reg_loss: 47115.5776; val_edge_recon_loss: 615851.7109; val_gene_expr_recon_loss: 18129107.0000; val_masked_gp_l1_reg_loss: 116141.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82813.3281; val_chrom_access_recon_loss: 5732752.1875; val_global_loss: 24723782.7500; val_optim_loss: 24723782.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8791; val_auprc_score: 0.8410; val_best_acc_score: 0.8117; val_best_f1_score: 0.8334; train_kl_reg_loss: 51313.2948; train_edge_recon_loss: 609289.4744; train_gene_expr_recon_loss: 18222353.7273; train_masked_gp_l1_reg_loss: 115197.4973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82195.8383; train_chrom_access_recon_loss: 5721602.5227; train_global_loss: 24801952.3939; train_optim_loss: 24801952.3939; val_kl_reg_loss: 47910.3872; val_edge_recon_loss: 607939.4141; val_gene_expr_recon_loss: 18234622.7500; val_masked_gp_l1_reg_loss: 114146.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81461.8203; val_chrom_access_recon_loss: 5747351.5000; val_global_loss: 24833432.2500; val_optim_loss: 24833432.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8839; val_auprc_score: 0.8550; val_best_acc_score: 0.8146; val_best_f1_score: 0.8377; train_kl_reg_loss: 52375.3864; train_edge_recon_loss: 604197.8797; train_gene_expr_recon_loss: 18183892.8485; train_masked_gp_l1_reg_loss: 113395.6460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80869.6557; train_chrom_access_recon_loss: 5708213.4091; train_global_loss: 24742944.8182; train_optim_loss: 24742944.8182; val_kl_reg_loss: 49436.3994; val_edge_recon_loss: 599388.7188; val_gene_expr_recon_loss: 17941816.2500; val_masked_gp_l1_reg_loss: 112899.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80614.8594; val_chrom_access_recon_loss: 5582131.9375; val_global_loss: 24366287.5000; val_optim_loss: 24366287.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8786; val_auprc_score: 0.8486; val_best_acc_score: 0.8060; val_best_f1_score: 0.8318; train_kl_reg_loss: 53145.6716; train_edge_recon_loss: 604116.8722; train_gene_expr_recon_loss: 18160016.7273; train_masked_gp_l1_reg_loss: 112155.7158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79950.2317; train_chrom_access_recon_loss: 5703329.1818; train_global_loss: 24712714.3636; train_optim_loss: 24712714.3636; val_kl_reg_loss: 50352.9224; val_edge_recon_loss: 606718.0938; val_gene_expr_recon_loss: 17802843.5000; val_masked_gp_l1_reg_loss: 111711.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79563.5625; val_chrom_access_recon_loss: 5623253.0000; val_global_loss: 24274442.5000; val_optim_loss: 24274442.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8802; val_auprc_score: 0.8460; val_best_acc_score: 0.8106; val_best_f1_score: 0.8351; train_kl_reg_loss: 53455.2801; train_edge_recon_loss: 603622.7509; train_gene_expr_recon_loss: 18151801.7576; train_masked_gp_l1_reg_loss: 111171.9313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79064.6435; train_chrom_access_recon_loss: 5702140.7273; train_global_loss: 24701256.9697; train_optim_loss: 24701256.9697; val_kl_reg_loss: 51877.8086; val_edge_recon_loss: 602343.6328; val_gene_expr_recon_loss: 18017204.0000; val_masked_gp_l1_reg_loss: 110832.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78398.2734; val_chrom_access_recon_loss: 5681396.5000; val_global_loss: 24542051.5000; val_optim_loss: 24542051.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8768; val_auprc_score: 0.8438; val_best_acc_score: 0.8031; val_best_f1_score: 0.8297; train_kl_reg_loss: 53775.6870; train_edge_recon_loss: 602664.2235; train_gene_expr_recon_loss: 18121784.1818; train_masked_gp_l1_reg_loss: 110220.2944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78168.3524; train_chrom_access_recon_loss: 5686341.9015; train_global_loss: 24652954.6364; train_optim_loss: 24652954.6364; val_kl_reg_loss: 52537.9458; val_edge_recon_loss: 615109.1094; val_gene_expr_recon_loss: 18011694.5000; val_masked_gp_l1_reg_loss: 109909.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77574.9375; val_chrom_access_recon_loss: 5647146.3750; val_global_loss: 24513971.5000; val_optim_loss: 24513971.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8967; val_auprc_score: 0.8680; val_best_acc_score: 0.8278; val_best_f1_score: 0.8430; train_kl_reg_loss: 54081.7218; train_edge_recon_loss: 601902.0814; train_gene_expr_recon_loss: 18114493.7879; train_masked_gp_l1_reg_loss: 109559.8247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77067.3475; train_chrom_access_recon_loss: 5696050.1061; train_global_loss: 24653154.9394; train_optim_loss: 24653154.9394; val_kl_reg_loss: 52927.6484; val_edge_recon_loss: 598852.5469; val_gene_expr_recon_loss: 17933459.0000; val_masked_gp_l1_reg_loss: 109139.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76118.8828; val_chrom_access_recon_loss: 5652487.5625; val_global_loss: 24422984.5000; val_optim_loss: 24422984.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8869; val_auprc_score: 0.8562; val_best_acc_score: 0.8111; val_best_f1_score: 0.8322; train_kl_reg_loss: 54179.1372; train_edge_recon_loss: 602925.5625; train_gene_expr_recon_loss: 18086758.8485; train_masked_gp_l1_reg_loss: 108856.0378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76042.1882; train_chrom_access_recon_loss: 5682069.1288; train_global_loss: 24610830.4848; train_optim_loss: 24610830.4848; val_kl_reg_loss: 53001.5972; val_edge_recon_loss: 601224.9297; val_gene_expr_recon_loss: 17910211.7500; val_masked_gp_l1_reg_loss: 108684.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75715.0312; val_chrom_access_recon_loss: 5643957.6875; val_global_loss: 24392796.0000; val_optim_loss: 24392796.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8893; val_auprc_score: 0.8568; val_best_acc_score: 0.8119; val_best_f1_score: 0.8357; train_kl_reg_loss: 54676.4554; train_edge_recon_loss: 599451.9754; train_gene_expr_recon_loss: 18058260.8182; train_masked_gp_l1_reg_loss: 105666.8626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63409.4719; train_chrom_access_recon_loss: 5674498.3485; train_global_loss: 24555963.8788; train_optim_loss: 24555963.8788; val_kl_reg_loss: 53555.2407; val_edge_recon_loss: 605688.9922; val_gene_expr_recon_loss: 17839426.7500; val_masked_gp_l1_reg_loss: 104599.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60770.1641; val_chrom_access_recon_loss: 5634618.1250; val_global_loss: 24298658.7500; val_optim_loss: 24298658.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8945; val_auprc_score: 0.8734; val_best_acc_score: 0.8184; val_best_f1_score: 0.8393; train_kl_reg_loss: 54991.9089; train_edge_recon_loss: 600776.9375; train_gene_expr_recon_loss: 18040184.5152; train_masked_gp_l1_reg_loss: 104372.3659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60373.1400; train_chrom_access_recon_loss: 5665428.0530; train_global_loss: 24526127.0606; train_optim_loss: 24526127.0606; val_kl_reg_loss: 53525.4785; val_edge_recon_loss: 608626.0938; val_gene_expr_recon_loss: 17828778.0000; val_masked_gp_l1_reg_loss: 104232.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60073.6289; val_chrom_access_recon_loss: 5583388.2500; val_global_loss: 24238624.0000; val_optim_loss: 24238624.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8937; val_auprc_score: 0.8711; val_best_acc_score: 0.8176; val_best_f1_score: 0.8388; train_kl_reg_loss: 55326.0146; train_edge_recon_loss: 599306.9877; train_gene_expr_recon_loss: 18045539.6061; train_masked_gp_l1_reg_loss: 104125.1735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59844.4619; train_chrom_access_recon_loss: 5669103.4773; train_global_loss: 24533245.5758; train_optim_loss: 24533245.5758; val_kl_reg_loss: 53910.4014; val_edge_recon_loss: 603563.1797; val_gene_expr_recon_loss: 17961131.7500; val_masked_gp_l1_reg_loss: 104025.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59628.4375; val_chrom_access_recon_loss: 5648921.6875; val_global_loss: 24431181.2500; val_optim_loss: 24431181.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8845; val_auprc_score: 0.8502; val_best_acc_score: 0.8106; val_best_f1_score: 0.8351; train_kl_reg_loss: 55414.7577; train_edge_recon_loss: 599388.5597; train_gene_expr_recon_loss: 18028551.2121; train_masked_gp_l1_reg_loss: 103950.5050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59441.5517; train_chrom_access_recon_loss: 5664474.7803; train_global_loss: 24511221.3636; train_optim_loss: 24511221.3636; val_kl_reg_loss: 54741.2983; val_edge_recon_loss: 607084.6953; val_gene_expr_recon_loss: 18010513.7500; val_masked_gp_l1_reg_loss: 103873.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59254.7773; val_chrom_access_recon_loss: 5712725.8750; val_global_loss: 24548193.2500; val_optim_loss: 24548193.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8913; val_auprc_score: 0.8597; val_best_acc_score: 0.8229; val_best_f1_score: 0.8419; train_kl_reg_loss: 55726.2675; train_edge_recon_loss: 600367.4138; train_gene_expr_recon_loss: 18046764.6364; train_masked_gp_l1_reg_loss: 103830.4901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59084.8527; train_chrom_access_recon_loss: 5669783.7121; train_global_loss: 24535557.2424; train_optim_loss: 24535557.2424; val_kl_reg_loss: 55015.4463; val_edge_recon_loss: 597763.6406; val_gene_expr_recon_loss: 17817047.7500; val_masked_gp_l1_reg_loss: 103748.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58932.9219; val_chrom_access_recon_loss: 5641356.7500; val_global_loss: 24273864.0000; val_optim_loss: 24273864.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8945; val_auprc_score: 0.8694; val_best_acc_score: 0.8146; val_best_f1_score: 0.8377; train_kl_reg_loss: 55830.7165; train_edge_recon_loss: 600311.5445; train_gene_expr_recon_loss: 18043942.5758; train_masked_gp_l1_reg_loss: 103700.9647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58810.9533; train_chrom_access_recon_loss: 5671260.9848; train_global_loss: 24533857.9394; train_optim_loss: 24533857.9394; val_kl_reg_loss: 54961.6665; val_edge_recon_loss: 603334.1641; val_gene_expr_recon_loss: 17919986.0000; val_masked_gp_l1_reg_loss: 103641.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58651.8750; val_chrom_access_recon_loss: 5626706.6875; val_global_loss: 24367282.5000; val_optim_loss: 24367282.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8953; val_auprc_score: 0.8713; val_best_acc_score: 0.8181; val_best_f1_score: 0.8391; train_kl_reg_loss: 55879.7428; train_edge_recon_loss: 599092.2699; train_gene_expr_recon_loss: 18014603.6364; train_masked_gp_l1_reg_loss: 103328.1921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57364.6178; train_chrom_access_recon_loss: 5664098.0985; train_global_loss: 24494366.4545; train_optim_loss: 24494366.4545; val_kl_reg_loss: 54556.0137; val_edge_recon_loss: 605384.7500; val_gene_expr_recon_loss: 17852123.2500; val_masked_gp_l1_reg_loss: 103198.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57106.0391; val_chrom_access_recon_loss: 5611262.5000; val_global_loss: 24283630.7500; val_optim_loss: 24283630.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8961; val_auprc_score: 0.8698; val_best_acc_score: 0.8170; val_best_f1_score: 0.8402; train_kl_reg_loss: 56027.2288; train_edge_recon_loss: 598703.9545; train_gene_expr_recon_loss: 18018591.3333; train_masked_gp_l1_reg_loss: 103161.6610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57073.4638; train_chrom_access_recon_loss: 5661944.4924; train_global_loss: 24495502.1818; train_optim_loss: 24495502.1818; val_kl_reg_loss: 54621.0723; val_edge_recon_loss: 602828.7578; val_gene_expr_recon_loss: 17839930.5000; val_masked_gp_l1_reg_loss: 103131.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57039.0234; val_chrom_access_recon_loss: 5600778.8125; val_global_loss: 24258331.0000; val_optim_loss: 24258331.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8917; val_auprc_score: 0.8680; val_best_acc_score: 0.8168; val_best_f1_score: 0.8370; train_kl_reg_loss: 56045.8703; train_edge_recon_loss: 600296.6629; train_gene_expr_recon_loss: 18019026.9394; train_masked_gp_l1_reg_loss: 103111.4354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57009.5346; train_chrom_access_recon_loss: 5659479.9924; train_global_loss: 24494970.3030; train_optim_loss: 24494970.3030; val_kl_reg_loss: 54859.4531; val_edge_recon_loss: 606119.5781; val_gene_expr_recon_loss: 17920058.2500; val_masked_gp_l1_reg_loss: 103093.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56978.4688; val_chrom_access_recon_loss: 5627477.6875; val_global_loss: 24368587.5000; val_optim_loss: 24368587.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8908; val_auprc_score: 0.8648; val_best_acc_score: 0.8149; val_best_f1_score: 0.8387; train_kl_reg_loss: 56101.2803; train_edge_recon_loss: 601505.6193; train_gene_expr_recon_loss: 18029303.0909; train_masked_gp_l1_reg_loss: 103080.9898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56955.8645; train_chrom_access_recon_loss: 5662967.1136; train_global_loss: 24509914.0606; train_optim_loss: 24509914.0606; val_kl_reg_loss: 54780.3330; val_edge_recon_loss: 604074.5156; val_gene_expr_recon_loss: 17777249.7500; val_masked_gp_l1_reg_loss: 103071.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56933.0234; val_chrom_access_recon_loss: 5609084.6875; val_global_loss: 24205195.0000; val_optim_loss: 24205195.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8930; val_auprc_score: 0.8642; val_best_acc_score: 0.8178; val_best_f1_score: 0.8403; train_kl_reg_loss: 56077.6693; train_edge_recon_loss: 601196.9205; train_gene_expr_recon_loss: 18007120.3030; train_masked_gp_l1_reg_loss: 103060.7249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56914.2130; train_chrom_access_recon_loss: 5653910.1591; train_global_loss: 24478280.2727; train_optim_loss: 24478280.2727; val_kl_reg_loss: 54893.3110; val_edge_recon_loss: 602860.5625; val_gene_expr_recon_loss: 17946942.7500; val_masked_gp_l1_reg_loss: 103049.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56895.1016; val_chrom_access_recon_loss: 5685208.8750; val_global_loss: 24449851.5000; val_optim_loss: 24449851.5000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8844; val_auprc_score: 0.8568; val_best_acc_score: 0.8060; val_best_f1_score: 0.8322; train_kl_reg_loss: 56063.5138; train_edge_recon_loss: 601513.1174; train_gene_expr_recon_loss: 18023415.8485; train_masked_gp_l1_reg_loss: 103042.1268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56872.6589; train_chrom_access_recon_loss: 5663401.5682; train_global_loss: 24504309.0303; train_optim_loss: 24504309.0303; val_kl_reg_loss: 54690.7476; val_edge_recon_loss: 609807.6094; val_gene_expr_recon_loss: 17902317.0000; val_masked_gp_l1_reg_loss: 103033.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56851.5000; val_chrom_access_recon_loss: 5599197.6875; val_global_loss: 24325899.2500; val_optim_loss: 24325899.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8936; val_auprc_score: 0.8676; val_best_acc_score: 0.8224; val_best_f1_score: 0.8440; train_kl_reg_loss: 56157.9747; train_edge_recon_loss: 602798.2907; train_gene_expr_recon_loss: 18030968.6818; train_masked_gp_l1_reg_loss: 103027.3022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56828.4637; train_chrom_access_recon_loss: 5668110.4091; train_global_loss: 24517891.3030; train_optim_loss: 24517891.3030; val_kl_reg_loss: 54851.1172; val_edge_recon_loss: 602459.4141; val_gene_expr_recon_loss: 17870467.7500; val_masked_gp_l1_reg_loss: 103019.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56810.5000; val_chrom_access_recon_loss: 5616965.3750; val_global_loss: 24304574.5000; val_optim_loss: 24304574.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8916; val_auprc_score: 0.8593; val_best_acc_score: 0.8162; val_best_f1_score: 0.8389; train_kl_reg_loss: 56119.1255; train_edge_recon_loss: 597773.9328; train_gene_expr_recon_loss: 18014970.6970; train_masked_gp_l1_reg_loss: 103010.7571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56790.3126; train_chrom_access_recon_loss: 5662166.9697; train_global_loss: 24490832.0303; train_optim_loss: 24490832.0303; val_kl_reg_loss: 54935.9917; val_edge_recon_loss: 606173.0625; val_gene_expr_recon_loss: 17885433.7500; val_masked_gp_l1_reg_loss: 103005.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56772.5703; val_chrom_access_recon_loss: 5617683.6875; val_global_loss: 24324004.5000; val_optim_loss: 24324004.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8990; val_auprc_score: 0.8712; val_best_acc_score: 0.8227; val_best_f1_score: 0.8410; train_kl_reg_loss: 56152.4152; train_edge_recon_loss: 600391.2528; train_gene_expr_recon_loss: 18006111.3030; train_masked_gp_l1_reg_loss: 102974.4118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56643.0192; train_chrom_access_recon_loss: 5653881.1591; train_global_loss: 24476153.6061; train_optim_loss: 24476153.6061; val_kl_reg_loss: 54856.1934; val_edge_recon_loss: 599227.9062; val_gene_expr_recon_loss: 17895184.7500; val_masked_gp_l1_reg_loss: 102961.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56617.3047; val_chrom_access_recon_loss: 5653508.8750; val_global_loss: 24362358.0000; val_optim_loss: 24362358.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8902; val_auprc_score: 0.8613; val_best_acc_score: 0.8133; val_best_f1_score: 0.8354; train_kl_reg_loss: 56183.5101; train_edge_recon_loss: 600213.7509; train_gene_expr_recon_loss: 18024946.6061; train_masked_gp_l1_reg_loss: 102957.0167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56613.5267; train_chrom_access_recon_loss: 5663408.0909; train_global_loss: 24504322.6061; train_optim_loss: 24504322.6061; val_kl_reg_loss: 55324.2559; val_edge_recon_loss: 608463.0703; val_gene_expr_recon_loss: 17992054.7500; val_masked_gp_l1_reg_loss: 102953.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56610.1172; val_chrom_access_recon_loss: 5662516.7500; val_global_loss: 24477922.5000; val_optim_loss: 24477922.5000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8963; val_auprc_score: 0.8777; val_best_acc_score: 0.8130; val_best_f1_score: 0.8365; train_kl_reg_loss: 56182.2016; train_edge_recon_loss: 598734.0568; train_gene_expr_recon_loss: 18012105.9394; train_masked_gp_l1_reg_loss: 102950.5501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56607.2028; train_chrom_access_recon_loss: 5655289.9015; train_global_loss: 24481869.7576; train_optim_loss: 24481869.7576; val_kl_reg_loss: 54743.2588; val_edge_recon_loss: 599885.8516; val_gene_expr_recon_loss: 17831832.0000; val_masked_gp_l1_reg_loss: 102948.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56604.2930; val_chrom_access_recon_loss: 5575206.1250; val_global_loss: 24221219.2500; val_optim_loss: 24221219.2500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8836; val_auprc_score: 0.8540; val_best_acc_score: 0.8092; val_best_f1_score: 0.8333; train_kl_reg_loss: 56145.6173; train_edge_recon_loss: 598933.6998; train_gene_expr_recon_loss: 18023815.7879; train_masked_gp_l1_reg_loss: 102946.9499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56602.1497; train_chrom_access_recon_loss: 5661135.7121; train_global_loss: 24499579.7576; train_optim_loss: 24499579.7576; val_kl_reg_loss: 54770.0859; val_edge_recon_loss: 608097.5078; val_gene_expr_recon_loss: 17928216.5000; val_masked_gp_l1_reg_loss: 102945.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56599.6914; val_chrom_access_recon_loss: 5632279.8750; val_global_loss: 24382910.5000; val_optim_loss: 24382910.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 20 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.8880
val AUPRC score: 0.8523
val best accuracy score: 0.8152
val best F1 score: 0.8389
val target rna MSE score: 1.6310
val source rna MSE score: 0.9726
val target atac MSE score: 0.3143
val source atac MSE score: 0.1344
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
