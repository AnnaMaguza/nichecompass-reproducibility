[True]
Run timestamp: 10102023_072910_184.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_184']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6676; val_auprc_score: 0.6534; val_best_acc_score: 0.5003; val_best_f1_score: 0.6668; train_kl_reg_loss: 44194.3156; train_edge_recon_loss: 742517.6818; train_gene_expr_recon_loss: 23295881.9394; train_masked_gp_l1_reg_loss: 109998.7478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3342781.2008; train_chrom_access_recon_loss: 2316370.4053; train_global_loss: 29851744.2424; train_optim_loss: 29851744.2424; val_kl_reg_loss: 51841.0684; val_edge_recon_loss: 813127.4922; val_gene_expr_recon_loss: 21946502.5000; val_masked_gp_l1_reg_loss: 94633.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2320565.0000; val_chrom_access_recon_loss: 2229354.5625; val_global_loss: 27456025.2500; val_optim_loss: 27456025.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6845; val_auprc_score: 0.6777; val_best_acc_score: 0.5938; val_best_f1_score: 0.6931; train_kl_reg_loss: 69751.8284; train_edge_recon_loss: 741963.8996; train_gene_expr_recon_loss: 21363402.5758; train_masked_gp_l1_reg_loss: 87190.6442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1556642.1449; train_chrom_access_recon_loss: 2205949.9621; train_global_loss: 26024901.2727; train_optim_loss: 26024901.2727; val_kl_reg_loss: 79740.5752; val_edge_recon_loss: 811669.5547; val_gene_expr_recon_loss: 21606086.2500; val_masked_gp_l1_reg_loss: 82591.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 960384.6250; val_chrom_access_recon_loss: 2213744.6875; val_global_loss: 25754217.0000; val_optim_loss: 25754217.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7039; val_auprc_score: 0.6849; val_best_acc_score: 0.6295; val_best_f1_score: 0.7009; train_kl_reg_loss: 70804.0074; train_edge_recon_loss: 735639.5009; train_gene_expr_recon_loss: 21075554.5758; train_masked_gp_l1_reg_loss: 80794.0516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 668040.2169; train_chrom_access_recon_loss: 2185712.0739; train_global_loss: 24816544.2424; train_optim_loss: 24816544.2424; val_kl_reg_loss: 66186.0117; val_edge_recon_loss: 810893.4609; val_gene_expr_recon_loss: 21285335.0000; val_masked_gp_l1_reg_loss: 79575.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 453684.1562; val_chrom_access_recon_loss: 2196387.7188; val_global_loss: 24892062.5000; val_optim_loss: 24892062.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7932; val_auprc_score: 0.7783; val_best_acc_score: 0.7195; val_best_f1_score: 0.7204; train_kl_reg_loss: 65921.9925; train_edge_recon_loss: 731001.2737; train_gene_expr_recon_loss: 20923347.7273; train_masked_gp_l1_reg_loss: 79266.5143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 345016.0639; train_chrom_access_recon_loss: 2171365.3617; train_global_loss: 24315919.1212; train_optim_loss: 24315919.1212; val_kl_reg_loss: 65583.7642; val_edge_recon_loss: 806045.7188; val_gene_expr_recon_loss: 21195920.0000; val_masked_gp_l1_reg_loss: 79506.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 261387.1094; val_chrom_access_recon_loss: 2167621.3750; val_global_loss: 24576064.7500; val_optim_loss: 24576064.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8634; val_auprc_score: 0.8326; val_best_acc_score: 0.7910; val_best_f1_score: 0.8098; train_kl_reg_loss: 61230.2198; train_edge_recon_loss: 724360.5189; train_gene_expr_recon_loss: 20762819.2424; train_masked_gp_l1_reg_loss: 80363.8619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217796.7985; train_chrom_access_recon_loss: 2160599.0795; train_global_loss: 24007169.6970; train_optim_loss: 24007169.6970; val_kl_reg_loss: 56090.4248; val_edge_recon_loss: 779241.8125; val_gene_expr_recon_loss: 20842653.2500; val_masked_gp_l1_reg_loss: 81569.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 186598.5156; val_chrom_access_recon_loss: 2157050.1094; val_global_loss: 24103203.7500; val_optim_loss: 24103203.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8682; val_auprc_score: 0.8357; val_best_acc_score: 0.7918; val_best_f1_score: 0.8127; train_kl_reg_loss: 59342.0945; train_edge_recon_loss: 693980.2917; train_gene_expr_recon_loss: 20610814.3333; train_masked_gp_l1_reg_loss: 83061.9447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168398.6458; train_chrom_access_recon_loss: 2144692.9830; train_global_loss: 23760290.2727; train_optim_loss: 23760290.2727; val_kl_reg_loss: 62703.8560; val_edge_recon_loss: 671800.8828; val_gene_expr_recon_loss: 20781677.2500; val_masked_gp_l1_reg_loss: 84389.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 151597.5000; val_chrom_access_recon_loss: 2146223.4531; val_global_loss: 23898393.7500; val_optim_loss: 23898393.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8676; val_auprc_score: 0.8324; val_best_acc_score: 0.7891; val_best_f1_score: 0.8119; train_kl_reg_loss: 69975.0966; train_edge_recon_loss: 647072.7585; train_gene_expr_recon_loss: 20491336.9091; train_masked_gp_l1_reg_loss: 84875.3053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138845.8834; train_chrom_access_recon_loss: 2136439.7519; train_global_loss: 23568545.8485; train_optim_loss: 23568545.8485; val_kl_reg_loss: 70022.6562; val_edge_recon_loss: 640874.6562; val_gene_expr_recon_loss: 20709715.5000; val_masked_gp_l1_reg_loss: 85746.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127314.9062; val_chrom_access_recon_loss: 2164040.7031; val_global_loss: 23797713.5000; val_optim_loss: 23797713.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8840; val_auprc_score: 0.8599; val_best_acc_score: 0.8009; val_best_f1_score: 0.8191; train_kl_reg_loss: 71257.4834; train_edge_recon_loss: 630075.9564; train_gene_expr_recon_loss: 20373873.6364; train_masked_gp_l1_reg_loss: 86502.0078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117953.9709; train_chrom_access_recon_loss: 2125325.6098; train_global_loss: 23404988.6061; train_optim_loss: 23404988.6061; val_kl_reg_loss: 71061.2715; val_edge_recon_loss: 629315.3359; val_gene_expr_recon_loss: 20691250.0000; val_masked_gp_l1_reg_loss: 87469.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110325.0000; val_chrom_access_recon_loss: 2141080.3125; val_global_loss: 23730501.5000; val_optim_loss: 23730501.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8913; val_auprc_score: 0.8616; val_best_acc_score: 0.8184; val_best_f1_score: 0.8364; train_kl_reg_loss: 70337.3133; train_edge_recon_loss: 623092.1487; train_gene_expr_recon_loss: 20277794.4545; train_masked_gp_l1_reg_loss: 87854.9066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104352.1590; train_chrom_access_recon_loss: 2117965.4811; train_global_loss: 23281396.6061; train_optim_loss: 23281396.6061; val_kl_reg_loss: 69496.6133; val_edge_recon_loss: 618885.3516; val_gene_expr_recon_loss: 20610839.2500; val_masked_gp_l1_reg_loss: 88697.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99802.0625; val_chrom_access_recon_loss: 2129311.1875; val_global_loss: 23617032.5000; val_optim_loss: 23617032.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9004; val_auprc_score: 0.8697; val_best_acc_score: 0.8278; val_best_f1_score: 0.8391; train_kl_reg_loss: 69226.3175; train_edge_recon_loss: 616174.3722; train_gene_expr_recon_loss: 20205101.8182; train_masked_gp_l1_reg_loss: 89081.5214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96093.3440; train_chrom_access_recon_loss: 2113239.4867; train_global_loss: 23188916.7576; train_optim_loss: 23188916.7576; val_kl_reg_loss: 68974.1416; val_edge_recon_loss: 620074.0312; val_gene_expr_recon_loss: 20428853.2500; val_masked_gp_l1_reg_loss: 89741.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92820.2656; val_chrom_access_recon_loss: 2123362.0156; val_global_loss: 23423825.2500; val_optim_loss: 23423825.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9129; val_auprc_score: 0.8896; val_best_acc_score: 0.8412; val_best_f1_score: 0.8526; train_kl_reg_loss: 68893.6392; train_edge_recon_loss: 611574.8665; train_gene_expr_recon_loss: 20111959.3939; train_masked_gp_l1_reg_loss: 90205.8561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90129.9183; train_chrom_access_recon_loss: 2102198.9621; train_global_loss: 23074962.3939; train_optim_loss: 23074962.3939; val_kl_reg_loss: 68910.2939; val_edge_recon_loss: 611737.2109; val_gene_expr_recon_loss: 20357131.5000; val_masked_gp_l1_reg_loss: 90818.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87976.2734; val_chrom_access_recon_loss: 2116707.6875; val_global_loss: 23333280.7500; val_optim_loss: 23333280.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9102; val_auprc_score: 0.8872; val_best_acc_score: 0.8428; val_best_f1_score: 0.8539; train_kl_reg_loss: 68995.8529; train_edge_recon_loss: 604026.8059; train_gene_expr_recon_loss: 20045884.7273; train_masked_gp_l1_reg_loss: 90990.9711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85190.1587; train_chrom_access_recon_loss: 2097135.3845; train_global_loss: 22992224.0909; train_optim_loss: 22992224.0909; val_kl_reg_loss: 67965.6055; val_edge_recon_loss: 611323.1719; val_gene_expr_recon_loss: 20134135.0000; val_masked_gp_l1_reg_loss: 91427.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83016.2500; val_chrom_access_recon_loss: 2082256.8125; val_global_loss: 23070124.7500; val_optim_loss: 23070124.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9207; val_auprc_score: 0.8870; val_best_acc_score: 0.8544; val_best_f1_score: 0.8631; train_kl_reg_loss: 67702.7588; train_edge_recon_loss: 603233.2301; train_gene_expr_recon_loss: 19961220.5152; train_masked_gp_l1_reg_loss: 92011.7382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81202.8017; train_chrom_access_recon_loss: 2090521.9432; train_global_loss: 22895893.0303; train_optim_loss: 22895893.0303; val_kl_reg_loss: 67470.6870; val_edge_recon_loss: 603078.8125; val_gene_expr_recon_loss: 20291898.0000; val_masked_gp_l1_reg_loss: 92300.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79809.3594; val_chrom_access_recon_loss: 2096539.4219; val_global_loss: 23231097.0000; val_optim_loss: 23231097.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9239; val_auprc_score: 0.9079; val_best_acc_score: 0.8533; val_best_f1_score: 0.8615; train_kl_reg_loss: 67040.4976; train_edge_recon_loss: 601564.5057; train_gene_expr_recon_loss: 19918119.9091; train_masked_gp_l1_reg_loss: 92760.5328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77931.5852; train_chrom_access_recon_loss: 2084527.1212; train_global_loss: 22841943.9091; train_optim_loss: 22841943.9091; val_kl_reg_loss: 67045.5342; val_edge_recon_loss: 606472.4844; val_gene_expr_recon_loss: 20138551.0000; val_masked_gp_l1_reg_loss: 93209.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76716.7344; val_chrom_access_recon_loss: 2083725.3438; val_global_loss: 23065720.5000; val_optim_loss: 23065720.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9279; val_auprc_score: 0.9075; val_best_acc_score: 0.8651; val_best_f1_score: 0.8699; train_kl_reg_loss: 66717.3833; train_edge_recon_loss: 599025.3333; train_gene_expr_recon_loss: 19841909.9394; train_masked_gp_l1_reg_loss: 93468.3362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75652.2347; train_chrom_access_recon_loss: 2075729.9943; train_global_loss: 22752503.1515; train_optim_loss: 22752503.1515; val_kl_reg_loss: 65875.8403; val_edge_recon_loss: 601726.8750; val_gene_expr_recon_loss: 20045745.5000; val_masked_gp_l1_reg_loss: 93885.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74566.8516; val_chrom_access_recon_loss: 2076202.1875; val_global_loss: 22958003.0000; val_optim_loss: 22958003.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9359; val_auprc_score: 0.9195; val_best_acc_score: 0.8678; val_best_f1_score: 0.8746; train_kl_reg_loss: 66014.7563; train_edge_recon_loss: 597988.9962; train_gene_expr_recon_loss: 19797575.6667; train_masked_gp_l1_reg_loss: 94186.6222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74073.9902; train_chrom_access_recon_loss: 2072039.2386; train_global_loss: 22701879.2424; train_optim_loss: 22701879.2424; val_kl_reg_loss: 66285.7319; val_edge_recon_loss: 597098.1484; val_gene_expr_recon_loss: 19919479.5000; val_masked_gp_l1_reg_loss: 94710.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73761.2812; val_chrom_access_recon_loss: 2095132.2500; val_global_loss: 22846467.5000; val_optim_loss: 22846467.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9292; val_auprc_score: 0.9047; val_best_acc_score: 0.8643; val_best_f1_score: 0.8711; train_kl_reg_loss: 65475.9715; train_edge_recon_loss: 594116.0265; train_gene_expr_recon_loss: 19744460.0606; train_masked_gp_l1_reg_loss: 94909.2773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73156.1065; train_chrom_access_recon_loss: 2067912.9545; train_global_loss: 22640030.4545; train_optim_loss: 22640030.4545; val_kl_reg_loss: 64583.0034; val_edge_recon_loss: 598256.2109; val_gene_expr_recon_loss: 19976839.5000; val_masked_gp_l1_reg_loss: 95289.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72876.6016; val_chrom_access_recon_loss: 2066449.9219; val_global_loss: 22874294.5000; val_optim_loss: 22874294.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9356; val_auprc_score: 0.9221; val_best_acc_score: 0.8654; val_best_f1_score: 0.8715; train_kl_reg_loss: 65107.4700; train_edge_recon_loss: 591355.9659; train_gene_expr_recon_loss: 19694592.5758; train_masked_gp_l1_reg_loss: 95483.9266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71999.0879; train_chrom_access_recon_loss: 2062317.5038; train_global_loss: 22580856.6970; train_optim_loss: 22580856.6970; val_kl_reg_loss: 65307.1519; val_edge_recon_loss: 602092.7969; val_gene_expr_recon_loss: 20060706.5000; val_masked_gp_l1_reg_loss: 95839.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71927.6484; val_chrom_access_recon_loss: 2098558.8438; val_global_loss: 22994433.7500; val_optim_loss: 22994433.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9369; val_auprc_score: 0.9133; val_best_acc_score: 0.8748; val_best_f1_score: 0.8804; train_kl_reg_loss: 64594.3069; train_edge_recon_loss: 590543.6061; train_gene_expr_recon_loss: 19637142.6061; train_masked_gp_l1_reg_loss: 96070.2647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71411.6444; train_chrom_access_recon_loss: 2057524.3333; train_global_loss: 22517286.4545; train_optim_loss: 22517286.4545; val_kl_reg_loss: 64299.4639; val_edge_recon_loss: 596277.4688; val_gene_expr_recon_loss: 19903326.2500; val_masked_gp_l1_reg_loss: 96406.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71023.0625; val_chrom_access_recon_loss: 2064026.8281; val_global_loss: 22795360.0000; val_optim_loss: 22795360.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9430; val_auprc_score: 0.9298; val_best_acc_score: 0.8772; val_best_f1_score: 0.8820; train_kl_reg_loss: 64064.4547; train_edge_recon_loss: 589192.0492; train_gene_expr_recon_loss: 19581136.2727; train_masked_gp_l1_reg_loss: 96687.1718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70672.6700; train_chrom_access_recon_loss: 2051458.6818; train_global_loss: 22453211.5152; train_optim_loss: 22453211.5152; val_kl_reg_loss: 66016.7583; val_edge_recon_loss: 594142.6484; val_gene_expr_recon_loss: 19968928.2500; val_masked_gp_l1_reg_loss: 97073.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70893.6484; val_chrom_access_recon_loss: 2058785.4375; val_global_loss: 22855841.2500; val_optim_loss: 22855841.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9355; val_auprc_score: 0.9157; val_best_acc_score: 0.8702; val_best_f1_score: 0.8768; train_kl_reg_loss: 63587.4019; train_edge_recon_loss: 587297.2945; train_gene_expr_recon_loss: 19543017.1818; train_masked_gp_l1_reg_loss: 97315.5326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70430.6404; train_chrom_access_recon_loss: 2048428.4299; train_global_loss: 22410076.2121; train_optim_loss: 22410076.2121; val_kl_reg_loss: 64947.4580; val_edge_recon_loss: 594278.3203; val_gene_expr_recon_loss: 19815504.7500; val_masked_gp_l1_reg_loss: 97663.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69773.3125; val_chrom_access_recon_loss: 2054809.2031; val_global_loss: 22696977.7500; val_optim_loss: 22696977.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9424; val_auprc_score: 0.9257; val_best_acc_score: 0.8796; val_best_f1_score: 0.8862; train_kl_reg_loss: 63234.6243; train_edge_recon_loss: 588889.3845; train_gene_expr_recon_loss: 19483693.8485; train_masked_gp_l1_reg_loss: 97823.6359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69349.8461; train_chrom_access_recon_loss: 2041927.4110; train_global_loss: 22344918.8485; train_optim_loss: 22344918.8485; val_kl_reg_loss: 63040.3057; val_edge_recon_loss: 589663.4297; val_gene_expr_recon_loss: 19780973.2500; val_masked_gp_l1_reg_loss: 98340.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69462.9844; val_chrom_access_recon_loss: 2068800.7812; val_global_loss: 22670279.5000; val_optim_loss: 22670279.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9457; val_auprc_score: 0.9338; val_best_acc_score: 0.8826; val_best_f1_score: 0.8875; train_kl_reg_loss: 62183.2733; train_edge_recon_loss: 587400.0767; train_gene_expr_recon_loss: 19432076.1212; train_masked_gp_l1_reg_loss: 98503.5402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68934.1882; train_chrom_access_recon_loss: 2036698.5928; train_global_loss: 22285795.9697; train_optim_loss: 22285795.9697; val_kl_reg_loss: 63206.6968; val_edge_recon_loss: 590290.3984; val_gene_expr_recon_loss: 19730981.7500; val_masked_gp_l1_reg_loss: 98849.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68469.2891; val_chrom_access_recon_loss: 2052117.7344; val_global_loss: 22603916.5000; val_optim_loss: 22603916.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9425; val_auprc_score: 0.9210; val_best_acc_score: 0.8845; val_best_f1_score: 0.8904; train_kl_reg_loss: 62289.6193; train_edge_recon_loss: 584150.4792; train_gene_expr_recon_loss: 19407848.9091; train_masked_gp_l1_reg_loss: 98964.9870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68049.5471; train_chrom_access_recon_loss: 2034308.9697; train_global_loss: 22255612.4545; train_optim_loss: 22255612.4545; val_kl_reg_loss: 63012.9448; val_edge_recon_loss: 588043.4453; val_gene_expr_recon_loss: 19707350.5000; val_masked_gp_l1_reg_loss: 99287.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68207.6406; val_chrom_access_recon_loss: 2049350.1250; val_global_loss: 22575253.0000; val_optim_loss: 22575253.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9442; val_auprc_score: 0.9199; val_best_acc_score: 0.8850; val_best_f1_score: 0.8906; train_kl_reg_loss: 61772.6130; train_edge_recon_loss: 585450.7604; train_gene_expr_recon_loss: 19373715.0303; train_masked_gp_l1_reg_loss: 99495.0460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67745.4274; train_chrom_access_recon_loss: 2029300.2330; train_global_loss: 22217479.1515; train_optim_loss: 22217479.1515; val_kl_reg_loss: 60847.2510; val_edge_recon_loss: 587121.5938; val_gene_expr_recon_loss: 19631333.5000; val_masked_gp_l1_reg_loss: 99812.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66731.6562; val_chrom_access_recon_loss: 2054064.9062; val_global_loss: 22499911.5000; val_optim_loss: 22499911.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9360; val_auprc_score: 0.9144; val_best_acc_score: 0.8748; val_best_f1_score: 0.8816; train_kl_reg_loss: 61153.9787; train_edge_recon_loss: 584581.7064; train_gene_expr_recon_loss: 19346881.1212; train_masked_gp_l1_reg_loss: 100065.4787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66937.2359; train_chrom_access_recon_loss: 2027896.2367; train_global_loss: 22187515.7879; train_optim_loss: 22187515.7879; val_kl_reg_loss: 62296.7998; val_edge_recon_loss: 594039.4297; val_gene_expr_recon_loss: 19723425.7500; val_masked_gp_l1_reg_loss: 100279.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66441.3047; val_chrom_access_recon_loss: 2062269.9375; val_global_loss: 22608754.0000; val_optim_loss: 22608754.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9485; val_auprc_score: 0.9344; val_best_acc_score: 0.8909; val_best_f1_score: 0.8948; train_kl_reg_loss: 61150.4069; train_edge_recon_loss: 584406.5483; train_gene_expr_recon_loss: 19296566.0303; train_masked_gp_l1_reg_loss: 100660.2180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66265.9074; train_chrom_access_recon_loss: 2023305.5985; train_global_loss: 22132354.8182; train_optim_loss: 22132354.8182; val_kl_reg_loss: 61077.8779; val_edge_recon_loss: 584137.5781; val_gene_expr_recon_loss: 19566732.0000; val_masked_gp_l1_reg_loss: 101010.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66497.0391; val_chrom_access_recon_loss: 2037844.5156; val_global_loss: 22417300.5000; val_optim_loss: 22417300.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9454; val_auprc_score: 0.9259; val_best_acc_score: 0.8901; val_best_f1_score: 0.8935; train_kl_reg_loss: 60506.2820; train_edge_recon_loss: 583858.1004; train_gene_expr_recon_loss: 19268589.6667; train_masked_gp_l1_reg_loss: 101305.3866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66118.9731; train_chrom_access_recon_loss: 2019352.1023; train_global_loss: 22099730.5152; train_optim_loss: 22099730.5152; val_kl_reg_loss: 60382.4268; val_edge_recon_loss: 585744.3516; val_gene_expr_recon_loss: 19433206.2500; val_masked_gp_l1_reg_loss: 101740.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65729.8438; val_chrom_access_recon_loss: 2026783.7656; val_global_loss: 22273586.7500; val_optim_loss: 22273586.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9423; val_auprc_score: 0.9261; val_best_acc_score: 0.8864; val_best_f1_score: 0.8919; train_kl_reg_loss: 60300.9621; train_edge_recon_loss: 582049.7898; train_gene_expr_recon_loss: 19215223.0909; train_masked_gp_l1_reg_loss: 102032.1946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65556.3671; train_chrom_access_recon_loss: 2014876.3523; train_global_loss: 22040038.6364; train_optim_loss: 22040038.6364; val_kl_reg_loss: 60852.4468; val_edge_recon_loss: 590902.6094; val_gene_expr_recon_loss: 19611071.0000; val_masked_gp_l1_reg_loss: 102481.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65771.0781; val_chrom_access_recon_loss: 2034280.5781; val_global_loss: 22465360.5000; val_optim_loss: 22465360.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9481; val_auprc_score: 0.9287; val_best_acc_score: 0.8904; val_best_f1_score: 0.8961; train_kl_reg_loss: 59906.0691; train_edge_recon_loss: 581238.6951; train_gene_expr_recon_loss: 19188169.6364; train_masked_gp_l1_reg_loss: 102737.7649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65364.9248; train_chrom_access_recon_loss: 2011845.3030; train_global_loss: 22009262.3636; train_optim_loss: 22009262.3636; val_kl_reg_loss: 60900.7710; val_edge_recon_loss: 587816.3594; val_gene_expr_recon_loss: 19585382.2500; val_masked_gp_l1_reg_loss: 103158.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65205.2812; val_chrom_access_recon_loss: 2019482.5625; val_global_loss: 22421945.7500; val_optim_loss: 22421945.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9446; val_auprc_score: 0.9257; val_best_acc_score: 0.8869; val_best_f1_score: 0.8932; train_kl_reg_loss: 59734.5923; train_edge_recon_loss: 581346.2576; train_gene_expr_recon_loss: 19155591.5758; train_masked_gp_l1_reg_loss: 103503.7887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65076.8678; train_chrom_access_recon_loss: 2009340.4091; train_global_loss: 21974593.5152; train_optim_loss: 21974593.5152; val_kl_reg_loss: 59931.7393; val_edge_recon_loss: 586441.2422; val_gene_expr_recon_loss: 19365523.0000; val_masked_gp_l1_reg_loss: 103947.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64877.2852; val_chrom_access_recon_loss: 2012964.2812; val_global_loss: 22193686.2500; val_optim_loss: 22193686.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9478; val_auprc_score: 0.9310; val_best_acc_score: 0.8925; val_best_f1_score: 0.8984; train_kl_reg_loss: 59317.9031; train_edge_recon_loss: 579277.7121; train_gene_expr_recon_loss: 19117776.0000; train_masked_gp_l1_reg_loss: 104292.5404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64669.3002; train_chrom_access_recon_loss: 2004441.8883; train_global_loss: 21929775.2727; train_optim_loss: 21929775.2727; val_kl_reg_loss: 61158.3779; val_edge_recon_loss: 584374.8438; val_gene_expr_recon_loss: 19263361.5000; val_masked_gp_l1_reg_loss: 104668.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64449.9180; val_chrom_access_recon_loss: 1994358.1562; val_global_loss: 22072370.7500; val_optim_loss: 22072370.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9491; val_auprc_score: 0.9295; val_best_acc_score: 0.8958; val_best_f1_score: 0.9004; train_kl_reg_loss: 59178.6864; train_edge_recon_loss: 580129.3674; train_gene_expr_recon_loss: 19104804.9091; train_masked_gp_l1_reg_loss: 104940.2591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64466.2633; train_chrom_access_recon_loss: 2004537.9678; train_global_loss: 21918057.5152; train_optim_loss: 21918057.5152; val_kl_reg_loss: 60017.3013; val_edge_recon_loss: 584661.3047; val_gene_expr_recon_loss: 19289971.7500; val_masked_gp_l1_reg_loss: 105478.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64626.6992; val_chrom_access_recon_loss: 2016139.4062; val_global_loss: 22120893.2500; val_optim_loss: 22120893.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9480; val_auprc_score: 0.9284; val_best_acc_score: 0.8923; val_best_f1_score: 0.8957; train_kl_reg_loss: 58799.2404; train_edge_recon_loss: 579019.5407; train_gene_expr_recon_loss: 19064175.6667; train_masked_gp_l1_reg_loss: 105720.6204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64252.9228; train_chrom_access_recon_loss: 2000477.4205; train_global_loss: 21872445.5455; train_optim_loss: 21872445.5455; val_kl_reg_loss: 59500.2964; val_edge_recon_loss: 590466.5234; val_gene_expr_recon_loss: 19426916.7500; val_masked_gp_l1_reg_loss: 106262.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64648.6484; val_chrom_access_recon_loss: 2021444.1250; val_global_loss: 22269237.2500; val_optim_loss: 22269237.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9573; val_auprc_score: 0.9414; val_best_acc_score: 0.9046; val_best_f1_score: 0.9084; train_kl_reg_loss: 58788.7341; train_edge_recon_loss: 577774.5777; train_gene_expr_recon_loss: 19037944.3030; train_masked_gp_l1_reg_loss: 106643.4536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64306.2234; train_chrom_access_recon_loss: 1999430.5720; train_global_loss: 21844887.8788; train_optim_loss: 21844887.8788; val_kl_reg_loss: 58163.3315; val_edge_recon_loss: 580666.2109; val_gene_expr_recon_loss: 19324195.7500; val_masked_gp_l1_reg_loss: 106929.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64017.2227; val_chrom_access_recon_loss: 2009856.6094; val_global_loss: 22143829.5000; val_optim_loss: 22143829.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9530; val_auprc_score: 0.9402; val_best_acc_score: 0.8984; val_best_f1_score: 0.9032; train_kl_reg_loss: 58294.6992; train_edge_recon_loss: 579094.3106; train_gene_expr_recon_loss: 18981872.6364; train_masked_gp_l1_reg_loss: 107307.4671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64185.9327; train_chrom_access_recon_loss: 1993566.2841; train_global_loss: 21784321.2424; train_optim_loss: 21784321.2424; val_kl_reg_loss: 58982.6753; val_edge_recon_loss: 581417.0391; val_gene_expr_recon_loss: 19559391.5000; val_masked_gp_l1_reg_loss: 107784.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64146.4648; val_chrom_access_recon_loss: 2041812.0625; val_global_loss: 22413533.0000; val_optim_loss: 22413533.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9530; val_auprc_score: 0.9370; val_best_acc_score: 0.8995; val_best_f1_score: 0.9031; train_kl_reg_loss: 58136.0187; train_edge_recon_loss: 577330.6761; train_gene_expr_recon_loss: 18966031.3030; train_masked_gp_l1_reg_loss: 104525.2837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51178.7644; train_chrom_access_recon_loss: 1991555.2973; train_global_loss: 21748757.3030; train_optim_loss: 21748757.3030; val_kl_reg_loss: 59429.9170; val_edge_recon_loss: 584274.2656; val_gene_expr_recon_loss: 19359255.5000; val_masked_gp_l1_reg_loss: 103095.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47316.6602; val_chrom_access_recon_loss: 2005919.1094; val_global_loss: 22159290.7500; val_optim_loss: 22159290.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9506; val_auprc_score: 0.9310; val_best_acc_score: 0.8974; val_best_f1_score: 0.9020; train_kl_reg_loss: 58623.2963; train_edge_recon_loss: 576383.7216; train_gene_expr_recon_loss: 18954243.3333; train_masked_gp_l1_reg_loss: 102885.2442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46766.2288; train_chrom_access_recon_loss: 1989050.7311; train_global_loss: 21727952.4545; train_optim_loss: 21727952.4545; val_kl_reg_loss: 59652.5054; val_edge_recon_loss: 583132.4609; val_gene_expr_recon_loss: 19173768.0000; val_masked_gp_l1_reg_loss: 102757.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46331.8867; val_chrom_access_recon_loss: 2011565.9062; val_global_loss: 21977208.0000; val_optim_loss: 21977208.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9488; val_auprc_score: 0.9251; val_best_acc_score: 0.9003; val_best_f1_score: 0.9049; train_kl_reg_loss: 58808.7580; train_edge_recon_loss: 576138.0095; train_gene_expr_recon_loss: 18943472.8182; train_masked_gp_l1_reg_loss: 102721.9073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46104.5694; train_chrom_access_recon_loss: 1988855.5265; train_global_loss: 21716101.4242; train_optim_loss: 21716101.4242; val_kl_reg_loss: 59683.7368; val_edge_recon_loss: 578975.6797; val_gene_expr_recon_loss: 19316979.0000; val_masked_gp_l1_reg_loss: 102708.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45871.2617; val_chrom_access_recon_loss: 2005643.1875; val_global_loss: 22109862.0000; val_optim_loss: 22109862.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9496; val_auprc_score: 0.9326; val_best_acc_score: 0.8971; val_best_f1_score: 0.9020; train_kl_reg_loss: 58967.8200; train_edge_recon_loss: 578699.9811; train_gene_expr_recon_loss: 18930214.6061; train_masked_gp_l1_reg_loss: 102737.9128; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45719.0818; train_chrom_access_recon_loss: 1988051.9773; train_global_loss: 21704391.7576; train_optim_loss: 21704391.7576; val_kl_reg_loss: 59664.2148; val_edge_recon_loss: 581344.5391; val_gene_expr_recon_loss: 19285677.5000; val_masked_gp_l1_reg_loss: 102756.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45585.0781; val_chrom_access_recon_loss: 1995026.2344; val_global_loss: 22070054.2500; val_optim_loss: 22070054.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9565; val_auprc_score: 0.9439; val_best_acc_score: 0.9033; val_best_f1_score: 0.9074; train_kl_reg_loss: 59019.0981; train_edge_recon_loss: 575092.8068; train_gene_expr_recon_loss: 18928032.0303; train_masked_gp_l1_reg_loss: 102770.2950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45503.8982; train_chrom_access_recon_loss: 1989504.4470; train_global_loss: 21699922.5152; train_optim_loss: 21699922.5152; val_kl_reg_loss: 59987.7188; val_edge_recon_loss: 582941.3047; val_gene_expr_recon_loss: 19247993.2500; val_masked_gp_l1_reg_loss: 102811.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45373.7109; val_chrom_access_recon_loss: 2010553.2344; val_global_loss: 22049661.7500; val_optim_loss: 22049661.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9455; val_auprc_score: 0.9231; val_best_acc_score: 0.8939; val_best_f1_score: 0.8980; train_kl_reg_loss: 59107.6879; train_edge_recon_loss: 576145.1581; train_gene_expr_recon_loss: 18927860.7273; train_masked_gp_l1_reg_loss: 102841.1552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45280.0640; train_chrom_access_recon_loss: 1988247.4886; train_global_loss: 21699482.3333; train_optim_loss: 21699482.3333; val_kl_reg_loss: 60025.1392; val_edge_recon_loss: 586564.0938; val_gene_expr_recon_loss: 19193490.5000; val_masked_gp_l1_reg_loss: 102879.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45142.1875; val_chrom_access_recon_loss: 2004132.5312; val_global_loss: 21992233.7500; val_optim_loss: 21992233.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9464; val_auprc_score: 0.9296; val_best_acc_score: 0.8915; val_best_f1_score: 0.8958; train_kl_reg_loss: 59114.8810; train_edge_recon_loss: 576284.0303; train_gene_expr_recon_loss: 18937214.6970; train_masked_gp_l1_reg_loss: 102554.6173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43913.5182; train_chrom_access_recon_loss: 1989353.4716; train_global_loss: 21708435.1515; train_optim_loss: 21708435.1515; val_kl_reg_loss: 59682.2476; val_edge_recon_loss: 586376.8125; val_gene_expr_recon_loss: 19140867.0000; val_masked_gp_l1_reg_loss: 102378.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43561.0977; val_chrom_access_recon_loss: 1999710.7812; val_global_loss: 21932577.5000; val_optim_loss: 21932577.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9506; val_auprc_score: 0.9310; val_best_acc_score: 0.9027; val_best_f1_score: 0.9058; train_kl_reg_loss: 59193.7813; train_edge_recon_loss: 576641.7812; train_gene_expr_recon_loss: 18921105.0909; train_masked_gp_l1_reg_loss: 102334.3706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43505.4536; train_chrom_access_recon_loss: 1986275.9280; train_global_loss: 21689056.4242; train_optim_loss: 21689056.4242; val_kl_reg_loss: 60309.7764; val_edge_recon_loss: 580423.1953; val_gene_expr_recon_loss: 19249965.7500; val_masked_gp_l1_reg_loss: 102302.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43460.4414; val_chrom_access_recon_loss: 2004626.6875; val_global_loss: 22041088.0000; val_optim_loss: 22041088.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9482; val_auprc_score: 0.9258; val_best_acc_score: 0.9019; val_best_f1_score: 0.9060; train_kl_reg_loss: 59231.9790; train_edge_recon_loss: 576387.1013; train_gene_expr_recon_loss: 18911149.2121; train_masked_gp_l1_reg_loss: 102286.7425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43427.3176; train_chrom_access_recon_loss: 1987125.9186; train_global_loss: 21679608.4242; train_optim_loss: 21679608.4242; val_kl_reg_loss: 60405.1069; val_edge_recon_loss: 578904.8984; val_gene_expr_recon_loss: 19280014.5000; val_masked_gp_l1_reg_loss: 102274.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43397.9609; val_chrom_access_recon_loss: 2010742.7500; val_global_loss: 22075739.2500; val_optim_loss: 22075739.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9541; val_auprc_score: 0.9407; val_best_acc_score: 0.9003; val_best_f1_score: 0.9037; train_kl_reg_loss: 59228.8955; train_edge_recon_loss: 577149.8646; train_gene_expr_recon_loss: 18916051.1515; train_masked_gp_l1_reg_loss: 102272.1819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43376.8199; train_chrom_access_recon_loss: 1984726.0208; train_global_loss: 21682805.0606; train_optim_loss: 21682805.0606; val_kl_reg_loss: 60127.0049; val_edge_recon_loss: 581968.6875; val_gene_expr_recon_loss: 19231636.2500; val_masked_gp_l1_reg_loss: 102265.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43356.5430; val_chrom_access_recon_loss: 1995117.8281; val_global_loss: 22014472.2500; val_optim_loss: 22014472.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9565; val_auprc_score: 0.9455; val_best_acc_score: 0.9030; val_best_f1_score: 0.9061; train_kl_reg_loss: 59244.6077; train_edge_recon_loss: 577637.2424; train_gene_expr_recon_loss: 18938116.1212; train_masked_gp_l1_reg_loss: 102263.5597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43335.0465; train_chrom_access_recon_loss: 1990634.1136; train_global_loss: 21711230.4848; train_optim_loss: 21711230.4848; val_kl_reg_loss: 59999.8931; val_edge_recon_loss: 581246.9219; val_gene_expr_recon_loss: 19184291.2500; val_masked_gp_l1_reg_loss: 102262.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43315.1797; val_chrom_access_recon_loss: 2007659.7031; val_global_loss: 21978775.5000; val_optim_loss: 21978775.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9451; val_auprc_score: 0.9287; val_best_acc_score: 0.8925; val_best_f1_score: 0.8970; train_kl_reg_loss: 59216.1395; train_edge_recon_loss: 577777.8693; train_gene_expr_recon_loss: 18919891.5152; train_masked_gp_l1_reg_loss: 102229.3406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43191.5472; train_chrom_access_recon_loss: 1987097.0549; train_global_loss: 21689403.6061; train_optim_loss: 21689403.6061; val_kl_reg_loss: 60213.4658; val_edge_recon_loss: 585825.1328; val_gene_expr_recon_loss: 19154635.7500; val_masked_gp_l1_reg_loss: 102211.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43156.8242; val_chrom_access_recon_loss: 2007985.9375; val_global_loss: 21954028.5000; val_optim_loss: 21954028.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9473; val_auprc_score: 0.9320; val_best_acc_score: 0.8947; val_best_f1_score: 0.8988; train_kl_reg_loss: 59310.7059; train_edge_recon_loss: 577247.9706; train_gene_expr_recon_loss: 18913406.6970; train_masked_gp_l1_reg_loss: 102206.4100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43151.1201; train_chrom_access_recon_loss: 1987621.1572; train_global_loss: 21682943.9091; train_optim_loss: 21682943.9091; val_kl_reg_loss: 60535.6030; val_edge_recon_loss: 585004.7812; val_gene_expr_recon_loss: 19293740.5000; val_masked_gp_l1_reg_loss: 102202.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43146.5039; val_chrom_access_recon_loss: 2017601.7344; val_global_loss: 22102231.0000; val_optim_loss: 22102231.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9439; val_auprc_score: 0.9261; val_best_acc_score: 0.8928; val_best_f1_score: 0.8982; train_kl_reg_loss: 59264.1156; train_edge_recon_loss: 577038.4413; train_gene_expr_recon_loss: 18920080.9697; train_masked_gp_l1_reg_loss: 102200.4215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43143.5697; train_chrom_access_recon_loss: 1989231.8958; train_global_loss: 21690959.1515; train_optim_loss: 21690959.1515; val_kl_reg_loss: 60486.6670; val_edge_recon_loss: 589663.2969; val_gene_expr_recon_loss: 19241569.5000; val_masked_gp_l1_reg_loss: 102198.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43140.0859; val_chrom_access_recon_loss: 1995956.0000; val_global_loss: 22033013.7500; val_optim_loss: 22033013.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9473; val_auprc_score: 0.9293; val_best_acc_score: 0.8923; val_best_f1_score: 0.8973; train_kl_reg_loss: 59273.7153; train_edge_recon_loss: 577182.9271; train_gene_expr_recon_loss: 18910693.4545; train_masked_gp_l1_reg_loss: 102197.1596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43137.1704; train_chrom_access_recon_loss: 1986296.4394; train_global_loss: 21678781.0303; train_optim_loss: 21678781.0303; val_kl_reg_loss: 60370.2847; val_edge_recon_loss: 587433.6016; val_gene_expr_recon_loss: 19315871.0000; val_masked_gp_l1_reg_loss: 102196.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43134.1953; val_chrom_access_recon_loss: 2007556.3125; val_global_loss: 22116561.0000; val_optim_loss: 22116561.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 54 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9525
val AUPRC score: 0.9339
val best accuracy score: 0.8982
val best F1 score: 0.9028
val target rna MSE score: 1.1605
val source rna MSE score: 0.5710
val target atac MSE score: 0.3220
val source atac MSE score: 0.1327
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
