[True]
Run timestamp: 10102023_003247_86.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_86']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7563; val_auprc_score: 0.7869; val_best_acc_score: 0.5525; val_best_f1_score: 0.6843; train_kl_reg_loss: 64660.8098; train_edge_recon_loss: 3510789.0305; train_gene_expr_recon_loss: 13363230.7863; train_masked_gp_l1_reg_loss: 88118.3391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1951462.9714; train_chrom_access_recon_loss: 6759885.2328; train_global_loss: 25738147.1756; train_optim_loss: 25738147.1756; val_kl_reg_loss: 82474.3516; val_edge_recon_loss: 4061544.2333; val_gene_expr_recon_loss: 12725194.2667; val_masked_gp_l1_reg_loss: 77559.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 445997.1562; val_chrom_access_recon_loss: 6514087.4333; val_global_loss: 23906858.2667; val_optim_loss: 23906858.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8503; val_auprc_score: 0.8494; val_best_acc_score: 0.7586; val_best_f1_score: 0.7785; train_kl_reg_loss: 79846.0301; train_edge_recon_loss: 3489275.0802; train_gene_expr_recon_loss: 12560691.7099; train_masked_gp_l1_reg_loss: 77999.7188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233336.4697; train_chrom_access_recon_loss: 6485222.5916; train_global_loss: 22926371.4504; train_optim_loss: 22926371.4504; val_kl_reg_loss: 61578.0432; val_edge_recon_loss: 3636980.2500; val_gene_expr_recon_loss: 12609765.7333; val_masked_gp_l1_reg_loss: 81741.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136709.4062; val_chrom_access_recon_loss: 6458041.1333; val_global_loss: 22984815.3333; val_optim_loss: 22984815.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8802; val_auprc_score: 0.8753; val_best_acc_score: 0.7732; val_best_f1_score: 0.7954; train_kl_reg_loss: 85769.9015; train_edge_recon_loss: 3039477.7137; train_gene_expr_recon_loss: 12399185.1679; train_masked_gp_l1_reg_loss: 90766.3593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110268.0752; train_chrom_access_recon_loss: 6396102.6107; train_global_loss: 22121569.9084; train_optim_loss: 22121569.9084; val_kl_reg_loss: 94465.2609; val_edge_recon_loss: 2966248.7500; val_gene_expr_recon_loss: 12439540.8667; val_masked_gp_l1_reg_loss: 93389.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93669.3359; val_chrom_access_recon_loss: 6358245.0667; val_global_loss: 22045558.9333; val_optim_loss: 22045558.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9112; val_auprc_score: 0.9024; val_best_acc_score: 0.8301; val_best_f1_score: 0.8352; train_kl_reg_loss: 93801.2077; train_edge_recon_loss: 2926567.1737; train_gene_expr_recon_loss: 12244794.8550; train_masked_gp_l1_reg_loss: 94579.2990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84930.5580; train_chrom_access_recon_loss: 6326242.3015; train_global_loss: 21770915.4198; train_optim_loss: 21770915.4198; val_kl_reg_loss: 87899.4318; val_edge_recon_loss: 2887292.7500; val_gene_expr_recon_loss: 12294117.9333; val_masked_gp_l1_reg_loss: 95799.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78363.7188; val_chrom_access_recon_loss: 6313515.6000; val_global_loss: 21756989.8667; val_optim_loss: 21756989.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9237; val_auprc_score: 0.9093; val_best_acc_score: 0.8535; val_best_f1_score: 0.8627; train_kl_reg_loss: 90569.9745; train_edge_recon_loss: 2847305.3321; train_gene_expr_recon_loss: 12136279.2901; train_masked_gp_l1_reg_loss: 97221.0411; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75833.5083; train_chrom_access_recon_loss: 6279824.3511; train_global_loss: 21527033.6489; train_optim_loss: 21527033.6489; val_kl_reg_loss: 91042.8813; val_edge_recon_loss: 2848876.4333; val_gene_expr_recon_loss: 12203260.8667; val_masked_gp_l1_reg_loss: 98906.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73212.2734; val_chrom_access_recon_loss: 6271071.9333; val_global_loss: 21586370.6667; val_optim_loss: 21586370.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9291; val_auprc_score: 0.9134; val_best_acc_score: 0.8603; val_best_f1_score: 0.8694; train_kl_reg_loss: 92968.7306; train_edge_recon_loss: 2803746.1412; train_gene_expr_recon_loss: 12043640.1756; train_masked_gp_l1_reg_loss: 99597.7010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70757.4769; train_chrom_access_recon_loss: 6234390.8359; train_global_loss: 21345101.0229; train_optim_loss: 21345101.0229; val_kl_reg_loss: 94803.5318; val_edge_recon_loss: 2806351.1833; val_gene_expr_recon_loss: 12100248.2667; val_masked_gp_l1_reg_loss: 100657.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68994.3984; val_chrom_access_recon_loss: 6214789.3667; val_global_loss: 21385844.2667; val_optim_loss: 21385844.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9378; val_auprc_score: 0.9219; val_best_acc_score: 0.8752; val_best_f1_score: 0.8822; train_kl_reg_loss: 90117.9642; train_edge_recon_loss: 2786847.8569; train_gene_expr_recon_loss: 11967998.3130; train_masked_gp_l1_reg_loss: 101001.2096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67134.1777; train_chrom_access_recon_loss: 6195206.8702; train_global_loss: 21208306.4122; train_optim_loss: 21208306.4122; val_kl_reg_loss: 89701.2104; val_edge_recon_loss: 2782970.6667; val_gene_expr_recon_loss: 12086777.4667; val_masked_gp_l1_reg_loss: 101865.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66494.9922; val_chrom_access_recon_loss: 6197276.6667; val_global_loss: 21325087.0667; val_optim_loss: 21325087.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9405; val_auprc_score: 0.9279; val_best_acc_score: 0.8742; val_best_f1_score: 0.8821; train_kl_reg_loss: 87585.1388; train_edge_recon_loss: 2773066.7844; train_gene_expr_recon_loss: 11893235.1985; train_masked_gp_l1_reg_loss: 102173.9591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64650.2535; train_chrom_access_recon_loss: 6163104.8397; train_global_loss: 21083816.1985; train_optim_loss: 21083816.1985; val_kl_reg_loss: 85895.6031; val_edge_recon_loss: 2773653.2333; val_gene_expr_recon_loss: 11984316.0667; val_masked_gp_l1_reg_loss: 102789.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63633.1758; val_chrom_access_recon_loss: 6165116.5667; val_global_loss: 21175403.3333; val_optim_loss: 21175403.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9393; val_auprc_score: 0.9247; val_best_acc_score: 0.8812; val_best_f1_score: 0.8871; train_kl_reg_loss: 86654.6672; train_edge_recon_loss: 2746014.3779; train_gene_expr_recon_loss: 11821658.1069; train_masked_gp_l1_reg_loss: 103283.3617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62805.0035; train_chrom_access_recon_loss: 6124068.4885; train_global_loss: 20944484.0000; train_optim_loss: 20944484.0000; val_kl_reg_loss: 84024.4443; val_edge_recon_loss: 2766512.4167; val_gene_expr_recon_loss: 11900632.7333; val_masked_gp_l1_reg_loss: 103960.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62530.1602; val_chrom_access_recon_loss: 6114196.5000; val_global_loss: 21031856.0000; val_optim_loss: 21031856.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9427; val_auprc_score: 0.9282; val_best_acc_score: 0.8778; val_best_f1_score: 0.8840; train_kl_reg_loss: 84691.0384; train_edge_recon_loss: 2750903.8244; train_gene_expr_recon_loss: 11771839.5725; train_masked_gp_l1_reg_loss: 104087.4529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62281.3012; train_chrom_access_recon_loss: 6094924.4771; train_global_loss: 20868727.6947; train_optim_loss: 20868727.6947; val_kl_reg_loss: 83642.4021; val_edge_recon_loss: 2772673.5833; val_gene_expr_recon_loss: 11797774.2000; val_masked_gp_l1_reg_loss: 104657.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62609.1719; val_chrom_access_recon_loss: 6067775.9000; val_global_loss: 20889132.9333; val_optim_loss: 20889132.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9499; val_auprc_score: 0.9397; val_best_acc_score: 0.8874; val_best_f1_score: 0.8933; train_kl_reg_loss: 83945.2779; train_edge_recon_loss: 2734128.1966; train_gene_expr_recon_loss: 11707831.4809; train_masked_gp_l1_reg_loss: 104547.8007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62288.4802; train_chrom_access_recon_loss: 6056529.9847; train_global_loss: 20749271.1145; train_optim_loss: 20749271.1145; val_kl_reg_loss: 83582.0411; val_edge_recon_loss: 2739915.9500; val_gene_expr_recon_loss: 11777857.4000; val_masked_gp_l1_reg_loss: 105325.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63164.6797; val_chrom_access_recon_loss: 6024465.0667; val_global_loss: 20794311.7333; val_optim_loss: 20794311.7333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9598; val_auprc_score: 0.9500; val_best_acc_score: 0.9016; val_best_f1_score: 0.9060; train_kl_reg_loss: 82873.4643; train_edge_recon_loss: 2720696.3034; train_gene_expr_recon_loss: 11651065.5649; train_masked_gp_l1_reg_loss: 105277.5459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62752.9008; train_chrom_access_recon_loss: 6030015.4466; train_global_loss: 20652681.2824; train_optim_loss: 20652681.2824; val_kl_reg_loss: 83848.9693; val_edge_recon_loss: 2702565.1833; val_gene_expr_recon_loss: 11804898.4000; val_masked_gp_l1_reg_loss: 105735.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62679.7422; val_chrom_access_recon_loss: 6045802.0333; val_global_loss: 20805530.6667; val_optim_loss: 20805530.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9549; val_auprc_score: 0.9433; val_best_acc_score: 0.8948; val_best_f1_score: 0.8997; train_kl_reg_loss: 80402.5505; train_edge_recon_loss: 2722553.2309; train_gene_expr_recon_loss: 11622760.9924; train_masked_gp_l1_reg_loss: 105927.4748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62414.3545; train_chrom_access_recon_loss: 6013084.8206; train_global_loss: 20607143.4809; train_optim_loss: 20607143.4809; val_kl_reg_loss: 79560.5099; val_edge_recon_loss: 2748128.5833; val_gene_expr_recon_loss: 11707796.5333; val_masked_gp_l1_reg_loss: 106311.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62233.4414; val_chrom_access_recon_loss: 6007751.1667; val_global_loss: 20711781.7333; val_optim_loss: 20711781.7333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9601; val_auprc_score: 0.9501; val_best_acc_score: 0.9002; val_best_f1_score: 0.9038; train_kl_reg_loss: 79791.8412; train_edge_recon_loss: 2711853.3588; train_gene_expr_recon_loss: 11572242.4275; train_masked_gp_l1_reg_loss: 106492.9590; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62097.4554; train_chrom_access_recon_loss: 5981212.6908; train_global_loss: 20513690.6718; train_optim_loss: 20513690.6718; val_kl_reg_loss: 79300.3521; val_edge_recon_loss: 2737692.7500; val_gene_expr_recon_loss: 11634385.4667; val_masked_gp_l1_reg_loss: 106840.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61545.0391; val_chrom_access_recon_loss: 5965820.3333; val_global_loss: 20585583.8667; val_optim_loss: 20585583.8667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9586; val_auprc_score: 0.9479; val_best_acc_score: 0.9022; val_best_f1_score: 0.9050; train_kl_reg_loss: 80572.1678; train_edge_recon_loss: 2708214.8263; train_gene_expr_recon_loss: 11524082.2824; train_masked_gp_l1_reg_loss: 106800.3927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61267.9105; train_chrom_access_recon_loss: 5952169.4160; train_global_loss: 20433106.9924; train_optim_loss: 20433106.9924; val_kl_reg_loss: 81782.8542; val_edge_recon_loss: 2718554.2000; val_gene_expr_recon_loss: 11624199.3333; val_masked_gp_l1_reg_loss: 106796.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61387.3086; val_chrom_access_recon_loss: 5971159.3667; val_global_loss: 20563879.6000; val_optim_loss: 20563879.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9594; val_auprc_score: 0.9483; val_best_acc_score: 0.9000; val_best_f1_score: 0.9039; train_kl_reg_loss: 79277.4150; train_edge_recon_loss: 2707560.2786; train_gene_expr_recon_loss: 11508046.6794; train_masked_gp_l1_reg_loss: 106984.2226; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60991.7569; train_chrom_access_recon_loss: 5941481.7595; train_global_loss: 20404342.1527; train_optim_loss: 20404342.1527; val_kl_reg_loss: 81029.5115; val_edge_recon_loss: 2731546.1167; val_gene_expr_recon_loss: 11577239.2000; val_masked_gp_l1_reg_loss: 107496.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60955.8125; val_chrom_access_recon_loss: 5902606.0000; val_global_loss: 20460873.0667; val_optim_loss: 20460873.0667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9644; val_auprc_score: 0.9537; val_best_acc_score: 0.9138; val_best_f1_score: 0.9160; train_kl_reg_loss: 77759.0050; train_edge_recon_loss: 2701534.0802; train_gene_expr_recon_loss: 11476856.7328; train_masked_gp_l1_reg_loss: 107261.6991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60616.9676; train_chrom_access_recon_loss: 5925369.3550; train_global_loss: 20349397.8473; train_optim_loss: 20349397.8473; val_kl_reg_loss: 79328.6349; val_edge_recon_loss: 2688029.6500; val_gene_expr_recon_loss: 11552782.1333; val_masked_gp_l1_reg_loss: 107272.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60442.8828; val_chrom_access_recon_loss: 5919066.7000; val_global_loss: 20406923.2000; val_optim_loss: 20406923.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9632; val_auprc_score: 0.9505; val_best_acc_score: 0.9077; val_best_f1_score: 0.9116; train_kl_reg_loss: 77259.1839; train_edge_recon_loss: 2696772.1698; train_gene_expr_recon_loss: 11441061.5878; train_masked_gp_l1_reg_loss: 107371.0413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60227.1299; train_chrom_access_recon_loss: 5902057.9122; train_global_loss: 20284748.9924; train_optim_loss: 20284748.9924; val_kl_reg_loss: 79409.9880; val_edge_recon_loss: 2726615.8500; val_gene_expr_recon_loss: 11529696.5333; val_masked_gp_l1_reg_loss: 107420.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60233.6641; val_chrom_access_recon_loss: 5894213.8667; val_global_loss: 20397590.9333; val_optim_loss: 20397590.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9665; val_auprc_score: 0.9596; val_best_acc_score: 0.9132; val_best_f1_score: 0.9169; train_kl_reg_loss: 77702.2765; train_edge_recon_loss: 2700612.4733; train_gene_expr_recon_loss: 11426404.0382; train_masked_gp_l1_reg_loss: 107341.2330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59870.8965; train_chrom_access_recon_loss: 5886089.2481; train_global_loss: 20258020.0763; train_optim_loss: 20258020.0763; val_kl_reg_loss: 78976.7745; val_edge_recon_loss: 2710785.5333; val_gene_expr_recon_loss: 11560919.8000; val_masked_gp_l1_reg_loss: 107530.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59971.3984; val_chrom_access_recon_loss: 5922373.7333; val_global_loss: 20440556.8000; val_optim_loss: 20440556.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9692; val_auprc_score: 0.9629; val_best_acc_score: 0.9147; val_best_f1_score: 0.9183; train_kl_reg_loss: 76111.8824; train_edge_recon_loss: 2696986.6317; train_gene_expr_recon_loss: 11402947.4275; train_masked_gp_l1_reg_loss: 107519.7771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59711.5487; train_chrom_access_recon_loss: 5872429.3282; train_global_loss: 20215706.4275; train_optim_loss: 20215706.4275; val_kl_reg_loss: 76992.2214; val_edge_recon_loss: 2700839.6167; val_gene_expr_recon_loss: 11510355.7333; val_masked_gp_l1_reg_loss: 107556.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59343.8242; val_chrom_access_recon_loss: 5854602.6000; val_global_loss: 20309690.2667; val_optim_loss: 20309690.2667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9677; val_auprc_score: 0.9570; val_best_acc_score: 0.9158; val_best_f1_score: 0.9187; train_kl_reg_loss: 76273.2357; train_edge_recon_loss: 2693553.3149; train_gene_expr_recon_loss: 11384966.5954; train_masked_gp_l1_reg_loss: 107489.3028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59511.6715; train_chrom_access_recon_loss: 5864609.7977; train_global_loss: 20186403.9847; train_optim_loss: 20186403.9847; val_kl_reg_loss: 78299.1438; val_edge_recon_loss: 2712108.3667; val_gene_expr_recon_loss: 11455668.2667; val_masked_gp_l1_reg_loss: 107539.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59337.0117; val_chrom_access_recon_loss: 5838199.0667; val_global_loss: 20251151.0667; val_optim_loss: 20251151.0667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9691; val_auprc_score: 0.9605; val_best_acc_score: 0.9174; val_best_f1_score: 0.9204; train_kl_reg_loss: 77291.5219; train_edge_recon_loss: 2685771.0477; train_gene_expr_recon_loss: 11365765.2290; train_masked_gp_l1_reg_loss: 107308.0428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59231.7094; train_chrom_access_recon_loss: 5847395.1641; train_global_loss: 20142762.6412; train_optim_loss: 20142762.6412; val_kl_reg_loss: 79107.3583; val_edge_recon_loss: 2709061.7833; val_gene_expr_recon_loss: 11470765.0667; val_masked_gp_l1_reg_loss: 107340.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59714.2227; val_chrom_access_recon_loss: 5869783.7333; val_global_loss: 20295772.8000; val_optim_loss: 20295772.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9729; val_auprc_score: 0.9669; val_best_acc_score: 0.9237; val_best_f1_score: 0.9270; train_kl_reg_loss: 76514.5020; train_edge_recon_loss: 2689923.8130; train_gene_expr_recon_loss: 11354915.2137; train_masked_gp_l1_reg_loss: 107234.0578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59232.0054; train_chrom_access_recon_loss: 5830498.7290; train_global_loss: 20118318.3206; train_optim_loss: 20118318.3206; val_kl_reg_loss: 76336.2969; val_edge_recon_loss: 2692292.6167; val_gene_expr_recon_loss: 11448175.7333; val_masked_gp_l1_reg_loss: 107235.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58990.1367; val_chrom_access_recon_loss: 5827933.2667; val_global_loss: 20210964.0000; val_optim_loss: 20210964.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9731; val_auprc_score: 0.9656; val_best_acc_score: 0.9213; val_best_f1_score: 0.9246; train_kl_reg_loss: 75904.3662; train_edge_recon_loss: 2693143.1870; train_gene_expr_recon_loss: 11333193.5267; train_masked_gp_l1_reg_loss: 107117.6598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59188.2578; train_chrom_access_recon_loss: 5813984.5611; train_global_loss: 20082531.5420; train_optim_loss: 20082531.5420; val_kl_reg_loss: 74056.5844; val_edge_recon_loss: 2687916.5333; val_gene_expr_recon_loss: 11434682.8667; val_masked_gp_l1_reg_loss: 107259.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59861.6562; val_chrom_access_recon_loss: 5811131.9667; val_global_loss: 20174910.0000; val_optim_loss: 20174910.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9736; val_auprc_score: 0.9674; val_best_acc_score: 0.9235; val_best_f1_score: 0.9259; train_kl_reg_loss: 74580.9191; train_edge_recon_loss: 2697024.0324; train_gene_expr_recon_loss: 11323747.9084; train_masked_gp_l1_reg_loss: 107122.2143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59414.9327; train_chrom_access_recon_loss: 5803001.7863; train_global_loss: 20064891.7710; train_optim_loss: 20064891.7710; val_kl_reg_loss: 74483.8922; val_edge_recon_loss: 2676918.1833; val_gene_expr_recon_loss: 11449924.4000; val_masked_gp_l1_reg_loss: 106926.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59580.3125; val_chrom_access_recon_loss: 5806984.7667; val_global_loss: 20174818.1333; val_optim_loss: 20174818.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9732; val_auprc_score: 0.9664; val_best_acc_score: 0.9229; val_best_f1_score: 0.9260; train_kl_reg_loss: 75784.2433; train_edge_recon_loss: 2688850.5534; train_gene_expr_recon_loss: 11299433.3130; train_masked_gp_l1_reg_loss: 106950.5194; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59353.7963; train_chrom_access_recon_loss: 5788677.8893; train_global_loss: 20019050.3206; train_optim_loss: 20019050.3206; val_kl_reg_loss: 76844.3370; val_edge_recon_loss: 2689543.3833; val_gene_expr_recon_loss: 11375499.0667; val_masked_gp_l1_reg_loss: 106679.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59414.1523; val_chrom_access_recon_loss: 5778064.3000; val_global_loss: 20086044.1333; val_optim_loss: 20086044.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9744; val_auprc_score: 0.9695; val_best_acc_score: 0.9229; val_best_f1_score: 0.9260; train_kl_reg_loss: 75674.9348; train_edge_recon_loss: 2683568.8912; train_gene_expr_recon_loss: 11291641.7634; train_masked_gp_l1_reg_loss: 106579.6718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59382.6742; train_chrom_access_recon_loss: 5777314.6183; train_global_loss: 19994162.5802; train_optim_loss: 19994162.5802; val_kl_reg_loss: 75497.2401; val_edge_recon_loss: 2703568.2167; val_gene_expr_recon_loss: 11434842.9333; val_masked_gp_l1_reg_loss: 106689.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59985.6719; val_chrom_access_recon_loss: 5839522.8000; val_global_loss: 20220107.2000; val_optim_loss: 20220107.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9772; val_auprc_score: 0.9681; val_best_acc_score: 0.9305; val_best_f1_score: 0.9322; train_kl_reg_loss: 74104.6784; train_edge_recon_loss: 2684133.9370; train_gene_expr_recon_loss: 11283060.2977; train_masked_gp_l1_reg_loss: 106512.4530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59664.9727; train_chrom_access_recon_loss: 5770841.2595; train_global_loss: 19978317.5725; train_optim_loss: 19978317.5725; val_kl_reg_loss: 74910.4094; val_edge_recon_loss: 2671422.6167; val_gene_expr_recon_loss: 11418152.6667; val_masked_gp_l1_reg_loss: 106438.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59895.7031; val_chrom_access_recon_loss: 5805884.1667; val_global_loss: 20136704.8000; val_optim_loss: 20136704.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9733; val_auprc_score: 0.9659; val_best_acc_score: 0.9236; val_best_f1_score: 0.9264; train_kl_reg_loss: 73900.0271; train_edge_recon_loss: 2680168.5973; train_gene_expr_recon_loss: 11264115.7710; train_masked_gp_l1_reg_loss: 106331.1922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59823.6046; train_chrom_access_recon_loss: 5761901.0458; train_global_loss: 19946240.1374; train_optim_loss: 19946240.1374; val_kl_reg_loss: 75587.3557; val_edge_recon_loss: 2697981.0167; val_gene_expr_recon_loss: 11400235.5333; val_masked_gp_l1_reg_loss: 106146.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59689.8789; val_chrom_access_recon_loss: 5775191.2667; val_global_loss: 20114831.0667; val_optim_loss: 20114831.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9772; val_auprc_score: 0.9698; val_best_acc_score: 0.9325; val_best_f1_score: 0.9353; train_kl_reg_loss: 73636.3873; train_edge_recon_loss: 2678973.6527; train_gene_expr_recon_loss: 11259545.4122; train_masked_gp_l1_reg_loss: 105991.4773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59997.9314; train_chrom_access_recon_loss: 5748852.4847; train_global_loss: 19926997.3740; train_optim_loss: 19926997.3740; val_kl_reg_loss: 73915.4911; val_edge_recon_loss: 2685500.6500; val_gene_expr_recon_loss: 11354328.4000; val_masked_gp_l1_reg_loss: 105847.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60229.4570; val_chrom_access_recon_loss: 5745059.8667; val_global_loss: 20024881.8667; val_optim_loss: 20024881.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9763; val_auprc_score: 0.9688; val_best_acc_score: 0.9275; val_best_f1_score: 0.9297; train_kl_reg_loss: 72882.7529; train_edge_recon_loss: 2679851.6298; train_gene_expr_recon_loss: 11249678.2137; train_masked_gp_l1_reg_loss: 105706.3305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60153.5808; train_chrom_access_recon_loss: 5737676.5038; train_global_loss: 19905948.9313; train_optim_loss: 19905948.9313; val_kl_reg_loss: 70935.8073; val_edge_recon_loss: 2702126.7167; val_gene_expr_recon_loss: 11328738.4000; val_masked_gp_l1_reg_loss: 105486.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60655.4297; val_chrom_access_recon_loss: 5764836.0000; val_global_loss: 20032777.8667; val_optim_loss: 20032777.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9790; val_auprc_score: 0.9730; val_best_acc_score: 0.9324; val_best_f1_score: 0.9345; train_kl_reg_loss: 73118.8885; train_edge_recon_loss: 2679788.4542; train_gene_expr_recon_loss: 11245085.2137; train_masked_gp_l1_reg_loss: 105404.7421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60441.1187; train_chrom_access_recon_loss: 5734525.0763; train_global_loss: 19898363.4504; train_optim_loss: 19898363.4504; val_kl_reg_loss: 74603.0427; val_edge_recon_loss: 2668733.6500; val_gene_expr_recon_loss: 11312130.6667; val_masked_gp_l1_reg_loss: 105197.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60690.5078; val_chrom_access_recon_loss: 5745454.1667; val_global_loss: 19966809.7333; val_optim_loss: 19966809.7333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9793; val_auprc_score: 0.9749; val_best_acc_score: 0.9345; val_best_f1_score: 0.9358; train_kl_reg_loss: 72827.2034; train_edge_recon_loss: 2678599.6546; train_gene_expr_recon_loss: 11228235.1679; train_masked_gp_l1_reg_loss: 104967.9231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60622.6093; train_chrom_access_recon_loss: 5727671.1947; train_global_loss: 19872923.7710; train_optim_loss: 19872923.7710; val_kl_reg_loss: 74101.5464; val_edge_recon_loss: 2691968.3667; val_gene_expr_recon_loss: 11355527.8000; val_masked_gp_l1_reg_loss: 105204.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61164.7734; val_chrom_access_recon_loss: 5742009.6333; val_global_loss: 20029977.3333; val_optim_loss: 20029977.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9804; val_auprc_score: 0.9760; val_best_acc_score: 0.9352; val_best_f1_score: 0.9365; train_kl_reg_loss: 72117.8485; train_edge_recon_loss: 2679988.2290; train_gene_expr_recon_loss: 11231156.8779; train_masked_gp_l1_reg_loss: 104815.7880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61201.3565; train_chrom_access_recon_loss: 5721963.0000; train_global_loss: 19871243.1145; train_optim_loss: 19871243.1145; val_kl_reg_loss: 73334.2812; val_edge_recon_loss: 2697987.1833; val_gene_expr_recon_loss: 11375763.3333; val_masked_gp_l1_reg_loss: 104932.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61629.6562; val_chrom_access_recon_loss: 5753086.9667; val_global_loss: 20066733.7333; val_optim_loss: 20066733.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9798; val_auprc_score: 0.9722; val_best_acc_score: 0.9390; val_best_f1_score: 0.9407; train_kl_reg_loss: 72316.9901; train_edge_recon_loss: 2672543.3225; train_gene_expr_recon_loss: 11206159.4122; train_masked_gp_l1_reg_loss: 104645.6663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61370.3756; train_chrom_access_recon_loss: 5697854.5038; train_global_loss: 19814890.3206; train_optim_loss: 19814890.3206; val_kl_reg_loss: 72206.0234; val_edge_recon_loss: 2684306.6500; val_gene_expr_recon_loss: 11319788.4667; val_masked_gp_l1_reg_loss: 104548.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61876.0820; val_chrom_access_recon_loss: 5732140.4667; val_global_loss: 19974866.5333; val_optim_loss: 19974866.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9794; val_auprc_score: 0.9725; val_best_acc_score: 0.9347; val_best_f1_score: 0.9361; train_kl_reg_loss: 71608.5712; train_edge_recon_loss: 2669886.8893; train_gene_expr_recon_loss: 11200619.4656; train_masked_gp_l1_reg_loss: 104277.0471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61735.7349; train_chrom_access_recon_loss: 5698069.2863; train_global_loss: 19806197.0382; train_optim_loss: 19806197.0382; val_kl_reg_loss: 72654.1005; val_edge_recon_loss: 2682682.2333; val_gene_expr_recon_loss: 11334075.0667; val_masked_gp_l1_reg_loss: 104174.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61826.1992; val_chrom_access_recon_loss: 5736668.7000; val_global_loss: 19992080.8000; val_optim_loss: 19992080.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9797; val_auprc_score: 0.9752; val_best_acc_score: 0.9367; val_best_f1_score: 0.9382; train_kl_reg_loss: 73059.6083; train_edge_recon_loss: 2665824.8779; train_gene_expr_recon_loss: 11194641.3969; train_masked_gp_l1_reg_loss: 100054.0425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48845.7089; train_chrom_access_recon_loss: 5681987.1756; train_global_loss: 19764412.8092; train_optim_loss: 19764412.8092; val_kl_reg_loss: 74293.6687; val_edge_recon_loss: 2701308.9333; val_gene_expr_recon_loss: 11287727.2667; val_masked_gp_l1_reg_loss: 98974.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46954.1523; val_chrom_access_recon_loss: 5715812.3000; val_global_loss: 19925070.0000; val_optim_loss: 19925070.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9827; val_auprc_score: 0.9772; val_best_acc_score: 0.9427; val_best_f1_score: 0.9436; train_kl_reg_loss: 74260.6555; train_edge_recon_loss: 2668571.1622; train_gene_expr_recon_loss: 11184546.7557; train_masked_gp_l1_reg_loss: 98786.0479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46626.4954; train_chrom_access_recon_loss: 5675239.3969; train_global_loss: 19748030.5344; train_optim_loss: 19748030.5344; val_kl_reg_loss: 74906.5120; val_edge_recon_loss: 2667465.2500; val_gene_expr_recon_loss: 11336345.7333; val_masked_gp_l1_reg_loss: 98680.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46413.0703; val_chrom_access_recon_loss: 5721971.5000; val_global_loss: 19945781.7333; val_optim_loss: 19945781.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9842; val_auprc_score: 0.9820; val_best_acc_score: 0.9402; val_best_f1_score: 0.9417; train_kl_reg_loss: 75153.6642; train_edge_recon_loss: 2668039.6889; train_gene_expr_recon_loss: 11192488.9466; train_masked_gp_l1_reg_loss: 98607.5849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46189.2563; train_chrom_access_recon_loss: 5679790.9809; train_global_loss: 19760270.1527; train_optim_loss: 19760270.1527; val_kl_reg_loss: 76011.8474; val_edge_recon_loss: 2673412.3333; val_gene_expr_recon_loss: 11309573.7333; val_masked_gp_l1_reg_loss: 98565.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45993.7305; val_chrom_access_recon_loss: 5708783.1333; val_global_loss: 19912340.0000; val_optim_loss: 19912340.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9835; val_auprc_score: 0.9794; val_best_acc_score: 0.9438; val_best_f1_score: 0.9453; train_kl_reg_loss: 75812.6252; train_edge_recon_loss: 2663002.6718; train_gene_expr_recon_loss: 11185512.9313; train_masked_gp_l1_reg_loss: 98481.3192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45827.3720; train_chrom_access_recon_loss: 5676009.3588; train_global_loss: 19744646.3664; train_optim_loss: 19744646.3664; val_kl_reg_loss: 77312.2969; val_edge_recon_loss: 2672167.1667; val_gene_expr_recon_loss: 11313294.3333; val_masked_gp_l1_reg_loss: 98466.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45671.4492; val_chrom_access_recon_loss: 5736648.9333; val_global_loss: 19943559.4667; val_optim_loss: 19943559.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9816; val_auprc_score: 0.9762; val_best_acc_score: 0.9431; val_best_f1_score: 0.9439; train_kl_reg_loss: 76353.6335; train_edge_recon_loss: 2668411.2863; train_gene_expr_recon_loss: 11177520.0840; train_masked_gp_l1_reg_loss: 98402.5597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45562.7781; train_chrom_access_recon_loss: 5668060.8435; train_global_loss: 19734311.0534; train_optim_loss: 19734311.0534; val_kl_reg_loss: 76728.6438; val_edge_recon_loss: 2666724.2500; val_gene_expr_recon_loss: 11287908.4000; val_masked_gp_l1_reg_loss: 98326.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45363.8320; val_chrom_access_recon_loss: 5712516.6000; val_global_loss: 19887568.9333; val_optim_loss: 19887568.9333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9826; val_auprc_score: 0.9775; val_best_acc_score: 0.9425; val_best_f1_score: 0.9439; train_kl_reg_loss: 75739.4742; train_edge_recon_loss: 2658347.3397; train_gene_expr_recon_loss: 11186803.5802; train_masked_gp_l1_reg_loss: 98284.4887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45275.8270; train_chrom_access_recon_loss: 5675243.9618; train_global_loss: 19739694.7176; train_optim_loss: 19739694.7176; val_kl_reg_loss: 76100.9250; val_edge_recon_loss: 2676261.1500; val_gene_expr_recon_loss: 11312966.7333; val_masked_gp_l1_reg_loss: 98272.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45240.0000; val_chrom_access_recon_loss: 5681628.5667; val_global_loss: 19890469.3333; val_optim_loss: 19890469.3333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9820; val_auprc_score: 0.9756; val_best_acc_score: 0.9423; val_best_f1_score: 0.9436; train_kl_reg_loss: 75645.3471; train_edge_recon_loss: 2667262.4981; train_gene_expr_recon_loss: 11187258.4962; train_masked_gp_l1_reg_loss: 98248.8826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45129.7622; train_chrom_access_recon_loss: 5673294.5992; train_global_loss: 19746839.6336; train_optim_loss: 19746839.6336; val_kl_reg_loss: 76159.9302; val_edge_recon_loss: 2672205.2667; val_gene_expr_recon_loss: 11330172.5333; val_masked_gp_l1_reg_loss: 98205.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44969.2656; val_chrom_access_recon_loss: 5740254.4000; val_global_loss: 19961967.2000; val_optim_loss: 19961967.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9833; val_auprc_score: 0.9793; val_best_acc_score: 0.9454; val_best_f1_score: 0.9468; train_kl_reg_loss: 75618.2608; train_edge_recon_loss: 2674276.9809; train_gene_expr_recon_loss: 11179895.7481; train_masked_gp_l1_reg_loss: 98151.7001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44862.7450; train_chrom_access_recon_loss: 5669753.2328; train_global_loss: 19742558.6260; train_optim_loss: 19742558.6260; val_kl_reg_loss: 76114.0641; val_edge_recon_loss: 2660672.9167; val_gene_expr_recon_loss: 11339725.6000; val_masked_gp_l1_reg_loss: 98119.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44758.2930; val_chrom_access_recon_loss: 5727053.5000; val_global_loss: 19946443.0667; val_optim_loss: 19946443.0667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9813; val_auprc_score: 0.9772; val_best_acc_score: 0.9423; val_best_f1_score: 0.9435; train_kl_reg_loss: 75353.0569; train_edge_recon_loss: 2667116.2939; train_gene_expr_recon_loss: 11188654.5954; train_masked_gp_l1_reg_loss: 98086.3151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44679.6581; train_chrom_access_recon_loss: 5674860.0420; train_global_loss: 19748750.0000; train_optim_loss: 19748750.0000; val_kl_reg_loss: 76090.7766; val_edge_recon_loss: 2679288.8000; val_gene_expr_recon_loss: 11260695.2667; val_masked_gp_l1_reg_loss: 98054.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44596.5039; val_chrom_access_recon_loss: 5698700.4000; val_global_loss: 19857427.2000; val_optim_loss: 19857427.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9842; val_auprc_score: 0.9796; val_best_acc_score: 0.9481; val_best_f1_score: 0.9489; train_kl_reg_loss: 75529.9479; train_edge_recon_loss: 2664551.0439; train_gene_expr_recon_loss: 11178109.3664; train_masked_gp_l1_reg_loss: 98009.6329; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44513.0919; train_chrom_access_recon_loss: 5667724.7366; train_global_loss: 19728437.7099; train_optim_loss: 19728437.7099; val_kl_reg_loss: 76481.9229; val_edge_recon_loss: 2669943.7833; val_gene_expr_recon_loss: 11317731.4000; val_masked_gp_l1_reg_loss: 97985.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44403.8164; val_chrom_access_recon_loss: 5740222.9000; val_global_loss: 19946769.2000; val_optim_loss: 19946769.2000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9798; val_auprc_score: 0.9729; val_best_acc_score: 0.9396; val_best_f1_score: 0.9409; train_kl_reg_loss: 75566.7060; train_edge_recon_loss: 2666356.0897; train_gene_expr_recon_loss: 11176255.7863; train_masked_gp_l1_reg_loss: 97959.9089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44317.6053; train_chrom_access_recon_loss: 5668648.0763; train_global_loss: 19729104.0458; train_optim_loss: 19729104.0458; val_kl_reg_loss: 75742.8932; val_edge_recon_loss: 2681117.7667; val_gene_expr_recon_loss: 11307413.2000; val_masked_gp_l1_reg_loss: 97939.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44293.8477; val_chrom_access_recon_loss: 5696972.7000; val_global_loss: 19903479.7333; val_optim_loss: 19903479.7333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9806; val_auprc_score: 0.9760; val_best_acc_score: 0.9394; val_best_f1_score: 0.9412; train_kl_reg_loss: 75235.5858; train_edge_recon_loss: 2667553.8588; train_gene_expr_recon_loss: 11179698.5802; train_masked_gp_l1_reg_loss: 97903.4568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44194.6833; train_chrom_access_recon_loss: 5666608.2176; train_global_loss: 19731194.4275; train_optim_loss: 19731194.4275; val_kl_reg_loss: 76298.2115; val_edge_recon_loss: 2677980.0833; val_gene_expr_recon_loss: 11292331.2000; val_masked_gp_l1_reg_loss: 97841.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44075.9570; val_chrom_access_recon_loss: 5713852.7000; val_global_loss: 19902379.2000; val_optim_loss: 19902379.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9810; val_auprc_score: 0.9729; val_best_acc_score: 0.9390; val_best_f1_score: 0.9412; train_kl_reg_loss: 75654.2635; train_edge_recon_loss: 2661947.4218; train_gene_expr_recon_loss: 11175565.1603; train_masked_gp_l1_reg_loss: 97805.7040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43974.3082; train_chrom_access_recon_loss: 5668874.9275; train_global_loss: 19723821.8626; train_optim_loss: 19723821.8626; val_kl_reg_loss: 76568.7505; val_edge_recon_loss: 2696314.5667; val_gene_expr_recon_loss: 11284631.6667; val_masked_gp_l1_reg_loss: 97803.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43908.4297; val_chrom_access_recon_loss: 5706705.7667; val_global_loss: 19905932.0000; val_optim_loss: 19905932.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9819; val_auprc_score: 0.9756; val_best_acc_score: 0.9430; val_best_f1_score: 0.9446; train_kl_reg_loss: 76130.5402; train_edge_recon_loss: 2666046.5019; train_gene_expr_recon_loss: 11167692.4733; train_masked_gp_l1_reg_loss: 97341.9966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42581.6662; train_chrom_access_recon_loss: 5655439.6260; train_global_loss: 19705232.7481; train_optim_loss: 19705232.7481; val_kl_reg_loss: 76247.4214; val_edge_recon_loss: 2674085.3167; val_gene_expr_recon_loss: 11287382.1333; val_masked_gp_l1_reg_loss: 97181.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42386.1602; val_chrom_access_recon_loss: 5709190.1667; val_global_loss: 19886472.0000; val_optim_loss: 19886472.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9820; val_auprc_score: 0.9764; val_best_acc_score: 0.9413; val_best_f1_score: 0.9430; train_kl_reg_loss: 75919.9617; train_edge_recon_loss: 2665328.0954; train_gene_expr_recon_loss: 11173633.9618; train_masked_gp_l1_reg_loss: 97143.9801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42340.9463; train_chrom_access_recon_loss: 5664793.6603; train_global_loss: 19719160.5344; train_optim_loss: 19719160.5344; val_kl_reg_loss: 76957.9703; val_edge_recon_loss: 2697128.0667; val_gene_expr_recon_loss: 11317775.8667; val_masked_gp_l1_reg_loss: 97112.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42306.8906; val_chrom_access_recon_loss: 5706997.5667; val_global_loss: 19938279.8667; val_optim_loss: 19938279.8667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9818; val_auprc_score: 0.9783; val_best_acc_score: 0.9367; val_best_f1_score: 0.9385; train_kl_reg_loss: 75876.8223; train_edge_recon_loss: 2666964.0954; train_gene_expr_recon_loss: 11174098.5191; train_masked_gp_l1_reg_loss: 97097.0785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42281.6975; train_chrom_access_recon_loss: 5660208.5153; train_global_loss: 19716526.8092; train_optim_loss: 19716526.8092; val_kl_reg_loss: 77013.7656; val_edge_recon_loss: 2703610.6667; val_gene_expr_recon_loss: 11323079.2000; val_masked_gp_l1_reg_loss: 97088.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42257.4648; val_chrom_access_recon_loss: 5743865.6667; val_global_loss: 19986914.5333; val_optim_loss: 19986914.5333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9836; val_auprc_score: 0.9803; val_best_acc_score: 0.9426; val_best_f1_score: 0.9442; train_kl_reg_loss: 75748.0590; train_edge_recon_loss: 2662695.1088; train_gene_expr_recon_loss: 11169410.8473; train_masked_gp_l1_reg_loss: 97075.9321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42236.0019; train_chrom_access_recon_loss: 5661441.3397; train_global_loss: 19708607.3130; train_optim_loss: 19708607.3130; val_kl_reg_loss: 76263.0385; val_edge_recon_loss: 2669885.3000; val_gene_expr_recon_loss: 11265237.4667; val_masked_gp_l1_reg_loss: 97064.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42218.7422; val_chrom_access_recon_loss: 5691903.9333; val_global_loss: 19842573.8667; val_optim_loss: 19842573.8667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9849; val_auprc_score: 0.9815; val_best_acc_score: 0.9456; val_best_f1_score: 0.9469; train_kl_reg_loss: 75786.2421; train_edge_recon_loss: 2658321.0172; train_gene_expr_recon_loss: 11175124.7328; train_masked_gp_l1_reg_loss: 97058.8758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42200.1908; train_chrom_access_recon_loss: 5661767.0038; train_global_loss: 19710257.9542; train_optim_loss: 19710257.9542; val_kl_reg_loss: 76495.7224; val_edge_recon_loss: 2675836.5333; val_gene_expr_recon_loss: 11313978.4667; val_masked_gp_l1_reg_loss: 97049.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42180.6016; val_chrom_access_recon_loss: 5702915.6000; val_global_loss: 19908457.3333; val_optim_loss: 19908457.3333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9833; val_auprc_score: 0.9768; val_best_acc_score: 0.9446; val_best_f1_score: 0.9460; train_kl_reg_loss: 75815.6257; train_edge_recon_loss: 2668058.7805; train_gene_expr_recon_loss: 11171251.1756; train_masked_gp_l1_reg_loss: 97042.3699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42164.0099; train_chrom_access_recon_loss: 5664025.4313; train_global_loss: 19718357.4962; train_optim_loss: 19718357.4962; val_kl_reg_loss: 76421.5958; val_edge_recon_loss: 2662048.5500; val_gene_expr_recon_loss: 11274186.5333; val_masked_gp_l1_reg_loss: 97037.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42153.4453; val_chrom_access_recon_loss: 5716053.9000; val_global_loss: 19867901.6000; val_optim_loss: 19867901.6000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9830; val_auprc_score: 0.9779; val_best_acc_score: 0.9458; val_best_f1_score: 0.9465; train_kl_reg_loss: 75822.0582; train_edge_recon_loss: 2665886.3282; train_gene_expr_recon_loss: 11171738.5496; train_masked_gp_l1_reg_loss: 97032.8154; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42136.2807; train_chrom_access_recon_loss: 5659844.1756; train_global_loss: 19712460.1679; train_optim_loss: 19712460.1679; val_kl_reg_loss: 76323.4396; val_edge_recon_loss: 2664102.8333; val_gene_expr_recon_loss: 11316625.2667; val_masked_gp_l1_reg_loss: 97028.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42128.6914; val_chrom_access_recon_loss: 5731426.0000; val_global_loss: 19927635.4667; val_optim_loss: 19927635.4667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9823; val_auprc_score: 0.9761; val_best_acc_score: 0.9427; val_best_f1_score: 0.9447; train_kl_reg_loss: 75888.1767; train_edge_recon_loss: 2666113.3187; train_gene_expr_recon_loss: 11176030.5725; train_masked_gp_l1_reg_loss: 97022.9709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42113.0330; train_chrom_access_recon_loss: 5665105.1565; train_global_loss: 19722273.1603; train_optim_loss: 19722273.1603; val_kl_reg_loss: 76366.8578; val_edge_recon_loss: 2672255.6000; val_gene_expr_recon_loss: 11274164.4667; val_masked_gp_l1_reg_loss: 97015.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42101.1562; val_chrom_access_recon_loss: 5708740.7000; val_global_loss: 19870644.6667; val_optim_loss: 19870644.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9804; val_auprc_score: 0.9739; val_best_acc_score: 0.9417; val_best_f1_score: 0.9432; train_kl_reg_loss: 75778.7804; train_edge_recon_loss: 2667913.4828; train_gene_expr_recon_loss: 11166057.4733; train_masked_gp_l1_reg_loss: 96970.4526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41969.4871; train_chrom_access_recon_loss: 5655511.5954; train_global_loss: 19704201.3130; train_optim_loss: 19704201.3130; val_kl_reg_loss: 76481.0135; val_edge_recon_loss: 2672044.5167; val_gene_expr_recon_loss: 11280578.8667; val_masked_gp_l1_reg_loss: 96954.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41951.1250; val_chrom_access_recon_loss: 5739208.5333; val_global_loss: 19907218.9333; val_optim_loss: 19907218.9333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9828; val_auprc_score: 0.9763; val_best_acc_score: 0.9434; val_best_f1_score: 0.9450; train_kl_reg_loss: 75677.6466; train_edge_recon_loss: 2666598.4962; train_gene_expr_recon_loss: 11166829.7481; train_masked_gp_l1_reg_loss: 96950.4485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41947.1984; train_chrom_access_recon_loss: 5657108.6832; train_global_loss: 19705112.3206; train_optim_loss: 19705112.3206; val_kl_reg_loss: 76521.8687; val_edge_recon_loss: 2680739.7167; val_gene_expr_recon_loss: 11315034.2667; val_masked_gp_l1_reg_loss: 96946.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41943.3555; val_chrom_access_recon_loss: 5707847.4000; val_global_loss: 19919033.2000; val_optim_loss: 19919033.2000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9808; val_auprc_score: 0.9754; val_best_acc_score: 0.9413; val_best_f1_score: 0.9430; train_kl_reg_loss: 75584.8460; train_edge_recon_loss: 2664625.8092; train_gene_expr_recon_loss: 11169946.5191; train_masked_gp_l1_reg_loss: 96945.3002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41941.0056; train_chrom_access_recon_loss: 5659332.0916; train_global_loss: 19708375.4809; train_optim_loss: 19708375.4809; val_kl_reg_loss: 76110.8271; val_edge_recon_loss: 2685164.9167; val_gene_expr_recon_loss: 11280655.3333; val_masked_gp_l1_reg_loss: 96943.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41938.3594; val_chrom_access_recon_loss: 5698272.9333; val_global_loss: 19879085.3333; val_optim_loss: 19879085.3333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9843; val_auprc_score: 0.9786; val_best_acc_score: 0.9457; val_best_f1_score: 0.9471; train_kl_reg_loss: 75646.5826; train_edge_recon_loss: 2666468.6183; train_gene_expr_recon_loss: 11170131.6031; train_masked_gp_l1_reg_loss: 96942.0626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41936.1406; train_chrom_access_recon_loss: 5665043.7405; train_global_loss: 19716168.5344; train_optim_loss: 19716168.5344; val_kl_reg_loss: 75848.8990; val_edge_recon_loss: 2674920.9167; val_gene_expr_recon_loss: 11337451.4000; val_masked_gp_l1_reg_loss: 96940.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41933.9375; val_chrom_access_recon_loss: 5722890.6333; val_global_loss: 19949985.7333; val_optim_loss: 19949985.7333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 44 min 51 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9804
val AUPRC score: 0.9734
val best accuracy score: 0.9400
val best F1 score: 0.9419
val target rna MSE score: 1.2048
val source rna MSE score: 0.4544
val target atac MSE score: 0.3380
val source atac MSE score: 0.0955
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
