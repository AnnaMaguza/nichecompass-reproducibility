[True]
Run timestamp: 31012024_180648_23.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse', '--reference_batches', 'batch10', 'batch15', 'batch21', 'batch22', 'batch23', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'dataset', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '50', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '300.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_23']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch21...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch22...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch23...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 931, n_cat_covariates_embed_input: 0, n_hidden: 931, n_latent: 1412, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1412, n_addon_gp_input: 10, n_cat_covariates_embed_input: 50, n_output: 931
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1412, n_addon_gp_input: 10, n_cat_covariates_embed_input: 50, n_output: 931

--- INITIALIZING TRAINER ---
Number of training nodes: 115396
Number of validation nodes: 12822
Number of training edges: 529798
Number of validation edges: 58866
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9795; val_auprc_score: 0.9836; val_best_acc_score: 0.9387; val_best_f1_score: 0.9499; train_kl_reg_loss: 5289.4856; train_edge_recon_loss: 215267.5625; train_cat_covariates_contrastive_loss: 117.4155; train_gene_expr_recon_loss: 215417.0006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 436091.4641; train_optim_loss: 436091.4641; val_kl_reg_loss: 5405.1139; val_edge_recon_loss: 211495.1533; val_cat_covariates_contrastive_loss: 122.2103; val_gene_expr_recon_loss: 203747.5605; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 420770.0375; val_optim_loss: 420770.0375
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9861; val_auprc_score: 0.9884; val_best_acc_score: 0.9538; val_best_f1_score: 0.9621; train_kl_reg_loss: 5441.6289; train_edge_recon_loss: 208840.2533; train_cat_covariates_contrastive_loss: 131.6041; train_gene_expr_recon_loss: 198073.2932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 412486.7799; train_optim_loss: 412486.7799; val_kl_reg_loss: 5369.9094; val_edge_recon_loss: 211292.2541; val_cat_covariates_contrastive_loss: 131.1710; val_gene_expr_recon_loss: 193383.4606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 410176.7957; val_optim_loss: 410176.7957
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9884; val_auprc_score: 0.9906; val_best_acc_score: 0.9577; val_best_f1_score: 0.9653; train_kl_reg_loss: 5793.5221; train_edge_recon_loss: 209570.7193; train_cat_covariates_contrastive_loss: 136.9544; train_gene_expr_recon_loss: 186019.1436; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 401520.3394; train_optim_loss: 401520.3394; val_kl_reg_loss: 6058.5519; val_edge_recon_loss: 210643.1951; val_cat_covariates_contrastive_loss: 133.6325; val_gene_expr_recon_loss: 180369.5799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 397204.9592; val_optim_loss: 397204.9592
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9880; val_auprc_score: 0.9899; val_best_acc_score: 0.9580; val_best_f1_score: 0.9655; train_kl_reg_loss: 6280.9237; train_edge_recon_loss: 209406.1766; train_cat_covariates_contrastive_loss: 136.8454; train_gene_expr_recon_loss: 175104.8416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 390928.7870; train_optim_loss: 390928.7870; val_kl_reg_loss: 6430.2752; val_edge_recon_loss: 211558.8606; val_cat_covariates_contrastive_loss: 135.8927; val_gene_expr_recon_loss: 171898.6552; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 390023.6837; val_optim_loss: 390023.6837
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9884; val_auprc_score: 0.9900; val_best_acc_score: 0.9593; val_best_f1_score: 0.9665; train_kl_reg_loss: 6540.3150; train_edge_recon_loss: 209636.0819; train_cat_covariates_contrastive_loss: 136.8410; train_gene_expr_recon_loss: 168719.2699; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 385032.5075; train_optim_loss: 385032.5075; val_kl_reg_loss: 6823.6535; val_edge_recon_loss: 211513.7216; val_cat_covariates_contrastive_loss: 135.2607; val_gene_expr_recon_loss: 167008.1181; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 385480.7541; val_optim_loss: 385480.7541
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9897; val_auprc_score: 0.9913; val_best_acc_score: 0.9614; val_best_f1_score: 0.9681; train_kl_reg_loss: 6686.4409; train_edge_recon_loss: 209402.1855; train_cat_covariates_contrastive_loss: 137.4485; train_gene_expr_recon_loss: 164613.9291; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 380840.0043; train_optim_loss: 380840.0043; val_kl_reg_loss: 6870.4270; val_edge_recon_loss: 211186.6660; val_cat_covariates_contrastive_loss: 134.1649; val_gene_expr_recon_loss: 163498.2981; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 381689.5546; val_optim_loss: 381689.5546
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9904; val_auprc_score: 0.9922; val_best_acc_score: 0.9631; val_best_f1_score: 0.9696; train_kl_reg_loss: 6781.3011; train_edge_recon_loss: 209411.6483; train_cat_covariates_contrastive_loss: 137.8576; train_gene_expr_recon_loss: 162010.1951; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 378341.0020; train_optim_loss: 378341.0020; val_kl_reg_loss: 6866.0981; val_edge_recon_loss: 210733.7444; val_cat_covariates_contrastive_loss: 135.4073; val_gene_expr_recon_loss: 161591.3334; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 379326.5856; val_optim_loss: 379326.5856
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9899; val_auprc_score: 0.9914; val_best_acc_score: 0.9637; val_best_f1_score: 0.9702; train_kl_reg_loss: 6838.5222; train_edge_recon_loss: 209162.5686; train_cat_covariates_contrastive_loss: 137.8115; train_gene_expr_recon_loss: 160133.2438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 376272.1457; train_optim_loss: 376272.1457; val_kl_reg_loss: 6832.5633; val_edge_recon_loss: 210593.6553; val_cat_covariates_contrastive_loss: 136.2502; val_gene_expr_recon_loss: 159667.4448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 377229.9130; val_optim_loss: 377229.9130
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9905; val_auprc_score: 0.9920; val_best_acc_score: 0.9649; val_best_f1_score: 0.9711; train_kl_reg_loss: 6882.1045; train_edge_recon_loss: 208900.2768; train_cat_covariates_contrastive_loss: 137.7984; train_gene_expr_recon_loss: 158517.1494; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 374437.3288; train_optim_loss: 374437.3288; val_kl_reg_loss: 6972.2458; val_edge_recon_loss: 210988.1043; val_cat_covariates_contrastive_loss: 137.5755; val_gene_expr_recon_loss: 158606.7333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376704.6587; val_optim_loss: 376704.6587
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9909; val_auprc_score: 0.9925; val_best_acc_score: 0.9656; val_best_f1_score: 0.9717; train_kl_reg_loss: 6924.7407; train_edge_recon_loss: 208862.2641; train_cat_covariates_contrastive_loss: 137.9165; train_gene_expr_recon_loss: 157309.9600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373234.8812; train_optim_loss: 373234.8812; val_kl_reg_loss: 7000.7514; val_edge_recon_loss: 210235.5719; val_cat_covariates_contrastive_loss: 136.4339; val_gene_expr_recon_loss: 157765.5257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375138.2840; val_optim_loss: 375138.2840
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9909; val_auprc_score: 0.9921; val_best_acc_score: 0.9670; val_best_f1_score: 0.9729; train_kl_reg_loss: 6953.9989; train_edge_recon_loss: 209067.1489; train_cat_covariates_contrastive_loss: 138.0700; train_gene_expr_recon_loss: 156356.7886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372516.0068; train_optim_loss: 372516.0068; val_kl_reg_loss: 6955.5612; val_edge_recon_loss: 209660.0825; val_cat_covariates_contrastive_loss: 136.5079; val_gene_expr_recon_loss: 156825.3482; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373577.5003; val_optim_loss: 373577.5003
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9912; val_auprc_score: 0.9927; val_best_acc_score: 0.9667; val_best_f1_score: 0.9726; train_kl_reg_loss: 6970.6091; train_edge_recon_loss: 208980.6118; train_cat_covariates_contrastive_loss: 137.8981; train_gene_expr_recon_loss: 155851.5386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371940.6582; train_optim_loss: 371940.6582; val_kl_reg_loss: 6869.1477; val_edge_recon_loss: 210618.2750; val_cat_covariates_contrastive_loss: 137.1147; val_gene_expr_recon_loss: 156469.6629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374094.2003; val_optim_loss: 374094.2003
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9912; val_auprc_score: 0.9926; val_best_acc_score: 0.9666; val_best_f1_score: 0.9725; train_kl_reg_loss: 6994.7795; train_edge_recon_loss: 208731.0406; train_cat_covariates_contrastive_loss: 137.6743; train_gene_expr_recon_loss: 154730.4516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370593.9461; train_optim_loss: 370593.9461; val_kl_reg_loss: 7047.5102; val_edge_recon_loss: 209844.1971; val_cat_covariates_contrastive_loss: 137.6900; val_gene_expr_recon_loss: 155748.2719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372777.6693; val_optim_loss: 372777.6693
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9915; val_auprc_score: 0.9930; val_best_acc_score: 0.9676; val_best_f1_score: 0.9733; train_kl_reg_loss: 7008.7024; train_edge_recon_loss: 208712.6234; train_cat_covariates_contrastive_loss: 138.0944; train_gene_expr_recon_loss: 154560.7040; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370420.1237; train_optim_loss: 370420.1237; val_kl_reg_loss: 7045.1524; val_edge_recon_loss: 210021.9076; val_cat_covariates_contrastive_loss: 136.1369; val_gene_expr_recon_loss: 155318.2251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372521.4220; val_optim_loss: 372521.4220
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9917; val_auprc_score: 0.9931; val_best_acc_score: 0.9684; val_best_f1_score: 0.9740; train_kl_reg_loss: 7022.2487; train_edge_recon_loss: 208707.0011; train_cat_covariates_contrastive_loss: 138.2651; train_gene_expr_recon_loss: 153538.2920; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369405.8072; train_optim_loss: 369405.8072; val_kl_reg_loss: 7094.9956; val_edge_recon_loss: 209717.4841; val_cat_covariates_contrastive_loss: 137.8768; val_gene_expr_recon_loss: 154806.9734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371757.3274; val_optim_loss: 371757.3274
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9917; val_auprc_score: 0.9930; val_best_acc_score: 0.9680; val_best_f1_score: 0.9736; train_kl_reg_loss: 7044.9306; train_edge_recon_loss: 208723.4006; train_cat_covariates_contrastive_loss: 137.7396; train_gene_expr_recon_loss: 153537.1093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369443.1796; train_optim_loss: 369443.1796; val_kl_reg_loss: 7102.3125; val_edge_recon_loss: 209762.6050; val_cat_covariates_contrastive_loss: 138.3414; val_gene_expr_recon_loss: 154749.2045; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371752.4630; val_optim_loss: 371752.4630
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9914; val_auprc_score: 0.9926; val_best_acc_score: 0.9673; val_best_f1_score: 0.9731; train_kl_reg_loss: 7066.2580; train_edge_recon_loss: 208551.8453; train_cat_covariates_contrastive_loss: 137.5362; train_gene_expr_recon_loss: 153004.7419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368760.3815; train_optim_loss: 368760.3815; val_kl_reg_loss: 6976.0620; val_edge_recon_loss: 210216.4015; val_cat_covariates_contrastive_loss: 136.7269; val_gene_expr_recon_loss: 154169.5167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371498.7062; val_optim_loss: 371498.7062
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9920; val_auprc_score: 0.9933; val_best_acc_score: 0.9689; val_best_f1_score: 0.9743; train_kl_reg_loss: 7073.4641; train_edge_recon_loss: 208639.1148; train_cat_covariates_contrastive_loss: 137.5400; train_gene_expr_recon_loss: 152897.2803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368747.3991; train_optim_loss: 368747.3991; val_kl_reg_loss: 7146.3845; val_edge_recon_loss: 210573.5515; val_cat_covariates_contrastive_loss: 137.7034; val_gene_expr_recon_loss: 153517.8697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371375.5092; val_optim_loss: 371375.5092
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9922; val_auprc_score: 0.9935; val_best_acc_score: 0.9693; val_best_f1_score: 0.9747; train_kl_reg_loss: 7073.8143; train_edge_recon_loss: 208616.5378; train_cat_covariates_contrastive_loss: 137.5543; train_gene_expr_recon_loss: 152032.0292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367859.9363; train_optim_loss: 367859.9363; val_kl_reg_loss: 7101.1316; val_edge_recon_loss: 209291.4610; val_cat_covariates_contrastive_loss: 137.1068; val_gene_expr_recon_loss: 153355.0253; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369884.7258; val_optim_loss: 369884.7258
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9920; val_auprc_score: 0.9933; val_best_acc_score: 0.9688; val_best_f1_score: 0.9743; train_kl_reg_loss: 7089.3596; train_edge_recon_loss: 208428.4568; train_cat_covariates_contrastive_loss: 138.0264; train_gene_expr_recon_loss: 152626.9654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368282.8078; train_optim_loss: 368282.8078; val_kl_reg_loss: 7167.9175; val_edge_recon_loss: 209568.5198; val_cat_covariates_contrastive_loss: 136.3118; val_gene_expr_recon_loss: 154292.1558; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371164.9068; val_optim_loss: 371164.9068
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9922; val_auprc_score: 0.9933; val_best_acc_score: 0.9699; val_best_f1_score: 0.9753; train_kl_reg_loss: 7101.1719; train_edge_recon_loss: 208787.6115; train_cat_covariates_contrastive_loss: 138.3858; train_gene_expr_recon_loss: 151559.0176; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367586.1876; train_optim_loss: 367586.1876; val_kl_reg_loss: 7160.7916; val_edge_recon_loss: 209665.1277; val_cat_covariates_contrastive_loss: 137.5397; val_gene_expr_recon_loss: 153332.5270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370295.9853; val_optim_loss: 370295.9853
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9930; val_auprc_score: 0.9940; val_best_acc_score: 0.9709; val_best_f1_score: 0.9758; train_kl_reg_loss: 7106.7213; train_edge_recon_loss: 208499.3820; train_cat_covariates_contrastive_loss: 137.8110; train_gene_expr_recon_loss: 151711.8607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367455.7751; train_optim_loss: 367455.7751; val_kl_reg_loss: 7037.8615; val_edge_recon_loss: 210604.0246; val_cat_covariates_contrastive_loss: 137.9830; val_gene_expr_recon_loss: 153365.6973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371145.5649; val_optim_loss: 371145.5649
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9924; val_auprc_score: 0.9933; val_best_acc_score: 0.9702; val_best_f1_score: 0.9755; train_kl_reg_loss: 7107.6533; train_edge_recon_loss: 208374.5718; train_cat_covariates_contrastive_loss: 137.3870; train_gene_expr_recon_loss: 151101.1607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 366720.7719; train_optim_loss: 366720.7719; val_kl_reg_loss: 6989.2050; val_edge_recon_loss: 209859.4296; val_cat_covariates_contrastive_loss: 136.4564; val_gene_expr_recon_loss: 154022.1408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371007.2288; val_optim_loss: 371007.2288

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9926; val_auprc_score: 0.9936; val_best_acc_score: 0.9707; val_best_f1_score: 0.9759; train_kl_reg_loss: 7013.8445; train_edge_recon_loss: 208030.9716; train_cat_covariates_contrastive_loss: 137.7602; train_gene_expr_recon_loss: 149897.0362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365079.6122; train_optim_loss: 365079.6122; val_kl_reg_loss: 7040.4329; val_edge_recon_loss: 208895.9495; val_cat_covariates_contrastive_loss: 136.8218; val_gene_expr_recon_loss: 151513.4779; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367586.6815; val_optim_loss: 367586.6815
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9928; val_auprc_score: 0.9939; val_best_acc_score: 0.9708; val_best_f1_score: 0.9760; train_kl_reg_loss: 7017.4902; train_edge_recon_loss: 207901.7712; train_cat_covariates_contrastive_loss: 138.1988; train_gene_expr_recon_loss: 149002.9244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 364060.3849; train_optim_loss: 364060.3849; val_kl_reg_loss: 7021.4553; val_edge_recon_loss: 209372.3758; val_cat_covariates_contrastive_loss: 136.9485; val_gene_expr_recon_loss: 150968.8395; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367499.6196; val_optim_loss: 367499.6196
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9928; val_auprc_score: 0.9939; val_best_acc_score: 0.9710; val_best_f1_score: 0.9761; train_kl_reg_loss: 7016.0963; train_edge_recon_loss: 207873.5286; train_cat_covariates_contrastive_loss: 138.1542; train_gene_expr_recon_loss: 148736.3014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363764.0805; train_optim_loss: 363764.0805; val_kl_reg_loss: 7014.5636; val_edge_recon_loss: 209103.5431; val_cat_covariates_contrastive_loss: 137.4034; val_gene_expr_recon_loss: 151111.8925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367367.4033; val_optim_loss: 367367.4033
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9930; val_auprc_score: 0.9940; val_best_acc_score: 0.9719; val_best_f1_score: 0.9769; train_kl_reg_loss: 7002.9763; train_edge_recon_loss: 208100.9525; train_cat_covariates_contrastive_loss: 138.4843; train_gene_expr_recon_loss: 148424.6428; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363667.0551; train_optim_loss: 363667.0551; val_kl_reg_loss: 6991.5175; val_edge_recon_loss: 209289.7516; val_cat_covariates_contrastive_loss: 136.7961; val_gene_expr_recon_loss: 150575.2228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366993.2872; val_optim_loss: 366993.2872
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9925; val_auprc_score: 0.9934; val_best_acc_score: 0.9710; val_best_f1_score: 0.9761; train_kl_reg_loss: 6985.8728; train_edge_recon_loss: 208135.0721; train_cat_covariates_contrastive_loss: 137.7279; train_gene_expr_recon_loss: 148372.5807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363631.2535; train_optim_loss: 363631.2535; val_kl_reg_loss: 6971.5579; val_edge_recon_loss: 209641.6679; val_cat_covariates_contrastive_loss: 136.4039; val_gene_expr_recon_loss: 150379.5545; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367129.1834; val_optim_loss: 367129.1834
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9929; val_auprc_score: 0.9941; val_best_acc_score: 0.9713; val_best_f1_score: 0.9764; train_kl_reg_loss: 6976.4470; train_edge_recon_loss: 207976.4301; train_cat_covariates_contrastive_loss: 138.0915; train_gene_expr_recon_loss: 148277.1165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363368.0853; train_optim_loss: 363368.0853; val_kl_reg_loss: 6973.8145; val_edge_recon_loss: 208735.1202; val_cat_covariates_contrastive_loss: 136.1823; val_gene_expr_recon_loss: 150167.6019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366012.7220; val_optim_loss: 366012.7220
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9931; val_auprc_score: 0.9940; val_best_acc_score: 0.9717; val_best_f1_score: 0.9766; train_kl_reg_loss: 6961.2082; train_edge_recon_loss: 207944.3120; train_cat_covariates_contrastive_loss: 138.2080; train_gene_expr_recon_loss: 148091.2385; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363134.9671; train_optim_loss: 363134.9671; val_kl_reg_loss: 6999.0509; val_edge_recon_loss: 210252.4337; val_cat_covariates_contrastive_loss: 136.6091; val_gene_expr_recon_loss: 150753.6693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368141.7614; val_optim_loss: 368141.7614
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9931; val_auprc_score: 0.9942; val_best_acc_score: 0.9714; val_best_f1_score: 0.9764; train_kl_reg_loss: 6961.3714; train_edge_recon_loss: 207736.8675; train_cat_covariates_contrastive_loss: 138.0967; train_gene_expr_recon_loss: 148148.5846; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362984.9204; train_optim_loss: 362984.9204; val_kl_reg_loss: 6969.3841; val_edge_recon_loss: 208866.6793; val_cat_covariates_contrastive_loss: 136.8670; val_gene_expr_recon_loss: 150247.6554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366220.5851; val_optim_loss: 366220.5851
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9932; val_auprc_score: 0.9942; val_best_acc_score: 0.9728; val_best_f1_score: 0.9775; train_kl_reg_loss: 6947.6627; train_edge_recon_loss: 207719.2578; train_cat_covariates_contrastive_loss: 138.0098; train_gene_expr_recon_loss: 147968.9496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362773.8797; train_optim_loss: 362773.8797; val_kl_reg_loss: 6929.4574; val_edge_recon_loss: 208964.5091; val_cat_covariates_contrastive_loss: 136.0715; val_gene_expr_recon_loss: 150268.5791; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366298.6149; val_optim_loss: 366298.6149
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9930; val_auprc_score: 0.9942; val_best_acc_score: 0.9717; val_best_f1_score: 0.9766; train_kl_reg_loss: 6948.4199; train_edge_recon_loss: 207785.8982; train_cat_covariates_contrastive_loss: 137.7875; train_gene_expr_recon_loss: 147951.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362823.4866; train_optim_loss: 362823.4866; val_kl_reg_loss: 6928.0858; val_edge_recon_loss: 209510.0709; val_cat_covariates_contrastive_loss: 137.6861; val_gene_expr_recon_loss: 150011.6493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366587.4918; val_optim_loss: 366587.4918

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9931; val_auprc_score: 0.9941; val_best_acc_score: 0.9718; val_best_f1_score: 0.9767; train_kl_reg_loss: 6936.4035; train_edge_recon_loss: 207861.8515; train_cat_covariates_contrastive_loss: 137.6907; train_gene_expr_recon_loss: 147758.8957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362694.8423; train_optim_loss: 362694.8423; val_kl_reg_loss: 6946.6942; val_edge_recon_loss: 209436.9821; val_cat_covariates_contrastive_loss: 136.5703; val_gene_expr_recon_loss: 150237.6308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366757.8753; val_optim_loss: 366757.8753
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9934; val_auprc_score: 0.9942; val_best_acc_score: 0.9728; val_best_f1_score: 0.9776; train_kl_reg_loss: 6926.4452; train_edge_recon_loss: 207785.1127; train_cat_covariates_contrastive_loss: 138.1476; train_gene_expr_recon_loss: 147723.9989; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362573.7040; train_optim_loss: 362573.7040; val_kl_reg_loss: 6935.7371; val_edge_recon_loss: 208704.2194; val_cat_covariates_contrastive_loss: 136.6346; val_gene_expr_recon_loss: 150130.7792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365907.3717; val_optim_loss: 365907.3717
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9928; val_auprc_score: 0.9934; val_best_acc_score: 0.9712; val_best_f1_score: 0.9763; train_kl_reg_loss: 6924.9389; train_edge_recon_loss: 207944.0748; train_cat_covariates_contrastive_loss: 138.2146; train_gene_expr_recon_loss: 147742.1142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362749.3431; train_optim_loss: 362749.3431; val_kl_reg_loss: 6942.6375; val_edge_recon_loss: 208588.8399; val_cat_covariates_contrastive_loss: 136.1078; val_gene_expr_recon_loss: 150207.3240; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365874.9082; val_optim_loss: 365874.9082
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9935; val_auprc_score: 0.9945; val_best_acc_score: 0.9723; val_best_f1_score: 0.9771; train_kl_reg_loss: 6922.6799; train_edge_recon_loss: 207585.6967; train_cat_covariates_contrastive_loss: 138.1085; train_gene_expr_recon_loss: 147809.4576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362455.9422; train_optim_loss: 362455.9422; val_kl_reg_loss: 6934.4371; val_edge_recon_loss: 208959.4802; val_cat_covariates_contrastive_loss: 136.9306; val_gene_expr_recon_loss: 150313.1245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366343.9720; val_optim_loss: 366343.9720
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9934; val_auprc_score: 0.9944; val_best_acc_score: 0.9724; val_best_f1_score: 0.9773; train_kl_reg_loss: 6920.5428; train_edge_recon_loss: 207677.1822; train_cat_covariates_contrastive_loss: 137.5471; train_gene_expr_recon_loss: 147558.1813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362293.4539; train_optim_loss: 362293.4539; val_kl_reg_loss: 6941.2600; val_edge_recon_loss: 208656.1247; val_cat_covariates_contrastive_loss: 136.1113; val_gene_expr_recon_loss: 149807.8556; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365541.3514; val_optim_loss: 365541.3514
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9933; val_auprc_score: 0.9943; val_best_acc_score: 0.9721; val_best_f1_score: 0.9770; train_kl_reg_loss: 6919.9986; train_edge_recon_loss: 207826.5753; train_cat_covariates_contrastive_loss: 137.9532; train_gene_expr_recon_loss: 147640.3759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362524.9033; train_optim_loss: 362524.9033; val_kl_reg_loss: 6923.7773; val_edge_recon_loss: 208852.3201; val_cat_covariates_contrastive_loss: 137.3490; val_gene_expr_recon_loss: 149759.4306; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365672.8772; val_optim_loss: 365672.8772
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9938; val_auprc_score: 0.9942; val_best_acc_score: 0.9733; val_best_f1_score: 0.9780; train_kl_reg_loss: 6912.4751; train_edge_recon_loss: 207913.7161; train_cat_covariates_contrastive_loss: 137.8992; train_gene_expr_recon_loss: 147569.8171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362533.9075; train_optim_loss: 362533.9075; val_kl_reg_loss: 6915.5905; val_edge_recon_loss: 208549.9596; val_cat_covariates_contrastive_loss: 136.1116; val_gene_expr_recon_loss: 149857.3056; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365458.9677; val_optim_loss: 365458.9677
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9934; val_auprc_score: 0.9945; val_best_acc_score: 0.9725; val_best_f1_score: 0.9773; train_kl_reg_loss: 6916.7054; train_edge_recon_loss: 208075.9335; train_cat_covariates_contrastive_loss: 137.8115; train_gene_expr_recon_loss: 147615.8350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362746.2851; train_optim_loss: 362746.2851; val_kl_reg_loss: 6927.2294; val_edge_recon_loss: 208514.4882; val_cat_covariates_contrastive_loss: 137.3165; val_gene_expr_recon_loss: 149939.7776; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365518.8114; val_optim_loss: 365518.8114
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9934; val_auprc_score: 0.9944; val_best_acc_score: 0.9729; val_best_f1_score: 0.9777; train_kl_reg_loss: 6914.0852; train_edge_recon_loss: 207907.8986; train_cat_covariates_contrastive_loss: 137.9772; train_gene_expr_recon_loss: 147644.9122; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362604.8729; train_optim_loss: 362604.8729; val_kl_reg_loss: 6939.0777; val_edge_recon_loss: 208958.7591; val_cat_covariates_contrastive_loss: 135.7818; val_gene_expr_recon_loss: 150134.0742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366167.6937; val_optim_loss: 366167.6937
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9936; val_auprc_score: 0.9946; val_best_acc_score: 0.9728; val_best_f1_score: 0.9775; train_kl_reg_loss: 6913.7082; train_edge_recon_loss: 207523.6205; train_cat_covariates_contrastive_loss: 137.7646; train_gene_expr_recon_loss: 147616.4465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362191.5398; train_optim_loss: 362191.5398; val_kl_reg_loss: 6926.6047; val_edge_recon_loss: 209449.6329; val_cat_covariates_contrastive_loss: 137.6539; val_gene_expr_recon_loss: 150112.3624; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366626.2552; val_optim_loss: 366626.2552
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9929; val_auprc_score: 0.9941; val_best_acc_score: 0.9716; val_best_f1_score: 0.9766; train_kl_reg_loss: 6911.9215; train_edge_recon_loss: 207933.7391; train_cat_covariates_contrastive_loss: 137.6687; train_gene_expr_recon_loss: 147469.7429; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362453.0729; train_optim_loss: 362453.0729; val_kl_reg_loss: 6915.7754; val_edge_recon_loss: 208797.6476; val_cat_covariates_contrastive_loss: 136.7484; val_gene_expr_recon_loss: 149816.1707; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365666.3389; val_optim_loss: 365666.3389

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9931; val_auprc_score: 0.9942; val_best_acc_score: 0.9719; val_best_f1_score: 0.9767; train_kl_reg_loss: 6910.1159; train_edge_recon_loss: 207702.7622; train_cat_covariates_contrastive_loss: 137.9585; train_gene_expr_recon_loss: 147535.5213; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362286.3581; train_optim_loss: 362286.3581; val_kl_reg_loss: 6926.3896; val_edge_recon_loss: 209229.2607; val_cat_covariates_contrastive_loss: 136.2009; val_gene_expr_recon_loss: 150048.6016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366340.4530; val_optim_loss: 366340.4530
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9934; val_auprc_score: 0.9943; val_best_acc_score: 0.9722; val_best_f1_score: 0.9771; train_kl_reg_loss: 6910.4351; train_edge_recon_loss: 207630.5824; train_cat_covariates_contrastive_loss: 137.6972; train_gene_expr_recon_loss: 147543.6308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362222.3457; train_optim_loss: 362222.3457; val_kl_reg_loss: 6926.4832; val_edge_recon_loss: 208764.1334; val_cat_covariates_contrastive_loss: 136.4441; val_gene_expr_recon_loss: 150189.9226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366016.9832; val_optim_loss: 366016.9832
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9935; val_auprc_score: 0.9944; val_best_acc_score: 0.9730; val_best_f1_score: 0.9778; train_kl_reg_loss: 6911.4794; train_edge_recon_loss: 207743.8502; train_cat_covariates_contrastive_loss: 138.0133; train_gene_expr_recon_loss: 147591.6700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362385.0131; train_optim_loss: 362385.0131; val_kl_reg_loss: 6926.9161; val_edge_recon_loss: 208526.8110; val_cat_covariates_contrastive_loss: 136.3627; val_gene_expr_recon_loss: 149857.4452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365447.5340; val_optim_loss: 365447.5340
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9936; val_auprc_score: 0.9946; val_best_acc_score: 0.9726; val_best_f1_score: 0.9774; train_kl_reg_loss: 6911.4593; train_edge_recon_loss: 208100.7464; train_cat_covariates_contrastive_loss: 137.6721; train_gene_expr_recon_loss: 147485.8152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362635.6926; train_optim_loss: 362635.6926; val_kl_reg_loss: 6926.2259; val_edge_recon_loss: 208485.2387; val_cat_covariates_contrastive_loss: 136.7807; val_gene_expr_recon_loss: 149602.7659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365151.0087; val_optim_loss: 365151.0087
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9929; val_auprc_score: 0.9940; val_best_acc_score: 0.9717; val_best_f1_score: 0.9767; train_kl_reg_loss: 6914.1919; train_edge_recon_loss: 207868.1111; train_cat_covariates_contrastive_loss: 137.8755; train_gene_expr_recon_loss: 147525.7134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362445.8912; train_optim_loss: 362445.8912; val_kl_reg_loss: 6932.0033; val_edge_recon_loss: 208986.7341; val_cat_covariates_contrastive_loss: 136.3809; val_gene_expr_recon_loss: 149997.1327; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366052.2514; val_optim_loss: 366052.2514
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9931; val_auprc_score: 0.9942; val_best_acc_score: 0.9724; val_best_f1_score: 0.9773; train_kl_reg_loss: 6912.8501; train_edge_recon_loss: 207847.3939; train_cat_covariates_contrastive_loss: 137.7407; train_gene_expr_recon_loss: 147519.8739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362417.8590; train_optim_loss: 362417.8590; val_kl_reg_loss: 6925.0451; val_edge_recon_loss: 208613.3402; val_cat_covariates_contrastive_loss: 136.5263; val_gene_expr_recon_loss: 149642.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365317.5470; val_optim_loss: 365317.5470
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9934; val_auprc_score: 0.9944; val_best_acc_score: 0.9719; val_best_f1_score: 0.9768; train_kl_reg_loss: 6911.9342; train_edge_recon_loss: 207658.0943; train_cat_covariates_contrastive_loss: 138.1760; train_gene_expr_recon_loss: 147541.6561; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362249.8607; train_optim_loss: 362249.8607; val_kl_reg_loss: 6936.8017; val_edge_recon_loss: 209365.7323; val_cat_covariates_contrastive_loss: 136.5643; val_gene_expr_recon_loss: 150122.8963; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366561.9924; val_optim_loss: 366561.9924
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9934; val_auprc_score: 0.9943; val_best_acc_score: 0.9725; val_best_f1_score: 0.9773; train_kl_reg_loss: 6910.1378; train_edge_recon_loss: 207987.5020; train_cat_covariates_contrastive_loss: 137.9294; train_gene_expr_recon_loss: 147565.5060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362601.0749; train_optim_loss: 362601.0749; val_kl_reg_loss: 6922.7314; val_edge_recon_loss: 209081.4524; val_cat_covariates_contrastive_loss: 135.9841; val_gene_expr_recon_loss: 149762.5162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 365902.6832; val_optim_loss: 365902.6832

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9931; val_auprc_score: 0.9941; val_best_acc_score: 0.9725; val_best_f1_score: 0.9774; train_kl_reg_loss: 6912.0712; train_edge_recon_loss: 207712.6537; train_cat_covariates_contrastive_loss: 137.5927; train_gene_expr_recon_loss: 147580.5237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362342.8419; train_optim_loss: 362342.8419; val_kl_reg_loss: 6928.2116; val_edge_recon_loss: 208976.7192; val_cat_covariates_contrastive_loss: 136.6482; val_gene_expr_recon_loss: 150190.1159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366231.6951; val_optim_loss: 366231.6951
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9930; val_auprc_score: 0.9940; val_best_acc_score: 0.9720; val_best_f1_score: 0.9769; train_kl_reg_loss: 6910.6691; train_edge_recon_loss: 207675.4450; train_cat_covariates_contrastive_loss: 138.0061; train_gene_expr_recon_loss: 147498.2231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362222.3437; train_optim_loss: 362222.3437; val_kl_reg_loss: 6934.4583; val_edge_recon_loss: 209678.1242; val_cat_covariates_contrastive_loss: 136.1280; val_gene_expr_recon_loss: 150346.8363; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367095.5454; val_optim_loss: 367095.5454
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9931; val_auprc_score: 0.9936; val_best_acc_score: 0.9718; val_best_f1_score: 0.9767; train_kl_reg_loss: 6913.3096; train_edge_recon_loss: 207811.7823; train_cat_covariates_contrastive_loss: 138.0815; train_gene_expr_recon_loss: 147560.9264; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362424.0998; train_optim_loss: 362424.0998; val_kl_reg_loss: 6930.1949; val_edge_recon_loss: 209476.0307; val_cat_covariates_contrastive_loss: 136.9549; val_gene_expr_recon_loss: 150288.6754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366831.8576; val_optim_loss: 366831.8576
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9936; val_auprc_score: 0.9945; val_best_acc_score: 0.9720; val_best_f1_score: 0.9768; train_kl_reg_loss: 6911.1643; train_edge_recon_loss: 207950.5731; train_cat_covariates_contrastive_loss: 137.9584; train_gene_expr_recon_loss: 147452.7071; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362452.4032; train_optim_loss: 362452.4032; val_kl_reg_loss: 6926.1630; val_edge_recon_loss: 209368.8948; val_cat_covariates_contrastive_loss: 137.6840; val_gene_expr_recon_loss: 149935.2817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366368.0228; val_optim_loss: 366368.0228

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 248 min 38 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9933
val AUPRC score: 0.9943
val best accuracy score: 0.9726
val best F1 score: 0.9774
val target rna MSE score: 0.5666
val source rna MSE score: 0.1611
Val cat covariate0 mean sim diff: 0.0005

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
