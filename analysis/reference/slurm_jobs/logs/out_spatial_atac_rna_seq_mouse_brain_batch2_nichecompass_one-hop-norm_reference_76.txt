[True]
Run timestamp: 09102023_235331_76.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_76']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6485; val_auprc_score: 0.6315; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 37771.1201; train_edge_recon_loss: 3511976.6818; train_gene_expr_recon_loss: 14213836.0455; train_masked_gp_l1_reg_loss: 120101.0110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4505294.0795; train_chrom_access_recon_loss: 3009250.6667; train_global_loss: 25398229.4848; train_optim_loss: 25398229.4848; val_kl_reg_loss: 82279.7305; val_edge_recon_loss: 4065652.3750; val_gene_expr_recon_loss: 12997237.2500; val_masked_gp_l1_reg_loss: 99808.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2064848.3750; val_chrom_access_recon_loss: 2820456.5938; val_global_loss: 22130282.7500; val_optim_loss: 22130282.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7010; val_auprc_score: 0.6836; val_best_acc_score: 0.5680; val_best_f1_score: 0.6911; train_kl_reg_loss: 89421.5318; train_edge_recon_loss: 3519992.1023; train_gene_expr_recon_loss: 12886542.7727; train_masked_gp_l1_reg_loss: 96214.0196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 943943.0066; train_chrom_access_recon_loss: 2839384.5038; train_global_loss: 20375497.8485; train_optim_loss: 20375497.8485; val_kl_reg_loss: 95176.1045; val_edge_recon_loss: 4061564.0312; val_gene_expr_recon_loss: 12655420.2500; val_masked_gp_l1_reg_loss: 95291.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 376289.7188; val_chrom_access_recon_loss: 2783997.9375; val_global_loss: 20067740.5000; val_optim_loss: 20067740.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6967; val_auprc_score: 0.6828; val_best_acc_score: 0.6303; val_best_f1_score: 0.6880; train_kl_reg_loss: 87853.4147; train_edge_recon_loss: 3513572.9697; train_gene_expr_recon_loss: 12728296.9091; train_masked_gp_l1_reg_loss: 95428.0343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 256136.4070; train_chrom_access_recon_loss: 2813961.8826; train_global_loss: 19495249.5152; train_optim_loss: 19495249.5152; val_kl_reg_loss: 74181.8799; val_edge_recon_loss: 4052940.7812; val_gene_expr_recon_loss: 12564730.0000; val_masked_gp_l1_reg_loss: 96240.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183861.5000; val_chrom_access_recon_loss: 2779360.5938; val_global_loss: 19751315.2500; val_optim_loss: 19751315.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7356; val_auprc_score: 0.7165; val_best_acc_score: 0.6650; val_best_f1_score: 0.7182; train_kl_reg_loss: 78780.8013; train_edge_recon_loss: 3507926.8295; train_gene_expr_recon_loss: 12632648.5455; train_masked_gp_l1_reg_loss: 97339.6628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153442.4877; train_chrom_access_recon_loss: 2797231.9659; train_global_loss: 19267370.3333; train_optim_loss: 19267370.3333; val_kl_reg_loss: 70145.6709; val_edge_recon_loss: 3982641.6250; val_gene_expr_recon_loss: 12388743.0000; val_masked_gp_l1_reg_loss: 98387.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130764.3438; val_chrom_access_recon_loss: 2745309.0000; val_global_loss: 19415991.2500; val_optim_loss: 19415991.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7257; val_auprc_score: 0.7145; val_best_acc_score: 0.6593; val_best_f1_score: 0.7045; train_kl_reg_loss: 63638.6439; train_edge_recon_loss: 3401311.1856; train_gene_expr_recon_loss: 12574987.1667; train_masked_gp_l1_reg_loss: 101065.0468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116542.3394; train_chrom_access_recon_loss: 2783590.4924; train_global_loss: 19041134.9091; train_optim_loss: 19041134.9091; val_kl_reg_loss: 70598.4033; val_edge_recon_loss: 3519570.7500; val_gene_expr_recon_loss: 12414036.8750; val_masked_gp_l1_reg_loss: 103828.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105695.6406; val_chrom_access_recon_loss: 2749238.5312; val_global_loss: 18962969.5000; val_optim_loss: 18962969.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7750; val_auprc_score: 0.7637; val_best_acc_score: 0.6878; val_best_f1_score: 0.7387; train_kl_reg_loss: 78558.3675; train_edge_recon_loss: 3170826.2424; train_gene_expr_recon_loss: 12536835.1818; train_masked_gp_l1_reg_loss: 106418.4901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98190.9422; train_chrom_access_recon_loss: 2775357.8636; train_global_loss: 18766187.2121; train_optim_loss: 18766187.2121; val_kl_reg_loss: 83429.2148; val_edge_recon_loss: 3226473.0312; val_gene_expr_recon_loss: 12411513.6250; val_masked_gp_l1_reg_loss: 108700.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94380.0469; val_chrom_access_recon_loss: 2752434.9688; val_global_loss: 18676931.7500; val_optim_loss: 18676931.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7946; val_auprc_score: 0.7716; val_best_acc_score: 0.7058; val_best_f1_score: 0.7508; train_kl_reg_loss: 93246.9509; train_edge_recon_loss: 3085850.8788; train_gene_expr_recon_loss: 12474334.8788; train_masked_gp_l1_reg_loss: 110184.9716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88839.5051; train_chrom_access_recon_loss: 2759746.0379; train_global_loss: 18612203.2727; train_optim_loss: 18612203.2727; val_kl_reg_loss: 81727.3008; val_edge_recon_loss: 3143224.8438; val_gene_expr_recon_loss: 12436025.1250; val_masked_gp_l1_reg_loss: 111532.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85042.7891; val_chrom_access_recon_loss: 2749644.5312; val_global_loss: 18607196.7500; val_optim_loss: 18607196.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8194; val_auprc_score: 0.8012; val_best_acc_score: 0.7364; val_best_f1_score: 0.7584; train_kl_reg_loss: 91683.7372; train_edge_recon_loss: 3045758.4924; train_gene_expr_recon_loss: 12406043.8485; train_masked_gp_l1_reg_loss: 112637.7657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83289.4168; train_chrom_access_recon_loss: 2746658.2083; train_global_loss: 18486071.5152; train_optim_loss: 18486071.5152; val_kl_reg_loss: 81596.4551; val_edge_recon_loss: 3102678.7188; val_gene_expr_recon_loss: 12265660.3750; val_masked_gp_l1_reg_loss: 114005.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81794.1094; val_chrom_access_recon_loss: 2703752.4062; val_global_loss: 18349487.5000; val_optim_loss: 18349487.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8517; val_auprc_score: 0.8174; val_best_acc_score: 0.7703; val_best_f1_score: 0.7901; train_kl_reg_loss: 89007.6581; train_edge_recon_loss: 2967747.8523; train_gene_expr_recon_loss: 12354580.2424; train_masked_gp_l1_reg_loss: 115830.5465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80739.0733; train_chrom_access_recon_loss: 2734804.7538; train_global_loss: 18342710.0303; train_optim_loss: 18342710.0303; val_kl_reg_loss: 91152.0977; val_edge_recon_loss: 2976760.5938; val_gene_expr_recon_loss: 12281307.1250; val_masked_gp_l1_reg_loss: 117470.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80954.5625; val_chrom_access_recon_loss: 2723395.2812; val_global_loss: 18271041.2500; val_optim_loss: 18271041.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8937; val_auprc_score: 0.8603; val_best_acc_score: 0.8305; val_best_f1_score: 0.8408; train_kl_reg_loss: 91790.9496; train_edge_recon_loss: 2871715.5265; train_gene_expr_recon_loss: 12287715.7424; train_masked_gp_l1_reg_loss: 120051.0904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82406.4199; train_chrom_access_recon_loss: 2723133.4129; train_global_loss: 18176813.0303; train_optim_loss: 18176813.0303; val_kl_reg_loss: 91365.3936; val_edge_recon_loss: 2866386.2812; val_gene_expr_recon_loss: 12125195.7500; val_masked_gp_l1_reg_loss: 122329.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84887.2109; val_chrom_access_recon_loss: 2691818.8438; val_global_loss: 17981983.0000; val_optim_loss: 17981983.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9119; val_auprc_score: 0.8837; val_best_acc_score: 0.8442; val_best_f1_score: 0.8542; train_kl_reg_loss: 95475.8911; train_edge_recon_loss: 2830483.8561; train_gene_expr_recon_loss: 12219376.8788; train_masked_gp_l1_reg_loss: 122873.7629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87145.1839; train_chrom_access_recon_loss: 2713778.2614; train_global_loss: 18069133.7879; train_optim_loss: 18069133.7879; val_kl_reg_loss: 93183.9727; val_edge_recon_loss: 2825925.4375; val_gene_expr_recon_loss: 12198247.0000; val_masked_gp_l1_reg_loss: 124347.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89567.6641; val_chrom_access_recon_loss: 2712588.8750; val_global_loss: 18043860.5000; val_optim_loss: 18043860.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9027; val_auprc_score: 0.8674; val_best_acc_score: 0.8342; val_best_f1_score: 0.8474; train_kl_reg_loss: 87179.4216; train_edge_recon_loss: 2870311.1818; train_gene_expr_recon_loss: 12206676.9697; train_masked_gp_l1_reg_loss: 129971.5689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91156.7370; train_chrom_access_recon_loss: 2708159.0417; train_global_loss: 18093455.1818; train_optim_loss: 18093455.1818; val_kl_reg_loss: 86155.8926; val_edge_recon_loss: 2866286.1250; val_gene_expr_recon_loss: 12054623.6250; val_masked_gp_l1_reg_loss: 133438.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90882.0938; val_chrom_access_recon_loss: 2658452.1250; val_global_loss: 17889838.2500; val_optim_loss: 17889838.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9110; val_auprc_score: 0.8815; val_best_acc_score: 0.8458; val_best_f1_score: 0.8566; train_kl_reg_loss: 94480.5138; train_edge_recon_loss: 2828453.8409; train_gene_expr_recon_loss: 12139324.2273; train_masked_gp_l1_reg_loss: 133911.3381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88823.8535; train_chrom_access_recon_loss: 2699774.3598; train_global_loss: 17984768.0303; train_optim_loss: 17984768.0303; val_kl_reg_loss: 95546.7773; val_edge_recon_loss: 2823771.6875; val_gene_expr_recon_loss: 12009446.6250; val_masked_gp_l1_reg_loss: 134101.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86926.4844; val_chrom_access_recon_loss: 2691835.4062; val_global_loss: 17841628.5000; val_optim_loss: 17841628.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9116; val_auprc_score: 0.8848; val_best_acc_score: 0.8512; val_best_f1_score: 0.8608; train_kl_reg_loss: 98803.3156; train_edge_recon_loss: 2801592.3977; train_gene_expr_recon_loss: 12090316.6212; train_masked_gp_l1_reg_loss: 134298.9768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85865.1984; train_chrom_access_recon_loss: 2690975.2727; train_global_loss: 17901851.7879; train_optim_loss: 17901851.7879; val_kl_reg_loss: 96579.3506; val_edge_recon_loss: 2811455.7188; val_gene_expr_recon_loss: 11968394.5000; val_masked_gp_l1_reg_loss: 134524.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85526.9453; val_chrom_access_recon_loss: 2702241.2188; val_global_loss: 17798722.0000; val_optim_loss: 17798722.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9175; val_auprc_score: 0.8916; val_best_acc_score: 0.8493; val_best_f1_score: 0.8610; train_kl_reg_loss: 95054.2165; train_edge_recon_loss: 2795373.3295; train_gene_expr_recon_loss: 12054185.1667; train_masked_gp_l1_reg_loss: 134724.9754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84246.5227; train_chrom_access_recon_loss: 2680403.8902; train_global_loss: 17843988.1818; train_optim_loss: 17843988.1818; val_kl_reg_loss: 94612.6338; val_edge_recon_loss: 2809466.3125; val_gene_expr_recon_loss: 11892877.8750; val_masked_gp_l1_reg_loss: 135124.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83378.5625; val_chrom_access_recon_loss: 2648633.0625; val_global_loss: 17664093.7500; val_optim_loss: 17664093.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9187; val_auprc_score: 0.8878; val_best_acc_score: 0.8579; val_best_f1_score: 0.8697; train_kl_reg_loss: 94368.6464; train_edge_recon_loss: 2785663.9318; train_gene_expr_recon_loss: 12017087.9848; train_masked_gp_l1_reg_loss: 135238.3359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82469.4873; train_chrom_access_recon_loss: 2672653.6932; train_global_loss: 17787482.0606; train_optim_loss: 17787482.0606; val_kl_reg_loss: 96505.6465; val_edge_recon_loss: 2791441.9062; val_gene_expr_recon_loss: 11901061.5000; val_masked_gp_l1_reg_loss: 135397.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81691.5469; val_chrom_access_recon_loss: 2663434.9688; val_global_loss: 17669534.0000; val_optim_loss: 17669534.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9172; val_auprc_score: 0.8866; val_best_acc_score: 0.8584; val_best_f1_score: 0.8687; train_kl_reg_loss: 93575.4112; train_edge_recon_loss: 2790703.2879; train_gene_expr_recon_loss: 11975368.4545; train_masked_gp_l1_reg_loss: 135624.2782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81058.6529; train_chrom_access_recon_loss: 2664560.8977; train_global_loss: 17740891.0909; train_optim_loss: 17740891.0909; val_kl_reg_loss: 92958.3145; val_edge_recon_loss: 2822179.9688; val_gene_expr_recon_loss: 11826279.7500; val_masked_gp_l1_reg_loss: 135473.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80899.4141; val_chrom_access_recon_loss: 2636841.1562; val_global_loss: 17594632.5000; val_optim_loss: 17594632.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9168; val_auprc_score: 0.8808; val_best_acc_score: 0.8603; val_best_f1_score: 0.8687; train_kl_reg_loss: 92189.7264; train_edge_recon_loss: 2781166.9091; train_gene_expr_recon_loss: 11964516.5606; train_masked_gp_l1_reg_loss: 135757.5388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80212.5501; train_chrom_access_recon_loss: 2661639.9015; train_global_loss: 17715483.2727; train_optim_loss: 17715483.2727; val_kl_reg_loss: 91035.6348; val_edge_recon_loss: 2803845.5938; val_gene_expr_recon_loss: 11971299.1250; val_masked_gp_l1_reg_loss: 135989.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79814.8828; val_chrom_access_recon_loss: 2666750.3125; val_global_loss: 17748736.0000; val_optim_loss: 17748736.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9222; val_auprc_score: 0.8974; val_best_acc_score: 0.8608; val_best_f1_score: 0.8707; train_kl_reg_loss: 92173.7461; train_edge_recon_loss: 2771577.1894; train_gene_expr_recon_loss: 11917285.0152; train_masked_gp_l1_reg_loss: 136029.9067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79448.4503; train_chrom_access_recon_loss: 2653795.2652; train_global_loss: 17650309.5455; train_optim_loss: 17650309.5455; val_kl_reg_loss: 91383.9053; val_edge_recon_loss: 2782697.9688; val_gene_expr_recon_loss: 11773836.1250; val_masked_gp_l1_reg_loss: 136062.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79263.3906; val_chrom_access_recon_loss: 2610477.7812; val_global_loss: 17473720.7500; val_optim_loss: 17473720.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9316; val_auprc_score: 0.9093; val_best_acc_score: 0.8724; val_best_f1_score: 0.8819; train_kl_reg_loss: 91681.3832; train_edge_recon_loss: 2751795.2879; train_gene_expr_recon_loss: 11892778.8333; train_masked_gp_l1_reg_loss: 135799.5746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78757.2341; train_chrom_access_recon_loss: 2647723.7652; train_global_loss: 17598536.0909; train_optim_loss: 17598536.0909; val_kl_reg_loss: 88432.4014; val_edge_recon_loss: 2741510.2500; val_gene_expr_recon_loss: 11779080.0000; val_masked_gp_l1_reg_loss: 136071.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78535.4062; val_chrom_access_recon_loss: 2603247.1250; val_global_loss: 17426876.7500; val_optim_loss: 17426876.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9204; val_auprc_score: 0.8956; val_best_acc_score: 0.8584; val_best_f1_score: 0.8680; train_kl_reg_loss: 91729.0417; train_edge_recon_loss: 2764050.0455; train_gene_expr_recon_loss: 11864868.3788; train_masked_gp_l1_reg_loss: 135884.6934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78128.7037; train_chrom_access_recon_loss: 2640429.7083; train_global_loss: 17575090.6061; train_optim_loss: 17575090.6061; val_kl_reg_loss: 90953.3643; val_edge_recon_loss: 2810421.0312; val_gene_expr_recon_loss: 11890382.7500; val_masked_gp_l1_reg_loss: 135948.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77992.9219; val_chrom_access_recon_loss: 2620874.2812; val_global_loss: 17626573.2500; val_optim_loss: 17626573.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9287; val_auprc_score: 0.9066; val_best_acc_score: 0.8694; val_best_f1_score: 0.8776; train_kl_reg_loss: 91528.5542; train_edge_recon_loss: 2756004.7500; train_gene_expr_recon_loss: 11846314.5455; train_masked_gp_l1_reg_loss: 136096.9119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77711.6438; train_chrom_access_recon_loss: 2636955.8258; train_global_loss: 17544612.4545; train_optim_loss: 17544612.4545; val_kl_reg_loss: 88664.4121; val_edge_recon_loss: 2793258.4688; val_gene_expr_recon_loss: 11715572.2500; val_masked_gp_l1_reg_loss: 135973.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77333.1016; val_chrom_access_recon_loss: 2619790.9062; val_global_loss: 17430593.2500; val_optim_loss: 17430593.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9307; val_auprc_score: 0.9003; val_best_acc_score: 0.8775; val_best_f1_score: 0.8858; train_kl_reg_loss: 91031.5685; train_edge_recon_loss: 2760853.1591; train_gene_expr_recon_loss: 11822183.6212; train_masked_gp_l1_reg_loss: 136147.2057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77506.4658; train_chrom_access_recon_loss: 2630771.6098; train_global_loss: 17518493.5455; train_optim_loss: 17518493.5455; val_kl_reg_loss: 87170.8701; val_edge_recon_loss: 2779106.6250; val_gene_expr_recon_loss: 11764159.0000; val_masked_gp_l1_reg_loss: 136094.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77814.6172; val_chrom_access_recon_loss: 2610647.2812; val_global_loss: 17454992.7500; val_optim_loss: 17454992.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9263; val_auprc_score: 0.8994; val_best_acc_score: 0.8649; val_best_f1_score: 0.8748; train_kl_reg_loss: 85776.6112; train_edge_recon_loss: 2779228.0114; train_gene_expr_recon_loss: 11820565.3182; train_masked_gp_l1_reg_loss: 137935.2337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77821.1716; train_chrom_access_recon_loss: 2628379.3977; train_global_loss: 17529705.7576; train_optim_loss: 17529705.7576; val_kl_reg_loss: 76843.0928; val_edge_recon_loss: 2833411.0000; val_gene_expr_recon_loss: 11762031.8750; val_masked_gp_l1_reg_loss: 144782.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79265.4688; val_chrom_access_recon_loss: 2623050.3125; val_global_loss: 17519383.5000; val_optim_loss: 17519383.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9263; val_auprc_score: 0.9009; val_best_acc_score: 0.8630; val_best_f1_score: 0.8707; train_kl_reg_loss: 79533.5526; train_edge_recon_loss: 2788281.2008; train_gene_expr_recon_loss: 11795809.5909; train_masked_gp_l1_reg_loss: 139470.9190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62754.8077; train_chrom_access_recon_loss: 2624491.5682; train_global_loss: 17490341.6212; train_optim_loss: 17490341.6212; val_kl_reg_loss: 80165.4189; val_edge_recon_loss: 2809391.0000; val_gene_expr_recon_loss: 11611533.2500; val_masked_gp_l1_reg_loss: 137352.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58925.7227; val_chrom_access_recon_loss: 2584979.5625; val_global_loss: 17282348.1250; val_optim_loss: 17282348.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9208; val_auprc_score: 0.8927; val_best_acc_score: 0.8622; val_best_f1_score: 0.8709; train_kl_reg_loss: 92508.4773; train_edge_recon_loss: 3052946.2197; train_gene_expr_recon_loss: 11079960.2879; train_masked_gp_l1_reg_loss: 136915.6148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57832.0034; train_chrom_access_recon_loss: 2606770.6023; train_global_loss: 17026933.2727; train_optim_loss: 17026933.2727; val_kl_reg_loss: 22178.3330; val_edge_recon_loss: 3009600.8125; val_gene_expr_recon_loss: 11043779.0000; val_masked_gp_l1_reg_loss: 137060.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56884.1211; val_chrom_access_recon_loss: 2517594.8438; val_global_loss: 16787098.1250; val_optim_loss: 16787098.1250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9238; val_auprc_score: 0.8924; val_best_acc_score: 0.8675; val_best_f1_score: 0.8768; train_kl_reg_loss: 110065.2583; train_edge_recon_loss: 2948613.6023; train_gene_expr_recon_loss: 11021395.5303; train_masked_gp_l1_reg_loss: 137377.8849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56244.9547; train_chrom_access_recon_loss: 2512354.1402; train_global_loss: 16786051.5152; train_optim_loss: 16786051.5152; val_kl_reg_loss: 25841.5635; val_edge_recon_loss: 2924809.5000; val_gene_expr_recon_loss: 10955819.3750; val_masked_gp_l1_reg_loss: 137701.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55896.5273; val_chrom_access_recon_loss: 2495849.6562; val_global_loss: 16595918.2500; val_optim_loss: 16595918.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9227; val_auprc_score: 0.8913; val_best_acc_score: 0.8635; val_best_f1_score: 0.8730; train_kl_reg_loss: 116591.3574; train_edge_recon_loss: 2918197.2045; train_gene_expr_recon_loss: 11009952.0152; train_masked_gp_l1_reg_loss: 137950.1877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55673.8253; train_chrom_access_recon_loss: 2502163.8447; train_global_loss: 16740528.3030; train_optim_loss: 16740528.3030; val_kl_reg_loss: 28097.5281; val_edge_recon_loss: 2914236.8750; val_gene_expr_recon_loss: 10854868.1250; val_masked_gp_l1_reg_loss: 138147.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55547.1914; val_chrom_access_recon_loss: 2481858.8750; val_global_loss: 16472755.6250; val_optim_loss: 16472755.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9189; val_auprc_score: 0.8857; val_best_acc_score: 0.8624; val_best_f1_score: 0.8724; train_kl_reg_loss: 118740.4394; train_edge_recon_loss: 2885825.3977; train_gene_expr_recon_loss: 10996187.1515; train_masked_gp_l1_reg_loss: 138305.2491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55511.1499; train_chrom_access_recon_loss: 2497045.7462; train_global_loss: 16691615.1061; train_optim_loss: 16691615.1061; val_kl_reg_loss: 29716.1218; val_edge_recon_loss: 2921492.9375; val_gene_expr_recon_loss: 10867538.7500; val_masked_gp_l1_reg_loss: 138464.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55521.1289; val_chrom_access_recon_loss: 2462978.1562; val_global_loss: 16475711.2500; val_optim_loss: 16475711.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9247; val_auprc_score: 0.8904; val_best_acc_score: 0.8667; val_best_f1_score: 0.8770; train_kl_reg_loss: 118582.5798; train_edge_recon_loss: 2880084.2008; train_gene_expr_recon_loss: 10992679.8030; train_masked_gp_l1_reg_loss: 138553.2221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55559.3831; train_chrom_access_recon_loss: 2493454.4242; train_global_loss: 16678913.4545; train_optim_loss: 16678913.4545; val_kl_reg_loss: 31601.3484; val_edge_recon_loss: 2877862.8438; val_gene_expr_recon_loss: 11031726.6250; val_masked_gp_l1_reg_loss: 138634.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55570.5352; val_chrom_access_recon_loss: 2505294.5938; val_global_loss: 16640690.5000; val_optim_loss: 16640690.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9222; val_auprc_score: 0.8986; val_best_acc_score: 0.8619; val_best_f1_score: 0.8719; train_kl_reg_loss: 117853.2354; train_edge_recon_loss: 2866749.1174; train_gene_expr_recon_loss: 10995117.1970; train_masked_gp_l1_reg_loss: 138664.5443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55596.6064; train_chrom_access_recon_loss: 2493457.4432; train_global_loss: 16667438.0909; train_optim_loss: 16667438.0909; val_kl_reg_loss: 33329.0576; val_edge_recon_loss: 2873865.2188; val_gene_expr_recon_loss: 10952337.7500; val_masked_gp_l1_reg_loss: 138742.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55619.1562; val_chrom_access_recon_loss: 2471294.2188; val_global_loss: 16525188.3750; val_optim_loss: 16525188.3750
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9265; val_auprc_score: 0.9006; val_best_acc_score: 0.8654; val_best_f1_score: 0.8761; train_kl_reg_loss: 115334.8095; train_edge_recon_loss: 2841233.4924; train_gene_expr_recon_loss: 10989409.6970; train_masked_gp_l1_reg_loss: 138747.5585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55758.4469; train_chrom_access_recon_loss: 2492266.9848; train_global_loss: 16632750.9848; train_optim_loss: 16632750.9848; val_kl_reg_loss: 34702.6738; val_edge_recon_loss: 2859341.6250; val_gene_expr_recon_loss: 10876987.8750; val_masked_gp_l1_reg_loss: 138759.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55791.0938; val_chrom_access_recon_loss: 2474340.6875; val_global_loss: 16439923.2500; val_optim_loss: 16439923.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9244; val_auprc_score: 0.8944; val_best_acc_score: 0.8630; val_best_f1_score: 0.8708; train_kl_reg_loss: 112432.0575; train_edge_recon_loss: 2851261.0947; train_gene_expr_recon_loss: 10983388.1061; train_masked_gp_l1_reg_loss: 138736.3778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55833.0811; train_chrom_access_recon_loss: 2491071.0985; train_global_loss: 16632721.8182; train_optim_loss: 16632721.8182; val_kl_reg_loss: 35903.4961; val_edge_recon_loss: 2881971.3750; val_gene_expr_recon_loss: 10905312.3750; val_masked_gp_l1_reg_loss: 138702.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55861.1562; val_chrom_access_recon_loss: 2425181.1719; val_global_loss: 16442932.3750; val_optim_loss: 16442932.3750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9295; val_auprc_score: 0.9024; val_best_acc_score: 0.8729; val_best_f1_score: 0.8803; train_kl_reg_loss: 109514.7087; train_edge_recon_loss: 2824611.6326; train_gene_expr_recon_loss: 10979362.5000; train_masked_gp_l1_reg_loss: 138678.4470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55896.7592; train_chrom_access_recon_loss: 2491666.6477; train_global_loss: 16599730.6667; train_optim_loss: 16599730.6667; val_kl_reg_loss: 37465.4731; val_edge_recon_loss: 2829439.3750; val_gene_expr_recon_loss: 10974180.8750; val_masked_gp_l1_reg_loss: 138630.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55905.6406; val_chrom_access_recon_loss: 2509127.7188; val_global_loss: 16544749.7500; val_optim_loss: 16544749.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9274; val_auprc_score: 0.9014; val_best_acc_score: 0.8667; val_best_f1_score: 0.8763; train_kl_reg_loss: 106032.6876; train_edge_recon_loss: 2824813.2045; train_gene_expr_recon_loss: 10973316.3333; train_masked_gp_l1_reg_loss: 138589.5947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55934.6100; train_chrom_access_recon_loss: 2488358.9280; train_global_loss: 16587045.2879; train_optim_loss: 16587045.2879; val_kl_reg_loss: 38384.1890; val_edge_recon_loss: 2832791.0312; val_gene_expr_recon_loss: 10956438.6250; val_masked_gp_l1_reg_loss: 138548.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55992.7148; val_chrom_access_recon_loss: 2485086.9375; val_global_loss: 16507241.5000; val_optim_loss: 16507241.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9235; val_auprc_score: 0.8929; val_best_acc_score: 0.8630; val_best_f1_score: 0.8720; train_kl_reg_loss: 102734.9001; train_edge_recon_loss: 2812038.8977; train_gene_expr_recon_loss: 10971443.8788; train_masked_gp_l1_reg_loss: 138457.9493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56043.7940; train_chrom_access_recon_loss: 2487815.3977; train_global_loss: 16568534.6818; train_optim_loss: 16568534.6818; val_kl_reg_loss: 40050.5000; val_edge_recon_loss: 2822495.3438; val_gene_expr_recon_loss: 10949358.2500; val_masked_gp_l1_reg_loss: 138370.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56071.0391; val_chrom_access_recon_loss: 2481776.1875; val_global_loss: 16488121.2500; val_optim_loss: 16488121.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9275; val_auprc_score: 0.8943; val_best_acc_score: 0.8684; val_best_f1_score: 0.8763; train_kl_reg_loss: 101512.1974; train_edge_recon_loss: 2811064.9091; train_gene_expr_recon_loss: 10972227.2121; train_masked_gp_l1_reg_loss: 138084.9550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54820.7899; train_chrom_access_recon_loss: 2489326.8371; train_global_loss: 16567036.8182; train_optim_loss: 16567036.8182; val_kl_reg_loss: 39996.5972; val_edge_recon_loss: 2809923.5938; val_gene_expr_recon_loss: 10938258.6250; val_masked_gp_l1_reg_loss: 137982.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54559.5312; val_chrom_access_recon_loss: 2447497.7812; val_global_loss: 16428219.5000; val_optim_loss: 16428219.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9217; val_auprc_score: 0.8918; val_best_acc_score: 0.8651; val_best_f1_score: 0.8737; train_kl_reg_loss: 100771.1720; train_edge_recon_loss: 2811296.3220; train_gene_expr_recon_loss: 10964602.4545; train_masked_gp_l1_reg_loss: 137957.9792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54524.8174; train_chrom_access_recon_loss: 2485312.4015; train_global_loss: 16554465.0455; train_optim_loss: 16554465.0455; val_kl_reg_loss: 40081.5303; val_edge_recon_loss: 2826421.4062; val_gene_expr_recon_loss: 10901836.8750; val_masked_gp_l1_reg_loss: 137931.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54496.6523; val_chrom_access_recon_loss: 2463912.0938; val_global_loss: 16424679.7500; val_optim_loss: 16424679.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9292; val_auprc_score: 0.9022; val_best_acc_score: 0.8740; val_best_f1_score: 0.8831; train_kl_reg_loss: 100636.4558; train_edge_recon_loss: 2801076.4091; train_gene_expr_recon_loss: 10969419.6515; train_masked_gp_l1_reg_loss: 137916.1773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54483.0597; train_chrom_access_recon_loss: 2487636.7992; train_global_loss: 16551168.5303; train_optim_loss: 16551168.5303; val_kl_reg_loss: 39902.3545; val_edge_recon_loss: 2805333.1250; val_gene_expr_recon_loss: 10913417.6250; val_masked_gp_l1_reg_loss: 137899.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54469.5625; val_chrom_access_recon_loss: 2477311.5000; val_global_loss: 16428333.6250; val_optim_loss: 16428333.6250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9265; val_auprc_score: 0.8935; val_best_acc_score: 0.8673; val_best_f1_score: 0.8753; train_kl_reg_loss: 100310.1839; train_edge_recon_loss: 2787370.8561; train_gene_expr_recon_loss: 10966162.8182; train_masked_gp_l1_reg_loss: 137888.4285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54466.9355; train_chrom_access_recon_loss: 2485479.0682; train_global_loss: 16531678.1818; train_optim_loss: 16531678.1818; val_kl_reg_loss: 40310.8818; val_edge_recon_loss: 2846224.6875; val_gene_expr_recon_loss: 10974707.3750; val_masked_gp_l1_reg_loss: 137876.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54461.3672; val_chrom_access_recon_loss: 2480021.1562; val_global_loss: 16533601.2500; val_optim_loss: 16533601.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9266; val_auprc_score: 0.8965; val_best_acc_score: 0.8694; val_best_f1_score: 0.8773; train_kl_reg_loss: 100139.5591; train_edge_recon_loss: 2819927.3182; train_gene_expr_recon_loss: 10963328.0152; train_masked_gp_l1_reg_loss: 137864.4645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54456.3290; train_chrom_access_recon_loss: 2486500.6629; train_global_loss: 16562216.2424; train_optim_loss: 16562216.2424; val_kl_reg_loss: 40045.2905; val_edge_recon_loss: 2821149.4375; val_gene_expr_recon_loss: 10868877.2500; val_masked_gp_l1_reg_loss: 137851.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54449.0508; val_chrom_access_recon_loss: 2470554.0312; val_global_loss: 16392926.1250; val_optim_loss: 16392926.1250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9206; val_auprc_score: 0.8865; val_best_acc_score: 0.8657; val_best_f1_score: 0.8760; train_kl_reg_loss: 99769.0813; train_edge_recon_loss: 2803039.2614; train_gene_expr_recon_loss: 10977223.1364; train_masked_gp_l1_reg_loss: 137838.4484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54443.8856; train_chrom_access_recon_loss: 2486365.3144; train_global_loss: 16558679.1364; train_optim_loss: 16558679.1364; val_kl_reg_loss: 40386.6226; val_edge_recon_loss: 2820535.4062; val_gene_expr_recon_loss: 10941847.2500; val_masked_gp_l1_reg_loss: 137826.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54442.4531; val_chrom_access_recon_loss: 2463287.7188; val_global_loss: 16458326.3750; val_optim_loss: 16458326.3750
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9202; val_auprc_score: 0.8861; val_best_acc_score: 0.8614; val_best_f1_score: 0.8706; train_kl_reg_loss: 99397.7379; train_edge_recon_loss: 2816220.9129; train_gene_expr_recon_loss: 10962260.3636; train_masked_gp_l1_reg_loss: 137814.9579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54441.9306; train_chrom_access_recon_loss: 2485075.3902; train_global_loss: 16555211.3788; train_optim_loss: 16555211.3788; val_kl_reg_loss: 40737.0703; val_edge_recon_loss: 2848488.7188; val_gene_expr_recon_loss: 10889686.0000; val_masked_gp_l1_reg_loss: 137802.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54438.8828; val_chrom_access_recon_loss: 2445654.5000; val_global_loss: 16416807.3750; val_optim_loss: 16416807.3750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9286; val_auprc_score: 0.9039; val_best_acc_score: 0.8721; val_best_f1_score: 0.8792; train_kl_reg_loss: 99136.7344; train_edge_recon_loss: 2800335.8598; train_gene_expr_recon_loss: 10972524.2121; train_masked_gp_l1_reg_loss: 137790.3830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54442.6238; train_chrom_access_recon_loss: 2486359.3258; train_global_loss: 16550589.1970; train_optim_loss: 16550589.1970; val_kl_reg_loss: 40688.4209; val_edge_recon_loss: 2804489.6875; val_gene_expr_recon_loss: 10895235.7500; val_masked_gp_l1_reg_loss: 137779.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54436.7891; val_chrom_access_recon_loss: 2451499.3125; val_global_loss: 16384130.2500; val_optim_loss: 16384130.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9262; val_auprc_score: 0.8974; val_best_acc_score: 0.8700; val_best_f1_score: 0.8798; train_kl_reg_loss: 98891.5722; train_edge_recon_loss: 2815567.0758; train_gene_expr_recon_loss: 10958898.8485; train_masked_gp_l1_reg_loss: 137764.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54439.7859; train_chrom_access_recon_loss: 2487122.6023; train_global_loss: 16552684.6667; train_optim_loss: 16552684.6667; val_kl_reg_loss: 40718.2861; val_edge_recon_loss: 2791407.7812; val_gene_expr_recon_loss: 10845905.7500; val_masked_gp_l1_reg_loss: 137749.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54442.6250; val_chrom_access_recon_loss: 2463203.1250; val_global_loss: 16333428.1250; val_optim_loss: 16333428.1250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9268; val_auprc_score: 0.8951; val_best_acc_score: 0.8686; val_best_f1_score: 0.8774; train_kl_reg_loss: 98522.5805; train_edge_recon_loss: 2803650.9545; train_gene_expr_recon_loss: 10966069.8939; train_masked_gp_l1_reg_loss: 137738.7188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54439.6685; train_chrom_access_recon_loss: 2486700.6591; train_global_loss: 16547122.5000; train_optim_loss: 16547122.5000; val_kl_reg_loss: 41289.1128; val_edge_recon_loss: 2820890.7500; val_gene_expr_recon_loss: 10973402.8750; val_masked_gp_l1_reg_loss: 137726.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54434.5156; val_chrom_access_recon_loss: 2460511.6562; val_global_loss: 16488255.5000; val_optim_loss: 16488255.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9262; val_auprc_score: 0.8920; val_best_acc_score: 0.8697; val_best_f1_score: 0.8783; train_kl_reg_loss: 98419.9880; train_edge_recon_loss: 2802029.6023; train_gene_expr_recon_loss: 10975822.7273; train_masked_gp_l1_reg_loss: 137714.2192; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54434.9328; train_chrom_access_recon_loss: 2486908.4394; train_global_loss: 16555329.9697; train_optim_loss: 16555329.9697; val_kl_reg_loss: 41235.2812; val_edge_recon_loss: 2793459.4375; val_gene_expr_recon_loss: 10860071.6250; val_masked_gp_l1_reg_loss: 137698.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54426.6602; val_chrom_access_recon_loss: 2455706.5625; val_global_loss: 16342599.1250; val_optim_loss: 16342599.1250
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9250; val_auprc_score: 0.8943; val_best_acc_score: 0.8659; val_best_f1_score: 0.8743; train_kl_reg_loss: 98091.1928; train_edge_recon_loss: 2800646.6553; train_gene_expr_recon_loss: 10960222.3182; train_masked_gp_l1_reg_loss: 137683.6406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54431.0932; train_chrom_access_recon_loss: 2486358.7235; train_global_loss: 16537433.6364; train_optim_loss: 16537433.6364; val_kl_reg_loss: 41314.6138; val_edge_recon_loss: 2822187.5625; val_gene_expr_recon_loss: 10916173.2500; val_masked_gp_l1_reg_loss: 137669.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54429.2422; val_chrom_access_recon_loss: 2444541.1250; val_global_loss: 16416314.8750; val_optim_loss: 16416314.8750
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9272; val_auprc_score: 0.8899; val_best_acc_score: 0.8737; val_best_f1_score: 0.8807; train_kl_reg_loss: 97486.9323; train_edge_recon_loss: 2799793.5152; train_gene_expr_recon_loss: 10971906.3939; train_masked_gp_l1_reg_loss: 137655.7545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54428.9492; train_chrom_access_recon_loss: 2487091.1894; train_global_loss: 16548362.6818; train_optim_loss: 16548362.6818; val_kl_reg_loss: 41218.2285; val_edge_recon_loss: 2791564.0625; val_gene_expr_recon_loss: 10879081.1250; val_masked_gp_l1_reg_loss: 137639.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54429.9102; val_chrom_access_recon_loss: 2462729.6875; val_global_loss: 16366662.0000; val_optim_loss: 16366662.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9248; val_auprc_score: 0.8987; val_best_acc_score: 0.8616; val_best_f1_score: 0.8711; train_kl_reg_loss: 97226.1703; train_edge_recon_loss: 2790022.0644; train_gene_expr_recon_loss: 10961525.1364; train_masked_gp_l1_reg_loss: 137608.9157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54296.4360; train_chrom_access_recon_loss: 2484923.8030; train_global_loss: 16525602.6212; train_optim_loss: 16525602.6212; val_kl_reg_loss: 41147.4863; val_edge_recon_loss: 2866728.6250; val_gene_expr_recon_loss: 10916153.7500; val_masked_gp_l1_reg_loss: 137597.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54268.5781; val_chrom_access_recon_loss: 2481023.6250; val_global_loss: 16496920.3750; val_optim_loss: 16496920.3750
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9232; val_auprc_score: 0.8911; val_best_acc_score: 0.8667; val_best_f1_score: 0.8752; train_kl_reg_loss: 97435.2315; train_edge_recon_loss: 2803743.4811; train_gene_expr_recon_loss: 10965702.7121; train_masked_gp_l1_reg_loss: 137594.2611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54264.6520; train_chrom_access_recon_loss: 2486028.8788; train_global_loss: 16544769.2121; train_optim_loss: 16544769.2121; val_kl_reg_loss: 41591.0405; val_edge_recon_loss: 2827732.8125; val_gene_expr_recon_loss: 11022298.1250; val_masked_gp_l1_reg_loss: 137590.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54262.3984; val_chrom_access_recon_loss: 2502655.3438; val_global_loss: 16586129.8750; val_optim_loss: 16586129.8750
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9286; val_auprc_score: 0.9022; val_best_acc_score: 0.8710; val_best_f1_score: 0.8791; train_kl_reg_loss: 97308.3378; train_edge_recon_loss: 2804429.1364; train_gene_expr_recon_loss: 10971155.7576; train_masked_gp_l1_reg_loss: 137588.3610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54260.4920; train_chrom_access_recon_loss: 2485762.3258; train_global_loss: 16550504.5303; train_optim_loss: 16550504.5303; val_kl_reg_loss: 41476.8223; val_edge_recon_loss: 2805784.0312; val_gene_expr_recon_loss: 10975619.2500; val_masked_gp_l1_reg_loss: 137585.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54259.0898; val_chrom_access_recon_loss: 2442525.8125; val_global_loss: 16457250.8750; val_optim_loss: 16457250.8750
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9222; val_auprc_score: 0.8883; val_best_acc_score: 0.8598; val_best_f1_score: 0.8697; train_kl_reg_loss: 97303.0136; train_edge_recon_loss: 2799478.9545; train_gene_expr_recon_loss: 10970084.3939; train_masked_gp_l1_reg_loss: 137583.4446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54258.3430; train_chrom_access_recon_loss: 2488007.7083; train_global_loss: 16546715.9242; train_optim_loss: 16546715.9242; val_kl_reg_loss: 41322.3984; val_edge_recon_loss: 2834955.6562; val_gene_expr_recon_loss: 10968937.2500; val_masked_gp_l1_reg_loss: 137581.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54257.6289; val_chrom_access_recon_loss: 2462883.0625; val_global_loss: 16499937.3750; val_optim_loss: 16499937.3750

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 8 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9285
val AUPRC score: 0.8989
val best accuracy score: 0.8697
val best F1 score: 0.8776
val target rna MSE score: 2.1663
val source rna MSE score: 1.2145
val target atac MSE score: 0.4691
val source atac MSE score: 0.2003
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
