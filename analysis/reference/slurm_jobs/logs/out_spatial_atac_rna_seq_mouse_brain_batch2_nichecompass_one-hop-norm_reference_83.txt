[True]
Run timestamp: 10102023_001534_83.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_83']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7086; val_auprc_score: 0.6782; val_best_acc_score: 0.5185; val_best_f1_score: 0.6742; train_kl_reg_loss: 45397.0574; train_edge_recon_loss: 3502278.8409; train_gene_expr_recon_loss: 13935239.3182; train_masked_gp_l1_reg_loss: 31834.9926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3666097.8598; train_chrom_access_recon_loss: 2971563.2197; train_global_loss: 24152411.1212; train_optim_loss: 24152411.1212; val_kl_reg_loss: 96850.1680; val_edge_recon_loss: 4064127.0938; val_gene_expr_recon_loss: 13058506.6250; val_masked_gp_l1_reg_loss: 37516.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2056349.3750; val_chrom_access_recon_loss: 2898863.4688; val_global_loss: 22212213.2500; val_optim_loss: 22212213.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7204; val_auprc_score: 0.6985; val_best_acc_score: 0.6660; val_best_f1_score: 0.6923; train_kl_reg_loss: 86913.9192; train_edge_recon_loss: 3510673.9129; train_gene_expr_recon_loss: 12826151.8636; train_masked_gp_l1_reg_loss: 38933.9664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1132154.6430; train_chrom_access_recon_loss: 2824325.8636; train_global_loss: 20419154.2424; train_optim_loss: 20419154.2424; val_kl_reg_loss: 93550.8721; val_edge_recon_loss: 4041487.7500; val_gene_expr_recon_loss: 12819451.6250; val_masked_gp_l1_reg_loss: 40483.5898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 552599.6875; val_chrom_access_recon_loss: 2864645.1875; val_global_loss: 20412219.5000; val_optim_loss: 20412219.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7597; val_auprc_score: 0.7448; val_best_acc_score: 0.6835; val_best_f1_score: 0.7278; train_kl_reg_loss: 73848.0078; train_edge_recon_loss: 3472719.1629; train_gene_expr_recon_loss: 12687891.9848; train_masked_gp_l1_reg_loss: 42016.8699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 367741.4032; train_chrom_access_recon_loss: 2804283.7955; train_global_loss: 19448501.3939; train_optim_loss: 19448501.3939; val_kl_reg_loss: 53597.2637; val_edge_recon_loss: 3488063.2812; val_gene_expr_recon_loss: 12769235.0000; val_masked_gp_l1_reg_loss: 44037.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 249956.1406; val_chrom_access_recon_loss: 2834779.5312; val_global_loss: 19439669.0000; val_optim_loss: 19439669.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7722; val_auprc_score: 0.7572; val_best_acc_score: 0.6900; val_best_f1_score: 0.7360; train_kl_reg_loss: 80124.7509; train_edge_recon_loss: 3175051.3295; train_gene_expr_recon_loss: 12645479.3939; train_masked_gp_l1_reg_loss: 46224.5269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197561.1160; train_chrom_access_recon_loss: 2795056.2311; train_global_loss: 18939497.3939; train_optim_loss: 18939497.3939; val_kl_reg_loss: 91199.0635; val_edge_recon_loss: 3198395.5938; val_gene_expr_recon_loss: 12833523.8750; val_masked_gp_l1_reg_loss: 47866.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158919.5781; val_chrom_access_recon_loss: 2856459.4688; val_global_loss: 19186364.7500; val_optim_loss: 19186364.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7982; val_auprc_score: 0.7877; val_best_acc_score: 0.7063; val_best_f1_score: 0.7481; train_kl_reg_loss: 87287.8577; train_edge_recon_loss: 3090179.6174; train_gene_expr_recon_loss: 12543670.1667; train_masked_gp_l1_reg_loss: 49257.3357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138908.8903; train_chrom_access_recon_loss: 2773973.3409; train_global_loss: 18683277.2121; train_optim_loss: 18683277.2121; val_kl_reg_loss: 80722.1982; val_edge_recon_loss: 3168112.8125; val_gene_expr_recon_loss: 12719939.5000; val_masked_gp_l1_reg_loss: 50727.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123158.1641; val_chrom_access_recon_loss: 2832531.2812; val_global_loss: 18975191.7500; val_optim_loss: 18975191.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8173; val_auprc_score: 0.8098; val_best_acc_score: 0.7303; val_best_f1_score: 0.7523; train_kl_reg_loss: 88834.8817; train_edge_recon_loss: 3043957.8788; train_gene_expr_recon_loss: 12461415.1970; train_masked_gp_l1_reg_loss: 52153.1225; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113625.7501; train_chrom_access_recon_loss: 2759173.6894; train_global_loss: 18519160.4242; train_optim_loss: 18519160.4242; val_kl_reg_loss: 80625.7041; val_edge_recon_loss: 3104233.9688; val_gene_expr_recon_loss: 12517698.7500; val_masked_gp_l1_reg_loss: 53434.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107092.6016; val_chrom_access_recon_loss: 2825756.0000; val_global_loss: 18688842.7500; val_optim_loss: 18688842.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8848; val_auprc_score: 0.8566; val_best_acc_score: 0.8141; val_best_f1_score: 0.8298; train_kl_reg_loss: 86202.7051; train_edge_recon_loss: 2917948.0114; train_gene_expr_recon_loss: 12393139.9545; train_masked_gp_l1_reg_loss: 55107.4112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106726.7283; train_chrom_access_recon_loss: 2750066.1591; train_global_loss: 18309190.8182; train_optim_loss: 18309190.8182; val_kl_reg_loss: 96832.1123; val_edge_recon_loss: 2889522.4688; val_gene_expr_recon_loss: 12643179.8750; val_masked_gp_l1_reg_loss: 56810.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106294.1719; val_chrom_access_recon_loss: 2817214.4688; val_global_loss: 18609854.0000; val_optim_loss: 18609854.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8864; val_auprc_score: 0.8520; val_best_acc_score: 0.8127; val_best_f1_score: 0.8314; train_kl_reg_loss: 95423.8198; train_edge_recon_loss: 2811772.6023; train_gene_expr_recon_loss: 12308959.6061; train_masked_gp_l1_reg_loss: 58086.5392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102767.2378; train_chrom_access_recon_loss: 2734075.1212; train_global_loss: 18111084.9091; train_optim_loss: 18111084.9091; val_kl_reg_loss: 98864.2568; val_edge_recon_loss: 2913696.8750; val_gene_expr_recon_loss: 12353476.2500; val_masked_gp_l1_reg_loss: 59284.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99630.3281; val_chrom_access_recon_loss: 2779040.9062; val_global_loss: 18303993.2500; val_optim_loss: 18303993.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9115; val_auprc_score: 0.8851; val_best_acc_score: 0.8477; val_best_f1_score: 0.8581; train_kl_reg_loss: 95479.2670; train_edge_recon_loss: 2797682.9659; train_gene_expr_recon_loss: 12244480.9394; train_masked_gp_l1_reg_loss: 60204.2525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95990.7393; train_chrom_access_recon_loss: 2721618.3409; train_global_loss: 18015456.5152; train_optim_loss: 18015456.5152; val_kl_reg_loss: 92795.0479; val_edge_recon_loss: 2825462.1875; val_gene_expr_recon_loss: 12480486.6250; val_masked_gp_l1_reg_loss: 61251.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93018.9453; val_chrom_access_recon_loss: 2793208.8125; val_global_loss: 18346223.2500; val_optim_loss: 18346223.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9046; val_auprc_score: 0.8708; val_best_acc_score: 0.8463; val_best_f1_score: 0.8596; train_kl_reg_loss: 93230.6358; train_edge_recon_loss: 2790264.7917; train_gene_expr_recon_loss: 12181474.8485; train_masked_gp_l1_reg_loss: 62154.1996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90379.1942; train_chrom_access_recon_loss: 2709505.5644; train_global_loss: 17927009.3939; train_optim_loss: 17927009.3939; val_kl_reg_loss: 94234.2988; val_edge_recon_loss: 2809555.7500; val_gene_expr_recon_loss: 12306613.0000; val_masked_gp_l1_reg_loss: 62889.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88148.6172; val_chrom_access_recon_loss: 2765668.3438; val_global_loss: 18127110.2500; val_optim_loss: 18127110.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8994; val_auprc_score: 0.8589; val_best_acc_score: 0.8455; val_best_f1_score: 0.8560; train_kl_reg_loss: 90727.9656; train_edge_recon_loss: 2793699.6780; train_gene_expr_recon_loss: 12146631.6061; train_masked_gp_l1_reg_loss: 63713.3189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86541.1591; train_chrom_access_recon_loss: 2703385.7727; train_global_loss: 17884699.5758; train_optim_loss: 17884699.5758; val_kl_reg_loss: 90309.9746; val_edge_recon_loss: 2852346.0312; val_gene_expr_recon_loss: 12213985.1250; val_masked_gp_l1_reg_loss: 64498.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84749.5625; val_chrom_access_recon_loss: 2743306.2812; val_global_loss: 18049195.2500; val_optim_loss: 18049195.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9035; val_auprc_score: 0.8698; val_best_acc_score: 0.8447; val_best_f1_score: 0.8553; train_kl_reg_loss: 87410.9930; train_edge_recon_loss: 2788074.1932; train_gene_expr_recon_loss: 12094405.2424; train_masked_gp_l1_reg_loss: 65234.3269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83295.3370; train_chrom_access_recon_loss: 2695412.0038; train_global_loss: 17813832.1515; train_optim_loss: 17813832.1515; val_kl_reg_loss: 84405.6240; val_edge_recon_loss: 2852904.0312; val_gene_expr_recon_loss: 12345862.5000; val_masked_gp_l1_reg_loss: 65838.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82052.7500; val_chrom_access_recon_loss: 2790460.6875; val_global_loss: 18221524.5000; val_optim_loss: 18221524.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9158; val_auprc_score: 0.8810; val_best_acc_score: 0.8571; val_best_f1_score: 0.8673; train_kl_reg_loss: 87410.2397; train_edge_recon_loss: 2790016.5000; train_gene_expr_recon_loss: 12063606.4242; train_masked_gp_l1_reg_loss: 66485.8790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80630.2275; train_chrom_access_recon_loss: 2687650.0152; train_global_loss: 17775799.3333; train_optim_loss: 17775799.3333; val_kl_reg_loss: 87075.2441; val_edge_recon_loss: 2789591.0000; val_gene_expr_recon_loss: 12270566.0000; val_masked_gp_l1_reg_loss: 67145.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79637.2500; val_chrom_access_recon_loss: 2756221.9688; val_global_loss: 18050237.0000; val_optim_loss: 18050237.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9109; val_auprc_score: 0.8773; val_best_acc_score: 0.8498; val_best_f1_score: 0.8616; train_kl_reg_loss: 84343.7966; train_edge_recon_loss: 2780341.1970; train_gene_expr_recon_loss: 12008977.4242; train_masked_gp_l1_reg_loss: 67629.0510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78799.5361; train_chrom_access_recon_loss: 2675608.6780; train_global_loss: 17695699.6970; train_optim_loss: 17695699.6970; val_kl_reg_loss: 87944.5352; val_edge_recon_loss: 2793941.6875; val_gene_expr_recon_loss: 12261891.2500; val_masked_gp_l1_reg_loss: 68263.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78070.5234; val_chrom_access_recon_loss: 2736203.6562; val_global_loss: 18026315.0000; val_optim_loss: 18026315.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9158; val_auprc_score: 0.8808; val_best_acc_score: 0.8614; val_best_f1_score: 0.8701; train_kl_reg_loss: 83612.1973; train_edge_recon_loss: 2769524.0833; train_gene_expr_recon_loss: 11981115.9394; train_masked_gp_l1_reg_loss: 68706.4344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77279.0649; train_chrom_access_recon_loss: 2668191.8258; train_global_loss: 17648429.5758; train_optim_loss: 17648429.5758; val_kl_reg_loss: 84309.0518; val_edge_recon_loss: 2801724.5938; val_gene_expr_recon_loss: 12073760.1250; val_masked_gp_l1_reg_loss: 69303.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76943.5391; val_chrom_access_recon_loss: 2716020.2812; val_global_loss: 17822062.2500; val_optim_loss: 17822062.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9216; val_auprc_score: 0.8978; val_best_acc_score: 0.8608; val_best_f1_score: 0.8708; train_kl_reg_loss: 82904.9382; train_edge_recon_loss: 2761676.5568; train_gene_expr_recon_loss: 11947729.1061; train_masked_gp_l1_reg_loss: 69706.5755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76418.3660; train_chrom_access_recon_loss: 2662640.2273; train_global_loss: 17601075.7879; train_optim_loss: 17601075.7879; val_kl_reg_loss: 82680.6445; val_edge_recon_loss: 2808854.0625; val_gene_expr_recon_loss: 12046479.8750; val_masked_gp_l1_reg_loss: 70229.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76614.1641; val_chrom_access_recon_loss: 2709332.2500; val_global_loss: 17794191.2500; val_optim_loss: 17794191.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9228; val_auprc_score: 0.8956; val_best_acc_score: 0.8678; val_best_f1_score: 0.8779; train_kl_reg_loss: 82167.2630; train_edge_recon_loss: 2748986.1705; train_gene_expr_recon_loss: 11909259.3030; train_masked_gp_l1_reg_loss: 70667.2209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76106.6384; train_chrom_access_recon_loss: 2656469.0720; train_global_loss: 17543655.6667; train_optim_loss: 17543655.6667; val_kl_reg_loss: 83415.6367; val_edge_recon_loss: 2743839.4688; val_gene_expr_recon_loss: 12053430.0000; val_masked_gp_l1_reg_loss: 71210.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77050.6953; val_chrom_access_recon_loss: 2698067.5000; val_global_loss: 17727013.5000; val_optim_loss: 17727013.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9180; val_auprc_score: 0.8904; val_best_acc_score: 0.8565; val_best_f1_score: 0.8681; train_kl_reg_loss: 80803.9447; train_edge_recon_loss: 2748683.3826; train_gene_expr_recon_loss: 11884395.7424; train_masked_gp_l1_reg_loss: 71534.1928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76516.3293; train_chrom_access_recon_loss: 2649304.5985; train_global_loss: 17511238.1818; train_optim_loss: 17511238.1818; val_kl_reg_loss: 79642.4697; val_edge_recon_loss: 2807189.5000; val_gene_expr_recon_loss: 11925474.7500; val_masked_gp_l1_reg_loss: 72053.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76848.1562; val_chrom_access_recon_loss: 2680596.5000; val_global_loss: 17641804.2500; val_optim_loss: 17641804.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9259; val_auprc_score: 0.8995; val_best_acc_score: 0.8675; val_best_f1_score: 0.8760; train_kl_reg_loss: 82022.3978; train_edge_recon_loss: 2745912.2955; train_gene_expr_recon_loss: 11852176.4545; train_masked_gp_l1_reg_loss: 72310.3149; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76453.9833; train_chrom_access_recon_loss: 2641853.3939; train_global_loss: 17470728.7879; train_optim_loss: 17470728.7879; val_kl_reg_loss: 78041.4824; val_edge_recon_loss: 2773980.0000; val_gene_expr_recon_loss: 11919847.8750; val_masked_gp_l1_reg_loss: 72686.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76505.3750; val_chrom_access_recon_loss: 2687049.0000; val_global_loss: 17608110.0000; val_optim_loss: 17608110.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9228; val_auprc_score: 0.8957; val_best_acc_score: 0.8697; val_best_f1_score: 0.8784; train_kl_reg_loss: 79763.5115; train_edge_recon_loss: 2749715.2424; train_gene_expr_recon_loss: 11822595.6667; train_masked_gp_l1_reg_loss: 72911.6231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76389.5249; train_chrom_access_recon_loss: 2636991.7803; train_global_loss: 17438367.3485; train_optim_loss: 17438367.3485; val_kl_reg_loss: 80336.8711; val_edge_recon_loss: 2754634.3750; val_gene_expr_recon_loss: 11825101.5000; val_masked_gp_l1_reg_loss: 73291.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76403.3125; val_chrom_access_recon_loss: 2666396.6875; val_global_loss: 17476163.2500; val_optim_loss: 17476163.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9297; val_auprc_score: 0.9018; val_best_acc_score: 0.8767; val_best_f1_score: 0.8856; train_kl_reg_loss: 78426.0610; train_edge_recon_loss: 2741925.6326; train_gene_expr_recon_loss: 11792266.6364; train_masked_gp_l1_reg_loss: 73547.8598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76556.0824; train_chrom_access_recon_loss: 2629569.3712; train_global_loss: 17392291.5909; train_optim_loss: 17392291.5909; val_kl_reg_loss: 79537.2959; val_edge_recon_loss: 2758856.0938; val_gene_expr_recon_loss: 11877042.2500; val_masked_gp_l1_reg_loss: 73935.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76419.9531; val_chrom_access_recon_loss: 2668069.4062; val_global_loss: 17533860.5000; val_optim_loss: 17533860.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9281; val_auprc_score: 0.9029; val_best_acc_score: 0.8724; val_best_f1_score: 0.8804; train_kl_reg_loss: 79169.0958; train_edge_recon_loss: 2736865.2348; train_gene_expr_recon_loss: 11771460.4697; train_masked_gp_l1_reg_loss: 74142.0961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76277.2180; train_chrom_access_recon_loss: 2625667.2955; train_global_loss: 17363581.3182; train_optim_loss: 17363581.3182; val_kl_reg_loss: 79344.5400; val_edge_recon_loss: 2775734.0625; val_gene_expr_recon_loss: 11755264.2500; val_masked_gp_l1_reg_loss: 74483.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76035.4141; val_chrom_access_recon_loss: 2645600.3750; val_global_loss: 17406461.0000; val_optim_loss: 17406461.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9302; val_auprc_score: 0.9057; val_best_acc_score: 0.8697; val_best_f1_score: 0.8778; train_kl_reg_loss: 78666.4665; train_edge_recon_loss: 2721745.2159; train_gene_expr_recon_loss: 11742765.3485; train_masked_gp_l1_reg_loss: 74653.2672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75908.5243; train_chrom_access_recon_loss: 2618725.4508; train_global_loss: 17312464.0606; train_optim_loss: 17312464.0606; val_kl_reg_loss: 76740.7969; val_edge_recon_loss: 2787208.5938; val_gene_expr_recon_loss: 11778214.5000; val_masked_gp_l1_reg_loss: 74908.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76279.3125; val_chrom_access_recon_loss: 2647576.9062; val_global_loss: 17440928.1250; val_optim_loss: 17440928.1250
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9257; val_auprc_score: 0.8953; val_best_acc_score: 0.8718; val_best_f1_score: 0.8800; train_kl_reg_loss: 78129.5743; train_edge_recon_loss: 2725838.6629; train_gene_expr_recon_loss: 11713642.5152; train_masked_gp_l1_reg_loss: 75150.8053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75496.2218; train_chrom_access_recon_loss: 2611699.5152; train_global_loss: 17279957.4091; train_optim_loss: 17279957.4091; val_kl_reg_loss: 78564.9033; val_edge_recon_loss: 2780920.0312; val_gene_expr_recon_loss: 11735273.7500; val_masked_gp_l1_reg_loss: 75457.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75592.7422; val_chrom_access_recon_loss: 2637001.9375; val_global_loss: 17382811.0000; val_optim_loss: 17382811.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9327; val_auprc_score: 0.9042; val_best_acc_score: 0.8791; val_best_f1_score: 0.8847; train_kl_reg_loss: 78490.4960; train_edge_recon_loss: 2723659.8485; train_gene_expr_recon_loss: 11700714.6667; train_masked_gp_l1_reg_loss: 75681.0561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75117.8704; train_chrom_access_recon_loss: 2607794.2765; train_global_loss: 17261458.3030; train_optim_loss: 17261458.3030; val_kl_reg_loss: 80425.2002; val_edge_recon_loss: 2786171.0312; val_gene_expr_recon_loss: 11749174.5000; val_masked_gp_l1_reg_loss: 75884.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75030.8906; val_chrom_access_recon_loss: 2640022.4375; val_global_loss: 17406709.2500; val_optim_loss: 17406709.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9419; val_auprc_score: 0.9213; val_best_acc_score: 0.8821; val_best_f1_score: 0.8896; train_kl_reg_loss: 78019.0011; train_edge_recon_loss: 2711807.4697; train_gene_expr_recon_loss: 11681189.0758; train_masked_gp_l1_reg_loss: 76136.1925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74534.7610; train_chrom_access_recon_loss: 2602756.0114; train_global_loss: 17224442.4091; train_optim_loss: 17224442.4091; val_kl_reg_loss: 80193.3711; val_edge_recon_loss: 2743543.9062; val_gene_expr_recon_loss: 11804054.5000; val_masked_gp_l1_reg_loss: 76359.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74267.8516; val_chrom_access_recon_loss: 2662924.0000; val_global_loss: 17441343.0000; val_optim_loss: 17441343.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9419; val_auprc_score: 0.9203; val_best_acc_score: 0.8874; val_best_f1_score: 0.8945; train_kl_reg_loss: 75897.8242; train_edge_recon_loss: 2717890.8220; train_gene_expr_recon_loss: 11654757.3788; train_masked_gp_l1_reg_loss: 76508.0272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74140.7907; train_chrom_access_recon_loss: 2595824.7008; train_global_loss: 17195019.5606; train_optim_loss: 17195019.5606; val_kl_reg_loss: 77970.3066; val_edge_recon_loss: 2725122.0000; val_gene_expr_recon_loss: 11804303.1250; val_masked_gp_l1_reg_loss: 76872.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74172.6719; val_chrom_access_recon_loss: 2651135.4375; val_global_loss: 17409577.0000; val_optim_loss: 17409577.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9458; val_auprc_score: 0.9252; val_best_acc_score: 0.8923; val_best_f1_score: 0.8977; train_kl_reg_loss: 75568.8254; train_edge_recon_loss: 2715863.3371; train_gene_expr_recon_loss: 11648736.7121; train_masked_gp_l1_reg_loss: 77024.1119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73677.1927; train_chrom_access_recon_loss: 2595511.8295; train_global_loss: 17186382.3788; train_optim_loss: 17186382.3788; val_kl_reg_loss: 74665.1543; val_edge_recon_loss: 2732806.0000; val_gene_expr_recon_loss: 11679165.5000; val_masked_gp_l1_reg_loss: 77320.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73681.0234; val_chrom_access_recon_loss: 2620003.0938; val_global_loss: 17257641.6250; val_optim_loss: 17257641.6250
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9484; val_auprc_score: 0.9279; val_best_acc_score: 0.8915; val_best_f1_score: 0.8971; train_kl_reg_loss: 75640.7526; train_edge_recon_loss: 2711947.5909; train_gene_expr_recon_loss: 11627951.8636; train_masked_gp_l1_reg_loss: 77485.4575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73320.3189; train_chrom_access_recon_loss: 2587671.7652; train_global_loss: 17154017.8636; train_optim_loss: 17154017.8636; val_kl_reg_loss: 77050.7607; val_edge_recon_loss: 2712687.1562; val_gene_expr_recon_loss: 11782592.8750; val_masked_gp_l1_reg_loss: 77750.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73213.8906; val_chrom_access_recon_loss: 2614180.6875; val_global_loss: 17337475.5000; val_optim_loss: 17337475.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9444; val_auprc_score: 0.9247; val_best_acc_score: 0.8874; val_best_f1_score: 0.8935; train_kl_reg_loss: 76002.6506; train_edge_recon_loss: 2696711.2386; train_gene_expr_recon_loss: 11609212.2273; train_masked_gp_l1_reg_loss: 77889.3646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72708.9004; train_chrom_access_recon_loss: 2585595.1932; train_global_loss: 17118119.4697; train_optim_loss: 17118119.4697; val_kl_reg_loss: 78204.8691; val_edge_recon_loss: 2762048.4062; val_gene_expr_recon_loss: 11764921.6250; val_masked_gp_l1_reg_loss: 78021.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72757.4688; val_chrom_access_recon_loss: 2635851.5312; val_global_loss: 17391805.5000; val_optim_loss: 17391805.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9501; val_auprc_score: 0.9308; val_best_acc_score: 0.8944; val_best_f1_score: 0.9011; train_kl_reg_loss: 74925.2953; train_edge_recon_loss: 2708928.7386; train_gene_expr_recon_loss: 11588029.3939; train_masked_gp_l1_reg_loss: 78183.9693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72416.8662; train_chrom_access_recon_loss: 2577485.9508; train_global_loss: 17099970.2424; train_optim_loss: 17099970.2424; val_kl_reg_loss: 77697.6689; val_edge_recon_loss: 2709373.5000; val_gene_expr_recon_loss: 11708991.2500; val_masked_gp_l1_reg_loss: 78380.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72342.5781; val_chrom_access_recon_loss: 2620313.7500; val_global_loss: 17267099.2500; val_optim_loss: 17267099.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9543; val_auprc_score: 0.9372; val_best_acc_score: 0.9062; val_best_f1_score: 0.9114; train_kl_reg_loss: 75544.8705; train_edge_recon_loss: 2701516.8712; train_gene_expr_recon_loss: 11571121.8030; train_masked_gp_l1_reg_loss: 78360.6744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71781.7996; train_chrom_access_recon_loss: 2574444.9318; train_global_loss: 17072771.1061; train_optim_loss: 17072771.1061; val_kl_reg_loss: 73497.3350; val_edge_recon_loss: 2708799.1250; val_gene_expr_recon_loss: 11826523.5000; val_masked_gp_l1_reg_loss: 78531.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71691.7266; val_chrom_access_recon_loss: 2632188.2188; val_global_loss: 17391232.2500; val_optim_loss: 17391232.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9519; val_auprc_score: 0.9329; val_best_acc_score: 0.9033; val_best_f1_score: 0.9088; train_kl_reg_loss: 73782.6541; train_edge_recon_loss: 2695847.6212; train_gene_expr_recon_loss: 11554783.1061; train_masked_gp_l1_reg_loss: 77891.3562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58602.9242; train_chrom_access_recon_loss: 2566666.4205; train_global_loss: 17027573.9848; train_optim_loss: 17027573.9848; val_kl_reg_loss: 76135.5098; val_edge_recon_loss: 2702440.5000; val_gene_expr_recon_loss: 11656889.1250; val_masked_gp_l1_reg_loss: 77562.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55311.2578; val_chrom_access_recon_loss: 2649643.1250; val_global_loss: 17217982.5000; val_optim_loss: 17217982.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9506; val_auprc_score: 0.9297; val_best_acc_score: 0.9054; val_best_f1_score: 0.9095; train_kl_reg_loss: 75988.3155; train_edge_recon_loss: 2702794.6780; train_gene_expr_recon_loss: 11545490.2879; train_masked_gp_l1_reg_loss: 77501.8645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54833.3419; train_chrom_access_recon_loss: 2565268.9773; train_global_loss: 17021877.4242; train_optim_loss: 17021877.4242; val_kl_reg_loss: 77744.5186; val_edge_recon_loss: 2717060.0938; val_gene_expr_recon_loss: 11587419.3750; val_masked_gp_l1_reg_loss: 77475.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54526.9258; val_chrom_access_recon_loss: 2616813.0938; val_global_loss: 17131039.1250; val_optim_loss: 17131039.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9451; val_auprc_score: 0.9222; val_best_acc_score: 0.8982; val_best_f1_score: 0.9045; train_kl_reg_loss: 76692.8063; train_edge_recon_loss: 2696727.2273; train_gene_expr_recon_loss: 11544680.8636; train_masked_gp_l1_reg_loss: 77462.8485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54262.0577; train_chrom_access_recon_loss: 2564811.1932; train_global_loss: 17014636.8788; train_optim_loss: 17014636.8788; val_kl_reg_loss: 76887.4014; val_edge_recon_loss: 2723280.4062; val_gene_expr_recon_loss: 11732253.1250; val_masked_gp_l1_reg_loss: 77463.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54060.0312; val_chrom_access_recon_loss: 2627677.7188; val_global_loss: 17291623.0000; val_optim_loss: 17291623.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9464; val_auprc_score: 0.9250; val_best_acc_score: 0.8933; val_best_f1_score: 0.9006; train_kl_reg_loss: 76337.3802; train_edge_recon_loss: 2693336.5644; train_gene_expr_recon_loss: 11544578.5758; train_masked_gp_l1_reg_loss: 77477.4231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53933.5391; train_chrom_access_recon_loss: 2563753.7311; train_global_loss: 17009417.1818; train_optim_loss: 17009417.1818; val_kl_reg_loss: 78290.5957; val_edge_recon_loss: 2746195.2812; val_gene_expr_recon_loss: 11668934.7500; val_masked_gp_l1_reg_loss: 77486.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53775.8359; val_chrom_access_recon_loss: 2622048.0000; val_global_loss: 17246730.5000; val_optim_loss: 17246730.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9494; val_auprc_score: 0.9322; val_best_acc_score: 0.8966; val_best_f1_score: 0.9029; train_kl_reg_loss: 76833.3361; train_edge_recon_loss: 2692421.0530; train_gene_expr_recon_loss: 11544737.7879; train_masked_gp_l1_reg_loss: 77506.4890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53675.4731; train_chrom_access_recon_loss: 2562777.9091; train_global_loss: 17007952.1061; train_optim_loss: 17007952.1061; val_kl_reg_loss: 77852.3232; val_edge_recon_loss: 2736709.4375; val_gene_expr_recon_loss: 11705224.2500; val_masked_gp_l1_reg_loss: 77515.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53536.2227; val_chrom_access_recon_loss: 2617233.4375; val_global_loss: 17268070.6250; val_optim_loss: 17268070.6250
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9518; val_auprc_score: 0.9356; val_best_acc_score: 0.8976; val_best_f1_score: 0.9029; train_kl_reg_loss: 76807.1580; train_edge_recon_loss: 2686641.5871; train_gene_expr_recon_loss: 11532807.2879; train_masked_gp_l1_reg_loss: 77521.0843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53416.1344; train_chrom_access_recon_loss: 2561949.5871; train_global_loss: 16989142.7727; train_optim_loss: 16989142.7727; val_kl_reg_loss: 78150.7031; val_edge_recon_loss: 2736341.2500; val_gene_expr_recon_loss: 11618400.1250; val_masked_gp_l1_reg_loss: 77529.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53349.3594; val_chrom_access_recon_loss: 2588810.2500; val_global_loss: 17152581.6250; val_optim_loss: 17152581.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9468; val_auprc_score: 0.9210; val_best_acc_score: 0.8987; val_best_f1_score: 0.9045; train_kl_reg_loss: 76820.8192; train_edge_recon_loss: 2692577.6553; train_gene_expr_recon_loss: 11544690.0000; train_masked_gp_l1_reg_loss: 77463.7518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52071.8307; train_chrom_access_recon_loss: 2563295.9091; train_global_loss: 17006920.0303; train_optim_loss: 17006920.0303; val_kl_reg_loss: 77980.7607; val_edge_recon_loss: 2732648.6875; val_gene_expr_recon_loss: 11538757.6250; val_masked_gp_l1_reg_loss: 77427.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51755.8555; val_chrom_access_recon_loss: 2593036.7500; val_global_loss: 17071607.1250; val_optim_loss: 17071607.1250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9507; val_auprc_score: 0.9267; val_best_acc_score: 0.8974; val_best_f1_score: 0.9031; train_kl_reg_loss: 76897.5986; train_edge_recon_loss: 2699341.1136; train_gene_expr_recon_loss: 11539892.9848; train_masked_gp_l1_reg_loss: 77417.8952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51708.4848; train_chrom_access_recon_loss: 2564135.1742; train_global_loss: 17009393.3636; train_optim_loss: 17009393.3636; val_kl_reg_loss: 78368.5508; val_edge_recon_loss: 2739072.0625; val_gene_expr_recon_loss: 11694177.1250; val_masked_gp_l1_reg_loss: 77410.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51668.6328; val_chrom_access_recon_loss: 2612314.5000; val_global_loss: 17253011.1250; val_optim_loss: 17253011.1250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9532; val_auprc_score: 0.9291; val_best_acc_score: 0.9030; val_best_f1_score: 0.9080; train_kl_reg_loss: 76878.5204; train_edge_recon_loss: 2701794.6932; train_gene_expr_recon_loss: 11545030.3939; train_masked_gp_l1_reg_loss: 77408.2589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51642.8393; train_chrom_access_recon_loss: 2564649.3902; train_global_loss: 17017404.0152; train_optim_loss: 17017404.0152; val_kl_reg_loss: 78470.1104; val_edge_recon_loss: 2714590.3125; val_gene_expr_recon_loss: 11695494.1250; val_masked_gp_l1_reg_loss: 77404.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51616.6836; val_chrom_access_recon_loss: 2643508.8750; val_global_loss: 17261085.5000; val_optim_loss: 17261085.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9540; val_auprc_score: 0.9366; val_best_acc_score: 0.8984; val_best_f1_score: 0.9032; train_kl_reg_loss: 76889.4214; train_edge_recon_loss: 2693221.8333; train_gene_expr_recon_loss: 11532009.3939; train_masked_gp_l1_reg_loss: 77404.3603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51593.5753; train_chrom_access_recon_loss: 2558670.3939; train_global_loss: 16989788.9697; train_optim_loss: 16989788.9697; val_kl_reg_loss: 77598.0264; val_edge_recon_loss: 2721980.4688; val_gene_expr_recon_loss: 11794630.6250; val_masked_gp_l1_reg_loss: 77404.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51574.0820; val_chrom_access_recon_loss: 2636595.5938; val_global_loss: 17359783.7500; val_optim_loss: 17359783.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9518; val_auprc_score: 0.9308; val_best_acc_score: 0.8944; val_best_f1_score: 0.9006; train_kl_reg_loss: 76784.4447; train_edge_recon_loss: 2697788.8220; train_gene_expr_recon_loss: 11539494.7424; train_masked_gp_l1_reg_loss: 77404.5835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51558.9781; train_chrom_access_recon_loss: 2561306.9205; train_global_loss: 17004338.5909; train_optim_loss: 17004338.5909; val_kl_reg_loss: 78051.4307; val_edge_recon_loss: 2729971.0000; val_gene_expr_recon_loss: 11703027.3750; val_masked_gp_l1_reg_loss: 77405.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51541.1953; val_chrom_access_recon_loss: 2630715.0000; val_global_loss: 17270710.7500; val_optim_loss: 17270710.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9472; val_auprc_score: 0.9210; val_best_acc_score: 0.8963; val_best_f1_score: 0.9022; train_kl_reg_loss: 76683.0163; train_edge_recon_loss: 2692958.0682; train_gene_expr_recon_loss: 11544124.5758; train_masked_gp_l1_reg_loss: 77398.3042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51414.2305; train_chrom_access_recon_loss: 2563105.2992; train_global_loss: 17005683.5303; train_optim_loss: 17005683.5303; val_kl_reg_loss: 77842.3857; val_edge_recon_loss: 2741843.6875; val_gene_expr_recon_loss: 11663302.0000; val_masked_gp_l1_reg_loss: 77394.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51384.1875; val_chrom_access_recon_loss: 2603205.8750; val_global_loss: 17214971.8750; val_optim_loss: 17214971.8750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9496; val_auprc_score: 0.9328; val_best_acc_score: 0.9006; val_best_f1_score: 0.9065; train_kl_reg_loss: 76708.0825; train_edge_recon_loss: 2692305.3712; train_gene_expr_recon_loss: 11533103.3636; train_masked_gp_l1_reg_loss: 77393.0020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51379.4113; train_chrom_access_recon_loss: 2560411.8523; train_global_loss: 16991301.0152; train_optim_loss: 16991301.0152; val_kl_reg_loss: 78608.5488; val_edge_recon_loss: 2727798.2188; val_gene_expr_recon_loss: 11795375.7500; val_masked_gp_l1_reg_loss: 77392.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51375.5547; val_chrom_access_recon_loss: 2649600.0000; val_global_loss: 17380150.5000; val_optim_loss: 17380150.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9550; val_auprc_score: 0.9384; val_best_acc_score: 0.9033; val_best_f1_score: 0.9088; train_kl_reg_loss: 76640.3765; train_edge_recon_loss: 2690510.4205; train_gene_expr_recon_loss: 11537499.1818; train_masked_gp_l1_reg_loss: 77391.7876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51373.0108; train_chrom_access_recon_loss: 2561056.8333; train_global_loss: 16994471.8333; train_optim_loss: 16994471.8333; val_kl_reg_loss: 77964.0498; val_edge_recon_loss: 2713961.5625; val_gene_expr_recon_loss: 11739246.2500; val_masked_gp_l1_reg_loss: 77391.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51370.2969; val_chrom_access_recon_loss: 2612436.0000; val_global_loss: 17272369.0000; val_optim_loss: 17272369.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9537; val_auprc_score: 0.9361; val_best_acc_score: 0.8992; val_best_f1_score: 0.9031; train_kl_reg_loss: 76809.8030; train_edge_recon_loss: 2677297.2273; train_gene_expr_recon_loss: 11541504.4697; train_masked_gp_l1_reg_loss: 77391.2534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51368.0364; train_chrom_access_recon_loss: 2562605.6402; train_global_loss: 16986976.1364; train_optim_loss: 16986976.1364; val_kl_reg_loss: 77603.5225; val_edge_recon_loss: 2738632.5938; val_gene_expr_recon_loss: 11633778.5000; val_masked_gp_l1_reg_loss: 77391.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51365.8086; val_chrom_access_recon_loss: 2621936.3438; val_global_loss: 17200708.0000; val_optim_loss: 17200708.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 7 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9541
val AUPRC score: 0.9325
val best accuracy score: 0.9116
val best F1 score: 0.9158
val target rna MSE score: 1.2415
val source rna MSE score: 0.8272
val target atac MSE score: 0.4948
val source atac MSE score: 0.1972
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
