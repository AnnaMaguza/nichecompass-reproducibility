[True]
Run timestamp: 10102023_101611_230.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_230']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7523; val_auprc_score: 0.7768; val_best_acc_score: 0.5485; val_best_f1_score: 0.6856; train_kl_reg_loss: 52876.9009; train_edge_recon_loss: 741612.3244; train_gene_expr_recon_loss: 22360614.9008; train_masked_gp_l1_reg_loss: 102365.0259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2543136.3006; train_chrom_access_recon_loss: 6710286.7061; train_global_loss: 32510892.2595; train_optim_loss: 32510892.2595; val_kl_reg_loss: 71219.8630; val_edge_recon_loss: 812480.1958; val_gene_expr_recon_loss: 21413473.2000; val_masked_gp_l1_reg_loss: 86519.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1043809.1250; val_chrom_access_recon_loss: 6637067.0000; val_global_loss: 30064570.4000; val_optim_loss: 30064570.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7997; val_auprc_score: 0.8145; val_best_acc_score: 0.6172; val_best_f1_score: 0.7165; train_kl_reg_loss: 66015.1678; train_edge_recon_loss: 733280.7338; train_gene_expr_recon_loss: 20916585.5115; train_masked_gp_l1_reg_loss: 82677.3653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 563161.0675; train_chrom_access_recon_loss: 6472953.3397; train_global_loss: 28834673.2672; train_optim_loss: 28834673.2672; val_kl_reg_loss: 60153.4711; val_edge_recon_loss: 811663.3583; val_gene_expr_recon_loss: 21019137.0667; val_masked_gp_l1_reg_loss: 79594.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 306951.8438; val_chrom_access_recon_loss: 6540736.0333; val_global_loss: 28818236.0000; val_optim_loss: 28818236.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8778; val_auprc_score: 0.8793; val_best_acc_score: 0.8032; val_best_f1_score: 0.7998; train_kl_reg_loss: 59592.6489; train_edge_recon_loss: 725125.0138; train_gene_expr_recon_loss: 20639968.3969; train_masked_gp_l1_reg_loss: 79617.9215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 226111.5086; train_chrom_access_recon_loss: 6409728.9237; train_global_loss: 28140144.4885; train_optim_loss: 28140144.4885; val_kl_reg_loss: 55181.1867; val_edge_recon_loss: 798611.5458; val_gene_expr_recon_loss: 20764454.8000; val_masked_gp_l1_reg_loss: 80416.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179669.2188; val_chrom_access_recon_loss: 6466403.9333; val_global_loss: 28344737.3333; val_optim_loss: 28344737.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8875; val_auprc_score: 0.8776; val_best_acc_score: 0.8022; val_best_f1_score: 0.8171; train_kl_reg_loss: 54056.1426; train_edge_recon_loss: 705048.0935; train_gene_expr_recon_loss: 20353010.8550; train_masked_gp_l1_reg_loss: 82345.7829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159029.6905; train_chrom_access_recon_loss: 6328213.9275; train_global_loss: 27681704.6260; train_optim_loss: 27681704.6260; val_kl_reg_loss: 56054.2859; val_edge_recon_loss: 677725.9208; val_gene_expr_recon_loss: 20527747.6000; val_masked_gp_l1_reg_loss: 85107.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140497.0469; val_chrom_access_recon_loss: 6433576.3000; val_global_loss: 27920710.2667; val_optim_loss: 27920710.2667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8888; val_auprc_score: 0.8770; val_best_acc_score: 0.8019; val_best_f1_score: 0.8137; train_kl_reg_loss: 64606.7733; train_edge_recon_loss: 635124.6703; train_gene_expr_recon_loss: 20159770.0763; train_masked_gp_l1_reg_loss: 86513.5063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125945.5411; train_chrom_access_recon_loss: 6277485.6603; train_global_loss: 27349446.3969; train_optim_loss: 27349446.3969; val_kl_reg_loss: 65688.8135; val_edge_recon_loss: 636627.5583; val_gene_expr_recon_loss: 20310922.6667; val_masked_gp_l1_reg_loss: 87997.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114780.9531; val_chrom_access_recon_loss: 6331884.9333; val_global_loss: 27547901.7333; val_optim_loss: 27547901.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9078; val_auprc_score: 0.8983; val_best_acc_score: 0.8162; val_best_f1_score: 0.8269; train_kl_reg_loss: 65688.6925; train_edge_recon_loss: 620030.0401; train_gene_expr_recon_loss: 19996523.1603; train_masked_gp_l1_reg_loss: 88817.7095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106449.0824; train_chrom_access_recon_loss: 6235611.9160; train_global_loss: 27113120.5649; train_optim_loss: 27113120.5649; val_kl_reg_loss: 62705.7797; val_edge_recon_loss: 621208.2750; val_gene_expr_recon_loss: 20204311.3333; val_masked_gp_l1_reg_loss: 89693.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100930.6641; val_chrom_access_recon_loss: 6305956.9333; val_global_loss: 27384806.2667; val_optim_loss: 27384806.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9168; val_auprc_score: 0.9071; val_best_acc_score: 0.8248; val_best_f1_score: 0.8353; train_kl_reg_loss: 64040.4852; train_edge_recon_loss: 611508.9160; train_gene_expr_recon_loss: 19838223.8626; train_masked_gp_l1_reg_loss: 90480.5135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96702.8322; train_chrom_access_recon_loss: 6182993.7137; train_global_loss: 26883950.2290; train_optim_loss: 26883950.2290; val_kl_reg_loss: 63899.1823; val_edge_recon_loss: 609225.5458; val_gene_expr_recon_loss: 20139625.7333; val_masked_gp_l1_reg_loss: 91092.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94030.2031; val_chrom_access_recon_loss: 6282063.9000; val_global_loss: 27279936.2667; val_optim_loss: 27279936.2667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9287; val_auprc_score: 0.9175; val_best_acc_score: 0.8496; val_best_f1_score: 0.8541; train_kl_reg_loss: 63146.2309; train_edge_recon_loss: 608020.9385; train_gene_expr_recon_loss: 19708863.2366; train_masked_gp_l1_reg_loss: 91691.5118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91388.5901; train_chrom_access_recon_loss: 6141432.1641; train_global_loss: 26704542.5954; train_optim_loss: 26704542.5954; val_kl_reg_loss: 62651.9784; val_edge_recon_loss: 604946.4542; val_gene_expr_recon_loss: 20048340.5333; val_masked_gp_l1_reg_loss: 92235.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89199.3359; val_chrom_access_recon_loss: 6281364.1667; val_global_loss: 27178739.2000; val_optim_loss: 27178739.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9346; val_auprc_score: 0.9261; val_best_acc_score: 0.8570; val_best_f1_score: 0.8628; train_kl_reg_loss: 61848.7390; train_edge_recon_loss: 603670.7719; train_gene_expr_recon_loss: 19616436.4122; train_masked_gp_l1_reg_loss: 92840.0608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87251.3575; train_chrom_access_recon_loss: 6113630.9046; train_global_loss: 26575678.1985; train_optim_loss: 26575678.1985; val_kl_reg_loss: 61232.9878; val_edge_recon_loss: 602662.3583; val_gene_expr_recon_loss: 19844017.6000; val_masked_gp_l1_reg_loss: 93483.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85956.8203; val_chrom_access_recon_loss: 6209528.5000; val_global_loss: 26896881.3333; val_optim_loss: 26896881.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9384; val_auprc_score: 0.9269; val_best_acc_score: 0.8665; val_best_f1_score: 0.8730; train_kl_reg_loss: 60713.4352; train_edge_recon_loss: 600809.5635; train_gene_expr_recon_loss: 19512331.4962; train_masked_gp_l1_reg_loss: 93890.1753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83596.4917; train_chrom_access_recon_loss: 6078492.8435; train_global_loss: 26429834.0305; train_optim_loss: 26429834.0305; val_kl_reg_loss: 59861.4336; val_edge_recon_loss: 601390.1458; val_gene_expr_recon_loss: 19801417.7333; val_masked_gp_l1_reg_loss: 94159.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82090.2812; val_chrom_access_recon_loss: 6193973.5667; val_global_loss: 26832893.0667; val_optim_loss: 26832893.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9474; val_auprc_score: 0.9349; val_best_acc_score: 0.8816; val_best_f1_score: 0.8855; train_kl_reg_loss: 60438.6179; train_edge_recon_loss: 593999.3039; train_gene_expr_recon_loss: 19397172.5496; train_masked_gp_l1_reg_loss: 94677.5673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80661.1337; train_chrom_access_recon_loss: 6040463.9847; train_global_loss: 26267413.0992; train_optim_loss: 26267413.0992; val_kl_reg_loss: 60414.0021; val_edge_recon_loss: 593454.6417; val_gene_expr_recon_loss: 19653347.6000; val_masked_gp_l1_reg_loss: 95328.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80159.4688; val_chrom_access_recon_loss: 6120447.7000; val_global_loss: 26603152.4000; val_optim_loss: 26603152.4000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9514; val_auprc_score: 0.9414; val_best_acc_score: 0.8884; val_best_f1_score: 0.8920; train_kl_reg_loss: 59845.9750; train_edge_recon_loss: 592409.8273; train_gene_expr_recon_loss: 19325732.8702; train_masked_gp_l1_reg_loss: 95505.6365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78813.2981; train_chrom_access_recon_loss: 6019657.8550; train_global_loss: 26171965.4656; train_optim_loss: 26171965.4656; val_kl_reg_loss: 60173.6497; val_edge_recon_loss: 590525.8333; val_gene_expr_recon_loss: 19549699.4667; val_masked_gp_l1_reg_loss: 95783.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77950.3438; val_chrom_access_recon_loss: 6090747.0000; val_global_loss: 26464879.7333; val_optim_loss: 26464879.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9568; val_auprc_score: 0.9446; val_best_acc_score: 0.8930; val_best_f1_score: 0.8957; train_kl_reg_loss: 59566.8947; train_edge_recon_loss: 587471.6865; train_gene_expr_recon_loss: 19255167.5878; train_masked_gp_l1_reg_loss: 96028.8653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77052.0972; train_chrom_access_recon_loss: 5993283.2863; train_global_loss: 26068570.6718; train_optim_loss: 26068570.6718; val_kl_reg_loss: 59743.3542; val_edge_recon_loss: 590690.9250; val_gene_expr_recon_loss: 19512616.9333; val_masked_gp_l1_reg_loss: 96532.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76871.6641; val_chrom_access_recon_loss: 6087897.4667; val_global_loss: 26424352.9333; val_optim_loss: 26424352.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9580; val_auprc_score: 0.9488; val_best_acc_score: 0.9002; val_best_f1_score: 0.9020; train_kl_reg_loss: 59067.0858; train_edge_recon_loss: 586548.9852; train_gene_expr_recon_loss: 19181407.4504; train_masked_gp_l1_reg_loss: 96668.7213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75994.1366; train_chrom_access_recon_loss: 5962451.2748; train_global_loss: 25962137.5267; train_optim_loss: 25962137.5267; val_kl_reg_loss: 61088.9995; val_edge_recon_loss: 584395.1500; val_gene_expr_recon_loss: 19435036.1333; val_masked_gp_l1_reg_loss: 97002.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75435.3906; val_chrom_access_recon_loss: 6046210.1667; val_global_loss: 26299168.5333; val_optim_loss: 26299168.5333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9607; val_auprc_score: 0.9525; val_best_acc_score: 0.9037; val_best_f1_score: 0.9062; train_kl_reg_loss: 58629.5071; train_edge_recon_loss: 583738.4795; train_gene_expr_recon_loss: 19118218.1679; train_masked_gp_l1_reg_loss: 97155.5607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75123.8668; train_chrom_access_recon_loss: 5946743.3015; train_global_loss: 25879608.9313; train_optim_loss: 25879608.9313; val_kl_reg_loss: 58774.8839; val_edge_recon_loss: 585927.6000; val_gene_expr_recon_loss: 19364753.4667; val_masked_gp_l1_reg_loss: 97547.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74688.8281; val_chrom_access_recon_loss: 6030593.8333; val_global_loss: 26212285.7333; val_optim_loss: 26212285.7333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9588; val_auprc_score: 0.9477; val_best_acc_score: 0.9010; val_best_f1_score: 0.9049; train_kl_reg_loss: 58225.8297; train_edge_recon_loss: 583239.8282; train_gene_expr_recon_loss: 19077005.7405; train_masked_gp_l1_reg_loss: 97746.8383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74446.0630; train_chrom_access_recon_loss: 5925436.5992; train_global_loss: 25816100.8855; train_optim_loss: 25816100.8855; val_kl_reg_loss: 59059.9328; val_edge_recon_loss: 584841.7000; val_gene_expr_recon_loss: 19346434.4000; val_masked_gp_l1_reg_loss: 98135.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74160.5156; val_chrom_access_recon_loss: 6035132.8000; val_global_loss: 26197765.2000; val_optim_loss: 26197765.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9577; val_auprc_score: 0.9456; val_best_acc_score: 0.9025; val_best_f1_score: 0.9063; train_kl_reg_loss: 57852.3144; train_edge_recon_loss: 581779.5630; train_gene_expr_recon_loss: 19015242.4275; train_masked_gp_l1_reg_loss: 98364.5153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74026.3053; train_chrom_access_recon_loss: 5898647.8740; train_global_loss: 25725912.9771; train_optim_loss: 25725912.9771; val_kl_reg_loss: 57414.8990; val_edge_recon_loss: 587107.4333; val_gene_expr_recon_loss: 19283488.4000; val_masked_gp_l1_reg_loss: 98943.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74635.6328; val_chrom_access_recon_loss: 6002068.7667; val_global_loss: 26103659.6000; val_optim_loss: 26103659.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9646; val_auprc_score: 0.9566; val_best_acc_score: 0.9111; val_best_f1_score: 0.9141; train_kl_reg_loss: 57734.7496; train_edge_recon_loss: 578686.7872; train_gene_expr_recon_loss: 18964602.8397; train_masked_gp_l1_reg_loss: 99058.3682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73994.2487; train_chrom_access_recon_loss: 5883680.8664; train_global_loss: 25657757.7710; train_optim_loss: 25657757.7710; val_kl_reg_loss: 56499.1289; val_edge_recon_loss: 581866.5125; val_gene_expr_recon_loss: 19193932.2667; val_masked_gp_l1_reg_loss: 99473.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74070.2109; val_chrom_access_recon_loss: 5972807.8667; val_global_loss: 25978650.1333; val_optim_loss: 25978650.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9620; val_auprc_score: 0.9520; val_best_acc_score: 0.9092; val_best_f1_score: 0.9126; train_kl_reg_loss: 57246.0396; train_edge_recon_loss: 578655.3712; train_gene_expr_recon_loss: 18903954.5649; train_masked_gp_l1_reg_loss: 99669.9215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73787.7543; train_chrom_access_recon_loss: 5855637.6145; train_global_loss: 25568951.3130; train_optim_loss: 25568951.3130; val_kl_reg_loss: 58863.3914; val_edge_recon_loss: 580917.5792; val_gene_expr_recon_loss: 19241965.6000; val_masked_gp_l1_reg_loss: 100061.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74007.0703; val_chrom_access_recon_loss: 6014289.2333; val_global_loss: 26070105.7333; val_optim_loss: 26070105.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9654; val_auprc_score: 0.9545; val_best_acc_score: 0.9127; val_best_f1_score: 0.9151; train_kl_reg_loss: 56863.0463; train_edge_recon_loss: 577676.5768; train_gene_expr_recon_loss: 18884306.8702; train_masked_gp_l1_reg_loss: 100413.4241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73957.0116; train_chrom_access_recon_loss: 5850908.3473; train_global_loss: 25544125.0840; train_optim_loss: 25544125.0840; val_kl_reg_loss: 57134.2594; val_edge_recon_loss: 578454.2583; val_gene_expr_recon_loss: 19143515.0667; val_masked_gp_l1_reg_loss: 101004.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74291.9531; val_chrom_access_recon_loss: 5943594.6000; val_global_loss: 25897994.6667; val_optim_loss: 25897994.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9652; val_auprc_score: 0.9570; val_best_acc_score: 0.9123; val_best_f1_score: 0.9159; train_kl_reg_loss: 56533.1947; train_edge_recon_loss: 577457.0148; train_gene_expr_recon_loss: 18846430.0840; train_masked_gp_l1_reg_loss: 101216.0918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74265.0896; train_chrom_access_recon_loss: 5836844.4198; train_global_loss: 25492746.0458; train_optim_loss: 25492746.0458; val_kl_reg_loss: 57044.0263; val_edge_recon_loss: 578132.6833; val_gene_expr_recon_loss: 19052727.2000; val_masked_gp_l1_reg_loss: 101606.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74466.5938; val_chrom_access_recon_loss: 5934021.3333; val_global_loss: 25797997.0667; val_optim_loss: 25797997.0667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9625; val_auprc_score: 0.9512; val_best_acc_score: 0.9112; val_best_f1_score: 0.9145; train_kl_reg_loss: 56228.7921; train_edge_recon_loss: 576544.9451; train_gene_expr_recon_loss: 18786590.5649; train_masked_gp_l1_reg_loss: 102162.9045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74663.1833; train_chrom_access_recon_loss: 5816025.2786; train_global_loss: 25412215.8626; train_optim_loss: 25412215.8626; val_kl_reg_loss: 56570.8404; val_edge_recon_loss: 584884.1417; val_gene_expr_recon_loss: 19078710.2667; val_masked_gp_l1_reg_loss: 102381.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74753.4688; val_chrom_access_recon_loss: 5927907.3000; val_global_loss: 25825208.4000; val_optim_loss: 25825208.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9608; val_auprc_score: 0.9480; val_best_acc_score: 0.9066; val_best_f1_score: 0.9110; train_kl_reg_loss: 55802.9902; train_edge_recon_loss: 577236.3163; train_gene_expr_recon_loss: 18744900.1069; train_masked_gp_l1_reg_loss: 102989.1308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75097.3290; train_chrom_access_recon_loss: 5800240.9237; train_global_loss: 25356266.8092; train_optim_loss: 25356266.8092; val_kl_reg_loss: 56384.2365; val_edge_recon_loss: 585069.8333; val_gene_expr_recon_loss: 18978907.7333; val_masked_gp_l1_reg_loss: 103531.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75977.8828; val_chrom_access_recon_loss: 5877928.4000; val_global_loss: 25677800.4000; val_optim_loss: 25677800.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9632; val_auprc_score: 0.9493; val_best_acc_score: 0.9116; val_best_f1_score: 0.9150; train_kl_reg_loss: 55708.6148; train_edge_recon_loss: 576378.1460; train_gene_expr_recon_loss: 18704083.8779; train_masked_gp_l1_reg_loss: 104054.3142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75726.7431; train_chrom_access_recon_loss: 5785267.5038; train_global_loss: 25301219.1145; train_optim_loss: 25301219.1145; val_kl_reg_loss: 55574.5198; val_edge_recon_loss: 579340.7875; val_gene_expr_recon_loss: 19013919.8667; val_masked_gp_l1_reg_loss: 104251.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75821.5547; val_chrom_access_recon_loss: 5925086.8000; val_global_loss: 25753996.1333; val_optim_loss: 25753996.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9619; val_auprc_score: 0.9512; val_best_acc_score: 0.9105; val_best_f1_score: 0.9139; train_kl_reg_loss: 55491.9648; train_edge_recon_loss: 576676.9490; train_gene_expr_recon_loss: 18654791.5725; train_masked_gp_l1_reg_loss: 104916.9503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75969.4827; train_chrom_access_recon_loss: 5769611.5954; train_global_loss: 25237458.5191; train_optim_loss: 25237458.5191; val_kl_reg_loss: 55003.2305; val_edge_recon_loss: 580473.9625; val_gene_expr_recon_loss: 18907908.4000; val_masked_gp_l1_reg_loss: 105314.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75933.1094; val_chrom_access_recon_loss: 5875157.3333; val_global_loss: 25599790.9333; val_optim_loss: 25599790.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9674; val_auprc_score: 0.9604; val_best_acc_score: 0.9175; val_best_f1_score: 0.9209; train_kl_reg_loss: 55595.3187; train_edge_recon_loss: 576493.9027; train_gene_expr_recon_loss: 18612650.7481; train_masked_gp_l1_reg_loss: 105841.7910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76317.7146; train_chrom_access_recon_loss: 5754506.7557; train_global_loss: 25181406.3511; train_optim_loss: 25181406.3511; val_kl_reg_loss: 57101.5245; val_edge_recon_loss: 579148.3708; val_gene_expr_recon_loss: 18974793.7333; val_masked_gp_l1_reg_loss: 106298.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77485.2734; val_chrom_access_recon_loss: 5883408.5000; val_global_loss: 25678236.1333; val_optim_loss: 25678236.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9656; val_auprc_score: 0.9554; val_best_acc_score: 0.9158; val_best_f1_score: 0.9194; train_kl_reg_loss: 55133.1453; train_edge_recon_loss: 577442.8287; train_gene_expr_recon_loss: 18545259.3740; train_masked_gp_l1_reg_loss: 106763.4184; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76804.7706; train_chrom_access_recon_loss: 5738344.2672; train_global_loss: 25099747.7557; train_optim_loss: 25099747.7557; val_kl_reg_loss: 55466.9698; val_edge_recon_loss: 579402.9958; val_gene_expr_recon_loss: 18907157.4667; val_masked_gp_l1_reg_loss: 107558.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77206.3828; val_chrom_access_recon_loss: 5887839.6333; val_global_loss: 25614631.2000; val_optim_loss: 25614631.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9704; val_auprc_score: 0.9621; val_best_acc_score: 0.9216; val_best_f1_score: 0.9244; train_kl_reg_loss: 55387.8423; train_edge_recon_loss: 576634.1942; train_gene_expr_recon_loss: 18513296.4275; train_masked_gp_l1_reg_loss: 107848.6659; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77466.6713; train_chrom_access_recon_loss: 5731153.8435; train_global_loss: 25061787.7405; train_optim_loss: 25061787.7405; val_kl_reg_loss: 54963.8122; val_edge_recon_loss: 576527.8375; val_gene_expr_recon_loss: 18877497.2000; val_masked_gp_l1_reg_loss: 108271.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78125.5469; val_chrom_access_recon_loss: 5878487.0333; val_global_loss: 25573874.1333; val_optim_loss: 25573874.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9648; val_auprc_score: 0.9557; val_best_acc_score: 0.9136; val_best_f1_score: 0.9179; train_kl_reg_loss: 55216.3661; train_edge_recon_loss: 576411.5916; train_gene_expr_recon_loss: 18486162.2595; train_masked_gp_l1_reg_loss: 108687.8198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77796.2357; train_chrom_access_recon_loss: 5717498.6794; train_global_loss: 25021772.9618; train_optim_loss: 25021772.9618; val_kl_reg_loss: 56680.0224; val_edge_recon_loss: 579860.9042; val_gene_expr_recon_loss: 18845079.6000; val_masked_gp_l1_reg_loss: 109414.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78576.7891; val_chrom_access_recon_loss: 5853055.0000; val_global_loss: 25522665.3333; val_optim_loss: 25522665.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9667; val_auprc_score: 0.9578; val_best_acc_score: 0.9148; val_best_f1_score: 0.9190; train_kl_reg_loss: 55336.5866; train_edge_recon_loss: 574551.9847; train_gene_expr_recon_loss: 18425887.1908; train_masked_gp_l1_reg_loss: 109652.9091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78455.6107; train_chrom_access_recon_loss: 5698701.8397; train_global_loss: 24942586.1527; train_optim_loss: 24942586.1527; val_kl_reg_loss: 55436.1107; val_edge_recon_loss: 577542.1042; val_gene_expr_recon_loss: 18712913.0667; val_masked_gp_l1_reg_loss: 110261.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78476.1484; val_chrom_access_recon_loss: 5837241.8667; val_global_loss: 25371870.9333; val_optim_loss: 25371870.9333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9682; val_auprc_score: 0.9600; val_best_acc_score: 0.9161; val_best_f1_score: 0.9198; train_kl_reg_loss: 55187.4952; train_edge_recon_loss: 575280.7085; train_gene_expr_recon_loss: 18408513.8779; train_masked_gp_l1_reg_loss: 110527.4971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78856.7585; train_chrom_access_recon_loss: 5698369.2290; train_global_loss: 24926735.5420; train_optim_loss: 24926735.5420; val_kl_reg_loss: 55855.9812; val_edge_recon_loss: 578261.0375; val_gene_expr_recon_loss: 18793134.1333; val_masked_gp_l1_reg_loss: 110616.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78637.0938; val_chrom_access_recon_loss: 5863936.9333; val_global_loss: 25480441.7333; val_optim_loss: 25480441.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9690; val_auprc_score: 0.9613; val_best_acc_score: 0.9209; val_best_f1_score: 0.9237; train_kl_reg_loss: 55337.2588; train_edge_recon_loss: 576548.1350; train_gene_expr_recon_loss: 18364506.0611; train_masked_gp_l1_reg_loss: 111271.3467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79213.2646; train_chrom_access_recon_loss: 5686392.0344; train_global_loss: 24873268.1221; train_optim_loss: 24873268.1221; val_kl_reg_loss: 55459.1016; val_edge_recon_loss: 579251.4667; val_gene_expr_recon_loss: 18778290.8000; val_masked_gp_l1_reg_loss: 111401.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78975.7031; val_chrom_access_recon_loss: 5877311.5000; val_global_loss: 25480690.8000; val_optim_loss: 25480690.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9669; val_auprc_score: 0.9564; val_best_acc_score: 0.9171; val_best_f1_score: 0.9209; train_kl_reg_loss: 55384.4214; train_edge_recon_loss: 575586.4823; train_gene_expr_recon_loss: 18302322.0916; train_masked_gp_l1_reg_loss: 111854.8716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79596.2987; train_chrom_access_recon_loss: 5667945.6794; train_global_loss: 24792689.7863; train_optim_loss: 24792689.7863; val_kl_reg_loss: 55949.6396; val_edge_recon_loss: 579902.3583; val_gene_expr_recon_loss: 18671070.4000; val_masked_gp_l1_reg_loss: 112273.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80193.6406; val_chrom_access_recon_loss: 5811843.3000; val_global_loss: 25311233.6000; val_optim_loss: 25311233.6000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9639; val_auprc_score: 0.9504; val_best_acc_score: 0.9144; val_best_f1_score: 0.9178; train_kl_reg_loss: 55538.4495; train_edge_recon_loss: 574695.8707; train_gene_expr_recon_loss: 18317921.2061; train_masked_gp_l1_reg_loss: 112592.0822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80287.9872; train_chrom_access_recon_loss: 5672841.9466; train_global_loss: 24813877.4046; train_optim_loss: 24813877.4046; val_kl_reg_loss: 55055.2927; val_edge_recon_loss: 581658.3708; val_gene_expr_recon_loss: 18689787.8667; val_masked_gp_l1_reg_loss: 112719.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80998.2812; val_chrom_access_recon_loss: 5817084.9667; val_global_loss: 25337304.6667; val_optim_loss: 25337304.6667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9690; val_auprc_score: 0.9587; val_best_acc_score: 0.9213; val_best_f1_score: 0.9241; train_kl_reg_loss: 55585.3222; train_edge_recon_loss: 575339.0520; train_gene_expr_recon_loss: 18247620.8321; train_masked_gp_l1_reg_loss: 113056.2980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80832.0988; train_chrom_access_recon_loss: 5656780.7252; train_global_loss: 24729214.2748; train_optim_loss: 24729214.2748; val_kl_reg_loss: 55600.0560; val_edge_recon_loss: 577259.2292; val_gene_expr_recon_loss: 18658161.8667; val_masked_gp_l1_reg_loss: 113471.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80906.9297; val_chrom_access_recon_loss: 5797788.0000; val_global_loss: 25283187.3333; val_optim_loss: 25283187.3333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9698; val_auprc_score: 0.9621; val_best_acc_score: 0.9210; val_best_f1_score: 0.9241; train_kl_reg_loss: 55775.0278; train_edge_recon_loss: 576760.1240; train_gene_expr_recon_loss: 18212952.3740; train_masked_gp_l1_reg_loss: 113630.9379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81327.9033; train_chrom_access_recon_loss: 5651757.2634; train_global_loss: 24692203.7710; train_optim_loss: 24692203.7710; val_kl_reg_loss: 56399.0404; val_edge_recon_loss: 579165.6792; val_gene_expr_recon_loss: 18698852.1333; val_masked_gp_l1_reg_loss: 113696.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81563.0859; val_chrom_access_recon_loss: 5821867.3667; val_global_loss: 25351544.1333; val_optim_loss: 25351544.1333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9658; val_auprc_score: 0.9536; val_best_acc_score: 0.9135; val_best_f1_score: 0.9173; train_kl_reg_loss: 56020.5772; train_edge_recon_loss: 576970.7114; train_gene_expr_recon_loss: 18206304.6565; train_masked_gp_l1_reg_loss: 113873.9807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81705.7390; train_chrom_access_recon_loss: 5647642.3779; train_global_loss: 24682518.1679; train_optim_loss: 24682518.1679; val_kl_reg_loss: 56521.8542; val_edge_recon_loss: 582099.6083; val_gene_expr_recon_loss: 18643653.4667; val_masked_gp_l1_reg_loss: 114139.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82025.0000; val_chrom_access_recon_loss: 5813876.9000; val_global_loss: 25292316.9333; val_optim_loss: 25292316.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9678; val_auprc_score: 0.9561; val_best_acc_score: 0.9236; val_best_f1_score: 0.9260; train_kl_reg_loss: 56173.7217; train_edge_recon_loss: 575913.6627; train_gene_expr_recon_loss: 18176587.5573; train_masked_gp_l1_reg_loss: 114189.3355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82104.7323; train_chrom_access_recon_loss: 5639461.3893; train_global_loss: 24644430.4427; train_optim_loss: 24644430.4427; val_kl_reg_loss: 56044.5109; val_edge_recon_loss: 580249.0292; val_gene_expr_recon_loss: 18668106.1333; val_masked_gp_l1_reg_loss: 114273.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82576.3672; val_chrom_access_recon_loss: 5857453.6333; val_global_loss: 25358703.2000; val_optim_loss: 25358703.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9715; val_auprc_score: 0.9593; val_best_acc_score: 0.9263; val_best_f1_score: 0.9284; train_kl_reg_loss: 56512.9187; train_edge_recon_loss: 575899.0501; train_gene_expr_recon_loss: 18122714.3435; train_masked_gp_l1_reg_loss: 114556.3551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82539.6607; train_chrom_access_recon_loss: 5627396.9885; train_global_loss: 24579619.2672; train_optim_loss: 24579619.2672; val_kl_reg_loss: 56320.3867; val_edge_recon_loss: 578016.4917; val_gene_expr_recon_loss: 18595860.2667; val_masked_gp_l1_reg_loss: 114814.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83154.7031; val_chrom_access_recon_loss: 5798665.8000; val_global_loss: 25226830.8000; val_optim_loss: 25226830.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9708; val_auprc_score: 0.9593; val_best_acc_score: 0.9247; val_best_f1_score: 0.9274; train_kl_reg_loss: 56632.6073; train_edge_recon_loss: 576575.3020; train_gene_expr_recon_loss: 18092060.6107; train_masked_gp_l1_reg_loss: 115075.7112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82884.3013; train_chrom_access_recon_loss: 5624398.3969; train_global_loss: 24547627.0992; train_optim_loss: 24547627.0992; val_kl_reg_loss: 57734.2542; val_edge_recon_loss: 578625.0750; val_gene_expr_recon_loss: 18592290.8000; val_masked_gp_l1_reg_loss: 115425.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84259.1016; val_chrom_access_recon_loss: 5793968.7333; val_global_loss: 25222304.5333; val_optim_loss: 25222304.5333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9683; val_auprc_score: 0.9586; val_best_acc_score: 0.9192; val_best_f1_score: 0.9219; train_kl_reg_loss: 57050.6391; train_edge_recon_loss: 576219.5138; train_gene_expr_recon_loss: 18075234.0305; train_masked_gp_l1_reg_loss: 115435.6924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83371.4986; train_chrom_access_recon_loss: 5617391.2214; train_global_loss: 24524702.5802; train_optim_loss: 24524702.5802; val_kl_reg_loss: 57939.9141; val_edge_recon_loss: 581110.2000; val_gene_expr_recon_loss: 18622387.4667; val_masked_gp_l1_reg_loss: 115798.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83977.0234; val_chrom_access_recon_loss: 5822324.3333; val_global_loss: 25283538.0000; val_optim_loss: 25283538.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9686; val_auprc_score: 0.9569; val_best_acc_score: 0.9214; val_best_f1_score: 0.9234; train_kl_reg_loss: 57610.5850; train_edge_recon_loss: 575749.4938; train_gene_expr_recon_loss: 18066185.6718; train_masked_gp_l1_reg_loss: 115455.7836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83912.9984; train_chrom_access_recon_loss: 5614317.6107; train_global_loss: 24513232.0763; train_optim_loss: 24513232.0763; val_kl_reg_loss: 57871.2190; val_edge_recon_loss: 583677.0875; val_gene_expr_recon_loss: 18605328.0000; val_masked_gp_l1_reg_loss: 115384.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83884.1953; val_chrom_access_recon_loss: 5807979.5000; val_global_loss: 25254123.8667; val_optim_loss: 25254123.8667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9696; val_auprc_score: 0.9586; val_best_acc_score: 0.9233; val_best_f1_score: 0.9249; train_kl_reg_loss: 58253.0759; train_edge_recon_loss: 575735.6985; train_gene_expr_recon_loss: 18051649.3588; train_masked_gp_l1_reg_loss: 115240.2735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84024.1398; train_chrom_access_recon_loss: 5619331.1603; train_global_loss: 24504233.5573; train_optim_loss: 24504233.5573; val_kl_reg_loss: 58772.1141; val_edge_recon_loss: 581111.1917; val_gene_expr_recon_loss: 18642373.8667; val_masked_gp_l1_reg_loss: 115298.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84236.0469; val_chrom_access_recon_loss: 5825940.8667; val_global_loss: 25307732.4000; val_optim_loss: 25307732.4000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9724; val_auprc_score: 0.9660; val_best_acc_score: 0.9227; val_best_f1_score: 0.9255; train_kl_reg_loss: 58768.2077; train_edge_recon_loss: 576468.3254; train_gene_expr_recon_loss: 18031247.9389; train_masked_gp_l1_reg_loss: 115221.3188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84373.7988; train_chrom_access_recon_loss: 5609349.5840; train_global_loss: 24475429.2366; train_optim_loss: 24475429.2366; val_kl_reg_loss: 58219.1922; val_edge_recon_loss: 581478.7625; val_gene_expr_recon_loss: 18617672.1333; val_masked_gp_l1_reg_loss: 115352.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86055.7188; val_chrom_access_recon_loss: 5813395.3667; val_global_loss: 25272173.3333; val_optim_loss: 25272173.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9704; val_auprc_score: 0.9608; val_best_acc_score: 0.9213; val_best_f1_score: 0.9237; train_kl_reg_loss: 58673.4984; train_edge_recon_loss: 574756.7309; train_gene_expr_recon_loss: 17976377.7557; train_masked_gp_l1_reg_loss: 109703.5005; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65453.6867; train_chrom_access_recon_loss: 5591854.6374; train_global_loss: 24376819.8168; train_optim_loss: 24376819.8168; val_kl_reg_loss: 59209.3990; val_edge_recon_loss: 579786.4583; val_gene_expr_recon_loss: 18470456.6667; val_masked_gp_l1_reg_loss: 107868.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61258.5039; val_chrom_access_recon_loss: 5760839.6333; val_global_loss: 25039418.0000; val_optim_loss: 25039418.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9701; val_auprc_score: 0.9619; val_best_acc_score: 0.9220; val_best_f1_score: 0.9257; train_kl_reg_loss: 58717.4843; train_edge_recon_loss: 574564.6155; train_gene_expr_recon_loss: 17951818.0458; train_masked_gp_l1_reg_loss: 107645.1234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60401.3262; train_chrom_access_recon_loss: 5581936.1450; train_global_loss: 24335082.5649; train_optim_loss: 24335082.5649; val_kl_reg_loss: 59156.3216; val_edge_recon_loss: 579616.7250; val_gene_expr_recon_loss: 18501668.2667; val_masked_gp_l1_reg_loss: 107472.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59735.8672; val_chrom_access_recon_loss: 5785480.4333; val_global_loss: 25093129.8667; val_optim_loss: 25093129.8667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9755; val_auprc_score: 0.9681; val_best_acc_score: 0.9293; val_best_f1_score: 0.9320; train_kl_reg_loss: 58767.4060; train_edge_recon_loss: 574629.5286; train_gene_expr_recon_loss: 17952694.5878; train_masked_gp_l1_reg_loss: 107406.1206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59376.3644; train_chrom_access_recon_loss: 5583984.8321; train_global_loss: 24336858.7023; train_optim_loss: 24336858.7023; val_kl_reg_loss: 59180.5568; val_edge_recon_loss: 574025.3250; val_gene_expr_recon_loss: 18488712.5333; val_masked_gp_l1_reg_loss: 107361.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59006.0195; val_chrom_access_recon_loss: 5784782.6667; val_global_loss: 25073068.5333; val_optim_loss: 25073068.5333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9736; val_auprc_score: 0.9655; val_best_acc_score: 0.9283; val_best_f1_score: 0.9312; train_kl_reg_loss: 58924.8861; train_edge_recon_loss: 573983.4198; train_gene_expr_recon_loss: 17934451.7481; train_masked_gp_l1_reg_loss: 107320.7945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58685.5917; train_chrom_access_recon_loss: 5575151.1412; train_global_loss: 24308517.6183; train_optim_loss: 24308517.6183; val_kl_reg_loss: 59639.0943; val_edge_recon_loss: 575153.9917; val_gene_expr_recon_loss: 18494218.2667; val_masked_gp_l1_reg_loss: 107302.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58529.3320; val_chrom_access_recon_loss: 5788774.3000; val_global_loss: 25083617.3333; val_optim_loss: 25083617.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9714; val_auprc_score: 0.9634; val_best_acc_score: 0.9245; val_best_f1_score: 0.9271; train_kl_reg_loss: 59084.1337; train_edge_recon_loss: 575261.7300; train_gene_expr_recon_loss: 17947834.1832; train_masked_gp_l1_reg_loss: 107279.6883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58270.3128; train_chrom_access_recon_loss: 5583490.2863; train_global_loss: 24331220.3969; train_optim_loss: 24331220.3969; val_kl_reg_loss: 59558.4914; val_edge_recon_loss: 576881.3792; val_gene_expr_recon_loss: 18529832.8000; val_masked_gp_l1_reg_loss: 107285.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58202.9336; val_chrom_access_recon_loss: 5798420.0667; val_global_loss: 25130180.2667; val_optim_loss: 25130180.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9669; val_auprc_score: 0.9547; val_best_acc_score: 0.9189; val_best_f1_score: 0.9223; train_kl_reg_loss: 59147.5146; train_edge_recon_loss: 573995.2638; train_gene_expr_recon_loss: 17941217.5191; train_masked_gp_l1_reg_loss: 106706.9402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56187.7805; train_chrom_access_recon_loss: 5580247.7214; train_global_loss: 24317502.7481; train_optim_loss: 24317502.7481; val_kl_reg_loss: 59655.4951; val_edge_recon_loss: 577273.0500; val_gene_expr_recon_loss: 18509892.5333; val_masked_gp_l1_reg_loss: 106484.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55778.1914; val_chrom_access_recon_loss: 5787753.8667; val_global_loss: 25096836.8000; val_optim_loss: 25096836.8000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9683; val_auprc_score: 0.9553; val_best_acc_score: 0.9189; val_best_f1_score: 0.9218; train_kl_reg_loss: 59117.9164; train_edge_recon_loss: 574697.0883; train_gene_expr_recon_loss: 17940783.6641; train_masked_gp_l1_reg_loss: 106431.8452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55670.9268; train_chrom_access_recon_loss: 5576380.4351; train_global_loss: 24313082.0305; train_optim_loss: 24313082.0305; val_kl_reg_loss: 59618.7568; val_edge_recon_loss: 578277.9792; val_gene_expr_recon_loss: 18499795.3333; val_masked_gp_l1_reg_loss: 106391.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55589.2188; val_chrom_access_recon_loss: 5787203.8000; val_global_loss: 25086877.6000; val_optim_loss: 25086877.6000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9720; val_auprc_score: 0.9635; val_best_acc_score: 0.9251; val_best_f1_score: 0.9276; train_kl_reg_loss: 59112.7581; train_edge_recon_loss: 574950.4327; train_gene_expr_recon_loss: 17927318.3588; train_masked_gp_l1_reg_loss: 106371.0708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55530.0395; train_chrom_access_recon_loss: 5572575.4504; train_global_loss: 24295858.0153; train_optim_loss: 24295858.0153; val_kl_reg_loss: 59607.5086; val_edge_recon_loss: 577296.6625; val_gene_expr_recon_loss: 18433878.4000; val_masked_gp_l1_reg_loss: 106356.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55462.3477; val_chrom_access_recon_loss: 5755345.4000; val_global_loss: 24987946.0000; val_optim_loss: 24987946.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9683; val_auprc_score: 0.9568; val_best_acc_score: 0.9184; val_best_f1_score: 0.9219; train_kl_reg_loss: 59238.5686; train_edge_recon_loss: 574105.1059; train_gene_expr_recon_loss: 17949157.0458; train_masked_gp_l1_reg_loss: 106348.8683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55417.0517; train_chrom_access_recon_loss: 5579502.4351; train_global_loss: 24323769.1298; train_optim_loss: 24323769.1298; val_kl_reg_loss: 59721.5378; val_edge_recon_loss: 580826.5208; val_gene_expr_recon_loss: 18500773.6000; val_masked_gp_l1_reg_loss: 106336.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55363.8438; val_chrom_access_recon_loss: 5806459.4333; val_global_loss: 25109481.0667; val_optim_loss: 25109481.0667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9705; val_auprc_score: 0.9620; val_best_acc_score: 0.9239; val_best_f1_score: 0.9254; train_kl_reg_loss: 59169.4631; train_edge_recon_loss: 574878.0115; train_gene_expr_recon_loss: 17933440.5496; train_masked_gp_l1_reg_loss: 106331.4481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55320.2741; train_chrom_access_recon_loss: 5573677.8015; train_global_loss: 24302817.5267; train_optim_loss: 24302817.5267; val_kl_reg_loss: 59705.8638; val_edge_recon_loss: 580124.5333; val_gene_expr_recon_loss: 18566054.6667; val_masked_gp_l1_reg_loss: 106318.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55285.6484; val_chrom_access_recon_loss: 5796196.0667; val_global_loss: 25163684.9333; val_optim_loss: 25163684.9333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9708; val_auprc_score: 0.9611; val_best_acc_score: 0.9235; val_best_f1_score: 0.9251; train_kl_reg_loss: 59161.9346; train_edge_recon_loss: 573367.9346; train_gene_expr_recon_loss: 17947050.8931; train_masked_gp_l1_reg_loss: 106321.4527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55239.6173; train_chrom_access_recon_loss: 5580911.3855; train_global_loss: 24322053.2824; train_optim_loss: 24322053.2824; val_kl_reg_loss: 59726.5596; val_edge_recon_loss: 577387.2333; val_gene_expr_recon_loss: 18428484.4000; val_masked_gp_l1_reg_loss: 106315.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55211.3516; val_chrom_access_recon_loss: 5751343.9000; val_global_loss: 24978470.0000; val_optim_loss: 24978470.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9694; val_auprc_score: 0.9583; val_best_acc_score: 0.9200; val_best_f1_score: 0.9226; train_kl_reg_loss: 59175.8337; train_edge_recon_loss: 573394.4761; train_gene_expr_recon_loss: 17918384.9695; train_masked_gp_l1_reg_loss: 106315.2041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55166.7922; train_chrom_access_recon_loss: 5571617.9160; train_global_loss: 24284055.3588; train_optim_loss: 24284055.3588; val_kl_reg_loss: 59654.1234; val_edge_recon_loss: 580525.4708; val_gene_expr_recon_loss: 18533221.8667; val_masked_gp_l1_reg_loss: 106316.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55140.5625; val_chrom_access_recon_loss: 5806237.4333; val_global_loss: 25141094.9333; val_optim_loss: 25141094.9333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9715; val_auprc_score: 0.9633; val_best_acc_score: 0.9240; val_best_f1_score: 0.9266; train_kl_reg_loss: 59220.5390; train_edge_recon_loss: 573870.0110; train_gene_expr_recon_loss: 17938020.5191; train_masked_gp_l1_reg_loss: 106311.9820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55109.1620; train_chrom_access_recon_loss: 5574752.0611; train_global_loss: 24307284.2748; train_optim_loss: 24307284.2748; val_kl_reg_loss: 59600.9536; val_edge_recon_loss: 578647.9542; val_gene_expr_recon_loss: 18564172.1333; val_masked_gp_l1_reg_loss: 106310.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55086.0703; val_chrom_access_recon_loss: 5792963.3667; val_global_loss: 25156780.5333; val_optim_loss: 25156780.5333
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9691; val_auprc_score: 0.9599; val_best_acc_score: 0.9212; val_best_f1_score: 0.9239; train_kl_reg_loss: 59278.4259; train_edge_recon_loss: 573746.8678; train_gene_expr_recon_loss: 17941026.1221; train_masked_gp_l1_reg_loss: 106307.3602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55060.8355; train_chrom_access_recon_loss: 5578132.0916; train_global_loss: 24313551.6641; train_optim_loss: 24313551.6641; val_kl_reg_loss: 59660.7453; val_edge_recon_loss: 577854.5167; val_gene_expr_recon_loss: 18454236.9333; val_masked_gp_l1_reg_loss: 106305.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55032.1133; val_chrom_access_recon_loss: 5775426.9000; val_global_loss: 25028517.6000; val_optim_loss: 25028517.6000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9713; val_auprc_score: 0.9625; val_best_acc_score: 0.9268; val_best_f1_score: 0.9294; train_kl_reg_loss: 59197.5041; train_edge_recon_loss: 573395.9647; train_gene_expr_recon_loss: 17922610.6412; train_masked_gp_l1_reg_loss: 106305.0974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54998.8082; train_chrom_access_recon_loss: 5572057.2901; train_global_loss: 24288565.2977; train_optim_loss: 24288565.2977; val_kl_reg_loss: 59830.2701; val_edge_recon_loss: 578133.9000; val_gene_expr_recon_loss: 18581372.8000; val_masked_gp_l1_reg_loss: 106303.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54978.7930; val_chrom_access_recon_loss: 5788763.4333; val_global_loss: 25169382.2667; val_optim_loss: 25169382.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9686; val_auprc_score: 0.9523; val_best_acc_score: 0.9235; val_best_f1_score: 0.9257; train_kl_reg_loss: 59238.2095; train_edge_recon_loss: 574157.5095; train_gene_expr_recon_loss: 17947379.1679; train_masked_gp_l1_reg_loss: 106244.5251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54784.7394; train_chrom_access_recon_loss: 5574848.0115; train_global_loss: 24316652.1832; train_optim_loss: 24316652.1832; val_kl_reg_loss: 59575.6292; val_edge_recon_loss: 578541.5458; val_gene_expr_recon_loss: 18475297.7333; val_masked_gp_l1_reg_loss: 106219.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54744.9414; val_chrom_access_recon_loss: 5756698.6000; val_global_loss: 25031077.6000; val_optim_loss: 25031077.6000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9698; val_auprc_score: 0.9577; val_best_acc_score: 0.9197; val_best_f1_score: 0.9228; train_kl_reg_loss: 59201.2302; train_edge_recon_loss: 573084.0749; train_gene_expr_recon_loss: 17921486.3435; train_masked_gp_l1_reg_loss: 106213.6580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54734.8955; train_chrom_access_recon_loss: 5572875.7557; train_global_loss: 24287596.0305; train_optim_loss: 24287596.0305; val_kl_reg_loss: 59915.6102; val_edge_recon_loss: 579703.1208; val_gene_expr_recon_loss: 18466566.6667; val_masked_gp_l1_reg_loss: 106209.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54726.7656; val_chrom_access_recon_loss: 5786966.4000; val_global_loss: 25054087.7333; val_optim_loss: 25054087.7333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9741; val_auprc_score: 0.9657; val_best_acc_score: 0.9282; val_best_f1_score: 0.9305; train_kl_reg_loss: 59207.7297; train_edge_recon_loss: 575669.2152; train_gene_expr_recon_loss: 17934798.2824; train_masked_gp_l1_reg_loss: 106206.2093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54720.3765; train_chrom_access_recon_loss: 5574910.0573; train_global_loss: 24305511.6183; train_optim_loss: 24305511.6183; val_kl_reg_loss: 59396.4909; val_edge_recon_loss: 575133.4333; val_gene_expr_recon_loss: 18507244.8000; val_masked_gp_l1_reg_loss: 106203.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54714.5156; val_chrom_access_recon_loss: 5784375.7000; val_global_loss: 25087068.5333; val_optim_loss: 25087068.5333
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9724; val_auprc_score: 0.9622; val_best_acc_score: 0.9241; val_best_f1_score: 0.9275; train_kl_reg_loss: 59264.4910; train_edge_recon_loss: 574056.2438; train_gene_expr_recon_loss: 17926741.6947; train_masked_gp_l1_reg_loss: 106202.4463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54709.4575; train_chrom_access_recon_loss: 5571072.4313; train_global_loss: 24292046.7176; train_optim_loss: 24292046.7176; val_kl_reg_loss: 59618.1359; val_edge_recon_loss: 576359.1625; val_gene_expr_recon_loss: 18514980.8000; val_masked_gp_l1_reg_loss: 106200.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54704.0000; val_chrom_access_recon_loss: 5788551.1000; val_global_loss: 25100413.2000; val_optim_loss: 25100413.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 53 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9744
val AUPRC score: 0.9684
val best accuracy score: 0.9270
val best F1 score: 0.9292
val target rna MSE score: 1.2007
val source rna MSE score: 0.3698
val target atac MSE score: 0.3682
val source atac MSE score: 0.0994
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
