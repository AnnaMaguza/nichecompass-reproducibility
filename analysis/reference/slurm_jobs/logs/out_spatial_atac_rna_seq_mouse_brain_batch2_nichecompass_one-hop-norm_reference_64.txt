[True]
Run timestamp: 09102023_225420_64.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_64']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6569; val_auprc_score: 0.6436; val_best_acc_score: 0.5105; val_best_f1_score: 0.6700; train_kl_reg_loss: 51693.5966; train_edge_recon_loss: 3518208.0000; train_gene_expr_recon_loss: 14044401.2576; train_masked_gp_l1_reg_loss: 125750.6713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4583143.0038; train_chrom_access_recon_loss: 6971748.8788; train_global_loss: 29294945.3636; train_optim_loss: 29294945.3636; val_kl_reg_loss: 90055.2920; val_edge_recon_loss: 4064510.4688; val_gene_expr_recon_loss: 12967658.3750; val_masked_gp_l1_reg_loss: 102764.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2166518.0000; val_chrom_access_recon_loss: 6698580.9375; val_global_loss: 26090087.0000; val_optim_loss: 26090087.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6773; val_auprc_score: 0.6703; val_best_acc_score: 0.5744; val_best_f1_score: 0.6894; train_kl_reg_loss: 99360.5420; train_edge_recon_loss: 3524462.2273; train_gene_expr_recon_loss: 12803978.0455; train_masked_gp_l1_reg_loss: 98488.6489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1018901.7225; train_chrom_access_recon_loss: 6627301.1212; train_global_loss: 24172492.3636; train_optim_loss: 24172492.3636; val_kl_reg_loss: 105232.9795; val_edge_recon_loss: 4061026.1562; val_gene_expr_recon_loss: 12816890.2500; val_masked_gp_l1_reg_loss: 96799.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 415723.1875; val_chrom_access_recon_loss: 6724545.3750; val_global_loss: 24220218.5000; val_optim_loss: 24220218.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7483; val_auprc_score: 0.7339; val_best_acc_score: 0.6760; val_best_f1_score: 0.7115; train_kl_reg_loss: 95540.7079; train_edge_recon_loss: 3518098.4773; train_gene_expr_recon_loss: 12635919.8485; train_masked_gp_l1_reg_loss: 96992.2985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 277200.2076; train_chrom_access_recon_loss: 6568310.0606; train_global_loss: 23192061.6970; train_optim_loss: 23192061.6970; val_kl_reg_loss: 93410.4336; val_edge_recon_loss: 4038616.8125; val_gene_expr_recon_loss: 12791927.2500; val_masked_gp_l1_reg_loss: 97918.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193206.0000; val_chrom_access_recon_loss: 6688176.1875; val_global_loss: 23903254.7500; val_optim_loss: 23903254.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8210; val_auprc_score: 0.8052; val_best_acc_score: 0.7431; val_best_f1_score: 0.7625; train_kl_reg_loss: 82823.9805; train_edge_recon_loss: 3500041.3674; train_gene_expr_recon_loss: 12552280.8182; train_masked_gp_l1_reg_loss: 99628.4283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 160355.8807; train_chrom_access_recon_loss: 6533932.8864; train_global_loss: 22929063.3333; train_optim_loss: 22929063.3333; val_kl_reg_loss: 69867.1016; val_edge_recon_loss: 3833295.5625; val_gene_expr_recon_loss: 12701852.7500; val_masked_gp_l1_reg_loss: 102131.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137061.6250; val_chrom_access_recon_loss: 6717335.5625; val_global_loss: 23561545.2500; val_optim_loss: 23561545.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8364; val_auprc_score: 0.8119; val_best_acc_score: 0.7507; val_best_f1_score: 0.7886; train_kl_reg_loss: 74268.2364; train_edge_recon_loss: 3251624.7992; train_gene_expr_recon_loss: 12502563.2879; train_masked_gp_l1_reg_loss: 107352.8520; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125330.8853; train_chrom_access_recon_loss: 6496661.7576; train_global_loss: 22557801.7879; train_optim_loss: 22557801.7879; val_kl_reg_loss: 94203.9570; val_edge_recon_loss: 3035856.3750; val_gene_expr_recon_loss: 12642401.0000; val_masked_gp_l1_reg_loss: 114241.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117829.8516; val_chrom_access_recon_loss: 6553923.3750; val_global_loss: 22558456.5000; val_optim_loss: 22558456.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8526; val_auprc_score: 0.8221; val_best_acc_score: 0.7601; val_best_f1_score: 0.7964; train_kl_reg_loss: 106877.8479; train_edge_recon_loss: 2970732.9318; train_gene_expr_recon_loss: 12424691.6667; train_masked_gp_l1_reg_loss: 115230.0379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111788.7098; train_chrom_access_recon_loss: 6453990.8712; train_global_loss: 22183312.0000; train_optim_loss: 22183312.0000; val_kl_reg_loss: 104920.3359; val_edge_recon_loss: 2937354.5312; val_gene_expr_recon_loss: 12418343.6250; val_masked_gp_l1_reg_loss: 116101.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107965.7188; val_chrom_access_recon_loss: 6511592.5625; val_global_loss: 22196279.0000; val_optim_loss: 22196279.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8560; val_auprc_score: 0.8266; val_best_acc_score: 0.7673; val_best_f1_score: 0.7991; train_kl_reg_loss: 105623.3124; train_edge_recon_loss: 2943330.0644; train_gene_expr_recon_loss: 12337995.5758; train_masked_gp_l1_reg_loss: 116595.0076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106039.8562; train_chrom_access_recon_loss: 6421073.9015; train_global_loss: 22030657.7273; train_optim_loss: 22030657.7273; val_kl_reg_loss: 103843.1074; val_edge_recon_loss: 2948759.0000; val_gene_expr_recon_loss: 12308122.5000; val_masked_gp_l1_reg_loss: 117822.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104177.4297; val_chrom_access_recon_loss: 6463832.0000; val_global_loss: 22046555.7500; val_optim_loss: 22046555.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8711; val_auprc_score: 0.8358; val_best_acc_score: 0.7942; val_best_f1_score: 0.8135; train_kl_reg_loss: 101115.5846; train_edge_recon_loss: 2914471.0038; train_gene_expr_recon_loss: 12277122.9394; train_masked_gp_l1_reg_loss: 118495.1594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102204.6404; train_chrom_access_recon_loss: 6389266.5076; train_global_loss: 21902675.7879; train_optim_loss: 21902675.7879; val_kl_reg_loss: 98863.2012; val_edge_recon_loss: 2899379.3438; val_gene_expr_recon_loss: 12372307.1250; val_masked_gp_l1_reg_loss: 119404.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100136.8828; val_chrom_access_recon_loss: 6495441.8750; val_global_loss: 22085532.5000; val_optim_loss: 22085532.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8759; val_auprc_score: 0.8481; val_best_acc_score: 0.7977; val_best_f1_score: 0.8189; train_kl_reg_loss: 107631.8602; train_edge_recon_loss: 2864516.5492; train_gene_expr_recon_loss: 12221088.3788; train_masked_gp_l1_reg_loss: 120301.2609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98135.4920; train_chrom_access_recon_loss: 6368205.0000; train_global_loss: 21779878.2727; train_optim_loss: 21779878.2727; val_kl_reg_loss: 100851.6133; val_edge_recon_loss: 2881613.9062; val_gene_expr_recon_loss: 12243058.6250; val_masked_gp_l1_reg_loss: 121257.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97069.6719; val_chrom_access_recon_loss: 6404195.6250; val_global_loss: 21848047.5000; val_optim_loss: 21848047.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8843; val_auprc_score: 0.8447; val_best_acc_score: 0.8176; val_best_f1_score: 0.8290; train_kl_reg_loss: 102912.2275; train_edge_recon_loss: 2864359.0947; train_gene_expr_recon_loss: 12172719.1515; train_masked_gp_l1_reg_loss: 122099.3990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95549.0781; train_chrom_access_recon_loss: 6341344.7652; train_global_loss: 21698983.8182; train_optim_loss: 21698983.8182; val_kl_reg_loss: 99092.3633; val_edge_recon_loss: 2878217.5312; val_gene_expr_recon_loss: 12223924.7500; val_masked_gp_l1_reg_loss: 122800.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94459.5781; val_chrom_access_recon_loss: 6447384.0625; val_global_loss: 21865879.7500; val_optim_loss: 21865879.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8999; val_auprc_score: 0.8630; val_best_acc_score: 0.8380; val_best_f1_score: 0.8481; train_kl_reg_loss: 101833.6054; train_edge_recon_loss: 2823905.9811; train_gene_expr_recon_loss: 12119363.3636; train_masked_gp_l1_reg_loss: 123530.8041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92951.7942; train_chrom_access_recon_loss: 6321189.7727; train_global_loss: 21582775.2424; train_optim_loss: 21582775.2424; val_kl_reg_loss: 95114.0840; val_edge_recon_loss: 2870106.5625; val_gene_expr_recon_loss: 12307191.8750; val_masked_gp_l1_reg_loss: 124285.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92075.6484; val_chrom_access_recon_loss: 6445733.5625; val_global_loss: 21934507.2500; val_optim_loss: 21934507.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9024; val_auprc_score: 0.8641; val_best_acc_score: 0.8420; val_best_f1_score: 0.8560; train_kl_reg_loss: 101396.4853; train_edge_recon_loss: 2803202.7386; train_gene_expr_recon_loss: 12087691.1061; train_masked_gp_l1_reg_loss: 124952.6280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90734.9078; train_chrom_access_recon_loss: 6302911.8939; train_global_loss: 21510889.7576; train_optim_loss: 21510889.7576; val_kl_reg_loss: 99720.7480; val_edge_recon_loss: 2839742.8438; val_gene_expr_recon_loss: 12275121.0000; val_masked_gp_l1_reg_loss: 125526.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89586.7188; val_chrom_access_recon_loss: 6450073.8750; val_global_loss: 21879772.2500; val_optim_loss: 21879772.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9085; val_auprc_score: 0.8786; val_best_acc_score: 0.8452; val_best_f1_score: 0.8581; train_kl_reg_loss: 100263.5386; train_edge_recon_loss: 2798238.6591; train_gene_expr_recon_loss: 12049554.2273; train_masked_gp_l1_reg_loss: 126056.0099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88961.5571; train_chrom_access_recon_loss: 6282689.7424; train_global_loss: 21445763.6667; train_optim_loss: 21445763.6667; val_kl_reg_loss: 102023.3516; val_edge_recon_loss: 2817379.2188; val_gene_expr_recon_loss: 12087767.3750; val_masked_gp_l1_reg_loss: 126584.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87638.4609; val_chrom_access_recon_loss: 6328203.1875; val_global_loss: 21549596.5000; val_optim_loss: 21549596.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9065; val_auprc_score: 0.8725; val_best_acc_score: 0.8407; val_best_f1_score: 0.8558; train_kl_reg_loss: 101119.9640; train_edge_recon_loss: 2785300.1212; train_gene_expr_recon_loss: 12011720.6364; train_masked_gp_l1_reg_loss: 126993.4635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86881.5322; train_chrom_access_recon_loss: 6258787.1364; train_global_loss: 21370802.8788; train_optim_loss: 21370802.8788; val_kl_reg_loss: 98946.2178; val_edge_recon_loss: 2851395.0625; val_gene_expr_recon_loss: 11998901.7500; val_masked_gp_l1_reg_loss: 127051.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86167.6484; val_chrom_access_recon_loss: 6322606.0000; val_global_loss: 21485068.7500; val_optim_loss: 21485068.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9151; val_auprc_score: 0.8833; val_best_acc_score: 0.8541; val_best_f1_score: 0.8672; train_kl_reg_loss: 99713.6380; train_edge_recon_loss: 2802529.3712; train_gene_expr_recon_loss: 11967969.8333; train_masked_gp_l1_reg_loss: 127431.1705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85415.9170; train_chrom_access_recon_loss: 6233620.1818; train_global_loss: 21316679.8485; train_optim_loss: 21316679.8485; val_kl_reg_loss: 99176.7842; val_edge_recon_loss: 2811409.2500; val_gene_expr_recon_loss: 12079070.1250; val_masked_gp_l1_reg_loss: 127712.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84958.2188; val_chrom_access_recon_loss: 6299261.6250; val_global_loss: 21501589.0000; val_optim_loss: 21501589.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9107; val_auprc_score: 0.8771; val_best_acc_score: 0.8498; val_best_f1_score: 0.8628; train_kl_reg_loss: 100165.7144; train_edge_recon_loss: 2779762.8258; train_gene_expr_recon_loss: 11952331.1515; train_masked_gp_l1_reg_loss: 127997.0594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83985.5792; train_chrom_access_recon_loss: 6228572.8712; train_global_loss: 21272815.4242; train_optim_loss: 21272815.4242; val_kl_reg_loss: 100772.6621; val_edge_recon_loss: 2813731.2812; val_gene_expr_recon_loss: 12092860.6250; val_masked_gp_l1_reg_loss: 128449.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83493.7344; val_chrom_access_recon_loss: 6357192.3750; val_global_loss: 21576499.5000; val_optim_loss: 21576499.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9205; val_auprc_score: 0.8886; val_best_acc_score: 0.8589; val_best_f1_score: 0.8690; train_kl_reg_loss: 100298.9329; train_edge_recon_loss: 2764929.2500; train_gene_expr_recon_loss: 11914912.9545; train_masked_gp_l1_reg_loss: 128702.9344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82523.8301; train_chrom_access_recon_loss: 6205095.6970; train_global_loss: 21196463.6667; train_optim_loss: 21196463.6667; val_kl_reg_loss: 100605.8564; val_edge_recon_loss: 2797637.5938; val_gene_expr_recon_loss: 11945156.2500; val_masked_gp_l1_reg_loss: 128957.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82313.6484; val_chrom_access_recon_loss: 6298197.0625; val_global_loss: 21352868.5000; val_optim_loss: 21352868.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9157; val_auprc_score: 0.8849; val_best_acc_score: 0.8576; val_best_f1_score: 0.8690; train_kl_reg_loss: 98705.2195; train_edge_recon_loss: 2768398.6591; train_gene_expr_recon_loss: 11892129.6212; train_masked_gp_l1_reg_loss: 129081.7127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81263.7287; train_chrom_access_recon_loss: 6192958.2197; train_global_loss: 21162537.2121; train_optim_loss: 21162537.2121; val_kl_reg_loss: 98731.2207; val_edge_recon_loss: 2815586.9375; val_gene_expr_recon_loss: 11978206.0000; val_masked_gp_l1_reg_loss: 129363.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80894.6016; val_chrom_access_recon_loss: 6310527.8125; val_global_loss: 21413311.0000; val_optim_loss: 21413311.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9215; val_auprc_score: 0.8924; val_best_acc_score: 0.8649; val_best_f1_score: 0.8750; train_kl_reg_loss: 99414.8962; train_edge_recon_loss: 2758387.2197; train_gene_expr_recon_loss: 11865726.0152; train_masked_gp_l1_reg_loss: 129519.6129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80208.8497; train_chrom_access_recon_loss: 6172585.7045; train_global_loss: 21105842.3636; train_optim_loss: 21105842.3636; val_kl_reg_loss: 96073.1973; val_edge_recon_loss: 2780455.6562; val_gene_expr_recon_loss: 11997205.3750; val_masked_gp_l1_reg_loss: 130009.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79794.4844; val_chrom_access_recon_loss: 6272732.5625; val_global_loss: 21356271.0000; val_optim_loss: 21356271.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9249; val_auprc_score: 0.8979; val_best_acc_score: 0.8622; val_best_f1_score: 0.8729; train_kl_reg_loss: 97286.1703; train_edge_recon_loss: 2742772.0682; train_gene_expr_recon_loss: 11841737.2576; train_masked_gp_l1_reg_loss: 130020.0658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79261.8582; train_chrom_access_recon_loss: 6159241.6515; train_global_loss: 21050318.9394; train_optim_loss: 21050318.9394; val_kl_reg_loss: 94597.5938; val_edge_recon_loss: 2789795.9688; val_gene_expr_recon_loss: 11960902.8750; val_masked_gp_l1_reg_loss: 130445.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79150.4609; val_chrom_access_recon_loss: 6283380.6250; val_global_loss: 21338272.0000; val_optim_loss: 21338272.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9169; val_auprc_score: 0.8814; val_best_acc_score: 0.8600; val_best_f1_score: 0.8716; train_kl_reg_loss: 96477.3237; train_edge_recon_loss: 2742553.4583; train_gene_expr_recon_loss: 11807520.9394; train_masked_gp_l1_reg_loss: 130378.1272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78560.2552; train_chrom_access_recon_loss: 6138184.7348; train_global_loss: 20993674.6667; train_optim_loss: 20993674.6667; val_kl_reg_loss: 100561.9287; val_edge_recon_loss: 2801113.9062; val_gene_expr_recon_loss: 11878625.3750; val_masked_gp_l1_reg_loss: 130598.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78627.2422; val_chrom_access_recon_loss: 6205505.6875; val_global_loss: 21195032.0000; val_optim_loss: 21195032.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9368; val_auprc_score: 0.9169; val_best_acc_score: 0.8748; val_best_f1_score: 0.8829; train_kl_reg_loss: 97270.0703; train_edge_recon_loss: 2753712.6742; train_gene_expr_recon_loss: 11788576.3030; train_masked_gp_l1_reg_loss: 130646.6385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78093.5449; train_chrom_access_recon_loss: 6129852.5833; train_global_loss: 20978151.9394; train_optim_loss: 20978151.9394; val_kl_reg_loss: 95486.3428; val_edge_recon_loss: 2769408.5000; val_gene_expr_recon_loss: 11872565.8750; val_masked_gp_l1_reg_loss: 130651.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77785.5703; val_chrom_access_recon_loss: 6228278.6250; val_global_loss: 21174176.2500; val_optim_loss: 21174176.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9357; val_auprc_score: 0.9094; val_best_acc_score: 0.8780; val_best_f1_score: 0.8859; train_kl_reg_loss: 95831.1312; train_edge_recon_loss: 2747094.1477; train_gene_expr_recon_loss: 11765454.8485; train_masked_gp_l1_reg_loss: 130713.8746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77514.7250; train_chrom_access_recon_loss: 6107720.8485; train_global_loss: 20924329.4545; train_optim_loss: 20924329.4545; val_kl_reg_loss: 95140.2256; val_edge_recon_loss: 2736369.3438; val_gene_expr_recon_loss: 11934677.2500; val_masked_gp_l1_reg_loss: 131121.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77390.3984; val_chrom_access_recon_loss: 6142845.6875; val_global_loss: 21117543.5000; val_optim_loss: 21117543.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9300; val_auprc_score: 0.9039; val_best_acc_score: 0.8732; val_best_f1_score: 0.8798; train_kl_reg_loss: 95261.5047; train_edge_recon_loss: 2742682.6136; train_gene_expr_recon_loss: 11744067.6667; train_masked_gp_l1_reg_loss: 130948.7029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77179.8711; train_chrom_access_recon_loss: 6101189.8485; train_global_loss: 20891330.2424; train_optim_loss: 20891330.2424; val_kl_reg_loss: 95389.4395; val_edge_recon_loss: 2781255.9062; val_gene_expr_recon_loss: 11830268.1250; val_masked_gp_l1_reg_loss: 131335.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77108.6875; val_chrom_access_recon_loss: 6180955.7500; val_global_loss: 21096314.2500; val_optim_loss: 21096314.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9356; val_auprc_score: 0.9153; val_best_acc_score: 0.8786; val_best_f1_score: 0.8864; train_kl_reg_loss: 96246.3949; train_edge_recon_loss: 2737100.2197; train_gene_expr_recon_loss: 11725768.4091; train_masked_gp_l1_reg_loss: 131079.8582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76860.1795; train_chrom_access_recon_loss: 6083249.3258; train_global_loss: 20850304.1818; train_optim_loss: 20850304.1818; val_kl_reg_loss: 94942.2051; val_edge_recon_loss: 2753190.8750; val_gene_expr_recon_loss: 11833955.7500; val_masked_gp_l1_reg_loss: 131065.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77074.7031; val_chrom_access_recon_loss: 6228232.7500; val_global_loss: 21118462.7500; val_optim_loss: 21118462.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9272; val_auprc_score: 0.9019; val_best_acc_score: 0.8619; val_best_f1_score: 0.8712; train_kl_reg_loss: 135245.6422; train_edge_recon_loss: 2929551.6818; train_gene_expr_recon_loss: 10700558.6667; train_masked_gp_l1_reg_loss: 132011.7969; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77386.0663; train_chrom_access_recon_loss: 5663946.0000; train_global_loss: 19638699.7879; train_optim_loss: 19638699.7879; val_kl_reg_loss: 31986.8235; val_edge_recon_loss: 2841191.1250; val_gene_expr_recon_loss: 10695022.6250; val_masked_gp_l1_reg_loss: 132453.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78887.0078; val_chrom_access_recon_loss: 5630218.0000; val_global_loss: 19409758.5000; val_optim_loss: 19409758.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9222; val_auprc_score: 0.8955; val_best_acc_score: 0.8587; val_best_f1_score: 0.8697; train_kl_reg_loss: 98531.7223; train_edge_recon_loss: 2783374.4015; train_gene_expr_recon_loss: 10647883.6515; train_masked_gp_l1_reg_loss: 131430.6860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78734.6219; train_chrom_access_recon_loss: 5605504.7121; train_global_loss: 19345459.7576; train_optim_loss: 19345459.7576; val_kl_reg_loss: 45376.7354; val_edge_recon_loss: 2842110.0625; val_gene_expr_recon_loss: 10661194.1250; val_masked_gp_l1_reg_loss: 130060.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78350.4062; val_chrom_access_recon_loss: 5662721.6875; val_global_loss: 19419812.7500; val_optim_loss: 19419812.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9254; val_auprc_score: 0.9006; val_best_acc_score: 0.8619; val_best_f1_score: 0.8718; train_kl_reg_loss: 79759.3190; train_edge_recon_loss: 2763250.1742; train_gene_expr_recon_loss: 10615587.5000; train_masked_gp_l1_reg_loss: 128508.0568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77959.5882; train_chrom_access_recon_loss: 5586731.3636; train_global_loss: 19251795.9697; train_optim_loss: 19251795.9697; val_kl_reg_loss: 50255.8257; val_edge_recon_loss: 2826083.0938; val_gene_expr_recon_loss: 10757085.0000; val_masked_gp_l1_reg_loss: 126896.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77675.4531; val_chrom_access_recon_loss: 5732639.1250; val_global_loss: 19570635.2500; val_optim_loss: 19570635.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9345; val_auprc_score: 0.9099; val_best_acc_score: 0.8692; val_best_f1_score: 0.8773; train_kl_reg_loss: 75733.9228; train_edge_recon_loss: 2746030.0530; train_gene_expr_recon_loss: 10582625.0909; train_masked_gp_l1_reg_loss: 125505.9867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77090.1207; train_chrom_access_recon_loss: 5578778.5455; train_global_loss: 19185763.7879; train_optim_loss: 19185763.7879; val_kl_reg_loss: 55700.4092; val_edge_recon_loss: 2768429.4375; val_gene_expr_recon_loss: 10637375.7500; val_masked_gp_l1_reg_loss: 124304.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76734.5156; val_chrom_access_recon_loss: 5641401.8750; val_global_loss: 19303946.0000; val_optim_loss: 19303946.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9395; val_auprc_score: 0.9192; val_best_acc_score: 0.8834; val_best_f1_score: 0.8901; train_kl_reg_loss: 72480.3140; train_edge_recon_loss: 2734468.4356; train_gene_expr_recon_loss: 10550526.2121; train_masked_gp_l1_reg_loss: 123082.1527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76410.3081; train_chrom_access_recon_loss: 5561527.2803; train_global_loss: 19118494.7273; train_optim_loss: 19118494.7273; val_kl_reg_loss: 57995.5186; val_edge_recon_loss: 2728206.7500; val_gene_expr_recon_loss: 10598451.6250; val_masked_gp_l1_reg_loss: 121873.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76005.5547; val_chrom_access_recon_loss: 5633951.6250; val_global_loss: 19216484.2500; val_optim_loss: 19216484.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9362; val_auprc_score: 0.9081; val_best_acc_score: 0.8807; val_best_f1_score: 0.8887; train_kl_reg_loss: 74163.2343; train_edge_recon_loss: 2732322.6515; train_gene_expr_recon_loss: 10546821.5455; train_masked_gp_l1_reg_loss: 120724.5895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75477.9632; train_chrom_access_recon_loss: 5559670.1136; train_global_loss: 19109180.2424; train_optim_loss: 19109180.2424; val_kl_reg_loss: 62232.2031; val_edge_recon_loss: 2726007.5312; val_gene_expr_recon_loss: 10714071.2500; val_masked_gp_l1_reg_loss: 119773.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75345.1797; val_chrom_access_recon_loss: 5640927.0000; val_global_loss: 19338355.7500; val_optim_loss: 19338355.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9317; val_auprc_score: 0.9007; val_best_acc_score: 0.8737; val_best_f1_score: 0.8820; train_kl_reg_loss: 73795.1484; train_edge_recon_loss: 2728147.1591; train_gene_expr_recon_loss: 10516936.1061; train_masked_gp_l1_reg_loss: 118642.2871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75027.8652; train_chrom_access_recon_loss: 5542617.2879; train_global_loss: 19055165.8485; train_optim_loss: 19055165.8485; val_kl_reg_loss: 62157.0518; val_edge_recon_loss: 2760666.3438; val_gene_expr_recon_loss: 10624565.7500; val_masked_gp_l1_reg_loss: 117576.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75175.9766; val_chrom_access_recon_loss: 5639954.2500; val_global_loss: 19280095.2500; val_optim_loss: 19280095.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9457; val_auprc_score: 0.9256; val_best_acc_score: 0.8904; val_best_f1_score: 0.8958; train_kl_reg_loss: 71519.1641; train_edge_recon_loss: 2721095.3333; train_gene_expr_recon_loss: 10495819.4697; train_masked_gp_l1_reg_loss: 116731.3410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74516.5507; train_chrom_access_recon_loss: 5528755.8636; train_global_loss: 19008437.7576; train_optim_loss: 19008437.7576; val_kl_reg_loss: 63185.1211; val_edge_recon_loss: 2719691.0625; val_gene_expr_recon_loss: 10464049.8750; val_masked_gp_l1_reg_loss: 115917.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74772.1641; val_chrom_access_recon_loss: 5523149.8750; val_global_loss: 18960765.2500; val_optim_loss: 18960765.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9348; val_auprc_score: 0.9062; val_best_acc_score: 0.8815; val_best_f1_score: 0.8876; train_kl_reg_loss: 72075.4194; train_edge_recon_loss: 2723375.1553; train_gene_expr_recon_loss: 10481219.9394; train_masked_gp_l1_reg_loss: 115184.7842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74277.1738; train_chrom_access_recon_loss: 5522248.0909; train_global_loss: 18988380.6061; train_optim_loss: 18988380.6061; val_kl_reg_loss: 65282.5952; val_edge_recon_loss: 2736994.0938; val_gene_expr_recon_loss: 10548896.8750; val_masked_gp_l1_reg_loss: 114422.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73882.7109; val_chrom_access_recon_loss: 5585774.9375; val_global_loss: 19125254.5000; val_optim_loss: 19125254.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9365; val_auprc_score: 0.9115; val_best_acc_score: 0.8780; val_best_f1_score: 0.8846; train_kl_reg_loss: 70954.2744; train_edge_recon_loss: 2719499.5379; train_gene_expr_recon_loss: 10471403.6364; train_masked_gp_l1_reg_loss: 113728.1660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73706.2070; train_chrom_access_recon_loss: 5517663.9394; train_global_loss: 18966955.5758; train_optim_loss: 18966955.5758; val_kl_reg_loss: 65079.4600; val_edge_recon_loss: 2784711.0625; val_gene_expr_recon_loss: 10633910.8750; val_masked_gp_l1_reg_loss: 113177.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73321.9688; val_chrom_access_recon_loss: 5672794.2500; val_global_loss: 19342994.2500; val_optim_loss: 19342994.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9357; val_auprc_score: 0.9067; val_best_acc_score: 0.8842; val_best_f1_score: 0.8892; train_kl_reg_loss: 70446.1573; train_edge_recon_loss: 2714652.9432; train_gene_expr_recon_loss: 10453287.0455; train_masked_gp_l1_reg_loss: 112645.5804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73549.1433; train_chrom_access_recon_loss: 5512528.8106; train_global_loss: 18937109.6364; train_optim_loss: 18937109.6364; val_kl_reg_loss: 65980.7793; val_edge_recon_loss: 2764918.0312; val_gene_expr_recon_loss: 10598143.6250; val_masked_gp_l1_reg_loss: 111982.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73484.9922; val_chrom_access_recon_loss: 5601190.6875; val_global_loss: 19215701.0000; val_optim_loss: 19215701.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9451; val_auprc_score: 0.9259; val_best_acc_score: 0.8874; val_best_f1_score: 0.8942; train_kl_reg_loss: 71503.3124; train_edge_recon_loss: 2718231.8371; train_gene_expr_recon_loss: 10446680.7273; train_masked_gp_l1_reg_loss: 111518.5949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73191.0759; train_chrom_access_recon_loss: 5502138.7727; train_global_loss: 18923264.3333; train_optim_loss: 18923264.3333; val_kl_reg_loss: 68334.7822; val_edge_recon_loss: 2726956.2812; val_gene_expr_recon_loss: 10618258.7500; val_masked_gp_l1_reg_loss: 111130.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73271.3594; val_chrom_access_recon_loss: 5622084.1250; val_global_loss: 19220036.0000; val_optim_loss: 19220036.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9392; val_auprc_score: 0.9098; val_best_acc_score: 0.8877; val_best_f1_score: 0.8943; train_kl_reg_loss: 71856.4719; train_edge_recon_loss: 2712067.4583; train_gene_expr_recon_loss: 10417669.2273; train_masked_gp_l1_reg_loss: 108544.1637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60443.9982; train_chrom_access_recon_loss: 5490718.4697; train_global_loss: 18861299.7273; train_optim_loss: 18861299.7273; val_kl_reg_loss: 68644.4268; val_edge_recon_loss: 2730008.5625; val_gene_expr_recon_loss: 10555663.7500; val_masked_gp_l1_reg_loss: 107811.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57722.7930; val_chrom_access_recon_loss: 5603483.7500; val_global_loss: 19123335.5000; val_optim_loss: 19123335.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9435; val_auprc_score: 0.9230; val_best_acc_score: 0.8858; val_best_f1_score: 0.8915; train_kl_reg_loss: 73188.2773; train_edge_recon_loss: 2714702.6705; train_gene_expr_recon_loss: 10400265.6061; train_masked_gp_l1_reg_loss: 107685.7286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57411.2224; train_chrom_access_recon_loss: 5482635.3561; train_global_loss: 18835889.0000; train_optim_loss: 18835889.0000; val_kl_reg_loss: 66944.5645; val_edge_recon_loss: 2717173.9375; val_gene_expr_recon_loss: 10509447.3750; val_masked_gp_l1_reg_loss: 107591.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57204.3242; val_chrom_access_recon_loss: 5559026.6875; val_global_loss: 19017388.5000; val_optim_loss: 19017388.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9373; val_auprc_score: 0.9109; val_best_acc_score: 0.8818; val_best_f1_score: 0.8878; train_kl_reg_loss: 73846.9240; train_edge_recon_loss: 2703872.7614; train_gene_expr_recon_loss: 10396509.5909; train_masked_gp_l1_reg_loss: 107506.3033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56997.3641; train_chrom_access_recon_loss: 5478870.4848; train_global_loss: 18817603.4848; train_optim_loss: 18817603.4848; val_kl_reg_loss: 67173.0371; val_edge_recon_loss: 2732110.8438; val_gene_expr_recon_loss: 10500333.1250; val_masked_gp_l1_reg_loss: 107440.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56885.4297; val_chrom_access_recon_loss: 5586485.4375; val_global_loss: 19050428.5000; val_optim_loss: 19050428.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9383; val_auprc_score: 0.9083; val_best_acc_score: 0.8855; val_best_f1_score: 0.8916; train_kl_reg_loss: 74517.8287; train_edge_recon_loss: 2706010.1629; train_gene_expr_recon_loss: 10401671.3939; train_masked_gp_l1_reg_loss: 107380.4010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56690.9454; train_chrom_access_recon_loss: 5476560.8712; train_global_loss: 18822831.5455; train_optim_loss: 18822831.5455; val_kl_reg_loss: 67906.5049; val_edge_recon_loss: 2741176.3438; val_gene_expr_recon_loss: 10515893.0000; val_masked_gp_l1_reg_loss: 107339.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56657.0273; val_chrom_access_recon_loss: 5509704.6875; val_global_loss: 18998676.2500; val_optim_loss: 18998676.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 55 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9321
val AUPRC score: 0.9020
val best accuracy score: 0.8802
val best F1 score: 0.8857
val target rna MSE score: 2.8837
val source rna MSE score: 1.3979
val target atac MSE score: 0.3289
val source atac MSE score: 0.1357
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
