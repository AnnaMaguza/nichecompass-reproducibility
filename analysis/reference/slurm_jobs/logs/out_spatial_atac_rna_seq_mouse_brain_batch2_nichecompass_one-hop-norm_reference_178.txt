[True]
Run timestamp: 10102023_070008_178.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_178']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7987; val_auprc_score: 0.8155; val_best_acc_score: 0.5605; val_best_f1_score: 0.6917; train_kl_reg_loss: 66308.8748; train_edge_recon_loss: 741575.5988; train_gene_expr_recon_loss: 22050730.4733; train_masked_gp_l1_reg_loss: 89500.1038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2406105.3135; train_chrom_access_recon_loss: 953462.1803; train_global_loss: 26307682.5954; train_optim_loss: 26307682.5954; val_kl_reg_loss: 82513.5349; val_edge_recon_loss: 812363.9500; val_gene_expr_recon_loss: 21091938.5333; val_masked_gp_l1_reg_loss: 74231.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 912126.2500; val_chrom_access_recon_loss: 932772.6042; val_global_loss: 23905946.6667; val_optim_loss: 23905946.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8884; val_auprc_score: 0.8894; val_best_acc_score: 0.7918; val_best_f1_score: 0.8130; train_kl_reg_loss: 69663.9204; train_edge_recon_loss: 728586.3254; train_gene_expr_recon_loss: 20956556.0611; train_masked_gp_l1_reg_loss: 75334.9588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 484706.5050; train_chrom_access_recon_loss: 922718.3311; train_global_loss: 23237566.0611; train_optim_loss: 23237566.0611; val_kl_reg_loss: 56746.8638; val_edge_recon_loss: 775053.4208; val_gene_expr_recon_loss: 20746538.0000; val_masked_gp_l1_reg_loss: 78151.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 265792.5312; val_chrom_access_recon_loss: 922330.8500; val_global_loss: 22844613.2000; val_optim_loss: 22844613.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9165; val_auprc_score: 0.9045; val_best_acc_score: 0.8424; val_best_f1_score: 0.8519; train_kl_reg_loss: 66091.3238; train_edge_recon_loss: 674536.7519; train_gene_expr_recon_loss: 20642846.0458; train_masked_gp_l1_reg_loss: 79925.1991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204347.0047; train_chrom_access_recon_loss: 912658.4642; train_global_loss: 22580404.6412; train_optim_loss: 22580404.6412; val_kl_reg_loss: 70826.3604; val_edge_recon_loss: 632416.2375; val_gene_expr_recon_loss: 20436382.5333; val_masked_gp_l1_reg_loss: 81219.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163095.2656; val_chrom_access_recon_loss: 916331.1375; val_global_loss: 22300272.1333; val_optim_loss: 22300272.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9281; val_auprc_score: 0.9181; val_best_acc_score: 0.8530; val_best_f1_score: 0.8634; train_kl_reg_loss: 72253.4630; train_edge_recon_loss: 621650.6560; train_gene_expr_recon_loss: 20419277.4198; train_masked_gp_l1_reg_loss: 82980.8701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141082.1052; train_chrom_access_recon_loss: 904637.8865; train_global_loss: 22241882.3511; train_optim_loss: 22241882.3511; val_kl_reg_loss: 73474.1693; val_edge_recon_loss: 611886.2042; val_gene_expr_recon_loss: 20181470.5333; val_masked_gp_l1_reg_loss: 84809.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124348.1484; val_chrom_access_recon_loss: 903095.7125; val_global_loss: 21979084.6667; val_optim_loss: 21979084.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9334; val_auprc_score: 0.9218; val_best_acc_score: 0.8672; val_best_f1_score: 0.8751; train_kl_reg_loss: 70201.7336; train_edge_recon_loss: 607990.2290; train_gene_expr_recon_loss: 20216744.7939; train_masked_gp_l1_reg_loss: 86206.2788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114510.9608; train_chrom_access_recon_loss: 895608.5868; train_global_loss: 21991262.5954; train_optim_loss: 21991262.5954; val_kl_reg_loss: 68977.7344; val_edge_recon_loss: 608764.3583; val_gene_expr_recon_loss: 20023532.9333; val_masked_gp_l1_reg_loss: 87626.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107638.5703; val_chrom_access_recon_loss: 896090.6875; val_global_loss: 21792629.4667; val_optim_loss: 21792629.4667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9450; val_auprc_score: 0.9338; val_best_acc_score: 0.8764; val_best_f1_score: 0.8824; train_kl_reg_loss: 67925.9842; train_edge_recon_loss: 601370.7047; train_gene_expr_recon_loss: 20080710.1985; train_masked_gp_l1_reg_loss: 88624.7231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101032.0552; train_chrom_access_recon_loss: 890145.8917; train_global_loss: 21829809.5725; train_optim_loss: 21829809.5725; val_kl_reg_loss: 67850.8828; val_edge_recon_loss: 601159.9292; val_gene_expr_recon_loss: 19870468.0000; val_masked_gp_l1_reg_loss: 89480.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96013.6406; val_chrom_access_recon_loss: 886711.1625; val_global_loss: 21611683.6000; val_optim_loss: 21611683.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9460; val_auprc_score: 0.9354; val_best_acc_score: 0.8801; val_best_f1_score: 0.8863; train_kl_reg_loss: 66234.1187; train_edge_recon_loss: 595492.0043; train_gene_expr_recon_loss: 19917254.3359; train_masked_gp_l1_reg_loss: 90460.4802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93325.3494; train_chrom_access_recon_loss: 882903.2099; train_global_loss: 21645669.4504; train_optim_loss: 21645669.4504; val_kl_reg_loss: 70466.9917; val_edge_recon_loss: 594473.0792; val_gene_expr_recon_loss: 19833799.8667; val_masked_gp_l1_reg_loss: 91452.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91086.2266; val_chrom_access_recon_loss: 883611.0042; val_global_loss: 21564888.9333; val_optim_loss: 21564888.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9529; val_auprc_score: 0.9386; val_best_acc_score: 0.8944; val_best_f1_score: 0.8991; train_kl_reg_loss: 65262.1312; train_edge_recon_loss: 591341.8344; train_gene_expr_recon_loss: 19815074.5954; train_masked_gp_l1_reg_loss: 91870.8029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88362.4540; train_chrom_access_recon_loss: 878053.8516; train_global_loss: 21529965.5573; train_optim_loss: 21529965.5573; val_kl_reg_loss: 62223.8828; val_edge_recon_loss: 588620.1167; val_gene_expr_recon_loss: 19685898.4000; val_masked_gp_l1_reg_loss: 92902.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86951.3516; val_chrom_access_recon_loss: 883811.8250; val_global_loss: 21400408.0000; val_optim_loss: 21400408.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9579; val_auprc_score: 0.9458; val_best_acc_score: 0.8988; val_best_f1_score: 0.9028; train_kl_reg_loss: 63399.9473; train_edge_recon_loss: 589958.2285; train_gene_expr_recon_loss: 19666253.5878; train_masked_gp_l1_reg_loss: 93250.1809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84761.2681; train_chrom_access_recon_loss: 872144.4461; train_global_loss: 21369767.6641; train_optim_loss: 21369767.6641; val_kl_reg_loss: 61540.3818; val_edge_recon_loss: 586393.1958; val_gene_expr_recon_loss: 19664298.0000; val_masked_gp_l1_reg_loss: 93700.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84061.6094; val_chrom_access_recon_loss: 882310.2667; val_global_loss: 21372303.7333; val_optim_loss: 21372303.7333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9624; val_auprc_score: 0.9543; val_best_acc_score: 0.9015; val_best_f1_score: 0.9063; train_kl_reg_loss: 62761.2125; train_edge_recon_loss: 585631.8588; train_gene_expr_recon_loss: 19568932.3053; train_masked_gp_l1_reg_loss: 94353.8835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82543.0859; train_chrom_access_recon_loss: 867624.3965; train_global_loss: 21261846.7023; train_optim_loss: 21261846.7023; val_kl_reg_loss: 63584.8904; val_edge_recon_loss: 584674.5417; val_gene_expr_recon_loss: 19416060.1333; val_masked_gp_l1_reg_loss: 95060.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82446.9844; val_chrom_access_recon_loss: 869727.1000; val_global_loss: 21111552.4000; val_optim_loss: 21111552.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9582; val_auprc_score: 0.9468; val_best_acc_score: 0.9018; val_best_f1_score: 0.9047; train_kl_reg_loss: 61780.4956; train_edge_recon_loss: 584841.3044; train_gene_expr_recon_loss: 19455099.2672; train_masked_gp_l1_reg_loss: 95541.4538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80708.9102; train_chrom_access_recon_loss: 862850.5520; train_global_loss: 21140821.9084; train_optim_loss: 21140821.9084; val_kl_reg_loss: 62001.7648; val_edge_recon_loss: 585269.1875; val_gene_expr_recon_loss: 19432077.2000; val_masked_gp_l1_reg_loss: 96364.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81000.8047; val_chrom_access_recon_loss: 869849.3417; val_global_loss: 21126561.3333; val_optim_loss: 21126561.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9619; val_auprc_score: 0.9526; val_best_acc_score: 0.9030; val_best_f1_score: 0.9076; train_kl_reg_loss: 60541.6290; train_edge_recon_loss: 583622.2433; train_gene_expr_recon_loss: 19388468.9160; train_masked_gp_l1_reg_loss: 96671.0634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78977.9405; train_chrom_access_recon_loss: 860342.4323; train_global_loss: 21068624.1374; train_optim_loss: 21068624.1374; val_kl_reg_loss: 60407.2911; val_edge_recon_loss: 585473.6875; val_gene_expr_recon_loss: 19344421.8667; val_masked_gp_l1_reg_loss: 97325.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79146.4141; val_chrom_access_recon_loss: 864857.0125; val_global_loss: 21031632.0000; val_optim_loss: 21031632.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9589; val_auprc_score: 0.9453; val_best_acc_score: 0.9054; val_best_f1_score: 0.9093; train_kl_reg_loss: 59975.2459; train_edge_recon_loss: 581109.6312; train_gene_expr_recon_loss: 19295964.1069; train_masked_gp_l1_reg_loss: 98010.2834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77570.1702; train_chrom_access_recon_loss: 856073.8678; train_global_loss: 20968703.2824; train_optim_loss: 20968703.2824; val_kl_reg_loss: 58898.8372; val_edge_recon_loss: 584778.5333; val_gene_expr_recon_loss: 19232687.8667; val_masked_gp_l1_reg_loss: 99025.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76614.7344; val_chrom_access_recon_loss: 862364.0542; val_global_loss: 20914369.4667; val_optim_loss: 20914369.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9591; val_auprc_score: 0.9468; val_best_acc_score: 0.9047; val_best_f1_score: 0.9090; train_kl_reg_loss: 58711.4173; train_edge_recon_loss: 581616.9361; train_gene_expr_recon_loss: 19188598.3817; train_masked_gp_l1_reg_loss: 99743.9001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75909.4338; train_chrom_access_recon_loss: 852000.0916; train_global_loss: 20856580.1069; train_optim_loss: 20856580.1069; val_kl_reg_loss: 58648.4362; val_edge_recon_loss: 584336.7833; val_gene_expr_recon_loss: 19114311.7333; val_masked_gp_l1_reg_loss: 100859.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75216.6250; val_chrom_access_recon_loss: 855269.5208; val_global_loss: 20788642.6667; val_optim_loss: 20788642.6667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9580; val_auprc_score: 0.9442; val_best_acc_score: 0.9062; val_best_f1_score: 0.9100; train_kl_reg_loss: 57775.0832; train_edge_recon_loss: 582062.5272; train_gene_expr_recon_loss: 19093212.3206; train_masked_gp_l1_reg_loss: 102017.4921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74883.7547; train_chrom_access_recon_loss: 849260.2419; train_global_loss: 20759211.2366; train_optim_loss: 20759211.2366; val_kl_reg_loss: 57418.9828; val_edge_recon_loss: 582929.4917; val_gene_expr_recon_loss: 18992485.3333; val_masked_gp_l1_reg_loss: 103410.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74140.4688; val_chrom_access_recon_loss: 849870.3750; val_global_loss: 20660254.2667; val_optim_loss: 20660254.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9501; val_auprc_score: 0.9311; val_best_acc_score: 0.8956; val_best_f1_score: 0.9008; train_kl_reg_loss: 56756.0186; train_edge_recon_loss: 581759.9437; train_gene_expr_recon_loss: 18990305.1756; train_masked_gp_l1_reg_loss: 104870.1596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74086.0352; train_chrom_access_recon_loss: 846291.8378; train_global_loss: 20654069.1603; train_optim_loss: 20654069.1603; val_kl_reg_loss: 56762.0065; val_edge_recon_loss: 588464.8958; val_gene_expr_recon_loss: 18892844.2667; val_masked_gp_l1_reg_loss: 106417.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74762.4766; val_chrom_access_recon_loss: 850112.9750; val_global_loss: 20569364.1333; val_optim_loss: 20569364.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9545; val_auprc_score: 0.9369; val_best_acc_score: 0.9046; val_best_f1_score: 0.9089; train_kl_reg_loss: 56400.1255; train_edge_recon_loss: 582155.5448; train_gene_expr_recon_loss: 18870333.4504; train_masked_gp_l1_reg_loss: 108011.7938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73718.7640; train_chrom_access_recon_loss: 843175.9752; train_global_loss: 20533795.5725; train_optim_loss: 20533795.5725; val_kl_reg_loss: 55618.6430; val_edge_recon_loss: 583032.3625; val_gene_expr_recon_loss: 18787756.5333; val_masked_gp_l1_reg_loss: 109555.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74464.2656; val_chrom_access_recon_loss: 852238.4958; val_global_loss: 20462665.7333; val_optim_loss: 20462665.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9518; val_auprc_score: 0.9347; val_best_acc_score: 0.8989; val_best_f1_score: 0.9041; train_kl_reg_loss: 56279.1172; train_edge_recon_loss: 581897.7705; train_gene_expr_recon_loss: 18761105.2290; train_masked_gp_l1_reg_loss: 111130.6907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73761.0122; train_chrom_access_recon_loss: 841821.7805; train_global_loss: 20425995.4504; train_optim_loss: 20425995.4504; val_kl_reg_loss: 55514.4672; val_edge_recon_loss: 584260.9375; val_gene_expr_recon_loss: 18681677.7333; val_masked_gp_l1_reg_loss: 112646.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73876.2734; val_chrom_access_recon_loss: 843757.2542; val_global_loss: 20351732.5333; val_optim_loss: 20351732.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9553; val_auprc_score: 0.9373; val_best_acc_score: 0.9069; val_best_f1_score: 0.9095; train_kl_reg_loss: 55991.5974; train_edge_recon_loss: 581863.2385; train_gene_expr_recon_loss: 18642380.4580; train_masked_gp_l1_reg_loss: 114153.6552; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73824.4959; train_chrom_access_recon_loss: 838953.6770; train_global_loss: 20307167.1450; train_optim_loss: 20307167.1450; val_kl_reg_loss: 56466.8773; val_edge_recon_loss: 583935.7333; val_gene_expr_recon_loss: 18711602.2667; val_masked_gp_l1_reg_loss: 115486.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73535.4922; val_chrom_access_recon_loss: 845565.7375; val_global_loss: 20386592.8000; val_optim_loss: 20386592.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9568; val_auprc_score: 0.9403; val_best_acc_score: 0.9049; val_best_f1_score: 0.9094; train_kl_reg_loss: 56684.8478; train_edge_recon_loss: 580442.2953; train_gene_expr_recon_loss: 18553070.0305; train_masked_gp_l1_reg_loss: 116857.3993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73780.0038; train_chrom_access_recon_loss: 838087.7409; train_global_loss: 20218922.1679; train_optim_loss: 20218922.1679; val_kl_reg_loss: 57221.6562; val_edge_recon_loss: 581822.6542; val_gene_expr_recon_loss: 18637591.3333; val_masked_gp_l1_reg_loss: 118238.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74397.7031; val_chrom_access_recon_loss: 847942.7042; val_global_loss: 20317214.0000; val_optim_loss: 20317214.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9518; val_auprc_score: 0.9328; val_best_acc_score: 0.8979; val_best_f1_score: 0.9030; train_kl_reg_loss: 57144.2972; train_edge_recon_loss: 580887.9447; train_gene_expr_recon_loss: 18434508.6107; train_masked_gp_l1_reg_loss: 119272.8743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73963.0902; train_chrom_access_recon_loss: 834646.0945; train_global_loss: 20100422.8092; train_optim_loss: 20100422.8092; val_kl_reg_loss: 57420.8648; val_edge_recon_loss: 584723.7292; val_gene_expr_recon_loss: 18521455.2000; val_masked_gp_l1_reg_loss: 120415.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73638.3984; val_chrom_access_recon_loss: 842857.1542; val_global_loss: 20200510.6667; val_optim_loss: 20200510.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9487; val_auprc_score: 0.9294; val_best_acc_score: 0.8968; val_best_f1_score: 0.9026; train_kl_reg_loss: 57745.0292; train_edge_recon_loss: 581525.4909; train_gene_expr_recon_loss: 18346209.8168; train_masked_gp_l1_reg_loss: 121287.3898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74009.8290; train_chrom_access_recon_loss: 833577.4237; train_global_loss: 20014354.9466; train_optim_loss: 20014354.9466; val_kl_reg_loss: 58419.8823; val_edge_recon_loss: 585802.3292; val_gene_expr_recon_loss: 18402276.0000; val_masked_gp_l1_reg_loss: 122239.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73985.0391; val_chrom_access_recon_loss: 842688.8292; val_global_loss: 20085413.2000; val_optim_loss: 20085413.2000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9476; val_auprc_score: 0.9280; val_best_acc_score: 0.8934; val_best_f1_score: 0.9011; train_kl_reg_loss: 58351.0889; train_edge_recon_loss: 581904.0778; train_gene_expr_recon_loss: 18262060.7481; train_masked_gp_l1_reg_loss: 123117.4498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74291.7244; train_chrom_access_recon_loss: 831573.6145; train_global_loss: 19931298.6718; train_optim_loss: 19931298.6718; val_kl_reg_loss: 59359.5380; val_edge_recon_loss: 585338.1083; val_gene_expr_recon_loss: 18372045.0667; val_masked_gp_l1_reg_loss: 123936.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75203.3281; val_chrom_access_recon_loss: 841810.0292; val_global_loss: 20057692.6667; val_optim_loss: 20057692.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9336; val_auprc_score: 0.9100; val_best_acc_score: 0.8744; val_best_f1_score: 0.8824; train_kl_reg_loss: 57937.6143; train_edge_recon_loss: 587858.0797; train_gene_expr_recon_loss: 18261230.7786; train_masked_gp_l1_reg_loss: 124837.1472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75275.0444; train_chrom_access_recon_loss: 831635.9423; train_global_loss: 19938774.5191; train_optim_loss: 19938774.5191; val_kl_reg_loss: 46230.3482; val_edge_recon_loss: 672842.3083; val_gene_expr_recon_loss: 19008329.7333; val_masked_gp_l1_reg_loss: 130521.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79047.4766; val_chrom_access_recon_loss: 853677.5042; val_global_loss: 20790649.7333; val_optim_loss: 20790649.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9494; val_auprc_score: 0.9268; val_best_acc_score: 0.8984; val_best_f1_score: 0.9032; train_kl_reg_loss: 52458.5943; train_edge_recon_loss: 596578.7681; train_gene_expr_recon_loss: 18580578.9008; train_masked_gp_l1_reg_loss: 124471.2087; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74163.4766; train_chrom_access_recon_loss: 834321.7448; train_global_loss: 20262572.4885; train_optim_loss: 20262572.4885; val_kl_reg_loss: 57757.1628; val_edge_recon_loss: 585849.4000; val_gene_expr_recon_loss: 18476052.9333; val_masked_gp_l1_reg_loss: 120673.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74350.8828; val_chrom_access_recon_loss: 837020.9583; val_global_loss: 20151704.8000; val_optim_loss: 20151704.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9549; val_auprc_score: 0.9378; val_best_acc_score: 0.9018; val_best_f1_score: 0.9068; train_kl_reg_loss: 58557.0786; train_edge_recon_loss: 583477.6913; train_gene_expr_recon_loss: 18348316.9008; train_masked_gp_l1_reg_loss: 120267.7442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72814.7115; train_chrom_access_recon_loss: 830429.5525; train_global_loss: 20013863.6183; train_optim_loss: 20013863.6183; val_kl_reg_loss: 58767.6667; val_edge_recon_loss: 585707.5917; val_gene_expr_recon_loss: 18477394.6667; val_masked_gp_l1_reg_loss: 120679.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73889.0625; val_chrom_access_recon_loss: 841270.4542; val_global_loss: 20157710.2667; val_optim_loss: 20157710.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9532; val_auprc_score: 0.9357; val_best_acc_score: 0.9038; val_best_f1_score: 0.9084; train_kl_reg_loss: 58638.6593; train_edge_recon_loss: 583149.2934; train_gene_expr_recon_loss: 18254404.3511; train_masked_gp_l1_reg_loss: 120997.7854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72926.7352; train_chrom_access_recon_loss: 827428.0530; train_global_loss: 19917544.7634; train_optim_loss: 19917544.7634; val_kl_reg_loss: 59350.9242; val_edge_recon_loss: 586087.4875; val_gene_expr_recon_loss: 18340709.2000; val_masked_gp_l1_reg_loss: 121372.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73041.5000; val_chrom_access_recon_loss: 838903.6875; val_global_loss: 20019465.2000; val_optim_loss: 20019465.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9537; val_auprc_score: 0.9365; val_best_acc_score: 0.9034; val_best_f1_score: 0.9079; train_kl_reg_loss: 58881.9084; train_edge_recon_loss: 582925.8230; train_gene_expr_recon_loss: 18177714.7328; train_masked_gp_l1_reg_loss: 122055.6366; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73270.9351; train_chrom_access_recon_loss: 826880.3721; train_global_loss: 19841729.4504; train_optim_loss: 19841729.4504; val_kl_reg_loss: 60032.4216; val_edge_recon_loss: 583535.9917; val_gene_expr_recon_loss: 18292799.7333; val_masked_gp_l1_reg_loss: 122827.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74333.8828; val_chrom_access_recon_loss: 837644.5583; val_global_loss: 19971175.0667; val_optim_loss: 19971175.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9517; val_auprc_score: 0.9356; val_best_acc_score: 0.9020; val_best_f1_score: 0.9070; train_kl_reg_loss: 59706.1896; train_edge_recon_loss: 582562.8893; train_gene_expr_recon_loss: 18131346.2748; train_masked_gp_l1_reg_loss: 123157.2316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74203.2518; train_chrom_access_recon_loss: 825771.4823; train_global_loss: 19796747.2214; train_optim_loss: 19796747.2214; val_kl_reg_loss: 57984.0437; val_edge_recon_loss: 589546.5250; val_gene_expr_recon_loss: 18334253.2000; val_masked_gp_l1_reg_loss: 125363.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75366.4766; val_chrom_access_recon_loss: 836478.7667; val_global_loss: 20018992.4000; val_optim_loss: 20018992.4000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9578; val_auprc_score: 0.9441; val_best_acc_score: 0.9058; val_best_f1_score: 0.9101; train_kl_reg_loss: 60447.2216; train_edge_recon_loss: 582897.7047; train_gene_expr_recon_loss: 18103826.5878; train_masked_gp_l1_reg_loss: 124803.2682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74935.0237; train_chrom_access_recon_loss: 825619.0143; train_global_loss: 19772528.7176; train_optim_loss: 19772528.7176; val_kl_reg_loss: 61669.4044; val_edge_recon_loss: 584533.8667; val_gene_expr_recon_loss: 18286318.0000; val_masked_gp_l1_reg_loss: 124194.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75096.4141; val_chrom_access_recon_loss: 832849.5542; val_global_loss: 19964660.5333; val_optim_loss: 19964660.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9543; val_auprc_score: 0.9419; val_best_acc_score: 0.8979; val_best_f1_score: 0.9022; train_kl_reg_loss: 61603.6539; train_edge_recon_loss: 584164.9523; train_gene_expr_recon_loss: 18102932.1374; train_masked_gp_l1_reg_loss: 124412.4114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75282.4331; train_chrom_access_recon_loss: 824177.7638; train_global_loss: 19772573.3435; train_optim_loss: 19772573.3435; val_kl_reg_loss: 66180.1680; val_edge_recon_loss: 604852.0250; val_gene_expr_recon_loss: 18767323.0667; val_masked_gp_l1_reg_loss: 126346.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76717.6875; val_chrom_access_recon_loss: 846506.7417; val_global_loss: 20487926.0000; val_optim_loss: 20487926.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9382; val_auprc_score: 0.9244; val_best_acc_score: 0.8738; val_best_f1_score: 0.8810; train_kl_reg_loss: 189681.4591; train_edge_recon_loss: 680345.9623; train_gene_expr_recon_loss: 19607255.7863; train_masked_gp_l1_reg_loss: 172800.6311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102073.7343; train_chrom_access_recon_loss: 891119.9031; train_global_loss: 21643277.4198; train_optim_loss: 21643277.4198; val_kl_reg_loss: 65426.9563; val_edge_recon_loss: 652832.4375; val_gene_expr_recon_loss: 19355698.0000; val_masked_gp_l1_reg_loss: 197505.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93199.3594; val_chrom_access_recon_loss: 864627.5333; val_global_loss: 21229290.9333; val_optim_loss: 21229290.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9337; val_auprc_score: 0.9265; val_best_acc_score: 0.8607; val_best_f1_score: 0.8654; train_kl_reg_loss: 90359.2717; train_edge_recon_loss: 659581.0802; train_gene_expr_recon_loss: 19690192.9466; train_masked_gp_l1_reg_loss: 179286.6896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91933.2982; train_chrom_access_recon_loss: 877461.7939; train_global_loss: 21588815.1145; train_optim_loss: 21588815.1145; val_kl_reg_loss: 1706797.7109; val_edge_recon_loss: 738136.7125; val_gene_expr_recon_loss: 19619937.3333; val_masked_gp_l1_reg_loss: 196502.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102737.7656; val_chrom_access_recon_loss: 883858.6708; val_global_loss: 23247970.2667; val_optim_loss: 23247970.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9391; val_auprc_score: 0.9235; val_best_acc_score: 0.8733; val_best_f1_score: 0.8819; train_kl_reg_loss: 299958.3024; train_edge_recon_loss: 676942.5573; train_gene_expr_recon_loss: 19699706.1527; train_masked_gp_l1_reg_loss: 207228.8182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95378.9513; train_chrom_access_recon_loss: 871515.9647; train_global_loss: 21850730.7786; train_optim_loss: 21850730.7786; val_kl_reg_loss: 91793.3089; val_edge_recon_loss: 620140.6250; val_gene_expr_recon_loss: 19153070.6667; val_masked_gp_l1_reg_loss: 193528.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80816.2266; val_chrom_access_recon_loss: 849717.8625; val_global_loss: 20989066.6667; val_optim_loss: 20989066.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9345; val_auprc_score: 0.9187; val_best_acc_score: 0.8682; val_best_f1_score: 0.8761; train_kl_reg_loss: 73752.1274; train_edge_recon_loss: 620584.1665; train_gene_expr_recon_loss: 19212481.8168; train_masked_gp_l1_reg_loss: 189644.8489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59996.6549; train_chrom_access_recon_loss: 845319.4652; train_global_loss: 21001778.9771; train_optim_loss: 21001778.9771; val_kl_reg_loss: 73943.0745; val_edge_recon_loss: 624820.3583; val_gene_expr_recon_loss: 19098433.3333; val_masked_gp_l1_reg_loss: 187341.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55645.2695; val_chrom_access_recon_loss: 850168.4875; val_global_loss: 20890353.0667; val_optim_loss: 20890353.0667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9326; val_auprc_score: 0.9159; val_best_acc_score: 0.8646; val_best_f1_score: 0.8728; train_kl_reg_loss: 72875.9667; train_edge_recon_loss: 616338.5344; train_gene_expr_recon_loss: 19125914.0611; train_masked_gp_l1_reg_loss: 186029.2483; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55005.1976; train_chrom_access_recon_loss: 840355.1651; train_global_loss: 20896518.3206; train_optim_loss: 20896518.3206; val_kl_reg_loss: 73761.1484; val_edge_recon_loss: 617324.4125; val_gene_expr_recon_loss: 19017008.6667; val_masked_gp_l1_reg_loss: 184616.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54490.8125; val_chrom_access_recon_loss: 843088.4750; val_global_loss: 20790288.6667; val_optim_loss: 20790288.6667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9344; val_auprc_score: 0.9172; val_best_acc_score: 0.8735; val_best_f1_score: 0.8808; train_kl_reg_loss: 72554.3287; train_edge_recon_loss: 613173.8063; train_gene_expr_recon_loss: 19006188.3817; train_masked_gp_l1_reg_loss: 183321.8915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54049.2370; train_chrom_access_recon_loss: 837271.9084; train_global_loss: 20766559.5725; train_optim_loss: 20766559.5725; val_kl_reg_loss: 73015.9781; val_edge_recon_loss: 614891.1292; val_gene_expr_recon_loss: 18975050.2667; val_masked_gp_l1_reg_loss: 181891.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53697.9336; val_chrom_access_recon_loss: 839725.1833; val_global_loss: 20738272.5333; val_optim_loss: 20738272.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9323; val_auprc_score: 0.9127; val_best_acc_score: 0.8717; val_best_f1_score: 0.8786; train_kl_reg_loss: 72998.3903; train_edge_recon_loss: 609848.1846; train_gene_expr_recon_loss: 18989432.8397; train_masked_gp_l1_reg_loss: 180627.7672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53455.4102; train_chrom_access_recon_loss: 836449.6460; train_global_loss: 20742812.1679; train_optim_loss: 20742812.1679; val_kl_reg_loss: 73792.2880; val_edge_recon_loss: 610239.9583; val_gene_expr_recon_loss: 18977766.5333; val_masked_gp_l1_reg_loss: 179472.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53382.7227; val_chrom_access_recon_loss: 844816.6208; val_global_loss: 20739469.3333; val_optim_loss: 20739469.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 22 min 19 sec.
Using best model state, which was in epoch 30.

--- MODEL EVALUATION ---
val AUROC score: 0.9546
val AUPRC score: 0.9385
val best accuracy score: 0.9030
val best F1 score: 0.9086
val target rna MSE score: 1.3187
val source rna MSE score: 0.4290
val target atac MSE score: 0.5196
val source atac MSE score: 0.1499
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
