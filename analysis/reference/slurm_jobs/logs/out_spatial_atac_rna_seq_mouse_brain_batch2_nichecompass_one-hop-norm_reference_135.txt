[True]
Run timestamp: 10102023_040201_135.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_135']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6742; val_auprc_score: 0.6489; val_best_acc_score: 0.5013; val_best_f1_score: 0.6671; train_kl_reg_loss: 61704.2162; train_edge_recon_loss: 3518302.2765; train_gene_expr_recon_loss: 13878522.4697; train_masked_gp_l1_reg_loss: 32176.6961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3564486.7064; train_chrom_access_recon_loss: 11502666.3485; train_global_loss: 32557858.3333; train_optim_loss: 32557858.3333; val_kl_reg_loss: 141815.9199; val_edge_recon_loss: 4065413.5312; val_gene_expr_recon_loss: 13346058.0000; val_masked_gp_l1_reg_loss: 37814.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1918773.8750; val_chrom_access_recon_loss: 11502129.0000; val_global_loss: 31012005.0000; val_optim_loss: 31012005.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6944; val_auprc_score: 0.6573; val_best_acc_score: 0.5339; val_best_f1_score: 0.6798; train_kl_reg_loss: 100002.0857; train_edge_recon_loss: 3527900.5795; train_gene_expr_recon_loss: 12873915.0758; train_masked_gp_l1_reg_loss: 40963.3586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1033284.7486; train_chrom_access_recon_loss: 11023316.7424; train_global_loss: 28599382.6667; train_optim_loss: 28599382.6667; val_kl_reg_loss: 96037.2217; val_edge_recon_loss: 4063236.2188; val_gene_expr_recon_loss: 12956740.2500; val_masked_gp_l1_reg_loss: 43357.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 514956.6562; val_chrom_access_recon_loss: 11128400.8750; val_global_loss: 28802728.7500; val_optim_loss: 28802728.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7145; val_auprc_score: 0.6889; val_best_acc_score: 0.6499; val_best_f1_score: 0.7066; train_kl_reg_loss: 92433.5404; train_edge_recon_loss: 3514128.3788; train_gene_expr_recon_loss: 12675985.9242; train_masked_gp_l1_reg_loss: 44210.7652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 352894.3793; train_chrom_access_recon_loss: 10915279.0758; train_global_loss: 27594932.1818; train_optim_loss: 27594932.1818; val_kl_reg_loss: 104323.4668; val_edge_recon_loss: 4050936.1875; val_gene_expr_recon_loss: 13017414.7500; val_masked_gp_l1_reg_loss: 45232.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 250979.1250; val_chrom_access_recon_loss: 11129496.2500; val_global_loss: 28598382.7500; val_optim_loss: 28598382.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7798; val_auprc_score: 0.7578; val_best_acc_score: 0.6886; val_best_f1_score: 0.7368; train_kl_reg_loss: 81926.9437; train_edge_recon_loss: 3504251.9811; train_gene_expr_recon_loss: 12580811.0303; train_masked_gp_l1_reg_loss: 46315.2538; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 205571.2325; train_chrom_access_recon_loss: 10844087.8485; train_global_loss: 27262964.2727; train_optim_loss: 27262964.2727; val_kl_reg_loss: 71038.5518; val_edge_recon_loss: 3955054.9688; val_gene_expr_recon_loss: 12881372.1250; val_masked_gp_l1_reg_loss: 47790.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 174696.2344; val_chrom_access_recon_loss: 10992112.6250; val_global_loss: 28122064.2500; val_optim_loss: 28122064.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8440; val_auprc_score: 0.8129; val_best_acc_score: 0.7749; val_best_f1_score: 0.8024; train_kl_reg_loss: 66645.0559; train_edge_recon_loss: 3368021.7992; train_gene_expr_recon_loss: 12507123.2273; train_masked_gp_l1_reg_loss: 49439.2063; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154570.8345; train_chrom_access_recon_loss: 10780267.3030; train_global_loss: 26926067.3333; train_optim_loss: 26926067.3333; val_kl_reg_loss: 75925.4561; val_edge_recon_loss: 3116952.4375; val_gene_expr_recon_loss: 12777000.2500; val_masked_gp_l1_reg_loss: 51975.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 138950.5625; val_chrom_access_recon_loss: 10954770.7500; val_global_loss: 27115574.7500; val_optim_loss: 27115574.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8496; val_auprc_score: 0.8197; val_best_acc_score: 0.7711; val_best_f1_score: 0.7952; train_kl_reg_loss: 100318.4891; train_edge_recon_loss: 2973753.4470; train_gene_expr_recon_loss: 12420819.1818; train_masked_gp_l1_reg_loss: 53911.7362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129356.6481; train_chrom_access_recon_loss: 10710951.3939; train_global_loss: 26389110.8485; train_optim_loss: 26389110.8485; val_kl_reg_loss: 104300.5986; val_edge_recon_loss: 2986591.5625; val_gene_expr_recon_loss: 12820832.5000; val_masked_gp_l1_reg_loss: 55494.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121846.8594; val_chrom_access_recon_loss: 11120620.7500; val_global_loss: 27209686.7500; val_optim_loss: 27209686.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8737; val_auprc_score: 0.8366; val_best_acc_score: 0.8076; val_best_f1_score: 0.8302; train_kl_reg_loss: 103987.4651; train_edge_recon_loss: 2895950.6742; train_gene_expr_recon_loss: 12337591.9242; train_masked_gp_l1_reg_loss: 56525.5458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114870.8029; train_chrom_access_recon_loss: 10646347.8333; train_global_loss: 26155274.2121; train_optim_loss: 26155274.2121; val_kl_reg_loss: 104205.4658; val_edge_recon_loss: 2889515.6562; val_gene_expr_recon_loss: 12612135.1250; val_masked_gp_l1_reg_loss: 57600.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109046.2109; val_chrom_access_recon_loss: 10856736.1250; val_global_loss: 26629238.5000; val_optim_loss: 26629238.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8835; val_auprc_score: 0.8464; val_best_acc_score: 0.8195; val_best_f1_score: 0.8336; train_kl_reg_loss: 102269.2129; train_edge_recon_loss: 2850649.3561; train_gene_expr_recon_loss: 12281350.1364; train_masked_gp_l1_reg_loss: 58552.4640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104876.6044; train_chrom_access_recon_loss: 10607288.1667; train_global_loss: 26004985.8485; train_optim_loss: 26004985.8485; val_kl_reg_loss: 102178.6631; val_edge_recon_loss: 2859597.8438; val_gene_expr_recon_loss: 12730397.0000; val_masked_gp_l1_reg_loss: 59605.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101832.9688; val_chrom_access_recon_loss: 11010137.5000; val_global_loss: 26863749.5000; val_optim_loss: 26863749.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8792; val_auprc_score: 0.8352; val_best_acc_score: 0.8192; val_best_f1_score: 0.8353; train_kl_reg_loss: 102757.0993; train_edge_recon_loss: 2836952.0530; train_gene_expr_recon_loss: 12229418.1818; train_masked_gp_l1_reg_loss: 60543.8459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98485.8667; train_chrom_access_recon_loss: 10578562.9242; train_global_loss: 25906720.1212; train_optim_loss: 25906720.1212; val_kl_reg_loss: 106663.7861; val_edge_recon_loss: 2883329.3438; val_gene_expr_recon_loss: 12506561.1250; val_masked_gp_l1_reg_loss: 61560.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95794.7812; val_chrom_access_recon_loss: 10813200.6250; val_global_loss: 26467110.7500; val_optim_loss: 26467110.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8909; val_auprc_score: 0.8564; val_best_acc_score: 0.8259; val_best_f1_score: 0.8395; train_kl_reg_loss: 100011.9721; train_edge_recon_loss: 2834788.8258; train_gene_expr_recon_loss: 12176552.7273; train_masked_gp_l1_reg_loss: 62349.6545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93129.2000; train_chrom_access_recon_loss: 10526285.4242; train_global_loss: 25793117.9091; train_optim_loss: 25793117.9091; val_kl_reg_loss: 103021.8691; val_edge_recon_loss: 2866622.8125; val_gene_expr_recon_loss: 12510833.0000; val_masked_gp_l1_reg_loss: 63156.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91881.8047; val_chrom_access_recon_loss: 10774457.8750; val_global_loss: 26409973.5000; val_optim_loss: 26409973.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9034; val_auprc_score: 0.8731; val_best_acc_score: 0.8318; val_best_f1_score: 0.8479; train_kl_reg_loss: 97001.8714; train_edge_recon_loss: 2807044.8333; train_gene_expr_recon_loss: 12126059.5606; train_masked_gp_l1_reg_loss: 63876.4904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90089.3668; train_chrom_access_recon_loss: 10497878.8636; train_global_loss: 25681950.8182; train_optim_loss: 25681950.8182; val_kl_reg_loss: 95681.4482; val_edge_recon_loss: 2850285.8750; val_gene_expr_recon_loss: 12426851.3750; val_masked_gp_l1_reg_loss: 64642.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88888.1641; val_chrom_access_recon_loss: 10803968.0000; val_global_loss: 26330317.7500; val_optim_loss: 26330317.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9084; val_auprc_score: 0.8821; val_best_acc_score: 0.8447; val_best_f1_score: 0.8579; train_kl_reg_loss: 93798.5698; train_edge_recon_loss: 2806170.3030; train_gene_expr_recon_loss: 12074646.6667; train_masked_gp_l1_reg_loss: 65247.0492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87048.4316; train_chrom_access_recon_loss: 10460153.0606; train_global_loss: 25587064.0909; train_optim_loss: 25587064.0909; val_kl_reg_loss: 91285.8174; val_edge_recon_loss: 2815563.1250; val_gene_expr_recon_loss: 12331514.0000; val_masked_gp_l1_reg_loss: 65914.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85681.7500; val_chrom_access_recon_loss: 10622354.1250; val_global_loss: 26012314.0000; val_optim_loss: 26012314.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9081; val_auprc_score: 0.8812; val_best_acc_score: 0.8452; val_best_f1_score: 0.8579; train_kl_reg_loss: 92183.7201; train_edge_recon_loss: 2789331.4205; train_gene_expr_recon_loss: 12046405.2879; train_masked_gp_l1_reg_loss: 66523.5200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84336.5361; train_chrom_access_recon_loss: 10437541.0606; train_global_loss: 25516321.4545; train_optim_loss: 25516321.4545; val_kl_reg_loss: 95773.2344; val_edge_recon_loss: 2812805.2812; val_gene_expr_recon_loss: 12315913.2500; val_masked_gp_l1_reg_loss: 67078.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83140.3203; val_chrom_access_recon_loss: 10587056.0000; val_global_loss: 25961766.2500; val_optim_loss: 25961766.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9241; val_auprc_score: 0.9004; val_best_acc_score: 0.8576; val_best_f1_score: 0.8654; train_kl_reg_loss: 92665.1353; train_edge_recon_loss: 2777622.6553; train_gene_expr_recon_loss: 11993455.8939; train_masked_gp_l1_reg_loss: 67549.2224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81837.1616; train_chrom_access_recon_loss: 10387447.5303; train_global_loss: 25400577.5455; train_optim_loss: 25400577.5455; val_kl_reg_loss: 91322.9980; val_edge_recon_loss: 2782149.7500; val_gene_expr_recon_loss: 12249611.1250; val_masked_gp_l1_reg_loss: 68053.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80756.7266; val_chrom_access_recon_loss: 10645356.5000; val_global_loss: 25917251.5000; val_optim_loss: 25917251.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9164; val_auprc_score: 0.8848; val_best_acc_score: 0.8576; val_best_f1_score: 0.8686; train_kl_reg_loss: 91265.4065; train_edge_recon_loss: 2769275.2879; train_gene_expr_recon_loss: 11960486.9242; train_masked_gp_l1_reg_loss: 68543.5247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79810.9938; train_chrom_access_recon_loss: 10353737.2121; train_global_loss: 25323119.4545; train_optim_loss: 25323119.4545; val_kl_reg_loss: 91427.3877; val_edge_recon_loss: 2776868.9062; val_gene_expr_recon_loss: 12194654.7500; val_masked_gp_l1_reg_loss: 69005.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79064.3672; val_chrom_access_recon_loss: 10556202.3750; val_global_loss: 25767222.7500; val_optim_loss: 25767222.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9254; val_auprc_score: 0.9017; val_best_acc_score: 0.8638; val_best_f1_score: 0.8728; train_kl_reg_loss: 90041.9811; train_edge_recon_loss: 2762584.2197; train_gene_expr_recon_loss: 11932372.1212; train_masked_gp_l1_reg_loss: 69472.7756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78085.5879; train_chrom_access_recon_loss: 10333548.7879; train_global_loss: 25266105.4545; train_optim_loss: 25266105.4545; val_kl_reg_loss: 95814.5244; val_edge_recon_loss: 2780506.0938; val_gene_expr_recon_loss: 12200387.0000; val_masked_gp_l1_reg_loss: 69876.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77022.6641; val_chrom_access_recon_loss: 10674645.0000; val_global_loss: 25898252.2500; val_optim_loss: 25898252.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9203; val_auprc_score: 0.8940; val_best_acc_score: 0.8646; val_best_f1_score: 0.8746; train_kl_reg_loss: 91377.4670; train_edge_recon_loss: 2751587.9621; train_gene_expr_recon_loss: 11887209.9697; train_masked_gp_l1_reg_loss: 70254.8030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76671.5401; train_chrom_access_recon_loss: 10297322.9242; train_global_loss: 25174424.4848; train_optim_loss: 25174424.4848; val_kl_reg_loss: 94757.8438; val_edge_recon_loss: 2784350.0312; val_gene_expr_recon_loss: 12216512.5000; val_masked_gp_l1_reg_loss: 70625.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76021.7812; val_chrom_access_recon_loss: 10579888.1250; val_global_loss: 25822155.0000; val_optim_loss: 25822155.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9169; val_auprc_score: 0.8810; val_best_acc_score: 0.8616; val_best_f1_score: 0.8691; train_kl_reg_loss: 89045.9814; train_edge_recon_loss: 2744416.8144; train_gene_expr_recon_loss: 11859373.0606; train_masked_gp_l1_reg_loss: 71007.2554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75547.2463; train_chrom_access_recon_loss: 10267507.9848; train_global_loss: 25106898.3030; train_optim_loss: 25106898.3030; val_kl_reg_loss: 89708.1533; val_edge_recon_loss: 2835340.3125; val_gene_expr_recon_loss: 12168719.6250; val_masked_gp_l1_reg_loss: 71348.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74580.4609; val_chrom_access_recon_loss: 10504288.0000; val_global_loss: 25743985.2500; val_optim_loss: 25743985.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9238; val_auprc_score: 0.8899; val_best_acc_score: 0.8611; val_best_f1_score: 0.8724; train_kl_reg_loss: 88127.8839; train_edge_recon_loss: 2749385.3485; train_gene_expr_recon_loss: 11836160.9091; train_masked_gp_l1_reg_loss: 71704.6773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74096.2103; train_chrom_access_recon_loss: 10236139.1061; train_global_loss: 25055614.0000; train_optim_loss: 25055614.0000; val_kl_reg_loss: 91884.0889; val_edge_recon_loss: 2794410.1562; val_gene_expr_recon_loss: 12194867.6250; val_masked_gp_l1_reg_loss: 72139.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73996.7891; val_chrom_access_recon_loss: 10475623.6250; val_global_loss: 25702921.7500; val_optim_loss: 25702921.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9325; val_auprc_score: 0.9085; val_best_acc_score: 0.8726; val_best_f1_score: 0.8791; train_kl_reg_loss: 85715.0192; train_edge_recon_loss: 2745896.7538; train_gene_expr_recon_loss: 11818942.8030; train_masked_gp_l1_reg_loss: 72442.8023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73426.3263; train_chrom_access_recon_loss: 10221466.6212; train_global_loss: 25017890.4545; train_optim_loss: 25017890.4545; val_kl_reg_loss: 87946.7900; val_edge_recon_loss: 2778052.3125; val_gene_expr_recon_loss: 12008779.0000; val_masked_gp_l1_reg_loss: 72807.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73134.7422; val_chrom_access_recon_loss: 10337119.6250; val_global_loss: 25357840.2500; val_optim_loss: 25357840.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9298; val_auprc_score: 0.9060; val_best_acc_score: 0.8729; val_best_f1_score: 0.8795; train_kl_reg_loss: 86035.1222; train_edge_recon_loss: 2736496.9697; train_gene_expr_recon_loss: 11782732.8636; train_masked_gp_l1_reg_loss: 73122.7339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72778.8594; train_chrom_access_recon_loss: 10174610.2273; train_global_loss: 24925776.8182; train_optim_loss: 24925776.8182; val_kl_reg_loss: 88411.4814; val_edge_recon_loss: 2784709.5312; val_gene_expr_recon_loss: 12065106.8750; val_masked_gp_l1_reg_loss: 73313.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71969.7578; val_chrom_access_recon_loss: 10337294.5000; val_global_loss: 25420805.7500; val_optim_loss: 25420805.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9345; val_auprc_score: 0.9086; val_best_acc_score: 0.8756; val_best_f1_score: 0.8814; train_kl_reg_loss: 86497.3937; train_edge_recon_loss: 2731315.4470; train_gene_expr_recon_loss: 11761790.2879; train_masked_gp_l1_reg_loss: 73553.9909; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71597.8003; train_chrom_access_recon_loss: 10157304.8788; train_global_loss: 24882059.8788; train_optim_loss: 24882059.8788; val_kl_reg_loss: 87016.0576; val_edge_recon_loss: 2734371.4062; val_gene_expr_recon_loss: 12077129.0000; val_masked_gp_l1_reg_loss: 73872.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71725.7656; val_chrom_access_recon_loss: 10530672.8750; val_global_loss: 25574788.0000; val_optim_loss: 25574788.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9368; val_auprc_score: 0.9118; val_best_acc_score: 0.8753; val_best_f1_score: 0.8824; train_kl_reg_loss: 85207.5603; train_edge_recon_loss: 2732379.0606; train_gene_expr_recon_loss: 11723984.9697; train_masked_gp_l1_reg_loss: 74033.6251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71273.0218; train_chrom_access_recon_loss: 10115850.0909; train_global_loss: 24802728.3939; train_optim_loss: 24802728.3939; val_kl_reg_loss: 84679.9902; val_edge_recon_loss: 2778471.3438; val_gene_expr_recon_loss: 11985775.5000; val_masked_gp_l1_reg_loss: 74246.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70650.0703; val_chrom_access_recon_loss: 10386101.2500; val_global_loss: 25379924.5000; val_optim_loss: 25379924.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9391; val_auprc_score: 0.9165; val_best_acc_score: 0.8837; val_best_f1_score: 0.8895; train_kl_reg_loss: 85766.0736; train_edge_recon_loss: 2718186.0189; train_gene_expr_recon_loss: 11715507.8788; train_masked_gp_l1_reg_loss: 74366.8616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70397.3219; train_chrom_access_recon_loss: 10100750.4091; train_global_loss: 24764974.1515; train_optim_loss: 24764974.1515; val_kl_reg_loss: 88567.3975; val_edge_recon_loss: 2743715.2188; val_gene_expr_recon_loss: 12038198.5000; val_masked_gp_l1_reg_loss: 74610.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70315.8203; val_chrom_access_recon_loss: 10337485.2500; val_global_loss: 25352893.2500; val_optim_loss: 25352893.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9432; val_auprc_score: 0.9227; val_best_acc_score: 0.8888; val_best_f1_score: 0.8944; train_kl_reg_loss: 83880.7861; train_edge_recon_loss: 2719016.2538; train_gene_expr_recon_loss: 11689929.6061; train_masked_gp_l1_reg_loss: 74777.8131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70069.6673; train_chrom_access_recon_loss: 10072475.2273; train_global_loss: 24710149.3939; train_optim_loss: 24710149.3939; val_kl_reg_loss: 86439.8643; val_edge_recon_loss: 2749654.5312; val_gene_expr_recon_loss: 11973083.2500; val_masked_gp_l1_reg_loss: 75005.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70425.6562; val_chrom_access_recon_loss: 10337634.8750; val_global_loss: 25292244.7500; val_optim_loss: 25292244.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9519; val_auprc_score: 0.9369; val_best_acc_score: 0.8952; val_best_f1_score: 0.9001; train_kl_reg_loss: 82940.1661; train_edge_recon_loss: 2716099.1288; train_gene_expr_recon_loss: 11688962.4545; train_masked_gp_l1_reg_loss: 75227.5394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70176.9660; train_chrom_access_recon_loss: 10059184.2879; train_global_loss: 24692590.6061; train_optim_loss: 24692590.6061; val_kl_reg_loss: 84777.6982; val_edge_recon_loss: 2745424.2188; val_gene_expr_recon_loss: 11895278.1250; val_masked_gp_l1_reg_loss: 75537.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70587.3750; val_chrom_access_recon_loss: 10260384.3750; val_global_loss: 25131989.5000; val_optim_loss: 25131989.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9458; val_auprc_score: 0.9258; val_best_acc_score: 0.8920; val_best_f1_score: 0.8977; train_kl_reg_loss: 82478.3960; train_edge_recon_loss: 2716597.7462; train_gene_expr_recon_loss: 11659249.6818; train_masked_gp_l1_reg_loss: 75652.7296; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69925.2908; train_chrom_access_recon_loss: 10030971.8788; train_global_loss: 24634875.8485; train_optim_loss: 24634875.8485; val_kl_reg_loss: 85451.3936; val_edge_recon_loss: 2737507.1562; val_gene_expr_recon_loss: 11992364.5000; val_masked_gp_l1_reg_loss: 75692.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69521.4453; val_chrom_access_recon_loss: 10375913.3750; val_global_loss: 25336449.7500; val_optim_loss: 25336449.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9508; val_auprc_score: 0.9320; val_best_acc_score: 0.8998; val_best_f1_score: 0.9041; train_kl_reg_loss: 82267.7044; train_edge_recon_loss: 2716543.7235; train_gene_expr_recon_loss: 11635927.4242; train_masked_gp_l1_reg_loss: 75882.2700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69541.9601; train_chrom_access_recon_loss: 9995078.1061; train_global_loss: 24575241.0303; train_optim_loss: 24575241.0303; val_kl_reg_loss: 84971.8848; val_edge_recon_loss: 2733399.1562; val_gene_expr_recon_loss: 11881594.2500; val_masked_gp_l1_reg_loss: 76032.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69614.0078; val_chrom_access_recon_loss: 10368386.1250; val_global_loss: 25213997.2500; val_optim_loss: 25213997.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9460; val_auprc_score: 0.9195; val_best_acc_score: 0.8917; val_best_f1_score: 0.8973; train_kl_reg_loss: 81947.7741; train_edge_recon_loss: 2716733.5038; train_gene_expr_recon_loss: 11608729.5606; train_masked_gp_l1_reg_loss: 76177.9228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69496.4979; train_chrom_access_recon_loss: 9954798.9848; train_global_loss: 24507884.1818; train_optim_loss: 24507884.1818; val_kl_reg_loss: 82797.0850; val_edge_recon_loss: 2734926.6562; val_gene_expr_recon_loss: 11912206.5000; val_masked_gp_l1_reg_loss: 76390.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69816.4844; val_chrom_access_recon_loss: 10220214.3750; val_global_loss: 25096351.7500; val_optim_loss: 25096351.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9516; val_auprc_score: 0.9278; val_best_acc_score: 0.9027; val_best_f1_score: 0.9065; train_kl_reg_loss: 82344.3330; train_edge_recon_loss: 2697566.3712; train_gene_expr_recon_loss: 11602493.5303; train_masked_gp_l1_reg_loss: 76505.3230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69557.6407; train_chrom_access_recon_loss: 9945588.5000; train_global_loss: 24474055.5455; train_optim_loss: 24474055.5455; val_kl_reg_loss: 82884.9873; val_edge_recon_loss: 2747533.1562; val_gene_expr_recon_loss: 12001380.2500; val_masked_gp_l1_reg_loss: 76637.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69577.3125; val_chrom_access_recon_loss: 10258398.3750; val_global_loss: 25236411.0000; val_optim_loss: 25236411.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9532; val_auprc_score: 0.9372; val_best_acc_score: 0.9041; val_best_f1_score: 0.9073; train_kl_reg_loss: 79999.0696; train_edge_recon_loss: 2711631.8826; train_gene_expr_recon_loss: 11588907.8788; train_masked_gp_l1_reg_loss: 76719.5443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69545.3681; train_chrom_access_recon_loss: 9915858.5000; train_global_loss: 24442662.1212; train_optim_loss: 24442662.1212; val_kl_reg_loss: 82054.0625; val_edge_recon_loss: 2747094.0312; val_gene_expr_recon_loss: 11845520.1250; val_masked_gp_l1_reg_loss: 76775.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69505.9688; val_chrom_access_recon_loss: 10208895.6250; val_global_loss: 25029846.2500; val_optim_loss: 25029846.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9527; val_auprc_score: 0.9365; val_best_acc_score: 0.9025; val_best_f1_score: 0.9063; train_kl_reg_loss: 81062.5482; train_edge_recon_loss: 2701090.1705; train_gene_expr_recon_loss: 11567301.1515; train_masked_gp_l1_reg_loss: 76912.0120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69488.5545; train_chrom_access_recon_loss: 9886045.5000; train_global_loss: 24381900.1515; train_optim_loss: 24381900.1515; val_kl_reg_loss: 80889.4502; val_edge_recon_loss: 2742963.5938; val_gene_expr_recon_loss: 11785205.1250; val_masked_gp_l1_reg_loss: 77020.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69502.0312; val_chrom_access_recon_loss: 10171861.6250; val_global_loss: 24927441.5000; val_optim_loss: 24927441.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9513; val_auprc_score: 0.9286; val_best_acc_score: 0.9095; val_best_f1_score: 0.9122; train_kl_reg_loss: 80285.7166; train_edge_recon_loss: 2703872.2576; train_gene_expr_recon_loss: 11565252.4697; train_masked_gp_l1_reg_loss: 77124.8382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69831.6412; train_chrom_access_recon_loss: 9873105.8030; train_global_loss: 24369472.8788; train_optim_loss: 24369472.8788; val_kl_reg_loss: 81895.0498; val_edge_recon_loss: 2715081.4688; val_gene_expr_recon_loss: 11884778.1250; val_masked_gp_l1_reg_loss: 77193.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69621.3516; val_chrom_access_recon_loss: 10213102.5000; val_global_loss: 25041672.0000; val_optim_loss: 25041672.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9553; val_auprc_score: 0.9389; val_best_acc_score: 0.9060; val_best_f1_score: 0.9116; train_kl_reg_loss: 80693.9180; train_edge_recon_loss: 2694624.3902; train_gene_expr_recon_loss: 11541461.7879; train_masked_gp_l1_reg_loss: 77260.7725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69881.8357; train_chrom_access_recon_loss: 9842812.2273; train_global_loss: 24306734.9394; train_optim_loss: 24306734.9394; val_kl_reg_loss: 81287.1299; val_edge_recon_loss: 2711230.6875; val_gene_expr_recon_loss: 11873138.6250; val_masked_gp_l1_reg_loss: 77282.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70063.9062; val_chrom_access_recon_loss: 10174667.5000; val_global_loss: 24987671.5000; val_optim_loss: 24987671.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9496; val_auprc_score: 0.9260; val_best_acc_score: 0.9017; val_best_f1_score: 0.9061; train_kl_reg_loss: 79015.7657; train_edge_recon_loss: 2700337.7083; train_gene_expr_recon_loss: 11527560.8485; train_masked_gp_l1_reg_loss: 77385.9825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70009.2492; train_chrom_access_recon_loss: 9808575.7424; train_global_loss: 24262885.3939; train_optim_loss: 24262885.3939; val_kl_reg_loss: 80357.4014; val_edge_recon_loss: 2741890.4375; val_gene_expr_recon_loss: 11806259.8750; val_masked_gp_l1_reg_loss: 77555.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70488.5938; val_chrom_access_recon_loss: 10097347.2500; val_global_loss: 24873900.7500; val_optim_loss: 24873900.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9551; val_auprc_score: 0.9415; val_best_acc_score: 0.9049; val_best_f1_score: 0.9094; train_kl_reg_loss: 79227.4233; train_edge_recon_loss: 2690910.5833; train_gene_expr_recon_loss: 11507887.3485; train_masked_gp_l1_reg_loss: 77611.9581; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70571.4426; train_chrom_access_recon_loss: 9783385.6212; train_global_loss: 24209594.3636; train_optim_loss: 24209594.3636; val_kl_reg_loss: 83108.6963; val_edge_recon_loss: 2726159.1562; val_gene_expr_recon_loss: 11816217.3750; val_masked_gp_l1_reg_loss: 77660.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70486.0078; val_chrom_access_recon_loss: 10121361.5000; val_global_loss: 24894992.5000; val_optim_loss: 24894992.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9567; val_auprc_score: 0.9401; val_best_acc_score: 0.9073; val_best_f1_score: 0.9111; train_kl_reg_loss: 78280.2011; train_edge_recon_loss: 2699922.9280; train_gene_expr_recon_loss: 11504939.9697; train_masked_gp_l1_reg_loss: 77668.6068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70721.3165; train_chrom_access_recon_loss: 9772441.4394; train_global_loss: 24203974.5455; train_optim_loss: 24203974.5455; val_kl_reg_loss: 81862.6006; val_edge_recon_loss: 2747870.7812; val_gene_expr_recon_loss: 11766842.7500; val_masked_gp_l1_reg_loss: 77753.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71265.2734; val_chrom_access_recon_loss: 10036941.1250; val_global_loss: 24782535.2500; val_optim_loss: 24782535.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9595; val_auprc_score: 0.9420; val_best_acc_score: 0.9103; val_best_f1_score: 0.9124; train_kl_reg_loss: 79381.4413; train_edge_recon_loss: 2687694.1402; train_gene_expr_recon_loss: 11491424.3485; train_masked_gp_l1_reg_loss: 77744.4299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71015.4452; train_chrom_access_recon_loss: 9748735.1667; train_global_loss: 24155994.9091; train_optim_loss: 24155994.9091; val_kl_reg_loss: 78945.3330; val_edge_recon_loss: 2729483.8750; val_gene_expr_recon_loss: 11862142.2500; val_masked_gp_l1_reg_loss: 77845.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71051.4922; val_chrom_access_recon_loss: 10134584.7500; val_global_loss: 24954051.7500; val_optim_loss: 24954051.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9624; val_auprc_score: 0.9520; val_best_acc_score: 0.9127; val_best_f1_score: 0.9165; train_kl_reg_loss: 78063.8717; train_edge_recon_loss: 2690666.4129; train_gene_expr_recon_loss: 11482868.3939; train_masked_gp_l1_reg_loss: 77870.4104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71088.8679; train_chrom_access_recon_loss: 9726889.9091; train_global_loss: 24127447.8182; train_optim_loss: 24127447.8182; val_kl_reg_loss: 78439.8252; val_edge_recon_loss: 2725561.0625; val_gene_expr_recon_loss: 11756741.0000; val_masked_gp_l1_reg_loss: 77898.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71034.6484; val_chrom_access_recon_loss: 10065486.7500; val_global_loss: 24775162.2500; val_optim_loss: 24775162.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9619; val_auprc_score: 0.9442; val_best_acc_score: 0.9170; val_best_f1_score: 0.9207; train_kl_reg_loss: 77468.2285; train_edge_recon_loss: 2690909.4773; train_gene_expr_recon_loss: 11471844.0909; train_masked_gp_l1_reg_loss: 77945.0353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71229.0245; train_chrom_access_recon_loss: 9707997.1818; train_global_loss: 24097393.2121; train_optim_loss: 24097393.2121; val_kl_reg_loss: 77109.6123; val_edge_recon_loss: 2704528.2500; val_gene_expr_recon_loss: 11886796.2500; val_masked_gp_l1_reg_loss: 77934.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71657.7734; val_chrom_access_recon_loss: 10221865.3750; val_global_loss: 25039892.5000; val_optim_loss: 25039892.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9615; val_auprc_score: 0.9459; val_best_acc_score: 0.9138; val_best_f1_score: 0.9169; train_kl_reg_loss: 76614.8835; train_edge_recon_loss: 2679702.1856; train_gene_expr_recon_loss: 11452985.7121; train_masked_gp_l1_reg_loss: 77957.3777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71584.0610; train_chrom_access_recon_loss: 9671832.6818; train_global_loss: 24030676.8788; train_optim_loss: 24030676.8788; val_kl_reg_loss: 79375.7295; val_edge_recon_loss: 2713706.9688; val_gene_expr_recon_loss: 11758134.7500; val_masked_gp_l1_reg_loss: 78022.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71607.6562; val_chrom_access_recon_loss: 10163182.3750; val_global_loss: 24864031.2500; val_optim_loss: 24864031.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9603; val_auprc_score: 0.9418; val_best_acc_score: 0.9121; val_best_f1_score: 0.9156; train_kl_reg_loss: 76425.2958; train_edge_recon_loss: 2688618.4621; train_gene_expr_recon_loss: 11443801.3030; train_masked_gp_l1_reg_loss: 78027.1813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71539.7560; train_chrom_access_recon_loss: 9662006.0455; train_global_loss: 24020418.2424; train_optim_loss: 24020418.2424; val_kl_reg_loss: 76476.4326; val_edge_recon_loss: 2744031.3438; val_gene_expr_recon_loss: 11682279.0000; val_masked_gp_l1_reg_loss: 78107.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71503.5078; val_chrom_access_recon_loss: 10024819.0000; val_global_loss: 24677216.7500; val_optim_loss: 24677216.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9588; val_auprc_score: 0.9401; val_best_acc_score: 0.9116; val_best_f1_score: 0.9159; train_kl_reg_loss: 76676.8449; train_edge_recon_loss: 2680701.7311; train_gene_expr_recon_loss: 11434971.3636; train_masked_gp_l1_reg_loss: 78082.6138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71495.9845; train_chrom_access_recon_loss: 9638490.0303; train_global_loss: 23980418.7879; train_optim_loss: 23980418.7879; val_kl_reg_loss: 75774.9072; val_edge_recon_loss: 2733768.2812; val_gene_expr_recon_loss: 11814135.0000; val_masked_gp_l1_reg_loss: 78077.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71410.5078; val_chrom_access_recon_loss: 10122764.3750; val_global_loss: 24895931.2500; val_optim_loss: 24895931.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9601; val_auprc_score: 0.9454; val_best_acc_score: 0.9159; val_best_f1_score: 0.9191; train_kl_reg_loss: 76838.2607; train_edge_recon_loss: 2681511.8068; train_gene_expr_recon_loss: 11425725.8485; train_masked_gp_l1_reg_loss: 77986.2562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71543.6835; train_chrom_access_recon_loss: 9617432.4242; train_global_loss: 23951038.3333; train_optim_loss: 23951038.3333; val_kl_reg_loss: 78640.3223; val_edge_recon_loss: 2730806.8438; val_gene_expr_recon_loss: 11700430.8750; val_masked_gp_l1_reg_loss: 77941.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71589.1328; val_chrom_access_recon_loss: 10052636.2500; val_global_loss: 24712044.2500; val_optim_loss: 24712044.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9624; val_auprc_score: 0.9482; val_best_acc_score: 0.9156; val_best_f1_score: 0.9194; train_kl_reg_loss: 75634.5367; train_edge_recon_loss: 2687812.9242; train_gene_expr_recon_loss: 11406817.1212; train_masked_gp_l1_reg_loss: 77917.5682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71588.6657; train_chrom_access_recon_loss: 9587576.6970; train_global_loss: 23907347.6970; train_optim_loss: 23907347.6970; val_kl_reg_loss: 77707.6152; val_edge_recon_loss: 2705671.7188; val_gene_expr_recon_loss: 11750105.5000; val_masked_gp_l1_reg_loss: 78000.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72040.8672; val_chrom_access_recon_loss: 10082310.8750; val_global_loss: 24765838.0000; val_optim_loss: 24765838.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9613; val_auprc_score: 0.9431; val_best_acc_score: 0.9146; val_best_f1_score: 0.9180; train_kl_reg_loss: 75421.2274; train_edge_recon_loss: 2688321.0417; train_gene_expr_recon_loss: 11405061.0606; train_masked_gp_l1_reg_loss: 77906.9407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71782.3991; train_chrom_access_recon_loss: 9572832.9242; train_global_loss: 23891325.5152; train_optim_loss: 23891325.5152; val_kl_reg_loss: 78342.5869; val_edge_recon_loss: 2746675.2812; val_gene_expr_recon_loss: 11695238.5000; val_masked_gp_l1_reg_loss: 77818.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71849.8594; val_chrom_access_recon_loss: 9957492.0000; val_global_loss: 24627416.5000; val_optim_loss: 24627416.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9588; val_auprc_score: 0.9436; val_best_acc_score: 0.9097; val_best_f1_score: 0.9138; train_kl_reg_loss: 75279.7618; train_edge_recon_loss: 2693166.4886; train_gene_expr_recon_loss: 11399075.6970; train_masked_gp_l1_reg_loss: 77811.4091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71776.8666; train_chrom_access_recon_loss: 9556998.1818; train_global_loss: 23874108.3333; train_optim_loss: 23874108.3333; val_kl_reg_loss: 76292.9844; val_edge_recon_loss: 2760666.2500; val_gene_expr_recon_loss: 11814142.7500; val_masked_gp_l1_reg_loss: 77811.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72228.5391; val_chrom_access_recon_loss: 10152721.1250; val_global_loss: 24953863.0000; val_optim_loss: 24953863.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9576; val_auprc_score: 0.9375; val_best_acc_score: 0.9108; val_best_f1_score: 0.9155; train_kl_reg_loss: 75040.5961; train_edge_recon_loss: 2690935.9356; train_gene_expr_recon_loss: 11390025.6212; train_masked_gp_l1_reg_loss: 77766.6934; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71949.1269; train_chrom_access_recon_loss: 9538985.2273; train_global_loss: 23844703.3939; train_optim_loss: 23844703.3939; val_kl_reg_loss: 75913.4160; val_edge_recon_loss: 2722618.3125; val_gene_expr_recon_loss: 11593164.8750; val_masked_gp_l1_reg_loss: 77764.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71927.1484; val_chrom_access_recon_loss: 9951097.1250; val_global_loss: 24492485.5000; val_optim_loss: 24492485.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9649; val_auprc_score: 0.9450; val_best_acc_score: 0.9215; val_best_f1_score: 0.9242; train_kl_reg_loss: 75456.9386; train_edge_recon_loss: 2680524.5985; train_gene_expr_recon_loss: 11379535.6515; train_masked_gp_l1_reg_loss: 77683.9454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71921.9905; train_chrom_access_recon_loss: 9532258.2121; train_global_loss: 23817381.4545; train_optim_loss: 23817381.4545; val_kl_reg_loss: 78349.1338; val_edge_recon_loss: 2712628.5000; val_gene_expr_recon_loss: 11765959.6250; val_masked_gp_l1_reg_loss: 77578.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71815.2812; val_chrom_access_recon_loss: 10011186.1250; val_global_loss: 24717517.7500; val_optim_loss: 24717517.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9671; val_auprc_score: 0.9564; val_best_acc_score: 0.9186; val_best_f1_score: 0.9210; train_kl_reg_loss: 75567.8414; train_edge_recon_loss: 2674215.5076; train_gene_expr_recon_loss: 11373581.3182; train_masked_gp_l1_reg_loss: 77519.6832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72005.3126; train_chrom_access_recon_loss: 9511595.5606; train_global_loss: 23784485.4242; train_optim_loss: 23784485.4242; val_kl_reg_loss: 77093.4795; val_edge_recon_loss: 2699166.2812; val_gene_expr_recon_loss: 11720975.6250; val_masked_gp_l1_reg_loss: 77473.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71870.1719; val_chrom_access_recon_loss: 9939372.1250; val_global_loss: 24585950.2500; val_optim_loss: 24585950.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9627; val_auprc_score: 0.9458; val_best_acc_score: 0.9140; val_best_f1_score: 0.9179; train_kl_reg_loss: 74879.6771; train_edge_recon_loss: 2684579.4091; train_gene_expr_recon_loss: 11364336.7576; train_masked_gp_l1_reg_loss: 77415.5825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72002.3928; train_chrom_access_recon_loss: 9504697.7273; train_global_loss: 23777911.4848; train_optim_loss: 23777911.4848; val_kl_reg_loss: 75452.6377; val_edge_recon_loss: 2723252.8438; val_gene_expr_recon_loss: 11746981.5000; val_masked_gp_l1_reg_loss: 77445.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72021.8203; val_chrom_access_recon_loss: 10050251.8750; val_global_loss: 24745405.7500; val_optim_loss: 24745405.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9608; val_auprc_score: 0.9427; val_best_acc_score: 0.9154; val_best_f1_score: 0.9185; train_kl_reg_loss: 74314.3321; train_edge_recon_loss: 2677874.7348; train_gene_expr_recon_loss: 11356211.5152; train_masked_gp_l1_reg_loss: 77315.3079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72066.6143; train_chrom_access_recon_loss: 9486343.5303; train_global_loss: 23744126.0606; train_optim_loss: 23744126.0606; val_kl_reg_loss: 76326.3945; val_edge_recon_loss: 2732848.8125; val_gene_expr_recon_loss: 11732177.8750; val_masked_gp_l1_reg_loss: 77376.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72536.9766; val_chrom_access_recon_loss: 10096636.5000; val_global_loss: 24787903.7500; val_optim_loss: 24787903.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9643; val_auprc_score: 0.9520; val_best_acc_score: 0.9191; val_best_f1_score: 0.9222; train_kl_reg_loss: 74653.0095; train_edge_recon_loss: 2677577.8902; train_gene_expr_recon_loss: 11339057.9091; train_masked_gp_l1_reg_loss: 76700.3267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58351.1691; train_chrom_access_recon_loss: 9454805.0303; train_global_loss: 23681145.3636; train_optim_loss: 23681145.3636; val_kl_reg_loss: 76841.4180; val_edge_recon_loss: 2703977.7188; val_gene_expr_recon_loss: 11686129.0000; val_masked_gp_l1_reg_loss: 76364.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55038.4297; val_chrom_access_recon_loss: 9969846.6250; val_global_loss: 24568197.7500; val_optim_loss: 24568197.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9662; val_auprc_score: 0.9520; val_best_acc_score: 0.9229; val_best_f1_score: 0.9254; train_kl_reg_loss: 75140.3351; train_edge_recon_loss: 2678634.8977; train_gene_expr_recon_loss: 11334207.3030; train_masked_gp_l1_reg_loss: 76284.0025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54703.3712; train_chrom_access_recon_loss: 9437307.3788; train_global_loss: 23656277.4545; train_optim_loss: 23656277.4545; val_kl_reg_loss: 77195.6699; val_edge_recon_loss: 2698869.1250; val_gene_expr_recon_loss: 11755198.2500; val_masked_gp_l1_reg_loss: 76240.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54451.4727; val_chrom_access_recon_loss: 9995433.2500; val_global_loss: 24657387.7500; val_optim_loss: 24657387.7500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9621; val_auprc_score: 0.9424; val_best_acc_score: 0.9183; val_best_f1_score: 0.9214; train_kl_reg_loss: 75511.1174; train_edge_recon_loss: 2678907.5076; train_gene_expr_recon_loss: 11331254.0758; train_masked_gp_l1_reg_loss: 76209.4092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54289.4725; train_chrom_access_recon_loss: 9432225.8636; train_global_loss: 23648397.4848; train_optim_loss: 23648397.4848; val_kl_reg_loss: 77443.4404; val_edge_recon_loss: 2735123.9062; val_gene_expr_recon_loss: 11635463.0000; val_masked_gp_l1_reg_loss: 76183.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54096.2031; val_chrom_access_recon_loss: 9966867.6250; val_global_loss: 24545176.7500; val_optim_loss: 24545176.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9679; val_auprc_score: 0.9519; val_best_acc_score: 0.9267; val_best_f1_score: 0.9280; train_kl_reg_loss: 76230.3152; train_edge_recon_loss: 2667169.2159; train_gene_expr_recon_loss: 11337222.3939; train_masked_gp_l1_reg_loss: 76161.5374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53951.5494; train_chrom_access_recon_loss: 9437699.5909; train_global_loss: 23648434.8485; train_optim_loss: 23648434.8485; val_kl_reg_loss: 78642.1523; val_edge_recon_loss: 2699893.0312; val_gene_expr_recon_loss: 11579672.0000; val_masked_gp_l1_reg_loss: 76143.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53825.8867; val_chrom_access_recon_loss: 9884959.8750; val_global_loss: 24373136.7500; val_optim_loss: 24373136.7500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9646; val_auprc_score: 0.9519; val_best_acc_score: 0.9218; val_best_f1_score: 0.9250; train_kl_reg_loss: 76380.6252; train_edge_recon_loss: 2679258.7008; train_gene_expr_recon_loss: 11332896.3182; train_masked_gp_l1_reg_loss: 76132.8835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53687.6779; train_chrom_access_recon_loss: 9430638.4091; train_global_loss: 23648994.6061; train_optim_loss: 23648994.6061; val_kl_reg_loss: 77633.4131; val_edge_recon_loss: 2719137.7188; val_gene_expr_recon_loss: 11679797.7500; val_masked_gp_l1_reg_loss: 76114.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53594.5547; val_chrom_access_recon_loss: 9903756.0000; val_global_loss: 24510035.0000; val_optim_loss: 24510035.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9662; val_auprc_score: 0.9520; val_best_acc_score: 0.9232; val_best_f1_score: 0.9257; train_kl_reg_loss: 76333.6508; train_edge_recon_loss: 2681430.1326; train_gene_expr_recon_loss: 11333459.2576; train_masked_gp_l1_reg_loss: 76103.8822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53518.8356; train_chrom_access_recon_loss: 9426809.1818; train_global_loss: 23647654.9091; train_optim_loss: 23647654.9091; val_kl_reg_loss: 78249.7998; val_edge_recon_loss: 2699537.0938; val_gene_expr_recon_loss: 11613687.7500; val_masked_gp_l1_reg_loss: 76082.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53443.6250; val_chrom_access_recon_loss: 9947535.1250; val_global_loss: 24468537.2500; val_optim_loss: 24468537.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9609; val_auprc_score: 0.9439; val_best_acc_score: 0.9151; val_best_f1_score: 0.9184; train_kl_reg_loss: 76090.5382; train_edge_recon_loss: 2674706.0379; train_gene_expr_recon_loss: 11335565.0758; train_masked_gp_l1_reg_loss: 76064.0617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53355.0176; train_chrom_access_recon_loss: 9432136.5152; train_global_loss: 23647917.2727; train_optim_loss: 23647917.2727; val_kl_reg_loss: 78135.5410; val_edge_recon_loss: 2716368.3125; val_gene_expr_recon_loss: 11641610.8750; val_masked_gp_l1_reg_loss: 76063.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53300.8281; val_chrom_access_recon_loss: 9867632.2500; val_global_loss: 24433111.7500; val_optim_loss: 24433111.7500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9693; val_auprc_score: 0.9610; val_best_acc_score: 0.9248; val_best_f1_score: 0.9272; train_kl_reg_loss: 75989.8217; train_edge_recon_loss: 2680185.3030; train_gene_expr_recon_loss: 11330330.4242; train_masked_gp_l1_reg_loss: 76056.6938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53228.1821; train_chrom_access_recon_loss: 9426135.9394; train_global_loss: 23641926.3939; train_optim_loss: 23641926.3939; val_kl_reg_loss: 77244.0703; val_edge_recon_loss: 2708464.7188; val_gene_expr_recon_loss: 11686919.1250; val_masked_gp_l1_reg_loss: 76052.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53162.9258; val_chrom_access_recon_loss: 9916127.1250; val_global_loss: 24517971.0000; val_optim_loss: 24517971.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9647; val_auprc_score: 0.9494; val_best_acc_score: 0.9162; val_best_f1_score: 0.9195; train_kl_reg_loss: 75389.2730; train_edge_recon_loss: 2678446.5038; train_gene_expr_recon_loss: 11318020.6515; train_masked_gp_l1_reg_loss: 75985.7776; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51761.7356; train_chrom_access_recon_loss: 9411755.1364; train_global_loss: 23611358.9697; train_optim_loss: 23611358.9697; val_kl_reg_loss: 77433.4570; val_edge_recon_loss: 2723938.4375; val_gene_expr_recon_loss: 11632528.2500; val_masked_gp_l1_reg_loss: 75948.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51447.8086; val_chrom_access_recon_loss: 9843089.0000; val_global_loss: 24404386.5000; val_optim_loss: 24404386.5000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9664; val_auprc_score: 0.9531; val_best_acc_score: 0.9221; val_best_f1_score: 0.9248; train_kl_reg_loss: 75514.3967; train_edge_recon_loss: 2674139.3144; train_gene_expr_recon_loss: 11336268.0303; train_masked_gp_l1_reg_loss: 75938.1383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51414.5997; train_chrom_access_recon_loss: 9429170.5303; train_global_loss: 23642445.0303; train_optim_loss: 23642445.0303; val_kl_reg_loss: 77424.4355; val_edge_recon_loss: 2719548.8125; val_gene_expr_recon_loss: 11721747.5000; val_masked_gp_l1_reg_loss: 75930.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51391.9844; val_chrom_access_recon_loss: 9929152.8750; val_global_loss: 24575195.7500; val_optim_loss: 24575195.7500
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9658; val_auprc_score: 0.9554; val_best_acc_score: 0.9189; val_best_f1_score: 0.9212; train_kl_reg_loss: 75610.7161; train_edge_recon_loss: 2669226.0492; train_gene_expr_recon_loss: 11334635.9545; train_masked_gp_l1_reg_loss: 75924.9782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51372.5350; train_chrom_access_recon_loss: 9435234.8030; train_global_loss: 23642004.7879; train_optim_loss: 23642004.7879; val_kl_reg_loss: 77108.9766; val_edge_recon_loss: 2731857.1875; val_gene_expr_recon_loss: 11668556.1250; val_masked_gp_l1_reg_loss: 75921.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51358.4531; val_chrom_access_recon_loss: 9926565.1250; val_global_loss: 24531367.7500; val_optim_loss: 24531367.7500
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9667; val_auprc_score: 0.9569; val_best_acc_score: 0.9218; val_best_f1_score: 0.9247; train_kl_reg_loss: 75595.3744; train_edge_recon_loss: 2671425.1742; train_gene_expr_recon_loss: 11335290.3788; train_masked_gp_l1_reg_loss: 75918.7410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51346.4529; train_chrom_access_recon_loss: 9432882.2424; train_global_loss: 23642458.5152; train_optim_loss: 23642458.5152; val_kl_reg_loss: 77631.3115; val_edge_recon_loss: 2704817.6875; val_gene_expr_recon_loss: 11698604.2500; val_masked_gp_l1_reg_loss: 75915.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51331.2227; val_chrom_access_recon_loss: 9942575.6250; val_global_loss: 24550874.7500; val_optim_loss: 24550874.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 57 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9657
val AUPRC score: 0.9490
val best accuracy score: 0.9229
val best F1 score: 0.9260
val target rna MSE score: 1.3257
val source rna MSE score: 0.8527
val target atac MSE score: 0.3385
val source atac MSE score: 0.1299
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
