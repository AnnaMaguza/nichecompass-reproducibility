[True]
Run timestamp: 01092023_182851_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_liver', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '1000000.0', '--contrastive_logits_neg_ratio', '0.0625', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1000, n_cat_covariates_embed_input: 0, n_hidden: 1000, n_latent: 1496, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1496, n_addon_gp_input: 100, n_cat_covariates_embed_input: 2, n_output: 1000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1496, n_addon_gp_input: 100, n_cat_covariates_embed_input: 2, n_output: 1000

--- INITIALIZING TRAINER ---
Number of training nodes: 299589
Number of validation nodes: 33288
Number of training edges: 691436
Number of validation edges: 76826
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8887; val_auprc_score: 0.8735; val_best_acc_score: 0.8102; val_best_f1_score: 0.8229; train_kl_reg_loss: 67017.8676; train_edge_recon_loss: 2993347.9204; train_gene_expr_recon_loss: 2785205.0553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137969.1706; train_global_loss: 5983540.0241; train_optim_loss: 5983540.0241; val_kl_reg_loss: 48516.2405; val_edge_recon_loss: 2858085.0480; val_gene_expr_recon_loss: 2552287.2533; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25107.2832; val_global_loss: 5483996.0629; val_optim_loss: 5483996.0629
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9131; val_auprc_score: 0.8997; val_best_acc_score: 0.8381; val_best_f1_score: 0.8474; train_kl_reg_loss: 39701.0743; train_edge_recon_loss: 2733577.1540; train_gene_expr_recon_loss: 2422360.8884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18777.9703; train_global_loss: 5214417.0947; train_optim_loss: 5214417.0947; val_kl_reg_loss: 31247.8456; val_edge_recon_loss: 2799203.8825; val_gene_expr_recon_loss: 2290481.2964; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15514.8896; val_global_loss: 5136448.0232; val_optim_loss: 5136448.0232
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9320; val_auprc_score: 0.9193; val_best_acc_score: 0.8603; val_best_f1_score: 0.8676; train_kl_reg_loss: 28563.7455; train_edge_recon_loss: 2698311.6591; train_gene_expr_recon_loss: 2201668.9723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14476.2348; train_global_loss: 4943020.6073; train_optim_loss: 4943020.6073; val_kl_reg_loss: 25044.4543; val_edge_recon_loss: 2765878.5530; val_gene_expr_recon_loss: 2119632.8576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13821.4141; val_global_loss: 4924377.3808; val_optim_loss: 4924377.3808
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9399; val_auprc_score: 0.9275; val_best_acc_score: 0.8710; val_best_f1_score: 0.8775; train_kl_reg_loss: 24203.1868; train_edge_recon_loss: 2673009.4238; train_gene_expr_recon_loss: 2060358.6510; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13805.9017; train_global_loss: 4771377.1628; train_optim_loss: 4771377.1628; val_kl_reg_loss: 24245.8412; val_edge_recon_loss: 2745529.7020; val_gene_expr_recon_loss: 2007549.1531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13647.8887; val_global_loss: 4790972.7152; val_optim_loss: 4790972.7152
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9439; val_auprc_score: 0.9326; val_best_acc_score: 0.8765; val_best_f1_score: 0.8821; train_kl_reg_loss: 23585.5831; train_edge_recon_loss: 2661242.8858; train_gene_expr_recon_loss: 1977844.0810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13805.7045; train_global_loss: 4676478.2383; train_optim_loss: 4676478.2383; val_kl_reg_loss: 23111.0681; val_edge_recon_loss: 2748016.3642; val_gene_expr_recon_loss: 1949127.8924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13803.7607; val_global_loss: 4734059.3477; val_optim_loss: 4734059.3477
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9432; val_auprc_score: 0.9311; val_best_acc_score: 0.8762; val_best_f1_score: 0.8821; train_kl_reg_loss: 23584.7331; train_edge_recon_loss: 2660670.9647; train_gene_expr_recon_loss: 1930540.8233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13855.3573; train_global_loss: 4628651.8945; train_optim_loss: 4628651.8945; val_kl_reg_loss: 23873.7697; val_edge_recon_loss: 2753678.0000; val_gene_expr_recon_loss: 1914957.0671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13978.3994; val_global_loss: 4706487.3510; val_optim_loss: 4706487.3510
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9467; val_auprc_score: 0.9348; val_best_acc_score: 0.8811; val_best_f1_score: 0.8863; train_kl_reg_loss: 23704.9228; train_edge_recon_loss: 2655071.9922; train_gene_expr_recon_loss: 1899129.4574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 13952.0350; train_global_loss: 4591858.4078; train_optim_loss: 4591858.4078; val_kl_reg_loss: 23417.6525; val_edge_recon_loss: 2745759.2947; val_gene_expr_recon_loss: 1887332.9669; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14003.8086; val_global_loss: 4670513.9139; val_optim_loss: 4670513.9139
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9462; val_auprc_score: 0.9345; val_best_acc_score: 0.8799; val_best_f1_score: 0.8856; train_kl_reg_loss: 24004.7131; train_edge_recon_loss: 2655951.2239; train_gene_expr_recon_loss: 1893503.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14059.1175; train_global_loss: 4587518.6277; train_optim_loss: 4587518.6277; val_kl_reg_loss: 24028.6998; val_edge_recon_loss: 2735988.3179; val_gene_expr_recon_loss: 1876365.2508; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 13965.4004; val_global_loss: 4650347.7450; val_optim_loss: 4650347.7450
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9465; val_auprc_score: 0.9347; val_best_acc_score: 0.8809; val_best_f1_score: 0.8863; train_kl_reg_loss: 23777.0876; train_edge_recon_loss: 2652118.8584; train_gene_expr_recon_loss: 1862297.6574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14104.5986; train_global_loss: 4552298.1987; train_optim_loss: 4552298.1987; val_kl_reg_loss: 23603.9113; val_edge_recon_loss: 2739496.6308; val_gene_expr_recon_loss: 1867447.4404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14084.4932; val_global_loss: 4644632.5066; val_optim_loss: 4644632.5066
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9478; val_auprc_score: 0.9361; val_best_acc_score: 0.8836; val_best_f1_score: 0.8886; train_kl_reg_loss: 23697.8937; train_edge_recon_loss: 2650783.0766; train_gene_expr_recon_loss: 1851804.7505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14184.0614; train_global_loss: 4540469.7839; train_optim_loss: 4540469.7839; val_kl_reg_loss: 23646.4986; val_edge_recon_loss: 2739331.8709; val_gene_expr_recon_loss: 1850282.9760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14310.2998; val_global_loss: 4627571.8543; val_optim_loss: 4627571.8543
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9502; val_auprc_score: 0.9382; val_best_acc_score: 0.8866; val_best_f1_score: 0.8916; train_kl_reg_loss: 23761.1294; train_edge_recon_loss: 2649778.9774; train_gene_expr_recon_loss: 1844051.2166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14327.9154; train_global_loss: 4531919.2498; train_optim_loss: 4531919.2498; val_kl_reg_loss: 23420.7487; val_edge_recon_loss: 2735288.1507; val_gene_expr_recon_loss: 1845936.6142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14422.9941; val_global_loss: 4619068.4934; val_optim_loss: 4619068.4934
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9501; val_auprc_score: 0.9393; val_best_acc_score: 0.8855; val_best_f1_score: 0.8905; train_kl_reg_loss: 23780.2619; train_edge_recon_loss: 2647309.5986; train_gene_expr_recon_loss: 1836344.7210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14340.0626; train_global_loss: 4521774.6477; train_optim_loss: 4521774.6477; val_kl_reg_loss: 24078.6628; val_edge_recon_loss: 2731282.8775; val_gene_expr_recon_loss: 1837801.5869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14405.4512; val_global_loss: 4607568.5993; val_optim_loss: 4607568.5993
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9506; val_auprc_score: 0.9394; val_best_acc_score: 0.8866; val_best_f1_score: 0.8914; train_kl_reg_loss: 23833.4057; train_edge_recon_loss: 2648476.6834; train_gene_expr_recon_loss: 1834961.6737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14335.6043; train_global_loss: 4521607.3668; train_optim_loss: 4521607.3668; val_kl_reg_loss: 24541.5589; val_edge_recon_loss: 2735042.9454; val_gene_expr_recon_loss: 1839175.4826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14254.5146; val_global_loss: 4613014.4934; val_optim_loss: 4613014.4934
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9516; val_auprc_score: 0.9396; val_best_acc_score: 0.8889; val_best_f1_score: 0.8941; train_kl_reg_loss: 24028.2408; train_edge_recon_loss: 2647088.5357; train_gene_expr_recon_loss: 1825873.9351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14380.4869; train_global_loss: 4511371.2028; train_optim_loss: 4511371.2028; val_kl_reg_loss: 24267.7506; val_edge_recon_loss: 2733182.9752; val_gene_expr_recon_loss: 1830714.4743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14475.6357; val_global_loss: 4602640.7119; val_optim_loss: 4602640.7119
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9523; val_auprc_score: 0.9408; val_best_acc_score: 0.8895; val_best_f1_score: 0.8940; train_kl_reg_loss: 24149.3791; train_edge_recon_loss: 2645399.5879; train_gene_expr_recon_loss: 1820890.3377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14447.4632; train_global_loss: 4504886.7779; train_optim_loss: 4504886.7779; val_kl_reg_loss: 24116.2342; val_edge_recon_loss: 2728950.9437; val_gene_expr_recon_loss: 1825349.0348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14520.1045; val_global_loss: 4592936.1954; val_optim_loss: 4592936.1954
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9531; val_auprc_score: 0.9424; val_best_acc_score: 0.8903; val_best_f1_score: 0.8948; train_kl_reg_loss: 24042.7937; train_edge_recon_loss: 2644558.9310; train_gene_expr_recon_loss: 1815995.4447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14525.1346; train_global_loss: 4499122.2968; train_optim_loss: 4499122.2968; val_kl_reg_loss: 24567.5907; val_edge_recon_loss: 2725045.5464; val_gene_expr_recon_loss: 1827878.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14493.9814; val_global_loss: 4591985.2682; val_optim_loss: 4591985.2682
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9535; val_auprc_score: 0.9424; val_best_acc_score: 0.8913; val_best_f1_score: 0.8955; train_kl_reg_loss: 23998.5241; train_edge_recon_loss: 2643528.7976; train_gene_expr_recon_loss: 1813136.3077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14625.0093; train_global_loss: 4495288.6347; train_optim_loss: 4495288.6347; val_kl_reg_loss: 24521.2209; val_edge_recon_loss: 2732390.9586; val_gene_expr_recon_loss: 1816964.0571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14494.9756; val_global_loss: 4588371.2318; val_optim_loss: 4588371.2318
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9548; val_auprc_score: 0.9440; val_best_acc_score: 0.8933; val_best_f1_score: 0.8979; train_kl_reg_loss: 24099.9893; train_edge_recon_loss: 2644177.3194; train_gene_expr_recon_loss: 1807743.1194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14712.6882; train_global_loss: 4490733.1266; train_optim_loss: 4490733.1266; val_kl_reg_loss: 24457.6834; val_edge_recon_loss: 2725323.6589; val_gene_expr_recon_loss: 1818286.2955; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14684.6885; val_global_loss: 4582752.1391; val_optim_loss: 4582752.1391
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9544; val_auprc_score: 0.9434; val_best_acc_score: 0.8929; val_best_f1_score: 0.8976; train_kl_reg_loss: 24159.1682; train_edge_recon_loss: 2642241.6577; train_gene_expr_recon_loss: 1806467.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14734.1003; train_global_loss: 4487602.4708; train_optim_loss: 4487602.4708; val_kl_reg_loss: 24873.4056; val_edge_recon_loss: 2726123.0960; val_gene_expr_recon_loss: 1819230.9785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14780.6289; val_global_loss: 4585007.9669; val_optim_loss: 4585007.9669
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9025; val_auprc_score: 0.8834; val_best_acc_score: 0.8273; val_best_f1_score: 0.8388; train_kl_reg_loss: 21293.4812; train_edge_recon_loss: 2730814.7887; train_gene_expr_recon_loss: 2421034.9127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20031.7767; train_global_loss: 5193174.9541; train_optim_loss: 5193174.9541; val_kl_reg_loss: 13976.7260; val_edge_recon_loss: 2788393.1656; val_gene_expr_recon_loss: 2410960.8642; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15283.5781; val_global_loss: 5228614.2384; val_optim_loss: 5228614.2384
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9333; val_auprc_score: 0.9198; val_best_acc_score: 0.8628; val_best_f1_score: 0.8695; train_kl_reg_loss: 14207.8891; train_edge_recon_loss: 2671621.3233; train_gene_expr_recon_loss: 2361918.2106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15191.5920; train_global_loss: 5062939.0170; train_optim_loss: 5062939.0170; val_kl_reg_loss: 14901.9045; val_edge_recon_loss: 2761399.2632; val_gene_expr_recon_loss: 2282942.0248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15378.3662; val_global_loss: 5074621.6954; val_optim_loss: 5074621.6954
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9413; val_auprc_score: 0.9302; val_best_acc_score: 0.8719; val_best_f1_score: 0.8776; train_kl_reg_loss: 16857.2632; train_edge_recon_loss: 2657557.2876; train_gene_expr_recon_loss: 2206541.0151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15422.7673; train_global_loss: 4896378.3346; train_optim_loss: 4896378.3346; val_kl_reg_loss: 18341.2207; val_edge_recon_loss: 2749753.6805; val_gene_expr_recon_loss: 2128600.5861; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15570.9697; val_global_loss: 4912266.5000; val_optim_loss: 4912266.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9434; val_auprc_score: 0.9319; val_best_acc_score: 0.8755; val_best_f1_score: 0.8805; train_kl_reg_loss: 18581.2156; train_edge_recon_loss: 2652127.2348; train_gene_expr_recon_loss: 2111894.6937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6814.6600; train_global_loss: 4789417.8064; train_optim_loss: 4789417.8064; val_kl_reg_loss: 18910.4422; val_edge_recon_loss: 2742486.9570; val_gene_expr_recon_loss: 2099035.3742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6741.5542; val_global_loss: 4867174.2715; val_optim_loss: 4867174.2715
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9445; val_auprc_score: 0.9332; val_best_acc_score: 0.8766; val_best_f1_score: 0.8815; train_kl_reg_loss: 19220.9042; train_edge_recon_loss: 2651685.7922; train_gene_expr_recon_loss: 2088839.5314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6677.1058; train_global_loss: 4766423.3479; train_optim_loss: 4766423.3479; val_kl_reg_loss: 19526.4621; val_edge_recon_loss: 2747020.4983; val_gene_expr_recon_loss: 2076895.8493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6620.5635; val_global_loss: 4850063.3146; val_optim_loss: 4850063.3146
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9441; val_auprc_score: 0.9322; val_best_acc_score: 0.8776; val_best_f1_score: 0.8826; train_kl_reg_loss: 19883.2856; train_edge_recon_loss: 2650882.6380; train_gene_expr_recon_loss: 2060035.4321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6580.3947; train_global_loss: 4737381.7620; train_optim_loss: 4737381.7620; val_kl_reg_loss: 20312.9283; val_edge_recon_loss: 2742506.8659; val_gene_expr_recon_loss: 2045282.5464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6509.1660; val_global_loss: 4814611.3477; val_optim_loss: 4814611.3477
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9471; val_auprc_score: 0.9360; val_best_acc_score: 0.8811; val_best_f1_score: 0.8859; train_kl_reg_loss: 20536.4408; train_edge_recon_loss: 2648652.1020; train_gene_expr_recon_loss: 2026331.7593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6466.9094; train_global_loss: 4701987.2135; train_optim_loss: 4701987.2135; val_kl_reg_loss: 20816.9912; val_edge_recon_loss: 2739806.3725; val_gene_expr_recon_loss: 2009627.1531; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6414.1577; val_global_loss: 4776664.5033; val_optim_loss: 4776664.5033

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 281 min 44 sec.
Using best model state, which was in epoch 18.

--- MODEL EVALUATION ---
val AUROC score: 0.9547
val AUPRC score: 0.9439
val best accuracy score: 0.8941
val best F1 score: 0.8985
val target rna MSE score: 0.6710
val source rna MSE score: 0.1278
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
