[True]
Run timestamp: 10102023_133539_280.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_280']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6832; val_auprc_score: 0.6598; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 40809.3389; train_edge_recon_loss: 733687.1506; train_gene_expr_recon_loss: 23600374.7879; train_masked_gp_l1_reg_loss: 108012.4330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3344828.6402; train_chrom_access_recon_loss: 11577776.5000; train_global_loss: 39405489.0303; train_optim_loss: 39405489.0303; val_kl_reg_loss: 72319.7480; val_edge_recon_loss: 813098.4531; val_gene_expr_recon_loss: 21778980.5000; val_masked_gp_l1_reg_loss: 87165.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2295061.7500; val_chrom_access_recon_loss: 11075461.8750; val_global_loss: 36122089.0000; val_optim_loss: 36122089.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7108; val_auprc_score: 0.6962; val_best_acc_score: 0.5484; val_best_f1_score: 0.6863; train_kl_reg_loss: 81054.4544; train_edge_recon_loss: 741589.6506; train_gene_expr_recon_loss: 21296631.6061; train_masked_gp_l1_reg_loss: 80372.2462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1520943.6657; train_chrom_access_recon_loss: 11009580.5000; train_global_loss: 34730172.3333; train_optim_loss: 34730172.3333; val_kl_reg_loss: 77095.2988; val_edge_recon_loss: 812574.6797; val_gene_expr_recon_loss: 21211913.2500; val_masked_gp_l1_reg_loss: 77002.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 927805.0000; val_chrom_access_recon_loss: 11026355.5000; val_global_loss: 34132745.2500; val_optim_loss: 34132745.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7654; val_auprc_score: 0.7460; val_best_acc_score: 0.6370; val_best_f1_score: 0.7210; train_kl_reg_loss: 77451.7147; train_edge_recon_loss: 735472.5085; train_gene_expr_recon_loss: 21044739.2727; train_masked_gp_l1_reg_loss: 75390.5741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 648907.8262; train_chrom_access_recon_loss: 10928390.1364; train_global_loss: 33510351.8485; train_optim_loss: 33510351.8485; val_kl_reg_loss: 70638.2949; val_edge_recon_loss: 811342.8438; val_gene_expr_recon_loss: 20719754.0000; val_masked_gp_l1_reg_loss: 74647.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 447996.9062; val_chrom_access_recon_loss: 10766170.7500; val_global_loss: 32890550.5000; val_optim_loss: 32890550.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8434; val_auprc_score: 0.8215; val_best_acc_score: 0.7603; val_best_f1_score: 0.7496; train_kl_reg_loss: 71440.9056; train_edge_recon_loss: 730609.2367; train_gene_expr_recon_loss: 20890077.8788; train_masked_gp_l1_reg_loss: 74730.4179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 348886.6151; train_chrom_access_recon_loss: 10852375.4242; train_global_loss: 32968120.4848; train_optim_loss: 32968120.4848; val_kl_reg_loss: 69960.0010; val_edge_recon_loss: 802132.0391; val_gene_expr_recon_loss: 20869246.5000; val_masked_gp_l1_reg_loss: 75600.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 274368.2188; val_chrom_access_recon_loss: 10816320.8750; val_global_loss: 32907627.5000; val_optim_loss: 32907627.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8673; val_auprc_score: 0.8388; val_best_acc_score: 0.7872; val_best_f1_score: 0.8079; train_kl_reg_loss: 65922.9635; train_edge_recon_loss: 723796.7178; train_gene_expr_recon_loss: 20717239.3636; train_masked_gp_l1_reg_loss: 77191.0078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 232964.1858; train_chrom_access_recon_loss: 10777284.1364; train_global_loss: 32594398.5455; train_optim_loss: 32594398.5455; val_kl_reg_loss: 64372.3384; val_edge_recon_loss: 775121.2734; val_gene_expr_recon_loss: 20507952.7500; val_masked_gp_l1_reg_loss: 78853.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 199901.2031; val_chrom_access_recon_loss: 10608422.0000; val_global_loss: 32234624.5000; val_optim_loss: 32234624.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8677; val_auprc_score: 0.8364; val_best_acc_score: 0.7945; val_best_f1_score: 0.8101; train_kl_reg_loss: 61722.2016; train_edge_recon_loss: 704357.4962; train_gene_expr_recon_loss: 20585728.3939; train_masked_gp_l1_reg_loss: 79859.5328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176820.0244; train_chrom_access_recon_loss: 10716438.0000; train_global_loss: 32324925.8182; train_optim_loss: 32324925.8182; val_kl_reg_loss: 61096.8867; val_edge_recon_loss: 705845.1562; val_gene_expr_recon_loss: 20429378.2500; val_masked_gp_l1_reg_loss: 81260.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158135.7188; val_chrom_access_recon_loss: 10576082.6250; val_global_loss: 32011799.0000; val_optim_loss: 32011799.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8616; val_auprc_score: 0.8296; val_best_acc_score: 0.7942; val_best_f1_score: 0.8109; train_kl_reg_loss: 67315.9721; train_edge_recon_loss: 659365.4858; train_gene_expr_recon_loss: 20467141.3636; train_masked_gp_l1_reg_loss: 82285.8864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144424.8054; train_chrom_access_recon_loss: 10673017.5152; train_global_loss: 32093551.1818; train_optim_loss: 32093551.1818; val_kl_reg_loss: 72036.3750; val_edge_recon_loss: 650952.7266; val_gene_expr_recon_loss: 20397176.5000; val_masked_gp_l1_reg_loss: 83273.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132870.0781; val_chrom_access_recon_loss: 10658753.7500; val_global_loss: 31995063.5000; val_optim_loss: 31995063.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8627; val_auprc_score: 0.8289; val_best_acc_score: 0.7918; val_best_f1_score: 0.8112; train_kl_reg_loss: 72535.7090; train_edge_recon_loss: 638694.1430; train_gene_expr_recon_loss: 20370216.0909; train_masked_gp_l1_reg_loss: 83996.8299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124580.0520; train_chrom_access_recon_loss: 10626072.2273; train_global_loss: 31916095.1212; train_optim_loss: 31916095.1212; val_kl_reg_loss: 71131.1719; val_edge_recon_loss: 640931.0859; val_gene_expr_recon_loss: 20326134.0000; val_masked_gp_l1_reg_loss: 84816.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117292.7109; val_chrom_access_recon_loss: 10516031.1250; val_global_loss: 31756335.5000; val_optim_loss: 31756335.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8760; val_auprc_score: 0.8391; val_best_acc_score: 0.8041; val_best_f1_score: 0.8236; train_kl_reg_loss: 72790.1790; train_edge_recon_loss: 626921.5691; train_gene_expr_recon_loss: 20293579.3333; train_masked_gp_l1_reg_loss: 85555.6325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111674.4635; train_chrom_access_recon_loss: 10593432.2879; train_global_loss: 31783953.4242; train_optim_loss: 31783953.4242; val_kl_reg_loss: 73621.1074; val_edge_recon_loss: 624426.6328; val_gene_expr_recon_loss: 20083445.0000; val_masked_gp_l1_reg_loss: 86233.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106071.4609; val_chrom_access_recon_loss: 10552305.6250; val_global_loss: 31526103.7500; val_optim_loss: 31526103.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8827; val_auprc_score: 0.8526; val_best_acc_score: 0.8063; val_best_f1_score: 0.8289; train_kl_reg_loss: 71373.8823; train_edge_recon_loss: 624514.6809; train_gene_expr_recon_loss: 20199474.9091; train_masked_gp_l1_reg_loss: 86859.2985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102275.3453; train_chrom_access_recon_loss: 10545921.2879; train_global_loss: 31630419.4242; train_optim_loss: 31630419.4242; val_kl_reg_loss: 71529.7598; val_edge_recon_loss: 628599.3672; val_gene_expr_recon_loss: 19959599.7500; val_masked_gp_l1_reg_loss: 87320.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98790.3047; val_chrom_access_recon_loss: 10376613.7500; val_global_loss: 31222452.7500; val_optim_loss: 31222452.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8965; val_auprc_score: 0.8711; val_best_acc_score: 0.8192; val_best_f1_score: 0.8353; train_kl_reg_loss: 69947.8300; train_edge_recon_loss: 619571.4110; train_gene_expr_recon_loss: 20146024.3333; train_masked_gp_l1_reg_loss: 87960.4300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95882.0405; train_chrom_access_recon_loss: 10522795.6818; train_global_loss: 31542181.7576; train_optim_loss: 31542181.7576; val_kl_reg_loss: 69522.7031; val_edge_recon_loss: 619950.2812; val_gene_expr_recon_loss: 20158319.5000; val_masked_gp_l1_reg_loss: 88315.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92762.4062; val_chrom_access_recon_loss: 10473255.8750; val_global_loss: 31502126.5000; val_optim_loss: 31502126.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8967; val_auprc_score: 0.8668; val_best_acc_score: 0.8186; val_best_f1_score: 0.8360; train_kl_reg_loss: 69168.3401; train_edge_recon_loss: 615683.0436; train_gene_expr_recon_loss: 20048049.4545; train_masked_gp_l1_reg_loss: 88794.4200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90734.9616; train_chrom_access_recon_loss: 10480285.1818; train_global_loss: 31392715.3636; train_optim_loss: 31392715.3636; val_kl_reg_loss: 68658.3291; val_edge_recon_loss: 617088.8750; val_gene_expr_recon_loss: 19914217.2500; val_masked_gp_l1_reg_loss: 89418.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89740.4844; val_chrom_access_recon_loss: 10292523.8750; val_global_loss: 31071646.2500; val_optim_loss: 31071646.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9092; val_auprc_score: 0.8876; val_best_acc_score: 0.8329; val_best_f1_score: 0.8465; train_kl_reg_loss: 68193.4977; train_edge_recon_loss: 612650.1657; train_gene_expr_recon_loss: 20003268.6970; train_masked_gp_l1_reg_loss: 89613.4004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87279.0747; train_chrom_access_recon_loss: 10446370.1818; train_global_loss: 31307375.1515; train_optim_loss: 31307375.1515; val_kl_reg_loss: 67812.2471; val_edge_recon_loss: 616109.1562; val_gene_expr_recon_loss: 19709127.0000; val_masked_gp_l1_reg_loss: 90050.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85317.4531; val_chrom_access_recon_loss: 10345455.0000; val_global_loss: 30913870.7500; val_optim_loss: 30913870.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9125; val_auprc_score: 0.8937; val_best_acc_score: 0.8377; val_best_f1_score: 0.8485; train_kl_reg_loss: 67766.4642; train_edge_recon_loss: 607934.3428; train_gene_expr_recon_loss: 19915373.2121; train_masked_gp_l1_reg_loss: 90488.0432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83564.9046; train_chrom_access_recon_loss: 10405533.3182; train_global_loss: 31170660.3030; train_optim_loss: 31170660.3030; val_kl_reg_loss: 66815.1167; val_edge_recon_loss: 604119.9688; val_gene_expr_recon_loss: 19872489.5000; val_masked_gp_l1_reg_loss: 91003.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82556.6719; val_chrom_access_recon_loss: 10429386.8750; val_global_loss: 31146371.7500; val_optim_loss: 31146371.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9186; val_auprc_score: 0.8971; val_best_acc_score: 0.8452; val_best_f1_score: 0.8531; train_kl_reg_loss: 66877.3234; train_edge_recon_loss: 606352.8381; train_gene_expr_recon_loss: 19856306.9394; train_masked_gp_l1_reg_loss: 91297.6515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81128.3068; train_chrom_access_recon_loss: 10371635.9545; train_global_loss: 31073599.1515; train_optim_loss: 31073599.1515; val_kl_reg_loss: 65666.5327; val_edge_recon_loss: 607978.8984; val_gene_expr_recon_loss: 19860405.5000; val_masked_gp_l1_reg_loss: 91743.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80074.5156; val_chrom_access_recon_loss: 10393948.8750; val_global_loss: 31099817.7500; val_optim_loss: 31099817.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9138; val_auprc_score: 0.8856; val_best_acc_score: 0.8469; val_best_f1_score: 0.8587; train_kl_reg_loss: 66337.7646; train_edge_recon_loss: 603677.6676; train_gene_expr_recon_loss: 19815774.3939; train_masked_gp_l1_reg_loss: 92106.2080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78698.6914; train_chrom_access_recon_loss: 10343076.0909; train_global_loss: 30999670.8485; train_optim_loss: 30999670.8485; val_kl_reg_loss: 67268.8223; val_edge_recon_loss: 609239.0781; val_gene_expr_recon_loss: 19681342.2500; val_masked_gp_l1_reg_loss: 92600.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77672.6172; val_chrom_access_recon_loss: 10260815.8750; val_global_loss: 30788938.2500; val_optim_loss: 30788938.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9178; val_auprc_score: 0.8952; val_best_acc_score: 0.8458; val_best_f1_score: 0.8552; train_kl_reg_loss: 65901.4856; train_edge_recon_loss: 601469.9706; train_gene_expr_recon_loss: 19759820.2424; train_masked_gp_l1_reg_loss: 92826.7724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76493.1262; train_chrom_access_recon_loss: 10307451.2879; train_global_loss: 30903962.6667; train_optim_loss: 30903962.6667; val_kl_reg_loss: 66770.9482; val_edge_recon_loss: 608343.8516; val_gene_expr_recon_loss: 19609765.5000; val_masked_gp_l1_reg_loss: 93377.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75502.2969; val_chrom_access_recon_loss: 10179032.5000; val_global_loss: 30632793.2500; val_optim_loss: 30632793.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9265; val_auprc_score: 0.9069; val_best_acc_score: 0.8622; val_best_f1_score: 0.8693; train_kl_reg_loss: 65459.7461; train_edge_recon_loss: 598561.0028; train_gene_expr_recon_loss: 19701021.8485; train_masked_gp_l1_reg_loss: 93626.7457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74776.7782; train_chrom_access_recon_loss: 10280243.8182; train_global_loss: 30813689.9697; train_optim_loss: 30813689.9697; val_kl_reg_loss: 64891.1870; val_edge_recon_loss: 600381.8359; val_gene_expr_recon_loss: 19734291.2500; val_masked_gp_l1_reg_loss: 94194.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74300.8047; val_chrom_access_recon_loss: 10320913.1250; val_global_loss: 30888971.5000; val_optim_loss: 30888971.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9255; val_auprc_score: 0.9019; val_best_acc_score: 0.8649; val_best_f1_score: 0.8703; train_kl_reg_loss: 64994.6990; train_edge_recon_loss: 597479.5294; train_gene_expr_recon_loss: 19659508.6061; train_masked_gp_l1_reg_loss: 94326.5653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73441.5330; train_chrom_access_recon_loss: 10238854.8636; train_global_loss: 30728605.5455; train_optim_loss: 30728605.5455; val_kl_reg_loss: 64058.5273; val_edge_recon_loss: 598358.9375; val_gene_expr_recon_loss: 19537518.7500; val_masked_gp_l1_reg_loss: 94708.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72838.0312; val_chrom_access_recon_loss: 10248706.5000; val_global_loss: 30616188.5000; val_optim_loss: 30616188.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9316; val_auprc_score: 0.9068; val_best_acc_score: 0.8692; val_best_f1_score: 0.8757; train_kl_reg_loss: 64661.9210; train_edge_recon_loss: 594442.5019; train_gene_expr_recon_loss: 19619588.6061; train_masked_gp_l1_reg_loss: 94935.5262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72224.4220; train_chrom_access_recon_loss: 10223683.6667; train_global_loss: 30669536.6667; train_optim_loss: 30669536.6667; val_kl_reg_loss: 64889.1533; val_edge_recon_loss: 598075.0391; val_gene_expr_recon_loss: 19519906.7500; val_masked_gp_l1_reg_loss: 95506.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71633.3750; val_chrom_access_recon_loss: 10161630.0000; val_global_loss: 30511641.0000; val_optim_loss: 30511641.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9369; val_auprc_score: 0.9207; val_best_acc_score: 0.8748; val_best_f1_score: 0.8798; train_kl_reg_loss: 64499.4474; train_edge_recon_loss: 592766.5076; train_gene_expr_recon_loss: 19557872.7576; train_masked_gp_l1_reg_loss: 95630.7848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71068.8383; train_chrom_access_recon_loss: 10172836.7424; train_global_loss: 30554675.0000; train_optim_loss: 30554675.0000; val_kl_reg_loss: 65917.3267; val_edge_recon_loss: 596823.3359; val_gene_expr_recon_loss: 19397893.5000; val_masked_gp_l1_reg_loss: 95868.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70771.3281; val_chrom_access_recon_loss: 10041760.0000; val_global_loss: 30269033.7500; val_optim_loss: 30269033.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9324; val_auprc_score: 0.9153; val_best_acc_score: 0.8684; val_best_f1_score: 0.8744; train_kl_reg_loss: 64075.8273; train_edge_recon_loss: 592632.1165; train_gene_expr_recon_loss: 19503678.4848; train_masked_gp_l1_reg_loss: 96222.5917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70411.8574; train_chrom_access_recon_loss: 10131756.5303; train_global_loss: 30458777.4242; train_optim_loss: 30458777.4242; val_kl_reg_loss: 63173.7061; val_edge_recon_loss: 599635.2109; val_gene_expr_recon_loss: 19400191.5000; val_masked_gp_l1_reg_loss: 96587.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70089.5781; val_chrom_access_recon_loss: 10097014.2500; val_global_loss: 30326693.0000; val_optim_loss: 30326693.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9400; val_auprc_score: 0.9207; val_best_acc_score: 0.8794; val_best_f1_score: 0.8845; train_kl_reg_loss: 63354.5279; train_edge_recon_loss: 591814.8258; train_gene_expr_recon_loss: 19463520.6061; train_masked_gp_l1_reg_loss: 96911.3613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69751.8999; train_chrom_access_recon_loss: 10102508.5909; train_global_loss: 30387861.7576; train_optim_loss: 30387861.7576; val_kl_reg_loss: 64516.2754; val_edge_recon_loss: 593582.7109; val_gene_expr_recon_loss: 19497948.2500; val_masked_gp_l1_reg_loss: 97338.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69536.2812; val_chrom_access_recon_loss: 10119478.1250; val_global_loss: 30442399.5000; val_optim_loss: 30442399.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9431; val_auprc_score: 0.9248; val_best_acc_score: 0.8847; val_best_f1_score: 0.8879; train_kl_reg_loss: 63149.6717; train_edge_recon_loss: 589989.0379; train_gene_expr_recon_loss: 19436610.7273; train_masked_gp_l1_reg_loss: 97752.5778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69126.7035; train_chrom_access_recon_loss: 10074198.3030; train_global_loss: 30330826.9091; train_optim_loss: 30330826.9091; val_kl_reg_loss: 63735.8438; val_edge_recon_loss: 588522.4453; val_gene_expr_recon_loss: 19415420.0000; val_masked_gp_l1_reg_loss: 97982.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69169.3594; val_chrom_access_recon_loss: 10083525.7500; val_global_loss: 30318356.2500; val_optim_loss: 30318356.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9333; val_auprc_score: 0.9075; val_best_acc_score: 0.8710; val_best_f1_score: 0.8783; train_kl_reg_loss: 62850.4545; train_edge_recon_loss: 587815.6042; train_gene_expr_recon_loss: 19410619.4545; train_masked_gp_l1_reg_loss: 98401.3144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68573.1600; train_chrom_access_recon_loss: 10053676.7879; train_global_loss: 30281936.3939; train_optim_loss: 30281936.3939; val_kl_reg_loss: 63341.2749; val_edge_recon_loss: 596821.6875; val_gene_expr_recon_loss: 19348689.5000; val_masked_gp_l1_reg_loss: 98618.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68593.3516; val_chrom_access_recon_loss: 10039291.1250; val_global_loss: 30215355.2500; val_optim_loss: 30215355.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9409; val_auprc_score: 0.9212; val_best_acc_score: 0.8810; val_best_f1_score: 0.8854; train_kl_reg_loss: 62896.5066; train_edge_recon_loss: 589362.0663; train_gene_expr_recon_loss: 19372985.6667; train_masked_gp_l1_reg_loss: 98963.2365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68311.0683; train_chrom_access_recon_loss: 10011174.4848; train_global_loss: 30203693.0606; train_optim_loss: 30203693.0606; val_kl_reg_loss: 62774.3408; val_edge_recon_loss: 597471.2188; val_gene_expr_recon_loss: 19259157.2500; val_masked_gp_l1_reg_loss: 99533.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68255.5938; val_chrom_access_recon_loss: 10138616.3750; val_global_loss: 30225808.7500; val_optim_loss: 30225808.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9351; val_auprc_score: 0.9170; val_best_acc_score: 0.8710; val_best_f1_score: 0.8797; train_kl_reg_loss: 62533.0748; train_edge_recon_loss: 588030.0095; train_gene_expr_recon_loss: 19311929.1212; train_masked_gp_l1_reg_loss: 99596.4626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67959.2995; train_chrom_access_recon_loss: 9977669.3485; train_global_loss: 30107717.4848; train_optim_loss: 30107717.4848; val_kl_reg_loss: 62683.6187; val_edge_recon_loss: 593458.8984; val_gene_expr_recon_loss: 19315474.2500; val_masked_gp_l1_reg_loss: 99876.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67960.2734; val_chrom_access_recon_loss: 10042397.5000; val_global_loss: 30181850.5000; val_optim_loss: 30181850.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9411; val_auprc_score: 0.9249; val_best_acc_score: 0.8794; val_best_f1_score: 0.8859; train_kl_reg_loss: 62230.9263; train_edge_recon_loss: 587134.0341; train_gene_expr_recon_loss: 19298298.5455; train_masked_gp_l1_reg_loss: 100223.0496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67669.4734; train_chrom_access_recon_loss: 9952543.7273; train_global_loss: 30068099.5152; train_optim_loss: 30068099.5152; val_kl_reg_loss: 62510.6270; val_edge_recon_loss: 592790.5547; val_gene_expr_recon_loss: 19309708.5000; val_masked_gp_l1_reg_loss: 100604.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67338.6562; val_chrom_access_recon_loss: 9979058.1250; val_global_loss: 30112009.7500; val_optim_loss: 30112009.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9440; val_auprc_score: 0.9260; val_best_acc_score: 0.8815; val_best_f1_score: 0.8888; train_kl_reg_loss: 61816.0422; train_edge_recon_loss: 586713.1278; train_gene_expr_recon_loss: 19250286.1515; train_masked_gp_l1_reg_loss: 100955.6478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67403.7251; train_chrom_access_recon_loss: 9918318.0303; train_global_loss: 29985492.6364; train_optim_loss: 29985492.6364; val_kl_reg_loss: 61432.7407; val_edge_recon_loss: 593933.1797; val_gene_expr_recon_loss: 19223371.7500; val_masked_gp_l1_reg_loss: 101514.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67516.9062; val_chrom_access_recon_loss: 9975580.5000; val_global_loss: 30023348.2500; val_optim_loss: 30023348.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9413; val_auprc_score: 0.9246; val_best_acc_score: 0.8810; val_best_f1_score: 0.8861; train_kl_reg_loss: 61508.7814; train_edge_recon_loss: 586706.8580; train_gene_expr_recon_loss: 19233470.8485; train_masked_gp_l1_reg_loss: 101884.6706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67432.2808; train_chrom_access_recon_loss: 9888764.9545; train_global_loss: 29939768.5152; train_optim_loss: 29939768.5152; val_kl_reg_loss: 62228.2554; val_edge_recon_loss: 591614.0391; val_gene_expr_recon_loss: 19314614.2500; val_masked_gp_l1_reg_loss: 102426.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67435.1875; val_chrom_access_recon_loss: 10045620.7500; val_global_loss: 30183939.2500; val_optim_loss: 30183939.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9397; val_auprc_score: 0.9246; val_best_acc_score: 0.8818; val_best_f1_score: 0.8866; train_kl_reg_loss: 61238.1513; train_edge_recon_loss: 586694.2481; train_gene_expr_recon_loss: 19189715.7879; train_masked_gp_l1_reg_loss: 102563.2403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67426.3259; train_chrom_access_recon_loss: 9849785.8182; train_global_loss: 29857423.6970; train_optim_loss: 29857423.6970; val_kl_reg_loss: 61277.5728; val_edge_recon_loss: 592202.4922; val_gene_expr_recon_loss: 19126519.2500; val_masked_gp_l1_reg_loss: 103124.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67677.4922; val_chrom_access_recon_loss: 9824298.5000; val_global_loss: 29775099.5000; val_optim_loss: 29775099.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9466; val_auprc_score: 0.9307; val_best_acc_score: 0.8901; val_best_f1_score: 0.8957; train_kl_reg_loss: 60978.9112; train_edge_recon_loss: 586916.1525; train_gene_expr_recon_loss: 19151971.1818; train_masked_gp_l1_reg_loss: 103373.2402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67459.5096; train_chrom_access_recon_loss: 9814800.5455; train_global_loss: 29785499.8485; train_optim_loss: 29785499.8485; val_kl_reg_loss: 61235.6699; val_edge_recon_loss: 588549.2266; val_gene_expr_recon_loss: 19082104.0000; val_masked_gp_l1_reg_loss: 103755.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67422.3047; val_chrom_access_recon_loss: 9765593.0000; val_global_loss: 29668659.7500; val_optim_loss: 29668659.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9450; val_auprc_score: 0.9239; val_best_acc_score: 0.8925; val_best_f1_score: 0.8965; train_kl_reg_loss: 60979.1444; train_edge_recon_loss: 584032.5985; train_gene_expr_recon_loss: 19119134.0606; train_masked_gp_l1_reg_loss: 104165.7557; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67394.2449; train_chrom_access_recon_loss: 9778156.0000; train_global_loss: 29713861.7879; train_optim_loss: 29713861.7879; val_kl_reg_loss: 61576.7314; val_edge_recon_loss: 586406.3125; val_gene_expr_recon_loss: 19018004.7500; val_masked_gp_l1_reg_loss: 104452.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67396.4062; val_chrom_access_recon_loss: 9796144.7500; val_global_loss: 29633980.5000; val_optim_loss: 29633980.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9479; val_auprc_score: 0.9308; val_best_acc_score: 0.8976; val_best_f1_score: 0.9016; train_kl_reg_loss: 61006.6455; train_edge_recon_loss: 584190.0388; train_gene_expr_recon_loss: 19084825.8788; train_masked_gp_l1_reg_loss: 104899.8101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67383.6254; train_chrom_access_recon_loss: 9744899.7727; train_global_loss: 29647205.6970; train_optim_loss: 29647205.6970; val_kl_reg_loss: 60989.2217; val_edge_recon_loss: 588022.2891; val_gene_expr_recon_loss: 19025083.7500; val_masked_gp_l1_reg_loss: 105302.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67795.5859; val_chrom_access_recon_loss: 9744131.8750; val_global_loss: 29591325.2500; val_optim_loss: 29591325.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9467; val_auprc_score: 0.9317; val_best_acc_score: 0.8845; val_best_f1_score: 0.8915; train_kl_reg_loss: 60855.7811; train_edge_recon_loss: 584867.7917; train_gene_expr_recon_loss: 19045236.0606; train_masked_gp_l1_reg_loss: 105685.8988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67734.1187; train_chrom_access_recon_loss: 9714669.2273; train_global_loss: 29579048.8182; train_optim_loss: 29579048.8182; val_kl_reg_loss: 60725.6636; val_edge_recon_loss: 589468.9922; val_gene_expr_recon_loss: 18823118.2500; val_masked_gp_l1_reg_loss: 106000.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67516.7734; val_chrom_access_recon_loss: 9738707.0000; val_global_loss: 29385536.0000; val_optim_loss: 29385536.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9474; val_auprc_score: 0.9311; val_best_acc_score: 0.8939; val_best_f1_score: 0.8993; train_kl_reg_loss: 60874.8162; train_edge_recon_loss: 583803.6657; train_gene_expr_recon_loss: 19001742.7273; train_masked_gp_l1_reg_loss: 106426.6378; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67680.2811; train_chrom_access_recon_loss: 9670007.6364; train_global_loss: 29490535.8182; train_optim_loss: 29490535.8182; val_kl_reg_loss: 61298.9399; val_edge_recon_loss: 588810.7656; val_gene_expr_recon_loss: 18853596.2500; val_masked_gp_l1_reg_loss: 106749.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67939.2422; val_chrom_access_recon_loss: 9693068.5000; val_global_loss: 29371464.5000; val_optim_loss: 29371464.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9486; val_auprc_score: 0.9324; val_best_acc_score: 0.8882; val_best_f1_score: 0.8932; train_kl_reg_loss: 61071.2728; train_edge_recon_loss: 583386.1373; train_gene_expr_recon_loss: 18990213.7576; train_masked_gp_l1_reg_loss: 107045.1410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67924.8693; train_chrom_access_recon_loss: 9655417.1667; train_global_loss: 29465058.3030; train_optim_loss: 29465058.3030; val_kl_reg_loss: 60992.1685; val_edge_recon_loss: 595100.4219; val_gene_expr_recon_loss: 19173479.2500; val_masked_gp_l1_reg_loss: 107503.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68326.2656; val_chrom_access_recon_loss: 9779645.7500; val_global_loss: 29785048.0000; val_optim_loss: 29785048.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9515; val_auprc_score: 0.9373; val_best_acc_score: 0.8931; val_best_f1_score: 0.8993; train_kl_reg_loss: 60816.7434; train_edge_recon_loss: 584997.7225; train_gene_expr_recon_loss: 18962949.0606; train_masked_gp_l1_reg_loss: 107786.9151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68114.2943; train_chrom_access_recon_loss: 9624874.1515; train_global_loss: 29409539.1515; train_optim_loss: 29409539.1515; val_kl_reg_loss: 61084.3638; val_edge_recon_loss: 587450.1875; val_gene_expr_recon_loss: 18945285.7500; val_masked_gp_l1_reg_loss: 108076.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68251.7344; val_chrom_access_recon_loss: 9723263.0000; val_global_loss: 29493411.0000; val_optim_loss: 29493411.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9520; val_auprc_score: 0.9392; val_best_acc_score: 0.8931; val_best_f1_score: 0.8993; train_kl_reg_loss: 61025.1886; train_edge_recon_loss: 583106.1392; train_gene_expr_recon_loss: 18922637.3939; train_masked_gp_l1_reg_loss: 108338.3929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68347.7655; train_chrom_access_recon_loss: 9589911.0303; train_global_loss: 29333365.8788; train_optim_loss: 29333365.8788; val_kl_reg_loss: 61471.1997; val_edge_recon_loss: 585231.4062; val_gene_expr_recon_loss: 19018815.2500; val_masked_gp_l1_reg_loss: 108644.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68141.2969; val_chrom_access_recon_loss: 9803678.7500; val_global_loss: 29645982.5000; val_optim_loss: 29645982.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9486; val_auprc_score: 0.9331; val_best_acc_score: 0.8915; val_best_f1_score: 0.8965; train_kl_reg_loss: 61236.8832; train_edge_recon_loss: 583196.3220; train_gene_expr_recon_loss: 18907582.6970; train_masked_gp_l1_reg_loss: 108870.5107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68334.5088; train_chrom_access_recon_loss: 9572522.6212; train_global_loss: 29301743.5152; train_optim_loss: 29301743.5152; val_kl_reg_loss: 61446.0513; val_edge_recon_loss: 589376.4531; val_gene_expr_recon_loss: 18916401.7500; val_masked_gp_l1_reg_loss: 109024.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68614.6250; val_chrom_access_recon_loss: 9769404.8750; val_global_loss: 29514267.0000; val_optim_loss: 29514267.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9418; val_auprc_score: 0.9240; val_best_acc_score: 0.8812; val_best_f1_score: 0.8891; train_kl_reg_loss: 61180.0204; train_edge_recon_loss: 583311.0634; train_gene_expr_recon_loss: 18857145.2121; train_masked_gp_l1_reg_loss: 105695.7489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54305.5165; train_chrom_access_recon_loss: 9523598.7273; train_global_loss: 29185236.2424; train_optim_loss: 29185236.2424; val_kl_reg_loss: 62007.0269; val_edge_recon_loss: 595736.8828; val_gene_expr_recon_loss: 18917180.2500; val_masked_gp_l1_reg_loss: 104289.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50079.3555; val_chrom_access_recon_loss: 9645932.3750; val_global_loss: 29375226.2500; val_optim_loss: 29375226.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9475; val_auprc_score: 0.9323; val_best_acc_score: 0.8896; val_best_f1_score: 0.8949; train_kl_reg_loss: 61440.6644; train_edge_recon_loss: 582877.0777; train_gene_expr_recon_loss: 18858187.4545; train_masked_gp_l1_reg_loss: 104058.4645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49550.1953; train_chrom_access_recon_loss: 9522935.2424; train_global_loss: 29179049.3939; train_optim_loss: 29179049.3939; val_kl_reg_loss: 62187.7471; val_edge_recon_loss: 589229.8750; val_gene_expr_recon_loss: 19000096.2500; val_masked_gp_l1_reg_loss: 103932.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49273.9766; val_chrom_access_recon_loss: 9943887.2500; val_global_loss: 29748607.5000; val_optim_loss: 29748607.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9456; val_auprc_score: 0.9282; val_best_acc_score: 0.8888; val_best_f1_score: 0.8947; train_kl_reg_loss: 61552.1294; train_edge_recon_loss: 582982.9896; train_gene_expr_recon_loss: 18854902.2424; train_masked_gp_l1_reg_loss: 103885.3008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49097.6495; train_chrom_access_recon_loss: 9516476.8333; train_global_loss: 29168897.0000; train_optim_loss: 29168897.0000; val_kl_reg_loss: 62253.3315; val_edge_recon_loss: 592582.5781; val_gene_expr_recon_loss: 19027619.7500; val_masked_gp_l1_reg_loss: 103880.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48946.2344; val_chrom_access_recon_loss: 9679329.7500; val_global_loss: 29514611.2500; val_optim_loss: 29514611.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9459; val_auprc_score: 0.9318; val_best_acc_score: 0.8864; val_best_f1_score: 0.8912; train_kl_reg_loss: 61686.2292; train_edge_recon_loss: 580894.0473; train_gene_expr_recon_loss: 18853300.8182; train_masked_gp_l1_reg_loss: 103852.3015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48818.5878; train_chrom_access_recon_loss: 9514169.5909; train_global_loss: 29162721.6061; train_optim_loss: 29162721.6061; val_kl_reg_loss: 62459.5767; val_edge_recon_loss: 591514.8359; val_gene_expr_recon_loss: 18957724.2500; val_masked_gp_l1_reg_loss: 103869.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48705.9453; val_chrom_access_recon_loss: 9711312.8750; val_global_loss: 29475587.5000; val_optim_loss: 29475587.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 31 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9437
val AUPRC score: 0.9221
val best accuracy score: 0.8861
val best F1 score: 0.8912
val target rna MSE score: 1.2810
val source rna MSE score: 0.7237
val target atac MSE score: 0.3333
val source atac MSE score: 0.1273
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
