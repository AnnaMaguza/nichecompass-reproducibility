[True]
Run timestamp: 10102023_050148_151.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_151']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6902; val_auprc_score: 0.6776; val_best_acc_score: 0.5105; val_best_f1_score: 0.6710; train_kl_reg_loss: 54812.3905; train_edge_recon_loss: 743638.6449; train_gene_expr_recon_loss: 23233775.5758; train_masked_gp_l1_reg_loss: 41490.8925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4098149.4242; train_chrom_access_recon_loss: 2318217.2197; train_global_loss: 30490084.0303; train_optim_loss: 30490084.0303; val_kl_reg_loss: 74836.3779; val_edge_recon_loss: 812974.0234; val_gene_expr_recon_loss: 21903384.0000; val_masked_gp_l1_reg_loss: 47777.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2819809.5000; val_chrom_access_recon_loss: 2233648.4062; val_global_loss: 27892431.0000; val_optim_loss: 27892431.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7032; val_auprc_score: 0.6935; val_best_acc_score: 0.5873; val_best_f1_score: 0.6934; train_kl_reg_loss: 77665.5953; train_edge_recon_loss: 741927.9991; train_gene_expr_recon_loss: 21306504.9091; train_masked_gp_l1_reg_loss: 48333.7604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1874530.9508; train_chrom_access_recon_loss: 2210514.3485; train_global_loss: 26259477.5152; train_optim_loss: 26259477.5152; val_kl_reg_loss: 75397.1562; val_edge_recon_loss: 811698.2031; val_gene_expr_recon_loss: 21013608.7500; val_masked_gp_l1_reg_loss: 48541.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1144417.0000; val_chrom_access_recon_loss: 2155359.7188; val_global_loss: 25249022.0000; val_optim_loss: 25249022.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7491; val_auprc_score: 0.7323; val_best_acc_score: 0.6666; val_best_f1_score: 0.7012; train_kl_reg_loss: 71606.8137; train_edge_recon_loss: 732408.4451; train_gene_expr_recon_loss: 21074093.2424; train_masked_gp_l1_reg_loss: 48862.5733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 794814.0350; train_chrom_access_recon_loss: 2192965.6061; train_global_loss: 24914750.7879; train_optim_loss: 24914750.7879; val_kl_reg_loss: 69340.1650; val_edge_recon_loss: 808655.6250; val_gene_expr_recon_loss: 21193547.2500; val_masked_gp_l1_reg_loss: 49208.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 540540.2500; val_chrom_access_recon_loss: 2190545.7188; val_global_loss: 24851837.0000; val_optim_loss: 24851837.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8308; val_auprc_score: 0.8003; val_best_acc_score: 0.7362; val_best_f1_score: 0.7763; train_kl_reg_loss: 64550.8132; train_edge_recon_loss: 725379.9934; train_gene_expr_recon_loss: 20921992.4242; train_masked_gp_l1_reg_loss: 49790.2224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 418526.9721; train_chrom_access_recon_loss: 2181677.0568; train_global_loss: 24361917.3939; train_optim_loss: 24361917.3939; val_kl_reg_loss: 63356.8364; val_edge_recon_loss: 789089.1875; val_gene_expr_recon_loss: 20749378.0000; val_masked_gp_l1_reg_loss: 50657.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 329454.4688; val_chrom_access_recon_loss: 2152800.0000; val_global_loss: 24134736.0000; val_optim_loss: 24134736.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8751; val_auprc_score: 0.8370; val_best_acc_score: 0.8020; val_best_f1_score: 0.8221; train_kl_reg_loss: 59526.9487; train_edge_recon_loss: 704812.2415; train_gene_expr_recon_loss: 20764728.2121; train_masked_gp_l1_reg_loss: 51515.6393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 279076.5196; train_chrom_access_recon_loss: 2168288.1686; train_global_loss: 24027947.8788; train_optim_loss: 24027947.8788; val_kl_reg_loss: 59489.7007; val_edge_recon_loss: 697121.1172; val_gene_expr_recon_loss: 20854409.5000; val_masked_gp_l1_reg_loss: 52535.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 237204.9844; val_chrom_access_recon_loss: 2168183.0938; val_global_loss: 24068943.5000; val_optim_loss: 24068943.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8686; val_auprc_score: 0.8281; val_best_acc_score: 0.7977; val_best_f1_score: 0.8210; train_kl_reg_loss: 67878.6788; train_edge_recon_loss: 647526.2045; train_gene_expr_recon_loss: 20592048.5455; train_masked_gp_l1_reg_loss: 53574.9061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 208747.5111; train_chrom_access_recon_loss: 2153359.7765; train_global_loss: 23723135.6667; train_optim_loss: 23723135.6667; val_kl_reg_loss: 68590.9326; val_edge_recon_loss: 639654.7266; val_gene_expr_recon_loss: 20600039.2500; val_masked_gp_l1_reg_loss: 54701.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183300.4531; val_chrom_access_recon_loss: 2129789.5938; val_global_loss: 23676076.5000; val_optim_loss: 23676076.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8880; val_auprc_score: 0.8488; val_best_acc_score: 0.8211; val_best_f1_score: 0.8342; train_kl_reg_loss: 70987.8942; train_edge_recon_loss: 629078.2273; train_gene_expr_recon_loss: 20520022.9091; train_masked_gp_l1_reg_loss: 55581.4881; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 165865.8658; train_chrom_access_recon_loss: 2146116.1458; train_global_loss: 23587652.6970; train_optim_loss: 23587652.6970; val_kl_reg_loss: 68910.7031; val_edge_recon_loss: 625162.1641; val_gene_expr_recon_loss: 20680134.7500; val_masked_gp_l1_reg_loss: 56451.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 150337.1250; val_chrom_access_recon_loss: 2148269.0469; val_global_loss: 23729266.5000; val_optim_loss: 23729266.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8967; val_auprc_score: 0.8574; val_best_acc_score: 0.8342; val_best_f1_score: 0.8459; train_kl_reg_loss: 69127.5886; train_edge_recon_loss: 617619.1288; train_gene_expr_recon_loss: 20389370.1212; train_masked_gp_l1_reg_loss: 57236.6610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139856.7914; train_chrom_access_recon_loss: 2132359.8068; train_global_loss: 23405570.2424; train_optim_loss: 23405570.2424; val_kl_reg_loss: 68780.2080; val_edge_recon_loss: 612077.8047; val_gene_expr_recon_loss: 20458064.5000; val_masked_gp_l1_reg_loss: 57911.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131309.5625; val_chrom_access_recon_loss: 2122890.8594; val_global_loss: 23451035.2500; val_optim_loss: 23451035.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9107; val_auprc_score: 0.8843; val_best_acc_score: 0.8428; val_best_f1_score: 0.8532; train_kl_reg_loss: 68042.1699; train_edge_recon_loss: 610358.8191; train_gene_expr_recon_loss: 20317643.4242; train_masked_gp_l1_reg_loss: 58628.3876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124267.2269; train_chrom_access_recon_loss: 2128175.4053; train_global_loss: 23307115.3030; train_optim_loss: 23307115.3030; val_kl_reg_loss: 67258.8906; val_edge_recon_loss: 607188.4141; val_gene_expr_recon_loss: 20380117.7500; val_masked_gp_l1_reg_loss: 59306.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118560.7578; val_chrom_access_recon_loss: 2103890.8906; val_global_loss: 23336322.0000; val_optim_loss: 23336322.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9055; val_auprc_score: 0.8744; val_best_acc_score: 0.8426; val_best_f1_score: 0.8539; train_kl_reg_loss: 66761.7164; train_edge_recon_loss: 605396.3011; train_gene_expr_recon_loss: 20229659.5455; train_masked_gp_l1_reg_loss: 59878.4164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113651.1990; train_chrom_access_recon_loss: 2119193.0682; train_global_loss: 23194540.3939; train_optim_loss: 23194540.3939; val_kl_reg_loss: 64252.7217; val_edge_recon_loss: 610003.4688; val_gene_expr_recon_loss: 20243105.2500; val_masked_gp_l1_reg_loss: 60503.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108465.7578; val_chrom_access_recon_loss: 2101217.9062; val_global_loss: 23187549.5000; val_optim_loss: 23187549.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9136; val_auprc_score: 0.8804; val_best_acc_score: 0.8469; val_best_f1_score: 0.8525; train_kl_reg_loss: 65924.0160; train_edge_recon_loss: 601423.0578; train_gene_expr_recon_loss: 20142773.7273; train_masked_gp_l1_reg_loss: 60939.8222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104956.1916; train_chrom_access_recon_loss: 2111365.4413; train_global_loss: 23087382.4545; train_optim_loss: 23087382.4545; val_kl_reg_loss: 67298.3301; val_edge_recon_loss: 605566.1094; val_gene_expr_recon_loss: 20077147.5000; val_masked_gp_l1_reg_loss: 61483.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102142.2969; val_chrom_access_recon_loss: 2093114.6719; val_global_loss: 23006752.7500; val_optim_loss: 23006752.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9167; val_auprc_score: 0.8917; val_best_acc_score: 0.8452; val_best_f1_score: 0.8566; train_kl_reg_loss: 64696.2740; train_edge_recon_loss: 598212.8589; train_gene_expr_recon_loss: 20085101.6970; train_masked_gp_l1_reg_loss: 61955.8664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99169.3084; train_chrom_access_recon_loss: 2104944.3390; train_global_loss: 23014080.3636; train_optim_loss: 23014080.3636; val_kl_reg_loss: 64729.7847; val_edge_recon_loss: 603757.6406; val_gene_expr_recon_loss: 20043657.2500; val_masked_gp_l1_reg_loss: 62462.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96144.6875; val_chrom_access_recon_loss: 2091690.5156; val_global_loss: 22962440.7500; val_optim_loss: 22962440.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9105; val_auprc_score: 0.8812; val_best_acc_score: 0.8461; val_best_f1_score: 0.8581; train_kl_reg_loss: 63505.4669; train_edge_recon_loss: 597957.7869; train_gene_expr_recon_loss: 20009622.3636; train_masked_gp_l1_reg_loss: 62747.8064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93892.7244; train_chrom_access_recon_loss: 2097279.7462; train_global_loss: 22925006.0909; train_optim_loss: 22925006.0909; val_kl_reg_loss: 62658.2881; val_edge_recon_loss: 603890.5391; val_gene_expr_recon_loss: 19975027.5000; val_masked_gp_l1_reg_loss: 63126.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92539.5469; val_chrom_access_recon_loss: 2082666.0781; val_global_loss: 22879908.5000; val_optim_loss: 22879908.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9202; val_auprc_score: 0.8856; val_best_acc_score: 0.8563; val_best_f1_score: 0.8642; train_kl_reg_loss: 62604.5556; train_edge_recon_loss: 593702.4934; train_gene_expr_recon_loss: 19966755.8182; train_masked_gp_l1_reg_loss: 63562.9491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90400.3609; train_chrom_access_recon_loss: 2093811.5322; train_global_loss: 22870837.9394; train_optim_loss: 22870837.9394; val_kl_reg_loss: 63062.9902; val_edge_recon_loss: 600845.5625; val_gene_expr_recon_loss: 20079344.2500; val_masked_gp_l1_reg_loss: 63896.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89114.6328; val_chrom_access_recon_loss: 2085780.8281; val_global_loss: 22982043.7500; val_optim_loss: 22982043.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9273; val_auprc_score: 0.9030; val_best_acc_score: 0.8654; val_best_f1_score: 0.8719; train_kl_reg_loss: 61429.1609; train_edge_recon_loss: 595060.7206; train_gene_expr_recon_loss: 19910005.8788; train_masked_gp_l1_reg_loss: 64365.9551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87483.1710; train_chrom_access_recon_loss: 2086880.5265; train_global_loss: 22805225.5152; train_optim_loss: 22805225.5152; val_kl_reg_loss: 61786.5454; val_edge_recon_loss: 593200.1406; val_gene_expr_recon_loss: 19898275.7500; val_masked_gp_l1_reg_loss: 64764.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86237.1719; val_chrom_access_recon_loss: 2063176.5156; val_global_loss: 22767440.7500; val_optim_loss: 22767440.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9320; val_auprc_score: 0.9114; val_best_acc_score: 0.8608; val_best_f1_score: 0.8672; train_kl_reg_loss: 60734.2038; train_edge_recon_loss: 592340.0748; train_gene_expr_recon_loss: 19826528.7879; train_masked_gp_l1_reg_loss: 65056.2027; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85311.1783; train_chrom_access_recon_loss: 2080185.2083; train_global_loss: 22710155.7273; train_optim_loss: 22710155.7273; val_kl_reg_loss: 61771.8506; val_edge_recon_loss: 596714.6875; val_gene_expr_recon_loss: 19743057.5000; val_masked_gp_l1_reg_loss: 65387.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84577.3281; val_chrom_access_recon_loss: 2039412.5312; val_global_loss: 22590922.7500; val_optim_loss: 22590922.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9351; val_auprc_score: 0.9099; val_best_acc_score: 0.8740; val_best_f1_score: 0.8775; train_kl_reg_loss: 60147.5925; train_edge_recon_loss: 588730.4214; train_gene_expr_recon_loss: 19776228.0909; train_masked_gp_l1_reg_loss: 65725.6977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83398.0036; train_chrom_access_recon_loss: 2072559.8068; train_global_loss: 22646789.7879; train_optim_loss: 22646789.7879; val_kl_reg_loss: 60378.9937; val_edge_recon_loss: 595823.5625; val_gene_expr_recon_loss: 19783617.5000; val_masked_gp_l1_reg_loss: 66175.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82568.3750; val_chrom_access_recon_loss: 2053442.1094; val_global_loss: 22642006.0000; val_optim_loss: 22642006.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9398; val_auprc_score: 0.9161; val_best_acc_score: 0.8759; val_best_f1_score: 0.8839; train_kl_reg_loss: 59597.4630; train_edge_recon_loss: 586848.5095; train_gene_expr_recon_loss: 19715418.7273; train_masked_gp_l1_reg_loss: 66400.7482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82135.4537; train_chrom_access_recon_loss: 2067233.7045; train_global_loss: 22577634.8485; train_optim_loss: 22577634.8485; val_kl_reg_loss: 59080.4795; val_edge_recon_loss: 589858.1328; val_gene_expr_recon_loss: 19787502.2500; val_masked_gp_l1_reg_loss: 66738.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81948.0625; val_chrom_access_recon_loss: 2051855.2031; val_global_loss: 22636982.2500; val_optim_loss: 22636982.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9422; val_auprc_score: 0.9202; val_best_acc_score: 0.8850; val_best_f1_score: 0.8897; train_kl_reg_loss: 58769.2757; train_edge_recon_loss: 585856.1051; train_gene_expr_recon_loss: 19680064.8485; train_masked_gp_l1_reg_loss: 67070.5475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81489.2679; train_chrom_access_recon_loss: 2065840.3788; train_global_loss: 22539090.3333; train_optim_loss: 22539090.3333; val_kl_reg_loss: 58839.9468; val_edge_recon_loss: 584930.6562; val_gene_expr_recon_loss: 19667380.2500; val_masked_gp_l1_reg_loss: 67377.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80750.6250; val_chrom_access_recon_loss: 2031936.6250; val_global_loss: 22491216.0000; val_optim_loss: 22491216.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9407; val_auprc_score: 0.9232; val_best_acc_score: 0.8837; val_best_f1_score: 0.8897; train_kl_reg_loss: 58535.5920; train_edge_recon_loss: 585002.5862; train_gene_expr_recon_loss: 19614841.0000; train_masked_gp_l1_reg_loss: 67600.4676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80286.6932; train_chrom_access_recon_loss: 2057535.8106; train_global_loss: 22463802.1212; train_optim_loss: 22463802.1212; val_kl_reg_loss: 60796.5024; val_edge_recon_loss: 593092.6250; val_gene_expr_recon_loss: 19672219.2500; val_masked_gp_l1_reg_loss: 67945.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80336.7734; val_chrom_access_recon_loss: 2053976.3438; val_global_loss: 22528367.0000; val_optim_loss: 22528367.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9426; val_auprc_score: 0.9169; val_best_acc_score: 0.8901; val_best_f1_score: 0.8954; train_kl_reg_loss: 58060.3217; train_edge_recon_loss: 582039.9299; train_gene_expr_recon_loss: 19589576.9394; train_masked_gp_l1_reg_loss: 68214.1611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79946.1162; train_chrom_access_recon_loss: 2054923.5606; train_global_loss: 22432761.2121; train_optim_loss: 22432761.2121; val_kl_reg_loss: 59259.9897; val_edge_recon_loss: 588261.1875; val_gene_expr_recon_loss: 19557433.7500; val_masked_gp_l1_reg_loss: 68484.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79657.6484; val_chrom_access_recon_loss: 2028884.0312; val_global_loss: 22381980.7500; val_optim_loss: 22381980.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9452; val_auprc_score: 0.9282; val_best_acc_score: 0.8845; val_best_f1_score: 0.8890; train_kl_reg_loss: 57462.0886; train_edge_recon_loss: 579932.7112; train_gene_expr_recon_loss: 19554342.5152; train_masked_gp_l1_reg_loss: 68717.4161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79237.6088; train_chrom_access_recon_loss: 2049150.7652; train_global_loss: 22388843.3333; train_optim_loss: 22388843.3333; val_kl_reg_loss: 58888.0898; val_edge_recon_loss: 591737.6250; val_gene_expr_recon_loss: 19414376.2500; val_masked_gp_l1_reg_loss: 68959.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78929.7422; val_chrom_access_recon_loss: 2023475.5625; val_global_loss: 22236367.5000; val_optim_loss: 22236367.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9419; val_auprc_score: 0.9219; val_best_acc_score: 0.8864; val_best_f1_score: 0.8904; train_kl_reg_loss: 56875.2219; train_edge_recon_loss: 581578.2680; train_gene_expr_recon_loss: 19489524.0303; train_masked_gp_l1_reg_loss: 69259.0858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78496.8451; train_chrom_access_recon_loss: 2042610.7614; train_global_loss: 22318344.2424; train_optim_loss: 22318344.2424; val_kl_reg_loss: 57139.9277; val_edge_recon_loss: 587698.2500; val_gene_expr_recon_loss: 19484775.7500; val_masked_gp_l1_reg_loss: 69612.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78036.6406; val_chrom_access_recon_loss: 2026167.1406; val_global_loss: 22303429.0000; val_optim_loss: 22303429.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9443; val_auprc_score: 0.9186; val_best_acc_score: 0.8925; val_best_f1_score: 0.8968; train_kl_reg_loss: 56297.1960; train_edge_recon_loss: 579510.7206; train_gene_expr_recon_loss: 19454360.5758; train_masked_gp_l1_reg_loss: 69851.2469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77826.4790; train_chrom_access_recon_loss: 2040400.6458; train_global_loss: 22278246.6667; train_optim_loss: 22278246.6667; val_kl_reg_loss: 56950.4878; val_edge_recon_loss: 579740.5469; val_gene_expr_recon_loss: 19508940.0000; val_masked_gp_l1_reg_loss: 70161.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77868.4922; val_chrom_access_recon_loss: 2027226.8906; val_global_loss: 22320888.0000; val_optim_loss: 22320888.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9491; val_auprc_score: 0.9325; val_best_acc_score: 0.8966; val_best_f1_score: 0.9013; train_kl_reg_loss: 56064.8836; train_edge_recon_loss: 577652.5511; train_gene_expr_recon_loss: 19414438.0606; train_masked_gp_l1_reg_loss: 70396.8516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77433.5749; train_chrom_access_recon_loss: 2035303.8939; train_global_loss: 22231290.0303; train_optim_loss: 22231290.0303; val_kl_reg_loss: 58165.6494; val_edge_recon_loss: 586587.4922; val_gene_expr_recon_loss: 19463512.2500; val_masked_gp_l1_reg_loss: 70700.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77316.2812; val_chrom_access_recon_loss: 2026596.6562; val_global_loss: 22282878.5000; val_optim_loss: 22282878.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8737; val_auprc_score: 0.8296; val_best_acc_score: 0.8117; val_best_f1_score: 0.8297; train_kl_reg_loss: 33416.0887; train_edge_recon_loss: 729618.1345; train_gene_expr_recon_loss: 18032323.1818; train_masked_gp_l1_reg_loss: 71554.6751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81001.8111; train_chrom_access_recon_loss: 1883472.8466; train_global_loss: 20831386.7879; train_optim_loss: 20831386.7879; val_kl_reg_loss: 8308.9464; val_edge_recon_loss: 736474.0312; val_gene_expr_recon_loss: 17919138.2500; val_masked_gp_l1_reg_loss: 72701.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91196.6328; val_chrom_access_recon_loss: 1845181.7812; val_global_loss: 20673001.0000; val_optim_loss: 20673001.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8698; val_auprc_score: 0.8325; val_best_acc_score: 0.7966; val_best_f1_score: 0.8193; train_kl_reg_loss: 21148.2865; train_edge_recon_loss: 704102.1544; train_gene_expr_recon_loss: 17705713.9394; train_masked_gp_l1_reg_loss: 72514.4364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92528.7797; train_chrom_access_recon_loss: 1850416.4261; train_global_loss: 20446424.1212; train_optim_loss: 20446424.1212; val_kl_reg_loss: 14247.1764; val_edge_recon_loss: 703921.3281; val_gene_expr_recon_loss: 17645576.5000; val_masked_gp_l1_reg_loss: 71314.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91090.2109; val_chrom_access_recon_loss: 1834487.6875; val_global_loss: 20360637.2500; val_optim_loss: 20360637.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8648; val_auprc_score: 0.8262; val_best_acc_score: 0.7998; val_best_f1_score: 0.8182; train_kl_reg_loss: 23405.1088; train_edge_recon_loss: 674301.2756; train_gene_expr_recon_loss: 17549715.8485; train_masked_gp_l1_reg_loss: 69916.6390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89073.1322; train_chrom_access_recon_loss: 1839172.3580; train_global_loss: 20245584.5152; train_optim_loss: 20245584.5152; val_kl_reg_loss: 14693.7413; val_edge_recon_loss: 682972.4688; val_gene_expr_recon_loss: 17619870.5000; val_masked_gp_l1_reg_loss: 68467.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86748.5938; val_chrom_access_recon_loss: 1834680.2500; val_global_loss: 20307431.7500; val_optim_loss: 20307431.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8733; val_auprc_score: 0.8366; val_best_acc_score: 0.8020; val_best_f1_score: 0.8235; train_kl_reg_loss: 23596.7642; train_edge_recon_loss: 658285.9991; train_gene_expr_recon_loss: 17498829.8636; train_masked_gp_l1_reg_loss: 67424.0723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85448.3411; train_chrom_access_recon_loss: 1834996.6667; train_global_loss: 20168581.7273; train_optim_loss: 20168581.7273; val_kl_reg_loss: 16014.5596; val_edge_recon_loss: 653693.8984; val_gene_expr_recon_loss: 17391605.5000; val_masked_gp_l1_reg_loss: 66353.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83410.7578; val_chrom_access_recon_loss: 1808662.4062; val_global_loss: 20019740.2500; val_optim_loss: 20019740.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8615; val_auprc_score: 0.8278; val_best_acc_score: 0.7886; val_best_f1_score: 0.8132; train_kl_reg_loss: 24390.9541; train_edge_recon_loss: 641628.3475; train_gene_expr_recon_loss: 17446458.4242; train_masked_gp_l1_reg_loss: 65394.7621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81776.7982; train_chrom_access_recon_loss: 1829534.3466; train_global_loss: 20089183.6667; train_optim_loss: 20089183.6667; val_kl_reg_loss: 17300.9578; val_edge_recon_loss: 640599.8359; val_gene_expr_recon_loss: 17429056.5000; val_masked_gp_l1_reg_loss: 64462.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80556.7734; val_chrom_access_recon_loss: 1803455.3750; val_global_loss: 20035430.5000; val_optim_loss: 20035430.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8718; val_auprc_score: 0.8368; val_best_acc_score: 0.7998; val_best_f1_score: 0.8244; train_kl_reg_loss: 25360.7466; train_edge_recon_loss: 627165.4072; train_gene_expr_recon_loss: 17409615.8333; train_masked_gp_l1_reg_loss: 63646.3614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79200.8050; train_chrom_access_recon_loss: 1827145.4886; train_global_loss: 20032134.6364; train_optim_loss: 20032134.6364; val_kl_reg_loss: 19658.5676; val_edge_recon_loss: 621552.7500; val_gene_expr_recon_loss: 17458885.2500; val_masked_gp_l1_reg_loss: 62798.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77962.4453; val_chrom_access_recon_loss: 1811028.6875; val_global_loss: 20051885.0000; val_optim_loss: 20051885.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8778; val_auprc_score: 0.8436; val_best_acc_score: 0.8076; val_best_f1_score: 0.8286; train_kl_reg_loss: 26608.8168; train_edge_recon_loss: 615622.9356; train_gene_expr_recon_loss: 17367512.2121; train_masked_gp_l1_reg_loss: 62090.0318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76929.9899; train_chrom_access_recon_loss: 1822674.9337; train_global_loss: 19971438.8485; train_optim_loss: 19971438.8485; val_kl_reg_loss: 22416.1250; val_edge_recon_loss: 612049.8125; val_gene_expr_recon_loss: 17405454.7500; val_masked_gp_l1_reg_loss: 61427.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76152.0234; val_chrom_access_recon_loss: 1820426.5312; val_global_loss: 19997927.0000; val_optim_loss: 19997927.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8701; val_auprc_score: 0.8374; val_best_acc_score: 0.8006; val_best_f1_score: 0.8253; train_kl_reg_loss: 28359.8151; train_edge_recon_loss: 603821.9527; train_gene_expr_recon_loss: 17330927.7273; train_masked_gp_l1_reg_loss: 60788.4871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75174.3364; train_chrom_access_recon_loss: 1818808.7386; train_global_loss: 19917881.0000; train_optim_loss: 19917881.0000; val_kl_reg_loss: 25521.9246; val_edge_recon_loss: 609119.0859; val_gene_expr_recon_loss: 17289385.5000; val_masked_gp_l1_reg_loss: 60180.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74411.3594; val_chrom_access_recon_loss: 1798826.3594; val_global_loss: 19857444.7500; val_optim_loss: 19857444.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8844; val_auprc_score: 0.8580; val_best_acc_score: 0.8076; val_best_f1_score: 0.8283; train_kl_reg_loss: 30133.4694; train_edge_recon_loss: 598421.5928; train_gene_expr_recon_loss: 17315219.3636; train_masked_gp_l1_reg_loss: 59631.6620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73568.8415; train_chrom_access_recon_loss: 1816753.4451; train_global_loss: 19893728.3939; train_optim_loss: 19893728.3939; val_kl_reg_loss: 27679.9478; val_edge_recon_loss: 601809.7734; val_gene_expr_recon_loss: 17306777.5000; val_masked_gp_l1_reg_loss: 59050.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72993.6797; val_chrom_access_recon_loss: 1801890.4062; val_global_loss: 19870201.5000; val_optim_loss: 19870201.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8838; val_auprc_score: 0.8496; val_best_acc_score: 0.8117; val_best_f1_score: 0.8306; train_kl_reg_loss: 30985.9594; train_edge_recon_loss: 596429.2093; train_gene_expr_recon_loss: 17307996.9394; train_masked_gp_l1_reg_loss: 58518.7791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72469.6652; train_chrom_access_recon_loss: 1814854.3485; train_global_loss: 19881254.9091; train_optim_loss: 19881254.9091; val_kl_reg_loss: 29147.4644; val_edge_recon_loss: 592722.7344; val_gene_expr_recon_loss: 17293554.3750; val_masked_gp_l1_reg_loss: 57966.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72050.3828; val_chrom_access_recon_loss: 1811821.9219; val_global_loss: 19857263.0000; val_optim_loss: 19857263.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8907; val_auprc_score: 0.8597; val_best_acc_score: 0.8213; val_best_f1_score: 0.8363; train_kl_reg_loss: 31546.7440; train_edge_recon_loss: 591033.6155; train_gene_expr_recon_loss: 17280082.4545; train_masked_gp_l1_reg_loss: 57518.2736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71539.3299; train_chrom_access_recon_loss: 1812471.5568; train_global_loss: 19844191.8485; train_optim_loss: 19844191.8485; val_kl_reg_loss: 30423.7461; val_edge_recon_loss: 594688.7656; val_gene_expr_recon_loss: 17239981.2500; val_masked_gp_l1_reg_loss: 57143.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71083.2188; val_chrom_access_recon_loss: 1813789.4688; val_global_loss: 19807111.0000; val_optim_loss: 19807111.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8924; val_auprc_score: 0.8604; val_best_acc_score: 0.8211; val_best_f1_score: 0.8404; train_kl_reg_loss: 32096.4920; train_edge_recon_loss: 591328.3542; train_gene_expr_recon_loss: 17257241.7879; train_masked_gp_l1_reg_loss: 56754.1393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70751.9680; train_chrom_access_recon_loss: 1810649.5909; train_global_loss: 19818822.2424; train_optim_loss: 19818822.2424; val_kl_reg_loss: 31109.1926; val_edge_recon_loss: 594381.2109; val_gene_expr_recon_loss: 17331498.5000; val_masked_gp_l1_reg_loss: 56399.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70377.1016; val_chrom_access_recon_loss: 1803859.4219; val_global_loss: 19887625.7500; val_optim_loss: 19887625.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8897; val_auprc_score: 0.8483; val_best_acc_score: 0.8264; val_best_f1_score: 0.8418; train_kl_reg_loss: 32534.7895; train_edge_recon_loss: 589498.4261; train_gene_expr_recon_loss: 17242586.3333; train_masked_gp_l1_reg_loss: 56039.9052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70016.2293; train_chrom_access_recon_loss: 1808606.4072; train_global_loss: 19799282.2727; train_optim_loss: 19799282.2727; val_kl_reg_loss: 31112.5403; val_edge_recon_loss: 592158.7578; val_gene_expr_recon_loss: 17210588.7500; val_masked_gp_l1_reg_loss: 55778.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69673.6094; val_chrom_access_recon_loss: 1782643.4375; val_global_loss: 19741955.2500; val_optim_loss: 19741955.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9037; val_auprc_score: 0.8759; val_best_acc_score: 0.8375; val_best_f1_score: 0.8473; train_kl_reg_loss: 32724.7035; train_edge_recon_loss: 586010.8220; train_gene_expr_recon_loss: 17211661.0303; train_masked_gp_l1_reg_loss: 55477.0725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69414.0225; train_chrom_access_recon_loss: 1806449.8087; train_global_loss: 19761737.5152; train_optim_loss: 19761737.5152; val_kl_reg_loss: 32245.5452; val_edge_recon_loss: 588659.5703; val_gene_expr_recon_loss: 17281052.2500; val_masked_gp_l1_reg_loss: 55182.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69042.6641; val_chrom_access_recon_loss: 1793948.2656; val_global_loss: 19820129.7500; val_optim_loss: 19820129.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9079; val_auprc_score: 0.8836; val_best_acc_score: 0.8377; val_best_f1_score: 0.8513; train_kl_reg_loss: 33683.2035; train_edge_recon_loss: 582684.8759; train_gene_expr_recon_loss: 17206423.6515; train_masked_gp_l1_reg_loss: 54928.2777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68239.6307; train_chrom_access_recon_loss: 1807977.1553; train_global_loss: 19753936.8788; train_optim_loss: 19753936.8788; val_kl_reg_loss: 32931.3381; val_edge_recon_loss: 583287.2422; val_gene_expr_recon_loss: 17164335.8750; val_masked_gp_l1_reg_loss: 54728.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67759.4531; val_chrom_access_recon_loss: 1796213.0625; val_global_loss: 19699255.5000; val_optim_loss: 19699255.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9066; val_auprc_score: 0.8785; val_best_acc_score: 0.8420; val_best_f1_score: 0.8527; train_kl_reg_loss: 33895.7835; train_edge_recon_loss: 583136.3333; train_gene_expr_recon_loss: 17184600.6818; train_masked_gp_l1_reg_loss: 54483.5439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67412.1396; train_chrom_access_recon_loss: 1801651.9470; train_global_loss: 19725180.2727; train_optim_loss: 19725180.2727; val_kl_reg_loss: 32528.0190; val_edge_recon_loss: 580995.3203; val_gene_expr_recon_loss: 17225624.5000; val_masked_gp_l1_reg_loss: 54326.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67040.7656; val_chrom_access_recon_loss: 1805673.3750; val_global_loss: 19766187.5000; val_optim_loss: 19766187.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9031; val_auprc_score: 0.8738; val_best_acc_score: 0.8409; val_best_f1_score: 0.8537; train_kl_reg_loss: 34159.2260; train_edge_recon_loss: 576822.2727; train_gene_expr_recon_loss: 17159678.0606; train_masked_gp_l1_reg_loss: 54166.6611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67043.4253; train_chrom_access_recon_loss: 1798691.9754; train_global_loss: 19690561.5758; train_optim_loss: 19690561.5758; val_kl_reg_loss: 32374.9517; val_edge_recon_loss: 586834.6797; val_gene_expr_recon_loss: 17156335.2500; val_masked_gp_l1_reg_loss: 54021.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66973.9531; val_chrom_access_recon_loss: 1781654.8125; val_global_loss: 19678195.7500; val_optim_loss: 19678195.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9102; val_auprc_score: 0.8838; val_best_acc_score: 0.8447; val_best_f1_score: 0.8545; train_kl_reg_loss: 34590.5641; train_edge_recon_loss: 578707.0966; train_gene_expr_recon_loss: 17147386.8939; train_masked_gp_l1_reg_loss: 53897.6236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66911.9473; train_chrom_access_recon_loss: 1798545.6913; train_global_loss: 19680039.6970; train_optim_loss: 19680039.6970; val_kl_reg_loss: 33445.2188; val_edge_recon_loss: 584414.0547; val_gene_expr_recon_loss: 17182208.2500; val_masked_gp_l1_reg_loss: 53751.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66638.9453; val_chrom_access_recon_loss: 1783927.9844; val_global_loss: 19704385.0000; val_optim_loss: 19704385.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9131; val_auprc_score: 0.8876; val_best_acc_score: 0.8463; val_best_f1_score: 0.8566; train_kl_reg_loss: 34689.2574; train_edge_recon_loss: 577416.5994; train_gene_expr_recon_loss: 17143654.1970; train_masked_gp_l1_reg_loss: 53605.8494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66501.1394; train_chrom_access_recon_loss: 1798329.5152; train_global_loss: 19674196.3333; train_optim_loss: 19674196.3333; val_kl_reg_loss: 33606.0947; val_edge_recon_loss: 584678.9453; val_gene_expr_recon_loss: 17212239.8750; val_masked_gp_l1_reg_loss: 53509.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66407.1016; val_chrom_access_recon_loss: 1806387.2031; val_global_loss: 19756829.7500; val_optim_loss: 19756829.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9165; val_auprc_score: 0.8905; val_best_acc_score: 0.8544; val_best_f1_score: 0.8676; train_kl_reg_loss: 34882.5587; train_edge_recon_loss: 574182.6259; train_gene_expr_recon_loss: 17127170.8939; train_masked_gp_l1_reg_loss: 53370.5073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66387.9721; train_chrom_access_recon_loss: 1795667.9470; train_global_loss: 19651662.5758; train_optim_loss: 19651662.5758; val_kl_reg_loss: 34141.3369; val_edge_recon_loss: 574522.6953; val_gene_expr_recon_loss: 17179606.7500; val_masked_gp_l1_reg_loss: 53261.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66058.1484; val_chrom_access_recon_loss: 1786827.4531; val_global_loss: 19694418.0000; val_optim_loss: 19694418.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9196; val_auprc_score: 0.8933; val_best_acc_score: 0.8503; val_best_f1_score: 0.8624; train_kl_reg_loss: 35106.5778; train_edge_recon_loss: 573288.5426; train_gene_expr_recon_loss: 17096474.1970; train_masked_gp_l1_reg_loss: 53093.7708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66140.5045; train_chrom_access_recon_loss: 1792855.2841; train_global_loss: 19616958.6970; train_optim_loss: 19616958.6970; val_kl_reg_loss: 34024.7036; val_edge_recon_loss: 573807.1250; val_gene_expr_recon_loss: 17284753.2500; val_masked_gp_l1_reg_loss: 53022.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66147.7578; val_chrom_access_recon_loss: 1791219.8594; val_global_loss: 19802974.5000; val_optim_loss: 19802974.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9120; val_auprc_score: 0.8839; val_best_acc_score: 0.8471; val_best_f1_score: 0.8619; train_kl_reg_loss: 34956.5874; train_edge_recon_loss: 571426.8608; train_gene_expr_recon_loss: 17101564.8485; train_masked_gp_l1_reg_loss: 52766.2910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57067.6221; train_chrom_access_recon_loss: 1790508.6345; train_global_loss: 19608290.8788; train_optim_loss: 19608290.8788; val_kl_reg_loss: 34251.5044; val_edge_recon_loss: 583390.5859; val_gene_expr_recon_loss: 17103492.5000; val_masked_gp_l1_reg_loss: 52628.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54934.6055; val_chrom_access_recon_loss: 1798307.6250; val_global_loss: 19627004.0000; val_optim_loss: 19627004.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9188; val_auprc_score: 0.8858; val_best_acc_score: 0.8579; val_best_f1_score: 0.8678; train_kl_reg_loss: 35141.4632; train_edge_recon_loss: 573558.7869; train_gene_expr_recon_loss: 17075686.4697; train_masked_gp_l1_reg_loss: 52580.4424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54560.5468; train_chrom_access_recon_loss: 1788417.3371; train_global_loss: 19579945.0909; train_optim_loss: 19579945.0909; val_kl_reg_loss: 33984.3738; val_edge_recon_loss: 581515.5781; val_gene_expr_recon_loss: 17025252.6250; val_masked_gp_l1_reg_loss: 52537.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54238.9258; val_chrom_access_recon_loss: 1767751.0781; val_global_loss: 19515279.5000; val_optim_loss: 19515279.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9161; val_auprc_score: 0.8889; val_best_acc_score: 0.8533; val_best_f1_score: 0.8614; train_kl_reg_loss: 35331.7845; train_edge_recon_loss: 574397.6657; train_gene_expr_recon_loss: 17082429.2727; train_masked_gp_l1_reg_loss: 52506.5847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54035.6689; train_chrom_access_recon_loss: 1789425.1553; train_global_loss: 19588126.2424; train_optim_loss: 19588126.2424; val_kl_reg_loss: 34615.6699; val_edge_recon_loss: 582972.7500; val_gene_expr_recon_loss: 17165331.8750; val_masked_gp_l1_reg_loss: 52478.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53818.6055; val_chrom_access_recon_loss: 1781677.3750; val_global_loss: 19670893.7500; val_optim_loss: 19670893.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9173; val_auprc_score: 0.8880; val_best_acc_score: 0.8533; val_best_f1_score: 0.8599; train_kl_reg_loss: 35310.9795; train_edge_recon_loss: 572354.2576; train_gene_expr_recon_loss: 17069612.0152; train_masked_gp_l1_reg_loss: 52456.7973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53678.5230; train_chrom_access_recon_loss: 1788378.0492; train_global_loss: 19571790.6061; train_optim_loss: 19571790.6061; val_kl_reg_loss: 34394.6636; val_edge_recon_loss: 586971.1719; val_gene_expr_recon_loss: 17096114.7500; val_masked_gp_l1_reg_loss: 52433.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53536.3398; val_chrom_access_recon_loss: 1776549.7344; val_global_loss: 19600000.2500; val_optim_loss: 19600000.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9149; val_auprc_score: 0.8764; val_best_acc_score: 0.8581; val_best_f1_score: 0.8693; train_kl_reg_loss: 35475.2167; train_edge_recon_loss: 573620.6752; train_gene_expr_recon_loss: 17068421.0303; train_masked_gp_l1_reg_loss: 52413.4534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53407.1800; train_chrom_access_recon_loss: 1788197.7917; train_global_loss: 19571535.3939; train_optim_loss: 19571535.3939; val_kl_reg_loss: 34812.7603; val_edge_recon_loss: 576247.2734; val_gene_expr_recon_loss: 17275059.2500; val_masked_gp_l1_reg_loss: 52385.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53301.8516; val_chrom_access_recon_loss: 1802289.5469; val_global_loss: 19794096.7500; val_optim_loss: 19794096.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9237; val_auprc_score: 0.8992; val_best_acc_score: 0.8619; val_best_f1_score: 0.8703; train_kl_reg_loss: 35578.3169; train_edge_recon_loss: 572093.9536; train_gene_expr_recon_loss: 17052252.4697; train_masked_gp_l1_reg_loss: 52366.6425; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53194.0610; train_chrom_access_recon_loss: 1786886.5492; train_global_loss: 19552371.8485; train_optim_loss: 19552371.8485; val_kl_reg_loss: 34650.5835; val_edge_recon_loss: 578525.2031; val_gene_expr_recon_loss: 17106109.2500; val_masked_gp_l1_reg_loss: 52349.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53069.3555; val_chrom_access_recon_loss: 1776082.7812; val_global_loss: 19600787.7500; val_optim_loss: 19600787.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9273; val_auprc_score: 0.9016; val_best_acc_score: 0.8662; val_best_f1_score: 0.8759; train_kl_reg_loss: 35502.0378; train_edge_recon_loss: 573192.4669; train_gene_expr_recon_loss: 17062030.7424; train_masked_gp_l1_reg_loss: 52323.3573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52155.0681; train_chrom_access_recon_loss: 1787479.9223; train_global_loss: 19562683.4545; train_optim_loss: 19562683.4545; val_kl_reg_loss: 34923.0664; val_edge_recon_loss: 573934.6953; val_gene_expr_recon_loss: 17092852.0000; val_masked_gp_l1_reg_loss: 52308.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51956.7930; val_chrom_access_recon_loss: 1779918.2969; val_global_loss: 19585891.5000; val_optim_loss: 19585891.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9272; val_auprc_score: 0.9001; val_best_acc_score: 0.8702; val_best_f1_score: 0.8792; train_kl_reg_loss: 35583.1958; train_edge_recon_loss: 573158.0805; train_gene_expr_recon_loss: 17056887.9242; train_masked_gp_l1_reg_loss: 52301.3384; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51924.5473; train_chrom_access_recon_loss: 1786104.1723; train_global_loss: 19555959.1515; train_optim_loss: 19555959.1515; val_kl_reg_loss: 34999.0366; val_edge_recon_loss: 571619.0234; val_gene_expr_recon_loss: 17182232.2500; val_masked_gp_l1_reg_loss: 52294.8398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51892.9883; val_chrom_access_recon_loss: 1782764.1719; val_global_loss: 19675800.2500; val_optim_loss: 19675800.2500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9203; val_auprc_score: 0.8966; val_best_acc_score: 0.8525; val_best_f1_score: 0.8623; train_kl_reg_loss: 35611.7678; train_edge_recon_loss: 573736.9621; train_gene_expr_recon_loss: 17066952.5758; train_masked_gp_l1_reg_loss: 52290.3288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51868.8742; train_chrom_access_recon_loss: 1787783.2254; train_global_loss: 19568243.6970; train_optim_loss: 19568243.6970; val_kl_reg_loss: 34688.4268; val_edge_recon_loss: 579253.6875; val_gene_expr_recon_loss: 17141630.5000; val_masked_gp_l1_reg_loss: 52285.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51843.5430; val_chrom_access_recon_loss: 1777120.3906; val_global_loss: 19636823.2500; val_optim_loss: 19636823.2500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9161; val_auprc_score: 0.8920; val_best_acc_score: 0.8520; val_best_f1_score: 0.8646; train_kl_reg_loss: 35641.7203; train_edge_recon_loss: 572550.2585; train_gene_expr_recon_loss: 17057605.0758; train_masked_gp_l1_reg_loss: 52281.7103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51826.2337; train_chrom_access_recon_loss: 1787611.7102; train_global_loss: 19557516.5758; train_optim_loss: 19557516.5758; val_kl_reg_loss: 34929.2627; val_edge_recon_loss: 577209.2266; val_gene_expr_recon_loss: 17086483.0000; val_masked_gp_l1_reg_loss: 52277.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51804.9297; val_chrom_access_recon_loss: 1768173.8438; val_global_loss: 19570877.2500; val_optim_loss: 19570877.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 8 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9224
val AUPRC score: 0.8965
val best accuracy score: 0.8589
val best F1 score: 0.8691
val target rna MSE score: 2.1249
val source rna MSE score: 1.2525
val target atac MSE score: 0.3193
val source atac MSE score: 0.1323
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
