[True]
Run timestamp: 31012024_180633_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse', '--reference_batches', 'batch10', 'batch15', 'batch21', 'batch22', 'batch23', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'dataset', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '50', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '300.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch21...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch22...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch23...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 931, n_cat_covariates_embed_input: 0, n_hidden: 931, n_latent: 1412, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1412, n_addon_gp_input: 10, n_cat_covariates_embed_input: 50, n_output: 931
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1412, n_addon_gp_input: 10, n_cat_covariates_embed_input: 50, n_output: 931

--- INITIALIZING TRAINER ---
Number of training nodes: 115396
Number of validation nodes: 12822
Number of training edges: 274980
Number of validation edges: 30553
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9597; val_auprc_score: 0.9671; val_best_acc_score: 0.9138; val_best_f1_score: 0.9297; train_kl_reg_loss: 5170.1543; train_edge_recon_loss: 221848.7263; train_cat_covariates_contrastive_loss: 117.2915; train_gene_expr_recon_loss: 222309.4827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449445.6547; train_optim_loss: 449445.6547; val_kl_reg_loss: 5595.0585; val_edge_recon_loss: 213927.9198; val_cat_covariates_contrastive_loss: 116.9392; val_gene_expr_recon_loss: 211635.1341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 431275.0521; val_optim_loss: 431275.0521
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9714; val_auprc_score: 0.9768; val_best_acc_score: 0.9267; val_best_f1_score: 0.9404; train_kl_reg_loss: 5542.0042; train_edge_recon_loss: 210017.0994; train_cat_covariates_contrastive_loss: 123.5569; train_gene_expr_recon_loss: 206547.6711; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 422230.3314; train_optim_loss: 422230.3314; val_kl_reg_loss: 5507.2303; val_edge_recon_loss: 212726.1875; val_cat_covariates_contrastive_loss: 125.9933; val_gene_expr_recon_loss: 202552.4052; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 420911.8182; val_optim_loss: 420911.8182
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9762; val_auprc_score: 0.9799; val_best_acc_score: 0.9396; val_best_f1_score: 0.9508; train_kl_reg_loss: 5532.7351; train_edge_recon_loss: 209537.4371; train_cat_covariates_contrastive_loss: 130.6160; train_gene_expr_recon_loss: 198974.1242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 414174.9120; train_optim_loss: 414174.9120; val_kl_reg_loss: 5613.3733; val_edge_recon_loss: 212950.9703; val_cat_covariates_contrastive_loss: 129.3408; val_gene_expr_recon_loss: 196188.7115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 414882.3953; val_optim_loss: 414882.3953
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9787; val_auprc_score: 0.9822; val_best_acc_score: 0.9415; val_best_f1_score: 0.9522; train_kl_reg_loss: 5712.0754; train_edge_recon_loss: 209353.6869; train_cat_covariates_contrastive_loss: 133.6377; train_gene_expr_recon_loss: 191428.6242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 406628.0240; train_optim_loss: 406628.0240; val_kl_reg_loss: 5849.0082; val_edge_recon_loss: 213340.0427; val_cat_covariates_contrastive_loss: 131.4205; val_gene_expr_recon_loss: 187868.0398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 407188.5115; val_optim_loss: 407188.5115
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9796; val_auprc_score: 0.9828; val_best_acc_score: 0.9440; val_best_f1_score: 0.9542; train_kl_reg_loss: 6028.4633; train_edge_recon_loss: 210161.9073; train_cat_covariates_contrastive_loss: 133.4646; train_gene_expr_recon_loss: 182763.7013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 399087.5362; train_optim_loss: 399087.5362; val_kl_reg_loss: 6020.1194; val_edge_recon_loss: 213719.5122; val_cat_covariates_contrastive_loss: 131.4179; val_gene_expr_recon_loss: 179661.7318; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 399532.7802; val_optim_loss: 399532.7802
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9808; val_auprc_score: 0.9836; val_best_acc_score: 0.9468; val_best_f1_score: 0.9564; train_kl_reg_loss: 6289.8296; train_edge_recon_loss: 209813.2186; train_cat_covariates_contrastive_loss: 133.1971; train_gene_expr_recon_loss: 175993.0377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 392229.2836; train_optim_loss: 392229.2836; val_kl_reg_loss: 6260.5730; val_edge_recon_loss: 214609.7336; val_cat_covariates_contrastive_loss: 131.6534; val_gene_expr_recon_loss: 173377.3984; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 394379.3568; val_optim_loss: 394379.3568
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9797; val_auprc_score: 0.9827; val_best_acc_score: 0.9449; val_best_f1_score: 0.9549; train_kl_reg_loss: 6481.2058; train_edge_recon_loss: 210044.8311; train_cat_covariates_contrastive_loss: 133.6787; train_gene_expr_recon_loss: 171049.5102; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 387709.2252; train_optim_loss: 387709.2252; val_kl_reg_loss: 6572.7742; val_edge_recon_loss: 213649.7974; val_cat_covariates_contrastive_loss: 131.8081; val_gene_expr_recon_loss: 169633.5326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 389987.9151; val_optim_loss: 389987.9151
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9822; val_auprc_score: 0.9841; val_best_acc_score: 0.9505; val_best_f1_score: 0.9594; train_kl_reg_loss: 6593.7154; train_edge_recon_loss: 209832.8410; train_cat_covariates_contrastive_loss: 133.9492; train_gene_expr_recon_loss: 167383.7340; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 383944.2397; train_optim_loss: 383944.2397; val_kl_reg_loss: 6624.6252; val_edge_recon_loss: 212954.6768; val_cat_covariates_contrastive_loss: 133.1100; val_gene_expr_recon_loss: 166357.3937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 386069.8021; val_optim_loss: 386069.8021
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9815; val_auprc_score: 0.9841; val_best_acc_score: 0.9495; val_best_f1_score: 0.9586; train_kl_reg_loss: 6672.5141; train_edge_recon_loss: 209681.6971; train_cat_covariates_contrastive_loss: 134.2318; train_gene_expr_recon_loss: 164642.4744; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 381130.9181; train_optim_loss: 381130.9181; val_kl_reg_loss: 6624.8406; val_edge_recon_loss: 213049.0859; val_cat_covariates_contrastive_loss: 133.8028; val_gene_expr_recon_loss: 164063.0049; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 383870.7344; val_optim_loss: 383870.7344
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9828; val_auprc_score: 0.9850; val_best_acc_score: 0.9513; val_best_f1_score: 0.9602; train_kl_reg_loss: 6731.9598; train_edge_recon_loss: 209507.5154; train_cat_covariates_contrastive_loss: 135.2352; train_gene_expr_recon_loss: 162645.3812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 379020.0919; train_optim_loss: 379020.0919; val_kl_reg_loss: 6688.3708; val_edge_recon_loss: 212538.3654; val_cat_covariates_contrastive_loss: 134.3971; val_gene_expr_recon_loss: 162557.8141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 381918.9453; val_optim_loss: 381918.9453
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9820; val_auprc_score: 0.9839; val_best_acc_score: 0.9510; val_best_f1_score: 0.9600; train_kl_reg_loss: 6773.1763; train_edge_recon_loss: 209457.2701; train_cat_covariates_contrastive_loss: 134.4203; train_gene_expr_recon_loss: 160992.4333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 377357.2998; train_optim_loss: 377357.2998; val_kl_reg_loss: 6878.2174; val_edge_recon_loss: 212881.9964; val_cat_covariates_contrastive_loss: 132.5216; val_gene_expr_recon_loss: 161489.6664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 381382.4005; val_optim_loss: 381382.4005
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9845; val_auprc_score: 0.9866; val_best_acc_score: 0.9542; val_best_f1_score: 0.9624; train_kl_reg_loss: 6826.6687; train_edge_recon_loss: 209313.9159; train_cat_covariates_contrastive_loss: 134.1159; train_gene_expr_recon_loss: 159495.3537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 375770.0540; train_optim_loss: 375770.0540; val_kl_reg_loss: 6847.3835; val_edge_recon_loss: 212517.9576; val_cat_covariates_contrastive_loss: 133.4179; val_gene_expr_recon_loss: 160548.0940; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 380046.8531; val_optim_loss: 380046.8531
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9828; val_auprc_score: 0.9854; val_best_acc_score: 0.9516; val_best_f1_score: 0.9604; train_kl_reg_loss: 6862.4116; train_edge_recon_loss: 209722.6860; train_cat_covariates_contrastive_loss: 134.8777; train_gene_expr_recon_loss: 158324.2573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 375044.2322; train_optim_loss: 375044.2322; val_kl_reg_loss: 6876.0248; val_edge_recon_loss: 213375.0727; val_cat_covariates_contrastive_loss: 132.7655; val_gene_expr_recon_loss: 159270.5617; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 379654.4266; val_optim_loss: 379654.4266
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9843; val_auprc_score: 0.9864; val_best_acc_score: 0.9549; val_best_f1_score: 0.9632; train_kl_reg_loss: 6896.4787; train_edge_recon_loss: 209193.2806; train_cat_covariates_contrastive_loss: 135.2520; train_gene_expr_recon_loss: 157453.1420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 373678.1531; train_optim_loss: 373678.1531; val_kl_reg_loss: 6879.1515; val_edge_recon_loss: 211667.1909; val_cat_covariates_contrastive_loss: 133.1610; val_gene_expr_recon_loss: 157678.9807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376358.4833; val_optim_loss: 376358.4833
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9847; val_auprc_score: 0.9871; val_best_acc_score: 0.9554; val_best_f1_score: 0.9635; train_kl_reg_loss: 6902.1914; train_edge_recon_loss: 208993.0584; train_cat_covariates_contrastive_loss: 135.3413; train_gene_expr_recon_loss: 156437.1587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 372467.7506; train_optim_loss: 372467.7506; val_kl_reg_loss: 6923.9931; val_edge_recon_loss: 211265.4076; val_cat_covariates_contrastive_loss: 134.2087; val_gene_expr_recon_loss: 157780.2065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 376103.8182; val_optim_loss: 376103.8182
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9845; val_auprc_score: 0.9865; val_best_acc_score: 0.9565; val_best_f1_score: 0.9643; train_kl_reg_loss: 6929.4825; train_edge_recon_loss: 208961.7339; train_cat_covariates_contrastive_loss: 135.5563; train_gene_expr_recon_loss: 155747.6591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 371774.4323; train_optim_loss: 371774.4323; val_kl_reg_loss: 6995.1058; val_edge_recon_loss: 211351.3740; val_cat_covariates_contrastive_loss: 135.3253; val_gene_expr_recon_loss: 157325.7341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375807.5370; val_optim_loss: 375807.5370
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9849; val_auprc_score: 0.9865; val_best_acc_score: 0.9562; val_best_f1_score: 0.9642; train_kl_reg_loss: 6952.1978; train_edge_recon_loss: 208840.8082; train_cat_covariates_contrastive_loss: 135.6120; train_gene_expr_recon_loss: 155057.7149; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370986.3328; train_optim_loss: 370986.3328; val_kl_reg_loss: 6840.6728; val_edge_recon_loss: 212050.9380; val_cat_covariates_contrastive_loss: 135.1510; val_gene_expr_recon_loss: 156265.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375292.1755; val_optim_loss: 375292.1755
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9857; val_auprc_score: 0.9876; val_best_acc_score: 0.9572; val_best_f1_score: 0.9649; train_kl_reg_loss: 6953.2897; train_edge_recon_loss: 209037.0151; train_cat_covariates_contrastive_loss: 137.4949; train_gene_expr_recon_loss: 154578.2869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 370706.0866; train_optim_loss: 370706.0866; val_kl_reg_loss: 6887.8122; val_edge_recon_loss: 212368.1471; val_cat_covariates_contrastive_loss: 135.5386; val_gene_expr_recon_loss: 155641.6242; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 375033.1219; val_optim_loss: 375033.1219
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9847; val_auprc_score: 0.9862; val_best_acc_score: 0.9570; val_best_f1_score: 0.9648; train_kl_reg_loss: 6977.4471; train_edge_recon_loss: 208760.4380; train_cat_covariates_contrastive_loss: 136.3319; train_gene_expr_recon_loss: 153911.4656; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369785.6819; train_optim_loss: 369785.6819; val_kl_reg_loss: 7075.3988; val_edge_recon_loss: 211552.9076; val_cat_covariates_contrastive_loss: 133.6353; val_gene_expr_recon_loss: 155713.1630; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374475.1047; val_optim_loss: 374475.1047
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9851; val_auprc_score: 0.9867; val_best_acc_score: 0.9575; val_best_f1_score: 0.9651; train_kl_reg_loss: 6983.4102; train_edge_recon_loss: 208965.1084; train_cat_covariates_contrastive_loss: 135.9816; train_gene_expr_recon_loss: 153517.6159; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369602.1162; train_optim_loss: 369602.1162; val_kl_reg_loss: 7035.4140; val_edge_recon_loss: 211505.4773; val_cat_covariates_contrastive_loss: 135.0516; val_gene_expr_recon_loss: 155783.5375; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 374459.4766; val_optim_loss: 374459.4766
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9863; val_auprc_score: 0.9878; val_best_acc_score: 0.9572; val_best_f1_score: 0.9648; train_kl_reg_loss: 7004.7876; train_edge_recon_loss: 208903.7578; train_cat_covariates_contrastive_loss: 135.5318; train_gene_expr_recon_loss: 153302.9397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 369347.0170; train_optim_loss: 369347.0170; val_kl_reg_loss: 7033.9399; val_edge_recon_loss: 211610.6781; val_cat_covariates_contrastive_loss: 134.3108; val_gene_expr_recon_loss: 155079.2268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373858.1552; val_optim_loss: 373858.1552
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9858; val_auprc_score: 0.9873; val_best_acc_score: 0.9603; val_best_f1_score: 0.9674; train_kl_reg_loss: 7008.0547; train_edge_recon_loss: 208989.8366; train_cat_covariates_contrastive_loss: 136.0414; train_gene_expr_recon_loss: 152780.4691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368914.4025; train_optim_loss: 368914.4025; val_kl_reg_loss: 6879.5866; val_edge_recon_loss: 212088.6036; val_cat_covariates_contrastive_loss: 135.2493; val_gene_expr_recon_loss: 154413.5169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373516.9562; val_optim_loss: 373516.9562
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9859; val_auprc_score: 0.9877; val_best_acc_score: 0.9593; val_best_f1_score: 0.9666; train_kl_reg_loss: 7010.7772; train_edge_recon_loss: 208723.3551; train_cat_covariates_contrastive_loss: 136.0137; train_gene_expr_recon_loss: 152383.3853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368253.5318; train_optim_loss: 368253.5318; val_kl_reg_loss: 7006.8658; val_edge_recon_loss: 211463.0888; val_cat_covariates_contrastive_loss: 136.4677; val_gene_expr_recon_loss: 154431.1784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373037.6021; val_optim_loss: 373037.6021
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9865; val_auprc_score: 0.9885; val_best_acc_score: 0.9595; val_best_f1_score: 0.9668; train_kl_reg_loss: 7013.3691; train_edge_recon_loss: 208787.6196; train_cat_covariates_contrastive_loss: 136.1370; train_gene_expr_recon_loss: 152419.8874; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 368357.0130; train_optim_loss: 368357.0130; val_kl_reg_loss: 7183.4639; val_edge_recon_loss: 211286.3393; val_cat_covariates_contrastive_loss: 134.4071; val_gene_expr_recon_loss: 154638.4945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373242.7042; val_optim_loss: 373242.7042
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9869; val_auprc_score: 0.9888; val_best_acc_score: 0.9603; val_best_f1_score: 0.9674; train_kl_reg_loss: 7027.6522; train_edge_recon_loss: 208901.8682; train_cat_covariates_contrastive_loss: 136.9321; train_gene_expr_recon_loss: 151895.7282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367962.1808; train_optim_loss: 367962.1808; val_kl_reg_loss: 7133.5196; val_edge_recon_loss: 211456.9419; val_cat_covariates_contrastive_loss: 134.7562; val_gene_expr_recon_loss: 153963.4268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372688.6474; val_optim_loss: 372688.6474
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9866; val_auprc_score: 0.9880; val_best_acc_score: 0.9605; val_best_f1_score: 0.9676; train_kl_reg_loss: 7037.1048; train_edge_recon_loss: 208929.5865; train_cat_covariates_contrastive_loss: 135.5878; train_gene_expr_recon_loss: 151711.0674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367813.3469; train_optim_loss: 367813.3469; val_kl_reg_loss: 7060.6854; val_edge_recon_loss: 211292.9542; val_cat_covariates_contrastive_loss: 131.6138; val_gene_expr_recon_loss: 154677.7747; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 373163.0286; val_optim_loss: 373163.0286
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9870; val_auprc_score: 0.9889; val_best_acc_score: 0.9607; val_best_f1_score: 0.9678; train_kl_reg_loss: 7035.1141; train_edge_recon_loss: 208708.4901; train_cat_covariates_contrastive_loss: 135.6147; train_gene_expr_recon_loss: 151560.2203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367439.4388; train_optim_loss: 367439.4388; val_kl_reg_loss: 7039.1697; val_edge_recon_loss: 211535.0133; val_cat_covariates_contrastive_loss: 134.2717; val_gene_expr_recon_loss: 153291.9576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 372000.4115; val_optim_loss: 372000.4115
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9867; val_auprc_score: 0.9885; val_best_acc_score: 0.9609; val_best_f1_score: 0.9679; train_kl_reg_loss: 7044.1099; train_edge_recon_loss: 208715.9707; train_cat_covariates_contrastive_loss: 135.4661; train_gene_expr_recon_loss: 151268.3833; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367163.9297; train_optim_loss: 367163.9297; val_kl_reg_loss: 7044.5931; val_edge_recon_loss: 211723.5781; val_cat_covariates_contrastive_loss: 133.9613; val_gene_expr_recon_loss: 153001.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371903.7661; val_optim_loss: 371903.7661
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9877; val_auprc_score: 0.9895; val_best_acc_score: 0.9629; val_best_f1_score: 0.9695; train_kl_reg_loss: 7029.4192; train_edge_recon_loss: 208999.5486; train_cat_covariates_contrastive_loss: 135.3203; train_gene_expr_recon_loss: 151088.1996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367252.4878; train_optim_loss: 367252.4878; val_kl_reg_loss: 7023.0212; val_edge_recon_loss: 210886.1552; val_cat_covariates_contrastive_loss: 132.6525; val_gene_expr_recon_loss: 153731.9497; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371773.7792; val_optim_loss: 371773.7792
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9862; val_auprc_score: 0.9876; val_best_acc_score: 0.9615; val_best_f1_score: 0.9684; train_kl_reg_loss: 7056.2008; train_edge_recon_loss: 208512.6948; train_cat_covariates_contrastive_loss: 135.8251; train_gene_expr_recon_loss: 151398.1163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 367102.8369; train_optim_loss: 367102.8369; val_kl_reg_loss: 7134.7456; val_edge_recon_loss: 210818.9185; val_cat_covariates_contrastive_loss: 135.5307; val_gene_expr_recon_loss: 153717.6141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371806.8109; val_optim_loss: 371806.8109
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9868; val_auprc_score: 0.9882; val_best_acc_score: 0.9613; val_best_f1_score: 0.9683; train_kl_reg_loss: 7054.2823; train_edge_recon_loss: 208654.3319; train_cat_covariates_contrastive_loss: 135.7298; train_gene_expr_recon_loss: 150625.8715; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 366470.2151; train_optim_loss: 366470.2151; val_kl_reg_loss: 7098.8647; val_edge_recon_loss: 210988.7852; val_cat_covariates_contrastive_loss: 134.1390; val_gene_expr_recon_loss: 152458.8109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370680.5969; val_optim_loss: 370680.5969
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9867; val_auprc_score: 0.9882; val_best_acc_score: 0.9615; val_best_f1_score: 0.9682; train_kl_reg_loss: 7055.2899; train_edge_recon_loss: 208219.2580; train_cat_covariates_contrastive_loss: 136.1328; train_gene_expr_recon_loss: 150410.8775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365821.5578; train_optim_loss: 365821.5578; val_kl_reg_loss: 7164.3116; val_edge_recon_loss: 212001.0148; val_cat_covariates_contrastive_loss: 133.8916; val_gene_expr_recon_loss: 152576.5620; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371875.7807; val_optim_loss: 371875.7807
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9869; val_auprc_score: 0.9879; val_best_acc_score: 0.9618; val_best_f1_score: 0.9686; train_kl_reg_loss: 7060.3931; train_edge_recon_loss: 208477.9165; train_cat_covariates_contrastive_loss: 134.6628; train_gene_expr_recon_loss: 150371.2021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 366044.1750; train_optim_loss: 366044.1750; val_kl_reg_loss: 7087.3079; val_edge_recon_loss: 211400.9969; val_cat_covariates_contrastive_loss: 132.8305; val_gene_expr_recon_loss: 152838.8203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371459.9568; val_optim_loss: 371459.9568
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9864; val_auprc_score: 0.9875; val_best_acc_score: 0.9625; val_best_f1_score: 0.9691; train_kl_reg_loss: 7058.9369; train_edge_recon_loss: 208371.7115; train_cat_covariates_contrastive_loss: 135.9743; train_gene_expr_recon_loss: 150262.0781; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365828.7006; train_optim_loss: 365828.7006; val_kl_reg_loss: 6950.9699; val_edge_recon_loss: 211028.1753; val_cat_covariates_contrastive_loss: 136.3504; val_gene_expr_recon_loss: 152682.7044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 370798.1979; val_optim_loss: 370798.1979
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9875; val_auprc_score: 0.9890; val_best_acc_score: 0.9635; val_best_f1_score: 0.9699; train_kl_reg_loss: 7058.0226; train_edge_recon_loss: 208770.7373; train_cat_covariates_contrastive_loss: 134.6901; train_gene_expr_recon_loss: 150026.4378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 365989.8881; train_optim_loss: 365989.8881; val_kl_reg_loss: 7056.6927; val_edge_recon_loss: 211591.6326; val_cat_covariates_contrastive_loss: 135.1160; val_gene_expr_recon_loss: 152303.5945; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 371087.0370; val_optim_loss: 371087.0370

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9874; val_auprc_score: 0.9883; val_best_acc_score: 0.9627; val_best_f1_score: 0.9691; train_kl_reg_loss: 6981.1067; train_edge_recon_loss: 208194.9222; train_cat_covariates_contrastive_loss: 135.6826; train_gene_expr_recon_loss: 148516.6423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363828.3540; train_optim_loss: 363828.3540; val_kl_reg_loss: 6991.4542; val_edge_recon_loss: 211781.9708; val_cat_covariates_contrastive_loss: 134.1742; val_gene_expr_recon_loss: 151064.2245; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369971.8224; val_optim_loss: 369971.8224
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9878; val_auprc_score: 0.9890; val_best_acc_score: 0.9633; val_best_f1_score: 0.9697; train_kl_reg_loss: 6970.7573; train_edge_recon_loss: 208127.0564; train_cat_covariates_contrastive_loss: 135.5901; train_gene_expr_recon_loss: 148278.7376; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363512.1418; train_optim_loss: 363512.1418; val_kl_reg_loss: 6976.1361; val_edge_recon_loss: 210670.3365; val_cat_covariates_contrastive_loss: 133.6636; val_gene_expr_recon_loss: 151184.6448; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368964.7797; val_optim_loss: 368964.7797
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9884; val_auprc_score: 0.9894; val_best_acc_score: 0.9647; val_best_f1_score: 0.9711; train_kl_reg_loss: 6972.7273; train_edge_recon_loss: 208043.5560; train_cat_covariates_contrastive_loss: 136.2402; train_gene_expr_recon_loss: 148217.2214; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363369.7451; train_optim_loss: 363369.7451; val_kl_reg_loss: 6989.2325; val_edge_recon_loss: 209905.3010; val_cat_covariates_contrastive_loss: 136.5127; val_gene_expr_recon_loss: 151564.5279; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368595.5755; val_optim_loss: 368595.5755
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9883; val_auprc_score: 0.9892; val_best_acc_score: 0.9644; val_best_f1_score: 0.9706; train_kl_reg_loss: 6960.1468; train_edge_recon_loss: 208166.1345; train_cat_covariates_contrastive_loss: 136.1111; train_gene_expr_recon_loss: 148091.9625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363354.3550; train_optim_loss: 363354.3550; val_kl_reg_loss: 7006.6712; val_edge_recon_loss: 210029.2529; val_cat_covariates_contrastive_loss: 134.5309; val_gene_expr_recon_loss: 151291.9365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368462.3901; val_optim_loss: 368462.3901
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9879; val_auprc_score: 0.9891; val_best_acc_score: 0.9640; val_best_f1_score: 0.9705; train_kl_reg_loss: 6955.1524; train_edge_recon_loss: 207953.8800; train_cat_covariates_contrastive_loss: 135.4638; train_gene_expr_recon_loss: 147971.0037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363015.4999; train_optim_loss: 363015.4999; val_kl_reg_loss: 6986.0252; val_edge_recon_loss: 210081.3133; val_cat_covariates_contrastive_loss: 133.3163; val_gene_expr_recon_loss: 150893.3414; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368093.9938; val_optim_loss: 368093.9938
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9891; val_auprc_score: 0.9902; val_best_acc_score: 0.9649; val_best_f1_score: 0.9712; train_kl_reg_loss: 6947.2734; train_edge_recon_loss: 208294.2932; train_cat_covariates_contrastive_loss: 135.7064; train_gene_expr_recon_loss: 148044.9721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 363422.2458; train_optim_loss: 363422.2458; val_kl_reg_loss: 6942.5470; val_edge_recon_loss: 210000.8208; val_cat_covariates_contrastive_loss: 134.3887; val_gene_expr_recon_loss: 151322.7609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368400.5172; val_optim_loss: 368400.5172
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9879; val_auprc_score: 0.9890; val_best_acc_score: 0.9643; val_best_f1_score: 0.9708; train_kl_reg_loss: 6951.6468; train_edge_recon_loss: 207803.9481; train_cat_covariates_contrastive_loss: 135.5751; train_gene_expr_recon_loss: 147883.8098; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362774.9797; train_optim_loss: 362774.9797; val_kl_reg_loss: 6986.0985; val_edge_recon_loss: 209948.5453; val_cat_covariates_contrastive_loss: 134.5717; val_gene_expr_recon_loss: 151045.3943; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368114.6068; val_optim_loss: 368114.6068
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9884; val_auprc_score: 0.9897; val_best_acc_score: 0.9646; val_best_f1_score: 0.9709; train_kl_reg_loss: 6947.0185; train_edge_recon_loss: 207511.0607; train_cat_covariates_contrastive_loss: 136.0663; train_gene_expr_recon_loss: 147860.3868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362454.5312; train_optim_loss: 362454.5312; val_kl_reg_loss: 6989.9320; val_edge_recon_loss: 210040.0245; val_cat_covariates_contrastive_loss: 134.4582; val_gene_expr_recon_loss: 150902.3068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368066.7203; val_optim_loss: 368066.7203
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9887; val_auprc_score: 0.9901; val_best_acc_score: 0.9644; val_best_f1_score: 0.9707; train_kl_reg_loss: 6945.6122; train_edge_recon_loss: 207899.1709; train_cat_covariates_contrastive_loss: 135.5101; train_gene_expr_recon_loss: 147794.9560; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362775.2485; train_optim_loss: 362775.2485; val_kl_reg_loss: 6962.0307; val_edge_recon_loss: 210762.6862; val_cat_covariates_contrastive_loss: 134.7773; val_gene_expr_recon_loss: 151034.5122; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368894.0068; val_optim_loss: 368894.0068
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9891; val_auprc_score: 0.9902; val_best_acc_score: 0.9652; val_best_f1_score: 0.9714; train_kl_reg_loss: 6949.3576; train_edge_recon_loss: 207967.3788; train_cat_covariates_contrastive_loss: 135.7896; train_gene_expr_recon_loss: 147864.8399; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362917.3658; train_optim_loss: 362917.3658; val_kl_reg_loss: 6995.1593; val_edge_recon_loss: 210459.7607; val_cat_covariates_contrastive_loss: 134.4707; val_gene_expr_recon_loss: 150478.6341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368068.0240; val_optim_loss: 368068.0240
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9887; val_auprc_score: 0.9899; val_best_acc_score: 0.9645; val_best_f1_score: 0.9708; train_kl_reg_loss: 6939.9948; train_edge_recon_loss: 207575.4098; train_cat_covariates_contrastive_loss: 136.0645; train_gene_expr_recon_loss: 147782.5470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362434.0165; train_optim_loss: 362434.0165; val_kl_reg_loss: 6969.2989; val_edge_recon_loss: 210005.8078; val_cat_covariates_contrastive_loss: 134.3114; val_gene_expr_recon_loss: 150793.3594; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367902.7797; val_optim_loss: 367902.7797
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9883; val_auprc_score: 0.9894; val_best_acc_score: 0.9648; val_best_f1_score: 0.9710; train_kl_reg_loss: 6934.7719; train_edge_recon_loss: 207923.9288; train_cat_covariates_contrastive_loss: 135.5935; train_gene_expr_recon_loss: 147725.4859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362719.7792; train_optim_loss: 362719.7792; val_kl_reg_loss: 6957.0017; val_edge_recon_loss: 210473.1484; val_cat_covariates_contrastive_loss: 133.9636; val_gene_expr_recon_loss: 150600.8521; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368164.9646; val_optim_loss: 368164.9646
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9885; val_auprc_score: 0.9893; val_best_acc_score: 0.9649; val_best_f1_score: 0.9711; train_kl_reg_loss: 6937.7732; train_edge_recon_loss: 207924.3471; train_cat_covariates_contrastive_loss: 136.1035; train_gene_expr_recon_loss: 147831.7426; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362829.9669; train_optim_loss: 362829.9669; val_kl_reg_loss: 6968.8809; val_edge_recon_loss: 211169.6677; val_cat_covariates_contrastive_loss: 133.6098; val_gene_expr_recon_loss: 150937.7464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 369209.9073; val_optim_loss: 369209.9073
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9895; val_auprc_score: 0.9904; val_best_acc_score: 0.9661; val_best_f1_score: 0.9720; train_kl_reg_loss: 6931.7652; train_edge_recon_loss: 207895.9430; train_cat_covariates_contrastive_loss: 135.3631; train_gene_expr_recon_loss: 147641.0298; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362604.1015; train_optim_loss: 362604.1015; val_kl_reg_loss: 6957.5648; val_edge_recon_loss: 210366.9047; val_cat_covariates_contrastive_loss: 134.4134; val_gene_expr_recon_loss: 150969.2367; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368428.1188; val_optim_loss: 368428.1188
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9885; val_auprc_score: 0.9896; val_best_acc_score: 0.9638; val_best_f1_score: 0.9703; train_kl_reg_loss: 6938.9462; train_edge_recon_loss: 207770.7106; train_cat_covariates_contrastive_loss: 136.0387; train_gene_expr_recon_loss: 147718.7545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362564.4509; train_optim_loss: 362564.4509; val_kl_reg_loss: 6942.7176; val_edge_recon_loss: 210675.4174; val_cat_covariates_contrastive_loss: 135.8772; val_gene_expr_recon_loss: 151050.0573; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368804.0698; val_optim_loss: 368804.0698

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9886; val_auprc_score: 0.9899; val_best_acc_score: 0.9647; val_best_f1_score: 0.9710; train_kl_reg_loss: 6927.8526; train_edge_recon_loss: 207831.9225; train_cat_covariates_contrastive_loss: 136.0617; train_gene_expr_recon_loss: 147570.7170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362466.5535; train_optim_loss: 362466.5535; val_kl_reg_loss: 6952.2520; val_edge_recon_loss: 210544.0656; val_cat_covariates_contrastive_loss: 134.8944; val_gene_expr_recon_loss: 151016.9169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368648.1297; val_optim_loss: 368648.1297
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9886; val_auprc_score: 0.9896; val_best_acc_score: 0.9655; val_best_f1_score: 0.9716; train_kl_reg_loss: 6925.9910; train_edge_recon_loss: 207840.2945; train_cat_covariates_contrastive_loss: 135.6637; train_gene_expr_recon_loss: 147523.4848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362425.4338; train_optim_loss: 362425.4338; val_kl_reg_loss: 6944.3575; val_edge_recon_loss: 209200.6927; val_cat_covariates_contrastive_loss: 135.4256; val_gene_expr_recon_loss: 150604.2794; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 366884.7562; val_optim_loss: 366884.7562
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9889; val_auprc_score: 0.9902; val_best_acc_score: 0.9651; val_best_f1_score: 0.9713; train_kl_reg_loss: 6919.8807; train_edge_recon_loss: 207634.1924; train_cat_covariates_contrastive_loss: 135.7996; train_gene_expr_recon_loss: 147534.7538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362224.6269; train_optim_loss: 362224.6269; val_kl_reg_loss: 6942.8074; val_edge_recon_loss: 209609.3398; val_cat_covariates_contrastive_loss: 135.4267; val_gene_expr_recon_loss: 150367.3406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367054.9146; val_optim_loss: 367054.9146
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9895; val_auprc_score: 0.9906; val_best_acc_score: 0.9672; val_best_f1_score: 0.9730; train_kl_reg_loss: 6914.3226; train_edge_recon_loss: 207844.3753; train_cat_covariates_contrastive_loss: 135.5587; train_gene_expr_recon_loss: 147327.5919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362221.8496; train_optim_loss: 362221.8496; val_kl_reg_loss: 6944.2117; val_edge_recon_loss: 209784.6367; val_cat_covariates_contrastive_loss: 134.2450; val_gene_expr_recon_loss: 150758.8544; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367621.9500; val_optim_loss: 367621.9500
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9891; val_auprc_score: 0.9904; val_best_acc_score: 0.9647; val_best_f1_score: 0.9709; train_kl_reg_loss: 6919.3039; train_edge_recon_loss: 208131.8832; train_cat_covariates_contrastive_loss: 136.5128; train_gene_expr_recon_loss: 147429.9270; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362617.6270; train_optim_loss: 362617.6270; val_kl_reg_loss: 6944.2111; val_edge_recon_loss: 210616.7115; val_cat_covariates_contrastive_loss: 133.9293; val_gene_expr_recon_loss: 150540.9823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368235.8323; val_optim_loss: 368235.8323
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9884; val_auprc_score: 0.9895; val_best_acc_score: 0.9650; val_best_f1_score: 0.9711; train_kl_reg_loss: 6918.4590; train_edge_recon_loss: 207878.7591; train_cat_covariates_contrastive_loss: 136.1033; train_gene_expr_recon_loss: 147439.2617; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362372.5832; train_optim_loss: 362372.5832; val_kl_reg_loss: 6936.0917; val_edge_recon_loss: 209996.1914; val_cat_covariates_contrastive_loss: 135.4678; val_gene_expr_recon_loss: 150441.4021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367509.1516; val_optim_loss: 367509.1516

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9883; val_auprc_score: 0.9892; val_best_acc_score: 0.9645; val_best_f1_score: 0.9708; train_kl_reg_loss: 6915.2924; train_edge_recon_loss: 207977.2031; train_cat_covariates_contrastive_loss: 136.0068; train_gene_expr_recon_loss: 147295.7493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362324.2515; train_optim_loss: 362324.2515; val_kl_reg_loss: 6943.8472; val_edge_recon_loss: 210958.7922; val_cat_covariates_contrastive_loss: 135.3722; val_gene_expr_recon_loss: 150763.4500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368801.4646; val_optim_loss: 368801.4646
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9885; val_auprc_score: 0.9897; val_best_acc_score: 0.9646; val_best_f1_score: 0.9709; train_kl_reg_loss: 6918.0130; train_edge_recon_loss: 207584.1639; train_cat_covariates_contrastive_loss: 136.0991; train_gene_expr_recon_loss: 147384.6736; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362022.9488; train_optim_loss: 362022.9488; val_kl_reg_loss: 6944.5263; val_edge_recon_loss: 210750.0674; val_cat_covariates_contrastive_loss: 134.7709; val_gene_expr_recon_loss: 150535.2677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368364.6339; val_optim_loss: 368364.6339
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9886; val_auprc_score: 0.9898; val_best_acc_score: 0.9650; val_best_f1_score: 0.9712; train_kl_reg_loss: 6917.2593; train_edge_recon_loss: 207785.3596; train_cat_covariates_contrastive_loss: 135.6371; train_gene_expr_recon_loss: 147350.5901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362188.8456; train_optim_loss: 362188.8456; val_kl_reg_loss: 6941.6392; val_edge_recon_loss: 210762.5909; val_cat_covariates_contrastive_loss: 135.0303; val_gene_expr_recon_loss: 150925.8786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 368765.1365; val_optim_loss: 368765.1365
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9888; val_auprc_score: 0.9895; val_best_acc_score: 0.9667; val_best_f1_score: 0.9726; train_kl_reg_loss: 6916.3039; train_edge_recon_loss: 208087.4513; train_cat_covariates_contrastive_loss: 135.3506; train_gene_expr_recon_loss: 147340.9955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 362480.1011; train_optim_loss: 362480.1011; val_kl_reg_loss: 6943.3974; val_edge_recon_loss: 209459.7982; val_cat_covariates_contrastive_loss: 134.4734; val_gene_expr_recon_loss: 151002.6812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 367540.3490; val_optim_loss: 367540.3490

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 203 min 59 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.9886
val AUPRC score: 0.9897
val best accuracy score: 0.9659
val best F1 score: 0.9719
val target rna MSE score: 0.6724
val source rna MSE score: 0.1636
Val cat covariate0 mean sim diff: 0.0004

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
