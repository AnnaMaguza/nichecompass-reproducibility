[True]
Run timestamp: 07092023_063552_285.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_285']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 1131 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5649, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 1131

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7791; val_auprc_score: 0.7967; val_best_acc_score: 0.5602; val_best_f1_score: 0.6908; train_kl_reg_loss: 99976.8122; train_edge_recon_loss: 3546833.0229; train_gene_expr_recon_loss: 16832036.7634; train_masked_gp_l1_reg_loss: 46127.1642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5545541.7013; train_chrom_access_recon_loss: 6557392.0725; train_global_loss: 32627907.5115; train_optim_loss: 32627907.5115; val_kl_reg_loss: 133377.6109; val_edge_recon_loss: 4061861.0000; val_gene_expr_recon_loss: 15794547.8000; val_masked_gp_l1_reg_loss: 41115.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 393665.0938; val_chrom_access_recon_loss: 6493626.9000; val_global_loss: 26918195.3333; val_optim_loss: 26918195.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8290; val_auprc_score: 0.8358; val_best_acc_score: 0.7489; val_best_f1_score: 0.7451; train_kl_reg_loss: 112520.3532; train_edge_recon_loss: 3526656.6813; train_gene_expr_recon_loss: 15574101.3282; train_masked_gp_l1_reg_loss: 40769.6561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 255831.0307; train_chrom_access_recon_loss: 6320990.4733; train_global_loss: 25830869.6947; train_optim_loss: 25830869.6947; val_kl_reg_loss: 106626.4542; val_edge_recon_loss: 3987367.7000; val_gene_expr_recon_loss: 15481784.6000; val_masked_gp_l1_reg_loss: 42027.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 193603.5469; val_chrom_access_recon_loss: 6389642.2667; val_global_loss: 26201053.0667; val_optim_loss: 26201053.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8781; val_auprc_score: 0.8744; val_best_acc_score: 0.7881; val_best_f1_score: 0.8019; train_kl_reg_loss: 88096.4167; train_edge_recon_loss: 3341152.4695; train_gene_expr_recon_loss: 15354007.6794; train_masked_gp_l1_reg_loss: 44539.2265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 171428.9798; train_chrom_access_recon_loss: 6241360.1718; train_global_loss: 25240584.8092; train_optim_loss: 25240584.8092; val_kl_reg_loss: 93887.7161; val_edge_recon_loss: 3120443.3000; val_gene_expr_recon_loss: 15336717.7333; val_masked_gp_l1_reg_loss: 47226.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 156083.1562; val_chrom_access_recon_loss: 6328444.2667; val_global_loss: 25082803.2000; val_optim_loss: 25082803.2000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8919; val_auprc_score: 0.8811; val_best_acc_score: 0.8067; val_best_f1_score: 0.8229; train_kl_reg_loss: 113350.2803; train_edge_recon_loss: 2989612.9237; train_gene_expr_recon_loss: 15194153.2061; train_masked_gp_l1_reg_loss: 48804.4075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146751.4469; train_chrom_access_recon_loss: 6173543.9580; train_global_loss: 24666216.3969; train_optim_loss: 24666216.3969; val_kl_reg_loss: 111394.2698; val_edge_recon_loss: 2966704.0833; val_gene_expr_recon_loss: 15113680.0000; val_masked_gp_l1_reg_loss: 50612.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140193.9062; val_chrom_access_recon_loss: 6245982.8667; val_global_loss: 24628567.3333; val_optim_loss: 24628567.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9067; val_auprc_score: 0.8946; val_best_acc_score: 0.8244; val_best_f1_score: 0.8389; train_kl_reg_loss: 116860.0591; train_edge_recon_loss: 2874875.8931; train_gene_expr_recon_loss: 15050016.1145; train_masked_gp_l1_reg_loss: 52344.2986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135103.0537; train_chrom_access_recon_loss: 6109660.7710; train_global_loss: 24338860.1832; train_optim_loss: 24338860.1832; val_kl_reg_loss: 119198.5661; val_edge_recon_loss: 2853948.1500; val_gene_expr_recon_loss: 15050921.2667; val_masked_gp_l1_reg_loss: 54013.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131420.2812; val_chrom_access_recon_loss: 6203328.4333; val_global_loss: 24412830.4000; val_optim_loss: 24412830.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9218; val_auprc_score: 0.9080; val_best_acc_score: 0.8453; val_best_f1_score: 0.8518; train_kl_reg_loss: 113069.2797; train_edge_recon_loss: 2869675.2156; train_gene_expr_recon_loss: 14907890.0153; train_masked_gp_l1_reg_loss: 55352.6661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128422.6817; train_chrom_access_recon_loss: 6050745.3969; train_global_loss: 24125155.2214; train_optim_loss: 24125155.2214; val_kl_reg_loss: 114165.9193; val_edge_recon_loss: 2845851.9667; val_gene_expr_recon_loss: 14914097.1333; val_masked_gp_l1_reg_loss: 56557.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125772.4922; val_chrom_access_recon_loss: 6144399.8667; val_global_loss: 24200844.6667; val_optim_loss: 24200844.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9269; val_auprc_score: 0.9109; val_best_acc_score: 0.8599; val_best_f1_score: 0.8658; train_kl_reg_loss: 108610.5993; train_edge_recon_loss: 2834226.2462; train_gene_expr_recon_loss: 14790686.2443; train_masked_gp_l1_reg_loss: 57520.5975; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124538.0063; train_chrom_access_recon_loss: 6003456.2519; train_global_loss: 23919037.8779; train_optim_loss: 23919037.8779; val_kl_reg_loss: 108781.7307; val_edge_recon_loss: 2838609.1167; val_gene_expr_recon_loss: 14765285.0000; val_masked_gp_l1_reg_loss: 58653.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123480.0391; val_chrom_access_recon_loss: 6084047.8000; val_global_loss: 23978857.2000; val_optim_loss: 23978857.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9362; val_auprc_score: 0.9189; val_best_acc_score: 0.8733; val_best_f1_score: 0.8798; train_kl_reg_loss: 104593.5756; train_edge_recon_loss: 2810634.1832; train_gene_expr_recon_loss: 14680190.9771; train_masked_gp_l1_reg_loss: 59635.4942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123227.1725; train_chrom_access_recon_loss: 5957396.4695; train_global_loss: 23735677.7863; train_optim_loss: 23735677.7863; val_kl_reg_loss: 106001.7568; val_edge_recon_loss: 2797046.4000; val_gene_expr_recon_loss: 14735102.4667; val_masked_gp_l1_reg_loss: 60727.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123385.7109; val_chrom_access_recon_loss: 6068005.6667; val_global_loss: 23890270.5333; val_optim_loss: 23890270.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9449; val_auprc_score: 0.9324; val_best_acc_score: 0.8816; val_best_f1_score: 0.8859; train_kl_reg_loss: 104024.6554; train_edge_recon_loss: 2791394.7214; train_gene_expr_recon_loss: 14596032.9313; train_masked_gp_l1_reg_loss: 61535.1365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123523.0137; train_chrom_access_recon_loss: 5919385.0420; train_global_loss: 23595895.5573; train_optim_loss: 23595895.5573; val_kl_reg_loss: 101167.6193; val_edge_recon_loss: 2770128.4000; val_gene_expr_recon_loss: 14657792.4667; val_masked_gp_l1_reg_loss: 62551.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123802.9609; val_chrom_access_recon_loss: 6032850.6667; val_global_loss: 23748293.2000; val_optim_loss: 23748293.2000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9463; val_auprc_score: 0.9354; val_best_acc_score: 0.8810; val_best_f1_score: 0.8871; train_kl_reg_loss: 105084.9155; train_edge_recon_loss: 2772395.3683; train_gene_expr_recon_loss: 14508221.8244; train_masked_gp_l1_reg_loss: 63219.5933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124269.3321; train_chrom_access_recon_loss: 5880103.9466; train_global_loss: 23453294.9618; train_optim_loss: 23453294.9618; val_kl_reg_loss: 106358.1328; val_edge_recon_loss: 2780191.5000; val_gene_expr_recon_loss: 14652732.9333; val_masked_gp_l1_reg_loss: 63991.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124642.9453; val_chrom_access_recon_loss: 6034711.7667; val_global_loss: 23762628.5333; val_optim_loss: 23762628.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9460; val_auprc_score: 0.9317; val_best_acc_score: 0.8856; val_best_f1_score: 0.8912; train_kl_reg_loss: 101426.3690; train_edge_recon_loss: 2761834.1947; train_gene_expr_recon_loss: 14435132.4885; train_masked_gp_l1_reg_loss: 64721.5189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125367.2805; train_chrom_access_recon_loss: 5854580.6374; train_global_loss: 23343062.3817; train_optim_loss: 23343062.3817; val_kl_reg_loss: 103613.7583; val_edge_recon_loss: 2771714.7833; val_gene_expr_recon_loss: 14426978.9333; val_masked_gp_l1_reg_loss: 65527.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125206.8203; val_chrom_access_recon_loss: 5969921.0000; val_global_loss: 23462962.5333; val_optim_loss: 23462962.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9518; val_auprc_score: 0.9405; val_best_acc_score: 0.8971; val_best_f1_score: 0.9022; train_kl_reg_loss: 101046.0732; train_edge_recon_loss: 2756677.8721; train_gene_expr_recon_loss: 14356175.9008; train_masked_gp_l1_reg_loss: 66150.5266; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125747.0987; train_chrom_access_recon_loss: 5817835.0458; train_global_loss: 23223632.7481; train_optim_loss: 23223632.7481; val_kl_reg_loss: 99495.1427; val_edge_recon_loss: 2752723.1000; val_gene_expr_recon_loss: 14443320.6000; val_masked_gp_l1_reg_loss: 66839.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126945.4688; val_chrom_access_recon_loss: 5955000.1667; val_global_loss: 23444324.9333; val_optim_loss: 23444324.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9540; val_auprc_score: 0.9454; val_best_acc_score: 0.8949; val_best_f1_score: 0.8982; train_kl_reg_loss: 100126.5543; train_edge_recon_loss: 2746346.1183; train_gene_expr_recon_loss: 14302849.7176; train_masked_gp_l1_reg_loss: 67437.9151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127061.7570; train_chrom_access_recon_loss: 5792722.0076; train_global_loss: 23136543.9237; train_optim_loss: 23136543.9237; val_kl_reg_loss: 103491.8828; val_edge_recon_loss: 2746055.5000; val_gene_expr_recon_loss: 14337631.2667; val_masked_gp_l1_reg_loss: 67970.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127237.5625; val_chrom_access_recon_loss: 5906214.5000; val_global_loss: 23288601.4667; val_optim_loss: 23288601.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9486; val_auprc_score: 0.9338; val_best_acc_score: 0.8932; val_best_f1_score: 0.8980; train_kl_reg_loss: 97546.1518; train_edge_recon_loss: 2751645.8855; train_gene_expr_recon_loss: 14245097.9618; train_masked_gp_l1_reg_loss: 68620.9820; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128438.8890; train_chrom_access_recon_loss: 5772038.4962; train_global_loss: 23063388.2290; train_optim_loss: 23063388.2290; val_kl_reg_loss: 96308.7401; val_edge_recon_loss: 2766083.5333; val_gene_expr_recon_loss: 14299832.2667; val_masked_gp_l1_reg_loss: 69220.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130108.1250; val_chrom_access_recon_loss: 5872216.3333; val_global_loss: 23233769.0667; val_optim_loss: 23233769.0667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9565; val_auprc_score: 0.9451; val_best_acc_score: 0.8949; val_best_f1_score: 0.8997; train_kl_reg_loss: 96094.1692; train_edge_recon_loss: 2740579.8683; train_gene_expr_recon_loss: 14174251.0229; train_masked_gp_l1_reg_loss: 69770.5431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129985.2351; train_chrom_access_recon_loss: 5740042.5992; train_global_loss: 22950723.2824; train_optim_loss: 22950723.2824; val_kl_reg_loss: 98172.0292; val_edge_recon_loss: 2749923.3000; val_gene_expr_recon_loss: 14241491.7333; val_masked_gp_l1_reg_loss: 70218.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129592.1328; val_chrom_access_recon_loss: 5876612.0333; val_global_loss: 23166009.2000; val_optim_loss: 23166009.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9581; val_auprc_score: 0.9482; val_best_acc_score: 0.8992; val_best_f1_score: 0.9025; train_kl_reg_loss: 96177.3608; train_edge_recon_loss: 2730891.2099; train_gene_expr_recon_loss: 14129789.1908; train_masked_gp_l1_reg_loss: 70707.5740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130400.4030; train_chrom_access_recon_loss: 5723305.9008; train_global_loss: 22881271.5878; train_optim_loss: 22881271.5878; val_kl_reg_loss: 91604.6089; val_edge_recon_loss: 2769035.8167; val_gene_expr_recon_loss: 14176017.1333; val_masked_gp_l1_reg_loss: 71138.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131067.4609; val_chrom_access_recon_loss: 5848042.3333; val_global_loss: 23086905.8667; val_optim_loss: 23086905.8667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9636; val_auprc_score: 0.9528; val_best_acc_score: 0.9085; val_best_f1_score: 0.9116; train_kl_reg_loss: 94174.5833; train_edge_recon_loss: 2726066.8473; train_gene_expr_recon_loss: 14090071.8550; train_masked_gp_l1_reg_loss: 71672.3018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130918.5638; train_chrom_access_recon_loss: 5706855.0687; train_global_loss: 22819759.2214; train_optim_loss: 22819759.2214; val_kl_reg_loss: 92565.7510; val_edge_recon_loss: 2742551.1333; val_gene_expr_recon_loss: 14107927.4667; val_masked_gp_l1_reg_loss: 72131.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130614.9609; val_chrom_access_recon_loss: 5822356.2667; val_global_loss: 22968146.8000; val_optim_loss: 22968146.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9627; val_auprc_score: 0.9529; val_best_acc_score: 0.9068; val_best_f1_score: 0.9091; train_kl_reg_loss: 94196.7969; train_edge_recon_loss: 2724262.6431; train_gene_expr_recon_loss: 14061999.8779; train_masked_gp_l1_reg_loss: 72495.4998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130495.1270; train_chrom_access_recon_loss: 5688582.7290; train_global_loss: 22772032.7481; train_optim_loss: 22772032.7481; val_kl_reg_loss: 91079.0771; val_edge_recon_loss: 2743072.3333; val_gene_expr_recon_loss: 14167362.2000; val_masked_gp_l1_reg_loss: 72861.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130932.0703; val_chrom_access_recon_loss: 5811318.1333; val_global_loss: 23016625.7333; val_optim_loss: 23016625.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9628; val_auprc_score: 0.9529; val_best_acc_score: 0.9085; val_best_f1_score: 0.9115; train_kl_reg_loss: 92405.1944; train_edge_recon_loss: 2723966.2557; train_gene_expr_recon_loss: 14021383.7939; train_masked_gp_l1_reg_loss: 73246.4518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130961.6201; train_chrom_access_recon_loss: 5672773.5916; train_global_loss: 22714736.9618; train_optim_loss: 22714736.9618; val_kl_reg_loss: 96021.0151; val_edge_recon_loss: 2732776.2167; val_gene_expr_recon_loss: 14104290.7333; val_masked_gp_l1_reg_loss: 73732.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131231.1719; val_chrom_access_recon_loss: 5788509.6667; val_global_loss: 22926561.0667; val_optim_loss: 22926561.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9679; val_auprc_score: 0.9596; val_best_acc_score: 0.9147; val_best_f1_score: 0.9184; train_kl_reg_loss: 92338.6573; train_edge_recon_loss: 2726946.2882; train_gene_expr_recon_loss: 13981667.7634; train_masked_gp_l1_reg_loss: 74013.1458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130816.6278; train_chrom_access_recon_loss: 5653813.3321; train_global_loss: 22659595.9237; train_optim_loss: 22659595.9237; val_kl_reg_loss: 91863.3005; val_edge_recon_loss: 2727561.1000; val_gene_expr_recon_loss: 14087413.2000; val_masked_gp_l1_reg_loss: 74463.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130446.2734; val_chrom_access_recon_loss: 5787582.1000; val_global_loss: 22899329.7333; val_optim_loss: 22899329.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9656; val_auprc_score: 0.9532; val_best_acc_score: 0.9111; val_best_f1_score: 0.9150; train_kl_reg_loss: 91536.5477; train_edge_recon_loss: 2717398.0000; train_gene_expr_recon_loss: 13948730.4580; train_masked_gp_l1_reg_loss: 74797.9993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130572.3719; train_chrom_access_recon_loss: 5638625.9504; train_global_loss: 22601661.2519; train_optim_loss: 22601661.2519; val_kl_reg_loss: 90409.2484; val_edge_recon_loss: 2745980.5000; val_gene_expr_recon_loss: 14054409.6667; val_masked_gp_l1_reg_loss: 75125.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130618.7109; val_chrom_access_recon_loss: 5796078.0000; val_global_loss: 22892621.4667; val_optim_loss: 22892621.4667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9723; val_auprc_score: 0.9656; val_best_acc_score: 0.9247; val_best_f1_score: 0.9261; train_kl_reg_loss: 90182.1217; train_edge_recon_loss: 2709363.9637; train_gene_expr_recon_loss: 13924094.8550; train_masked_gp_l1_reg_loss: 75514.6263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130581.0700; train_chrom_access_recon_loss: 5622990.9847; train_global_loss: 22552727.6183; train_optim_loss: 22552727.6183; val_kl_reg_loss: 92662.4547; val_edge_recon_loss: 2717205.4667; val_gene_expr_recon_loss: 13989064.5333; val_masked_gp_l1_reg_loss: 76007.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130348.1406; val_chrom_access_recon_loss: 5753079.8667; val_global_loss: 22758367.7333; val_optim_loss: 22758367.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9703; val_auprc_score: 0.9630; val_best_acc_score: 0.9170; val_best_f1_score: 0.9192; train_kl_reg_loss: 90362.4820; train_edge_recon_loss: 2710336.6145; train_gene_expr_recon_loss: 13898511.6718; train_masked_gp_l1_reg_loss: 76317.0042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130752.5820; train_chrom_access_recon_loss: 5610989.6031; train_global_loss: 22517270.0611; train_optim_loss: 22517270.0611; val_kl_reg_loss: 92020.9167; val_edge_recon_loss: 2723400.9833; val_gene_expr_recon_loss: 13984079.0667; val_masked_gp_l1_reg_loss: 76636.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131013.0938; val_chrom_access_recon_loss: 5719903.5667; val_global_loss: 22727054.8000; val_optim_loss: 22727054.8000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9753; val_auprc_score: 0.9695; val_best_acc_score: 0.9250; val_best_f1_score: 0.9273; train_kl_reg_loss: 89871.1990; train_edge_recon_loss: 2708035.0458; train_gene_expr_recon_loss: 13876486.0763; train_masked_gp_l1_reg_loss: 76959.7518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130805.4773; train_chrom_access_recon_loss: 5596166.7710; train_global_loss: 22478324.1679; train_optim_loss: 22478324.1679; val_kl_reg_loss: 89819.4667; val_edge_recon_loss: 2690006.1667; val_gene_expr_recon_loss: 13935433.6000; val_masked_gp_l1_reg_loss: 77399.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131191.5938; val_chrom_access_recon_loss: 5723229.7000; val_global_loss: 22647080.2667; val_optim_loss: 22647080.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9748; val_auprc_score: 0.9672; val_best_acc_score: 0.9260; val_best_f1_score: 0.9282; train_kl_reg_loss: 89718.8482; train_edge_recon_loss: 2700115.4466; train_gene_expr_recon_loss: 13844456.4351; train_masked_gp_l1_reg_loss: 77709.9976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130890.7164; train_chrom_access_recon_loss: 5582265.0954; train_global_loss: 22425156.6412; train_optim_loss: 22425156.6412; val_kl_reg_loss: 89009.2417; val_edge_recon_loss: 2705288.9167; val_gene_expr_recon_loss: 13926322.3333; val_masked_gp_l1_reg_loss: 78026.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130679.4453; val_chrom_access_recon_loss: 5714632.0000; val_global_loss: 22643958.8000; val_optim_loss: 22643958.8000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9731; val_auprc_score: 0.9636; val_best_acc_score: 0.9254; val_best_f1_score: 0.9278; train_kl_reg_loss: 92034.3829; train_edge_recon_loss: 2709262.7672; train_gene_expr_recon_loss: 13638316.7023; train_masked_gp_l1_reg_loss: 76683.2893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128472.9208; train_chrom_access_recon_loss: 5542443.8855; train_global_loss: 22187213.9084; train_optim_loss: 22187213.9084; val_kl_reg_loss: 71164.6849; val_edge_recon_loss: 2725919.1167; val_gene_expr_recon_loss: 13713792.2000; val_masked_gp_l1_reg_loss: 76441.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128995.0547; val_chrom_access_recon_loss: 5651117.0333; val_global_loss: 22367430.5333; val_optim_loss: 22367430.5333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9770; val_auprc_score: 0.9720; val_best_acc_score: 0.9310; val_best_f1_score: 0.9319; train_kl_reg_loss: 89567.9505; train_edge_recon_loss: 2710516.1851; train_gene_expr_recon_loss: 13593574.6641; train_masked_gp_l1_reg_loss: 76521.7981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128909.6527; train_chrom_access_recon_loss: 5519926.0038; train_global_loss: 22119016.3969; train_optim_loss: 22119016.3969; val_kl_reg_loss: 74442.3474; val_edge_recon_loss: 2713085.6333; val_gene_expr_recon_loss: 13687808.5333; val_masked_gp_l1_reg_loss: 76586.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129598.5859; val_chrom_access_recon_loss: 5705505.5000; val_global_loss: 22387027.3333; val_optim_loss: 22387027.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9739; val_auprc_score: 0.9641; val_best_acc_score: 0.9244; val_best_f1_score: 0.9262; train_kl_reg_loss: 87243.0518; train_edge_recon_loss: 2704027.9122; train_gene_expr_recon_loss: 13570226.9389; train_masked_gp_l1_reg_loss: 76639.5666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128864.7307; train_chrom_access_recon_loss: 5509902.5382; train_global_loss: 22076904.6107; train_optim_loss: 22076904.6107; val_kl_reg_loss: 73531.8036; val_edge_recon_loss: 2712255.7333; val_gene_expr_recon_loss: 13632044.3333; val_masked_gp_l1_reg_loss: 76685.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128188.3672; val_chrom_access_recon_loss: 5609566.3000; val_global_loss: 22232272.6667; val_optim_loss: 22232272.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9781; val_auprc_score: 0.9733; val_best_acc_score: 0.9326; val_best_f1_score: 0.9338; train_kl_reg_loss: 85054.6792; train_edge_recon_loss: 2702905.9485; train_gene_expr_recon_loss: 13553583.1145; train_masked_gp_l1_reg_loss: 76732.5067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128348.3059; train_chrom_access_recon_loss: 5503586.8969; train_global_loss: 22050211.4351; train_optim_loss: 22050211.4351; val_kl_reg_loss: 78113.9844; val_edge_recon_loss: 2726868.3000; val_gene_expr_recon_loss: 13674436.3333; val_masked_gp_l1_reg_loss: 76848.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128875.6094; val_chrom_access_recon_loss: 5643749.8000; val_global_loss: 22328892.1333; val_optim_loss: 22328892.1333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9770; val_auprc_score: 0.9693; val_best_acc_score: 0.9317; val_best_f1_score: 0.9337; train_kl_reg_loss: 84480.3667; train_edge_recon_loss: 2696921.2271; train_gene_expr_recon_loss: 13544556.4122; train_masked_gp_l1_reg_loss: 76910.8715; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128174.4797; train_chrom_access_recon_loss: 5502195.6221; train_global_loss: 22033238.8397; train_optim_loss: 22033238.8397; val_kl_reg_loss: 82132.9734; val_edge_recon_loss: 2710512.4833; val_gene_expr_recon_loss: 13642843.7333; val_masked_gp_l1_reg_loss: 76917.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128307.1016; val_chrom_access_recon_loss: 5619918.9333; val_global_loss: 22260633.7333; val_optim_loss: 22260633.7333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9803; val_auprc_score: 0.9766; val_best_acc_score: 0.9351; val_best_f1_score: 0.9364; train_kl_reg_loss: 82965.0132; train_edge_recon_loss: 2697067.1450; train_gene_expr_recon_loss: 13517665.6794; train_masked_gp_l1_reg_loss: 77008.5901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127839.7968; train_chrom_access_recon_loss: 5493797.1031; train_global_loss: 21996343.2977; train_optim_loss: 21996343.2977; val_kl_reg_loss: 80272.4474; val_edge_recon_loss: 2703641.3833; val_gene_expr_recon_loss: 13621148.8667; val_masked_gp_l1_reg_loss: 77056.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126787.4844; val_chrom_access_recon_loss: 5632010.9000; val_global_loss: 22240916.8000; val_optim_loss: 22240916.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9783; val_auprc_score: 0.9733; val_best_acc_score: 0.9325; val_best_f1_score: 0.9348; train_kl_reg_loss: 82399.5858; train_edge_recon_loss: 2698005.9580; train_gene_expr_recon_loss: 13485244.5496; train_masked_gp_l1_reg_loss: 77076.9009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127773.1358; train_chrom_access_recon_loss: 5480942.4351; train_global_loss: 21951442.6412; train_optim_loss: 21951442.6412; val_kl_reg_loss: 77290.6526; val_edge_recon_loss: 2723824.1833; val_gene_expr_recon_loss: 13595592.8667; val_masked_gp_l1_reg_loss: 77202.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127992.2031; val_chrom_access_recon_loss: 5609899.2333; val_global_loss: 22211801.6000; val_optim_loss: 22211801.6000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9799; val_auprc_score: 0.9719; val_best_acc_score: 0.9352; val_best_f1_score: 0.9372; train_kl_reg_loss: 82282.6582; train_edge_recon_loss: 2692378.6756; train_gene_expr_recon_loss: 13492867.8855; train_masked_gp_l1_reg_loss: 77255.3096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127610.7145; train_chrom_access_recon_loss: 5479411.4962; train_global_loss: 21951806.8702; train_optim_loss: 21951806.8702; val_kl_reg_loss: 81825.4120; val_edge_recon_loss: 2702913.3500; val_gene_expr_recon_loss: 13591595.5333; val_masked_gp_l1_reg_loss: 77298.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126956.4844; val_chrom_access_recon_loss: 5609745.0667; val_global_loss: 22190334.1333; val_optim_loss: 22190334.1333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9821; val_auprc_score: 0.9760; val_best_acc_score: 0.9400; val_best_f1_score: 0.9412; train_kl_reg_loss: 82031.5082; train_edge_recon_loss: 2688511.7252; train_gene_expr_recon_loss: 13477096.7252; train_masked_gp_l1_reg_loss: 77372.6979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127297.3972; train_chrom_access_recon_loss: 5476420.8473; train_global_loss: 21928730.9313; train_optim_loss: 21928730.9313; val_kl_reg_loss: 80043.9177; val_edge_recon_loss: 2691992.6500; val_gene_expr_recon_loss: 13610643.3333; val_masked_gp_l1_reg_loss: 77410.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127476.0859; val_chrom_access_recon_loss: 5602328.6667; val_global_loss: 22189895.3333; val_optim_loss: 22189895.3333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9806; val_auprc_score: 0.9757; val_best_acc_score: 0.9382; val_best_f1_score: 0.9397; train_kl_reg_loss: 81521.9116; train_edge_recon_loss: 2693641.0305; train_gene_expr_recon_loss: 13469494.4580; train_masked_gp_l1_reg_loss: 77515.7551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127350.2225; train_chrom_access_recon_loss: 5472093.9504; train_global_loss: 21921617.3893; train_optim_loss: 21921617.3893; val_kl_reg_loss: 78717.4865; val_edge_recon_loss: 2702544.4833; val_gene_expr_recon_loss: 13581740.7333; val_masked_gp_l1_reg_loss: 77586.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126589.5547; val_chrom_access_recon_loss: 5595925.0333; val_global_loss: 22163104.0000; val_optim_loss: 22163104.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9833; val_auprc_score: 0.9778; val_best_acc_score: 0.9394; val_best_f1_score: 0.9404; train_kl_reg_loss: 81293.3435; train_edge_recon_loss: 2684106.7252; train_gene_expr_recon_loss: 13445279.8015; train_masked_gp_l1_reg_loss: 77646.3768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127044.5706; train_chrom_access_recon_loss: 5462237.5573; train_global_loss: 21877608.2443; train_optim_loss: 21877608.2443; val_kl_reg_loss: 77509.2896; val_edge_recon_loss: 2691064.8167; val_gene_expr_recon_loss: 13605539.0667; val_masked_gp_l1_reg_loss: 77739.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127562.5625; val_chrom_access_recon_loss: 5636461.1667; val_global_loss: 22215876.2667; val_optim_loss: 22215876.2667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9839; val_auprc_score: 0.9805; val_best_acc_score: 0.9444; val_best_f1_score: 0.9455; train_kl_reg_loss: 80208.1298; train_edge_recon_loss: 2687724.4943; train_gene_expr_recon_loss: 13437533.6031; train_masked_gp_l1_reg_loss: 77858.7523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127102.5935; train_chrom_access_recon_loss: 5463996.8015; train_global_loss: 21874424.4122; train_optim_loss: 21874424.4122; val_kl_reg_loss: 79031.5755; val_edge_recon_loss: 2691820.3833; val_gene_expr_recon_loss: 13544202.5333; val_masked_gp_l1_reg_loss: 77937.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127350.8906; val_chrom_access_recon_loss: 5587869.7333; val_global_loss: 22108212.6667; val_optim_loss: 22108212.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9816; val_auprc_score: 0.9754; val_best_acc_score: 0.9413; val_best_f1_score: 0.9425; train_kl_reg_loss: 80319.1088; train_edge_recon_loss: 2688518.8321; train_gene_expr_recon_loss: 13431450.5191; train_masked_gp_l1_reg_loss: 78010.2044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126958.6461; train_chrom_access_recon_loss: 5453613.1412; train_global_loss: 21858870.3359; train_optim_loss: 21858870.3359; val_kl_reg_loss: 81062.0031; val_edge_recon_loss: 2702207.8000; val_gene_expr_recon_loss: 13533953.0000; val_masked_gp_l1_reg_loss: 78011.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125631.6641; val_chrom_access_recon_loss: 5589667.4667; val_global_loss: 22110533.4667; val_optim_loss: 22110533.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9831; val_auprc_score: 0.9768; val_best_acc_score: 0.9431; val_best_f1_score: 0.9450; train_kl_reg_loss: 80658.5714; train_edge_recon_loss: 2683952.7824; train_gene_expr_recon_loss: 13421324.1450; train_masked_gp_l1_reg_loss: 78097.0738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126874.6727; train_chrom_access_recon_loss: 5448709.7252; train_global_loss: 21839617.1450; train_optim_loss: 21839617.1450; val_kl_reg_loss: 79131.1240; val_edge_recon_loss: 2685692.2333; val_gene_expr_recon_loss: 13534561.3333; val_masked_gp_l1_reg_loss: 78132.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126836.6250; val_chrom_access_recon_loss: 5574109.6000; val_global_loss: 22078464.1333; val_optim_loss: 22078464.1333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9850; val_auprc_score: 0.9822; val_best_acc_score: 0.9452; val_best_f1_score: 0.9463; train_kl_reg_loss: 80001.2688; train_edge_recon_loss: 2682484.2710; train_gene_expr_recon_loss: 13424658.3588; train_masked_gp_l1_reg_loss: 78160.9422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127103.6867; train_chrom_access_recon_loss: 5450539.3397; train_global_loss: 21842947.9695; train_optim_loss: 21842947.9695; val_kl_reg_loss: 78482.0521; val_edge_recon_loss: 2684626.3333; val_gene_expr_recon_loss: 13549889.7333; val_masked_gp_l1_reg_loss: 78245.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127232.6250; val_chrom_access_recon_loss: 5595182.7667; val_global_loss: 22113659.0667; val_optim_loss: 22113659.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9810; val_auprc_score: 0.9721; val_best_acc_score: 0.9392; val_best_f1_score: 0.9412; train_kl_reg_loss: 79745.5796; train_edge_recon_loss: 2679075.4733; train_gene_expr_recon_loss: 13403002.5954; train_masked_gp_l1_reg_loss: 78322.8119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126965.4942; train_chrom_access_recon_loss: 5439175.9084; train_global_loss: 21806287.8473; train_optim_loss: 21806287.8473; val_kl_reg_loss: 79598.1146; val_edge_recon_loss: 2695055.9667; val_gene_expr_recon_loss: 13497999.2667; val_masked_gp_l1_reg_loss: 78368.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125845.6250; val_chrom_access_recon_loss: 5558825.5333; val_global_loss: 22035692.6667; val_optim_loss: 22035692.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9846; val_auprc_score: 0.9813; val_best_acc_score: 0.9434; val_best_f1_score: 0.9451; train_kl_reg_loss: 79526.2293; train_edge_recon_loss: 2689108.0305; train_gene_expr_recon_loss: 13388117.9160; train_masked_gp_l1_reg_loss: 78419.0291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126970.3383; train_chrom_access_recon_loss: 5434911.1985; train_global_loss: 21797052.7481; train_optim_loss: 21797052.7481; val_kl_reg_loss: 77171.6104; val_edge_recon_loss: 2699712.0000; val_gene_expr_recon_loss: 13481473.9333; val_masked_gp_l1_reg_loss: 78474.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127150.8125; val_chrom_access_recon_loss: 5542453.6333; val_global_loss: 22006436.4000; val_optim_loss: 22006436.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9841; val_auprc_score: 0.9760; val_best_acc_score: 0.9452; val_best_f1_score: 0.9474; train_kl_reg_loss: 79896.2644; train_edge_recon_loss: 2678018.8149; train_gene_expr_recon_loss: 13388721.2443; train_masked_gp_l1_reg_loss: 78485.7159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126856.0250; train_chrom_access_recon_loss: 5433750.1298; train_global_loss: 21785728.1527; train_optim_loss: 21785728.1527; val_kl_reg_loss: 78768.5932; val_edge_recon_loss: 2686162.8333; val_gene_expr_recon_loss: 13551738.9333; val_masked_gp_l1_reg_loss: 78480.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128073.3203; val_chrom_access_recon_loss: 5577836.2667; val_global_loss: 22101059.7333; val_optim_loss: 22101059.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9853; val_auprc_score: 0.9806; val_best_acc_score: 0.9506; val_best_f1_score: 0.9518; train_kl_reg_loss: 79506.1573; train_edge_recon_loss: 2682178.0477; train_gene_expr_recon_loss: 13381776.8626; train_masked_gp_l1_reg_loss: 78540.1899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127053.2162; train_chrom_access_recon_loss: 5430399.9618; train_global_loss: 21779454.3969; train_optim_loss: 21779454.3969; val_kl_reg_loss: 78941.0005; val_edge_recon_loss: 2697082.3333; val_gene_expr_recon_loss: 13541880.6667; val_masked_gp_l1_reg_loss: 78574.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126037.0469; val_chrom_access_recon_loss: 5593919.4667; val_global_loss: 22116435.7333; val_optim_loss: 22116435.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9876; val_auprc_score: 0.9825; val_best_acc_score: 0.9538; val_best_f1_score: 0.9545; train_kl_reg_loss: 79606.7179; train_edge_recon_loss: 2681240.6565; train_gene_expr_recon_loss: 13384086.0305; train_masked_gp_l1_reg_loss: 78620.6335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126961.5407; train_chrom_access_recon_loss: 5429985.7863; train_global_loss: 21780501.1756; train_optim_loss: 21780501.1756; val_kl_reg_loss: 78313.5260; val_edge_recon_loss: 2683569.8000; val_gene_expr_recon_loss: 13506307.7333; val_masked_gp_l1_reg_loss: 78667.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127399.9688; val_chrom_access_recon_loss: 5561623.1000; val_global_loss: 22035880.8000; val_optim_loss: 22035880.8000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9861; val_auprc_score: 0.9831; val_best_acc_score: 0.9489; val_best_f1_score: 0.9508; train_kl_reg_loss: 79498.7381; train_edge_recon_loss: 2674412.1603; train_gene_expr_recon_loss: 13371782.4427; train_masked_gp_l1_reg_loss: 78706.2613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127139.6226; train_chrom_access_recon_loss: 5425315.5573; train_global_loss: 21756854.7023; train_optim_loss: 21756854.7023; val_kl_reg_loss: 78264.2198; val_edge_recon_loss: 2692472.7167; val_gene_expr_recon_loss: 13509480.2667; val_masked_gp_l1_reg_loss: 78726.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126963.4844; val_chrom_access_recon_loss: 5552383.8333; val_global_loss: 22038291.4667; val_optim_loss: 22038291.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9862; val_auprc_score: 0.9818; val_best_acc_score: 0.9516; val_best_f1_score: 0.9525; train_kl_reg_loss: 80643.5314; train_edge_recon_loss: 2668669.6183; train_gene_expr_recon_loss: 13344969.9542; train_masked_gp_l1_reg_loss: 78046.6491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93225.4367; train_chrom_access_recon_loss: 5413616.0534; train_global_loss: 21679171.2214; train_optim_loss: 21679171.2214; val_kl_reg_loss: 82027.2271; val_edge_recon_loss: 2684162.8000; val_gene_expr_recon_loss: 13453010.2667; val_masked_gp_l1_reg_loss: 77733.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89380.3906; val_chrom_access_recon_loss: 5530570.4667; val_global_loss: 21916884.8000; val_optim_loss: 21916884.8000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9833; val_auprc_score: 0.9751; val_best_acc_score: 0.9501; val_best_f1_score: 0.9514; train_kl_reg_loss: 81890.0621; train_edge_recon_loss: 2679438.2538; train_gene_expr_recon_loss: 13339261.9618; train_masked_gp_l1_reg_loss: 77632.1467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88920.9846; train_chrom_access_recon_loss: 5404480.0649; train_global_loss: 21671623.3893; train_optim_loss: 21671623.3893; val_kl_reg_loss: 81953.5281; val_edge_recon_loss: 2688082.5333; val_gene_expr_recon_loss: 13478357.9333; val_masked_gp_l1_reg_loss: 77543.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88543.6484; val_chrom_access_recon_loss: 5571044.9333; val_global_loss: 21985525.6000; val_optim_loss: 21985525.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9869; val_auprc_score: 0.9838; val_best_acc_score: 0.9508; val_best_f1_score: 0.9520; train_kl_reg_loss: 82451.6235; train_edge_recon_loss: 2671122.8969; train_gene_expr_recon_loss: 13334115.8702; train_masked_gp_l1_reg_loss: 77503.8701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88236.4572; train_chrom_access_recon_loss: 5406163.4389; train_global_loss: 21659594.2137; train_optim_loss: 21659594.2137; val_kl_reg_loss: 82746.0917; val_edge_recon_loss: 2689701.5500; val_gene_expr_recon_loss: 13448468.5333; val_masked_gp_l1_reg_loss: 77459.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88061.6406; val_chrom_access_recon_loss: 5540751.7000; val_global_loss: 21927189.0667; val_optim_loss: 21927189.0667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9859; val_auprc_score: 0.9806; val_best_acc_score: 0.9501; val_best_f1_score: 0.9508; train_kl_reg_loss: 83294.7260; train_edge_recon_loss: 2674077.9313; train_gene_expr_recon_loss: 13329362.4046; train_masked_gp_l1_reg_loss: 77432.5927; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87761.4665; train_chrom_access_recon_loss: 5405032.8969; train_global_loss: 21656961.8931; train_optim_loss: 21656961.8931; val_kl_reg_loss: 83797.8068; val_edge_recon_loss: 2706158.0333; val_gene_expr_recon_loss: 13462696.4667; val_masked_gp_l1_reg_loss: 77398.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87448.1172; val_chrom_access_recon_loss: 5536567.3667; val_global_loss: 21954066.1333; val_optim_loss: 21954066.1333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9884; val_auprc_score: 0.9855; val_best_acc_score: 0.9539; val_best_f1_score: 0.9547; train_kl_reg_loss: 83243.9710; train_edge_recon_loss: 2669118.1031; train_gene_expr_recon_loss: 13334479.6947; train_masked_gp_l1_reg_loss: 77385.1475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87277.3528; train_chrom_access_recon_loss: 5403822.0573; train_global_loss: 21655326.2137; train_optim_loss: 21655326.2137; val_kl_reg_loss: 83292.7937; val_edge_recon_loss: 2682535.9500; val_gene_expr_recon_loss: 13474721.2667; val_masked_gp_l1_reg_loss: 77374.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87083.5391; val_chrom_access_recon_loss: 5541573.5333; val_global_loss: 21946582.1333; val_optim_loss: 21946582.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9885; val_auprc_score: 0.9831; val_best_acc_score: 0.9550; val_best_f1_score: 0.9559; train_kl_reg_loss: 83323.3477; train_edge_recon_loss: 2676105.3645; train_gene_expr_recon_loss: 13323460.4046; train_masked_gp_l1_reg_loss: 77302.1236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83340.3968; train_chrom_access_recon_loss: 5402500.4160; train_global_loss: 21646032.0153; train_optim_loss: 21646032.0153; val_kl_reg_loss: 83530.4557; val_edge_recon_loss: 2673198.9500; val_gene_expr_recon_loss: 13498819.0000; val_masked_gp_l1_reg_loss: 77262.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82887.6016; val_chrom_access_recon_loss: 5577263.8333; val_global_loss: 21992962.9333; val_optim_loss: 21992962.9333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9878; val_auprc_score: 0.9849; val_best_acc_score: 0.9506; val_best_f1_score: 0.9518; train_kl_reg_loss: 83421.4724; train_edge_recon_loss: 2671679.6698; train_gene_expr_recon_loss: 13331328.8702; train_masked_gp_l1_reg_loss: 77245.7414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82796.7640; train_chrom_access_recon_loss: 5405038.7748; train_global_loss: 21651511.3282; train_optim_loss: 21651511.3282; val_kl_reg_loss: 83287.9453; val_edge_recon_loss: 2688670.2333; val_gene_expr_recon_loss: 13460233.5333; val_masked_gp_l1_reg_loss: 77231.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82741.8750; val_chrom_access_recon_loss: 5521889.7333; val_global_loss: 21914054.6667; val_optim_loss: 21914054.6667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9869; val_auprc_score: 0.9831; val_best_acc_score: 0.9507; val_best_f1_score: 0.9516; train_kl_reg_loss: 83456.4837; train_edge_recon_loss: 2669066.6107; train_gene_expr_recon_loss: 13322404.7863; train_masked_gp_l1_reg_loss: 77222.7170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82697.7202; train_chrom_access_recon_loss: 5398516.7672; train_global_loss: 21633365.1145; train_optim_loss: 21633365.1145; val_kl_reg_loss: 83662.4677; val_edge_recon_loss: 2684909.0833; val_gene_expr_recon_loss: 13469287.3333; val_masked_gp_l1_reg_loss: 77212.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82644.6875; val_chrom_access_recon_loss: 5551611.7667; val_global_loss: 21949328.5333; val_optim_loss: 21949328.5333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9876; val_auprc_score: 0.9837; val_best_acc_score: 0.9527; val_best_f1_score: 0.9537; train_kl_reg_loss: 83534.1023; train_edge_recon_loss: 2666795.5553; train_gene_expr_recon_loss: 13329141.0229; train_masked_gp_l1_reg_loss: 77206.9955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82599.8673; train_chrom_access_recon_loss: 5403952.9198; train_global_loss: 21643230.5191; train_optim_loss: 21643230.5191; val_kl_reg_loss: 83499.2422; val_edge_recon_loss: 2663476.8333; val_gene_expr_recon_loss: 13409209.3333; val_masked_gp_l1_reg_loss: 77201.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82565.3359; val_chrom_access_recon_loss: 5540303.0333; val_global_loss: 21856254.6667; val_optim_loss: 21856254.6667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9881; val_auprc_score: 0.9838; val_best_acc_score: 0.9499; val_best_f1_score: 0.9507; train_kl_reg_loss: 83716.8635; train_edge_recon_loss: 2671379.5153; train_gene_expr_recon_loss: 13324888.3740; train_masked_gp_l1_reg_loss: 77197.1010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82550.5976; train_chrom_access_recon_loss: 5400921.3321; train_global_loss: 21640653.9695; train_optim_loss: 21640653.9695; val_kl_reg_loss: 83554.0729; val_edge_recon_loss: 2679789.2333; val_gene_expr_recon_loss: 13505884.9333; val_masked_gp_l1_reg_loss: 77192.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82509.6250; val_chrom_access_recon_loss: 5559172.0000; val_global_loss: 21988103.3333; val_optim_loss: 21988103.3333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9859; val_auprc_score: 0.9820; val_best_acc_score: 0.9497; val_best_f1_score: 0.9507; train_kl_reg_loss: 83696.8625; train_edge_recon_loss: 2674704.6508; train_gene_expr_recon_loss: 13329691.2824; train_masked_gp_l1_reg_loss: 77188.9016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82478.7583; train_chrom_access_recon_loss: 5404932.5382; train_global_loss: 21652693.0229; train_optim_loss: 21652693.0229; val_kl_reg_loss: 83585.9115; val_edge_recon_loss: 2702594.5333; val_gene_expr_recon_loss: 13475455.7333; val_masked_gp_l1_reg_loss: 77185.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82440.7500; val_chrom_access_recon_loss: 5546414.7000; val_global_loss: 21967676.4000; val_optim_loss: 21967676.4000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9895; val_auprc_score: 0.9875; val_best_acc_score: 0.9537; val_best_f1_score: 0.9543; train_kl_reg_loss: 83644.8927; train_edge_recon_loss: 2667041.7309; train_gene_expr_recon_loss: 13331460.2519; train_masked_gp_l1_reg_loss: 77184.0840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82415.2722; train_chrom_access_recon_loss: 5405260.9733; train_global_loss: 21647007.0534; train_optim_loss: 21647007.0534; val_kl_reg_loss: 83977.9745; val_edge_recon_loss: 2672090.7333; val_gene_expr_recon_loss: 13542353.0000; val_masked_gp_l1_reg_loss: 77179.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82387.5703; val_chrom_access_recon_loss: 5553067.9667; val_global_loss: 22011056.5333; val_optim_loss: 22011056.5333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9866; val_auprc_score: 0.9828; val_best_acc_score: 0.9522; val_best_f1_score: 0.9530; train_kl_reg_loss: 83750.8070; train_edge_recon_loss: 2671278.8244; train_gene_expr_recon_loss: 13336172.1832; train_masked_gp_l1_reg_loss: 77178.2610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82368.4314; train_chrom_access_recon_loss: 5403948.8893; train_global_loss: 21654697.3282; train_optim_loss: 21654697.3282; val_kl_reg_loss: 83652.8094; val_edge_recon_loss: 2676444.6333; val_gene_expr_recon_loss: 13457881.8000; val_masked_gp_l1_reg_loss: 77174.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82335.9141; val_chrom_access_recon_loss: 5556918.1667; val_global_loss: 21934408.6667; val_optim_loss: 21934408.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9857; val_auprc_score: 0.9793; val_best_acc_score: 0.9528; val_best_f1_score: 0.9540; train_kl_reg_loss: 83655.3859; train_edge_recon_loss: 2668396.3989; train_gene_expr_recon_loss: 13336304.7710; train_masked_gp_l1_reg_loss: 77167.7415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81966.5297; train_chrom_access_recon_loss: 5406696.2481; train_global_loss: 21654187.0992; train_optim_loss: 21654187.0992; val_kl_reg_loss: 84001.3906; val_edge_recon_loss: 2698866.4167; val_gene_expr_recon_loss: 13512147.5333; val_masked_gp_l1_reg_loss: 77164.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81923.6484; val_chrom_access_recon_loss: 5567290.4000; val_global_loss: 22021393.6000; val_optim_loss: 22021393.6000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9885; val_auprc_score: 0.9861; val_best_acc_score: 0.9532; val_best_f1_score: 0.9540; train_kl_reg_loss: 83655.2756; train_edge_recon_loss: 2676819.5611; train_gene_expr_recon_loss: 13327623.5420; train_masked_gp_l1_reg_loss: 77162.7981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81917.5776; train_chrom_access_recon_loss: 5402135.3588; train_global_loss: 21649314.1832; train_optim_loss: 21649314.1832; val_kl_reg_loss: 83522.1552; val_edge_recon_loss: 2680557.3500; val_gene_expr_recon_loss: 13520497.7333; val_masked_gp_l1_reg_loss: 77161.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81910.6016; val_chrom_access_recon_loss: 5565004.7333; val_global_loss: 22008653.7333; val_optim_loss: 22008653.7333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9862; val_auprc_score: 0.9801; val_best_acc_score: 0.9518; val_best_f1_score: 0.9526; train_kl_reg_loss: 83643.2902; train_edge_recon_loss: 2670671.1584; train_gene_expr_recon_loss: 13332227.9695; train_masked_gp_l1_reg_loss: 77160.2111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81905.8146; train_chrom_access_recon_loss: 5400602.7748; train_global_loss: 21646211.1450; train_optim_loss: 21646211.1450; val_kl_reg_loss: 83796.7937; val_edge_recon_loss: 2671267.9667; val_gene_expr_recon_loss: 13463326.8000; val_masked_gp_l1_reg_loss: 77159.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81899.7578; val_chrom_access_recon_loss: 5555271.2667; val_global_loss: 21932722.2667; val_optim_loss: 21932722.2667
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9878; val_auprc_score: 0.9848; val_best_acc_score: 0.9539; val_best_f1_score: 0.9546; train_kl_reg_loss: 83688.9939; train_edge_recon_loss: 2676151.0592; train_gene_expr_recon_loss: 13336545.8931; train_masked_gp_l1_reg_loss: 77158.7235; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81896.3556; train_chrom_access_recon_loss: 5406918.7290; train_global_loss: 21662359.6489; train_optim_loss: 21662359.6489; val_kl_reg_loss: 83638.4828; val_edge_recon_loss: 2684002.2667; val_gene_expr_recon_loss: 13419780.9333; val_masked_gp_l1_reg_loss: 77157.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81891.2109; val_chrom_access_recon_loss: 5526807.4000; val_global_loss: 21873278.0000; val_optim_loss: 21873278.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 84 min 49 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9875
val AUPRC score: 0.9829
val best accuracy score: 0.9568
val best F1 score: 0.9577
val target rna MSE score: 0.8737
val source rna MSE score: 0.2335
val target atac MSE score: 0.5232
val source atac MSE score: 0.0847
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
