[True]
Run timestamp: 09102023_185358_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6381; val_auprc_score: 0.6386; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 40097.6868; train_edge_recon_loss: 3506640.7689; train_gene_expr_recon_loss: 14080685.3030; train_masked_gp_l1_reg_loss: 31489.2215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3657558.6288; train_chrom_access_recon_loss: 2334083.3068; train_global_loss: 23650554.7879; train_optim_loss: 23650554.7879; val_kl_reg_loss: 91964.8066; val_edge_recon_loss: 4065494.0312; val_gene_expr_recon_loss: 12965361.1250; val_masked_gp_l1_reg_loss: 37502.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2074212.8750; val_chrom_access_recon_loss: 2186890.1562; val_global_loss: 21421425.2500; val_optim_loss: 21421425.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7239; val_auprc_score: 0.7093; val_best_acc_score: 0.5615; val_best_f1_score: 0.6875; train_kl_reg_loss: 78052.1436; train_edge_recon_loss: 3513039.5985; train_gene_expr_recon_loss: 12894901.2576; train_masked_gp_l1_reg_loss: 38733.3697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1156732.7008; train_chrom_access_recon_loss: 2220102.2121; train_global_loss: 19901561.2424; train_optim_loss: 19901561.2424; val_kl_reg_loss: 91138.9746; val_edge_recon_loss: 4061420.4688; val_gene_expr_recon_loss: 12472530.5000; val_masked_gp_l1_reg_loss: 39876.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 575365.8125; val_chrom_access_recon_loss: 2165011.4375; val_global_loss: 19405343.5000; val_optim_loss: 19405343.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7425; val_auprc_score: 0.7317; val_best_acc_score: 0.6701; val_best_f1_score: 0.7024; train_kl_reg_loss: 78560.5593; train_edge_recon_loss: 3504983.0417; train_gene_expr_recon_loss: 12691408.1061; train_masked_gp_l1_reg_loss: 41009.2098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 385207.2737; train_chrom_access_recon_loss: 2199992.5189; train_global_loss: 18901160.4545; train_optim_loss: 18901160.4545; val_kl_reg_loss: 77781.5684; val_edge_recon_loss: 4034993.2812; val_gene_expr_recon_loss: 12480259.8750; val_masked_gp_l1_reg_loss: 42334.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 260850.0312; val_chrom_access_recon_loss: 2145220.7344; val_global_loss: 19041439.7500; val_optim_loss: 19041439.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7721; val_auprc_score: 0.7501; val_best_acc_score: 0.7066; val_best_f1_score: 0.7322; train_kl_reg_loss: 66867.8333; train_edge_recon_loss: 3470128.7992; train_gene_expr_recon_loss: 12606294.5455; train_masked_gp_l1_reg_loss: 43653.6443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 204879.8374; train_chrom_access_recon_loss: 2186520.6250; train_global_loss: 18578345.3030; train_optim_loss: 18578345.3030; val_kl_reg_loss: 41846.3296; val_edge_recon_loss: 3499233.6250; val_gene_expr_recon_loss: 12420657.8750; val_masked_gp_l1_reg_loss: 45398.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163297.2812; val_chrom_access_recon_loss: 2136993.9219; val_global_loss: 18307428.0000; val_optim_loss: 18307428.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8033; val_auprc_score: 0.8031; val_best_acc_score: 0.7321; val_best_f1_score: 0.7365; train_kl_reg_loss: 65939.6100; train_edge_recon_loss: 3162507.5227; train_gene_expr_recon_loss: 12565494.4394; train_masked_gp_l1_reg_loss: 48179.2733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141489.7107; train_chrom_access_recon_loss: 2179175.7519; train_global_loss: 18162786.3636; train_optim_loss: 18162786.3636; val_kl_reg_loss: 90863.2686; val_edge_recon_loss: 3182921.5312; val_gene_expr_recon_loss: 12330284.8750; val_masked_gp_l1_reg_loss: 50464.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126436.0078; val_chrom_access_recon_loss: 2129168.2344; val_global_loss: 17910138.0000; val_optim_loss: 17910138.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8808; val_auprc_score: 0.8480; val_best_acc_score: 0.8149; val_best_f1_score: 0.8304; train_kl_reg_loss: 91741.8530; train_edge_recon_loss: 2901748.3598; train_gene_expr_recon_loss: 12465160.7576; train_masked_gp_l1_reg_loss: 52510.0574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117954.0645; train_chrom_access_recon_loss: 2163607.1629; train_global_loss: 17792722.3485; train_optim_loss: 17792722.3485; val_kl_reg_loss: 94015.0166; val_edge_recon_loss: 2882251.2188; val_gene_expr_recon_loss: 12396316.1250; val_masked_gp_l1_reg_loss: 54605.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110810.0469; val_chrom_access_recon_loss: 2124395.0938; val_global_loss: 17662393.5000; val_optim_loss: 17662393.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8861; val_auprc_score: 0.8551; val_best_acc_score: 0.8216; val_best_f1_score: 0.8348; train_kl_reg_loss: 99383.5703; train_edge_recon_loss: 2839811.5644; train_gene_expr_recon_loss: 12377519.7273; train_masked_gp_l1_reg_loss: 55740.5603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104861.2099; train_chrom_access_recon_loss: 2150051.3712; train_global_loss: 17627367.9091; train_optim_loss: 17627367.9091; val_kl_reg_loss: 97442.0264; val_edge_recon_loss: 2861657.7188; val_gene_expr_recon_loss: 12286274.7500; val_masked_gp_l1_reg_loss: 57015.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100266.3906; val_chrom_access_recon_loss: 2120485.0156; val_global_loss: 17523140.7500; val_optim_loss: 17523140.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8952; val_auprc_score: 0.8652; val_best_acc_score: 0.8315; val_best_f1_score: 0.8446; train_kl_reg_loss: 98147.4089; train_edge_recon_loss: 2831107.8030; train_gene_expr_recon_loss: 12309678.3788; train_masked_gp_l1_reg_loss: 58092.7208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95963.2657; train_chrom_access_recon_loss: 2140461.1591; train_global_loss: 17533450.7273; train_optim_loss: 17533450.7273; val_kl_reg_loss: 94809.1357; val_edge_recon_loss: 2829999.6875; val_gene_expr_recon_loss: 12250312.1250; val_masked_gp_l1_reg_loss: 59215.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92161.9062; val_chrom_access_recon_loss: 2097085.5938; val_global_loss: 17423583.7500; val_optim_loss: 17423583.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8894; val_auprc_score: 0.8543; val_best_acc_score: 0.8176; val_best_f1_score: 0.8363; train_kl_reg_loss: 93321.8086; train_edge_recon_loss: 2808459.4545; train_gene_expr_recon_loss: 12249843.7576; train_masked_gp_l1_reg_loss: 60201.8234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88976.4119; train_chrom_access_recon_loss: 2128728.3352; train_global_loss: 17429531.4697; train_optim_loss: 17429531.4697; val_kl_reg_loss: 90486.1230; val_edge_recon_loss: 2865299.9688; val_gene_expr_recon_loss: 12012354.2500; val_masked_gp_l1_reg_loss: 61273.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86179.7891; val_chrom_access_recon_loss: 2071592.0781; val_global_loss: 17187186.5000; val_optim_loss: 17187186.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8965; val_auprc_score: 0.8656; val_best_acc_score: 0.8329; val_best_f1_score: 0.8456; train_kl_reg_loss: 91014.5529; train_edge_recon_loss: 2807121.3106; train_gene_expr_recon_loss: 12195515.0909; train_masked_gp_l1_reg_loss: 62067.9395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83791.5373; train_chrom_access_recon_loss: 2121700.9205; train_global_loss: 17361211.4394; train_optim_loss: 17361211.4394; val_kl_reg_loss: 89088.9512; val_edge_recon_loss: 2829971.5312; val_gene_expr_recon_loss: 12002693.7500; val_masked_gp_l1_reg_loss: 62999.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82242.1172; val_chrom_access_recon_loss: 2066829.7812; val_global_loss: 17133825.6250; val_optim_loss: 17133825.6250
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9098; val_auprc_score: 0.8850; val_best_acc_score: 0.8420; val_best_f1_score: 0.8518; train_kl_reg_loss: 89123.8778; train_edge_recon_loss: 2801461.0985; train_gene_expr_recon_loss: 12153140.7879; train_masked_gp_l1_reg_loss: 63721.9022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80060.1052; train_chrom_access_recon_loss: 2114942.6951; train_global_loss: 17302450.3939; train_optim_loss: 17302450.3939; val_kl_reg_loss: 85172.6455; val_edge_recon_loss: 2793863.5312; val_gene_expr_recon_loss: 12027031.0000; val_masked_gp_l1_reg_loss: 64556.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78795.9062; val_chrom_access_recon_loss: 2068252.8750; val_global_loss: 17117672.1250; val_optim_loss: 17117672.1250
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8929; val_auprc_score: 0.8565; val_best_acc_score: 0.8305; val_best_f1_score: 0.8441; train_kl_reg_loss: 86254.9625; train_edge_recon_loss: 2803105.3106; train_gene_expr_recon_loss: 12106092.3182; train_masked_gp_l1_reg_loss: 65264.9445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77058.6016; train_chrom_access_recon_loss: 2107891.6989; train_global_loss: 17245667.7121; train_optim_loss: 17245667.7121; val_kl_reg_loss: 83465.1543; val_edge_recon_loss: 2838858.5312; val_gene_expr_recon_loss: 12053849.3750; val_masked_gp_l1_reg_loss: 66040.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75846.6953; val_chrom_access_recon_loss: 2075500.9844; val_global_loss: 17193561.1250; val_optim_loss: 17193561.1250
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9081; val_auprc_score: 0.8826; val_best_acc_score: 0.8428; val_best_f1_score: 0.8531; train_kl_reg_loss: 84717.1493; train_edge_recon_loss: 2799100.3636; train_gene_expr_recon_loss: 12068949.4697; train_masked_gp_l1_reg_loss: 66634.4073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74245.1766; train_chrom_access_recon_loss: 2101955.8258; train_global_loss: 17195602.3333; train_optim_loss: 17195602.3333; val_kl_reg_loss: 84818.5449; val_edge_recon_loss: 2814596.1875; val_gene_expr_recon_loss: 12066938.6250; val_masked_gp_l1_reg_loss: 67441.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73595.3828; val_chrom_access_recon_loss: 2070812.7031; val_global_loss: 17178202.1250; val_optim_loss: 17178202.1250
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9132; val_auprc_score: 0.8844; val_best_acc_score: 0.8495; val_best_f1_score: 0.8626; train_kl_reg_loss: 84940.6198; train_edge_recon_loss: 2764832.5530; train_gene_expr_recon_loss: 12017396.4697; train_masked_gp_l1_reg_loss: 67934.3879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73028.3778; train_chrom_access_recon_loss: 2093840.9034; train_global_loss: 17101973.3788; train_optim_loss: 17101973.3788; val_kl_reg_loss: 80273.4297; val_edge_recon_loss: 2810815.2500; val_gene_expr_recon_loss: 11870387.8750; val_masked_gp_l1_reg_loss: 68447.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72793.8984; val_chrom_access_recon_loss: 2052855.2969; val_global_loss: 16955573.8750; val_optim_loss: 16955573.8750
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9163; val_auprc_score: 0.8861; val_best_acc_score: 0.8573; val_best_f1_score: 0.8671; train_kl_reg_loss: 80799.2652; train_edge_recon_loss: 2771291.5644; train_gene_expr_recon_loss: 11993188.9091; train_masked_gp_l1_reg_loss: 69014.6482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72512.6296; train_chrom_access_recon_loss: 2089301.4735; train_global_loss: 17076108.5000; train_optim_loss: 17076108.5000; val_kl_reg_loss: 80666.9326; val_edge_recon_loss: 2791060.5938; val_gene_expr_recon_loss: 11865868.3750; val_masked_gp_l1_reg_loss: 69678.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73003.3203; val_chrom_access_recon_loss: 2038161.6875; val_global_loss: 16918438.3750; val_optim_loss: 16918438.3750
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9206; val_auprc_score: 0.8901; val_best_acc_score: 0.8611; val_best_f1_score: 0.8700; train_kl_reg_loss: 81404.1902; train_edge_recon_loss: 2755887.2689; train_gene_expr_recon_loss: 11950646.9545; train_masked_gp_l1_reg_loss: 70205.4773; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72593.3943; train_chrom_access_recon_loss: 2082598.3523; train_global_loss: 17013335.6818; train_optim_loss: 17013335.6818; val_kl_reg_loss: 78367.0273; val_edge_recon_loss: 2798160.5625; val_gene_expr_recon_loss: 11903407.0000; val_masked_gp_l1_reg_loss: 70662.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72349.3359; val_chrom_access_recon_loss: 2055102.2969; val_global_loss: 16978047.8750; val_optim_loss: 16978047.8750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9232; val_auprc_score: 0.9025; val_best_acc_score: 0.8635; val_best_f1_score: 0.8724; train_kl_reg_loss: 79679.9938; train_edge_recon_loss: 2751186.3371; train_gene_expr_recon_loss: 11917737.0909; train_masked_gp_l1_reg_loss: 71144.0047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72466.6635; train_chrom_access_recon_loss: 2076761.2860; train_global_loss: 16968975.4697; train_optim_loss: 16968975.4697; val_kl_reg_loss: 79943.2002; val_edge_recon_loss: 2805656.3125; val_gene_expr_recon_loss: 11744398.1250; val_masked_gp_l1_reg_loss: 71795.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73362.0859; val_chrom_access_recon_loss: 2015777.9062; val_global_loss: 16790933.3750; val_optim_loss: 16790933.3750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9271; val_auprc_score: 0.9019; val_best_acc_score: 0.8724; val_best_f1_score: 0.8801; train_kl_reg_loss: 80011.4512; train_edge_recon_loss: 2746377.6212; train_gene_expr_recon_loss: 11891325.9394; train_masked_gp_l1_reg_loss: 72139.5546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72523.8878; train_chrom_access_recon_loss: 2071633.2746; train_global_loss: 16934011.7879; train_optim_loss: 16934011.7879; val_kl_reg_loss: 76874.7783; val_edge_recon_loss: 2770071.5000; val_gene_expr_recon_loss: 11866495.7500; val_masked_gp_l1_reg_loss: 72632.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72647.2031; val_chrom_access_recon_loss: 2037909.1875; val_global_loss: 16896630.5000; val_optim_loss: 16896630.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9323; val_auprc_score: 0.9089; val_best_acc_score: 0.8769; val_best_f1_score: 0.8838; train_kl_reg_loss: 80253.9862; train_edge_recon_loss: 2726894.9886; train_gene_expr_recon_loss: 11860254.0000; train_masked_gp_l1_reg_loss: 72919.4639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71805.6194; train_chrom_access_recon_loss: 2067924.3580; train_global_loss: 16880052.3485; train_optim_loss: 16880052.3485; val_kl_reg_loss: 79395.4424; val_edge_recon_loss: 2744026.1562; val_gene_expr_recon_loss: 11734881.1250; val_masked_gp_l1_reg_loss: 73347.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71731.2891; val_chrom_access_recon_loss: 2028204.4219; val_global_loss: 16731586.2500; val_optim_loss: 16731586.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9278; val_auprc_score: 0.9051; val_best_acc_score: 0.8694; val_best_f1_score: 0.8760; train_kl_reg_loss: 76957.0310; train_edge_recon_loss: 2731990.0038; train_gene_expr_recon_loss: 11826404.8333; train_masked_gp_l1_reg_loss: 73641.7263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71386.2653; train_chrom_access_recon_loss: 2061095.1780; train_global_loss: 16841475.1818; train_optim_loss: 16841475.1818; val_kl_reg_loss: 75827.0938; val_edge_recon_loss: 2806706.3750; val_gene_expr_recon_loss: 11690313.8750; val_masked_gp_l1_reg_loss: 74090.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70577.0781; val_chrom_access_recon_loss: 2027467.8906; val_global_loss: 16744983.1250; val_optim_loss: 16744983.1250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9388; val_auprc_score: 0.9200; val_best_acc_score: 0.8812; val_best_f1_score: 0.8866; train_kl_reg_loss: 77219.9186; train_edge_recon_loss: 2722896.2803; train_gene_expr_recon_loss: 11804671.7727; train_masked_gp_l1_reg_loss: 74361.1136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70425.6544; train_chrom_access_recon_loss: 2057382.1345; train_global_loss: 16806956.8636; train_optim_loss: 16806956.8636; val_kl_reg_loss: 77918.6348; val_edge_recon_loss: 2722134.2500; val_gene_expr_recon_loss: 11636866.5000; val_masked_gp_l1_reg_loss: 74802.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70522.1719; val_chrom_access_recon_loss: 2022363.3750; val_global_loss: 16604607.1250; val_optim_loss: 16604607.1250
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9338; val_auprc_score: 0.9114; val_best_acc_score: 0.8748; val_best_f1_score: 0.8825; train_kl_reg_loss: 77432.6811; train_edge_recon_loss: 2718174.2500; train_gene_expr_recon_loss: 11780918.4242; train_masked_gp_l1_reg_loss: 75037.7098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70208.0288; train_chrom_access_recon_loss: 2052771.5568; train_global_loss: 16774542.6667; train_optim_loss: 16774542.6667; val_kl_reg_loss: 73571.0020; val_edge_recon_loss: 2747009.4375; val_gene_expr_recon_loss: 11611337.6250; val_masked_gp_l1_reg_loss: 75261.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69730.7031; val_chrom_access_recon_loss: 1986517.2812; val_global_loss: 16563428.1250; val_optim_loss: 16563428.1250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9287; val_auprc_score: 0.9036; val_best_acc_score: 0.8721; val_best_f1_score: 0.8782; train_kl_reg_loss: 76000.0308; train_edge_recon_loss: 2717413.1212; train_gene_expr_recon_loss: 11768145.5303; train_masked_gp_l1_reg_loss: 75628.6017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69859.8376; train_chrom_access_recon_loss: 2051424.9981; train_global_loss: 16758472.1818; train_optim_loss: 16758472.1818; val_kl_reg_loss: 79485.2080; val_edge_recon_loss: 2775051.5625; val_gene_expr_recon_loss: 11710084.1250; val_masked_gp_l1_reg_loss: 76015.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69474.1328; val_chrom_access_recon_loss: 1995717.8906; val_global_loss: 16705828.7500; val_optim_loss: 16705828.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9400; val_auprc_score: 0.9181; val_best_acc_score: 0.8826; val_best_f1_score: 0.8889; train_kl_reg_loss: 76795.6238; train_edge_recon_loss: 2717393.9659; train_gene_expr_recon_loss: 11733418.4697; train_masked_gp_l1_reg_loss: 76183.0382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69308.2653; train_chrom_access_recon_loss: 2044215.2992; train_global_loss: 16717314.8030; train_optim_loss: 16717314.8030; val_kl_reg_loss: 72363.3896; val_edge_recon_loss: 2753259.8750; val_gene_expr_recon_loss: 11682612.7500; val_masked_gp_l1_reg_loss: 76461.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69329.9609; val_chrom_access_recon_loss: 2022973.4688; val_global_loss: 16677000.7500; val_optim_loss: 16677000.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9474; val_auprc_score: 0.9270; val_best_acc_score: 0.8925; val_best_f1_score: 0.8984; train_kl_reg_loss: 75701.9779; train_edge_recon_loss: 2713717.0720; train_gene_expr_recon_loss: 11723089.6970; train_masked_gp_l1_reg_loss: 76665.6340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68965.3390; train_chrom_access_recon_loss: 2041276.0682; train_global_loss: 16699415.7121; train_optim_loss: 16699415.7121; val_kl_reg_loss: 75269.5410; val_edge_recon_loss: 2760624.3750; val_gene_expr_recon_loss: 11532906.5000; val_masked_gp_l1_reg_loss: 76758.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68809.3672; val_chrom_access_recon_loss: 2000618.3125; val_global_loss: 16514985.8750; val_optim_loss: 16514985.8750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9416; val_auprc_score: 0.9211; val_best_acc_score: 0.8842; val_best_f1_score: 0.8896; train_kl_reg_loss: 104950.7979; train_edge_recon_loss: 2846679.5985; train_gene_expr_recon_loss: 10461422.7273; train_masked_gp_l1_reg_loss: 76598.6747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64733.0266; train_chrom_access_recon_loss: 1847190.4792; train_global_loss: 15401575.2121; train_optim_loss: 15401575.2121; val_kl_reg_loss: 20811.4817; val_edge_recon_loss: 2802827.8125; val_gene_expr_recon_loss: 10320280.8750; val_masked_gp_l1_reg_loss: 76149.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65620.9766; val_chrom_access_recon_loss: 1784683.5938; val_global_loss: 15070374.6250; val_optim_loss: 15070374.6250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9340; val_auprc_score: 0.9082; val_best_acc_score: 0.8799; val_best_f1_score: 0.8851; train_kl_reg_loss: 80208.4239; train_edge_recon_loss: 2750255.9735; train_gene_expr_recon_loss: 10381722.1364; train_masked_gp_l1_reg_loss: 75562.3886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66050.8324; train_chrom_access_recon_loss: 1815564.0890; train_global_loss: 15169364.0000; train_optim_loss: 15169364.0000; val_kl_reg_loss: 26615.4070; val_edge_recon_loss: 2784420.1250; val_gene_expr_recon_loss: 10318511.8750; val_masked_gp_l1_reg_loss: 74787.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66896.4375; val_chrom_access_recon_loss: 1778010.5156; val_global_loss: 15049240.8750; val_optim_loss: 15049240.8750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9451; val_auprc_score: 0.9241; val_best_acc_score: 0.8923; val_best_f1_score: 0.8979; train_kl_reg_loss: 63122.0953; train_edge_recon_loss: 2739315.5644; train_gene_expr_recon_loss: 10356451.2273; train_masked_gp_l1_reg_loss: 74020.2357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66752.6821; train_chrom_access_recon_loss: 1810797.1553; train_global_loss: 15110459.0455; train_optim_loss: 15110459.0455; val_kl_reg_loss: 31182.5886; val_edge_recon_loss: 2759890.0000; val_gene_expr_recon_loss: 10196515.5000; val_masked_gp_l1_reg_loss: 73206.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66491.7422; val_chrom_access_recon_loss: 1750011.9688; val_global_loss: 14877297.8750; val_optim_loss: 14877297.8750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9424; val_auprc_score: 0.9161; val_best_acc_score: 0.8874; val_best_f1_score: 0.8921; train_kl_reg_loss: 57178.1497; train_edge_recon_loss: 2709248.9167; train_gene_expr_recon_loss: 10329878.7879; train_masked_gp_l1_reg_loss: 72357.4867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66757.3724; train_chrom_access_recon_loss: 1805298.6326; train_global_loss: 15040719.3788; train_optim_loss: 15040719.3788; val_kl_reg_loss: 34086.0825; val_edge_recon_loss: 2739590.4062; val_gene_expr_recon_loss: 10208718.2500; val_masked_gp_l1_reg_loss: 71514.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66964.5312; val_chrom_access_recon_loss: 1755758.5469; val_global_loss: 14876633.3750; val_optim_loss: 14876633.3750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9387; val_auprc_score: 0.9134; val_best_acc_score: 0.8847; val_best_f1_score: 0.8913; train_kl_reg_loss: 54563.9308; train_edge_recon_loss: 2713162.0152; train_gene_expr_recon_loss: 10316266.0152; train_masked_gp_l1_reg_loss: 70701.3416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66744.5393; train_chrom_access_recon_loss: 1802676.3106; train_global_loss: 15024114.1515; train_optim_loss: 15024114.1515; val_kl_reg_loss: 35134.0479; val_edge_recon_loss: 2759013.4375; val_gene_expr_recon_loss: 10164902.8750; val_masked_gp_l1_reg_loss: 69957.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66674.6094; val_chrom_access_recon_loss: 1768839.6406; val_global_loss: 14864523.0000; val_optim_loss: 14864523.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9463; val_auprc_score: 0.9262; val_best_acc_score: 0.8928; val_best_f1_score: 0.8968; train_kl_reg_loss: 52961.6162; train_edge_recon_loss: 2699671.5492; train_gene_expr_recon_loss: 10298306.6212; train_masked_gp_l1_reg_loss: 69237.6911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66549.9218; train_chrom_access_recon_loss: 1798691.0852; train_global_loss: 14985418.4848; train_optim_loss: 14985418.4848; val_kl_reg_loss: 39352.1729; val_edge_recon_loss: 2724130.6562; val_gene_expr_recon_loss: 10158793.5000; val_masked_gp_l1_reg_loss: 68527.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66300.8984; val_chrom_access_recon_loss: 1750342.6562; val_global_loss: 14807448.1250; val_optim_loss: 14807448.1250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9439; val_auprc_score: 0.9221; val_best_acc_score: 0.8909; val_best_f1_score: 0.8962; train_kl_reg_loss: 52457.3441; train_edge_recon_loss: 2698055.0114; train_gene_expr_recon_loss: 10272488.0758; train_masked_gp_l1_reg_loss: 67872.1443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66247.5813; train_chrom_access_recon_loss: 1793264.0170; train_global_loss: 14950384.2121; train_optim_loss: 14950384.2121; val_kl_reg_loss: 39622.2646; val_edge_recon_loss: 2743836.4375; val_gene_expr_recon_loss: 10141301.3750; val_masked_gp_l1_reg_loss: 67295.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66008.0781; val_chrom_access_recon_loss: 1750105.2812; val_global_loss: 14808169.2500; val_optim_loss: 14808169.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9403; val_auprc_score: 0.9145; val_best_acc_score: 0.8869; val_best_f1_score: 0.8917; train_kl_reg_loss: 50147.9788; train_edge_recon_loss: 2692600.9129; train_gene_expr_recon_loss: 10270906.6667; train_masked_gp_l1_reg_loss: 66690.9625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65946.1263; train_chrom_access_recon_loss: 1791435.1155; train_global_loss: 14937727.6667; train_optim_loss: 14937727.6667; val_kl_reg_loss: 41227.4946; val_edge_recon_loss: 2746139.5938; val_gene_expr_recon_loss: 10186413.8750; val_masked_gp_l1_reg_loss: 66159.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66142.1406; val_chrom_access_recon_loss: 1764491.5625; val_global_loss: 14870574.7500; val_optim_loss: 14870574.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9473; val_auprc_score: 0.9248; val_best_acc_score: 0.8923; val_best_f1_score: 0.8969; train_kl_reg_loss: 49003.6040; train_edge_recon_loss: 2701228.4394; train_gene_expr_recon_loss: 10253958.8333; train_masked_gp_l1_reg_loss: 65666.3890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65841.4808; train_chrom_access_recon_loss: 1788444.4223; train_global_loss: 14924143.2273; train_optim_loss: 14924143.2273; val_kl_reg_loss: 40873.3765; val_edge_recon_loss: 2713398.6250; val_gene_expr_recon_loss: 10224996.3750; val_masked_gp_l1_reg_loss: 65185.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65554.5781; val_chrom_access_recon_loss: 1774305.7656; val_global_loss: 14884315.1250; val_optim_loss: 14884315.1250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9439; val_auprc_score: 0.9241; val_best_acc_score: 0.8837; val_best_f1_score: 0.8895; train_kl_reg_loss: 49431.3900; train_edge_recon_loss: 2693704.7348; train_gene_expr_recon_loss: 10243611.4848; train_masked_gp_l1_reg_loss: 64778.7206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65578.0130; train_chrom_access_recon_loss: 1786761.4148; train_global_loss: 14903865.7424; train_optim_loss: 14903865.7424; val_kl_reg_loss: 44208.5415; val_edge_recon_loss: 2745498.5000; val_gene_expr_recon_loss: 10170030.2500; val_masked_gp_l1_reg_loss: 64361.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65775.8438; val_chrom_access_recon_loss: 1751465.0469; val_global_loss: 14841339.6250; val_optim_loss: 14841339.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9484; val_auprc_score: 0.9267; val_best_acc_score: 0.8941; val_best_f1_score: 0.8994; train_kl_reg_loss: 51360.8596; train_edge_recon_loss: 2685869.1667; train_gene_expr_recon_loss: 10223556.8788; train_masked_gp_l1_reg_loss: 64079.8219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56756.2954; train_chrom_access_recon_loss: 1782753.4583; train_global_loss: 14864376.4394; train_optim_loss: 14864376.4394; val_kl_reg_loss: 43585.2734; val_edge_recon_loss: 2715544.6562; val_gene_expr_recon_loss: 10164029.5000; val_masked_gp_l1_reg_loss: 63947.9727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54772.3633; val_chrom_access_recon_loss: 1759788.1406; val_global_loss: 14801667.5000; val_optim_loss: 14801667.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9470; val_auprc_score: 0.9271; val_best_acc_score: 0.8928; val_best_f1_score: 0.8982; train_kl_reg_loss: 51067.1539; train_edge_recon_loss: 2691482.5000; train_gene_expr_recon_loss: 10217236.6970; train_masked_gp_l1_reg_loss: 63883.0734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54456.4368; train_chrom_access_recon_loss: 1783057.9167; train_global_loss: 14861183.7576; train_optim_loss: 14861183.7576; val_kl_reg_loss: 43966.9536; val_edge_recon_loss: 2707074.2188; val_gene_expr_recon_loss: 10204096.2500; val_masked_gp_l1_reg_loss: 63822.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54241.8164; val_chrom_access_recon_loss: 1760695.4062; val_global_loss: 14833896.8750; val_optim_loss: 14833896.8750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9515; val_auprc_score: 0.9346; val_best_acc_score: 0.8982; val_best_f1_score: 0.9028; train_kl_reg_loss: 51089.2734; train_edge_recon_loss: 2684674.8409; train_gene_expr_recon_loss: 10221955.2576; train_masked_gp_l1_reg_loss: 63777.5859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54086.6667; train_chrom_access_recon_loss: 1783238.0208; train_global_loss: 14858821.5758; train_optim_loss: 14858821.5758; val_kl_reg_loss: 44011.8481; val_edge_recon_loss: 2720668.5938; val_gene_expr_recon_loss: 10172102.3750; val_masked_gp_l1_reg_loss: 63731.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53926.4727; val_chrom_access_recon_loss: 1751474.0312; val_global_loss: 14805914.8750; val_optim_loss: 14805914.8750
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9532; val_auprc_score: 0.9360; val_best_acc_score: 0.8958; val_best_f1_score: 0.9007; train_kl_reg_loss: 51158.7551; train_edge_recon_loss: 2689029.5114; train_gene_expr_recon_loss: 10216105.5000; train_masked_gp_l1_reg_loss: 63684.5409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53847.4408; train_chrom_access_recon_loss: 1782345.0549; train_global_loss: 14856170.8333; train_optim_loss: 14856170.8333; val_kl_reg_loss: 43792.1455; val_edge_recon_loss: 2692542.1562; val_gene_expr_recon_loss: 10084368.5000; val_masked_gp_l1_reg_loss: 63640.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53737.6758; val_chrom_access_recon_loss: 1730040.9844; val_global_loss: 14668122.7500; val_optim_loss: 14668122.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9483; val_auprc_score: 0.9259; val_best_acc_score: 0.8955; val_best_f1_score: 0.9007; train_kl_reg_loss: 50971.0052; train_edge_recon_loss: 2692894.2652; train_gene_expr_recon_loss: 10212623.8636; train_masked_gp_l1_reg_loss: 63589.6712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53629.3135; train_chrom_access_recon_loss: 1780545.7633; train_global_loss: 14854253.8636; train_optim_loss: 14854253.8636; val_kl_reg_loss: 43662.9238; val_edge_recon_loss: 2703714.3438; val_gene_expr_recon_loss: 10076552.8750; val_masked_gp_l1_reg_loss: 63547.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53564.3789; val_chrom_access_recon_loss: 1747734.9531; val_global_loss: 14688776.8750; val_optim_loss: 14688776.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9467; val_auprc_score: 0.9214; val_best_acc_score: 0.8976; val_best_f1_score: 0.9026; train_kl_reg_loss: 51101.1735; train_edge_recon_loss: 2681232.3068; train_gene_expr_recon_loss: 10205851.7727; train_masked_gp_l1_reg_loss: 63505.0231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53450.8882; train_chrom_access_recon_loss: 1780663.3655; train_global_loss: 14835804.6061; train_optim_loss: 14835804.6061; val_kl_reg_loss: 44207.8232; val_edge_recon_loss: 2729700.3750; val_gene_expr_recon_loss: 10190052.0000; val_masked_gp_l1_reg_loss: 63460.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53320.8633; val_chrom_access_recon_loss: 1757842.8281; val_global_loss: 14838584.7500; val_optim_loss: 14838584.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9452; val_auprc_score: 0.9255; val_best_acc_score: 0.8904; val_best_f1_score: 0.8961; train_kl_reg_loss: 51327.0980; train_edge_recon_loss: 2685759.9280; train_gene_expr_recon_loss: 10203278.6970; train_masked_gp_l1_reg_loss: 63410.4428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53238.1565; train_chrom_access_recon_loss: 1779817.8769; train_global_loss: 14836832.2424; train_optim_loss: 14836832.2424; val_kl_reg_loss: 44641.7363; val_edge_recon_loss: 2712504.4688; val_gene_expr_recon_loss: 10181659.6250; val_masked_gp_l1_reg_loss: 63366.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53126.8789; val_chrom_access_recon_loss: 1756464.5312; val_global_loss: 14811764.1250; val_optim_loss: 14811764.1250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9500; val_auprc_score: 0.9239; val_best_acc_score: 0.9009; val_best_f1_score: 0.9052; train_kl_reg_loss: 51362.8865; train_edge_recon_loss: 2681069.6061; train_gene_expr_recon_loss: 10221386.5758; train_masked_gp_l1_reg_loss: 63317.5161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53055.0080; train_chrom_access_recon_loss: 1781874.6288; train_global_loss: 14852066.2273; train_optim_loss: 14852066.2273; val_kl_reg_loss: 44664.9341; val_edge_recon_loss: 2717261.9375; val_gene_expr_recon_loss: 10114501.8750; val_masked_gp_l1_reg_loss: 63270.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52965.1250; val_chrom_access_recon_loss: 1747788.1250; val_global_loss: 14740451.8750; val_optim_loss: 14740451.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9509; val_auprc_score: 0.9334; val_best_acc_score: 0.9003; val_best_f1_score: 0.9048; train_kl_reg_loss: 51322.6176; train_edge_recon_loss: 2685815.9205; train_gene_expr_recon_loss: 10222058.2121; train_masked_gp_l1_reg_loss: 63239.5043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52032.7308; train_chrom_access_recon_loss: 1782198.0625; train_global_loss: 14856667.0000; train_optim_loss: 14856667.0000; val_kl_reg_loss: 44698.1719; val_edge_recon_loss: 2714899.4688; val_gene_expr_recon_loss: 10067172.5000; val_masked_gp_l1_reg_loss: 63224.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51850.8906; val_chrom_access_recon_loss: 1763359.2969; val_global_loss: 14705205.3750; val_optim_loss: 14705205.3750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9474; val_auprc_score: 0.9329; val_best_acc_score: 0.8925; val_best_f1_score: 0.8982; train_kl_reg_loss: 51295.6117; train_edge_recon_loss: 2680747.6553; train_gene_expr_recon_loss: 10213156.3485; train_masked_gp_l1_reg_loss: 63217.3473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51829.1046; train_chrom_access_recon_loss: 1780562.9830; train_global_loss: 14840809.1061; train_optim_loss: 14840809.1061; val_kl_reg_loss: 44303.3970; val_edge_recon_loss: 2735327.8125; val_gene_expr_recon_loss: 10128002.8750; val_masked_gp_l1_reg_loss: 63210.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51811.3125; val_chrom_access_recon_loss: 1745696.7500; val_global_loss: 14768352.0000; val_optim_loss: 14768352.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9463; val_auprc_score: 0.9261; val_best_acc_score: 0.8949; val_best_f1_score: 0.9003; train_kl_reg_loss: 51217.7023; train_edge_recon_loss: 2684188.2083; train_gene_expr_recon_loss: 10206614.9242; train_masked_gp_l1_reg_loss: 63204.1743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51794.9392; train_chrom_access_recon_loss: 1778757.6667; train_global_loss: 14835777.6212; train_optim_loss: 14835777.6212; val_kl_reg_loss: 44684.5386; val_edge_recon_loss: 2726789.6562; val_gene_expr_recon_loss: 10237188.3750; val_masked_gp_l1_reg_loss: 63197.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51777.0625; val_chrom_access_recon_loss: 1752263.2656; val_global_loss: 14875900.8750; val_optim_loss: 14875900.8750
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9430; val_auprc_score: 0.9175; val_best_acc_score: 0.8904; val_best_f1_score: 0.8963; train_kl_reg_loss: 51206.8617; train_edge_recon_loss: 2675814.5985; train_gene_expr_recon_loss: 10203348.4697; train_masked_gp_l1_reg_loss: 63192.0920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51764.6536; train_chrom_access_recon_loss: 1780976.4545; train_global_loss: 14826303.1667; train_optim_loss: 14826303.1667; val_kl_reg_loss: 44421.5210; val_edge_recon_loss: 2738749.7500; val_gene_expr_recon_loss: 10100708.7500; val_masked_gp_l1_reg_loss: 63186.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51749.3047; val_chrom_access_recon_loss: 1754983.0469; val_global_loss: 14753799.0000; val_optim_loss: 14753799.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 38 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9515
val AUPRC score: 0.9307
val best accuracy score: 0.8990
val best F1 score: 0.9037
val target rna MSE score: 2.4441
val source rna MSE score: 1.0568
val target atac MSE score: 0.3137
val source atac MSE score: 0.1293
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
