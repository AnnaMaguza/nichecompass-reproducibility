[True]
Run timestamp: 10102023_003736_88.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_88']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6705; val_auprc_score: 0.6526; val_best_acc_score: 0.5253; val_best_f1_score: 0.6760; train_kl_reg_loss: 52362.2323; train_edge_recon_loss: 3515467.9659; train_gene_expr_recon_loss: 14061288.0303; train_masked_gp_l1_reg_loss: 91660.4957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3009495.0701; train_chrom_access_recon_loss: 6935428.9848; train_global_loss: 27665702.7576; train_optim_loss: 27665702.7576; val_kl_reg_loss: 108717.7656; val_edge_recon_loss: 4064059.8125; val_gene_expr_recon_loss: 13122896.6250; val_masked_gp_l1_reg_loss: 75752.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1720245.3750; val_chrom_access_recon_loss: 6676300.7500; val_global_loss: 25767973.2500; val_optim_loss: 25767973.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6566; val_auprc_score: 0.6482; val_best_acc_score: 0.5752; val_best_f1_score: 0.6850; train_kl_reg_loss: 98996.2183; train_edge_recon_loss: 3523398.3712; train_gene_expr_recon_loss: 12791586.0909; train_masked_gp_l1_reg_loss: 72688.0849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 967301.9044; train_chrom_access_recon_loss: 6579874.9924; train_global_loss: 24033845.7879; train_optim_loss: 24033845.7879; val_kl_reg_loss: 85116.5020; val_edge_recon_loss: 4059606.4375; val_gene_expr_recon_loss: 12915214.7500; val_masked_gp_l1_reg_loss: 71757.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 489795.4062; val_chrom_access_recon_loss: 6672558.2500; val_global_loss: 24294049.7500; val_optim_loss: 24294049.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7470; val_auprc_score: 0.7257; val_best_acc_score: 0.6789; val_best_f1_score: 0.7039; train_kl_reg_loss: 89967.6161; train_edge_recon_loss: 3514482.9015; train_gene_expr_recon_loss: 12659611.2576; train_masked_gp_l1_reg_loss: 71975.3356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 331119.0286; train_chrom_access_recon_loss: 6534739.9242; train_global_loss: 23201895.9697; train_optim_loss: 23201895.9697; val_kl_reg_loss: 83140.5859; val_edge_recon_loss: 4019566.0938; val_gene_expr_recon_loss: 12826570.5000; val_masked_gp_l1_reg_loss: 72876.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 227360.0156; val_chrom_access_recon_loss: 6634391.8125; val_global_loss: 23863905.0000; val_optim_loss: 23863905.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8192; val_auprc_score: 0.7908; val_best_acc_score: 0.7499; val_best_f1_score: 0.7676; train_kl_reg_loss: 72426.4079; train_edge_recon_loss: 3453488.7311; train_gene_expr_recon_loss: 12569556.7121; train_masked_gp_l1_reg_loss: 75076.3216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181668.4032; train_chrom_access_recon_loss: 6490690.4091; train_global_loss: 22842906.9697; train_optim_loss: 22842906.9697; val_kl_reg_loss: 67144.0000; val_edge_recon_loss: 3420543.5938; val_gene_expr_recon_loss: 12726347.2500; val_masked_gp_l1_reg_loss: 78820.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148343.1562; val_chrom_access_recon_loss: 6701509.3750; val_global_loss: 23142707.5000; val_optim_loss: 23142707.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8232; val_auprc_score: 0.7945; val_best_acc_score: 0.7407; val_best_f1_score: 0.7781; train_kl_reg_loss: 78721.1752; train_edge_recon_loss: 3141641.2121; train_gene_expr_recon_loss: 12555647.2424; train_masked_gp_l1_reg_loss: 86764.6805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130064.8726; train_chrom_access_recon_loss: 6492910.1894; train_global_loss: 22485749.2424; train_optim_loss: 22485749.2424; val_kl_reg_loss: 91831.8965; val_edge_recon_loss: 3054713.0000; val_gene_expr_recon_loss: 12761796.0000; val_masked_gp_l1_reg_loss: 90686.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115875.2812; val_chrom_access_recon_loss: 6665802.6250; val_global_loss: 22780705.0000; val_optim_loss: 22780705.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8468; val_auprc_score: 0.8166; val_best_acc_score: 0.7622; val_best_f1_score: 0.7986; train_kl_reg_loss: 99349.8572; train_edge_recon_loss: 2960048.3750; train_gene_expr_recon_loss: 12431582.4091; train_masked_gp_l1_reg_loss: 90985.8370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105781.7309; train_chrom_access_recon_loss: 6427438.3636; train_global_loss: 22115186.5758; train_optim_loss: 22115186.5758; val_kl_reg_loss: 103809.7686; val_edge_recon_loss: 2952292.7812; val_gene_expr_recon_loss: 12532875.0000; val_masked_gp_l1_reg_loss: 92132.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97084.5547; val_chrom_access_recon_loss: 6504226.6875; val_global_loss: 22282422.2500; val_optim_loss: 22282422.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8740; val_auprc_score: 0.8405; val_best_acc_score: 0.8041; val_best_f1_score: 0.8229; train_kl_reg_loss: 99947.5198; train_edge_recon_loss: 2893834.5038; train_gene_expr_recon_loss: 12358705.7727; train_masked_gp_l1_reg_loss: 93306.1372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90596.2895; train_chrom_access_recon_loss: 6397789.6818; train_global_loss: 21934179.7879; train_optim_loss: 21934179.7879; val_kl_reg_loss: 101751.9092; val_edge_recon_loss: 2901122.2188; val_gene_expr_recon_loss: 12413333.1250; val_masked_gp_l1_reg_loss: 94641.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85173.2109; val_chrom_access_recon_loss: 6443284.5625; val_global_loss: 22039307.0000; val_optim_loss: 22039307.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8822; val_auprc_score: 0.8471; val_best_acc_score: 0.8160; val_best_f1_score: 0.8301; train_kl_reg_loss: 100083.5838; train_edge_recon_loss: 2846268.6553; train_gene_expr_recon_loss: 12300697.5909; train_masked_gp_l1_reg_loss: 95604.0095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81635.0915; train_chrom_access_recon_loss: 6374127.2121; train_global_loss: 21798416.1515; train_optim_loss: 21798416.1515; val_kl_reg_loss: 100046.0254; val_edge_recon_loss: 2918124.8438; val_gene_expr_recon_loss: 12518051.7500; val_masked_gp_l1_reg_loss: 96841.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78751.8281; val_chrom_access_recon_loss: 6498677.8750; val_global_loss: 22210494.2500; val_optim_loss: 22210494.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9080; val_auprc_score: 0.8717; val_best_acc_score: 0.8471; val_best_f1_score: 0.8578; train_kl_reg_loss: 99822.0850; train_edge_recon_loss: 2834817.0152; train_gene_expr_recon_loss: 12238459.6970; train_masked_gp_l1_reg_loss: 97753.0920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76917.7042; train_chrom_access_recon_loss: 6346514.6364; train_global_loss: 21694284.3333; train_optim_loss: 21694284.3333; val_kl_reg_loss: 101414.3486; val_edge_recon_loss: 2795744.7500; val_gene_expr_recon_loss: 12409365.0000; val_masked_gp_l1_reg_loss: 98973.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75469.6719; val_chrom_access_recon_loss: 6402672.3750; val_global_loss: 21883640.0000; val_optim_loss: 21883640.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9028; val_auprc_score: 0.8736; val_best_acc_score: 0.8377; val_best_f1_score: 0.8497; train_kl_reg_loss: 100385.3899; train_edge_recon_loss: 2821050.9015; train_gene_expr_recon_loss: 12181182.2576; train_masked_gp_l1_reg_loss: 99633.4543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73756.8112; train_chrom_access_recon_loss: 6319843.2197; train_global_loss: 21595852.0000; train_optim_loss: 21595852.0000; val_kl_reg_loss: 106899.7969; val_edge_recon_loss: 2839629.0000; val_gene_expr_recon_loss: 12411504.8750; val_masked_gp_l1_reg_loss: 100425.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72189.0234; val_chrom_access_recon_loss: 6449779.5625; val_global_loss: 21980428.0000; val_optim_loss: 21980428.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9090; val_auprc_score: 0.8767; val_best_acc_score: 0.8517; val_best_f1_score: 0.8602; train_kl_reg_loss: 99354.8751; train_edge_recon_loss: 2794016.4432; train_gene_expr_recon_loss: 12130354.3030; train_masked_gp_l1_reg_loss: 101198.0084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70805.4218; train_chrom_access_recon_loss: 6295883.0606; train_global_loss: 21491612.1212; train_optim_loss: 21491612.1212; val_kl_reg_loss: 98346.7988; val_edge_recon_loss: 2807566.0000; val_gene_expr_recon_loss: 12278050.0000; val_masked_gp_l1_reg_loss: 102197.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69875.6016; val_chrom_access_recon_loss: 6367744.5625; val_global_loss: 21723780.5000; val_optim_loss: 21723780.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9024; val_auprc_score: 0.8681; val_best_acc_score: 0.8455; val_best_f1_score: 0.8539; train_kl_reg_loss: 97620.4664; train_edge_recon_loss: 2794510.1705; train_gene_expr_recon_loss: 12086230.8636; train_masked_gp_l1_reg_loss: 102718.7807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68437.4448; train_chrom_access_recon_loss: 6272900.1591; train_global_loss: 21422417.8485; train_optim_loss: 21422417.8485; val_kl_reg_loss: 98096.1299; val_edge_recon_loss: 2838769.3750; val_gene_expr_recon_loss: 12307806.6250; val_masked_gp_l1_reg_loss: 103312.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67589.3594; val_chrom_access_recon_loss: 6408021.8750; val_global_loss: 21823595.0000; val_optim_loss: 21823595.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9116; val_auprc_score: 0.8818; val_best_acc_score: 0.8533; val_best_f1_score: 0.8585; train_kl_reg_loss: 94677.8950; train_edge_recon_loss: 2791659.3409; train_gene_expr_recon_loss: 12041569.0606; train_masked_gp_l1_reg_loss: 103743.6568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66465.9370; train_chrom_access_recon_loss: 6254917.2652; train_global_loss: 21353033.1212; train_optim_loss: 21353033.1212; val_kl_reg_loss: 94735.2246; val_edge_recon_loss: 2850847.3438; val_gene_expr_recon_loss: 12258383.3750; val_masked_gp_l1_reg_loss: 104476.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66120.3828; val_chrom_access_recon_loss: 6368034.0000; val_global_loss: 21742597.2500; val_optim_loss: 21742597.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9088; val_auprc_score: 0.8775; val_best_acc_score: 0.8565; val_best_f1_score: 0.8636; train_kl_reg_loss: 93298.9998; train_edge_recon_loss: 2769929.4583; train_gene_expr_recon_loss: 12004277.2424; train_masked_gp_l1_reg_loss: 104991.2957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65144.9658; train_chrom_access_recon_loss: 6236945.1515; train_global_loss: 21274587.1818; train_optim_loss: 21274587.1818; val_kl_reg_loss: 95056.8486; val_edge_recon_loss: 2821510.9688; val_gene_expr_recon_loss: 12232748.3750; val_masked_gp_l1_reg_loss: 105395.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64367.0547; val_chrom_access_recon_loss: 6327191.3125; val_global_loss: 21646271.2500; val_optim_loss: 21646271.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9176; val_auprc_score: 0.8877; val_best_acc_score: 0.8614; val_best_f1_score: 0.8668; train_kl_reg_loss: 92031.0262; train_edge_recon_loss: 2779300.9735; train_gene_expr_recon_loss: 11980461.9394; train_masked_gp_l1_reg_loss: 105784.1501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64094.8258; train_chrom_access_recon_loss: 6219169.2424; train_global_loss: 21240842.1212; train_optim_loss: 21240842.1212; val_kl_reg_loss: 92847.7832; val_edge_recon_loss: 2790714.4688; val_gene_expr_recon_loss: 12072614.1250; val_masked_gp_l1_reg_loss: 106361.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63987.8594; val_chrom_access_recon_loss: 6291137.1250; val_global_loss: 21417662.7500; val_optim_loss: 21417662.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9134; val_auprc_score: 0.8782; val_best_acc_score: 0.8587; val_best_f1_score: 0.8696; train_kl_reg_loss: 90306.9566; train_edge_recon_loss: 2765073.4242; train_gene_expr_recon_loss: 11937206.2424; train_masked_gp_l1_reg_loss: 106610.2132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63578.4305; train_chrom_access_recon_loss: 6203268.3636; train_global_loss: 21166043.6667; train_optim_loss: 21166043.6667; val_kl_reg_loss: 88791.4814; val_edge_recon_loss: 2788002.5625; val_gene_expr_recon_loss: 12106633.0000; val_masked_gp_l1_reg_loss: 107137.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63723.2578; val_chrom_access_recon_loss: 6314612.0625; val_global_loss: 21468900.0000; val_optim_loss: 21468900.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9238; val_auprc_score: 0.8988; val_best_acc_score: 0.8622; val_best_f1_score: 0.8705; train_kl_reg_loss: 90094.0303; train_edge_recon_loss: 2763217.8561; train_gene_expr_recon_loss: 11895029.9848; train_masked_gp_l1_reg_loss: 107409.3213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63144.2672; train_chrom_access_recon_loss: 6177948.4924; train_global_loss: 21096843.9697; train_optim_loss: 21096843.9697; val_kl_reg_loss: 92880.9414; val_edge_recon_loss: 2753799.5938; val_gene_expr_recon_loss: 12085733.8750; val_masked_gp_l1_reg_loss: 107603.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63049.5156; val_chrom_access_recon_loss: 6243029.0000; val_global_loss: 21346096.2500; val_optim_loss: 21346096.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9172; val_auprc_score: 0.8912; val_best_acc_score: 0.8552; val_best_f1_score: 0.8640; train_kl_reg_loss: 90321.8732; train_edge_recon_loss: 2757401.4697; train_gene_expr_recon_loss: 11872807.3333; train_masked_gp_l1_reg_loss: 107898.1468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62830.5225; train_chrom_access_recon_loss: 6169229.6591; train_global_loss: 21060488.9697; train_optim_loss: 21060488.9697; val_kl_reg_loss: 91346.0469; val_edge_recon_loss: 2809413.1875; val_gene_expr_recon_loss: 12059946.0000; val_masked_gp_l1_reg_loss: 108366.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62757.1445; val_chrom_access_recon_loss: 6332574.1250; val_global_loss: 21464402.2500; val_optim_loss: 21464402.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9192; val_auprc_score: 0.8921; val_best_acc_score: 0.8627; val_best_f1_score: 0.8691; train_kl_reg_loss: 89604.8268; train_edge_recon_loss: 2747070.4280; train_gene_expr_recon_loss: 11848273.2273; train_masked_gp_l1_reg_loss: 108490.0593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62563.7330; train_chrom_access_recon_loss: 6154396.2045; train_global_loss: 21010398.4545; train_optim_loss: 21010398.4545; val_kl_reg_loss: 90991.4443; val_edge_recon_loss: 2786813.8125; val_gene_expr_recon_loss: 12032835.3750; val_masked_gp_l1_reg_loss: 108714.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62857.3320; val_chrom_access_recon_loss: 6350392.5625; val_global_loss: 21432604.5000; val_optim_loss: 21432604.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9191; val_auprc_score: 0.8900; val_best_acc_score: 0.8616; val_best_f1_score: 0.8708; train_kl_reg_loss: 87502.2350; train_edge_recon_loss: 2749216.2197; train_gene_expr_recon_loss: 11826627.2121; train_masked_gp_l1_reg_loss: 108831.6482; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62403.4489; train_chrom_access_recon_loss: 6144176.9015; train_global_loss: 20978757.7879; train_optim_loss: 20978757.7879; val_kl_reg_loss: 89729.7979; val_edge_recon_loss: 2834063.5625; val_gene_expr_recon_loss: 12049498.1250; val_masked_gp_l1_reg_loss: 108873.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61854.1523; val_chrom_access_recon_loss: 6318599.9375; val_global_loss: 21462618.5000; val_optim_loss: 21462618.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9235; val_auprc_score: 0.8986; val_best_acc_score: 0.8611; val_best_f1_score: 0.8702; train_kl_reg_loss: 88055.2150; train_edge_recon_loss: 2747280.5152; train_gene_expr_recon_loss: 11791846.5758; train_masked_gp_l1_reg_loss: 109224.4786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61637.1009; train_chrom_access_recon_loss: 6122206.6894; train_global_loss: 20920250.6061; train_optim_loss: 20920250.6061; val_kl_reg_loss: 90324.3477; val_edge_recon_loss: 2786967.1875; val_gene_expr_recon_loss: 11965643.3750; val_masked_gp_l1_reg_loss: 109417.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61529.7188; val_chrom_access_recon_loss: 6269937.4375; val_global_loss: 21283819.2500; val_optim_loss: 21283819.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9322; val_auprc_score: 0.9083; val_best_acc_score: 0.8751; val_best_f1_score: 0.8809; train_kl_reg_loss: 87746.0323; train_edge_recon_loss: 2753267.9583; train_gene_expr_recon_loss: 11764512.1364; train_masked_gp_l1_reg_loss: 109490.6542; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61310.4315; train_chrom_access_recon_loss: 6111536.8561; train_global_loss: 20887864.2727; train_optim_loss: 20887864.2727; val_kl_reg_loss: 82136.0664; val_edge_recon_loss: 2773111.0312; val_gene_expr_recon_loss: 11894632.5000; val_masked_gp_l1_reg_loss: 109674.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61445.8086; val_chrom_access_recon_loss: 6213747.5625; val_global_loss: 21134746.5000; val_optim_loss: 21134746.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9246; val_auprc_score: 0.8970; val_best_acc_score: 0.8638; val_best_f1_score: 0.8721; train_kl_reg_loss: 85711.7202; train_edge_recon_loss: 2740591.4470; train_gene_expr_recon_loss: 11754211.5303; train_masked_gp_l1_reg_loss: 109736.6876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60919.0205; train_chrom_access_recon_loss: 6106959.0379; train_global_loss: 20858129.3636; train_optim_loss: 20858129.3636; val_kl_reg_loss: 86749.1816; val_edge_recon_loss: 2775304.2812; val_gene_expr_recon_loss: 11848759.6250; val_masked_gp_l1_reg_loss: 110119.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61124.7070; val_chrom_access_recon_loss: 6145271.4375; val_global_loss: 21027329.5000; val_optim_loss: 21027329.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9335; val_auprc_score: 0.9045; val_best_acc_score: 0.8804; val_best_f1_score: 0.8882; train_kl_reg_loss: 85865.4039; train_edge_recon_loss: 2731075.0492; train_gene_expr_recon_loss: 11724246.4242; train_masked_gp_l1_reg_loss: 110223.7511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60717.9398; train_chrom_access_recon_loss: 6089350.2348; train_global_loss: 20801478.9091; train_optim_loss: 20801478.9091; val_kl_reg_loss: 87487.6426; val_edge_recon_loss: 2762368.4375; val_gene_expr_recon_loss: 11979353.6250; val_masked_gp_l1_reg_loss: 110446.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60527.6172; val_chrom_access_recon_loss: 6217283.3125; val_global_loss: 21217468.0000; val_optim_loss: 21217468.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9400; val_auprc_score: 0.9191; val_best_acc_score: 0.8842; val_best_f1_score: 0.8908; train_kl_reg_loss: 84366.4763; train_edge_recon_loss: 2727352.9735; train_gene_expr_recon_loss: 11700973.0909; train_masked_gp_l1_reg_loss: 110578.1974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60459.2437; train_chrom_access_recon_loss: 6074991.5985; train_global_loss: 20758721.6364; train_optim_loss: 20758721.6364; val_kl_reg_loss: 88330.0195; val_edge_recon_loss: 2742229.8750; val_gene_expr_recon_loss: 11892430.7500; val_masked_gp_l1_reg_loss: 110735.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60516.3203; val_chrom_access_recon_loss: 6157518.6250; val_global_loss: 21051761.2500; val_optim_loss: 21051761.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9432; val_auprc_score: 0.9201; val_best_acc_score: 0.8898; val_best_f1_score: 0.8942; train_kl_reg_loss: 85437.7406; train_edge_recon_loss: 2719606.9735; train_gene_expr_recon_loss: 11682418.4091; train_masked_gp_l1_reg_loss: 110805.8106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60016.0325; train_chrom_access_recon_loss: 6056581.8333; train_global_loss: 20714866.8485; train_optim_loss: 20714866.8485; val_kl_reg_loss: 86259.1436; val_edge_recon_loss: 2748845.8125; val_gene_expr_recon_loss: 11922846.0000; val_masked_gp_l1_reg_loss: 111015.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60111.6406; val_chrom_access_recon_loss: 6215559.1875; val_global_loss: 21144636.7500; val_optim_loss: 21144636.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9443; val_auprc_score: 0.9197; val_best_acc_score: 0.8915; val_best_f1_score: 0.8952; train_kl_reg_loss: 84056.3369; train_edge_recon_loss: 2712969.4394; train_gene_expr_recon_loss: 11663640.1970; train_masked_gp_l1_reg_loss: 111010.6342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59798.4934; train_chrom_access_recon_loss: 6046023.9773; train_global_loss: 20677499.1212; train_optim_loss: 20677499.1212; val_kl_reg_loss: 85080.9990; val_edge_recon_loss: 2732610.2812; val_gene_expr_recon_loss: 11827098.5000; val_masked_gp_l1_reg_loss: 111184.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59517.4648; val_chrom_access_recon_loss: 6169235.4375; val_global_loss: 20984726.2500; val_optim_loss: 20984726.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9441; val_auprc_score: 0.9194; val_best_acc_score: 0.8855; val_best_f1_score: 0.8921; train_kl_reg_loss: 83710.6881; train_edge_recon_loss: 2712620.5871; train_gene_expr_recon_loss: 11652353.6515; train_masked_gp_l1_reg_loss: 111179.2769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59475.2195; train_chrom_access_recon_loss: 6038061.8106; train_global_loss: 20657401.0000; train_optim_loss: 20657401.0000; val_kl_reg_loss: 80095.9580; val_edge_recon_loss: 2762827.8438; val_gene_expr_recon_loss: 11818727.8750; val_masked_gp_l1_reg_loss: 111233.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59451.7461; val_chrom_access_recon_loss: 6142441.5625; val_global_loss: 20974779.0000; val_optim_loss: 20974779.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9452; val_auprc_score: 0.9265; val_best_acc_score: 0.8842; val_best_f1_score: 0.8921; train_kl_reg_loss: 84721.0683; train_edge_recon_loss: 2712509.3409; train_gene_expr_recon_loss: 11632138.3333; train_masked_gp_l1_reg_loss: 111229.8108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59158.7729; train_chrom_access_recon_loss: 6023960.3939; train_global_loss: 20623717.6970; train_optim_loss: 20623717.6970; val_kl_reg_loss: 85960.8945; val_edge_recon_loss: 2743375.7500; val_gene_expr_recon_loss: 11808915.0000; val_masked_gp_l1_reg_loss: 111371.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59414.3242; val_chrom_access_recon_loss: 6138670.7500; val_global_loss: 20947708.0000; val_optim_loss: 20947708.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9463; val_auprc_score: 0.9300; val_best_acc_score: 0.8888; val_best_f1_score: 0.8969; train_kl_reg_loss: 83660.9332; train_edge_recon_loss: 2708904.5455; train_gene_expr_recon_loss: 11610150.7576; train_masked_gp_l1_reg_loss: 111338.6838; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59167.3965; train_chrom_access_recon_loss: 6012795.9318; train_global_loss: 20586018.3030; train_optim_loss: 20586018.3030; val_kl_reg_loss: 83865.4717; val_edge_recon_loss: 2746751.8125; val_gene_expr_recon_loss: 11886996.7500; val_masked_gp_l1_reg_loss: 111436.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59229.8594; val_chrom_access_recon_loss: 6117491.3750; val_global_loss: 21005773.2500; val_optim_loss: 21005773.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9470; val_auprc_score: 0.9218; val_best_acc_score: 0.8958; val_best_f1_score: 0.9003; train_kl_reg_loss: 83247.9375; train_edge_recon_loss: 2718685.7538; train_gene_expr_recon_loss: 11590036.5909; train_masked_gp_l1_reg_loss: 111324.1926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58934.8844; train_chrom_access_recon_loss: 5999070.0530; train_global_loss: 20561299.4848; train_optim_loss: 20561299.4848; val_kl_reg_loss: 84206.4023; val_edge_recon_loss: 2727661.5000; val_gene_expr_recon_loss: 11842474.6250; val_masked_gp_l1_reg_loss: 111084.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58791.4531; val_chrom_access_recon_loss: 6132059.6875; val_global_loss: 20956278.0000; val_optim_loss: 20956278.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9473; val_auprc_score: 0.9300; val_best_acc_score: 0.8901; val_best_f1_score: 0.8955; train_kl_reg_loss: 82652.3957; train_edge_recon_loss: 2708045.7386; train_gene_expr_recon_loss: 11581222.4394; train_masked_gp_l1_reg_loss: 111205.3129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58632.9877; train_chrom_access_recon_loss: 5988641.2652; train_global_loss: 20530400.0000; train_optim_loss: 20530400.0000; val_kl_reg_loss: 84383.5400; val_edge_recon_loss: 2753840.5625; val_gene_expr_recon_loss: 11761300.1250; val_masked_gp_l1_reg_loss: 111557.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58774.2461; val_chrom_access_recon_loss: 6123177.6250; val_global_loss: 20893032.5000; val_optim_loss: 20893032.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9549; val_auprc_score: 0.9415; val_best_acc_score: 0.8931; val_best_f1_score: 0.8982; train_kl_reg_loss: 81950.6687; train_edge_recon_loss: 2707391.5189; train_gene_expr_recon_loss: 11563021.9545; train_masked_gp_l1_reg_loss: 111342.0852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58576.7640; train_chrom_access_recon_loss: 5976593.9697; train_global_loss: 20498877.0000; train_optim_loss: 20498877.0000; val_kl_reg_loss: 84949.6846; val_edge_recon_loss: 2736655.5625; val_gene_expr_recon_loss: 11715239.0000; val_masked_gp_l1_reg_loss: 111516.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58793.6953; val_chrom_access_recon_loss: 6055338.6875; val_global_loss: 20762494.2500; val_optim_loss: 20762494.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9533; val_auprc_score: 0.9356; val_best_acc_score: 0.8974; val_best_f1_score: 0.9015; train_kl_reg_loss: 84197.9272; train_edge_recon_loss: 2703678.5720; train_gene_expr_recon_loss: 11548298.6667; train_masked_gp_l1_reg_loss: 111352.9624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58405.2162; train_chrom_access_recon_loss: 5963339.5606; train_global_loss: 20469272.8788; train_optim_loss: 20469272.8788; val_kl_reg_loss: 84822.3154; val_edge_recon_loss: 2739159.2500; val_gene_expr_recon_loss: 11741260.3750; val_masked_gp_l1_reg_loss: 111244.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58410.5195; val_chrom_access_recon_loss: 6107447.5625; val_global_loss: 20842345.7500; val_optim_loss: 20842345.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9588; val_auprc_score: 0.9501; val_best_acc_score: 0.9027; val_best_f1_score: 0.9069; train_kl_reg_loss: 81553.4098; train_edge_recon_loss: 2704067.8333; train_gene_expr_recon_loss: 11548642.8788; train_masked_gp_l1_reg_loss: 111215.7691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58347.4893; train_chrom_access_recon_loss: 5954697.8030; train_global_loss: 20458524.9697; train_optim_loss: 20458524.9697; val_kl_reg_loss: 84279.6006; val_edge_recon_loss: 2705013.3438; val_gene_expr_recon_loss: 11744036.3750; val_masked_gp_l1_reg_loss: 111245.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58350.8711; val_chrom_access_recon_loss: 6150286.3750; val_global_loss: 20853212.2500; val_optim_loss: 20853212.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9516; val_auprc_score: 0.9295; val_best_acc_score: 0.8949; val_best_f1_score: 0.8990; train_kl_reg_loss: 82880.0372; train_edge_recon_loss: 2700506.3977; train_gene_expr_recon_loss: 11527968.4697; train_masked_gp_l1_reg_loss: 111241.3310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58157.4252; train_chrom_access_recon_loss: 5947511.8258; train_global_loss: 20428265.4848; train_optim_loss: 20428265.4848; val_kl_reg_loss: 81065.3965; val_edge_recon_loss: 2727251.0312; val_gene_expr_recon_loss: 11797196.1250; val_masked_gp_l1_reg_loss: 111214.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58333.8555; val_chrom_access_recon_loss: 6087151.5000; val_global_loss: 20862212.0000; val_optim_loss: 20862212.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9573; val_auprc_score: 0.9442; val_best_acc_score: 0.9006; val_best_f1_score: 0.9039; train_kl_reg_loss: 81276.8919; train_edge_recon_loss: 2699216.5682; train_gene_expr_recon_loss: 11513116.0152; train_masked_gp_l1_reg_loss: 111115.2556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58206.7620; train_chrom_access_recon_loss: 5934740.6818; train_global_loss: 20397672.2727; train_optim_loss: 20397672.2727; val_kl_reg_loss: 85590.7705; val_edge_recon_loss: 2718166.8750; val_gene_expr_recon_loss: 11685241.3750; val_masked_gp_l1_reg_loss: 111401.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58175.7578; val_chrom_access_recon_loss: 6071336.1875; val_global_loss: 20729912.5000; val_optim_loss: 20729912.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9580; val_auprc_score: 0.9434; val_best_acc_score: 0.9054; val_best_f1_score: 0.9096; train_kl_reg_loss: 80362.8999; train_edge_recon_loss: 2700745.1136; train_gene_expr_recon_loss: 11500833.8939; train_masked_gp_l1_reg_loss: 111213.2215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58077.9521; train_chrom_access_recon_loss: 5924481.7197; train_global_loss: 20375714.7273; train_optim_loss: 20375714.7273; val_kl_reg_loss: 82694.6875; val_edge_recon_loss: 2715264.4062; val_gene_expr_recon_loss: 11799510.2500; val_masked_gp_l1_reg_loss: 111324.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58421.6406; val_chrom_access_recon_loss: 6128264.4375; val_global_loss: 20895479.7500; val_optim_loss: 20895479.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9575; val_auprc_score: 0.9391; val_best_acc_score: 0.9052; val_best_f1_score: 0.9088; train_kl_reg_loss: 81836.1631; train_edge_recon_loss: 2687206.2159; train_gene_expr_recon_loss: 11484366.4394; train_masked_gp_l1_reg_loss: 111262.3131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58224.7341; train_chrom_access_recon_loss: 5910901.0909; train_global_loss: 20333796.9394; train_optim_loss: 20333796.9394; val_kl_reg_loss: 81881.7598; val_edge_recon_loss: 2710561.3750; val_gene_expr_recon_loss: 11763628.5000; val_masked_gp_l1_reg_loss: 111383.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58253.2227; val_chrom_access_recon_loss: 6100916.5625; val_global_loss: 20826625.5000; val_optim_loss: 20826625.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9537; val_auprc_score: 0.9354; val_best_acc_score: 0.9003; val_best_f1_score: 0.9050; train_kl_reg_loss: 80577.5082; train_edge_recon_loss: 2691246.9545; train_gene_expr_recon_loss: 11463390.6818; train_masked_gp_l1_reg_loss: 111234.9702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58063.6598; train_chrom_access_recon_loss: 5897117.6818; train_global_loss: 20301631.5455; train_optim_loss: 20301631.5455; val_kl_reg_loss: 79071.1982; val_edge_recon_loss: 2741956.6562; val_gene_expr_recon_loss: 11693373.6250; val_masked_gp_l1_reg_loss: 111234.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58342.7500; val_chrom_access_recon_loss: 6121407.0000; val_global_loss: 20805385.5000; val_optim_loss: 20805385.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9636; val_auprc_score: 0.9517; val_best_acc_score: 0.9111; val_best_f1_score: 0.9143; train_kl_reg_loss: 79533.7622; train_edge_recon_loss: 2688614.8220; train_gene_expr_recon_loss: 11457410.8485; train_masked_gp_l1_reg_loss: 111231.8150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58307.9050; train_chrom_access_recon_loss: 5884651.1364; train_global_loss: 20279750.3333; train_optim_loss: 20279750.3333; val_kl_reg_loss: 80128.8818; val_edge_recon_loss: 2721117.4688; val_gene_expr_recon_loss: 11729657.0000; val_masked_gp_l1_reg_loss: 111182.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58216.5352; val_chrom_access_recon_loss: 6013607.3750; val_global_loss: 20713909.5000; val_optim_loss: 20713909.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9615; val_auprc_score: 0.9490; val_best_acc_score: 0.9097; val_best_f1_score: 0.9119; train_kl_reg_loss: 80768.8743; train_edge_recon_loss: 2693559.2424; train_gene_expr_recon_loss: 11453111.1364; train_masked_gp_l1_reg_loss: 111194.3670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58018.8449; train_chrom_access_recon_loss: 5874632.9924; train_global_loss: 20271285.2727; train_optim_loss: 20271285.2727; val_kl_reg_loss: 81500.2920; val_edge_recon_loss: 2730127.1875; val_gene_expr_recon_loss: 11592063.5000; val_masked_gp_l1_reg_loss: 111205.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58196.5078; val_chrom_access_recon_loss: 6012021.8125; val_global_loss: 20585115.0000; val_optim_loss: 20585115.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9615; val_auprc_score: 0.9500; val_best_acc_score: 0.9084; val_best_f1_score: 0.9113; train_kl_reg_loss: 80498.8217; train_edge_recon_loss: 2695554.7689; train_gene_expr_recon_loss: 11442814.1818; train_masked_gp_l1_reg_loss: 111086.2337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58180.5268; train_chrom_access_recon_loss: 5866270.4545; train_global_loss: 20254404.9394; train_optim_loss: 20254404.9394; val_kl_reg_loss: 77390.3203; val_edge_recon_loss: 2725390.4375; val_gene_expr_recon_loss: 11540156.1250; val_masked_gp_l1_reg_loss: 111157.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58423.2344; val_chrom_access_recon_loss: 5952362.0000; val_global_loss: 20464879.2500; val_optim_loss: 20464879.2500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9555; val_auprc_score: 0.9378; val_best_acc_score: 0.9103; val_best_f1_score: 0.9139; train_kl_reg_loss: 78892.2140; train_edge_recon_loss: 2695634.2462; train_gene_expr_recon_loss: 11433703.2879; train_masked_gp_l1_reg_loss: 111017.2390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58450.4316; train_chrom_access_recon_loss: 5861589.8636; train_global_loss: 20239287.2727; train_optim_loss: 20239287.2727; val_kl_reg_loss: 82230.1279; val_edge_recon_loss: 2719996.7188; val_gene_expr_recon_loss: 11616655.2500; val_masked_gp_l1_reg_loss: 110938.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58431.0625; val_chrom_access_recon_loss: 6008286.8750; val_global_loss: 20596539.0000; val_optim_loss: 20596539.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9607; val_auprc_score: 0.9447; val_best_acc_score: 0.9087; val_best_f1_score: 0.9134; train_kl_reg_loss: 79453.7522; train_edge_recon_loss: 2699505.4356; train_gene_expr_recon_loss: 11429287.7879; train_masked_gp_l1_reg_loss: 110886.5468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58257.9719; train_chrom_access_recon_loss: 5849598.5530; train_global_loss: 20226989.9394; train_optim_loss: 20226989.9394; val_kl_reg_loss: 78166.6670; val_edge_recon_loss: 2715217.8125; val_gene_expr_recon_loss: 11720271.7500; val_masked_gp_l1_reg_loss: 111099.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58683.5469; val_chrom_access_recon_loss: 6045457.8125; val_global_loss: 20728898.5000; val_optim_loss: 20728898.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9631; val_auprc_score: 0.9502; val_best_acc_score: 0.9154; val_best_f1_score: 0.9189; train_kl_reg_loss: 78577.0489; train_edge_recon_loss: 2689960.6894; train_gene_expr_recon_loss: 11415415.8788; train_masked_gp_l1_reg_loss: 110896.9579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58516.9476; train_chrom_access_recon_loss: 5840734.3939; train_global_loss: 20194101.6970; train_optim_loss: 20194101.6970; val_kl_reg_loss: 78999.7344; val_edge_recon_loss: 2724951.1250; val_gene_expr_recon_loss: 11582347.6250; val_masked_gp_l1_reg_loss: 110793.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58447.6055; val_chrom_access_recon_loss: 5923023.8750; val_global_loss: 20478564.2500; val_optim_loss: 20478564.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9636; val_auprc_score: 0.9444; val_best_acc_score: 0.9148; val_best_f1_score: 0.9187; train_kl_reg_loss: 79363.1448; train_edge_recon_loss: 2683155.3939; train_gene_expr_recon_loss: 11407019.5606; train_masked_gp_l1_reg_loss: 110748.2836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58542.8042; train_chrom_access_recon_loss: 5834758.7652; train_global_loss: 20173587.9697; train_optim_loss: 20173587.9697; val_kl_reg_loss: 80320.3066; val_edge_recon_loss: 2712924.6250; val_gene_expr_recon_loss: 11734010.1250; val_masked_gp_l1_reg_loss: 110779.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58706.2305; val_chrom_access_recon_loss: 6033887.3750; val_global_loss: 20730628.2500; val_optim_loss: 20730628.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9610; val_auprc_score: 0.9471; val_best_acc_score: 0.9095; val_best_f1_score: 0.9139; train_kl_reg_loss: 79594.4318; train_edge_recon_loss: 2682950.1364; train_gene_expr_recon_loss: 11405659.8485; train_masked_gp_l1_reg_loss: 107815.2739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48242.2754; train_chrom_access_recon_loss: 5831007.0076; train_global_loss: 20155268.9091; train_optim_loss: 20155268.9091; val_kl_reg_loss: 81248.6133; val_edge_recon_loss: 2725485.0312; val_gene_expr_recon_loss: 11633444.6250; val_masked_gp_l1_reg_loss: 106721.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45797.1953; val_chrom_access_recon_loss: 6000646.5000; val_global_loss: 20593342.7500; val_optim_loss: 20593342.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9610; val_auprc_score: 0.9421; val_best_acc_score: 0.9167; val_best_f1_score: 0.9207; train_kl_reg_loss: 80307.6706; train_edge_recon_loss: 2676999.9735; train_gene_expr_recon_loss: 11395587.0455; train_masked_gp_l1_reg_loss: 106565.4413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45527.2435; train_chrom_access_recon_loss: 5816192.3333; train_global_loss: 20121179.6667; train_optim_loss: 20121179.6667; val_kl_reg_loss: 81674.8125; val_edge_recon_loss: 2713552.4062; val_gene_expr_recon_loss: 11614417.2500; val_masked_gp_l1_reg_loss: 106448.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45297.3867; val_chrom_access_recon_loss: 5991271.0625; val_global_loss: 20552661.5000; val_optim_loss: 20552661.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9625; val_auprc_score: 0.9495; val_best_acc_score: 0.9140; val_best_f1_score: 0.9177; train_kl_reg_loss: 80785.2930; train_edge_recon_loss: 2685854.8636; train_gene_expr_recon_loss: 11385721.2576; train_masked_gp_l1_reg_loss: 106414.6004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45192.1155; train_chrom_access_recon_loss: 5808888.6288; train_global_loss: 20112856.6061; train_optim_loss: 20112856.6061; val_kl_reg_loss: 82395.5693; val_edge_recon_loss: 2715335.3125; val_gene_expr_recon_loss: 11649843.7500; val_masked_gp_l1_reg_loss: 106362.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45052.0352; val_chrom_access_recon_loss: 6039716.4375; val_global_loss: 20638706.2500; val_optim_loss: 20638706.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9683; val_auprc_score: 0.9591; val_best_acc_score: 0.9159; val_best_f1_score: 0.9195; train_kl_reg_loss: 80755.6921; train_edge_recon_loss: 2682314.2652; train_gene_expr_recon_loss: 11391919.7879; train_masked_gp_l1_reg_loss: 106341.9280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44952.9455; train_chrom_access_recon_loss: 5812923.0909; train_global_loss: 20119207.7273; train_optim_loss: 20119207.7273; val_kl_reg_loss: 82125.6729; val_edge_recon_loss: 2702737.0625; val_gene_expr_recon_loss: 11598869.2500; val_masked_gp_l1_reg_loss: 106321.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44888.8555; val_chrom_access_recon_loss: 5995396.6875; val_global_loss: 20530339.7500; val_optim_loss: 20530339.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 17 min 25 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9572
val AUPRC score: 0.9405
val best accuracy score: 0.9054
val best F1 score: 0.9095
val target rna MSE score: 1.3736
val source rna MSE score: 0.7477
val target atac MSE score: 0.3354
val source atac MSE score: 0.1331
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
