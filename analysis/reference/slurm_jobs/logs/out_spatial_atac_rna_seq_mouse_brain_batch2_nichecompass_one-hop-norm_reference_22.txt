[True]
Run timestamp: 09102023_201703_22.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_22']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7653; val_auprc_score: 0.7881; val_best_acc_score: 0.5323; val_best_f1_score: 0.6779; train_kl_reg_loss: 66284.5690; train_edge_recon_loss: 3503787.4924; train_gene_expr_recon_loss: 13361297.2595; train_masked_gp_l1_reg_loss: 85069.5854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1983439.3347; train_chrom_access_recon_loss: 2257262.9036; train_global_loss: 21257141.0382; train_optim_loss: 21257141.0382; val_kl_reg_loss: 80451.7896; val_edge_recon_loss: 4062796.3500; val_gene_expr_recon_loss: 12670241.6667; val_masked_gp_l1_reg_loss: 76014.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 472482.1250; val_chrom_access_recon_loss: 2199834.7750; val_global_loss: 19561821.3333; val_optim_loss: 19561821.3333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8058; val_auprc_score: 0.8197; val_best_acc_score: 0.7156; val_best_f1_score: 0.7173; train_kl_reg_loss: 77615.0978; train_edge_recon_loss: 3497361.0344; train_gene_expr_recon_loss: 12555577.8473; train_masked_gp_l1_reg_loss: 75791.3115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 243207.8570; train_chrom_access_recon_loss: 2164395.6384; train_global_loss: 18613948.8397; train_optim_loss: 18613948.8397; val_kl_reg_loss: 63003.1740; val_edge_recon_loss: 3996617.1167; val_gene_expr_recon_loss: 12555290.0667; val_masked_gp_l1_reg_loss: 77772.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135759.5156; val_chrom_access_recon_loss: 2178634.3750; val_global_loss: 19007077.4667; val_optim_loss: 19007077.4667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8447; val_auprc_score: 0.8483; val_best_acc_score: 0.7479; val_best_f1_score: 0.7700; train_kl_reg_loss: 71831.4543; train_edge_recon_loss: 3244661.4370; train_gene_expr_recon_loss: 12432934.6183; train_masked_gp_l1_reg_loss: 85028.2360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108367.3171; train_chrom_access_recon_loss: 2144335.7777; train_global_loss: 18087158.7863; train_optim_loss: 18087158.7863; val_kl_reg_loss: 92034.4974; val_edge_recon_loss: 3084246.2500; val_gene_expr_recon_loss: 12419683.8667; val_masked_gp_l1_reg_loss: 92185.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93128.9766; val_chrom_access_recon_loss: 2161377.7000; val_global_loss: 17942656.2667; val_optim_loss: 17942656.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9067; val_auprc_score: 0.8945; val_best_acc_score: 0.8242; val_best_f1_score: 0.8405; train_kl_reg_loss: 91398.0126; train_edge_recon_loss: 2940467.2366; train_gene_expr_recon_loss: 12285787.6947; train_masked_gp_l1_reg_loss: 94226.2746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85550.6978; train_chrom_access_recon_loss: 2118062.5401; train_global_loss: 17615492.5038; train_optim_loss: 17615492.5038; val_kl_reg_loss: 91484.8385; val_edge_recon_loss: 2873279.3667; val_gene_expr_recon_loss: 12284908.9333; val_masked_gp_l1_reg_loss: 96247.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78953.5703; val_chrom_access_recon_loss: 2129815.6167; val_global_loss: 17554690.0000; val_optim_loss: 17554690.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9265; val_auprc_score: 0.9132; val_best_acc_score: 0.8599; val_best_f1_score: 0.8659; train_kl_reg_loss: 92339.2266; train_edge_recon_loss: 2808081.6698; train_gene_expr_recon_loss: 12167905.1145; train_masked_gp_l1_reg_loss: 98030.5644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75149.2928; train_chrom_access_recon_loss: 2098939.5534; train_global_loss: 17340445.4733; train_optim_loss: 17340445.4733; val_kl_reg_loss: 87625.2849; val_edge_recon_loss: 2814114.5500; val_gene_expr_recon_loss: 12202928.0667; val_masked_gp_l1_reg_loss: 100019.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74654.4844; val_chrom_access_recon_loss: 2114548.6167; val_global_loss: 17393890.3333; val_optim_loss: 17393890.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9315; val_auprc_score: 0.9195; val_best_acc_score: 0.8670; val_best_f1_score: 0.8732; train_kl_reg_loss: 91271.1708; train_edge_recon_loss: 2794817.0439; train_gene_expr_recon_loss: 12051274.4885; train_masked_gp_l1_reg_loss: 100778.2260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72708.0368; train_chrom_access_recon_loss: 2081112.4437; train_global_loss: 17191961.4809; train_optim_loss: 17191961.4809; val_kl_reg_loss: 86987.3943; val_edge_recon_loss: 2792475.5833; val_gene_expr_recon_loss: 12047255.2000; val_masked_gp_l1_reg_loss: 101539.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70729.3359; val_chrom_access_recon_loss: 2105733.0750; val_global_loss: 17204720.2667; val_optim_loss: 17204720.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9356; val_auprc_score: 0.9231; val_best_acc_score: 0.8708; val_best_f1_score: 0.8789; train_kl_reg_loss: 87533.0807; train_edge_recon_loss: 2787231.7882; train_gene_expr_recon_loss: 11963257.4962; train_masked_gp_l1_reg_loss: 102632.0778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68372.5871; train_chrom_access_recon_loss: 2067962.9914; train_global_loss: 17076990.0000; train_optim_loss: 17076990.0000; val_kl_reg_loss: 86859.8115; val_edge_recon_loss: 2797865.8667; val_gene_expr_recon_loss: 11933527.3333; val_masked_gp_l1_reg_loss: 103422.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66692.6562; val_chrom_access_recon_loss: 2085053.7167; val_global_loss: 17073422.8000; val_optim_loss: 17073422.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9421; val_auprc_score: 0.9309; val_best_acc_score: 0.8771; val_best_f1_score: 0.8834; train_kl_reg_loss: 86067.9268; train_edge_recon_loss: 2771198.1298; train_gene_expr_recon_loss: 11907665.7252; train_masked_gp_l1_reg_loss: 104029.3223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65670.3067; train_chrom_access_recon_loss: 2058345.0487; train_global_loss: 16992976.4351; train_optim_loss: 16992976.4351; val_kl_reg_loss: 81602.9891; val_edge_recon_loss: 2778557.8167; val_gene_expr_recon_loss: 11870591.2000; val_masked_gp_l1_reg_loss: 104582.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64745.7148; val_chrom_access_recon_loss: 2067405.0083; val_global_loss: 16967486.0667; val_optim_loss: 16967486.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9451; val_auprc_score: 0.9299; val_best_acc_score: 0.8828; val_best_f1_score: 0.8871; train_kl_reg_loss: 83781.6709; train_edge_recon_loss: 2760909.1985; train_gene_expr_recon_loss: 11836400.1908; train_masked_gp_l1_reg_loss: 105080.2798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63173.2246; train_chrom_access_recon_loss: 2043883.8960; train_global_loss: 16893228.3435; train_optim_loss: 16893228.3435; val_kl_reg_loss: 83116.0151; val_edge_recon_loss: 2782535.9167; val_gene_expr_recon_loss: 11858371.2667; val_masked_gp_l1_reg_loss: 105910.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63053.6680; val_chrom_access_recon_loss: 2061788.5250; val_global_loss: 16954775.8667; val_optim_loss: 16954775.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9467; val_auprc_score: 0.9336; val_best_acc_score: 0.8831; val_best_f1_score: 0.8880; train_kl_reg_loss: 82536.0988; train_edge_recon_loss: 2743588.5973; train_gene_expr_recon_loss: 11772905.9389; train_masked_gp_l1_reg_loss: 106243.1143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62465.9392; train_chrom_access_recon_loss: 2033272.8130; train_global_loss: 16801012.5573; train_optim_loss: 16801012.5573; val_kl_reg_loss: 81509.8927; val_edge_recon_loss: 2757234.4000; val_gene_expr_recon_loss: 11803114.6667; val_masked_gp_l1_reg_loss: 106688.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62524.8398; val_chrom_access_recon_loss: 2054704.3500; val_global_loss: 16865776.4000; val_optim_loss: 16865776.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9514; val_auprc_score: 0.9380; val_best_acc_score: 0.8902; val_best_f1_score: 0.8947; train_kl_reg_loss: 80835.9101; train_edge_recon_loss: 2737226.2176; train_gene_expr_recon_loss: 11716389.4885; train_masked_gp_l1_reg_loss: 106981.5602; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62986.1017; train_chrom_access_recon_loss: 2023206.1059; train_global_loss: 16727625.4122; train_optim_loss: 16727625.4122; val_kl_reg_loss: 79545.3365; val_edge_recon_loss: 2752993.9833; val_gene_expr_recon_loss: 11683578.8667; val_masked_gp_l1_reg_loss: 107456.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64523.9492; val_chrom_access_recon_loss: 2041588.3083; val_global_loss: 16729686.3333; val_optim_loss: 16729686.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9541; val_auprc_score: 0.9440; val_best_acc_score: 0.8915; val_best_f1_score: 0.8973; train_kl_reg_loss: 80561.3043; train_edge_recon_loss: 2731151.4427; train_gene_expr_recon_loss: 11662415.6565; train_masked_gp_l1_reg_loss: 107646.3257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64295.0863; train_chrom_access_recon_loss: 2013219.3874; train_global_loss: 16659289.1603; train_optim_loss: 16659289.1603; val_kl_reg_loss: 81621.1745; val_edge_recon_loss: 2730112.8667; val_gene_expr_recon_loss: 11681816.2667; val_masked_gp_l1_reg_loss: 107425.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63624.8867; val_chrom_access_recon_loss: 2026651.0167; val_global_loss: 16691251.5333; val_optim_loss: 16691251.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9499; val_auprc_score: 0.9380; val_best_acc_score: 0.8905; val_best_f1_score: 0.8960; train_kl_reg_loss: 80711.2971; train_edge_recon_loss: 2716031.9447; train_gene_expr_recon_loss: 11617335.3740; train_masked_gp_l1_reg_loss: 107814.3739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63418.8525; train_chrom_access_recon_loss: 2007123.5105; train_global_loss: 16592435.4427; train_optim_loss: 16592435.4427; val_kl_reg_loss: 82466.7859; val_edge_recon_loss: 2750653.4167; val_gene_expr_recon_loss: 11614738.9333; val_masked_gp_l1_reg_loss: 107886.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63136.3594; val_chrom_access_recon_loss: 2015189.8833; val_global_loss: 16634071.2667; val_optim_loss: 16634071.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9564; val_auprc_score: 0.9425; val_best_acc_score: 0.9003; val_best_f1_score: 0.9038; train_kl_reg_loss: 78869.6329; train_edge_recon_loss: 2711401.6947; train_gene_expr_recon_loss: 11574740.4275; train_masked_gp_l1_reg_loss: 108152.0574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63157.9588; train_chrom_access_recon_loss: 1997266.5105; train_global_loss: 16533588.4198; train_optim_loss: 16533588.4198; val_kl_reg_loss: 76906.1505; val_edge_recon_loss: 2724583.0167; val_gene_expr_recon_loss: 11575340.4000; val_masked_gp_l1_reg_loss: 108339.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62534.7461; val_chrom_access_recon_loss: 2007352.6000; val_global_loss: 16555057.0667; val_optim_loss: 16555057.0667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9621; val_auprc_score: 0.9519; val_best_acc_score: 0.9076; val_best_f1_score: 0.9105; train_kl_reg_loss: 78341.6848; train_edge_recon_loss: 2706327.4599; train_gene_expr_recon_loss: 11540920.7634; train_masked_gp_l1_reg_loss: 108350.2743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62388.5938; train_chrom_access_recon_loss: 1990220.5658; train_global_loss: 16486549.3206; train_optim_loss: 16486549.3206; val_kl_reg_loss: 80572.5083; val_edge_recon_loss: 2711202.4167; val_gene_expr_recon_loss: 11570226.4667; val_masked_gp_l1_reg_loss: 109149.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63044.5625; val_chrom_access_recon_loss: 2004310.3667; val_global_loss: 16538506.8667; val_optim_loss: 16538506.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9678; val_auprc_score: 0.9603; val_best_acc_score: 0.9124; val_best_f1_score: 0.9158; train_kl_reg_loss: 77097.4409; train_edge_recon_loss: 2705156.8969; train_gene_expr_recon_loss: 11508014.4198; train_masked_gp_l1_reg_loss: 108783.2295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62207.2173; train_chrom_access_recon_loss: 1985290.7548; train_global_loss: 16446550.0458; train_optim_loss: 16446550.0458; val_kl_reg_loss: 77529.1979; val_edge_recon_loss: 2701662.0333; val_gene_expr_recon_loss: 11541763.4667; val_masked_gp_l1_reg_loss: 108386.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61470.4375; val_chrom_access_recon_loss: 2012787.1000; val_global_loss: 16503597.7333; val_optim_loss: 16503597.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9635; val_auprc_score: 0.9530; val_best_acc_score: 0.9070; val_best_f1_score: 0.9106; train_kl_reg_loss: 76644.9314; train_edge_recon_loss: 2708203.6393; train_gene_expr_recon_loss: 11484481.5191; train_masked_gp_l1_reg_loss: 108452.2390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61617.3978; train_chrom_access_recon_loss: 1980344.9380; train_global_loss: 16419744.6641; train_optim_loss: 16419744.6641; val_kl_reg_loss: 76264.8052; val_edge_recon_loss: 2713532.3500; val_gene_expr_recon_loss: 11497116.6667; val_masked_gp_l1_reg_loss: 108557.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61618.4766; val_chrom_access_recon_loss: 1997241.3667; val_global_loss: 16454331.4667; val_optim_loss: 16454331.4667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9663; val_auprc_score: 0.9588; val_best_acc_score: 0.9126; val_best_f1_score: 0.9154; train_kl_reg_loss: 75943.8847; train_edge_recon_loss: 2700946.4103; train_gene_expr_recon_loss: 11464782.0534; train_masked_gp_l1_reg_loss: 108440.6094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61176.8833; train_chrom_access_recon_loss: 1974297.0115; train_global_loss: 16385586.8702; train_optim_loss: 16385586.8702; val_kl_reg_loss: 75614.4052; val_edge_recon_loss: 2709419.7833; val_gene_expr_recon_loss: 11470856.5333; val_masked_gp_l1_reg_loss: 108377.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60713.5078; val_chrom_access_recon_loss: 1999021.6000; val_global_loss: 16424003.4000; val_optim_loss: 16424003.4000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9675; val_auprc_score: 0.9540; val_best_acc_score: 0.9155; val_best_f1_score: 0.9188; train_kl_reg_loss: 76531.2185; train_edge_recon_loss: 2693076.9218; train_gene_expr_recon_loss: 11432067.1069; train_masked_gp_l1_reg_loss: 108422.0354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60943.3556; train_chrom_access_recon_loss: 1968345.0334; train_global_loss: 16339385.6794; train_optim_loss: 16339385.6794; val_kl_reg_loss: 76442.1229; val_edge_recon_loss: 2703732.6167; val_gene_expr_recon_loss: 11455861.4000; val_masked_gp_l1_reg_loss: 108552.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61102.9648; val_chrom_access_recon_loss: 1987615.2417; val_global_loss: 16393306.6000; val_optim_loss: 16393306.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9706; val_auprc_score: 0.9614; val_best_acc_score: 0.9221; val_best_f1_score: 0.9233; train_kl_reg_loss: 75001.6266; train_edge_recon_loss: 2697337.5611; train_gene_expr_recon_loss: 11403191.5573; train_masked_gp_l1_reg_loss: 108365.7196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60742.5620; train_chrom_access_recon_loss: 1963010.5296; train_global_loss: 16307649.5573; train_optim_loss: 16307649.5573; val_kl_reg_loss: 75192.2542; val_edge_recon_loss: 2686401.1333; val_gene_expr_recon_loss: 11433812.2667; val_masked_gp_l1_reg_loss: 108473.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60758.8711; val_chrom_access_recon_loss: 1983754.3083; val_global_loss: 16348391.9333; val_optim_loss: 16348391.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9694; val_auprc_score: 0.9600; val_best_acc_score: 0.9210; val_best_f1_score: 0.9236; train_kl_reg_loss: 74488.7904; train_edge_recon_loss: 2692615.2080; train_gene_expr_recon_loss: 11398398.2748; train_masked_gp_l1_reg_loss: 108343.1665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60710.4185; train_chrom_access_recon_loss: 1960944.2185; train_global_loss: 16295500.0763; train_optim_loss: 16295500.0763; val_kl_reg_loss: 75031.2651; val_edge_recon_loss: 2692759.4833; val_gene_expr_recon_loss: 11413101.6667; val_masked_gp_l1_reg_loss: 108235.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60495.1367; val_chrom_access_recon_loss: 1985356.3250; val_global_loss: 16334979.6000; val_optim_loss: 16334979.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9688; val_auprc_score: 0.9597; val_best_acc_score: 0.9150; val_best_f1_score: 0.9178; train_kl_reg_loss: 74820.6901; train_edge_recon_loss: 2689036.4275; train_gene_expr_recon_loss: 11372860.4809; train_masked_gp_l1_reg_loss: 107953.9990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60256.1766; train_chrom_access_recon_loss: 1955887.9189; train_global_loss: 16260815.7405; train_optim_loss: 16260815.7405; val_kl_reg_loss: 75486.2146; val_edge_recon_loss: 2704009.1500; val_gene_expr_recon_loss: 11450465.0667; val_masked_gp_l1_reg_loss: 108354.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61200.6211; val_chrom_access_recon_loss: 1980044.1583; val_global_loss: 16379560.5333; val_optim_loss: 16379560.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9691; val_auprc_score: 0.9583; val_best_acc_score: 0.9190; val_best_f1_score: 0.9212; train_kl_reg_loss: 74545.8996; train_edge_recon_loss: 2690014.3588; train_gene_expr_recon_loss: 11358033.3130; train_masked_gp_l1_reg_loss: 107835.3653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60280.2475; train_chrom_access_recon_loss: 1953611.0744; train_global_loss: 16244320.3053; train_optim_loss: 16244320.3053; val_kl_reg_loss: 74535.0339; val_edge_recon_loss: 2709014.9333; val_gene_expr_recon_loss: 11428196.4667; val_masked_gp_l1_reg_loss: 107760.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60541.0273; val_chrom_access_recon_loss: 1977215.5083; val_global_loss: 16357263.9333; val_optim_loss: 16357263.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9739; val_auprc_score: 0.9677; val_best_acc_score: 0.9236; val_best_f1_score: 0.9259; train_kl_reg_loss: 74119.4008; train_edge_recon_loss: 2689076.0229; train_gene_expr_recon_loss: 11340269.2290; train_masked_gp_l1_reg_loss: 107643.2944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60090.9910; train_chrom_access_recon_loss: 1950691.8454; train_global_loss: 16221890.7176; train_optim_loss: 16221890.7176; val_kl_reg_loss: 73109.6182; val_edge_recon_loss: 2684573.5000; val_gene_expr_recon_loss: 11408802.2667; val_masked_gp_l1_reg_loss: 107585.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60334.2305; val_chrom_access_recon_loss: 1968050.1833; val_global_loss: 16302455.5333; val_optim_loss: 16302455.5333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9762; val_auprc_score: 0.9694; val_best_acc_score: 0.9286; val_best_f1_score: 0.9305; train_kl_reg_loss: 73901.0688; train_edge_recon_loss: 2684550.3531; train_gene_expr_recon_loss: 11316797.5191; train_masked_gp_l1_reg_loss: 107534.3006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60265.9712; train_chrom_access_recon_loss: 1944444.2576; train_global_loss: 16187493.4351; train_optim_loss: 16187493.4351; val_kl_reg_loss: 73929.4646; val_edge_recon_loss: 2686048.4333; val_gene_expr_recon_loss: 11366728.2667; val_masked_gp_l1_reg_loss: 107494.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60198.0391; val_chrom_access_recon_loss: 1967434.5583; val_global_loss: 16261833.6667; val_optim_loss: 16261833.6667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9710; val_auprc_score: 0.9638; val_best_acc_score: 0.9213; val_best_f1_score: 0.9242; train_kl_reg_loss: 84469.5706; train_edge_recon_loss: 2730384.2252; train_gene_expr_recon_loss: 10721285.6870; train_masked_gp_l1_reg_loss: 106747.6647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56751.5785; train_chrom_access_recon_loss: 1863957.0267; train_global_loss: 15563595.7786; train_optim_loss: 15563595.7786; val_kl_reg_loss: 45280.9951; val_edge_recon_loss: 2711251.9167; val_gene_expr_recon_loss: 10742981.4667; val_masked_gp_l1_reg_loss: 106555.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56787.9258; val_chrom_access_recon_loss: 1875971.6000; val_global_loss: 15538829.1333; val_optim_loss: 15538829.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9749; val_auprc_score: 0.9696; val_best_acc_score: 0.9274; val_best_f1_score: 0.9300; train_kl_reg_loss: 73189.1693; train_edge_recon_loss: 2703460.2901; train_gene_expr_recon_loss: 10689982.3130; train_masked_gp_l1_reg_loss: 105854.5673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56889.6175; train_chrom_access_recon_loss: 1854410.6718; train_global_loss: 15483786.6489; train_optim_loss: 15483786.6489; val_kl_reg_loss: 47855.6602; val_edge_recon_loss: 2702730.8833; val_gene_expr_recon_loss: 10708411.0667; val_masked_gp_l1_reg_loss: 105235.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56804.9023; val_chrom_access_recon_loss: 1875024.7833; val_global_loss: 15496063.2000; val_optim_loss: 15496063.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9720; val_auprc_score: 0.9642; val_best_acc_score: 0.9214; val_best_f1_score: 0.9250; train_kl_reg_loss: 68673.7651; train_edge_recon_loss: 2687547.8798; train_gene_expr_recon_loss: 10676106.6565; train_masked_gp_l1_reg_loss: 104457.1446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57035.3545; train_chrom_access_recon_loss: 1853356.4323; train_global_loss: 15447177.2214; train_optim_loss: 15447177.2214; val_kl_reg_loss: 48558.7805; val_edge_recon_loss: 2688723.4167; val_gene_expr_recon_loss: 10706564.2667; val_masked_gp_l1_reg_loss: 103703.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56866.1094; val_chrom_access_recon_loss: 1871499.5750; val_global_loss: 15475914.9333; val_optim_loss: 15475914.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9751; val_auprc_score: 0.9663; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 64980.2125; train_edge_recon_loss: 2690588.8073; train_gene_expr_recon_loss: 10655659.0840; train_masked_gp_l1_reg_loss: 102930.6917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57248.7637; train_chrom_access_recon_loss: 1850915.6269; train_global_loss: 15422323.1908; train_optim_loss: 15422323.1908; val_kl_reg_loss: 50858.6755; val_edge_recon_loss: 2663913.8667; val_gene_expr_recon_loss: 10670469.3333; val_masked_gp_l1_reg_loss: 102334.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57353.9883; val_chrom_access_recon_loss: 1864254.2000; val_global_loss: 15409184.0000; val_optim_loss: 15409184.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9732; val_auprc_score: 0.9621; val_best_acc_score: 0.9267; val_best_f1_score: 0.9298; train_kl_reg_loss: 62904.7524; train_edge_recon_loss: 2679805.0000; train_gene_expr_recon_loss: 10639558.9618; train_masked_gp_l1_reg_loss: 101558.2422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57177.0800; train_chrom_access_recon_loss: 1849739.7290; train_global_loss: 15390743.7634; train_optim_loss: 15390743.7634; val_kl_reg_loss: 53830.5578; val_edge_recon_loss: 2668617.9333; val_gene_expr_recon_loss: 10676776.0667; val_masked_gp_l1_reg_loss: 100891.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57374.2227; val_chrom_access_recon_loss: 1867054.8417; val_global_loss: 15424545.6667; val_optim_loss: 15424545.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9729; val_auprc_score: 0.9638; val_best_acc_score: 0.9286; val_best_f1_score: 0.9314; train_kl_reg_loss: 61837.6384; train_edge_recon_loss: 2682724.9065; train_gene_expr_recon_loss: 10626081.1298; train_masked_gp_l1_reg_loss: 100234.0160; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57107.1973; train_chrom_access_recon_loss: 1844668.3826; train_global_loss: 15372653.1679; train_optim_loss: 15372653.1679; val_kl_reg_loss: 53773.5924; val_edge_recon_loss: 2695073.7167; val_gene_expr_recon_loss: 10630648.2667; val_masked_gp_l1_reg_loss: 99468.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56723.3398; val_chrom_access_recon_loss: 1858676.6417; val_global_loss: 15394364.1333; val_optim_loss: 15394364.1333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9729; val_auprc_score: 0.9621; val_best_acc_score: 0.9245; val_best_f1_score: 0.9268; train_kl_reg_loss: 61761.4505; train_edge_recon_loss: 2674398.1889; train_gene_expr_recon_loss: 10619999.9847; train_masked_gp_l1_reg_loss: 99127.0718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56909.2818; train_chrom_access_recon_loss: 1845242.2948; train_global_loss: 15357438.2443; train_optim_loss: 15357438.2443; val_kl_reg_loss: 54941.3607; val_edge_recon_loss: 2698457.0833; val_gene_expr_recon_loss: 10660328.2000; val_masked_gp_l1_reg_loss: 98493.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56764.2070; val_chrom_access_recon_loss: 1858584.3500; val_global_loss: 15427569.0000; val_optim_loss: 15427569.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9762; val_auprc_score: 0.9700; val_best_acc_score: 0.9285; val_best_f1_score: 0.9306; train_kl_reg_loss: 60043.5396; train_edge_recon_loss: 2678517.1832; train_gene_expr_recon_loss: 10604174.3969; train_masked_gp_l1_reg_loss: 98112.9463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56793.0680; train_chrom_access_recon_loss: 1842102.1908; train_global_loss: 15339743.3053; train_optim_loss: 15339743.3053; val_kl_reg_loss: 56463.7115; val_edge_recon_loss: 2690234.4167; val_gene_expr_recon_loss: 10635278.3333; val_masked_gp_l1_reg_loss: 97835.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56487.4688; val_chrom_access_recon_loss: 1860635.7500; val_global_loss: 15396934.2000; val_optim_loss: 15396934.2000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9744; val_auprc_score: 0.9663; val_best_acc_score: 0.9259; val_best_f1_score: 0.9282; train_kl_reg_loss: 60578.9456; train_edge_recon_loss: 2671311.9084; train_gene_expr_recon_loss: 10592560.3282; train_masked_gp_l1_reg_loss: 97164.8135; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56281.2508; train_chrom_access_recon_loss: 1835157.9380; train_global_loss: 15313055.0916; train_optim_loss: 15313055.0916; val_kl_reg_loss: 57072.4299; val_edge_recon_loss: 2700659.2000; val_gene_expr_recon_loss: 10626296.1333; val_masked_gp_l1_reg_loss: 96678.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56540.5273; val_chrom_access_recon_loss: 1854690.7250; val_global_loss: 15391937.4667; val_optim_loss: 15391937.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9804; val_auprc_score: 0.9762; val_best_acc_score: 0.9347; val_best_f1_score: 0.9370; train_kl_reg_loss: 59542.5810; train_edge_recon_loss: 2672441.1698; train_gene_expr_recon_loss: 10578099.3969; train_masked_gp_l1_reg_loss: 96127.8110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56279.4932; train_chrom_access_recon_loss: 1832517.1698; train_global_loss: 15295007.5267; train_optim_loss: 15295007.5267; val_kl_reg_loss: 55875.1479; val_edge_recon_loss: 2673879.8000; val_gene_expr_recon_loss: 10601861.0000; val_masked_gp_l1_reg_loss: 95829.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56380.8750; val_chrom_access_recon_loss: 1846731.3667; val_global_loss: 15330557.2667; val_optim_loss: 15330557.2667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9775; val_auprc_score: 0.9712; val_best_acc_score: 0.9345; val_best_f1_score: 0.9365; train_kl_reg_loss: 59247.3406; train_edge_recon_loss: 2675028.1202; train_gene_expr_recon_loss: 10575882.4198; train_masked_gp_l1_reg_loss: 95371.9899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56374.4824; train_chrom_access_recon_loss: 1833936.4800; train_global_loss: 15295840.8168; train_optim_loss: 15295840.8168; val_kl_reg_loss: 57703.0219; val_edge_recon_loss: 2683938.2833; val_gene_expr_recon_loss: 10612598.7333; val_masked_gp_l1_reg_loss: 94966.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56259.3945; val_chrom_access_recon_loss: 1860680.0917; val_global_loss: 15366146.3333; val_optim_loss: 15366146.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9761; val_auprc_score: 0.9670; val_best_acc_score: 0.9337; val_best_f1_score: 0.9362; train_kl_reg_loss: 59770.5557; train_edge_recon_loss: 2675121.9313; train_gene_expr_recon_loss: 10568755.7176; train_masked_gp_l1_reg_loss: 94501.3310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56208.9541; train_chrom_access_recon_loss: 1830701.8750; train_global_loss: 15285060.3511; train_optim_loss: 15285060.3511; val_kl_reg_loss: 57935.2031; val_edge_recon_loss: 2679420.9167; val_gene_expr_recon_loss: 10626175.7333; val_masked_gp_l1_reg_loss: 93845.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56236.9844; val_chrom_access_recon_loss: 1851226.1583; val_global_loss: 15364840.9333; val_optim_loss: 15364840.9333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9805; val_auprc_score: 0.9757; val_best_acc_score: 0.9384; val_best_f1_score: 0.9399; train_kl_reg_loss: 59645.9184; train_edge_recon_loss: 2666927.3989; train_gene_expr_recon_loss: 10551388.6947; train_masked_gp_l1_reg_loss: 93588.8758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56182.7163; train_chrom_access_recon_loss: 1829789.8120; train_global_loss: 15257523.4351; train_optim_loss: 15257523.4351; val_kl_reg_loss: 57547.3674; val_edge_recon_loss: 2673682.6833; val_gene_expr_recon_loss: 10574423.2667; val_masked_gp_l1_reg_loss: 93299.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56257.2344; val_chrom_access_recon_loss: 1843431.2833; val_global_loss: 15298640.7333; val_optim_loss: 15298640.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9817; val_auprc_score: 0.9774; val_best_acc_score: 0.9398; val_best_f1_score: 0.9413; train_kl_reg_loss: 59500.3856; train_edge_recon_loss: 2666154.4065; train_gene_expr_recon_loss: 10544882.1221; train_masked_gp_l1_reg_loss: 92800.4645; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56301.2620; train_chrom_access_recon_loss: 1827961.1345; train_global_loss: 15247599.8168; train_optim_loss: 15247599.8168; val_kl_reg_loss: 56703.4357; val_edge_recon_loss: 2661845.8833; val_gene_expr_recon_loss: 10608330.0000; val_masked_gp_l1_reg_loss: 92601.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56174.8086; val_chrom_access_recon_loss: 1842672.5583; val_global_loss: 15318328.8000; val_optim_loss: 15318328.8000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9812; val_auprc_score: 0.9767; val_best_acc_score: 0.9380; val_best_f1_score: 0.9395; train_kl_reg_loss: 59043.9758; train_edge_recon_loss: 2664512.2366; train_gene_expr_recon_loss: 10537146.4122; train_masked_gp_l1_reg_loss: 92253.4532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56155.5188; train_chrom_access_recon_loss: 1824229.0544; train_global_loss: 15233340.7328; train_optim_loss: 15233340.7328; val_kl_reg_loss: 56661.4193; val_edge_recon_loss: 2671825.6000; val_gene_expr_recon_loss: 10548164.3333; val_masked_gp_l1_reg_loss: 92089.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56430.2617; val_chrom_access_recon_loss: 1835425.6333; val_global_loss: 15260595.8667; val_optim_loss: 15260595.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9794; val_auprc_score: 0.9715; val_best_acc_score: 0.9411; val_best_f1_score: 0.9426; train_kl_reg_loss: 58762.4868; train_edge_recon_loss: 2662129.8492; train_gene_expr_recon_loss: 10531248.9618; train_masked_gp_l1_reg_loss: 91701.8141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56268.3169; train_chrom_access_recon_loss: 1825682.8607; train_global_loss: 15225794.3053; train_optim_loss: 15225794.3053; val_kl_reg_loss: 58978.5003; val_edge_recon_loss: 2674655.1000; val_gene_expr_recon_loss: 10524382.2000; val_masked_gp_l1_reg_loss: 91439.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56044.0469; val_chrom_access_recon_loss: 1843312.7000; val_global_loss: 15248812.6667; val_optim_loss: 15248812.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9801; val_auprc_score: 0.9734; val_best_acc_score: 0.9376; val_best_f1_score: 0.9387; train_kl_reg_loss: 58411.8130; train_edge_recon_loss: 2665397.3492; train_gene_expr_recon_loss: 10511082.6870; train_masked_gp_l1_reg_loss: 91215.8643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56261.7859; train_chrom_access_recon_loss: 1821886.3569; train_global_loss: 15204255.8092; train_optim_loss: 15204255.8092; val_kl_reg_loss: 56366.7188; val_edge_recon_loss: 2679468.5667; val_gene_expr_recon_loss: 10585836.5333; val_masked_gp_l1_reg_loss: 91050.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56319.7070; val_chrom_access_recon_loss: 1848306.2667; val_global_loss: 15317348.0000; val_optim_loss: 15317348.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9795; val_auprc_score: 0.9747; val_best_acc_score: 0.9364; val_best_f1_score: 0.9385; train_kl_reg_loss: 58016.4348; train_edge_recon_loss: 2661826.5477; train_gene_expr_recon_loss: 10506662.4122; train_masked_gp_l1_reg_loss: 90783.8667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56096.5640; train_chrom_access_recon_loss: 1820535.2710; train_global_loss: 15193921.0153; train_optim_loss: 15193921.0153; val_kl_reg_loss: 57553.1169; val_edge_recon_loss: 2679462.1833; val_gene_expr_recon_loss: 10566720.4667; val_masked_gp_l1_reg_loss: 90616.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56153.6484; val_chrom_access_recon_loss: 1843540.2167; val_global_loss: 15294047.0000; val_optim_loss: 15294047.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9781; val_auprc_score: 0.9701; val_best_acc_score: 0.9355; val_best_f1_score: 0.9374; train_kl_reg_loss: 58663.2542; train_edge_recon_loss: 2659924.8359; train_gene_expr_recon_loss: 10508759.7099; train_masked_gp_l1_reg_loss: 90500.1603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56423.1139; train_chrom_access_recon_loss: 1823489.6622; train_global_loss: 15197760.8168; train_optim_loss: 15197760.8168; val_kl_reg_loss: 56327.0477; val_edge_recon_loss: 2696736.0167; val_gene_expr_recon_loss: 10552233.0667; val_masked_gp_l1_reg_loss: 90318.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56165.7148; val_chrom_access_recon_loss: 1837779.3333; val_global_loss: 15289560.4667; val_optim_loss: 15289560.4667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9855; val_auprc_score: 0.9824; val_best_acc_score: 0.9458; val_best_f1_score: 0.9469; train_kl_reg_loss: 58594.5242; train_edge_recon_loss: 2662137.4351; train_gene_expr_recon_loss: 10497961.0458; train_masked_gp_l1_reg_loss: 90228.3646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56271.1167; train_chrom_access_recon_loss: 1821462.5954; train_global_loss: 15186655.1374; train_optim_loss: 15186655.1374; val_kl_reg_loss: 58541.4276; val_edge_recon_loss: 2654361.3500; val_gene_expr_recon_loss: 10593393.6667; val_masked_gp_l1_reg_loss: 89960.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56230.0938; val_chrom_access_recon_loss: 1854582.9833; val_global_loss: 15307070.2667; val_optim_loss: 15307070.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9775; val_auprc_score: 0.9689; val_best_acc_score: 0.9396; val_best_f1_score: 0.9413; train_kl_reg_loss: 60406.2819; train_edge_recon_loss: 2656587.1450; train_gene_expr_recon_loss: 10494175.1908; train_masked_gp_l1_reg_loss: 87591.0962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47239.8307; train_chrom_access_recon_loss: 1820048.0420; train_global_loss: 15166047.5878; train_optim_loss: 15166047.5878; val_kl_reg_loss: 59151.7305; val_edge_recon_loss: 2688360.3333; val_gene_expr_recon_loss: 10541310.2000; val_masked_gp_l1_reg_loss: 86999.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45910.3359; val_chrom_access_recon_loss: 1839810.7417; val_global_loss: 15261543.3333; val_optim_loss: 15261543.3333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9816; val_auprc_score: 0.9755; val_best_acc_score: 0.9426; val_best_f1_score: 0.9438; train_kl_reg_loss: 60903.7964; train_edge_recon_loss: 2652036.6813; train_gene_expr_recon_loss: 10474704.6336; train_masked_gp_l1_reg_loss: 86886.1079; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45571.2610; train_chrom_access_recon_loss: 1816983.5344; train_global_loss: 15137085.9771; train_optim_loss: 15137085.9771; val_kl_reg_loss: 58821.8763; val_edge_recon_loss: 2665539.1500; val_gene_expr_recon_loss: 10551668.3333; val_masked_gp_l1_reg_loss: 86776.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45209.4258; val_chrom_access_recon_loss: 1841679.3417; val_global_loss: 15249694.6667; val_optim_loss: 15249694.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9809; val_auprc_score: 0.9736; val_best_acc_score: 0.9429; val_best_f1_score: 0.9450; train_kl_reg_loss: 60484.6224; train_edge_recon_loss: 2654769.8282; train_gene_expr_recon_loss: 10468746.5802; train_masked_gp_l1_reg_loss: 86749.2100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45036.9334; train_chrom_access_recon_loss: 1817290.2758; train_global_loss: 15133077.6260; train_optim_loss: 15133077.6260; val_kl_reg_loss: 58494.3456; val_edge_recon_loss: 2675024.8000; val_gene_expr_recon_loss: 10559261.0667; val_masked_gp_l1_reg_loss: 86721.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44854.2891; val_chrom_access_recon_loss: 1837842.7167; val_global_loss: 15262198.8667; val_optim_loss: 15262198.8667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9815; val_auprc_score: 0.9756; val_best_acc_score: 0.9449; val_best_f1_score: 0.9461; train_kl_reg_loss: 60615.7175; train_edge_recon_loss: 2661773.3321; train_gene_expr_recon_loss: 10486886.5267; train_masked_gp_l1_reg_loss: 86695.1259; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44698.0462; train_chrom_access_recon_loss: 1818986.2490; train_global_loss: 15159655.0153; train_optim_loss: 15159655.0153; val_kl_reg_loss: 58174.5758; val_edge_recon_loss: 2651140.2500; val_gene_expr_recon_loss: 10505903.9333; val_masked_gp_l1_reg_loss: 86673.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44571.3281; val_chrom_access_recon_loss: 1829785.8333; val_global_loss: 15176249.5333; val_optim_loss: 15176249.5333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9810; val_auprc_score: 0.9737; val_best_acc_score: 0.9427; val_best_f1_score: 0.9441; train_kl_reg_loss: 61111.4152; train_edge_recon_loss: 2653575.1355; train_gene_expr_recon_loss: 10482868.9618; train_masked_gp_l1_reg_loss: 86641.2793; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44404.0199; train_chrom_access_recon_loss: 1817440.6307; train_global_loss: 15146041.4122; train_optim_loss: 15146041.4122; val_kl_reg_loss: 58714.3784; val_edge_recon_loss: 2666148.4833; val_gene_expr_recon_loss: 10542354.3333; val_masked_gp_l1_reg_loss: 86602.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44232.6133; val_chrom_access_recon_loss: 1843417.6917; val_global_loss: 15241470.8667; val_optim_loss: 15241470.8667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9811; val_auprc_score: 0.9749; val_best_acc_score: 0.9403; val_best_f1_score: 0.9417; train_kl_reg_loss: 61134.8423; train_edge_recon_loss: 2654217.4046; train_gene_expr_recon_loss: 10483832.6870; train_masked_gp_l1_reg_loss: 86566.3893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44135.4031; train_chrom_access_recon_loss: 1818625.9781; train_global_loss: 15148512.7023; train_optim_loss: 15148512.7023; val_kl_reg_loss: 59162.5477; val_edge_recon_loss: 2664927.8167; val_gene_expr_recon_loss: 10503283.3333; val_masked_gp_l1_reg_loss: 86552.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43995.1406; val_chrom_access_recon_loss: 1839372.8667; val_global_loss: 15197294.4000; val_optim_loss: 15197294.4000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9829; val_auprc_score: 0.9776; val_best_acc_score: 0.9442; val_best_f1_score: 0.9450; train_kl_reg_loss: 61516.5909; train_edge_recon_loss: 2651325.9981; train_gene_expr_recon_loss: 10479057.3511; train_masked_gp_l1_reg_loss: 86522.7455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43845.7612; train_chrom_access_recon_loss: 1818195.6403; train_global_loss: 15140464.1069; train_optim_loss: 15140464.1069; val_kl_reg_loss: 59111.7745; val_edge_recon_loss: 2657290.8000; val_gene_expr_recon_loss: 10544522.5333; val_masked_gp_l1_reg_loss: 86477.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43762.5000; val_chrom_access_recon_loss: 1838386.3750; val_global_loss: 15229551.9333; val_optim_loss: 15229551.9333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9815; val_auprc_score: 0.9761; val_best_acc_score: 0.9415; val_best_f1_score: 0.9423; train_kl_reg_loss: 60942.5711; train_edge_recon_loss: 2661726.1393; train_gene_expr_recon_loss: 10477231.6947; train_masked_gp_l1_reg_loss: 86468.7657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43678.3169; train_chrom_access_recon_loss: 1817077.9151; train_global_loss: 15147125.3359; train_optim_loss: 15147125.3359; val_kl_reg_loss: 59466.3831; val_edge_recon_loss: 2672219.1833; val_gene_expr_recon_loss: 10512181.2000; val_masked_gp_l1_reg_loss: 86446.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43515.6133; val_chrom_access_recon_loss: 1832758.0500; val_global_loss: 15206587.8000; val_optim_loss: 15206587.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9792; val_auprc_score: 0.9720; val_best_acc_score: 0.9376; val_best_f1_score: 0.9396; train_kl_reg_loss: 61673.4595; train_edge_recon_loss: 2653890.9294; train_gene_expr_recon_loss: 10482764.6870; train_masked_gp_l1_reg_loss: 86198.4356; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42617.8777; train_chrom_access_recon_loss: 1817113.8139; train_global_loss: 15144259.2290; train_optim_loss: 15144259.2290; val_kl_reg_loss: 59657.7266; val_edge_recon_loss: 2681304.9833; val_gene_expr_recon_loss: 10523263.2667; val_masked_gp_l1_reg_loss: 86120.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42490.6523; val_chrom_access_recon_loss: 1838483.0750; val_global_loss: 15231321.0667; val_optim_loss: 15231321.0667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9852; val_auprc_score: 0.9815; val_best_acc_score: 0.9477; val_best_f1_score: 0.9489; train_kl_reg_loss: 61530.9246; train_edge_recon_loss: 2658958.2920; train_gene_expr_recon_loss: 10467977.7863; train_masked_gp_l1_reg_loss: 86093.9101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42448.8174; train_chrom_access_recon_loss: 1814655.1422; train_global_loss: 15131664.8702; train_optim_loss: 15131664.8702; val_kl_reg_loss: 59032.9969; val_edge_recon_loss: 2662309.2000; val_gene_expr_recon_loss: 10502159.4000; val_masked_gp_l1_reg_loss: 86072.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42410.5234; val_chrom_access_recon_loss: 1830026.3417; val_global_loss: 15182010.8000; val_optim_loss: 15182010.8000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9815; val_auprc_score: 0.9763; val_best_acc_score: 0.9413; val_best_f1_score: 0.9436; train_kl_reg_loss: 61265.9283; train_edge_recon_loss: 2660056.9943; train_gene_expr_recon_loss: 10472800.8092; train_masked_gp_l1_reg_loss: 86059.5489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42383.4429; train_chrom_access_recon_loss: 1815929.1947; train_global_loss: 15138495.9313; train_optim_loss: 15138495.9313; val_kl_reg_loss: 59132.7263; val_edge_recon_loss: 2670011.1000; val_gene_expr_recon_loss: 10510896.4000; val_masked_gp_l1_reg_loss: 86051.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42358.1992; val_chrom_access_recon_loss: 1837595.3417; val_global_loss: 15206044.6000; val_optim_loss: 15206044.6000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9835; val_auprc_score: 0.9783; val_best_acc_score: 0.9441; val_best_f1_score: 0.9459; train_kl_reg_loss: 61387.1623; train_edge_recon_loss: 2650537.3473; train_gene_expr_recon_loss: 10467500.2901; train_masked_gp_l1_reg_loss: 86047.5426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42336.3766; train_chrom_access_recon_loss: 1814821.1307; train_global_loss: 15122629.7786; train_optim_loss: 15122629.7786; val_kl_reg_loss: 58897.2802; val_edge_recon_loss: 2655306.0667; val_gene_expr_recon_loss: 10538661.1333; val_masked_gp_l1_reg_loss: 86037.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 42312.6680; val_chrom_access_recon_loss: 1845766.9000; val_global_loss: 15226981.4667; val_optim_loss: 15226981.4667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 5 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9828
val AUPRC score: 0.9785
val best accuracy score: 0.9435
val best F1 score: 0.9451
val target rna MSE score: 1.4170
val source rna MSE score: 0.5152
val target atac MSE score: 0.3442
val source atac MSE score: 0.1058
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
