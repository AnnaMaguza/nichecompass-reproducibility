[True]
Run timestamp: 09102023_184234_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7622; val_auprc_score: 0.7870; val_best_acc_score: 0.5641; val_best_f1_score: 0.6915; train_kl_reg_loss: 63276.7212; train_edge_recon_loss: 3502973.6431; train_gene_expr_recon_loss: 13364168.6794; train_masked_gp_l1_reg_loss: 34005.4108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2450645.7839; train_chrom_access_recon_loss: 2240611.9838; train_global_loss: 21655682.2137; train_optim_loss: 21655682.2137; val_kl_reg_loss: 25492.4357; val_edge_recon_loss: 4061632.3333; val_gene_expr_recon_loss: 12971055.0000; val_masked_gp_l1_reg_loss: 42240.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 631321.8750; val_chrom_access_recon_loss: 2193767.1417; val_global_loss: 19925508.6667; val_optim_loss: 19925508.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7871; val_auprc_score: 0.8035; val_best_acc_score: 0.7005; val_best_f1_score: 0.7194; train_kl_reg_loss: 65892.9762; train_edge_recon_loss: 3492527.7767; train_gene_expr_recon_loss: 12704189.3130; train_masked_gp_l1_reg_loss: 46080.9709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 338324.7094; train_chrom_access_recon_loss: 2174063.6155; train_global_loss: 18821079.4046; train_optim_loss: 18821079.4046; val_kl_reg_loss: 65372.6297; val_edge_recon_loss: 3999872.6000; val_gene_expr_recon_loss: 12552372.3333; val_masked_gp_l1_reg_loss: 48084.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189327.1719; val_chrom_access_recon_loss: 2147609.5333; val_global_loss: 19002639.2000; val_optim_loss: 19002639.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8667; val_auprc_score: 0.8660; val_best_acc_score: 0.7719; val_best_f1_score: 0.7847; train_kl_reg_loss: 63642.4158; train_edge_recon_loss: 3297015.7385; train_gene_expr_recon_loss: 12500825.2137; train_masked_gp_l1_reg_loss: 50939.7388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 146971.2226; train_chrom_access_recon_loss: 2145782.0172; train_global_loss: 18205176.4122; train_optim_loss: 18205176.4122; val_kl_reg_loss: 78800.6807; val_edge_recon_loss: 2983722.2500; val_gene_expr_recon_loss: 12419309.8667; val_masked_gp_l1_reg_loss: 55435.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122498.7344; val_chrom_access_recon_loss: 2126452.6417; val_global_loss: 17786219.3333; val_optim_loss: 17786219.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9107; val_auprc_score: 0.8975; val_best_acc_score: 0.8305; val_best_f1_score: 0.8434; train_kl_reg_loss: 86009.1466; train_edge_recon_loss: 2892880.4828; train_gene_expr_recon_loss: 12317224.5344; train_masked_gp_l1_reg_loss: 58044.1966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109160.7804; train_chrom_access_recon_loss: 2121319.5029; train_global_loss: 17584638.6336; train_optim_loss: 17584638.6336; val_kl_reg_loss: 86949.5703; val_edge_recon_loss: 2816818.1000; val_gene_expr_recon_loss: 12114570.8000; val_masked_gp_l1_reg_loss: 60135.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98332.8906; val_chrom_access_recon_loss: 2085297.1250; val_global_loss: 17262103.6000; val_optim_loss: 17262103.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9263; val_auprc_score: 0.9113; val_best_acc_score: 0.8589; val_best_f1_score: 0.8665; train_kl_reg_loss: 88080.6418; train_edge_recon_loss: 2829572.2557; train_gene_expr_recon_loss: 12190182.6183; train_masked_gp_l1_reg_loss: 61895.1474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93124.1358; train_chrom_access_recon_loss: 2106147.6937; train_global_loss: 17369002.3969; train_optim_loss: 17369002.3969; val_kl_reg_loss: 87257.4620; val_edge_recon_loss: 2817870.2333; val_gene_expr_recon_loss: 12055146.0000; val_masked_gp_l1_reg_loss: 63476.4023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88937.9297; val_chrom_access_recon_loss: 2081500.6833; val_global_loss: 17194188.1333; val_optim_loss: 17194188.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9320; val_auprc_score: 0.9168; val_best_acc_score: 0.8677; val_best_f1_score: 0.8751; train_kl_reg_loss: 86078.2062; train_edge_recon_loss: 2796472.8569; train_gene_expr_recon_loss: 12066694.2061; train_masked_gp_l1_reg_loss: 64932.8578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85298.8268; train_chrom_access_recon_loss: 2083989.9933; train_global_loss: 17183466.9466; train_optim_loss: 17183466.9466; val_kl_reg_loss: 80909.4182; val_edge_recon_loss: 2798900.0500; val_gene_expr_recon_loss: 11973950.7333; val_masked_gp_l1_reg_loss: 66073.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81626.0469; val_chrom_access_recon_loss: 2059342.2750; val_global_loss: 17060801.4667; val_optim_loss: 17060801.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9371; val_auprc_score: 0.9235; val_best_acc_score: 0.8743; val_best_f1_score: 0.8813; train_kl_reg_loss: 83631.2498; train_edge_recon_loss: 2777077.4828; train_gene_expr_recon_loss: 11980875.8092; train_masked_gp_l1_reg_loss: 67121.5561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79236.0533; train_chrom_access_recon_loss: 2070824.1765; train_global_loss: 17058766.2595; train_optim_loss: 17058766.2595; val_kl_reg_loss: 82086.3083; val_edge_recon_loss: 2789680.8500; val_gene_expr_recon_loss: 11895349.6667; val_masked_gp_l1_reg_loss: 68226.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77508.0156; val_chrom_access_recon_loss: 2051378.3583; val_global_loss: 16964230.2667; val_optim_loss: 16964230.2667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9397; val_auprc_score: 0.9235; val_best_acc_score: 0.8787; val_best_f1_score: 0.8846; train_kl_reg_loss: 81499.7665; train_edge_recon_loss: 2777931.0344; train_gene_expr_recon_loss: 11917130.0305; train_masked_gp_l1_reg_loss: 68882.5737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75245.8383; train_chrom_access_recon_loss: 2059528.8950; train_global_loss: 16980218.1603; train_optim_loss: 16980218.1603; val_kl_reg_loss: 77200.2568; val_edge_recon_loss: 2769899.6000; val_gene_expr_recon_loss: 11812155.2667; val_masked_gp_l1_reg_loss: 69558.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74216.8672; val_chrom_access_recon_loss: 2036726.6500; val_global_loss: 16839757.6667; val_optim_loss: 16839757.6667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9423; val_auprc_score: 0.9312; val_best_acc_score: 0.8748; val_best_f1_score: 0.8814; train_kl_reg_loss: 80305.9390; train_edge_recon_loss: 2756436.2290; train_gene_expr_recon_loss: 11849398.8702; train_masked_gp_l1_reg_loss: 70179.1431; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72829.7108; train_chrom_access_recon_loss: 2046174.3578; train_global_loss: 16875324.3206; train_optim_loss: 16875324.3206; val_kl_reg_loss: 79525.6161; val_edge_recon_loss: 2765510.7833; val_gene_expr_recon_loss: 11757085.1333; val_masked_gp_l1_reg_loss: 70640.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72311.2266; val_chrom_access_recon_loss: 2026348.9417; val_global_loss: 16771421.5333; val_optim_loss: 16771421.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9405; val_auprc_score: 0.9230; val_best_acc_score: 0.8793; val_best_f1_score: 0.8871; train_kl_reg_loss: 76390.5425; train_edge_recon_loss: 2751991.3187; train_gene_expr_recon_loss: 11789631.9466; train_masked_gp_l1_reg_loss: 71257.8466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72166.3093; train_chrom_access_recon_loss: 2036335.2958; train_global_loss: 16797773.1527; train_optim_loss: 16797773.1527; val_kl_reg_loss: 74769.2812; val_edge_recon_loss: 2760575.0333; val_gene_expr_recon_loss: 11714450.7333; val_masked_gp_l1_reg_loss: 71778.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72455.6172; val_chrom_access_recon_loss: 2021208.9667; val_global_loss: 16715238.9333; val_optim_loss: 16715238.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9483; val_auprc_score: 0.9362; val_best_acc_score: 0.8829; val_best_f1_score: 0.8894; train_kl_reg_loss: 75808.2037; train_edge_recon_loss: 2729511.5897; train_gene_expr_recon_loss: 11726320.4809; train_masked_gp_l1_reg_loss: 72293.5022; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73000.7320; train_chrom_access_recon_loss: 2026765.6011; train_global_loss: 16703699.9924; train_optim_loss: 16703699.9924; val_kl_reg_loss: 74150.1271; val_edge_recon_loss: 2733657.2667; val_gene_expr_recon_loss: 11698187.4667; val_masked_gp_l1_reg_loss: 72767.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73639.3047; val_chrom_access_recon_loss: 2024630.9417; val_global_loss: 16677031.6667; val_optim_loss: 16677031.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9509; val_auprc_score: 0.9361; val_best_acc_score: 0.8929; val_best_f1_score: 0.8981; train_kl_reg_loss: 75207.7018; train_edge_recon_loss: 2725744.4790; train_gene_expr_recon_loss: 11673444.6947; train_masked_gp_l1_reg_loss: 73090.0529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73132.1885; train_chrom_access_recon_loss: 2016306.3216; train_global_loss: 16636925.4885; train_optim_loss: 16636925.4885; val_kl_reg_loss: 72619.0219; val_edge_recon_loss: 2720602.2000; val_gene_expr_recon_loss: 11601910.2000; val_masked_gp_l1_reg_loss: 73378.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73096.5547; val_chrom_access_recon_loss: 1996253.1583; val_global_loss: 16537860.4000; val_optim_loss: 16537860.4000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9550; val_auprc_score: 0.9424; val_best_acc_score: 0.8944; val_best_f1_score: 0.8997; train_kl_reg_loss: 73558.2771; train_edge_recon_loss: 2722023.0592; train_gene_expr_recon_loss: 11637198.5954; train_masked_gp_l1_reg_loss: 73670.0270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72556.8753; train_chrom_access_recon_loss: 2012365.6918; train_global_loss: 16591372.5267; train_optim_loss: 16591372.5267; val_kl_reg_loss: 68232.8461; val_edge_recon_loss: 2744649.7167; val_gene_expr_recon_loss: 11554927.0000; val_masked_gp_l1_reg_loss: 73906.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72587.7031; val_chrom_access_recon_loss: 2000385.6167; val_global_loss: 16514689.2000; val_optim_loss: 16514689.2000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9540; val_auprc_score: 0.9394; val_best_acc_score: 0.8983; val_best_f1_score: 0.9020; train_kl_reg_loss: 71635.3665; train_edge_recon_loss: 2714169.3817; train_gene_expr_recon_loss: 11589985.3740; train_masked_gp_l1_reg_loss: 74225.7826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72064.6266; train_chrom_access_recon_loss: 2001969.0344; train_global_loss: 16524049.4656; train_optim_loss: 16524049.4656; val_kl_reg_loss: 68897.0214; val_edge_recon_loss: 2729936.5333; val_gene_expr_recon_loss: 11470788.7333; val_masked_gp_l1_reg_loss: 74602.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72003.6172; val_chrom_access_recon_loss: 1977255.8333; val_global_loss: 16393485.0667; val_optim_loss: 16393485.0667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9553; val_auprc_score: 0.9420; val_best_acc_score: 0.8977; val_best_f1_score: 0.9023; train_kl_reg_loss: 70843.9451; train_edge_recon_loss: 2706371.6813; train_gene_expr_recon_loss: 11547980.8244; train_masked_gp_l1_reg_loss: 74826.0033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71595.4311; train_chrom_access_recon_loss: 1993737.1135; train_global_loss: 16465354.8702; train_optim_loss: 16465354.8702; val_kl_reg_loss: 69374.2104; val_edge_recon_loss: 2721869.2000; val_gene_expr_recon_loss: 11478015.1333; val_masked_gp_l1_reg_loss: 75123.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71934.6250; val_chrom_access_recon_loss: 1982285.8083; val_global_loss: 16398602.0667; val_optim_loss: 16398602.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9632; val_auprc_score: 0.9530; val_best_acc_score: 0.9065; val_best_f1_score: 0.9110; train_kl_reg_loss: 70906.2774; train_edge_recon_loss: 2706506.0324; train_gene_expr_recon_loss: 11513243.1145; train_masked_gp_l1_reg_loss: 75154.7103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71239.2167; train_chrom_access_recon_loss: 1985400.0420; train_global_loss: 16422449.4504; train_optim_loss: 16422449.4504; val_kl_reg_loss: 68797.2896; val_edge_recon_loss: 2718813.7333; val_gene_expr_recon_loss: 11434581.6000; val_masked_gp_l1_reg_loss: 75378.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71878.6172; val_chrom_access_recon_loss: 1965394.8583; val_global_loss: 16334845.3333; val_optim_loss: 16334845.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9613; val_auprc_score: 0.9483; val_best_acc_score: 0.9034; val_best_f1_score: 0.9086; train_kl_reg_loss: 70298.0101; train_edge_recon_loss: 2695511.2156; train_gene_expr_recon_loss: 11482774.5954; train_masked_gp_l1_reg_loss: 75513.0793; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71069.4608; train_chrom_access_recon_loss: 1981068.4265; train_global_loss: 16376234.8015; train_optim_loss: 16376234.8015; val_kl_reg_loss: 69222.1854; val_edge_recon_loss: 2701622.3667; val_gene_expr_recon_loss: 11466328.8000; val_masked_gp_l1_reg_loss: 75738.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70962.9766; val_chrom_access_recon_loss: 1982328.6083; val_global_loss: 16366204.0000; val_optim_loss: 16366204.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9638; val_auprc_score: 0.9546; val_best_acc_score: 0.9091; val_best_f1_score: 0.9127; train_kl_reg_loss: 70229.3955; train_edge_recon_loss: 2696990.9160; train_gene_expr_recon_loss: 11461065.4046; train_masked_gp_l1_reg_loss: 75715.3504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71011.5665; train_chrom_access_recon_loss: 1976412.5859; train_global_loss: 16351425.2290; train_optim_loss: 16351425.2290; val_kl_reg_loss: 68792.7906; val_edge_recon_loss: 2701769.0667; val_gene_expr_recon_loss: 11386060.0000; val_masked_gp_l1_reg_loss: 75988.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71083.7656; val_chrom_access_recon_loss: 1960530.7000; val_global_loss: 16264225.5333; val_optim_loss: 16264225.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9629; val_auprc_score: 0.9536; val_best_acc_score: 0.9086; val_best_f1_score: 0.9129; train_kl_reg_loss: 69214.9012; train_edge_recon_loss: 2685741.5057; train_gene_expr_recon_loss: 11444304.9695; train_masked_gp_l1_reg_loss: 75908.7682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70800.7057; train_chrom_access_recon_loss: 1971023.9943; train_global_loss: 16316994.9008; train_optim_loss: 16316994.9008; val_kl_reg_loss: 68053.0474; val_edge_recon_loss: 2702936.5167; val_gene_expr_recon_loss: 11376880.6667; val_masked_gp_l1_reg_loss: 76042.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70960.4375; val_chrom_access_recon_loss: 1961816.2000; val_global_loss: 16256689.2667; val_optim_loss: 16256689.2667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9626; val_auprc_score: 0.9506; val_best_acc_score: 0.9082; val_best_f1_score: 0.9136; train_kl_reg_loss: 68760.3605; train_edge_recon_loss: 2696001.1832; train_gene_expr_recon_loss: 11417074.6794; train_masked_gp_l1_reg_loss: 76062.9052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70721.3470; train_chrom_access_recon_loss: 1966361.7844; train_global_loss: 16294982.2824; train_optim_loss: 16294982.2824; val_kl_reg_loss: 69214.7281; val_edge_recon_loss: 2703784.4000; val_gene_expr_recon_loss: 11345289.2000; val_masked_gp_l1_reg_loss: 76214.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70735.1953; val_chrom_access_recon_loss: 1950060.7500; val_global_loss: 16215299.0667; val_optim_loss: 16215299.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9634; val_auprc_score: 0.9522; val_best_acc_score: 0.9148; val_best_f1_score: 0.9175; train_kl_reg_loss: 68581.7237; train_edge_recon_loss: 2687357.2023; train_gene_expr_recon_loss: 11381513.3588; train_masked_gp_l1_reg_loss: 76213.9651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70582.5781; train_chrom_access_recon_loss: 1960589.0992; train_global_loss: 16244837.9542; train_optim_loss: 16244837.9542; val_kl_reg_loss: 65442.7781; val_edge_recon_loss: 2707712.9500; val_gene_expr_recon_loss: 11291375.9333; val_masked_gp_l1_reg_loss: 76263.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70409.2500; val_chrom_access_recon_loss: 1939580.6000; val_global_loss: 16150784.2000; val_optim_loss: 16150784.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9681; val_auprc_score: 0.9576; val_best_acc_score: 0.9175; val_best_f1_score: 0.9212; train_kl_reg_loss: 67262.2538; train_edge_recon_loss: 2686488.8454; train_gene_expr_recon_loss: 11372439.2901; train_masked_gp_l1_reg_loss: 76328.6232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70496.5426; train_chrom_access_recon_loss: 1958818.4074; train_global_loss: 16231834.0076; train_optim_loss: 16231834.0076; val_kl_reg_loss: 67088.9365; val_edge_recon_loss: 2688297.0000; val_gene_expr_recon_loss: 11332259.0000; val_masked_gp_l1_reg_loss: 76419.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70511.2578; val_chrom_access_recon_loss: 1950805.0417; val_global_loss: 16185380.8667; val_optim_loss: 16185380.8667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9714; val_auprc_score: 0.9607; val_best_acc_score: 0.9251; val_best_f1_score: 0.9281; train_kl_reg_loss: 66782.0778; train_edge_recon_loss: 2682392.0134; train_gene_expr_recon_loss: 11354384.1221; train_masked_gp_l1_reg_loss: 76413.5057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70730.1790; train_chrom_access_recon_loss: 1953918.5439; train_global_loss: 16204620.4885; train_optim_loss: 16204620.4885; val_kl_reg_loss: 67322.0690; val_edge_recon_loss: 2693052.3167; val_gene_expr_recon_loss: 11307751.8667; val_masked_gp_l1_reg_loss: 76441.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70603.0781; val_chrom_access_recon_loss: 1940536.5333; val_global_loss: 16155707.6667; val_optim_loss: 16155707.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9707; val_auprc_score: 0.9637; val_best_acc_score: 0.9217; val_best_f1_score: 0.9253; train_kl_reg_loss: 66359.7157; train_edge_recon_loss: 2686114.0286; train_gene_expr_recon_loss: 11333456.7710; train_masked_gp_l1_reg_loss: 76377.4017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70622.0959; train_chrom_access_recon_loss: 1949776.0181; train_global_loss: 16182706.0305; train_optim_loss: 16182706.0305; val_kl_reg_loss: 65855.8411; val_edge_recon_loss: 2680472.6500; val_gene_expr_recon_loss: 11269184.6667; val_masked_gp_l1_reg_loss: 76216.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70868.8672; val_chrom_access_recon_loss: 1936544.5917; val_global_loss: 16099143.2667; val_optim_loss: 16099143.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9698; val_auprc_score: 0.9585; val_best_acc_score: 0.9227; val_best_f1_score: 0.9252; train_kl_reg_loss: 66404.5980; train_edge_recon_loss: 2677931.2061; train_gene_expr_recon_loss: 11324335.9389; train_masked_gp_l1_reg_loss: 76278.2797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70894.4269; train_chrom_access_recon_loss: 1947560.7500; train_global_loss: 16163405.1450; train_optim_loss: 16163405.1450; val_kl_reg_loss: 65380.3208; val_edge_recon_loss: 2692452.2667; val_gene_expr_recon_loss: 11246279.3333; val_masked_gp_l1_reg_loss: 76289.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70556.0312; val_chrom_access_recon_loss: 1930033.5667; val_global_loss: 16080991.4667; val_optim_loss: 16080991.4667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9674; val_auprc_score: 0.9591; val_best_acc_score: 0.9166; val_best_f1_score: 0.9191; train_kl_reg_loss: 85145.4757; train_edge_recon_loss: 2771224.4656; train_gene_expr_recon_loss: 10176444.6412; train_masked_gp_l1_reg_loss: 75090.7236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66884.9199; train_chrom_access_recon_loss: 1755252.2786; train_global_loss: 14930042.4885; train_optim_loss: 14930042.4885; val_kl_reg_loss: 23477.1630; val_edge_recon_loss: 2720796.8333; val_gene_expr_recon_loss: 10121318.5333; val_masked_gp_l1_reg_loss: 73709.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68059.4375; val_chrom_access_recon_loss: 1741716.7417; val_global_loss: 14749077.2000; val_optim_loss: 14749077.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9675; val_auprc_score: 0.9584; val_best_acc_score: 0.9204; val_best_f1_score: 0.9229; train_kl_reg_loss: 64461.5631; train_edge_recon_loss: 2699009.9771; train_gene_expr_recon_loss: 10124572.7634; train_masked_gp_l1_reg_loss: 72173.9739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68792.8656; train_chrom_access_recon_loss: 1742665.2891; train_global_loss: 14771676.4046; train_optim_loss: 14771676.4046; val_kl_reg_loss: 29448.1423; val_edge_recon_loss: 2702977.8833; val_gene_expr_recon_loss: 10102738.3333; val_masked_gp_l1_reg_loss: 70722.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69265.1562; val_chrom_access_recon_loss: 1733112.3667; val_global_loss: 14708264.6000; val_optim_loss: 14708264.6000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9702; val_auprc_score: 0.9611; val_best_acc_score: 0.9200; val_best_f1_score: 0.9236; train_kl_reg_loss: 54374.4721; train_edge_recon_loss: 2694632.5286; train_gene_expr_recon_loss: 10101154.1756; train_masked_gp_l1_reg_loss: 69376.2925; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69663.5871; train_chrom_access_recon_loss: 1741551.2223; train_global_loss: 14730752.2824; train_optim_loss: 14730752.2824; val_kl_reg_loss: 31991.5715; val_edge_recon_loss: 2684606.5000; val_gene_expr_recon_loss: 10059008.8000; val_masked_gp_l1_reg_loss: 68022.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69903.8281; val_chrom_access_recon_loss: 1730640.9167; val_global_loss: 14644175.0667; val_optim_loss: 14644175.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9716; val_auprc_score: 0.9623; val_best_acc_score: 0.9267; val_best_f1_score: 0.9296; train_kl_reg_loss: 50649.4289; train_edge_recon_loss: 2678944.3931; train_gene_expr_recon_loss: 10090787.5191; train_masked_gp_l1_reg_loss: 66734.7342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69925.9504; train_chrom_access_recon_loss: 1738727.2042; train_global_loss: 14695769.1908; train_optim_loss: 14695769.1908; val_kl_reg_loss: 33434.4862; val_edge_recon_loss: 2660945.8500; val_gene_expr_recon_loss: 10032830.8000; val_masked_gp_l1_reg_loss: 65564.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70244.7812; val_chrom_access_recon_loss: 1734373.8250; val_global_loss: 14597394.8667; val_optim_loss: 14597394.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9715; val_auprc_score: 0.9639; val_best_acc_score: 0.9235; val_best_f1_score: 0.9260; train_kl_reg_loss: 48980.1366; train_edge_recon_loss: 2675651.7977; train_gene_expr_recon_loss: 10074609.5878; train_masked_gp_l1_reg_loss: 64360.1406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69855.3497; train_chrom_access_recon_loss: 1733270.1212; train_global_loss: 14666727.1298; train_optim_loss: 14666727.1298; val_kl_reg_loss: 34853.9125; val_edge_recon_loss: 2685996.9833; val_gene_expr_recon_loss: 10031213.0667; val_masked_gp_l1_reg_loss: 63197.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70042.7422; val_chrom_access_recon_loss: 1724103.2750; val_global_loss: 14609408.4000; val_optim_loss: 14609408.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9691; val_auprc_score: 0.9570; val_best_acc_score: 0.9223; val_best_f1_score: 0.9256; train_kl_reg_loss: 48797.6204; train_edge_recon_loss: 2670663.1813; train_gene_expr_recon_loss: 10058769.1298; train_masked_gp_l1_reg_loss: 62263.7948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69812.7952; train_chrom_access_recon_loss: 1733936.2681; train_global_loss: 14644242.7634; train_optim_loss: 14644242.7634; val_kl_reg_loss: 36976.8177; val_edge_recon_loss: 2668858.0667; val_gene_expr_recon_loss: 10004398.0667; val_masked_gp_l1_reg_loss: 61345.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69983.9844; val_chrom_access_recon_loss: 1719465.4500; val_global_loss: 14561028.4000; val_optim_loss: 14561028.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9707; val_auprc_score: 0.9598; val_best_acc_score: 0.9271; val_best_f1_score: 0.9298; train_kl_reg_loss: 47635.8758; train_edge_recon_loss: 2668277.8989; train_gene_expr_recon_loss: 10024538.3282; train_masked_gp_l1_reg_loss: 60519.5064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69847.5247; train_chrom_access_recon_loss: 1728038.8349; train_global_loss: 14598858.0076; train_optim_loss: 14598858.0076; val_kl_reg_loss: 36222.2492; val_edge_recon_loss: 2670436.7667; val_gene_expr_recon_loss: 9974142.5333; val_masked_gp_l1_reg_loss: 59707.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69513.0391; val_chrom_access_recon_loss: 1716938.5750; val_global_loss: 14526961.2000; val_optim_loss: 14526961.2000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9722; val_auprc_score: 0.9640; val_best_acc_score: 0.9239; val_best_f1_score: 0.9272; train_kl_reg_loss: 46665.9993; train_edge_recon_loss: 2666920.2214; train_gene_expr_recon_loss: 10006570.7099; train_masked_gp_l1_reg_loss: 59010.7097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69659.8833; train_chrom_access_recon_loss: 1726372.2395; train_global_loss: 14575199.7710; train_optim_loss: 14575199.7710; val_kl_reg_loss: 39052.9292; val_edge_recon_loss: 2668997.7000; val_gene_expr_recon_loss: 9950916.9333; val_masked_gp_l1_reg_loss: 58484.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69515.5078; val_chrom_access_recon_loss: 1712171.2167; val_global_loss: 14499139.8000; val_optim_loss: 14499139.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9693; val_auprc_score: 0.9577; val_best_acc_score: 0.9214; val_best_f1_score: 0.9252; train_kl_reg_loss: 46131.1829; train_edge_recon_loss: 2667005.5305; train_gene_expr_recon_loss: 9995985.3359; train_masked_gp_l1_reg_loss: 57867.6992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69724.1164; train_chrom_access_recon_loss: 1722966.2863; train_global_loss: 14559680.0305; train_optim_loss: 14559680.0305; val_kl_reg_loss: 39010.2229; val_edge_recon_loss: 2675173.5833; val_gene_expr_recon_loss: 9932316.8000; val_masked_gp_l1_reg_loss: 57343.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69789.6094; val_chrom_access_recon_loss: 1705008.9667; val_global_loss: 14478643.4667; val_optim_loss: 14478643.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9722; val_auprc_score: 0.9644; val_best_acc_score: 0.9243; val_best_f1_score: 0.9263; train_kl_reg_loss: 46193.0983; train_edge_recon_loss: 2662301.0763; train_gene_expr_recon_loss: 9968253.9160; train_masked_gp_l1_reg_loss: 56820.6452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69785.6292; train_chrom_access_recon_loss: 1718962.9389; train_global_loss: 14522317.3130; train_optim_loss: 14522317.3130; val_kl_reg_loss: 39681.9026; val_edge_recon_loss: 2684482.8667; val_gene_expr_recon_loss: 9915011.0667; val_masked_gp_l1_reg_loss: 56445.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69805.1016; val_chrom_access_recon_loss: 1707742.4250; val_global_loss: 14473169.4667; val_optim_loss: 14473169.4667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9750; val_auprc_score: 0.9669; val_best_acc_score: 0.9334; val_best_f1_score: 0.9359; train_kl_reg_loss: 45224.9173; train_edge_recon_loss: 2657598.6813; train_gene_expr_recon_loss: 9968388.5573; train_masked_gp_l1_reg_loss: 56014.7050; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69816.2213; train_chrom_access_recon_loss: 1718064.5324; train_global_loss: 14515107.5954; train_optim_loss: 14515107.5954; val_kl_reg_loss: 39163.1297; val_edge_recon_loss: 2661787.4500; val_gene_expr_recon_loss: 9951261.8000; val_masked_gp_l1_reg_loss: 55622.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69620.7422; val_chrom_access_recon_loss: 1714762.1500; val_global_loss: 14492218.5333; val_optim_loss: 14492218.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9723; val_auprc_score: 0.9606; val_best_acc_score: 0.9275; val_best_f1_score: 0.9306; train_kl_reg_loss: 44530.5383; train_edge_recon_loss: 2665984.1126; train_gene_expr_recon_loss: 9954021.3740; train_masked_gp_l1_reg_loss: 55365.7073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69640.9719; train_chrom_access_recon_loss: 1717556.2939; train_global_loss: 14507098.9618; train_optim_loss: 14507098.9618; val_kl_reg_loss: 40547.5036; val_edge_recon_loss: 2660503.8667; val_gene_expr_recon_loss: 9878649.0667; val_masked_gp_l1_reg_loss: 55083.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69857.4609; val_chrom_access_recon_loss: 1707832.5583; val_global_loss: 14412473.8000; val_optim_loss: 14412473.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9747; val_auprc_score: 0.9663; val_best_acc_score: 0.9336; val_best_f1_score: 0.9353; train_kl_reg_loss: 45975.7120; train_edge_recon_loss: 2661470.0191; train_gene_expr_recon_loss: 9927462.4580; train_masked_gp_l1_reg_loss: 54737.9045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69520.1626; train_chrom_access_recon_loss: 1713321.3721; train_global_loss: 14472487.6183; train_optim_loss: 14472487.6183; val_kl_reg_loss: 39774.2323; val_edge_recon_loss: 2645469.9000; val_gene_expr_recon_loss: 9882408.0667; val_masked_gp_l1_reg_loss: 54401.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69389.0469; val_chrom_access_recon_loss: 1701676.6250; val_global_loss: 14393119.0000; val_optim_loss: 14393119.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9718; val_auprc_score: 0.9592; val_best_acc_score: 0.9306; val_best_f1_score: 0.9331; train_kl_reg_loss: 44622.3025; train_edge_recon_loss: 2659977.3416; train_gene_expr_recon_loss: 9927634.7786; train_masked_gp_l1_reg_loss: 54169.4942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69503.1353; train_chrom_access_recon_loss: 1714083.2223; train_global_loss: 14469990.2443; train_optim_loss: 14469990.2443; val_kl_reg_loss: 40193.1893; val_edge_recon_loss: 2685795.0833; val_gene_expr_recon_loss: 9888586.0667; val_masked_gp_l1_reg_loss: 53902.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69614.5938; val_chrom_access_recon_loss: 1705163.1500; val_global_loss: 14443255.4667; val_optim_loss: 14443255.4667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9759; val_auprc_score: 0.9651; val_best_acc_score: 0.9382; val_best_f1_score: 0.9396; train_kl_reg_loss: 44603.0943; train_edge_recon_loss: 2664648.3282; train_gene_expr_recon_loss: 9927326.0153; train_masked_gp_l1_reg_loss: 53757.3920; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69517.6736; train_chrom_access_recon_loss: 1714900.5859; train_global_loss: 14474753.1374; train_optim_loss: 14474753.1374; val_kl_reg_loss: 40100.2841; val_edge_recon_loss: 2661501.9833; val_gene_expr_recon_loss: 9885548.0667; val_masked_gp_l1_reg_loss: 53422.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69803.5469; val_chrom_access_recon_loss: 1703038.3333; val_global_loss: 14413415.8667; val_optim_loss: 14413415.8667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9763; val_auprc_score: 0.9668; val_best_acc_score: 0.9379; val_best_f1_score: 0.9394; train_kl_reg_loss: 44587.3622; train_edge_recon_loss: 2654793.0095; train_gene_expr_recon_loss: 9916453.2595; train_masked_gp_l1_reg_loss: 53293.0986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69570.2971; train_chrom_access_recon_loss: 1710496.5439; train_global_loss: 14449193.5649; train_optim_loss: 14449193.5649; val_kl_reg_loss: 40897.6813; val_edge_recon_loss: 2654387.2000; val_gene_expr_recon_loss: 9865956.0000; val_masked_gp_l1_reg_loss: 53006.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69401.7891; val_chrom_access_recon_loss: 1700524.2167; val_global_loss: 14384173.1333; val_optim_loss: 14384173.1333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9778; val_auprc_score: 0.9710; val_best_acc_score: 0.9369; val_best_f1_score: 0.9385; train_kl_reg_loss: 44557.0205; train_edge_recon_loss: 2659505.2901; train_gene_expr_recon_loss: 9901881.2977; train_masked_gp_l1_reg_loss: 52737.7224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69522.0225; train_chrom_access_recon_loss: 1706280.9179; train_global_loss: 14434484.2061; train_optim_loss: 14434484.2061; val_kl_reg_loss: 42152.5813; val_edge_recon_loss: 2654123.5167; val_gene_expr_recon_loss: 9902137.3333; val_masked_gp_l1_reg_loss: 52559.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69813.6328; val_chrom_access_recon_loss: 1705449.3500; val_global_loss: 14426235.8000; val_optim_loss: 14426235.8000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9738; val_auprc_score: 0.9658; val_best_acc_score: 0.9307; val_best_f1_score: 0.9332; train_kl_reg_loss: 44215.7296; train_edge_recon_loss: 2654944.3034; train_gene_expr_recon_loss: 9901019.2214; train_masked_gp_l1_reg_loss: 52372.2739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69576.3613; train_chrom_access_recon_loss: 1708220.8731; train_global_loss: 14430348.8092; train_optim_loss: 14430348.8092; val_kl_reg_loss: 42266.5565; val_edge_recon_loss: 2672273.5333; val_gene_expr_recon_loss: 9871696.0000; val_masked_gp_l1_reg_loss: 52185.9961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69610.1641; val_chrom_access_recon_loss: 1701421.3667; val_global_loss: 14409453.6667; val_optim_loss: 14409453.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9778; val_auprc_score: 0.9655; val_best_acc_score: 0.9417; val_best_f1_score: 0.9432; train_kl_reg_loss: 44207.8296; train_edge_recon_loss: 2650273.2691; train_gene_expr_recon_loss: 9889163.9771; train_masked_gp_l1_reg_loss: 51878.0065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69446.8103; train_chrom_access_recon_loss: 1706084.8273; train_global_loss: 14411054.7939; train_optim_loss: 14411054.7939; val_kl_reg_loss: 41037.5563; val_edge_recon_loss: 2654154.4167; val_gene_expr_recon_loss: 9874802.4667; val_masked_gp_l1_reg_loss: 51750.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69637.0938; val_chrom_access_recon_loss: 1700196.6417; val_global_loss: 14391579.0000; val_optim_loss: 14391579.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9767; val_auprc_score: 0.9685; val_best_acc_score: 0.9373; val_best_f1_score: 0.9392; train_kl_reg_loss: 43496.4589; train_edge_recon_loss: 2657214.3130; train_gene_expr_recon_loss: 9887171.8168; train_masked_gp_l1_reg_loss: 51566.4205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69696.0874; train_chrom_access_recon_loss: 1706397.2271; train_global_loss: 14415542.3053; train_optim_loss: 14415542.3053; val_kl_reg_loss: 41724.0807; val_edge_recon_loss: 2655349.0500; val_gene_expr_recon_loss: 9876280.9333; val_masked_gp_l1_reg_loss: 51381.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69815.8281; val_chrom_access_recon_loss: 1696243.2250; val_global_loss: 14390794.2667; val_optim_loss: 14390794.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9770; val_auprc_score: 0.9652; val_best_acc_score: 0.9387; val_best_f1_score: 0.9404; train_kl_reg_loss: 44163.6756; train_edge_recon_loss: 2658255.2080; train_gene_expr_recon_loss: 9881277.9313; train_masked_gp_l1_reg_loss: 50993.5681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58864.7600; train_chrom_access_recon_loss: 1705120.6746; train_global_loss: 14398675.8779; train_optim_loss: 14398675.8779; val_kl_reg_loss: 41977.2635; val_edge_recon_loss: 2673737.5167; val_gene_expr_recon_loss: 9852477.8000; val_masked_gp_l1_reg_loss: 50878.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57125.9844; val_chrom_access_recon_loss: 1694868.2500; val_global_loss: 14371065.7333; val_optim_loss: 14371065.7333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9780; val_auprc_score: 0.9704; val_best_acc_score: 0.9357; val_best_f1_score: 0.9378; train_kl_reg_loss: 45018.5449; train_edge_recon_loss: 2645029.6966; train_gene_expr_recon_loss: 9876654.2214; train_masked_gp_l1_reg_loss: 50840.9868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56650.0861; train_chrom_access_recon_loss: 1704015.1517; train_global_loss: 14378208.6870; train_optim_loss: 14378208.6870; val_kl_reg_loss: 43298.7943; val_edge_recon_loss: 2659620.6833; val_gene_expr_recon_loss: 9824637.2667; val_masked_gp_l1_reg_loss: 50808.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56245.8711; val_chrom_access_recon_loss: 1693511.0917; val_global_loss: 14328123.0000; val_optim_loss: 14328123.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9759; val_auprc_score: 0.9684; val_best_acc_score: 0.9345; val_best_f1_score: 0.9370; train_kl_reg_loss: 45694.5214; train_edge_recon_loss: 2646617.7252; train_gene_expr_recon_loss: 9864723.6412; train_masked_gp_l1_reg_loss: 50773.5372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55994.5191; train_chrom_access_recon_loss: 1702922.6536; train_global_loss: 14366726.6412; train_optim_loss: 14366726.6412; val_kl_reg_loss: 43923.0323; val_edge_recon_loss: 2675587.0167; val_gene_expr_recon_loss: 9854933.2667; val_masked_gp_l1_reg_loss: 50740.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55681.9805; val_chrom_access_recon_loss: 1693502.6833; val_global_loss: 14374368.1333; val_optim_loss: 14374368.1333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9764; val_auprc_score: 0.9646; val_best_acc_score: 0.9372; val_best_f1_score: 0.9395; train_kl_reg_loss: 46500.1614; train_edge_recon_loss: 2655607.8740; train_gene_expr_recon_loss: 9873054.3893; train_masked_gp_l1_reg_loss: 50713.6301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55461.5420; train_chrom_access_recon_loss: 1704668.1116; train_global_loss: 14386005.7863; train_optim_loss: 14386005.7863; val_kl_reg_loss: 43974.7070; val_edge_recon_loss: 2647191.9333; val_gene_expr_recon_loss: 9862425.4000; val_masked_gp_l1_reg_loss: 50689.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55251.8359; val_chrom_access_recon_loss: 1697725.2667; val_global_loss: 14357259.2000; val_optim_loss: 14357259.2000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9796; val_auprc_score: 0.9736; val_best_acc_score: 0.9378; val_best_f1_score: 0.9400; train_kl_reg_loss: 46163.7713; train_edge_recon_loss: 2650880.5191; train_gene_expr_recon_loss: 9869477.6489; train_masked_gp_l1_reg_loss: 50652.5217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55097.1490; train_chrom_access_recon_loss: 1704730.9084; train_global_loss: 14377002.5954; train_optim_loss: 14377002.5954; val_kl_reg_loss: 43166.7901; val_edge_recon_loss: 2656385.3500; val_gene_expr_recon_loss: 9855854.1333; val_masked_gp_l1_reg_loss: 50624.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54888.9805; val_chrom_access_recon_loss: 1696018.9500; val_global_loss: 14356939.0667; val_optim_loss: 14356939.0667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9784; val_auprc_score: 0.9671; val_best_acc_score: 0.9402; val_best_f1_score: 0.9421; train_kl_reg_loss: 46119.9490; train_edge_recon_loss: 2651361.6202; train_gene_expr_recon_loss: 9869492.0992; train_masked_gp_l1_reg_loss: 50600.3922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54799.1255; train_chrom_access_recon_loss: 1702860.7414; train_global_loss: 14375233.9389; train_optim_loss: 14375233.9389; val_kl_reg_loss: 43796.1607; val_edge_recon_loss: 2649603.3000; val_gene_expr_recon_loss: 9850442.6667; val_masked_gp_l1_reg_loss: 50571.4492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54637.6094; val_chrom_access_recon_loss: 1696863.9083; val_global_loss: 14345915.2667; val_optim_loss: 14345915.2667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9780; val_auprc_score: 0.9668; val_best_acc_score: 0.9390; val_best_f1_score: 0.9408; train_kl_reg_loss: 46445.8864; train_edge_recon_loss: 2650625.5267; train_gene_expr_recon_loss: 9861164.2824; train_masked_gp_l1_reg_loss: 50529.8798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53510.3178; train_chrom_access_recon_loss: 1701160.0191; train_global_loss: 14363435.8473; train_optim_loss: 14363435.8473; val_kl_reg_loss: 44085.9427; val_edge_recon_loss: 2650757.0000; val_gene_expr_recon_loss: 9837640.2667; val_masked_gp_l1_reg_loss: 50514.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53348.6172; val_chrom_access_recon_loss: 1699334.2083; val_global_loss: 14335680.3333; val_optim_loss: 14335680.3333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9744; val_auprc_score: 0.9639; val_best_acc_score: 0.9340; val_best_f1_score: 0.9360; train_kl_reg_loss: 46640.6537; train_edge_recon_loss: 2648532.7901; train_gene_expr_recon_loss: 9876383.9466; train_masked_gp_l1_reg_loss: 50507.5473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53291.3878; train_chrom_access_recon_loss: 1705600.2567; train_global_loss: 14380956.5649; train_optim_loss: 14380956.5649; val_kl_reg_loss: 43754.1784; val_edge_recon_loss: 2670066.5833; val_gene_expr_recon_loss: 9863582.6667; val_masked_gp_l1_reg_loss: 50500.8086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53241.8828; val_chrom_access_recon_loss: 1698365.4167; val_global_loss: 14379511.9333; val_optim_loss: 14379511.9333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9744; val_auprc_score: 0.9652; val_best_acc_score: 0.9352; val_best_f1_score: 0.9371; train_kl_reg_loss: 46499.0652; train_edge_recon_loss: 2652338.8989; train_gene_expr_recon_loss: 9869711.7863; train_masked_gp_l1_reg_loss: 50497.0655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53201.4222; train_chrom_access_recon_loss: 1703236.9265; train_global_loss: 14375485.2061; train_optim_loss: 14375485.2061; val_kl_reg_loss: 44124.1695; val_edge_recon_loss: 2664530.6500; val_gene_expr_recon_loss: 9851015.6000; val_masked_gp_l1_reg_loss: 50492.9492; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53164.8477; val_chrom_access_recon_loss: 1692290.3167; val_global_loss: 14355618.9333; val_optim_loss: 14355618.9333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9794; val_auprc_score: 0.9728; val_best_acc_score: 0.9400; val_best_f1_score: 0.9423; train_kl_reg_loss: 46571.6317; train_edge_recon_loss: 2647815.5191; train_gene_expr_recon_loss: 9865370.9771; train_masked_gp_l1_reg_loss: 50489.9727; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53135.1668; train_chrom_access_recon_loss: 1702528.8235; train_global_loss: 14365912.1221; train_optim_loss: 14365912.1221; val_kl_reg_loss: 43937.8294; val_edge_recon_loss: 2642159.5167; val_gene_expr_recon_loss: 9868915.1333; val_masked_gp_l1_reg_loss: 50485.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53100.2188; val_chrom_access_recon_loss: 1699561.6917; val_global_loss: 14358160.2000; val_optim_loss: 14358160.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 47 min 49 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9773
val AUPRC score: 0.9673
val best accuracy score: 0.9373
val best F1 score: 0.9398
val target rna MSE score: 1.7715
val source rna MSE score: 0.5604
val target atac MSE score: 0.3315
val source atac MSE score: 0.1054
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
