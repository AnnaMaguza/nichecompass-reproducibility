[True]
Run timestamp: 10102023_024247_114.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_114']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7828; val_auprc_score: 0.7974; val_best_acc_score: 0.6236; val_best_f1_score: 0.7182; train_kl_reg_loss: 79349.7542; train_edge_recon_loss: 3512242.0821; train_gene_expr_recon_loss: 13244749.5191; train_masked_gp_l1_reg_loss: 84779.8990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1933412.6820; train_chrom_access_recon_loss: 4771013.2901; train_global_loss: 23625547.3435; train_optim_loss: 23625547.3435; val_kl_reg_loss: 112184.2224; val_edge_recon_loss: 4058828.5000; val_gene_expr_recon_loss: 12570872.5333; val_masked_gp_l1_reg_loss: 73509.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 435937.9375; val_chrom_access_recon_loss: 4623963.7333; val_global_loss: 21875297.0667; val_optim_loss: 21875297.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8219; val_auprc_score: 0.8281; val_best_acc_score: 0.7369; val_best_f1_score: 0.7509; train_kl_reg_loss: 78978.9257; train_edge_recon_loss: 3456609.1775; train_gene_expr_recon_loss: 12555824.2824; train_masked_gp_l1_reg_loss: 75294.9125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 228542.8781; train_chrom_access_recon_loss: 4607113.2595; train_global_loss: 21002363.5420; train_optim_loss: 21002363.5420; val_kl_reg_loss: 66449.5503; val_edge_recon_loss: 3358322.2167; val_gene_expr_recon_loss: 12361782.3333; val_masked_gp_l1_reg_loss: 79591.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135012.1719; val_chrom_access_recon_loss: 4546589.4333; val_global_loss: 20547746.2667; val_optim_loss: 20547746.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9041; val_auprc_score: 0.8889; val_best_acc_score: 0.8296; val_best_f1_score: 0.8390; train_kl_reg_loss: 89688.4335; train_edge_recon_loss: 3003503.3321; train_gene_expr_recon_loss: 12421343.3130; train_masked_gp_l1_reg_loss: 84575.3409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108939.9946; train_chrom_access_recon_loss: 4561811.8626; train_global_loss: 20269862.2901; train_optim_loss: 20269862.2901; val_kl_reg_loss: 104299.7859; val_edge_recon_loss: 2887966.4833; val_gene_expr_recon_loss: 12275231.4000; val_masked_gp_l1_reg_loss: 88664.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95979.3750; val_chrom_access_recon_loss: 4504771.1000; val_global_loss: 19956911.8667; val_optim_loss: 19956911.8667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9274; val_auprc_score: 0.9129; val_best_acc_score: 0.8619; val_best_f1_score: 0.8682; train_kl_reg_loss: 103097.4827; train_edge_recon_loss: 2838222.1565; train_gene_expr_recon_loss: 12283423.7328; train_masked_gp_l1_reg_loss: 90882.9150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90084.4519; train_chrom_access_recon_loss: 4519396.7672; train_global_loss: 19925107.5420; train_optim_loss: 19925107.5420; val_kl_reg_loss: 99638.5214; val_edge_recon_loss: 2822495.0333; val_gene_expr_recon_loss: 12108877.9333; val_masked_gp_l1_reg_loss: 92521.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84240.6562; val_chrom_access_recon_loss: 4453863.2833; val_global_loss: 19661637.8667; val_optim_loss: 19661637.8667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9312; val_auprc_score: 0.9152; val_best_acc_score: 0.8658; val_best_f1_score: 0.8730; train_kl_reg_loss: 98515.4628; train_edge_recon_loss: 2805428.7844; train_gene_expr_recon_loss: 12148816.1221; train_masked_gp_l1_reg_loss: 93739.3220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81475.1212; train_chrom_access_recon_loss: 4475596.9561; train_global_loss: 19703571.7710; train_optim_loss: 19703571.7710; val_kl_reg_loss: 96552.8984; val_edge_recon_loss: 2790336.7500; val_gene_expr_recon_loss: 12043135.0000; val_masked_gp_l1_reg_loss: 94959.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78874.6250; val_chrom_access_recon_loss: 4443684.5333; val_global_loss: 19547544.2667; val_optim_loss: 19547544.2667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9286; val_auprc_score: 0.9126; val_best_acc_score: 0.8634; val_best_f1_score: 0.8734; train_kl_reg_loss: 94704.7753; train_edge_recon_loss: 2798158.5897; train_gene_expr_recon_loss: 12047126.4809; train_masked_gp_l1_reg_loss: 96161.2495; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76673.4071; train_chrom_access_recon_loss: 4435016.2691; train_global_loss: 19547840.7481; train_optim_loss: 19547840.7481; val_kl_reg_loss: 91684.3568; val_edge_recon_loss: 2820563.3333; val_gene_expr_recon_loss: 11919341.5333; val_masked_gp_l1_reg_loss: 97092.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74491.8516; val_chrom_access_recon_loss: 4392256.1833; val_global_loss: 19395429.6000; val_optim_loss: 19395429.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9387; val_auprc_score: 0.9226; val_best_acc_score: 0.8720; val_best_f1_score: 0.8809; train_kl_reg_loss: 91757.0626; train_edge_recon_loss: 2782383.0458; train_gene_expr_recon_loss: 11973961.1221; train_masked_gp_l1_reg_loss: 98089.7179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72553.1302; train_chrom_access_recon_loss: 4410174.8740; train_global_loss: 19428918.8550; train_optim_loss: 19428918.8550; val_kl_reg_loss: 90488.4104; val_edge_recon_loss: 2782873.0500; val_gene_expr_recon_loss: 11838279.8000; val_masked_gp_l1_reg_loss: 99082.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71316.3203; val_chrom_access_recon_loss: 4346451.6833; val_global_loss: 19228491.0667; val_optim_loss: 19228491.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9412; val_auprc_score: 0.9283; val_best_acc_score: 0.8801; val_best_f1_score: 0.8869; train_kl_reg_loss: 88659.0841; train_edge_recon_loss: 2777084.1679; train_gene_expr_recon_loss: 11897675.6412; train_masked_gp_l1_reg_loss: 99826.5029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69243.9720; train_chrom_access_recon_loss: 4383698.3263; train_global_loss: 19316187.5725; train_optim_loss: 19316187.5725; val_kl_reg_loss: 84558.7453; val_edge_recon_loss: 2787629.5000; val_gene_expr_recon_loss: 11752983.7333; val_masked_gp_l1_reg_loss: 100968.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68123.8828; val_chrom_access_recon_loss: 4328545.5333; val_global_loss: 19122809.3333; val_optim_loss: 19122809.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9447; val_auprc_score: 0.9307; val_best_acc_score: 0.8874; val_best_f1_score: 0.8920; train_kl_reg_loss: 87367.7114; train_edge_recon_loss: 2759177.2080; train_gene_expr_recon_loss: 11830411.7252; train_masked_gp_l1_reg_loss: 101316.6073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66909.8763; train_chrom_access_recon_loss: 4355141.5229; train_global_loss: 19200324.6870; train_optim_loss: 19200324.6870; val_kl_reg_loss: 87516.6948; val_edge_recon_loss: 2756928.8000; val_gene_expr_recon_loss: 11693909.6667; val_masked_gp_l1_reg_loss: 102063.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66293.4297; val_chrom_access_recon_loss: 4320418.3167; val_global_loss: 19027129.6000; val_optim_loss: 19027129.6000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9449; val_auprc_score: 0.9313; val_best_acc_score: 0.8857; val_best_f1_score: 0.8914; train_kl_reg_loss: 86362.0431; train_edge_recon_loss: 2754040.5763; train_gene_expr_recon_loss: 11772366.0458; train_masked_gp_l1_reg_loss: 102281.9146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65217.8689; train_chrom_access_recon_loss: 4327487.5668; train_global_loss: 19107756.0305; train_optim_loss: 19107756.0305; val_kl_reg_loss: 87861.0958; val_edge_recon_loss: 2762771.2333; val_gene_expr_recon_loss: 11648690.8667; val_masked_gp_l1_reg_loss: 102783.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64888.9062; val_chrom_access_recon_loss: 4278633.5833; val_global_loss: 18945629.7333; val_optim_loss: 18945629.7333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9468; val_auprc_score: 0.9327; val_best_acc_score: 0.8878; val_best_f1_score: 0.8941; train_kl_reg_loss: 84205.3188; train_edge_recon_loss: 2751632.3531; train_gene_expr_recon_loss: 11719645.2595; train_masked_gp_l1_reg_loss: 103054.9543; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64501.2355; train_chrom_access_recon_loss: 4310944.0344; train_global_loss: 19033983.1450; train_optim_loss: 19033983.1450; val_kl_reg_loss: 81232.6266; val_edge_recon_loss: 2761387.4667; val_gene_expr_recon_loss: 11559087.6667; val_masked_gp_l1_reg_loss: 103482.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64262.6758; val_chrom_access_recon_loss: 4238057.1833; val_global_loss: 18807510.0000; val_optim_loss: 18807510.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9499; val_auprc_score: 0.9385; val_best_acc_score: 0.8919; val_best_f1_score: 0.8973; train_kl_reg_loss: 83394.0992; train_edge_recon_loss: 2733724.5630; train_gene_expr_recon_loss: 11664815.6336; train_masked_gp_l1_reg_loss: 103828.2965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64008.1694; train_chrom_access_recon_loss: 4282444.1889; train_global_loss: 18932215.1450; train_optim_loss: 18932215.1450; val_kl_reg_loss: 78870.2094; val_edge_recon_loss: 2750276.8833; val_gene_expr_recon_loss: 11576784.4000; val_masked_gp_l1_reg_loss: 104272.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64112.3281; val_chrom_access_recon_loss: 4251333.6333; val_global_loss: 18825649.2000; val_optim_loss: 18825649.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9572; val_auprc_score: 0.9464; val_best_acc_score: 0.9007; val_best_f1_score: 0.9050; train_kl_reg_loss: 81489.7135; train_edge_recon_loss: 2729777.7786; train_gene_expr_recon_loss: 11634637.7710; train_masked_gp_l1_reg_loss: 104568.1491; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64427.2858; train_chrom_access_recon_loss: 4272709.0859; train_global_loss: 18887609.8321; train_optim_loss: 18887609.8321; val_kl_reg_loss: 81773.6625; val_edge_recon_loss: 2721712.8167; val_gene_expr_recon_loss: 11502102.9333; val_masked_gp_l1_reg_loss: 105032.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64781.9922; val_chrom_access_recon_loss: 4217968.9000; val_global_loss: 18693372.8000; val_optim_loss: 18693372.8000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9580; val_auprc_score: 0.9479; val_best_acc_score: 0.8984; val_best_f1_score: 0.9029; train_kl_reg_loss: 81451.2684; train_edge_recon_loss: 2714458.4466; train_gene_expr_recon_loss: 11580982.0840; train_masked_gp_l1_reg_loss: 105275.4859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65178.0584; train_chrom_access_recon_loss: 4248656.0057; train_global_loss: 18796001.1908; train_optim_loss: 18796001.1908; val_kl_reg_loss: 81134.6891; val_edge_recon_loss: 2710715.1500; val_gene_expr_recon_loss: 11469549.2667; val_masked_gp_l1_reg_loss: 105873.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65633.4453; val_chrom_access_recon_loss: 4201536.7667; val_global_loss: 18634441.7333; val_optim_loss: 18634441.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9561; val_auprc_score: 0.9467; val_best_acc_score: 0.8953; val_best_f1_score: 0.8992; train_kl_reg_loss: 81396.5016; train_edge_recon_loss: 2711507.6737; train_gene_expr_recon_loss: 11558449.8855; train_masked_gp_l1_reg_loss: 105771.9191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65569.6041; train_chrom_access_recon_loss: 4233503.3645; train_global_loss: 18756198.9160; train_optim_loss: 18756198.9160; val_kl_reg_loss: 83898.7630; val_edge_recon_loss: 2747340.4167; val_gene_expr_recon_loss: 11436959.6667; val_masked_gp_l1_reg_loss: 105903.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65903.0469; val_chrom_access_recon_loss: 4204595.8000; val_global_loss: 18644601.7333; val_optim_loss: 18644601.7333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9589; val_auprc_score: 0.9487; val_best_acc_score: 0.8989; val_best_f1_score: 0.9032; train_kl_reg_loss: 80241.2239; train_edge_recon_loss: 2712994.2080; train_gene_expr_recon_loss: 11517895.5496; train_masked_gp_l1_reg_loss: 105904.5745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65412.3015; train_chrom_access_recon_loss: 4216589.6298; train_global_loss: 18699037.5267; train_optim_loss: 18699037.5267; val_kl_reg_loss: 81027.6391; val_edge_recon_loss: 2740950.6000; val_gene_expr_recon_loss: 11462419.4000; val_masked_gp_l1_reg_loss: 106067.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65814.4922; val_chrom_access_recon_loss: 4197585.0833; val_global_loss: 18653864.6667; val_optim_loss: 18653864.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9642; val_auprc_score: 0.9549; val_best_acc_score: 0.9069; val_best_f1_score: 0.9103; train_kl_reg_loss: 80189.9506; train_edge_recon_loss: 2707194.6508; train_gene_expr_recon_loss: 11492215.5725; train_masked_gp_l1_reg_loss: 106102.4662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65351.6051; train_chrom_access_recon_loss: 4202968.6870; train_global_loss: 18654022.9618; train_optim_loss: 18654022.9618; val_kl_reg_loss: 79220.1958; val_edge_recon_loss: 2726097.3500; val_gene_expr_recon_loss: 11331811.0000; val_masked_gp_l1_reg_loss: 106319.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65687.9531; val_chrom_access_recon_loss: 4140229.7333; val_global_loss: 18449365.4667; val_optim_loss: 18449365.4667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9659; val_auprc_score: 0.9564; val_best_acc_score: 0.9135; val_best_f1_score: 0.9170; train_kl_reg_loss: 78953.8095; train_edge_recon_loss: 2699721.2137; train_gene_expr_recon_loss: 11467882.6031; train_masked_gp_l1_reg_loss: 106295.5177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65426.7157; train_chrom_access_recon_loss: 4188353.2481; train_global_loss: 18606633.0534; train_optim_loss: 18606633.0534; val_kl_reg_loss: 77778.6458; val_edge_recon_loss: 2693167.7167; val_gene_expr_recon_loss: 11334507.3333; val_masked_gp_l1_reg_loss: 106384.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65713.7578; val_chrom_access_recon_loss: 4145701.3500; val_global_loss: 18423253.2000; val_optim_loss: 18423253.2000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9672; val_auprc_score: 0.9575; val_best_acc_score: 0.9159; val_best_f1_score: 0.9192; train_kl_reg_loss: 78461.4507; train_edge_recon_loss: 2701919.0515; train_gene_expr_recon_loss: 11442225.6718; train_masked_gp_l1_reg_loss: 106345.7430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65759.6341; train_chrom_access_recon_loss: 4169569.0267; train_global_loss: 18564280.5038; train_optim_loss: 18564280.5038; val_kl_reg_loss: 78051.2891; val_edge_recon_loss: 2718151.9833; val_gene_expr_recon_loss: 11312908.1333; val_masked_gp_l1_reg_loss: 106696.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65846.9297; val_chrom_access_recon_loss: 4128339.5333; val_global_loss: 18409994.0000; val_optim_loss: 18409994.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9698; val_auprc_score: 0.9629; val_best_acc_score: 0.9190; val_best_f1_score: 0.9212; train_kl_reg_loss: 79130.6942; train_edge_recon_loss: 2695409.5229; train_gene_expr_recon_loss: 11427694.2443; train_masked_gp_l1_reg_loss: 106336.0041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65658.4061; train_chrom_access_recon_loss: 4160923.5286; train_global_loss: 18535152.3817; train_optim_loss: 18535152.3817; val_kl_reg_loss: 77867.4271; val_edge_recon_loss: 2704207.0833; val_gene_expr_recon_loss: 11308599.9333; val_masked_gp_l1_reg_loss: 106258.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65902.6953; val_chrom_access_recon_loss: 4126267.1000; val_global_loss: 18389102.5333; val_optim_loss: 18389102.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9710; val_auprc_score: 0.9601; val_best_acc_score: 0.9212; val_best_f1_score: 0.9231; train_kl_reg_loss: 78031.4356; train_edge_recon_loss: 2700475.2672; train_gene_expr_recon_loss: 11387963.3969; train_masked_gp_l1_reg_loss: 106103.0652; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65716.7944; train_chrom_access_recon_loss: 4140987.5687; train_global_loss: 18479277.5115; train_optim_loss: 18479277.5115; val_kl_reg_loss: 74807.4156; val_edge_recon_loss: 2700670.1000; val_gene_expr_recon_loss: 11279283.1333; val_masked_gp_l1_reg_loss: 105865.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65885.6797; val_chrom_access_recon_loss: 4108899.9167; val_global_loss: 18335411.8667; val_optim_loss: 18335411.8667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9678; val_auprc_score: 0.9566; val_best_acc_score: 0.9178; val_best_f1_score: 0.9199; train_kl_reg_loss: 77384.8856; train_edge_recon_loss: 2692893.9809; train_gene_expr_recon_loss: 11383902.0611; train_masked_gp_l1_reg_loss: 105929.7279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65728.3093; train_chrom_access_recon_loss: 4130454.3645; train_global_loss: 18456293.3435; train_optim_loss: 18456293.3435; val_kl_reg_loss: 76713.4906; val_edge_recon_loss: 2696055.6333; val_gene_expr_recon_loss: 11301665.2000; val_masked_gp_l1_reg_loss: 105989.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66057.2031; val_chrom_access_recon_loss: 4116878.2833; val_global_loss: 18363359.8667; val_optim_loss: 18363359.8667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9734; val_auprc_score: 0.9666; val_best_acc_score: 0.9262; val_best_f1_score: 0.9290; train_kl_reg_loss: 76743.0730; train_edge_recon_loss: 2694119.8550; train_gene_expr_recon_loss: 11366934.2061; train_masked_gp_l1_reg_loss: 105849.5351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65785.0241; train_chrom_access_recon_loss: 4116316.2042; train_global_loss: 18425747.9542; train_optim_loss: 18425747.9542; val_kl_reg_loss: 77084.4646; val_edge_recon_loss: 2694373.9167; val_gene_expr_recon_loss: 11219097.2667; val_masked_gp_l1_reg_loss: 106122.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66268.3750; val_chrom_access_recon_loss: 4073176.6667; val_global_loss: 18236122.2667; val_optim_loss: 18236122.2667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9760; val_auprc_score: 0.9686; val_best_acc_score: 0.9286; val_best_f1_score: 0.9313; train_kl_reg_loss: 76849.4415; train_edge_recon_loss: 2691994.8168; train_gene_expr_recon_loss: 11343387.2672; train_masked_gp_l1_reg_loss: 105868.7906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65989.0174; train_chrom_access_recon_loss: 4103416.4313; train_global_loss: 18387505.7863; train_optim_loss: 18387505.7863; val_kl_reg_loss: 75986.0240; val_edge_recon_loss: 2683599.3500; val_gene_expr_recon_loss: 11269791.8667; val_masked_gp_l1_reg_loss: 105748.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66225.1172; val_chrom_access_recon_loss: 4112476.3000; val_global_loss: 18313827.4667; val_optim_loss: 18313827.4667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9709; val_auprc_score: 0.9616; val_best_acc_score: 0.9227; val_best_f1_score: 0.9254; train_kl_reg_loss: 75736.6341; train_edge_recon_loss: 2692906.2786; train_gene_expr_recon_loss: 11335872.6947; train_masked_gp_l1_reg_loss: 105732.0198; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66256.2040; train_chrom_access_recon_loss: 4092237.7004; train_global_loss: 18368741.4504; train_optim_loss: 18368741.4504; val_kl_reg_loss: 73467.9625; val_edge_recon_loss: 2704051.8500; val_gene_expr_recon_loss: 11268092.3333; val_masked_gp_l1_reg_loss: 105496.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66179.8438; val_chrom_access_recon_loss: 4071863.4833; val_global_loss: 18289152.5333; val_optim_loss: 18289152.5333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9696; val_auprc_score: 0.9593; val_best_acc_score: 0.9206; val_best_f1_score: 0.9235; train_kl_reg_loss: 84054.8276; train_edge_recon_loss: 2737446.2863; train_gene_expr_recon_loss: 10686212.0534; train_masked_gp_l1_reg_loss: 104848.2564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63170.2241; train_chrom_access_recon_loss: 3941324.9695; train_global_loss: 17617056.5267; train_optim_loss: 17617056.5267; val_kl_reg_loss: 44773.3721; val_edge_recon_loss: 2712199.5333; val_gene_expr_recon_loss: 10566691.0667; val_masked_gp_l1_reg_loss: 104388.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63753.6641; val_chrom_access_recon_loss: 3897013.2667; val_global_loss: 17388820.6667; val_optim_loss: 17388820.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9707; val_auprc_score: 0.9615; val_best_acc_score: 0.9224; val_best_f1_score: 0.9250; train_kl_reg_loss: 74298.5135; train_edge_recon_loss: 2701617.3397; train_gene_expr_recon_loss: 10648078.4809; train_masked_gp_l1_reg_loss: 103787.9689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64290.9837; train_chrom_access_recon_loss: 3922069.4981; train_global_loss: 17514142.7939; train_optim_loss: 17514142.7939; val_kl_reg_loss: 48487.8141; val_edge_recon_loss: 2712116.5333; val_gene_expr_recon_loss: 10519017.2000; val_masked_gp_l1_reg_loss: 103123.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64537.6289; val_chrom_access_recon_loss: 3875366.7333; val_global_loss: 17322650.1333; val_optim_loss: 17322650.1333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9741; val_auprc_score: 0.9654; val_best_acc_score: 0.9278; val_best_f1_score: 0.9301; train_kl_reg_loss: 69928.7404; train_edge_recon_loss: 2690576.8340; train_gene_expr_recon_loss: 10624385.2443; train_masked_gp_l1_reg_loss: 102368.6671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64914.4223; train_chrom_access_recon_loss: 3909195.9485; train_global_loss: 17461369.7786; train_optim_loss: 17461369.7786; val_kl_reg_loss: 51001.9599; val_edge_recon_loss: 2672488.5500; val_gene_expr_recon_loss: 10558763.3333; val_masked_gp_l1_reg_loss: 101542.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64927.6289; val_chrom_access_recon_loss: 3885037.9167; val_global_loss: 17333762.9333; val_optim_loss: 17333762.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9731; val_auprc_score: 0.9665; val_best_acc_score: 0.9275; val_best_f1_score: 0.9296; train_kl_reg_loss: 66432.6484; train_edge_recon_loss: 2694398.6603; train_gene_expr_recon_loss: 10608438.6183; train_masked_gp_l1_reg_loss: 100665.8367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64929.1969; train_chrom_access_recon_loss: 3899564.6126; train_global_loss: 17434429.6641; train_optim_loss: 17434429.6641; val_kl_reg_loss: 55574.5695; val_edge_recon_loss: 2690671.0667; val_gene_expr_recon_loss: 10501584.1333; val_masked_gp_l1_reg_loss: 99766.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64915.0781; val_chrom_access_recon_loss: 3846444.4167; val_global_loss: 17258955.0667; val_optim_loss: 17258955.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9720; val_auprc_score: 0.9603; val_best_acc_score: 0.9259; val_best_f1_score: 0.9288; train_kl_reg_loss: 65516.5900; train_edge_recon_loss: 2679969.1164; train_gene_expr_recon_loss: 10597416.7176; train_masked_gp_l1_reg_loss: 98866.7857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64510.8649; train_chrom_access_recon_loss: 3892524.9828; train_global_loss: 17398805.0534; train_optim_loss: 17398805.0534; val_kl_reg_loss: 56221.4471; val_edge_recon_loss: 2730482.8833; val_gene_expr_recon_loss: 10495800.9333; val_masked_gp_l1_reg_loss: 97864.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64070.5352; val_chrom_access_recon_loss: 3863055.4333; val_global_loss: 17307496.6667; val_optim_loss: 17307496.6667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9724; val_auprc_score: 0.9638; val_best_acc_score: 0.9256; val_best_f1_score: 0.9289; train_kl_reg_loss: 64509.1620; train_edge_recon_loss: 2676950.0363; train_gene_expr_recon_loss: 10583465.7405; train_masked_gp_l1_reg_loss: 97339.9250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64195.2875; train_chrom_access_recon_loss: 3889929.3779; train_global_loss: 17376389.4962; train_optim_loss: 17376389.4962; val_kl_reg_loss: 57610.5711; val_edge_recon_loss: 2704496.6000; val_gene_expr_recon_loss: 10507766.5333; val_masked_gp_l1_reg_loss: 96835.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63836.2891; val_chrom_access_recon_loss: 3851453.3500; val_global_loss: 17281999.1333; val_optim_loss: 17281999.1333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9739; val_auprc_score: 0.9630; val_best_acc_score: 0.9307; val_best_f1_score: 0.9329; train_kl_reg_loss: 63531.6249; train_edge_recon_loss: 2676640.1775; train_gene_expr_recon_loss: 10577386.5954; train_masked_gp_l1_reg_loss: 96264.0039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64071.0644; train_chrom_access_recon_loss: 3890183.7653; train_global_loss: 17368077.1756; train_optim_loss: 17368077.1756; val_kl_reg_loss: 59355.0445; val_edge_recon_loss: 2683897.9500; val_gene_expr_recon_loss: 10476368.8667; val_masked_gp_l1_reg_loss: 95975.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63805.2305; val_chrom_access_recon_loss: 3848940.2833; val_global_loss: 17228341.8667; val_optim_loss: 17228341.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9733; val_auprc_score: 0.9642; val_best_acc_score: 0.9274; val_best_f1_score: 0.9304; train_kl_reg_loss: 62796.3595; train_edge_recon_loss: 2675008.3989; train_gene_expr_recon_loss: 10567575.9008; train_masked_gp_l1_reg_loss: 95325.2167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63751.4156; train_chrom_access_recon_loss: 3881787.7882; train_global_loss: 17346245.0992; train_optim_loss: 17346245.0992; val_kl_reg_loss: 55380.5008; val_edge_recon_loss: 2687185.3000; val_gene_expr_recon_loss: 10493099.3333; val_masked_gp_l1_reg_loss: 94828.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63775.4023; val_chrom_access_recon_loss: 3858016.8333; val_global_loss: 17252284.8667; val_optim_loss: 17252284.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9780; val_auprc_score: 0.9712; val_best_acc_score: 0.9347; val_best_f1_score: 0.9356; train_kl_reg_loss: 62432.4707; train_edge_recon_loss: 2676728.0534; train_gene_expr_recon_loss: 10565697.7176; train_masked_gp_l1_reg_loss: 94414.2350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63520.5621; train_chrom_access_recon_loss: 3882051.1374; train_global_loss: 17344844.0840; train_optim_loss: 17344844.0840; val_kl_reg_loss: 56043.1641; val_edge_recon_loss: 2687845.1167; val_gene_expr_recon_loss: 10477971.6000; val_masked_gp_l1_reg_loss: 94056.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63354.9375; val_chrom_access_recon_loss: 3845029.4333; val_global_loss: 17224301.4667; val_optim_loss: 17224301.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9724; val_auprc_score: 0.9626; val_best_acc_score: 0.9278; val_best_f1_score: 0.9306; train_kl_reg_loss: 61992.2066; train_edge_recon_loss: 2674894.2863; train_gene_expr_recon_loss: 10542766.1756; train_masked_gp_l1_reg_loss: 93721.2769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63201.0179; train_chrom_access_recon_loss: 3874505.3225; train_global_loss: 17311080.3282; train_optim_loss: 17311080.3282; val_kl_reg_loss: 59752.5055; val_edge_recon_loss: 2702041.1667; val_gene_expr_recon_loss: 10430600.8000; val_masked_gp_l1_reg_loss: 93420.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63231.6094; val_chrom_access_recon_loss: 3828719.0167; val_global_loss: 17177766.6000; val_optim_loss: 17177766.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9745; val_auprc_score: 0.9667; val_best_acc_score: 0.9291; val_best_f1_score: 0.9316; train_kl_reg_loss: 62775.3016; train_edge_recon_loss: 2672998.9656; train_gene_expr_recon_loss: 10537825.3740; train_masked_gp_l1_reg_loss: 92940.5468; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63014.9194; train_chrom_access_recon_loss: 3868502.2767; train_global_loss: 17298057.4809; train_optim_loss: 17298057.4809; val_kl_reg_loss: 57489.9333; val_edge_recon_loss: 2687120.7000; val_gene_expr_recon_loss: 10403083.4000; val_masked_gp_l1_reg_loss: 92646.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63081.8906; val_chrom_access_recon_loss: 3822227.9167; val_global_loss: 17125651.0667; val_optim_loss: 17125651.0667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9764; val_auprc_score: 0.9656; val_best_acc_score: 0.9336; val_best_f1_score: 0.9357; train_kl_reg_loss: 61969.1287; train_edge_recon_loss: 2670321.2634; train_gene_expr_recon_loss: 10535940.2901; train_masked_gp_l1_reg_loss: 92274.4720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62944.5575; train_chrom_access_recon_loss: 3867070.7271; train_global_loss: 17290520.3740; train_optim_loss: 17290520.3740; val_kl_reg_loss: 56561.4924; val_edge_recon_loss: 2677270.4500; val_gene_expr_recon_loss: 10423232.6000; val_masked_gp_l1_reg_loss: 91958.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62749.7461; val_chrom_access_recon_loss: 3833101.2000; val_global_loss: 17144873.7333; val_optim_loss: 17144873.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9757; val_auprc_score: 0.9642; val_best_acc_score: 0.9338; val_best_f1_score: 0.9352; train_kl_reg_loss: 61312.6960; train_edge_recon_loss: 2668408.5115; train_gene_expr_recon_loss: 10525099.8092; train_masked_gp_l1_reg_loss: 91610.4692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62746.3599; train_chrom_access_recon_loss: 3861292.7042; train_global_loss: 17270470.6260; train_optim_loss: 17270470.6260; val_kl_reg_loss: 58345.9599; val_edge_recon_loss: 2687572.0500; val_gene_expr_recon_loss: 10406683.6667; val_masked_gp_l1_reg_loss: 91220.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62547.1484; val_chrom_access_recon_loss: 3827075.0500; val_global_loss: 17133443.7333; val_optim_loss: 17133443.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9773; val_auprc_score: 0.9685; val_best_acc_score: 0.9353; val_best_f1_score: 0.9375; train_kl_reg_loss: 61175.3914; train_edge_recon_loss: 2676292.1546; train_gene_expr_recon_loss: 10502174.3435; train_masked_gp_l1_reg_loss: 91025.7448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62294.5468; train_chrom_access_recon_loss: 3852190.6050; train_global_loss: 17245152.8473; train_optim_loss: 17245152.8473; val_kl_reg_loss: 57298.6318; val_edge_recon_loss: 2691106.5000; val_gene_expr_recon_loss: 10417047.8000; val_masked_gp_l1_reg_loss: 90844.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62165.2695; val_chrom_access_recon_loss: 3812303.5000; val_global_loss: 17130766.5333; val_optim_loss: 17130766.5333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9771; val_auprc_score: 0.9714; val_best_acc_score: 0.9348; val_best_f1_score: 0.9363; train_kl_reg_loss: 60620.2084; train_edge_recon_loss: 2675143.4218; train_gene_expr_recon_loss: 10499065.6107; train_masked_gp_l1_reg_loss: 90623.3432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62139.9623; train_chrom_access_recon_loss: 3848592.6889; train_global_loss: 17236185.1832; train_optim_loss: 17236185.1832; val_kl_reg_loss: 58077.0667; val_edge_recon_loss: 2681191.2833; val_gene_expr_recon_loss: 10451166.3333; val_masked_gp_l1_reg_loss: 90328.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61890.9102; val_chrom_access_recon_loss: 3837459.0333; val_global_loss: 17180113.8000; val_optim_loss: 17180113.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9795; val_auprc_score: 0.9735; val_best_acc_score: 0.9414; val_best_f1_score: 0.9433; train_kl_reg_loss: 62271.5033; train_edge_recon_loss: 2667350.7156; train_gene_expr_recon_loss: 10481390.8931; train_masked_gp_l1_reg_loss: 87962.8835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52464.2132; train_chrom_access_recon_loss: 3848316.6393; train_global_loss: 17199756.8626; train_optim_loss: 17199756.8626; val_kl_reg_loss: 58776.6375; val_edge_recon_loss: 2663125.6500; val_gene_expr_recon_loss: 10411195.9333; val_masked_gp_l1_reg_loss: 87354.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50907.3711; val_chrom_access_recon_loss: 3829564.6500; val_global_loss: 17100924.8000; val_optim_loss: 17100924.8000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9802; val_auprc_score: 0.9759; val_best_acc_score: 0.9380; val_best_f1_score: 0.9400; train_kl_reg_loss: 63317.4883; train_edge_recon_loss: 2661232.5267; train_gene_expr_recon_loss: 10471567.2137; train_masked_gp_l1_reg_loss: 87229.5186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50421.8390; train_chrom_access_recon_loss: 3844063.4714; train_global_loss: 17177831.9466; train_optim_loss: 17177831.9466; val_kl_reg_loss: 60813.9469; val_edge_recon_loss: 2671232.2333; val_gene_expr_recon_loss: 10412451.6667; val_masked_gp_l1_reg_loss: 87137.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50093.6289; val_chrom_access_recon_loss: 3828924.1500; val_global_loss: 17110653.0000; val_optim_loss: 17110653.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9773; val_auprc_score: 0.9676; val_best_acc_score: 0.9396; val_best_f1_score: 0.9411; train_kl_reg_loss: 64279.6959; train_edge_recon_loss: 2658287.9637; train_gene_expr_recon_loss: 10479383.5344; train_masked_gp_l1_reg_loss: 87060.6320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49857.7922; train_chrom_access_recon_loss: 3845092.5420; train_global_loss: 17183962.1450; train_optim_loss: 17183962.1450; val_kl_reg_loss: 59969.7128; val_edge_recon_loss: 2684206.9000; val_gene_expr_recon_loss: 10423675.6000; val_masked_gp_l1_reg_loss: 86984.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49641.4844; val_chrom_access_recon_loss: 3828873.9500; val_global_loss: 17133351.7333; val_optim_loss: 17133351.7333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9790; val_auprc_score: 0.9694; val_best_acc_score: 0.9392; val_best_f1_score: 0.9412; train_kl_reg_loss: 64265.3909; train_edge_recon_loss: 2666139.8092; train_gene_expr_recon_loss: 10472786.8397; train_masked_gp_l1_reg_loss: 86944.2632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49477.3970; train_chrom_access_recon_loss: 3845898.7710; train_global_loss: 17185512.4046; train_optim_loss: 17185512.4046; val_kl_reg_loss: 60702.3242; val_edge_recon_loss: 2673913.7000; val_gene_expr_recon_loss: 10404852.5333; val_masked_gp_l1_reg_loss: 86902.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49354.0430; val_chrom_access_recon_loss: 3840483.8000; val_global_loss: 17116208.0667; val_optim_loss: 17116208.0667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9797; val_auprc_score: 0.9733; val_best_acc_score: 0.9398; val_best_f1_score: 0.9413; train_kl_reg_loss: 64367.3880; train_edge_recon_loss: 2666054.0954; train_gene_expr_recon_loss: 10468609.7176; train_masked_gp_l1_reg_loss: 86849.6965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49165.2051; train_chrom_access_recon_loss: 3843613.7691; train_global_loss: 17178659.9618; train_optim_loss: 17178659.9618; val_kl_reg_loss: 60376.4302; val_edge_recon_loss: 2682687.8500; val_gene_expr_recon_loss: 10409601.8667; val_masked_gp_l1_reg_loss: 86804.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49023.4844; val_chrom_access_recon_loss: 3821510.7167; val_global_loss: 17110004.0667; val_optim_loss: 17110004.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9780; val_auprc_score: 0.9717; val_best_acc_score: 0.9382; val_best_f1_score: 0.9396; train_kl_reg_loss: 64021.8879; train_edge_recon_loss: 2668228.2061; train_gene_expr_recon_loss: 10466719.5496; train_masked_gp_l1_reg_loss: 86568.1085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48077.7612; train_chrom_access_recon_loss: 3843562.7500; train_global_loss: 17177178.2901; train_optim_loss: 17177178.2901; val_kl_reg_loss: 60935.1865; val_edge_recon_loss: 2674797.5333; val_gene_expr_recon_loss: 10344851.8667; val_masked_gp_l1_reg_loss: 86489.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47899.0234; val_chrom_access_recon_loss: 3806436.6833; val_global_loss: 17021410.1333; val_optim_loss: 17021410.1333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9787; val_auprc_score: 0.9721; val_best_acc_score: 0.9391; val_best_f1_score: 0.9414; train_kl_reg_loss: 64336.7482; train_edge_recon_loss: 2659984.9752; train_gene_expr_recon_loss: 10469049.8931; train_masked_gp_l1_reg_loss: 86464.0682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47838.3166; train_chrom_access_recon_loss: 3842545.7042; train_global_loss: 17170219.8321; train_optim_loss: 17170219.8321; val_kl_reg_loss: 61296.0214; val_edge_recon_loss: 2669790.0667; val_gene_expr_recon_loss: 10384298.2667; val_masked_gp_l1_reg_loss: 86443.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47776.4414; val_chrom_access_recon_loss: 3817934.9667; val_global_loss: 17067539.1333; val_optim_loss: 17067539.1333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9790; val_auprc_score: 0.9718; val_best_acc_score: 0.9403; val_best_f1_score: 0.9422; train_kl_reg_loss: 64426.2022; train_edge_recon_loss: 2663965.4752; train_gene_expr_recon_loss: 10474345.9008; train_masked_gp_l1_reg_loss: 86428.5812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47733.7639; train_chrom_access_recon_loss: 3846075.0802; train_global_loss: 17182975.1908; train_optim_loss: 17182975.1908; val_kl_reg_loss: 60755.3083; val_edge_recon_loss: 2660499.6667; val_gene_expr_recon_loss: 10338281.0667; val_masked_gp_l1_reg_loss: 86417.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47692.7734; val_chrom_access_recon_loss: 3793564.9833; val_global_loss: 16987212.2000; val_optim_loss: 16987212.2000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9817; val_auprc_score: 0.9753; val_best_acc_score: 0.9462; val_best_f1_score: 0.9476; train_kl_reg_loss: 64543.7754; train_edge_recon_loss: 2663186.6336; train_gene_expr_recon_loss: 10472206.7405; train_masked_gp_l1_reg_loss: 86407.8694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47660.6798; train_chrom_access_recon_loss: 3844286.8531; train_global_loss: 17178292.5267; train_optim_loss: 17178292.5267; val_kl_reg_loss: 61115.0815; val_edge_recon_loss: 2656877.8000; val_gene_expr_recon_loss: 10395702.3333; val_masked_gp_l1_reg_loss: 86397.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47629.4375; val_chrom_access_recon_loss: 3835986.5000; val_global_loss: 17083708.6667; val_optim_loss: 17083708.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9813; val_auprc_score: 0.9743; val_best_acc_score: 0.9425; val_best_f1_score: 0.9440; train_kl_reg_loss: 64448.2709; train_edge_recon_loss: 2666161.5344; train_gene_expr_recon_loss: 10479447.4809; train_masked_gp_l1_reg_loss: 86390.5376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47598.0053; train_chrom_access_recon_loss: 3848682.3664; train_global_loss: 17192728.2519; train_optim_loss: 17192728.2519; val_kl_reg_loss: 61244.6227; val_edge_recon_loss: 2662789.6667; val_gene_expr_recon_loss: 10415913.5333; val_masked_gp_l1_reg_loss: 86382.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47564.1953; val_chrom_access_recon_loss: 3834637.3167; val_global_loss: 17108531.0667; val_optim_loss: 17108531.0667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9765; val_auprc_score: 0.9662; val_best_acc_score: 0.9375; val_best_f1_score: 0.9396; train_kl_reg_loss: 64531.9110; train_edge_recon_loss: 2669931.3569; train_gene_expr_recon_loss: 10475187.2443; train_masked_gp_l1_reg_loss: 86377.4862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47543.5806; train_chrom_access_recon_loss: 3849724.3454; train_global_loss: 17193296.0000; train_optim_loss: 17193296.0000; val_kl_reg_loss: 61140.3354; val_edge_recon_loss: 2693153.0667; val_gene_expr_recon_loss: 10392358.7333; val_masked_gp_l1_reg_loss: 86371.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47513.6875; val_chrom_access_recon_loss: 3820207.3833; val_global_loss: 17100744.4667; val_optim_loss: 17100744.4667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9784; val_auprc_score: 0.9718; val_best_acc_score: 0.9384; val_best_f1_score: 0.9396; train_kl_reg_loss: 64743.2761; train_edge_recon_loss: 2660890.8683; train_gene_expr_recon_loss: 10475219.1832; train_masked_gp_l1_reg_loss: 86366.4944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47498.8955; train_chrom_access_recon_loss: 3845750.1221; train_global_loss: 17180468.8015; train_optim_loss: 17180468.8015; val_kl_reg_loss: 61466.9286; val_edge_recon_loss: 2668838.3833; val_gene_expr_recon_loss: 10399030.8000; val_masked_gp_l1_reg_loss: 86358.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47472.1836; val_chrom_access_recon_loss: 3813806.4333; val_global_loss: 17076972.5333; val_optim_loss: 17076972.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9801; val_auprc_score: 0.9739; val_best_acc_score: 0.9403; val_best_f1_score: 0.9419; train_kl_reg_loss: 64669.4350; train_edge_recon_loss: 2662017.9027; train_gene_expr_recon_loss: 10474788.7557; train_masked_gp_l1_reg_loss: 86334.5458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47377.8044; train_chrom_access_recon_loss: 3844960.8531; train_global_loss: 17180149.3359; train_optim_loss: 17180149.3359; val_kl_reg_loss: 61405.4159; val_edge_recon_loss: 2679298.7333; val_gene_expr_recon_loss: 10438889.2000; val_masked_gp_l1_reg_loss: 86327.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47361.5469; val_chrom_access_recon_loss: 3829490.5333; val_global_loss: 17142773.0000; val_optim_loss: 17142773.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9816; val_auprc_score: 0.9758; val_best_acc_score: 0.9423; val_best_f1_score: 0.9441; train_kl_reg_loss: 64797.1540; train_edge_recon_loss: 2662090.7576; train_gene_expr_recon_loss: 10479920.5115; train_masked_gp_l1_reg_loss: 86324.9102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47355.8582; train_chrom_access_recon_loss: 3848058.8969; train_global_loss: 17188548.0763; train_optim_loss: 17188548.0763; val_kl_reg_loss: 61564.4576; val_edge_recon_loss: 2668549.9167; val_gene_expr_recon_loss: 10408945.1333; val_masked_gp_l1_reg_loss: 86322.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47350.3203; val_chrom_access_recon_loss: 3822553.5667; val_global_loss: 17095286.0000; val_optim_loss: 17095286.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9823; val_auprc_score: 0.9764; val_best_acc_score: 0.9429; val_best_f1_score: 0.9443; train_kl_reg_loss: 64714.1512; train_edge_recon_loss: 2668498.4523; train_gene_expr_recon_loss: 10459975.2214; train_masked_gp_l1_reg_loss: 86320.8328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47345.2627; train_chrom_access_recon_loss: 3836450.7099; train_global_loss: 17163304.7099; train_optim_loss: 17163304.7099; val_kl_reg_loss: 61237.9883; val_edge_recon_loss: 2670379.7000; val_gene_expr_recon_loss: 10377100.9333; val_masked_gp_l1_reg_loss: 86319.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47340.9258; val_chrom_access_recon_loss: 3812134.1167; val_global_loss: 17054512.6667; val_optim_loss: 17054512.6667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9808; val_auprc_score: 0.9754; val_best_acc_score: 0.9415; val_best_f1_score: 0.9429; train_kl_reg_loss: 64648.1534; train_edge_recon_loss: 2661834.2767; train_gene_expr_recon_loss: 10467211.4122; train_masked_gp_l1_reg_loss: 86318.1683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47337.5131; train_chrom_access_recon_loss: 3842751.2977; train_global_loss: 17170100.9695; train_optim_loss: 17170100.9695; val_kl_reg_loss: 61223.6638; val_edge_recon_loss: 2660557.3500; val_gene_expr_recon_loss: 10427488.6000; val_masked_gp_l1_reg_loss: 86316.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47333.6055; val_chrom_access_recon_loss: 3822733.6167; val_global_loss: 17105654.2000; val_optim_loss: 17105654.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 36 min 9 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9819
val AUPRC score: 0.9769
val best accuracy score: 0.9431
val best F1 score: 0.9448
val target rna MSE score: 1.3973
val source rna MSE score: 0.5275
val target atac MSE score: 0.4856
val source atac MSE score: 0.1493
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
