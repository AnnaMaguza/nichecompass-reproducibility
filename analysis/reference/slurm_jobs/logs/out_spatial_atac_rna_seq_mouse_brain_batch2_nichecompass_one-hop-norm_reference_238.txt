[True]
Run timestamp: 10102023_104121_238.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_238']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7817; val_auprc_score: 0.8041; val_best_acc_score: 0.5058; val_best_f1_score: 0.6685; train_kl_reg_loss: 55516.7894; train_edge_recon_loss: 737576.8783; train_gene_expr_recon_loss: 22278513.3893; train_masked_gp_l1_reg_loss: 131261.4620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3314858.2700; train_chrom_access_recon_loss: 6730987.3550; train_global_loss: 33248714.1832; train_optim_loss: 33248714.1832; val_kl_reg_loss: 73688.5323; val_edge_recon_loss: 812942.7167; val_gene_expr_recon_loss: 20916138.2667; val_masked_gp_l1_reg_loss: 109584.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 806680.0625; val_chrom_access_recon_loss: 6472943.7000; val_global_loss: 29191977.0667; val_optim_loss: 29191977.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8889; val_auprc_score: 0.8926; val_best_acc_score: 0.7167; val_best_f1_score: 0.7709; train_kl_reg_loss: 71699.9562; train_edge_recon_loss: 733745.3655; train_gene_expr_recon_loss: 20958490.9924; train_masked_gp_l1_reg_loss: 105911.3433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 413667.5413; train_chrom_access_recon_loss: 6491487.3664; train_global_loss: 28775002.6107; train_optim_loss: 28775002.6107; val_kl_reg_loss: 62981.4016; val_edge_recon_loss: 809896.4625; val_gene_expr_recon_loss: 20609066.1333; val_masked_gp_l1_reg_loss: 104618.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 225536.7031; val_chrom_access_recon_loss: 6398238.1333; val_global_loss: 28210336.4000; val_optim_loss: 28210336.4000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9016; val_auprc_score: 0.8982; val_best_acc_score: 0.8034; val_best_f1_score: 0.8243; train_kl_reg_loss: 63212.8958; train_edge_recon_loss: 723994.5840; train_gene_expr_recon_loss: 20644967.5267; train_masked_gp_l1_reg_loss: 106192.0056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 173118.5050; train_chrom_access_recon_loss: 6400741.8740; train_global_loss: 28112227.2977; train_optim_loss: 28112227.2977; val_kl_reg_loss: 56495.4638; val_edge_recon_loss: 773110.6250; val_gene_expr_recon_loss: 20359935.4667; val_masked_gp_l1_reg_loss: 108919.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 144476.2188; val_chrom_access_recon_loss: 6321485.2333; val_global_loss: 27764422.8000; val_optim_loss: 27764422.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8893; val_auprc_score: 0.8760; val_best_acc_score: 0.8084; val_best_f1_score: 0.8185; train_kl_reg_loss: 62012.1205; train_edge_recon_loss: 683316.0095; train_gene_expr_recon_loss: 20393015.0992; train_masked_gp_l1_reg_loss: 111449.9343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133325.7062; train_chrom_access_recon_loss: 6328908.1832; train_global_loss: 27712027.0840; train_optim_loss: 27712027.0840; val_kl_reg_loss: 70209.4391; val_edge_recon_loss: 653262.6083; val_gene_expr_recon_loss: 20229398.2667; val_masked_gp_l1_reg_loss: 114226.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125084.5312; val_chrom_access_recon_loss: 6271197.3667; val_global_loss: 27463377.4667; val_optim_loss: 27463377.4667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9070; val_auprc_score: 0.8970; val_best_acc_score: 0.8238; val_best_f1_score: 0.8333; train_kl_reg_loss: 70828.9028; train_edge_recon_loss: 637316.2476; train_gene_expr_recon_loss: 20201363.1756; train_masked_gp_l1_reg_loss: 115109.7020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118735.0411; train_chrom_access_recon_loss: 6283525.5687; train_global_loss: 27426878.7023; train_optim_loss: 27426878.7023; val_kl_reg_loss: 69640.7448; val_edge_recon_loss: 627827.0458; val_gene_expr_recon_loss: 19946881.6000; val_masked_gp_l1_reg_loss: 116097.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113619.4219; val_chrom_access_recon_loss: 6190936.4333; val_global_loss: 27065003.7333; val_optim_loss: 27065003.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9129; val_auprc_score: 0.9043; val_best_acc_score: 0.8266; val_best_f1_score: 0.8418; train_kl_reg_loss: 70237.4604; train_edge_recon_loss: 624842.2786; train_gene_expr_recon_loss: 20050561.3588; train_masked_gp_l1_reg_loss: 117278.2843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108098.2004; train_chrom_access_recon_loss: 6236660.1260; train_global_loss: 27207677.6183; train_optim_loss: 27207677.6183; val_kl_reg_loss: 70068.6521; val_edge_recon_loss: 614797.2167; val_gene_expr_recon_loss: 19810926.2667; val_masked_gp_l1_reg_loss: 118025.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104264.9844; val_chrom_access_recon_loss: 6138276.1333; val_global_loss: 26856358.2667; val_optim_loss: 26856358.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9212; val_auprc_score: 0.9071; val_best_acc_score: 0.8409; val_best_f1_score: 0.8527; train_kl_reg_loss: 70133.9708; train_edge_recon_loss: 614752.3359; train_gene_expr_recon_loss: 19915506.6870; train_masked_gp_l1_reg_loss: 118482.4684; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101437.2272; train_chrom_access_recon_loss: 6195029.1794; train_global_loss: 27015341.6794; train_optim_loss: 27015341.6794; val_kl_reg_loss: 70549.3443; val_edge_recon_loss: 615219.4500; val_gene_expr_recon_loss: 19720393.7333; val_masked_gp_l1_reg_loss: 119367.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100134.9062; val_chrom_access_recon_loss: 6143968.7000; val_global_loss: 26769633.2000; val_optim_loss: 26769633.2000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9266; val_auprc_score: 0.9107; val_best_acc_score: 0.8496; val_best_f1_score: 0.8612; train_kl_reg_loss: 69452.7593; train_edge_recon_loss: 611920.2514; train_gene_expr_recon_loss: 19773456.9466; train_masked_gp_l1_reg_loss: 119678.4512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98203.1201; train_chrom_access_recon_loss: 6157092.1450; train_global_loss: 26829803.7405; train_optim_loss: 26829803.7405; val_kl_reg_loss: 70750.5193; val_edge_recon_loss: 613181.7458; val_gene_expr_recon_loss: 19587814.5333; val_masked_gp_l1_reg_loss: 120155.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97050.8750; val_chrom_access_recon_loss: 6104006.2000; val_global_loss: 26592958.9333; val_optim_loss: 26592958.9333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9392; val_auprc_score: 0.9279; val_best_acc_score: 0.8651; val_best_f1_score: 0.8740; train_kl_reg_loss: 69480.7703; train_edge_recon_loss: 606463.0363; train_gene_expr_recon_loss: 19665885.1756; train_masked_gp_l1_reg_loss: 120366.8766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95459.7785; train_chrom_access_recon_loss: 6113208.4771; train_global_loss: 26670864.0763; train_optim_loss: 26670864.0763; val_kl_reg_loss: 67822.9708; val_edge_recon_loss: 603607.8417; val_gene_expr_recon_loss: 19471985.2000; val_masked_gp_l1_reg_loss: 120406.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95145.4375; val_chrom_access_recon_loss: 6076562.3000; val_global_loss: 26435530.4000; val_optim_loss: 26435530.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9414; val_auprc_score: 0.9317; val_best_acc_score: 0.8709; val_best_f1_score: 0.8777; train_kl_reg_loss: 69322.0291; train_edge_recon_loss: 601447.6932; train_gene_expr_recon_loss: 19553725.7863; train_masked_gp_l1_reg_loss: 120977.4625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93276.7531; train_chrom_access_recon_loss: 6080344.1450; train_global_loss: 26519093.7863; train_optim_loss: 26519093.7863; val_kl_reg_loss: 66121.5742; val_edge_recon_loss: 603796.4125; val_gene_expr_recon_loss: 19331676.8000; val_masked_gp_l1_reg_loss: 121369.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92915.6641; val_chrom_access_recon_loss: 6020544.2333; val_global_loss: 26236424.8000; val_optim_loss: 26236424.8000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9487; val_auprc_score: 0.9407; val_best_acc_score: 0.8832; val_best_f1_score: 0.8874; train_kl_reg_loss: 68590.5697; train_edge_recon_loss: 598787.9327; train_gene_expr_recon_loss: 19462387.5115; train_masked_gp_l1_reg_loss: 121711.2866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91209.5599; train_chrom_access_recon_loss: 6049212.8053; train_global_loss: 26391899.7863; train_optim_loss: 26391899.7863; val_kl_reg_loss: 69283.1167; val_edge_recon_loss: 601777.5958; val_gene_expr_recon_loss: 19351807.6000; val_masked_gp_l1_reg_loss: 121978.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90755.5234; val_chrom_access_recon_loss: 6044812.9667; val_global_loss: 26280415.2000; val_optim_loss: 26280415.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9529; val_auprc_score: 0.9407; val_best_acc_score: 0.8884; val_best_f1_score: 0.8924; train_kl_reg_loss: 68173.4968; train_edge_recon_loss: 597043.1536; train_gene_expr_recon_loss: 19384932.3664; train_masked_gp_l1_reg_loss: 122132.4761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89316.5116; train_chrom_access_recon_loss: 6026227.8702; train_global_loss: 26287825.9542; train_optim_loss: 26287825.9542; val_kl_reg_loss: 68288.3193; val_edge_recon_loss: 600035.5250; val_gene_expr_recon_loss: 19246894.6667; val_masked_gp_l1_reg_loss: 122403.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88406.5391; val_chrom_access_recon_loss: 5973130.8667; val_global_loss: 26099159.4667; val_optim_loss: 26099159.4667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9510; val_auprc_score: 0.9381; val_best_acc_score: 0.8922; val_best_f1_score: 0.8962; train_kl_reg_loss: 67935.8968; train_edge_recon_loss: 593360.5639; train_gene_expr_recon_loss: 19319681.4198; train_masked_gp_l1_reg_loss: 122763.7553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87904.6125; train_chrom_access_recon_loss: 5999929.0954; train_global_loss: 26191575.4656; train_optim_loss: 26191575.4656; val_kl_reg_loss: 68043.2000; val_edge_recon_loss: 598277.0250; val_gene_expr_recon_loss: 19120032.6667; val_masked_gp_l1_reg_loss: 122989.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87256.3750; val_chrom_access_recon_loss: 5965766.8333; val_global_loss: 25962365.3333; val_optim_loss: 25962365.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9556; val_auprc_score: 0.9430; val_best_acc_score: 0.8948; val_best_f1_score: 0.8982; train_kl_reg_loss: 67358.2951; train_edge_recon_loss: 592513.9451; train_gene_expr_recon_loss: 19259689.6183; train_masked_gp_l1_reg_loss: 123281.8124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86768.4537; train_chrom_access_recon_loss: 5975960.6221; train_global_loss: 26105572.7023; train_optim_loss: 26105572.7023; val_kl_reg_loss: 67456.9167; val_edge_recon_loss: 595966.4667; val_gene_expr_recon_loss: 19079055.6000; val_masked_gp_l1_reg_loss: 123585.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86800.1250; val_chrom_access_recon_loss: 5927004.8333; val_global_loss: 25879870.0000; val_optim_loss: 25879870.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9567; val_auprc_score: 0.9438; val_best_acc_score: 0.8983; val_best_f1_score: 0.9022; train_kl_reg_loss: 67213.4712; train_edge_recon_loss: 590468.8211; train_gene_expr_recon_loss: 19178042.4122; train_masked_gp_l1_reg_loss: 123738.1988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85941.8933; train_chrom_access_recon_loss: 5943550.6412; train_global_loss: 25988955.4656; train_optim_loss: 25988955.4656; val_kl_reg_loss: 66411.5932; val_edge_recon_loss: 591946.1667; val_gene_expr_recon_loss: 19056469.0667; val_masked_gp_l1_reg_loss: 124169.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85612.5000; val_chrom_access_recon_loss: 5944427.4333; val_global_loss: 25869036.4000; val_optim_loss: 25869036.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9586; val_auprc_score: 0.9501; val_best_acc_score: 0.9029; val_best_f1_score: 0.9060; train_kl_reg_loss: 66533.8792; train_edge_recon_loss: 590430.3941; train_gene_expr_recon_loss: 19116393.1298; train_masked_gp_l1_reg_loss: 124286.6510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85260.8635; train_chrom_access_recon_loss: 5925208.1947; train_global_loss: 25908113.0076; train_optim_loss: 25908113.0076; val_kl_reg_loss: 65605.1839; val_edge_recon_loss: 594524.2250; val_gene_expr_recon_loss: 19011010.0000; val_masked_gp_l1_reg_loss: 124739.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85595.3438; val_chrom_access_recon_loss: 5884680.0667; val_global_loss: 25766155.7333; val_optim_loss: 25766155.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9606; val_auprc_score: 0.9505; val_best_acc_score: 0.9047; val_best_f1_score: 0.9085; train_kl_reg_loss: 66218.3209; train_edge_recon_loss: 589149.7572; train_gene_expr_recon_loss: 19059115.7405; train_masked_gp_l1_reg_loss: 124951.1984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85068.3674; train_chrom_access_recon_loss: 5900625.2290; train_global_loss: 25825128.5496; train_optim_loss: 25825128.5496; val_kl_reg_loss: 63722.5333; val_edge_recon_loss: 591300.4292; val_gene_expr_recon_loss: 18938880.6667; val_masked_gp_l1_reg_loss: 125292.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84899.3672; val_chrom_access_recon_loss: 5874999.9000; val_global_loss: 25679095.6000; val_optim_loss: 25679095.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9597; val_auprc_score: 0.9490; val_best_acc_score: 0.9047; val_best_f1_score: 0.9072; train_kl_reg_loss: 65997.9691; train_edge_recon_loss: 588212.5310; train_gene_expr_recon_loss: 19017915.2672; train_masked_gp_l1_reg_loss: 125665.9111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84622.1960; train_chrom_access_recon_loss: 5884899.5420; train_global_loss: 25767313.5420; train_optim_loss: 25767313.5420; val_kl_reg_loss: 66058.2992; val_edge_recon_loss: 591101.0208; val_gene_expr_recon_loss: 18874817.7333; val_masked_gp_l1_reg_loss: 126357.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85104.0781; val_chrom_access_recon_loss: 5810023.0667; val_global_loss: 25553462.1333; val_optim_loss: 25553462.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9596; val_auprc_score: 0.9492; val_best_acc_score: 0.9065; val_best_f1_score: 0.9076; train_kl_reg_loss: 65699.5608; train_edge_recon_loss: 587604.6126; train_gene_expr_recon_loss: 18949936.8092; train_masked_gp_l1_reg_loss: 126458.5089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84708.2238; train_chrom_access_recon_loss: 5857541.7366; train_global_loss: 25671949.5573; train_optim_loss: 25671949.5573; val_kl_reg_loss: 65674.7456; val_edge_recon_loss: 592885.6750; val_gene_expr_recon_loss: 18847360.5333; val_masked_gp_l1_reg_loss: 127093.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84560.9297; val_chrom_access_recon_loss: 5839457.2333; val_global_loss: 25557032.8000; val_optim_loss: 25557032.8000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9639; val_auprc_score: 0.9523; val_best_acc_score: 0.9119; val_best_f1_score: 0.9145; train_kl_reg_loss: 65358.1102; train_edge_recon_loss: 587087.0429; train_gene_expr_recon_loss: 18908135.9542; train_masked_gp_l1_reg_loss: 127419.4931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84521.1299; train_chrom_access_recon_loss: 5848027.9198; train_global_loss: 25620549.6031; train_optim_loss: 25620549.6031; val_kl_reg_loss: 64243.9648; val_edge_recon_loss: 591064.0333; val_gene_expr_recon_loss: 18746780.8000; val_masked_gp_l1_reg_loss: 127662.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84425.1797; val_chrom_access_recon_loss: 5802890.0000; val_global_loss: 25417067.0667; val_optim_loss: 25417067.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9626; val_auprc_score: 0.9505; val_best_acc_score: 0.9082; val_best_f1_score: 0.9115; train_kl_reg_loss: 64890.0672; train_edge_recon_loss: 587519.7991; train_gene_expr_recon_loss: 18847580.7023; train_masked_gp_l1_reg_loss: 128294.2957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84636.3900; train_chrom_access_recon_loss: 5825573.6718; train_global_loss: 25538495.2214; train_optim_loss: 25538495.2214; val_kl_reg_loss: 64444.0526; val_edge_recon_loss: 589646.5125; val_gene_expr_recon_loss: 18818787.7333; val_masked_gp_l1_reg_loss: 128933.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84756.2656; val_chrom_access_recon_loss: 5803768.0333; val_global_loss: 25490336.5333; val_optim_loss: 25490336.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9640; val_auprc_score: 0.9541; val_best_acc_score: 0.9119; val_best_f1_score: 0.9150; train_kl_reg_loss: 64733.9482; train_edge_recon_loss: 586836.4141; train_gene_expr_recon_loss: 18798117.7099; train_masked_gp_l1_reg_loss: 129398.5728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84880.8019; train_chrom_access_recon_loss: 5807284.3359; train_global_loss: 25471251.8321; train_optim_loss: 25471251.8321; val_kl_reg_loss: 64689.2870; val_edge_recon_loss: 587079.1208; val_gene_expr_recon_loss: 18780250.4000; val_masked_gp_l1_reg_loss: 129908.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84640.2891; val_chrom_access_recon_loss: 5813486.8667; val_global_loss: 25460053.4667; val_optim_loss: 25460053.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9637; val_auprc_score: 0.9533; val_best_acc_score: 0.9130; val_best_f1_score: 0.9148; train_kl_reg_loss: 64818.9439; train_edge_recon_loss: 585422.6102; train_gene_expr_recon_loss: 18759929.5420; train_masked_gp_l1_reg_loss: 130515.6453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84732.0723; train_chrom_access_recon_loss: 5794063.9733; train_global_loss: 25419482.9313; train_optim_loss: 25419482.9313; val_kl_reg_loss: 63686.1299; val_edge_recon_loss: 588828.9875; val_gene_expr_recon_loss: 18645118.9333; val_masked_gp_l1_reg_loss: 131235.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85151.3438; val_chrom_access_recon_loss: 5767571.0333; val_global_loss: 25281593.0667; val_optim_loss: 25281593.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9638; val_auprc_score: 0.9530; val_best_acc_score: 0.9093; val_best_f1_score: 0.9121; train_kl_reg_loss: 64462.6147; train_edge_recon_loss: 585687.1732; train_gene_expr_recon_loss: 18692339.0534; train_masked_gp_l1_reg_loss: 131724.5488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84824.2563; train_chrom_access_recon_loss: 5771688.3740; train_global_loss: 25330725.9542; train_optim_loss: 25330725.9542; val_kl_reg_loss: 64781.7852; val_edge_recon_loss: 587806.4875; val_gene_expr_recon_loss: 18543285.0667; val_masked_gp_l1_reg_loss: 132666.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85007.0859; val_chrom_access_recon_loss: 5751107.7000; val_global_loss: 25164655.0667; val_optim_loss: 25164655.0667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9646; val_auprc_score: 0.9529; val_best_acc_score: 0.9153; val_best_f1_score: 0.9176; train_kl_reg_loss: 64285.4320; train_edge_recon_loss: 585485.0635; train_gene_expr_recon_loss: 18635984.2137; train_masked_gp_l1_reg_loss: 132992.7103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84932.7054; train_chrom_access_recon_loss: 5747875.0000; train_global_loss: 25251555.1603; train_optim_loss: 25251555.1603; val_kl_reg_loss: 63951.2141; val_edge_recon_loss: 584732.6458; val_gene_expr_recon_loss: 18666533.8667; val_masked_gp_l1_reg_loss: 133613.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85350.5078; val_chrom_access_recon_loss: 5776978.3667; val_global_loss: 25311160.4000; val_optim_loss: 25311160.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9652; val_auprc_score: 0.9574; val_best_acc_score: 0.9111; val_best_f1_score: 0.9133; train_kl_reg_loss: 64151.9035; train_edge_recon_loss: 585463.9399; train_gene_expr_recon_loss: 18590374.9771; train_masked_gp_l1_reg_loss: 133954.4840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84946.4794; train_chrom_access_recon_loss: 5735222.1756; train_global_loss: 25194114.0305; train_optim_loss: 25194114.0305; val_kl_reg_loss: 63757.2208; val_edge_recon_loss: 591405.6708; val_gene_expr_recon_loss: 18601570.4000; val_masked_gp_l1_reg_loss: 134539.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85133.2109; val_chrom_access_recon_loss: 5764300.4000; val_global_loss: 25240707.8667; val_optim_loss: 25240707.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9671; val_auprc_score: 0.9571; val_best_acc_score: 0.9151; val_best_f1_score: 0.9169; train_kl_reg_loss: 63990.8227; train_edge_recon_loss: 584748.0324; train_gene_expr_recon_loss: 18551718.9618; train_masked_gp_l1_reg_loss: 134941.1598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84953.6766; train_chrom_access_recon_loss: 5721093.8321; train_global_loss: 25141446.4733; train_optim_loss: 25141446.4733; val_kl_reg_loss: 64399.6227; val_edge_recon_loss: 592310.2792; val_gene_expr_recon_loss: 18543236.5333; val_masked_gp_l1_reg_loss: 135470.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85123.6484; val_chrom_access_recon_loss: 5740281.7667; val_global_loss: 25160822.0000; val_optim_loss: 25160822.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9697; val_auprc_score: 0.9631; val_best_acc_score: 0.9184; val_best_f1_score: 0.9210; train_kl_reg_loss: 64367.6524; train_edge_recon_loss: 584364.3144; train_gene_expr_recon_loss: 18522829.2672; train_masked_gp_l1_reg_loss: 135724.4306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85149.6972; train_chrom_access_recon_loss: 5718093.9160; train_global_loss: 25110529.4046; train_optim_loss: 25110529.4046; val_kl_reg_loss: 63791.3953; val_edge_recon_loss: 584479.1958; val_gene_expr_recon_loss: 18438405.3333; val_masked_gp_l1_reg_loss: 136093.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85501.4766; val_chrom_access_recon_loss: 5709480.9667; val_global_loss: 25017753.0667; val_optim_loss: 25017753.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9666; val_auprc_score: 0.9537; val_best_acc_score: 0.9184; val_best_f1_score: 0.9209; train_kl_reg_loss: 64510.5783; train_edge_recon_loss: 584978.3521; train_gene_expr_recon_loss: 18449638.3969; train_masked_gp_l1_reg_loss: 136440.6447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85327.3579; train_chrom_access_recon_loss: 5695253.8359; train_global_loss: 25016149.0687; train_optim_loss: 25016149.0687; val_kl_reg_loss: 62986.7672; val_edge_recon_loss: 588636.3583; val_gene_expr_recon_loss: 18430001.2000; val_masked_gp_l1_reg_loss: 137124.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85818.1016; val_chrom_access_recon_loss: 5702338.7333; val_global_loss: 25006905.3333; val_optim_loss: 25006905.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9668; val_auprc_score: 0.9588; val_best_acc_score: 0.9136; val_best_f1_score: 0.9165; train_kl_reg_loss: 64762.0506; train_edge_recon_loss: 584427.4747; train_gene_expr_recon_loss: 18426642.3206; train_masked_gp_l1_reg_loss: 136963.7453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85632.2963; train_chrom_access_recon_loss: 5686993.3015; train_global_loss: 24985421.1450; train_optim_loss: 24985421.1450; val_kl_reg_loss: 65140.9430; val_edge_recon_loss: 586702.1083; val_gene_expr_recon_loss: 18455273.7333; val_masked_gp_l1_reg_loss: 137133.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85764.3203; val_chrom_access_recon_loss: 5705306.0667; val_global_loss: 25035320.9333; val_optim_loss: 25035320.9333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9640; val_auprc_score: 0.9535; val_best_acc_score: 0.9092; val_best_f1_score: 0.9137; train_kl_reg_loss: 65375.5545; train_edge_recon_loss: 584120.6913; train_gene_expr_recon_loss: 18383242.4733; train_masked_gp_l1_reg_loss: 137339.9955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85738.3771; train_chrom_access_recon_loss: 5680319.9198; train_global_loss: 24936136.9771; train_optim_loss: 24936136.9771; val_kl_reg_loss: 65501.3604; val_edge_recon_loss: 589501.5000; val_gene_expr_recon_loss: 18364391.6000; val_masked_gp_l1_reg_loss: 137714.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86512.1953; val_chrom_access_recon_loss: 5689130.4000; val_global_loss: 24932750.5333; val_optim_loss: 24932750.5333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9670; val_auprc_score: 0.9594; val_best_acc_score: 0.9162; val_best_f1_score: 0.9187; train_kl_reg_loss: 65399.3118; train_edge_recon_loss: 584855.5725; train_gene_expr_recon_loss: 18345639.0992; train_masked_gp_l1_reg_loss: 137746.9270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86054.5172; train_chrom_access_recon_loss: 5668289.6679; train_global_loss: 24887985.0382; train_optim_loss: 24887985.0382; val_kl_reg_loss: 65666.8461; val_edge_recon_loss: 588882.0917; val_gene_expr_recon_loss: 18405256.4000; val_masked_gp_l1_reg_loss: 138141.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86511.9688; val_chrom_access_recon_loss: 5702544.5667; val_global_loss: 24987003.6000; val_optim_loss: 24987003.6000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9691; val_auprc_score: 0.9623; val_best_acc_score: 0.9175; val_best_f1_score: 0.9195; train_kl_reg_loss: 65744.8136; train_edge_recon_loss: 585367.6885; train_gene_expr_recon_loss: 18326910.9160; train_masked_gp_l1_reg_loss: 137927.6045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86497.0143; train_chrom_access_recon_loss: 5662444.3130; train_global_loss: 24864892.3206; train_optim_loss: 24864892.3206; val_kl_reg_loss: 65737.9654; val_edge_recon_loss: 587768.9000; val_gene_expr_recon_loss: 18414204.5333; val_masked_gp_l1_reg_loss: 138253.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87650.9141; val_chrom_access_recon_loss: 5735540.5000; val_global_loss: 25029155.8667; val_optim_loss: 25029155.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9689; val_auprc_score: 0.9602; val_best_acc_score: 0.9178; val_best_f1_score: 0.9201; train_kl_reg_loss: 65984.3345; train_edge_recon_loss: 584102.6756; train_gene_expr_recon_loss: 18311142.2748; train_masked_gp_l1_reg_loss: 138272.3732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86876.4787; train_chrom_access_recon_loss: 5657011.5305; train_global_loss: 24843389.6641; train_optim_loss: 24843389.6641; val_kl_reg_loss: 67172.1693; val_edge_recon_loss: 589185.1333; val_gene_expr_recon_loss: 18425458.2667; val_masked_gp_l1_reg_loss: 138610.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87751.9844; val_chrom_access_recon_loss: 5726281.7667; val_global_loss: 25034459.0667; val_optim_loss: 25034459.0667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9637; val_auprc_score: 0.9521; val_best_acc_score: 0.9135; val_best_f1_score: 0.9160; train_kl_reg_loss: 66332.7035; train_edge_recon_loss: 584554.9747; train_gene_expr_recon_loss: 18264880.3664; train_masked_gp_l1_reg_loss: 138474.3829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87327.0085; train_chrom_access_recon_loss: 5639605.5038; train_global_loss: 24781174.9924; train_optim_loss: 24781174.9924; val_kl_reg_loss: 65896.1875; val_edge_recon_loss: 591961.6625; val_gene_expr_recon_loss: 18364518.2667; val_masked_gp_l1_reg_loss: 138548.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87391.3906; val_chrom_access_recon_loss: 5688419.6667; val_global_loss: 24936735.6000; val_optim_loss: 24936735.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9682; val_auprc_score: 0.9579; val_best_acc_score: 0.9170; val_best_f1_score: 0.9201; train_kl_reg_loss: 66696.4023; train_edge_recon_loss: 583432.6899; train_gene_expr_recon_loss: 18213555.2901; train_masked_gp_l1_reg_loss: 131086.9707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64826.7883; train_chrom_access_recon_loss: 5620056.8092; train_global_loss: 24679654.7634; train_optim_loss: 24679654.7634; val_kl_reg_loss: 67271.6724; val_edge_recon_loss: 586732.5083; val_gene_expr_recon_loss: 18334692.4000; val_masked_gp_l1_reg_loss: 129219.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61276.4258; val_chrom_access_recon_loss: 5672306.9333; val_global_loss: 24851499.4667; val_optim_loss: 24851499.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9674; val_auprc_score: 0.9571; val_best_acc_score: 0.9166; val_best_f1_score: 0.9183; train_kl_reg_loss: 67102.2630; train_edge_recon_loss: 581834.0024; train_gene_expr_recon_loss: 18187772.8702; train_masked_gp_l1_reg_loss: 128972.3312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60655.3451; train_chrom_access_recon_loss: 5609927.1069; train_global_loss: 24636263.9695; train_optim_loss: 24636263.9695; val_kl_reg_loss: 67386.7922; val_edge_recon_loss: 585082.2625; val_gene_expr_recon_loss: 18281593.4667; val_masked_gp_l1_reg_loss: 128827.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60248.7891; val_chrom_access_recon_loss: 5676799.3333; val_global_loss: 24799937.8667; val_optim_loss: 24799937.8667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9696; val_auprc_score: 0.9614; val_best_acc_score: 0.9178; val_best_f1_score: 0.9206; train_kl_reg_loss: 67330.3950; train_edge_recon_loss: 582462.8554; train_gene_expr_recon_loss: 18185552.1527; train_masked_gp_l1_reg_loss: 128745.9976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59830.8355; train_chrom_access_recon_loss: 5611315.2748; train_global_loss: 24635237.5878; train_optim_loss: 24635237.5878; val_kl_reg_loss: 67528.0948; val_edge_recon_loss: 584783.3500; val_gene_expr_recon_loss: 18268119.6000; val_masked_gp_l1_reg_loss: 128668.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59505.5312; val_chrom_access_recon_loss: 5645521.4000; val_global_loss: 24754126.4000; val_optim_loss: 24754126.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9650; val_auprc_score: 0.9552; val_best_acc_score: 0.9116; val_best_f1_score: 0.9152; train_kl_reg_loss: 67542.7137; train_edge_recon_loss: 582969.0234; train_gene_expr_recon_loss: 18176932.5191; train_masked_gp_l1_reg_loss: 128650.2229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59230.6679; train_chrom_access_recon_loss: 5609180.9122; train_global_loss: 24624505.9389; train_optim_loss: 24624505.9389; val_kl_reg_loss: 67841.6302; val_edge_recon_loss: 588309.1250; val_gene_expr_recon_loss: 18258152.8000; val_masked_gp_l1_reg_loss: 128587.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58960.5195; val_chrom_access_recon_loss: 5659673.4000; val_global_loss: 24761524.9333; val_optim_loss: 24761524.9333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9712; val_auprc_score: 0.9645; val_best_acc_score: 0.9189; val_best_f1_score: 0.9213; train_kl_reg_loss: 67804.8151; train_edge_recon_loss: 582356.4413; train_gene_expr_recon_loss: 18198742.7939; train_masked_gp_l1_reg_loss: 128579.1686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58715.5106; train_chrom_access_recon_loss: 5616298.7137; train_global_loss: 24652497.4198; train_optim_loss: 24652497.4198; val_kl_reg_loss: 67841.1620; val_edge_recon_loss: 583376.6625; val_gene_expr_recon_loss: 18314456.0000; val_masked_gp_l1_reg_loss: 128511.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58538.6289; val_chrom_access_recon_loss: 5662919.9333; val_global_loss: 24815644.1333; val_optim_loss: 24815644.1333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9678; val_auprc_score: 0.9541; val_best_acc_score: 0.9175; val_best_f1_score: 0.9193; train_kl_reg_loss: 67996.0175; train_edge_recon_loss: 581551.5744; train_gene_expr_recon_loss: 18170594.1374; train_masked_gp_l1_reg_loss: 128530.7965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58312.2384; train_chrom_access_recon_loss: 5609396.1221; train_global_loss: 24616380.9160; train_optim_loss: 24616380.9160; val_kl_reg_loss: 68086.5161; val_edge_recon_loss: 582497.5792; val_gene_expr_recon_loss: 18391787.3333; val_masked_gp_l1_reg_loss: 128473.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58098.1445; val_chrom_access_recon_loss: 5713643.6000; val_global_loss: 24942586.8000; val_optim_loss: 24942586.8000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9728; val_auprc_score: 0.9671; val_best_acc_score: 0.9213; val_best_f1_score: 0.9242; train_kl_reg_loss: 68164.9687; train_edge_recon_loss: 582124.9547; train_gene_expr_recon_loss: 18175124.7252; train_masked_gp_l1_reg_loss: 128480.8690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57894.3464; train_chrom_access_recon_loss: 5607444.1756; train_global_loss: 24619233.9695; train_optim_loss: 24619233.9695; val_kl_reg_loss: 68174.1187; val_edge_recon_loss: 580618.5292; val_gene_expr_recon_loss: 18346695.3333; val_masked_gp_l1_reg_loss: 128525.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57784.7344; val_chrom_access_recon_loss: 5692969.8667; val_global_loss: 24874767.7333; val_optim_loss: 24874767.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9682; val_auprc_score: 0.9577; val_best_acc_score: 0.9188; val_best_f1_score: 0.9216; train_kl_reg_loss: 68186.3842; train_edge_recon_loss: 581685.5396; train_gene_expr_recon_loss: 18151260.1527; train_masked_gp_l1_reg_loss: 127726.3913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55531.8110; train_chrom_access_recon_loss: 5605098.6183; train_global_loss: 24589488.9618; train_optim_loss: 24589488.9618; val_kl_reg_loss: 68546.0875; val_edge_recon_loss: 585038.9292; val_gene_expr_recon_loss: 18378194.0000; val_masked_gp_l1_reg_loss: 127464.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55190.5508; val_chrom_access_recon_loss: 5695684.9667; val_global_loss: 24910118.2667; val_optim_loss: 24910118.2667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9692; val_auprc_score: 0.9587; val_best_acc_score: 0.9196; val_best_f1_score: 0.9212; train_kl_reg_loss: 68422.8303; train_edge_recon_loss: 581327.5787; train_gene_expr_recon_loss: 18164544.4885; train_masked_gp_l1_reg_loss: 127412.8318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55107.3635; train_chrom_access_recon_loss: 5602173.3893; train_global_loss: 24598988.6565; train_optim_loss: 24598988.6565; val_kl_reg_loss: 68370.4307; val_edge_recon_loss: 585547.0792; val_gene_expr_recon_loss: 18297300.2000; val_masked_gp_l1_reg_loss: 127366.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55039.2891; val_chrom_access_recon_loss: 5675831.8333; val_global_loss: 24809456.0000; val_optim_loss: 24809456.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9681; val_auprc_score: 0.9588; val_best_acc_score: 0.9185; val_best_f1_score: 0.9214; train_kl_reg_loss: 68349.2010; train_edge_recon_loss: 582099.1221; train_gene_expr_recon_loss: 18152603.4504; train_masked_gp_l1_reg_loss: 127346.4865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54984.9348; train_chrom_access_recon_loss: 5605463.0382; train_global_loss: 24590846.3359; train_optim_loss: 24590846.3359; val_kl_reg_loss: 68267.4901; val_edge_recon_loss: 585089.2292; val_gene_expr_recon_loss: 18311209.0667; val_masked_gp_l1_reg_loss: 127325.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54933.5391; val_chrom_access_recon_loss: 5698064.2000; val_global_loss: 24844890.1333; val_optim_loss: 24844890.1333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9651; val_auprc_score: 0.9547; val_best_acc_score: 0.9139; val_best_f1_score: 0.9174; train_kl_reg_loss: 68198.4404; train_edge_recon_loss: 581916.9971; train_gene_expr_recon_loss: 18141059.2672; train_masked_gp_l1_reg_loss: 127308.6393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54894.7235; train_chrom_access_recon_loss: 5594511.7061; train_global_loss: 24567889.8779; train_optim_loss: 24567889.8779; val_kl_reg_loss: 68495.8078; val_edge_recon_loss: 586042.2125; val_gene_expr_recon_loss: 18262537.2000; val_masked_gp_l1_reg_loss: 127296.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54848.8438; val_chrom_access_recon_loss: 5670372.8000; val_global_loss: 24769592.2667; val_optim_loss: 24769592.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 40 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9684
val AUPRC score: 0.9598
val best accuracy score: 0.9178
val best F1 score: 0.9205
val target rna MSE score: 1.1820
val source rna MSE score: 0.4407
val target atac MSE score: 0.3470
val source atac MSE score: 0.0953
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
