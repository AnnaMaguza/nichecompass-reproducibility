[True]
Run timestamp: 09102023_184234_1.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_1']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7917; val_auprc_score: 0.8074; val_best_acc_score: 0.6688; val_best_f1_score: 0.7308; train_kl_reg_loss: 66289.0913; train_edge_recon_loss: 3500010.4351; train_gene_expr_recon_loss: 13292256.8168; train_masked_gp_l1_reg_loss: 32314.2951; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2381926.2939; train_chrom_access_recon_loss: 954809.4542; train_global_loss: 20227606.3511; train_optim_loss: 20227606.3511; val_kl_reg_loss: 85388.9141; val_edge_recon_loss: 4051945.2667; val_gene_expr_recon_loss: 12691033.9333; val_masked_gp_l1_reg_loss: 38195.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 566316.4375; val_chrom_access_recon_loss: 918131.4833; val_global_loss: 18351012.0000; val_optim_loss: 18351012.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8275; val_auprc_score: 0.8286; val_best_acc_score: 0.7316; val_best_f1_score: 0.7659; train_kl_reg_loss: 71717.1072; train_edge_recon_loss: 3287122.4981; train_gene_expr_recon_loss: 12619904.6947; train_masked_gp_l1_reg_loss: 42213.0794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 292039.8316; train_chrom_access_recon_loss: 924855.8545; train_global_loss: 17237853.1069; train_optim_loss: 17237853.1069; val_kl_reg_loss: 77738.7646; val_edge_recon_loss: 3102299.7333; val_gene_expr_recon_loss: 12630135.6000; val_masked_gp_l1_reg_loss: 46087.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161957.2656; val_chrom_access_recon_loss: 910979.9583; val_global_loss: 16929198.2000; val_optim_loss: 16929198.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8894; val_auprc_score: 0.8838; val_best_acc_score: 0.7986; val_best_f1_score: 0.8159; train_kl_reg_loss: 86641.7016; train_edge_recon_loss: 3004661.9790; train_gene_expr_recon_loss: 12442016.3359; train_masked_gp_l1_reg_loss: 48917.8489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128145.4804; train_chrom_access_recon_loss: 913553.7767; train_global_loss: 16623937.1145; train_optim_loss: 16623937.1145; val_kl_reg_loss: 82754.1859; val_edge_recon_loss: 2923888.2500; val_gene_expr_recon_loss: 12418071.0000; val_masked_gp_l1_reg_loss: 52171.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110512.0312; val_chrom_access_recon_loss: 903122.6417; val_global_loss: 16490519.0667; val_optim_loss: 16490519.0667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9271; val_auprc_score: 0.9116; val_best_acc_score: 0.8605; val_best_f1_score: 0.8695; train_kl_reg_loss: 90255.3597; train_edge_recon_loss: 2813487.7634; train_gene_expr_recon_loss: 12286171.9008; train_masked_gp_l1_reg_loss: 54942.4863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101435.4336; train_chrom_access_recon_loss: 904338.8564; train_global_loss: 16250631.6947; train_optim_loss: 16250631.6947; val_kl_reg_loss: 86265.5651; val_edge_recon_loss: 2788862.4833; val_gene_expr_recon_loss: 12275706.8000; val_masked_gp_l1_reg_loss: 57039.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95571.7734; val_chrom_access_recon_loss: 897485.9417; val_global_loss: 16200931.7333; val_optim_loss: 16200931.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9303; val_auprc_score: 0.9130; val_best_acc_score: 0.8628; val_best_f1_score: 0.8726; train_kl_reg_loss: 87497.8845; train_edge_recon_loss: 2800856.1794; train_gene_expr_recon_loss: 12158222.2824; train_masked_gp_l1_reg_loss: 58719.5954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89900.8346; train_chrom_access_recon_loss: 895190.5687; train_global_loss: 16090387.3130; train_optim_loss: 16090387.3130; val_kl_reg_loss: 85840.9885; val_edge_recon_loss: 2791061.3167; val_gene_expr_recon_loss: 12138068.4000; val_masked_gp_l1_reg_loss: 60347.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85399.3672; val_chrom_access_recon_loss: 884014.7500; val_global_loss: 16044731.4000; val_optim_loss: 16044731.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9365; val_auprc_score: 0.9220; val_best_acc_score: 0.8743; val_best_f1_score: 0.8807; train_kl_reg_loss: 84735.2683; train_edge_recon_loss: 2782026.0840; train_gene_expr_recon_loss: 12071058.5344; train_masked_gp_l1_reg_loss: 61554.5785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81573.1737; train_chrom_access_recon_loss: 888364.6508; train_global_loss: 15969312.2977; train_optim_loss: 15969312.2977; val_kl_reg_loss: 79854.6198; val_edge_recon_loss: 2781267.0667; val_gene_expr_recon_loss: 12068327.1333; val_masked_gp_l1_reg_loss: 62630.8945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78465.2734; val_chrom_access_recon_loss: 879288.4000; val_global_loss: 15949833.1333; val_optim_loss: 15949833.1333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9417; val_auprc_score: 0.9297; val_best_acc_score: 0.8829; val_best_f1_score: 0.8883; train_kl_reg_loss: 79966.2516; train_edge_recon_loss: 2767869.9542; train_gene_expr_recon_loss: 11973262.2748; train_masked_gp_l1_reg_loss: 63899.9093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76779.7962; train_chrom_access_recon_loss: 882166.7700; train_global_loss: 15843944.9313; train_optim_loss: 15843944.9313; val_kl_reg_loss: 79994.0427; val_edge_recon_loss: 2756749.0167; val_gene_expr_recon_loss: 11944027.6000; val_masked_gp_l1_reg_loss: 65118.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76502.8594; val_chrom_access_recon_loss: 873951.1292; val_global_loss: 15796343.7333; val_optim_loss: 15796343.7333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9438; val_auprc_score: 0.9328; val_best_acc_score: 0.8797; val_best_f1_score: 0.8865; train_kl_reg_loss: 77001.0363; train_edge_recon_loss: 2759037.4771; train_gene_expr_recon_loss: 11889950.5954; train_masked_gp_l1_reg_loss: 65980.8109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75433.5795; train_chrom_access_recon_loss: 876423.9580; train_global_loss: 15743827.5038; train_optim_loss: 15743827.5038; val_kl_reg_loss: 75373.9953; val_edge_recon_loss: 2777173.3000; val_gene_expr_recon_loss: 11921387.2667; val_masked_gp_l1_reg_loss: 67056.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76323.7734; val_chrom_access_recon_loss: 869310.7542; val_global_loss: 15786625.3333; val_optim_loss: 15786625.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9453; val_auprc_score: 0.9330; val_best_acc_score: 0.8825; val_best_f1_score: 0.8894; train_kl_reg_loss: 74774.7235; train_edge_recon_loss: 2736496.3206; train_gene_expr_recon_loss: 11836425.2137; train_masked_gp_l1_reg_loss: 67823.4244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75689.0463; train_chrom_access_recon_loss: 872945.7276; train_global_loss: 15664154.4656; train_optim_loss: 15664154.4656; val_kl_reg_loss: 75389.8734; val_edge_recon_loss: 2748465.3000; val_gene_expr_recon_loss: 11850985.6667; val_masked_gp_l1_reg_loss: 68648.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75210.9531; val_chrom_access_recon_loss: 861052.1083; val_global_loss: 15679752.9333; val_optim_loss: 15679752.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9581; val_auprc_score: 0.9489; val_best_acc_score: 0.9030; val_best_f1_score: 0.9054; train_kl_reg_loss: 74818.2624; train_edge_recon_loss: 2726577.0687; train_gene_expr_recon_loss: 11776099.8626; train_masked_gp_l1_reg_loss: 69329.5935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74050.0868; train_chrom_access_recon_loss: 868028.8931; train_global_loss: 15588903.7939; train_optim_loss: 15588903.7939; val_kl_reg_loss: 74474.3979; val_edge_recon_loss: 2728004.6833; val_gene_expr_recon_loss: 11799803.0667; val_masked_gp_l1_reg_loss: 70064.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73962.9297; val_chrom_access_recon_loss: 858670.4583; val_global_loss: 15604980.5333; val_optim_loss: 15604980.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9551; val_auprc_score: 0.9451; val_best_acc_score: 0.8941; val_best_f1_score: 0.8993; train_kl_reg_loss: 74254.3964; train_edge_recon_loss: 2721875.2233; train_gene_expr_recon_loss: 11717034.9389; train_masked_gp_l1_reg_loss: 70628.4402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73083.5450; train_chrom_access_recon_loss: 864801.6846; train_global_loss: 15521678.2137; train_optim_loss: 15521678.2137; val_kl_reg_loss: 74301.1411; val_edge_recon_loss: 2732726.4500; val_gene_expr_recon_loss: 11761644.8000; val_masked_gp_l1_reg_loss: 71091.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73174.3359; val_chrom_access_recon_loss: 854259.7417; val_global_loss: 15567197.1333; val_optim_loss: 15567197.1333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9597; val_auprc_score: 0.9497; val_best_acc_score: 0.9050; val_best_f1_score: 0.9086; train_kl_reg_loss: 74039.3681; train_edge_recon_loss: 2712731.6641; train_gene_expr_recon_loss: 11670151.1985; train_masked_gp_l1_reg_loss: 71658.0045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72565.6571; train_chrom_access_recon_loss: 859930.8688; train_global_loss: 15461076.7481; train_optim_loss: 15461076.7481; val_kl_reg_loss: 74110.0141; val_edge_recon_loss: 2726486.4333; val_gene_expr_recon_loss: 11694976.4000; val_masked_gp_l1_reg_loss: 72072.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72969.7422; val_chrom_access_recon_loss: 850494.2708; val_global_loss: 15491110.0000; val_optim_loss: 15491110.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9598; val_auprc_score: 0.9488; val_best_acc_score: 0.9029; val_best_f1_score: 0.9069; train_kl_reg_loss: 71349.9467; train_edge_recon_loss: 2705746.1240; train_gene_expr_recon_loss: 11626623.8779; train_masked_gp_l1_reg_loss: 72543.9099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72250.8034; train_chrom_access_recon_loss: 857492.2185; train_global_loss: 15406006.9084; train_optim_loss: 15406006.9084; val_kl_reg_loss: 69491.0365; val_edge_recon_loss: 2703206.2500; val_gene_expr_recon_loss: 11584562.1333; val_masked_gp_l1_reg_loss: 73001.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73155.7031; val_chrom_access_recon_loss: 844570.3375; val_global_loss: 15347987.6000; val_optim_loss: 15347987.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9626; val_auprc_score: 0.9522; val_best_acc_score: 0.9078; val_best_f1_score: 0.9117; train_kl_reg_loss: 71290.2430; train_edge_recon_loss: 2695925.7405; train_gene_expr_recon_loss: 11575546.4656; train_masked_gp_l1_reg_loss: 73384.9403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72202.4284; train_chrom_access_recon_loss: 853060.6617; train_global_loss: 15341410.5038; train_optim_loss: 15341410.5038; val_kl_reg_loss: 70611.6734; val_edge_recon_loss: 2696813.3667; val_gene_expr_recon_loss: 11666359.1333; val_masked_gp_l1_reg_loss: 73701.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72165.5391; val_chrom_access_recon_loss: 846241.0500; val_global_loss: 15425892.1333; val_optim_loss: 15425892.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9657; val_auprc_score: 0.9561; val_best_acc_score: 0.9151; val_best_f1_score: 0.9179; train_kl_reg_loss: 70180.6768; train_edge_recon_loss: 2693084.2004; train_gene_expr_recon_loss: 11540473.3053; train_masked_gp_l1_reg_loss: 74034.2960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71576.2266; train_chrom_access_recon_loss: 849870.4490; train_global_loss: 15299219.1679; train_optim_loss: 15299219.1679; val_kl_reg_loss: 70601.0828; val_edge_recon_loss: 2714244.7333; val_gene_expr_recon_loss: 11559008.6000; val_masked_gp_l1_reg_loss: 74208.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71452.8516; val_chrom_access_recon_loss: 839704.8583; val_global_loss: 15329220.4667; val_optim_loss: 15329220.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9619; val_auprc_score: 0.9495; val_best_acc_score: 0.9088; val_best_f1_score: 0.9126; train_kl_reg_loss: 70619.6225; train_edge_recon_loss: 2691444.8359; train_gene_expr_recon_loss: 11513799.5649; train_masked_gp_l1_reg_loss: 74393.0232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71330.8663; train_chrom_access_recon_loss: 848830.8593; train_global_loss: 15270418.7481; train_optim_loss: 15270418.7481; val_kl_reg_loss: 72029.2911; val_edge_recon_loss: 2722039.3667; val_gene_expr_recon_loss: 11550868.2000; val_masked_gp_l1_reg_loss: 74647.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71340.8281; val_chrom_access_recon_loss: 839712.7042; val_global_loss: 15330637.6000; val_optim_loss: 15330637.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9667; val_auprc_score: 0.9583; val_best_acc_score: 0.9163; val_best_f1_score: 0.9182; train_kl_reg_loss: 69643.6194; train_edge_recon_loss: 2694998.6679; train_gene_expr_recon_loss: 11483226.3130; train_masked_gp_l1_reg_loss: 74651.7223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71140.7426; train_chrom_access_recon_loss: 845387.2739; train_global_loss: 15239048.3664; train_optim_loss: 15239048.3664; val_kl_reg_loss: 71794.0938; val_edge_recon_loss: 2701927.9833; val_gene_expr_recon_loss: 11543562.0000; val_masked_gp_l1_reg_loss: 74823.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70833.4922; val_chrom_access_recon_loss: 839742.6542; val_global_loss: 15302682.7333; val_optim_loss: 15302682.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9698; val_auprc_score: 0.9613; val_best_acc_score: 0.9178; val_best_f1_score: 0.9207; train_kl_reg_loss: 69492.0083; train_edge_recon_loss: 2692022.6126; train_gene_expr_recon_loss: 11445222.6107; train_masked_gp_l1_reg_loss: 74933.2761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70912.7556; train_chrom_access_recon_loss: 842339.7195; train_global_loss: 15194923.0000; train_optim_loss: 15194923.0000; val_kl_reg_loss: 67067.1615; val_edge_recon_loss: 2707525.9500; val_gene_expr_recon_loss: 11444847.6667; val_masked_gp_l1_reg_loss: 74876.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71335.2500; val_chrom_access_recon_loss: 835206.8500; val_global_loss: 15200859.6000; val_optim_loss: 15200859.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9662; val_auprc_score: 0.9571; val_best_acc_score: 0.9135; val_best_f1_score: 0.9179; train_kl_reg_loss: 66901.5420; train_edge_recon_loss: 2690511.7424; train_gene_expr_recon_loss: 11434614.7023; train_masked_gp_l1_reg_loss: 75101.3012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71076.1213; train_chrom_access_recon_loss: 841167.5091; train_global_loss: 15179372.9847; train_optim_loss: 15179372.9847; val_kl_reg_loss: 67476.8268; val_edge_recon_loss: 2719786.4000; val_gene_expr_recon_loss: 11445747.6000; val_masked_gp_l1_reg_loss: 75399.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71106.9141; val_chrom_access_recon_loss: 832400.1667; val_global_loss: 15211918.0667; val_optim_loss: 15211918.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9708; val_auprc_score: 0.9607; val_best_acc_score: 0.9219; val_best_f1_score: 0.9243; train_kl_reg_loss: 67189.3179; train_edge_recon_loss: 2686049.2805; train_gene_expr_recon_loss: 11407805.8015; train_masked_gp_l1_reg_loss: 75464.2267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71165.2730; train_chrom_access_recon_loss: 839205.0782; train_global_loss: 15146878.9695; train_optim_loss: 15146878.9695; val_kl_reg_loss: 67403.3651; val_edge_recon_loss: 2702433.7500; val_gene_expr_recon_loss: 11464103.1333; val_masked_gp_l1_reg_loss: 75432.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71203.2266; val_chrom_access_recon_loss: 835538.0333; val_global_loss: 15216114.4667; val_optim_loss: 15216114.4667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9707; val_auprc_score: 0.9631; val_best_acc_score: 0.9241; val_best_f1_score: 0.9271; train_kl_reg_loss: 66712.7354; train_edge_recon_loss: 2683005.8397; train_gene_expr_recon_loss: 11388676.2977; train_masked_gp_l1_reg_loss: 75595.5959; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71313.7140; train_chrom_access_recon_loss: 838834.5534; train_global_loss: 15124138.7328; train_optim_loss: 15124138.7328; val_kl_reg_loss: 65605.3940; val_edge_recon_loss: 2699924.9000; val_gene_expr_recon_loss: 11430859.4000; val_masked_gp_l1_reg_loss: 75680.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71963.9688; val_chrom_access_recon_loss: 828364.5125; val_global_loss: 15172397.9333; val_optim_loss: 15172397.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9718; val_auprc_score: 0.9619; val_best_acc_score: 0.9233; val_best_f1_score: 0.9255; train_kl_reg_loss: 66243.3395; train_edge_recon_loss: 2680820.8340; train_gene_expr_recon_loss: 11373393.7405; train_masked_gp_l1_reg_loss: 75756.0949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71337.9807; train_chrom_access_recon_loss: 836687.4823; train_global_loss: 15104239.4962; train_optim_loss: 15104239.4962; val_kl_reg_loss: 66532.7138; val_edge_recon_loss: 2693244.2333; val_gene_expr_recon_loss: 11423889.0000; val_masked_gp_l1_reg_loss: 75848.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72022.4453; val_chrom_access_recon_loss: 830093.5500; val_global_loss: 15161629.6667; val_optim_loss: 15161629.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9735; val_auprc_score: 0.9637; val_best_acc_score: 0.9274; val_best_f1_score: 0.9293; train_kl_reg_loss: 65954.3621; train_edge_recon_loss: 2681391.0592; train_gene_expr_recon_loss: 11345881.2901; train_masked_gp_l1_reg_loss: 75744.8097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71499.5058; train_chrom_access_recon_loss: 834603.0716; train_global_loss: 15075074.0229; train_optim_loss: 15075074.0229; val_kl_reg_loss: 65787.4878; val_edge_recon_loss: 2702751.2000; val_gene_expr_recon_loss: 11411077.8667; val_masked_gp_l1_reg_loss: 75867.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71830.7344; val_chrom_access_recon_loss: 830277.4708; val_global_loss: 15157592.0000; val_optim_loss: 15157592.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9735; val_auprc_score: 0.9659; val_best_acc_score: 0.9264; val_best_f1_score: 0.9279; train_kl_reg_loss: 65564.4812; train_edge_recon_loss: 2677576.3111; train_gene_expr_recon_loss: 11334311.3282; train_masked_gp_l1_reg_loss: 75822.6432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71410.4614; train_chrom_access_recon_loss: 833582.0496; train_global_loss: 15058267.2366; train_optim_loss: 15058267.2366; val_kl_reg_loss: 65061.7333; val_edge_recon_loss: 2689087.4833; val_gene_expr_recon_loss: 11382457.4000; val_masked_gp_l1_reg_loss: 75918.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71650.3906; val_chrom_access_recon_loss: 829029.8542; val_global_loss: 15113205.6667; val_optim_loss: 15113205.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9741; val_auprc_score: 0.9667; val_best_acc_score: 0.9239; val_best_f1_score: 0.9264; train_kl_reg_loss: 64345.8799; train_edge_recon_loss: 2677070.8092; train_gene_expr_recon_loss: 11310158.4046; train_masked_gp_l1_reg_loss: 75863.8958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71282.3287; train_chrom_access_recon_loss: 831871.0052; train_global_loss: 15030592.3435; train_optim_loss: 15030592.3435; val_kl_reg_loss: 66528.0865; val_edge_recon_loss: 2694615.6833; val_gene_expr_recon_loss: 11405357.2000; val_masked_gp_l1_reg_loss: 75888.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71014.7734; val_chrom_access_recon_loss: 829843.4167; val_global_loss: 15143247.4667; val_optim_loss: 15143247.4667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9700; val_auprc_score: 0.9600; val_best_acc_score: 0.9223; val_best_f1_score: 0.9257; train_kl_reg_loss: 77855.8214; train_edge_recon_loss: 2720398.7137; train_gene_expr_recon_loss: 10216224.7176; train_masked_gp_l1_reg_loss: 74581.9457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68347.6627; train_chrom_access_recon_loss: 752748.7347; train_global_loss: 13910157.5267; train_optim_loss: 13910157.5267; val_kl_reg_loss: 31696.9660; val_edge_recon_loss: 2704777.6833; val_gene_expr_recon_loss: 10235749.7333; val_masked_gp_l1_reg_loss: 73032.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69881.2812; val_chrom_access_recon_loss: 744743.8167; val_global_loss: 13859881.1333; val_optim_loss: 13859881.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9718; val_auprc_score: 0.9600; val_best_acc_score: 0.9259; val_best_f1_score: 0.9286; train_kl_reg_loss: 59710.6781; train_edge_recon_loss: 2693207.8092; train_gene_expr_recon_loss: 10172968.9389; train_masked_gp_l1_reg_loss: 71637.1627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70093.4017; train_chrom_access_recon_loss: 746109.1188; train_global_loss: 13813727.1145; train_optim_loss: 13813727.1145; val_kl_reg_loss: 35523.5604; val_edge_recon_loss: 2681255.8333; val_gene_expr_recon_loss: 10181051.9333; val_masked_gp_l1_reg_loss: 70331.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70382.0625; val_chrom_access_recon_loss: 739354.7167; val_global_loss: 13777899.0000; val_optim_loss: 13777899.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9754; val_auprc_score: 0.9672; val_best_acc_score: 0.9333; val_best_f1_score: 0.9351; train_kl_reg_loss: 53698.7858; train_edge_recon_loss: 2684595.8492; train_gene_expr_recon_loss: 10141916.6718; train_masked_gp_l1_reg_loss: 69150.5061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70647.2227; train_chrom_access_recon_loss: 743376.6813; train_global_loss: 13763385.7099; train_optim_loss: 13763385.7099; val_kl_reg_loss: 37958.6482; val_edge_recon_loss: 2699042.6833; val_gene_expr_recon_loss: 10201192.2000; val_masked_gp_l1_reg_loss: 67849.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69889.9609; val_chrom_access_recon_loss: 737549.0792; val_global_loss: 13813481.4667; val_optim_loss: 13813481.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9755; val_auprc_score: 0.9668; val_best_acc_score: 0.9307; val_best_f1_score: 0.9333; train_kl_reg_loss: 51937.7311; train_edge_recon_loss: 2678907.3130; train_gene_expr_recon_loss: 10124447.4580; train_masked_gp_l1_reg_loss: 66649.4157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70561.7616; train_chrom_access_recon_loss: 743044.6999; train_global_loss: 13735548.4427; train_optim_loss: 13735548.4427; val_kl_reg_loss: 38637.1990; val_edge_recon_loss: 2700398.2667; val_gene_expr_recon_loss: 10176106.2667; val_masked_gp_l1_reg_loss: 65479.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70895.9219; val_chrom_access_recon_loss: 736200.6917; val_global_loss: 13787717.6000; val_optim_loss: 13787717.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9773; val_auprc_score: 0.9716; val_best_acc_score: 0.9324; val_best_f1_score: 0.9342; train_kl_reg_loss: 50588.6421; train_edge_recon_loss: 2668677.2042; train_gene_expr_recon_loss: 10114150.2290; train_masked_gp_l1_reg_loss: 64423.6603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70791.9452; train_chrom_access_recon_loss: 742273.7972; train_global_loss: 13710905.4275; train_optim_loss: 13710905.4275; val_kl_reg_loss: 39940.8120; val_edge_recon_loss: 2667882.1500; val_gene_expr_recon_loss: 10148010.6667; val_masked_gp_l1_reg_loss: 63374.3867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71052.4609; val_chrom_access_recon_loss: 732322.7167; val_global_loss: 13722582.2000; val_optim_loss: 13722582.2000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9752; val_auprc_score: 0.9661; val_best_acc_score: 0.9297; val_best_f1_score: 0.9314; train_kl_reg_loss: 50057.7189; train_edge_recon_loss: 2669741.5725; train_gene_expr_recon_loss: 10104869.2672; train_masked_gp_l1_reg_loss: 62505.6988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70786.3845; train_chrom_access_recon_loss: 740946.8364; train_global_loss: 13698907.4198; train_optim_loss: 13698907.4198; val_kl_reg_loss: 40157.0388; val_edge_recon_loss: 2680614.9167; val_gene_expr_recon_loss: 10142414.4000; val_masked_gp_l1_reg_loss: 61706.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70670.0391; val_chrom_access_recon_loss: 737629.1542; val_global_loss: 13733191.6000; val_optim_loss: 13733191.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9754; val_auprc_score: 0.9644; val_best_acc_score: 0.9322; val_best_f1_score: 0.9336; train_kl_reg_loss: 48687.1768; train_edge_recon_loss: 2675939.0802; train_gene_expr_recon_loss: 10093346.1221; train_masked_gp_l1_reg_loss: 61045.6328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70863.7972; train_chrom_access_recon_loss: 738556.1594; train_global_loss: 13688437.9313; train_optim_loss: 13688437.9313; val_kl_reg_loss: 39520.2698; val_edge_recon_loss: 2684371.2667; val_gene_expr_recon_loss: 10140802.5333; val_masked_gp_l1_reg_loss: 60395.8633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71375.1719; val_chrom_access_recon_loss: 730855.5750; val_global_loss: 13727320.6667; val_optim_loss: 13727320.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9759; val_auprc_score: 0.9694; val_best_acc_score: 0.9330; val_best_f1_score: 0.9347; train_kl_reg_loss: 49144.6996; train_edge_recon_loss: 2667012.0954; train_gene_expr_recon_loss: 10073426.2214; train_masked_gp_l1_reg_loss: 59820.6452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71007.6291; train_chrom_access_recon_loss: 737095.8531; train_global_loss: 13657507.1374; train_optim_loss: 13657507.1374; val_kl_reg_loss: 41029.4964; val_edge_recon_loss: 2669678.2167; val_gene_expr_recon_loss: 10086377.5333; val_masked_gp_l1_reg_loss: 59306.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70860.0234; val_chrom_access_recon_loss: 728368.4375; val_global_loss: 13655619.8000; val_optim_loss: 13655619.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9779; val_auprc_score: 0.9712; val_best_acc_score: 0.9363; val_best_f1_score: 0.9379; train_kl_reg_loss: 48086.2719; train_edge_recon_loss: 2662153.1164; train_gene_expr_recon_loss: 10066794.8931; train_masked_gp_l1_reg_loss: 58776.4605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71028.3846; train_chrom_access_recon_loss: 735604.2991; train_global_loss: 13642443.3664; train_optim_loss: 13642443.3664; val_kl_reg_loss: 42067.3622; val_edge_recon_loss: 2656682.9167; val_gene_expr_recon_loss: 10167351.0667; val_masked_gp_l1_reg_loss: 58316.3086; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71125.2656; val_chrom_access_recon_loss: 732132.7583; val_global_loss: 13727675.0667; val_optim_loss: 13727675.0667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9774; val_auprc_score: 0.9707; val_best_acc_score: 0.9368; val_best_f1_score: 0.9385; train_kl_reg_loss: 47067.7311; train_edge_recon_loss: 2664180.9160; train_gene_expr_recon_loss: 10046277.0076; train_masked_gp_l1_reg_loss: 57865.3634; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71039.8934; train_chrom_access_recon_loss: 735216.7653; train_global_loss: 13621647.5725; train_optim_loss: 13621647.5725; val_kl_reg_loss: 43680.7104; val_edge_recon_loss: 2652032.4667; val_gene_expr_recon_loss: 10083188.6000; val_masked_gp_l1_reg_loss: 57381.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70819.5469; val_chrom_access_recon_loss: 727087.4833; val_global_loss: 13634190.2000; val_optim_loss: 13634190.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9769; val_auprc_score: 0.9706; val_best_acc_score: 0.9349; val_best_f1_score: 0.9369; train_kl_reg_loss: 47258.6395; train_edge_recon_loss: 2665295.7958; train_gene_expr_recon_loss: 10033000.6183; train_masked_gp_l1_reg_loss: 57047.7193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70800.1221; train_chrom_access_recon_loss: 734316.6336; train_global_loss: 13607719.5038; train_optim_loss: 13607719.5038; val_kl_reg_loss: 41914.0685; val_edge_recon_loss: 2669664.3167; val_gene_expr_recon_loss: 10028821.2667; val_masked_gp_l1_reg_loss: 56681.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71368.0234; val_chrom_access_recon_loss: 725160.8583; val_global_loss: 13593610.4667; val_optim_loss: 13593610.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9802; val_auprc_score: 0.9751; val_best_acc_score: 0.9383; val_best_f1_score: 0.9399; train_kl_reg_loss: 47004.9971; train_edge_recon_loss: 2660140.4275; train_gene_expr_recon_loss: 10021975.8931; train_masked_gp_l1_reg_loss: 56356.4910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71193.4374; train_chrom_access_recon_loss: 734147.8268; train_global_loss: 13590819.0763; train_optim_loss: 13590819.0763; val_kl_reg_loss: 41603.0026; val_edge_recon_loss: 2657977.2500; val_gene_expr_recon_loss: 10035231.0000; val_masked_gp_l1_reg_loss: 55978.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70995.3047; val_chrom_access_recon_loss: 724366.4625; val_global_loss: 13586150.7333; val_optim_loss: 13586150.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9789; val_auprc_score: 0.9704; val_best_acc_score: 0.9399; val_best_f1_score: 0.9410; train_kl_reg_loss: 47046.6270; train_edge_recon_loss: 2659819.8416; train_gene_expr_recon_loss: 10009043.0382; train_masked_gp_l1_reg_loss: 55579.3228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71010.4854; train_chrom_access_recon_loss: 732217.1288; train_global_loss: 13574716.3664; train_optim_loss: 13574716.3664; val_kl_reg_loss: 41225.9589; val_edge_recon_loss: 2667923.5000; val_gene_expr_recon_loss: 10046911.3333; val_masked_gp_l1_reg_loss: 55252.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70635.6406; val_chrom_access_recon_loss: 727707.1000; val_global_loss: 13609656.7333; val_optim_loss: 13609656.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9783; val_auprc_score: 0.9711; val_best_acc_score: 0.9382; val_best_f1_score: 0.9397; train_kl_reg_loss: 47052.0276; train_edge_recon_loss: 2655500.9313; train_gene_expr_recon_loss: 9991494.8244; train_masked_gp_l1_reg_loss: 55023.6582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70926.6050; train_chrom_access_recon_loss: 731563.5444; train_global_loss: 13551561.6260; train_optim_loss: 13551561.6260; val_kl_reg_loss: 43856.7810; val_edge_recon_loss: 2655823.4667; val_gene_expr_recon_loss: 10040499.2000; val_masked_gp_l1_reg_loss: 54764.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70982.2734; val_chrom_access_recon_loss: 725856.5125; val_global_loss: 13591782.0000; val_optim_loss: 13591782.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9774; val_auprc_score: 0.9686; val_best_acc_score: 0.9361; val_best_f1_score: 0.9379; train_kl_reg_loss: 46393.8384; train_edge_recon_loss: 2654247.9580; train_gene_expr_recon_loss: 9998775.8626; train_masked_gp_l1_reg_loss: 54543.1466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71072.4200; train_chrom_access_recon_loss: 731175.7195; train_global_loss: 13556208.9313; train_optim_loss: 13556208.9313; val_kl_reg_loss: 41772.0411; val_edge_recon_loss: 2675716.4833; val_gene_expr_recon_loss: 10030598.1333; val_masked_gp_l1_reg_loss: 54325.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71301.2266; val_chrom_access_recon_loss: 721730.6333; val_global_loss: 13595443.0000; val_optim_loss: 13595443.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9800; val_auprc_score: 0.9717; val_best_acc_score: 0.9396; val_best_f1_score: 0.9414; train_kl_reg_loss: 46240.4910; train_edge_recon_loss: 2654843.5611; train_gene_expr_recon_loss: 9983617.5115; train_masked_gp_l1_reg_loss: 54105.9862; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71046.3118; train_chrom_access_recon_loss: 731117.6054; train_global_loss: 13540971.6107; train_optim_loss: 13540971.6107; val_kl_reg_loss: 42018.3576; val_edge_recon_loss: 2661839.4000; val_gene_expr_recon_loss: 10023505.9333; val_masked_gp_l1_reg_loss: 53942.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71304.2422; val_chrom_access_recon_loss: 726992.0208; val_global_loss: 13579602.0000; val_optim_loss: 13579602.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9770; val_auprc_score: 0.9688; val_best_acc_score: 0.9347; val_best_f1_score: 0.9370; train_kl_reg_loss: 46641.2981; train_edge_recon_loss: 2652381.4656; train_gene_expr_recon_loss: 9976931.4656; train_masked_gp_l1_reg_loss: 53724.3469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71187.9851; train_chrom_access_recon_loss: 730069.3244; train_global_loss: 13530935.8244; train_optim_loss: 13530935.8244; val_kl_reg_loss: 41800.6740; val_edge_recon_loss: 2655835.3667; val_gene_expr_recon_loss: 9989446.6667; val_masked_gp_l1_reg_loss: 53430.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71219.8984; val_chrom_access_recon_loss: 720607.1958; val_global_loss: 13532341.0000; val_optim_loss: 13532341.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9792; val_auprc_score: 0.9695; val_best_acc_score: 0.9394; val_best_f1_score: 0.9409; train_kl_reg_loss: 46106.8761; train_edge_recon_loss: 2658289.4427; train_gene_expr_recon_loss: 9952157.4656; train_masked_gp_l1_reg_loss: 53262.3713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71225.2544; train_chrom_access_recon_loss: 727908.8330; train_global_loss: 13508950.1908; train_optim_loss: 13508950.1908; val_kl_reg_loss: 41576.8701; val_edge_recon_loss: 2660254.5000; val_gene_expr_recon_loss: 10005838.1333; val_masked_gp_l1_reg_loss: 53095.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71160.0234; val_chrom_access_recon_loss: 721248.2417; val_global_loss: 13553173.8000; val_optim_loss: 13553173.8000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9791; val_auprc_score: 0.9691; val_best_acc_score: 0.9382; val_best_f1_score: 0.9391; train_kl_reg_loss: 45979.8805; train_edge_recon_loss: 2646670.3321; train_gene_expr_recon_loss: 9956089.0534; train_masked_gp_l1_reg_loss: 52882.5049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71216.5227; train_chrom_access_recon_loss: 727206.7042; train_global_loss: 13500044.9924; train_optim_loss: 13500044.9924; val_kl_reg_loss: 42346.1471; val_edge_recon_loss: 2673288.7833; val_gene_expr_recon_loss: 9985489.6000; val_masked_gp_l1_reg_loss: 52745.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71045.2891; val_chrom_access_recon_loss: 721703.3708; val_global_loss: 13546618.7333; val_optim_loss: 13546618.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9772; val_auprc_score: 0.9661; val_best_acc_score: 0.9355; val_best_f1_score: 0.9366; train_kl_reg_loss: 45165.4698; train_edge_recon_loss: 2654184.6927; train_gene_expr_recon_loss: 9949688.2366; train_masked_gp_l1_reg_loss: 52581.0907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71239.2755; train_chrom_access_recon_loss: 727608.6431; train_global_loss: 13500467.3664; train_optim_loss: 13500467.3664; val_kl_reg_loss: 42032.9227; val_edge_recon_loss: 2673288.8833; val_gene_expr_recon_loss: 9976110.5333; val_masked_gp_l1_reg_loss: 52479.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72045.6406; val_chrom_access_recon_loss: 719828.3875; val_global_loss: 13535785.6667; val_optim_loss: 13535785.6667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9814; val_auprc_score: 0.9743; val_best_acc_score: 0.9371; val_best_f1_score: 0.9388; train_kl_reg_loss: 46280.7759; train_edge_recon_loss: 2653681.2996; train_gene_expr_recon_loss: 9933160.0611; train_masked_gp_l1_reg_loss: 52314.7481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71436.8231; train_chrom_access_recon_loss: 725542.1260; train_global_loss: 13482415.8168; train_optim_loss: 13482415.8168; val_kl_reg_loss: 42249.7151; val_edge_recon_loss: 2672086.0500; val_gene_expr_recon_loss: 9972552.0000; val_masked_gp_l1_reg_loss: 52134.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71353.4609; val_chrom_access_recon_loss: 723362.6708; val_global_loss: 13533738.4000; val_optim_loss: 13533738.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9803; val_auprc_score: 0.9746; val_best_acc_score: 0.9367; val_best_f1_score: 0.9383; train_kl_reg_loss: 45223.2030; train_edge_recon_loss: 2649081.8149; train_gene_expr_recon_loss: 9919180.5725; train_masked_gp_l1_reg_loss: 51673.6701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60168.5559; train_chrom_access_recon_loss: 725839.2409; train_global_loss: 13451166.9847; train_optim_loss: 13451166.9847; val_kl_reg_loss: 43169.0326; val_edge_recon_loss: 2657900.7000; val_gene_expr_recon_loss: 9973150.7333; val_masked_gp_l1_reg_loss: 51527.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58085.9375; val_chrom_access_recon_loss: 718120.6500; val_global_loss: 13501954.0000; val_optim_loss: 13501954.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9792; val_auprc_score: 0.9727; val_best_acc_score: 0.9399; val_best_f1_score: 0.9409; train_kl_reg_loss: 46340.8988; train_edge_recon_loss: 2654222.2557; train_gene_expr_recon_loss: 9902080.1756; train_masked_gp_l1_reg_loss: 51486.7442; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57536.0503; train_chrom_access_recon_loss: 724458.5296; train_global_loss: 13436124.6718; train_optim_loss: 13436124.6718; val_kl_reg_loss: 43541.0240; val_edge_recon_loss: 2676188.0500; val_gene_expr_recon_loss: 9953691.7333; val_masked_gp_l1_reg_loss: 51457.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57103.3672; val_chrom_access_recon_loss: 717559.8667; val_global_loss: 13499540.6000; val_optim_loss: 13499540.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9798; val_auprc_score: 0.9735; val_best_acc_score: 0.9386; val_best_f1_score: 0.9404; train_kl_reg_loss: 46902.5605; train_edge_recon_loss: 2642680.2710; train_gene_expr_recon_loss: 9897197.6565; train_masked_gp_l1_reg_loss: 51438.2882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56835.2571; train_chrom_access_recon_loss: 723792.5296; train_global_loss: 13418846.5496; train_optim_loss: 13418846.5496; val_kl_reg_loss: 44659.2789; val_edge_recon_loss: 2669026.6333; val_gene_expr_recon_loss: 9954243.0667; val_masked_gp_l1_reg_loss: 51413.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56500.3242; val_chrom_access_recon_loss: 718708.4875; val_global_loss: 13494550.3333; val_optim_loss: 13494550.3333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9780; val_auprc_score: 0.9697; val_best_acc_score: 0.9364; val_best_f1_score: 0.9381; train_kl_reg_loss: 47361.1504; train_edge_recon_loss: 2641637.5267; train_gene_expr_recon_loss: 9900657.3969; train_masked_gp_l1_reg_loss: 51393.5204; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56259.6310; train_chrom_access_recon_loss: 723589.2319; train_global_loss: 13420898.5496; train_optim_loss: 13420898.5496; val_kl_reg_loss: 44816.8013; val_edge_recon_loss: 2662056.3667; val_gene_expr_recon_loss: 9948418.3333; val_masked_gp_l1_reg_loss: 51386.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56015.7852; val_chrom_access_recon_loss: 718977.2792; val_global_loss: 13481671.8000; val_optim_loss: 13481671.8000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9807; val_auprc_score: 0.9744; val_best_acc_score: 0.9406; val_best_f1_score: 0.9422; train_kl_reg_loss: 47318.9048; train_edge_recon_loss: 2652376.1240; train_gene_expr_recon_loss: 9903272.6794; train_masked_gp_l1_reg_loss: 51372.1593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55840.8691; train_chrom_access_recon_loss: 724031.8717; train_global_loss: 13434212.6183; train_optim_loss: 13434212.6183; val_kl_reg_loss: 44578.1568; val_edge_recon_loss: 2666864.7167; val_gene_expr_recon_loss: 9956332.0000; val_masked_gp_l1_reg_loss: 51369.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55613.1602; val_chrom_access_recon_loss: 717217.3667; val_global_loss: 13491975.2000; val_optim_loss: 13491975.2000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9807; val_auprc_score: 0.9709; val_best_acc_score: 0.9372; val_best_f1_score: 0.9387; train_kl_reg_loss: 47623.1864; train_edge_recon_loss: 2647773.2405; train_gene_expr_recon_loss: 9904559.0992; train_masked_gp_l1_reg_loss: 51351.3268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55471.0516; train_chrom_access_recon_loss: 724169.4709; train_global_loss: 13430947.3130; train_optim_loss: 13430947.3130; val_kl_reg_loss: 45006.1448; val_edge_recon_loss: 2659192.3000; val_gene_expr_recon_loss: 9959774.1333; val_masked_gp_l1_reg_loss: 51332.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55293.3516; val_chrom_access_recon_loss: 718689.5792; val_global_loss: 13489288.2667; val_optim_loss: 13489288.2667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9801; val_auprc_score: 0.9731; val_best_acc_score: 0.9404; val_best_f1_score: 0.9424; train_kl_reg_loss: 47771.1105; train_edge_recon_loss: 2651575.4676; train_gene_expr_recon_loss: 9896210.5649; train_masked_gp_l1_reg_loss: 51314.1768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55135.5966; train_chrom_access_recon_loss: 724085.6102; train_global_loss: 13426092.4962; train_optim_loss: 13426092.4962; val_kl_reg_loss: 45194.1766; val_edge_recon_loss: 2646292.2500; val_gene_expr_recon_loss: 9975666.5333; val_masked_gp_l1_reg_loss: 51300.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54992.5977; val_chrom_access_recon_loss: 718260.4292; val_global_loss: 13491706.3333; val_optim_loss: 13491706.3333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9787; val_auprc_score: 0.9702; val_best_acc_score: 0.9368; val_best_f1_score: 0.9387; train_kl_reg_loss: 47759.0006; train_edge_recon_loss: 2641868.4714; train_gene_expr_recon_loss: 9903389.5725; train_masked_gp_l1_reg_loss: 51276.7278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54856.3563; train_chrom_access_recon_loss: 723942.2156; train_global_loss: 13423092.3664; train_optim_loss: 13423092.3664; val_kl_reg_loss: 45326.2971; val_edge_recon_loss: 2676434.0500; val_gene_expr_recon_loss: 9967974.2000; val_masked_gp_l1_reg_loss: 51268.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54659.0664; val_chrom_access_recon_loss: 718687.8875; val_global_loss: 13514350.4667; val_optim_loss: 13514350.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9819; val_auprc_score: 0.9748; val_best_acc_score: 0.9409; val_best_f1_score: 0.9427; train_kl_reg_loss: 48000.3865; train_edge_recon_loss: 2650625.1698; train_gene_expr_recon_loss: 9901574.7252; train_masked_gp_l1_reg_loss: 51225.3591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53546.9938; train_chrom_access_recon_loss: 724581.0596; train_global_loss: 13429553.6947; train_optim_loss: 13429553.6947; val_kl_reg_loss: 45380.4047; val_edge_recon_loss: 2650085.0000; val_gene_expr_recon_loss: 9927331.2667; val_masked_gp_l1_reg_loss: 51208.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53355.9727; val_chrom_access_recon_loss: 716908.7583; val_global_loss: 13444269.4667; val_optim_loss: 13444269.4667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9783; val_auprc_score: 0.9708; val_best_acc_score: 0.9367; val_best_f1_score: 0.9379; train_kl_reg_loss: 47878.4616; train_edge_recon_loss: 2646830.5458; train_gene_expr_recon_loss: 9903887.4504; train_masked_gp_l1_reg_loss: 51202.2303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53301.3957; train_chrom_access_recon_loss: 724520.8201; train_global_loss: 13427620.9084; train_optim_loss: 13427620.9084; val_kl_reg_loss: 45216.6930; val_edge_recon_loss: 2677162.9167; val_gene_expr_recon_loss: 9927226.5333; val_masked_gp_l1_reg_loss: 51196.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53236.2383; val_chrom_access_recon_loss: 717837.3208; val_global_loss: 13471876.4000; val_optim_loss: 13471876.4000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9796; val_auprc_score: 0.9724; val_best_acc_score: 0.9382; val_best_f1_score: 0.9403; train_kl_reg_loss: 47829.7229; train_edge_recon_loss: 2646182.2328; train_gene_expr_recon_loss: 9897895.3130; train_masked_gp_l1_reg_loss: 51191.6856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53186.4906; train_chrom_access_recon_loss: 723876.6460; train_global_loss: 13420162.0382; train_optim_loss: 13420162.0382; val_kl_reg_loss: 45180.7427; val_edge_recon_loss: 2662217.0500; val_gene_expr_recon_loss: 9923866.0000; val_masked_gp_l1_reg_loss: 51188.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53146.7148; val_chrom_access_recon_loss: 716516.5958; val_global_loss: 13452115.2667; val_optim_loss: 13452115.2667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9807; val_auprc_score: 0.9749; val_best_acc_score: 0.9375; val_best_f1_score: 0.9392; train_kl_reg_loss: 47806.9756; train_edge_recon_loss: 2639183.7195; train_gene_expr_recon_loss: 9903128.8550; train_masked_gp_l1_reg_loss: 51185.5631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53116.3781; train_chrom_access_recon_loss: 724498.0119; train_global_loss: 13418919.5115; train_optim_loss: 13418919.5115; val_kl_reg_loss: 45445.4698; val_edge_recon_loss: 2662063.0167; val_gene_expr_recon_loss: 9947993.6000; val_masked_gp_l1_reg_loss: 51182.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53078.0742; val_chrom_access_recon_loss: 721067.7125; val_global_loss: 13480829.7333; val_optim_loss: 13480829.7333
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9806; val_auprc_score: 0.9751; val_best_acc_score: 0.9367; val_best_f1_score: 0.9377; train_kl_reg_loss: 47705.6698; train_edge_recon_loss: 2650775.8378; train_gene_expr_recon_loss: 9900227.7634; train_masked_gp_l1_reg_loss: 51180.7621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53051.2009; train_chrom_access_recon_loss: 723668.6045; train_global_loss: 13426609.7863; train_optim_loss: 13426609.7863; val_kl_reg_loss: 45250.4375; val_edge_recon_loss: 2675613.6167; val_gene_expr_recon_loss: 9973994.8667; val_masked_gp_l1_reg_loss: 51178.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53011.9141; val_chrom_access_recon_loss: 723561.8083; val_global_loss: 13522611.6667; val_optim_loss: 13522611.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9800; val_auprc_score: 0.9701; val_best_acc_score: 0.9404; val_best_f1_score: 0.9412; train_kl_reg_loss: 47874.1461; train_edge_recon_loss: 2645980.9389; train_gene_expr_recon_loss: 9904127.3893; train_masked_gp_l1_reg_loss: 51174.3466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52900.0971; train_chrom_access_recon_loss: 724460.0630; train_global_loss: 13426516.9695; train_optim_loss: 13426516.9695; val_kl_reg_loss: 45553.9628; val_edge_recon_loss: 2657052.2833; val_gene_expr_recon_loss: 9952475.2667; val_masked_gp_l1_reg_loss: 51172.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52883.2773; val_chrom_access_recon_loss: 716976.2500; val_global_loss: 13476113.8000; val_optim_loss: 13476113.8000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9808; val_auprc_score: 0.9761; val_best_acc_score: 0.9406; val_best_f1_score: 0.9415; train_kl_reg_loss: 47803.3006; train_edge_recon_loss: 2645104.9218; train_gene_expr_recon_loss: 9894018.4427; train_masked_gp_l1_reg_loss: 51172.2569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52877.5958; train_chrom_access_recon_loss: 723714.4289; train_global_loss: 13414691.0000; train_optim_loss: 13414691.0000; val_kl_reg_loss: 45258.4203; val_edge_recon_loss: 2654966.4167; val_gene_expr_recon_loss: 9985054.1333; val_masked_gp_l1_reg_loss: 51171.6055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52872.1719; val_chrom_access_recon_loss: 719939.4667; val_global_loss: 13509262.4000; val_optim_loss: 13509262.4000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9790; val_auprc_score: 0.9705; val_best_acc_score: 0.9371; val_best_f1_score: 0.9388; train_kl_reg_loss: 47792.7202; train_edge_recon_loss: 2647982.1107; train_gene_expr_recon_loss: 9896769.6718; train_masked_gp_l1_reg_loss: 51171.0913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52867.4094; train_chrom_access_recon_loss: 723986.3063; train_global_loss: 13420569.2748; train_optim_loss: 13420569.2748; val_kl_reg_loss: 45254.1490; val_edge_recon_loss: 2681146.0667; val_gene_expr_recon_loss: 9989885.4000; val_masked_gp_l1_reg_loss: 51170.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52863.0703; val_chrom_access_recon_loss: 719083.3458; val_global_loss: 13539402.9333; val_optim_loss: 13539402.9333
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9815; val_auprc_score: 0.9754; val_best_acc_score: 0.9410; val_best_f1_score: 0.9425; train_kl_reg_loss: 47728.9728; train_edge_recon_loss: 2648554.4924; train_gene_expr_recon_loss: 9904084.8626; train_masked_gp_l1_reg_loss: 51170.1409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52858.9625; train_chrom_access_recon_loss: 724832.5372; train_global_loss: 13429229.9313; train_optim_loss: 13429229.9313; val_kl_reg_loss: 45383.6164; val_edge_recon_loss: 2657197.3667; val_gene_expr_recon_loss: 9962859.9333; val_masked_gp_l1_reg_loss: 51169.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52854.7227; val_chrom_access_recon_loss: 718521.1375; val_global_loss: 13487987.1333; val_optim_loss: 13487987.1333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 58 min 45 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9814
val AUPRC score: 0.9760
val best accuracy score: 0.9391
val best F1 score: 0.9406
val target rna MSE score: 1.6856
val source rna MSE score: 0.4695
val target atac MSE score: 0.4917
val source atac MSE score: 0.1493
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
