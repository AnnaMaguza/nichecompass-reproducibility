[True]
Run timestamp: 10102023_042900_141.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_141']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7773; val_auprc_score: 0.7985; val_best_acc_score: 0.5810; val_best_f1_score: 0.6989; train_kl_reg_loss: 78222.3453; train_edge_recon_loss: 3513422.5973; train_gene_expr_recon_loss: 13307415.7176; train_masked_gp_l1_reg_loss: 47327.7716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3204330.6880; train_chrom_access_recon_loss: 11172930.0992; train_global_loss: 31323649.0534; train_optim_loss: 31323649.0534; val_kl_reg_loss: 116519.7672; val_edge_recon_loss: 4060710.9000; val_gene_expr_recon_loss: 12473623.9333; val_masked_gp_l1_reg_loss: 54680.6367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 412127.4688; val_chrom_access_recon_loss: 10776649.4000; val_global_loss: 27894312.0000; val_optim_loss: 27894312.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8313; val_auprc_score: 0.8360; val_best_acc_score: 0.7390; val_best_f1_score: 0.7639; train_kl_reg_loss: 85713.4908; train_edge_recon_loss: 3452749.9847; train_gene_expr_recon_loss: 12550470.1985; train_masked_gp_l1_reg_loss: 57798.2301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 235029.2063; train_chrom_access_recon_loss: 10794514.3664; train_global_loss: 27176275.5878; train_optim_loss: 27176275.5878; val_kl_reg_loss: 87694.7130; val_edge_recon_loss: 3225752.4500; val_gene_expr_recon_loss: 12352962.8667; val_masked_gp_l1_reg_loss: 61969.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158916.3750; val_chrom_access_recon_loss: 10624588.2000; val_global_loss: 26511883.4667; val_optim_loss: 26511883.4667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9100; val_auprc_score: 0.8972; val_best_acc_score: 0.8371; val_best_f1_score: 0.8459; train_kl_reg_loss: 97376.2244; train_edge_recon_loss: 3008827.5649; train_gene_expr_recon_loss: 12417610.3664; train_masked_gp_l1_reg_loss: 67247.8155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135218.4444; train_chrom_access_recon_loss: 10664198.3740; train_global_loss: 26390478.7939; train_optim_loss: 26390478.7939; val_kl_reg_loss: 108191.7917; val_edge_recon_loss: 2883191.6667; val_gene_expr_recon_loss: 12180956.2000; val_masked_gp_l1_reg_loss: 71428.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121474.0703; val_chrom_access_recon_loss: 10508873.6000; val_global_loss: 25874114.9333; val_optim_loss: 25874114.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9260; val_auprc_score: 0.9126; val_best_acc_score: 0.8604; val_best_f1_score: 0.8681; train_kl_reg_loss: 108433.6162; train_edge_recon_loss: 2830299.7405; train_gene_expr_recon_loss: 12280373.9237; train_masked_gp_l1_reg_loss: 73723.6990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114223.1341; train_chrom_access_recon_loss: 10561952.6794; train_global_loss: 25969006.7634; train_optim_loss: 25969006.7634; val_kl_reg_loss: 101179.3901; val_edge_recon_loss: 2836148.7333; val_gene_expr_recon_loss: 12094230.4667; val_masked_gp_l1_reg_loss: 75599.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109985.7109; val_chrom_access_recon_loss: 10440687.6667; val_global_loss: 25657831.6000; val_optim_loss: 25657831.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9403; val_auprc_score: 0.9287; val_best_acc_score: 0.8775; val_best_f1_score: 0.8825; train_kl_reg_loss: 101547.3283; train_edge_recon_loss: 2805077.5115; train_gene_expr_recon_loss: 12161668.0534; train_masked_gp_l1_reg_loss: 77148.6245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107422.4628; train_chrom_access_recon_loss: 10466803.8931; train_global_loss: 25719667.9237; train_optim_loss: 25719667.9237; val_kl_reg_loss: 96056.8870; val_edge_recon_loss: 2797989.2500; val_gene_expr_recon_loss: 11931198.0667; val_masked_gp_l1_reg_loss: 78497.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105721.7344; val_chrom_access_recon_loss: 10298394.4000; val_global_loss: 25307858.6667; val_optim_loss: 25307858.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9433; val_auprc_score: 0.9282; val_best_acc_score: 0.8821; val_best_f1_score: 0.8847; train_kl_reg_loss: 97446.4616; train_edge_recon_loss: 2776646.6450; train_gene_expr_recon_loss: 12062947.6565; train_masked_gp_l1_reg_loss: 79960.3609; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104543.6509; train_chrom_access_recon_loss: 10392145.5878; train_global_loss: 25513690.4122; train_optim_loss: 25513690.4122; val_kl_reg_loss: 95778.6745; val_edge_recon_loss: 2811930.3833; val_gene_expr_recon_loss: 11896710.5333; val_masked_gp_l1_reg_loss: 81291.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103474.9688; val_chrom_access_recon_loss: 10254713.8000; val_global_loss: 25243900.4000; val_optim_loss: 25243900.4000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9486; val_auprc_score: 0.9370; val_best_acc_score: 0.8892; val_best_f1_score: 0.8947; train_kl_reg_loss: 95956.5714; train_edge_recon_loss: 2755259.9790; train_gene_expr_recon_loss: 11977882.2061; train_masked_gp_l1_reg_loss: 82251.8979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102679.3238; train_chrom_access_recon_loss: 10310956.5878; train_global_loss: 25324986.5649; train_optim_loss: 25324986.5649; val_kl_reg_loss: 93426.3391; val_edge_recon_loss: 2762311.2667; val_gene_expr_recon_loss: 11769256.6667; val_masked_gp_l1_reg_loss: 83272.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101974.0078; val_chrom_access_recon_loss: 10160756.2000; val_global_loss: 24970997.8667; val_optim_loss: 24970997.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9526; val_auprc_score: 0.9409; val_best_acc_score: 0.8914; val_best_f1_score: 0.8966; train_kl_reg_loss: 94740.9663; train_edge_recon_loss: 2755951.0477; train_gene_expr_recon_loss: 11917867.7710; train_masked_gp_l1_reg_loss: 84167.5345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100816.7898; train_chrom_access_recon_loss: 10262236.6947; train_global_loss: 25215780.8092; train_optim_loss: 25215780.8092; val_kl_reg_loss: 92051.3219; val_edge_recon_loss: 2758474.8333; val_gene_expr_recon_loss: 11722390.7333; val_masked_gp_l1_reg_loss: 84837.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100362.9141; val_chrom_access_recon_loss: 10154432.8667; val_global_loss: 24912550.8000; val_optim_loss: 24912550.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9485; val_auprc_score: 0.9296; val_best_acc_score: 0.8914; val_best_f1_score: 0.8967; train_kl_reg_loss: 90742.0286; train_edge_recon_loss: 2749647.8282; train_gene_expr_recon_loss: 11835908.2214; train_masked_gp_l1_reg_loss: 85342.6131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98738.6177; train_chrom_access_recon_loss: 10183166.9771; train_global_loss: 25043546.2748; train_optim_loss: 25043546.2748; val_kl_reg_loss: 92564.4880; val_edge_recon_loss: 2756691.8000; val_gene_expr_recon_loss: 11644789.2667; val_masked_gp_l1_reg_loss: 85800.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97586.7188; val_chrom_access_recon_loss: 10048747.2000; val_global_loss: 24726180.0000; val_optim_loss: 24726180.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9587; val_auprc_score: 0.9500; val_best_acc_score: 0.9007; val_best_f1_score: 0.9038; train_kl_reg_loss: 91196.1344; train_edge_recon_loss: 2728889.3149; train_gene_expr_recon_loss: 11786220.8550; train_masked_gp_l1_reg_loss: 86137.8359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96855.0776; train_chrom_access_recon_loss: 10133888.3435; train_global_loss: 24923187.5267; train_optim_loss: 24923187.5267; val_kl_reg_loss: 86193.8281; val_edge_recon_loss: 2733157.4500; val_gene_expr_recon_loss: 11649428.1333; val_masked_gp_l1_reg_loss: 86672.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95897.3672; val_chrom_access_recon_loss: 10031778.2667; val_global_loss: 24683127.8667; val_optim_loss: 24683127.8667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9599; val_auprc_score: 0.9507; val_best_acc_score: 0.9025; val_best_f1_score: 0.9067; train_kl_reg_loss: 89194.4900; train_edge_recon_loss: 2722498.1431; train_gene_expr_recon_loss: 11744495.2290; train_masked_gp_l1_reg_loss: 87035.6946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95618.7706; train_chrom_access_recon_loss: 10087146.8550; train_global_loss: 24825989.1450; train_optim_loss: 24825989.1450; val_kl_reg_loss: 87549.3479; val_edge_recon_loss: 2711924.2500; val_gene_expr_recon_loss: 11572270.2000; val_masked_gp_l1_reg_loss: 87146.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94723.1953; val_chrom_access_recon_loss: 9998782.0000; val_global_loss: 24552395.7333; val_optim_loss: 24552395.7333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9545; val_auprc_score: 0.9415; val_best_acc_score: 0.8979; val_best_f1_score: 0.9023; train_kl_reg_loss: 87955.8780; train_edge_recon_loss: 2722739.7443; train_gene_expr_recon_loss: 11684499.3359; train_masked_gp_l1_reg_loss: 87486.5422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94220.3246; train_chrom_access_recon_loss: 10020761.0305; train_global_loss: 24697662.8855; train_optim_loss: 24697662.8855; val_kl_reg_loss: 84546.9057; val_edge_recon_loss: 2751409.3500; val_gene_expr_recon_loss: 11526478.5333; val_masked_gp_l1_reg_loss: 87722.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94342.9844; val_chrom_access_recon_loss: 9888437.4000; val_global_loss: 24432938.4000; val_optim_loss: 24432938.4000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9590; val_auprc_score: 0.9466; val_best_acc_score: 0.9053; val_best_f1_score: 0.9081; train_kl_reg_loss: 85603.0280; train_edge_recon_loss: 2714183.7080; train_gene_expr_recon_loss: 11636551.2137; train_masked_gp_l1_reg_loss: 87992.0834; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93536.9920; train_chrom_access_recon_loss: 9964539.8855; train_global_loss: 24582406.9771; train_optim_loss: 24582406.9771; val_kl_reg_loss: 86072.1271; val_edge_recon_loss: 2737183.4500; val_gene_expr_recon_loss: 11481138.0000; val_masked_gp_l1_reg_loss: 88215.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92678.8828; val_chrom_access_recon_loss: 9826979.2667; val_global_loss: 24312267.8667; val_optim_loss: 24312267.8667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9609; val_auprc_score: 0.9488; val_best_acc_score: 0.9066; val_best_f1_score: 0.9113; train_kl_reg_loss: 85569.7982; train_edge_recon_loss: 2712005.3798; train_gene_expr_recon_loss: 11613948.0000; train_masked_gp_l1_reg_loss: 88369.5612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92532.7626; train_chrom_access_recon_loss: 9929116.7939; train_global_loss: 24521542.4427; train_optim_loss: 24521542.4427; val_kl_reg_loss: 85321.6323; val_edge_recon_loss: 2731778.9833; val_gene_expr_recon_loss: 11445974.0667; val_masked_gp_l1_reg_loss: 88546.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92672.0938; val_chrom_access_recon_loss: 9835468.9333; val_global_loss: 24279761.7333; val_optim_loss: 24279761.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9649; val_auprc_score: 0.9545; val_best_acc_score: 0.9130; val_best_f1_score: 0.9170; train_kl_reg_loss: 84333.0506; train_edge_recon_loss: 2713114.2958; train_gene_expr_recon_loss: 11569586.7405; train_masked_gp_l1_reg_loss: 88780.8829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92036.3834; train_chrom_access_recon_loss: 9881785.3740; train_global_loss: 24429636.7634; train_optim_loss: 24429636.7634; val_kl_reg_loss: 85560.4094; val_edge_recon_loss: 2722812.4833; val_gene_expr_recon_loss: 11397902.6000; val_masked_gp_l1_reg_loss: 88814.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91473.4297; val_chrom_access_recon_loss: 9763279.8000; val_global_loss: 24149842.5333; val_optim_loss: 24149842.5333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9653; val_auprc_score: 0.9535; val_best_acc_score: 0.9142; val_best_f1_score: 0.9180; train_kl_reg_loss: 84360.3078; train_edge_recon_loss: 2702018.3779; train_gene_expr_recon_loss: 11538690.7405; train_masked_gp_l1_reg_loss: 88801.4372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91590.0249; train_chrom_access_recon_loss: 9833077.4427; train_global_loss: 24338538.2901; train_optim_loss: 24338538.2901; val_kl_reg_loss: 81229.0672; val_edge_recon_loss: 2732736.4333; val_gene_expr_recon_loss: 11429529.4667; val_masked_gp_l1_reg_loss: 88786.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91397.1562; val_chrom_access_recon_loss: 9787697.2000; val_global_loss: 24211375.2000; val_optim_loss: 24211375.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9664; val_auprc_score: 0.9564; val_best_acc_score: 0.9153; val_best_f1_score: 0.9172; train_kl_reg_loss: 83994.5117; train_edge_recon_loss: 2702381.8225; train_gene_expr_recon_loss: 11514359.3053; train_masked_gp_l1_reg_loss: 88671.4599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91221.0085; train_chrom_access_recon_loss: 9785012.3359; train_global_loss: 24265640.5649; train_optim_loss: 24265640.5649; val_kl_reg_loss: 82602.9365; val_edge_recon_loss: 2716005.3000; val_gene_expr_recon_loss: 11352360.6000; val_masked_gp_l1_reg_loss: 88809.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92061.8359; val_chrom_access_recon_loss: 9691113.8000; val_global_loss: 24022954.0000; val_optim_loss: 24022954.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9672; val_auprc_score: 0.9554; val_best_acc_score: 0.9148; val_best_f1_score: 0.9178; train_kl_reg_loss: 82549.9114; train_edge_recon_loss: 2699316.8626; train_gene_expr_recon_loss: 11487934.7405; train_masked_gp_l1_reg_loss: 88659.1190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91247.3338; train_chrom_access_recon_loss: 9746559.1298; train_global_loss: 24196267.0992; train_optim_loss: 24196267.0992; val_kl_reg_loss: 80062.5802; val_edge_recon_loss: 2717038.2000; val_gene_expr_recon_loss: 11354644.1333; val_masked_gp_l1_reg_loss: 88744.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91200.5469; val_chrom_access_recon_loss: 9674625.6000; val_global_loss: 24006316.2667; val_optim_loss: 24006316.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9705; val_auprc_score: 0.9599; val_best_acc_score: 0.9217; val_best_f1_score: 0.9237; train_kl_reg_loss: 81634.6218; train_edge_recon_loss: 2699066.9351; train_gene_expr_recon_loss: 11472069.4885; train_masked_gp_l1_reg_loss: 88654.2534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91302.9641; train_chrom_access_recon_loss: 9710537.2595; train_global_loss: 24143265.5878; train_optim_loss: 24143265.5878; val_kl_reg_loss: 81735.1031; val_edge_recon_loss: 2712086.1667; val_gene_expr_recon_loss: 11313024.0000; val_masked_gp_l1_reg_loss: 88641.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91291.7656; val_chrom_access_recon_loss: 9652819.4667; val_global_loss: 23939598.0000; val_optim_loss: 23939598.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9722; val_auprc_score: 0.9647; val_best_acc_score: 0.9243; val_best_f1_score: 0.9270; train_kl_reg_loss: 81163.5290; train_edge_recon_loss: 2693347.5057; train_gene_expr_recon_loss: 11441737.2366; train_masked_gp_l1_reg_loss: 88383.5242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90959.7249; train_chrom_access_recon_loss: 9657946.3740; train_global_loss: 24053537.7710; train_optim_loss: 24053537.7710; val_kl_reg_loss: 80997.0740; val_edge_recon_loss: 2694348.0500; val_gene_expr_recon_loss: 11273659.9333; val_masked_gp_l1_reg_loss: 88396.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91286.6953; val_chrom_access_recon_loss: 9626632.5333; val_global_loss: 23855321.6000; val_optim_loss: 23855321.6000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9748; val_auprc_score: 0.9685; val_best_acc_score: 0.9260; val_best_f1_score: 0.9280; train_kl_reg_loss: 81027.9651; train_edge_recon_loss: 2696340.9885; train_gene_expr_recon_loss: 11427530.3511; train_masked_gp_l1_reg_loss: 88244.9756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90976.1258; train_chrom_access_recon_loss: 9632444.6183; train_global_loss: 24016564.9466; train_optim_loss: 24016564.9466; val_kl_reg_loss: 83293.1406; val_edge_recon_loss: 2698028.1167; val_gene_expr_recon_loss: 11278383.4667; val_masked_gp_l1_reg_loss: 88233.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92031.7109; val_chrom_access_recon_loss: 9562615.4667; val_global_loss: 23802585.2000; val_optim_loss: 23802585.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9758; val_auprc_score: 0.9681; val_best_acc_score: 0.9271; val_best_f1_score: 0.9299; train_kl_reg_loss: 80178.3478; train_edge_recon_loss: 2690715.1966; train_gene_expr_recon_loss: 11394728.6260; train_masked_gp_l1_reg_loss: 87895.2548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91198.0247; train_chrom_access_recon_loss: 9588488.9160; train_global_loss: 23933204.3969; train_optim_loss: 23933204.3969; val_kl_reg_loss: 77981.1651; val_edge_recon_loss: 2695529.2500; val_gene_expr_recon_loss: 11260909.4667; val_masked_gp_l1_reg_loss: 87722.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91692.9219; val_chrom_access_recon_loss: 9550066.2667; val_global_loss: 23763902.1333; val_optim_loss: 23763902.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9761; val_auprc_score: 0.9703; val_best_acc_score: 0.9278; val_best_f1_score: 0.9297; train_kl_reg_loss: 79429.7313; train_edge_recon_loss: 2687952.0439; train_gene_expr_recon_loss: 11384977.9771; train_masked_gp_l1_reg_loss: 87452.2890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91285.9727; train_chrom_access_recon_loss: 9568961.9695; train_global_loss: 23900060.0916; train_optim_loss: 23900060.0916; val_kl_reg_loss: 76314.5042; val_edge_recon_loss: 2705497.5833; val_gene_expr_recon_loss: 11267286.0000; val_masked_gp_l1_reg_loss: 87252.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91730.9453; val_chrom_access_recon_loss: 9561091.6667; val_global_loss: 23789172.6667; val_optim_loss: 23789172.6667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9770; val_auprc_score: 0.9698; val_best_acc_score: 0.9324; val_best_f1_score: 0.9338; train_kl_reg_loss: 78748.4773; train_edge_recon_loss: 2689846.9714; train_gene_expr_recon_loss: 11371705.6183; train_masked_gp_l1_reg_loss: 87092.5648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91527.4447; train_chrom_access_recon_loss: 9540404.3206; train_global_loss: 23859325.3893; train_optim_loss: 23859325.3893; val_kl_reg_loss: 79370.7812; val_edge_recon_loss: 2697670.8167; val_gene_expr_recon_loss: 11264090.6667; val_masked_gp_l1_reg_loss: 86888.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91889.9844; val_chrom_access_recon_loss: 9517692.6667; val_global_loss: 23737603.6000; val_optim_loss: 23737603.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9794; val_auprc_score: 0.9741; val_best_acc_score: 0.9386; val_best_f1_score: 0.9401; train_kl_reg_loss: 78243.1248; train_edge_recon_loss: 2684483.0191; train_gene_expr_recon_loss: 11360226.0458; train_masked_gp_l1_reg_loss: 86640.5011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91741.8668; train_chrom_access_recon_loss: 9516295.4809; train_global_loss: 23817630.1374; train_optim_loss: 23817630.1374; val_kl_reg_loss: 77726.5693; val_edge_recon_loss: 2698651.2833; val_gene_expr_recon_loss: 11224362.1333; val_masked_gp_l1_reg_loss: 86583.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92198.7891; val_chrom_access_recon_loss: 9516425.4667; val_global_loss: 23695948.1333; val_optim_loss: 23695948.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9769; val_auprc_score: 0.9713; val_best_acc_score: 0.9293; val_best_f1_score: 0.9318; train_kl_reg_loss: 78070.4183; train_edge_recon_loss: 2687875.6813; train_gene_expr_recon_loss: 11345412.8321; train_masked_gp_l1_reg_loss: 86157.1635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91968.6141; train_chrom_access_recon_loss: 9497593.7863; train_global_loss: 23787078.3053; train_optim_loss: 23787078.3053; val_kl_reg_loss: 78130.9672; val_edge_recon_loss: 2699685.9833; val_gene_expr_recon_loss: 11224114.2667; val_masked_gp_l1_reg_loss: 86056.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92406.7500; val_chrom_access_recon_loss: 9509542.0667; val_global_loss: 23689937.0667; val_optim_loss: 23689937.0667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9779; val_auprc_score: 0.9722; val_best_acc_score: 0.9363; val_best_f1_score: 0.9380; train_kl_reg_loss: 77326.2918; train_edge_recon_loss: 2685548.4294; train_gene_expr_recon_loss: 11330003.6031; train_masked_gp_l1_reg_loss: 85651.4474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92114.2199; train_chrom_access_recon_loss: 9469919.5267; train_global_loss: 23740563.3588; train_optim_loss: 23740563.3588; val_kl_reg_loss: 74939.1792; val_edge_recon_loss: 2687501.1167; val_gene_expr_recon_loss: 11192771.8000; val_masked_gp_l1_reg_loss: 85798.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93228.3438; val_chrom_access_recon_loss: 9442071.8000; val_global_loss: 23576309.8667; val_optim_loss: 23576309.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9768; val_auprc_score: 0.9683; val_best_acc_score: 0.9318; val_best_f1_score: 0.9341; train_kl_reg_loss: 77911.9971; train_edge_recon_loss: 2676213.3779; train_gene_expr_recon_loss: 11326579.1832; train_masked_gp_l1_reg_loss: 85403.0559; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92547.4244; train_chrom_access_recon_loss: 9451386.7748; train_global_loss: 23710041.9084; train_optim_loss: 23710041.9084; val_kl_reg_loss: 76106.4141; val_edge_recon_loss: 2706749.7000; val_gene_expr_recon_loss: 11149783.9333; val_masked_gp_l1_reg_loss: 85156.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93357.4922; val_chrom_access_recon_loss: 9430645.0000; val_global_loss: 23541799.0667; val_optim_loss: 23541799.0667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9785; val_auprc_score: 0.9734; val_best_acc_score: 0.9365; val_best_f1_score: 0.9385; train_kl_reg_loss: 77322.2752; train_edge_recon_loss: 2681641.4828; train_gene_expr_recon_loss: 11309727.6107; train_masked_gp_l1_reg_loss: 85012.6304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92940.4563; train_chrom_access_recon_loss: 9428877.9008; train_global_loss: 23675522.2901; train_optim_loss: 23675522.2901; val_kl_reg_loss: 76729.4729; val_edge_recon_loss: 2691751.5500; val_gene_expr_recon_loss: 11135457.8000; val_masked_gp_l1_reg_loss: 84740.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93463.2812; val_chrom_access_recon_loss: 9438577.3333; val_global_loss: 23520719.3333; val_optim_loss: 23520719.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9815; val_auprc_score: 0.9772; val_best_acc_score: 0.9411; val_best_f1_score: 0.9430; train_kl_reg_loss: 77722.7766; train_edge_recon_loss: 2679024.9313; train_gene_expr_recon_loss: 11301717.7176; train_masked_gp_l1_reg_loss: 84466.2094; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93297.3320; train_chrom_access_recon_loss: 9408928.9924; train_global_loss: 23645157.8473; train_optim_loss: 23645157.8473; val_kl_reg_loss: 77637.9906; val_edge_recon_loss: 2685838.2167; val_gene_expr_recon_loss: 11183594.0000; val_masked_gp_l1_reg_loss: 84237.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94401.3984; val_chrom_access_recon_loss: 9429333.2667; val_global_loss: 23555042.4000; val_optim_loss: 23555042.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9821; val_auprc_score: 0.9758; val_best_acc_score: 0.9409; val_best_f1_score: 0.9423; train_kl_reg_loss: 77791.5971; train_edge_recon_loss: 2671547.1355; train_gene_expr_recon_loss: 11278702.5573; train_masked_gp_l1_reg_loss: 83980.2736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94163.4165; train_chrom_access_recon_loss: 9383611.7099; train_global_loss: 23589796.7023; train_optim_loss: 23589796.7023; val_kl_reg_loss: 74977.6083; val_edge_recon_loss: 2688860.7833; val_gene_expr_recon_loss: 11114250.8000; val_masked_gp_l1_reg_loss: 83913.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94801.2812; val_chrom_access_recon_loss: 9421334.7333; val_global_loss: 23478137.8667; val_optim_loss: 23478137.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9808; val_auprc_score: 0.9761; val_best_acc_score: 0.9365; val_best_f1_score: 0.9381; train_kl_reg_loss: 77041.8287; train_edge_recon_loss: 2681939.9408; train_gene_expr_recon_loss: 11266596.3588; train_masked_gp_l1_reg_loss: 83580.9910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94651.7408; train_chrom_access_recon_loss: 9368638.4656; train_global_loss: 23572449.2824; train_optim_loss: 23572449.2824; val_kl_reg_loss: 76227.7219; val_edge_recon_loss: 2702937.4500; val_gene_expr_recon_loss: 11164053.0000; val_masked_gp_l1_reg_loss: 83370.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94932.8203; val_chrom_access_recon_loss: 9441132.8000; val_global_loss: 23562653.8667; val_optim_loss: 23562653.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9822; val_auprc_score: 0.9741; val_best_acc_score: 0.9452; val_best_f1_score: 0.9461; train_kl_reg_loss: 76430.3847; train_edge_recon_loss: 2681166.6469; train_gene_expr_recon_loss: 11265620.0916; train_masked_gp_l1_reg_loss: 83126.3922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95318.6221; train_chrom_access_recon_loss: 9359484.5954; train_global_loss: 23561146.7634; train_optim_loss: 23561146.7634; val_kl_reg_loss: 74667.8099; val_edge_recon_loss: 2691699.1167; val_gene_expr_recon_loss: 11179346.8667; val_masked_gp_l1_reg_loss: 82838.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96005.8125; val_chrom_access_recon_loss: 9451945.3333; val_global_loss: 23576503.3333; val_optim_loss: 23576503.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9814; val_auprc_score: 0.9758; val_best_acc_score: 0.9426; val_best_f1_score: 0.9443; train_kl_reg_loss: 75895.3283; train_edge_recon_loss: 2677596.7557; train_gene_expr_recon_loss: 11261718.2214; train_masked_gp_l1_reg_loss: 82650.1631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95983.8297; train_chrom_access_recon_loss: 9355133.4962; train_global_loss: 23548977.8015; train_optim_loss: 23548977.8015; val_kl_reg_loss: 75419.0682; val_edge_recon_loss: 2686544.5333; val_gene_expr_recon_loss: 11202194.2667; val_masked_gp_l1_reg_loss: 82488.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96836.3516; val_chrom_access_recon_loss: 9462982.3333; val_global_loss: 23606464.0000; val_optim_loss: 23606464.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9836; val_auprc_score: 0.9770; val_best_acc_score: 0.9453; val_best_f1_score: 0.9463; train_kl_reg_loss: 76560.9035; train_edge_recon_loss: 2675700.4504; train_gene_expr_recon_loss: 11250588.8702; train_masked_gp_l1_reg_loss: 82292.5217; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96588.9704; train_chrom_access_recon_loss: 9331995.8244; train_global_loss: 23513727.6794; train_optim_loss: 23513727.6794; val_kl_reg_loss: 78419.6703; val_edge_recon_loss: 2695951.0000; val_gene_expr_recon_loss: 11143460.1333; val_masked_gp_l1_reg_loss: 82021.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97542.8828; val_chrom_access_recon_loss: 9421063.7333; val_global_loss: 23518458.8000; val_optim_loss: 23518458.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9826; val_auprc_score: 0.9779; val_best_acc_score: 0.9423; val_best_f1_score: 0.9436; train_kl_reg_loss: 79570.4308; train_edge_recon_loss: 2664780.7672; train_gene_expr_recon_loss: 11240424.1221; train_masked_gp_l1_reg_loss: 80563.2102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72676.5185; train_chrom_access_recon_loss: 9311010.6489; train_global_loss: 23449025.6489; train_optim_loss: 23449025.6489; val_kl_reg_loss: 80366.8474; val_edge_recon_loss: 2694765.8833; val_gene_expr_recon_loss: 11104588.6667; val_masked_gp_l1_reg_loss: 80145.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69522.6719; val_chrom_access_recon_loss: 9361741.0000; val_global_loss: 23391130.6667; val_optim_loss: 23391130.6667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9836; val_auprc_score: 0.9806; val_best_acc_score: 0.9430; val_best_f1_score: 0.9442; train_kl_reg_loss: 80193.5349; train_edge_recon_loss: 2665561.9542; train_gene_expr_recon_loss: 11238141.7634; train_masked_gp_l1_reg_loss: 80047.5582; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68969.3411; train_chrom_access_recon_loss: 9306028.8473; train_global_loss: 23438943.0687; train_optim_loss: 23438943.0687; val_kl_reg_loss: 81237.1734; val_edge_recon_loss: 2671496.9167; val_gene_expr_recon_loss: 11145898.7333; val_masked_gp_l1_reg_loss: 79965.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68680.4531; val_chrom_access_recon_loss: 9422290.8667; val_global_loss: 23469568.6667; val_optim_loss: 23469568.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9838; val_auprc_score: 0.9780; val_best_acc_score: 0.9456; val_best_f1_score: 0.9467; train_kl_reg_loss: 80557.2929; train_edge_recon_loss: 2666928.3473; train_gene_expr_recon_loss: 11239133.6641; train_masked_gp_l1_reg_loss: 79923.8964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68295.6213; train_chrom_access_recon_loss: 9304522.8702; train_global_loss: 23439361.6183; train_optim_loss: 23439361.6183; val_kl_reg_loss: 79617.1781; val_edge_recon_loss: 2679123.5667; val_gene_expr_recon_loss: 11159399.7333; val_masked_gp_l1_reg_loss: 79866.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68011.3281; val_chrom_access_recon_loss: 9371346.2000; val_global_loss: 23437364.9333; val_optim_loss: 23437364.9333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9846; val_auprc_score: 0.9788; val_best_acc_score: 0.9481; val_best_f1_score: 0.9494; train_kl_reg_loss: 80005.2769; train_edge_recon_loss: 2668755.2882; train_gene_expr_recon_loss: 11231236.5420; train_masked_gp_l1_reg_loss: 79823.5995; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67836.5007; train_chrom_access_recon_loss: 9289164.2214; train_global_loss: 23416821.4351; train_optim_loss: 23416821.4351; val_kl_reg_loss: 80075.1323; val_edge_recon_loss: 2665957.8667; val_gene_expr_recon_loss: 11131286.3333; val_masked_gp_l1_reg_loss: 79778.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67614.1484; val_chrom_access_recon_loss: 9384646.7333; val_global_loss: 23409358.1333; val_optim_loss: 23409358.1333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9836; val_auprc_score: 0.9789; val_best_acc_score: 0.9446; val_best_f1_score: 0.9463; train_kl_reg_loss: 80250.2099; train_edge_recon_loss: 2663119.9981; train_gene_expr_recon_loss: 11222971.3588; train_masked_gp_l1_reg_loss: 79741.5649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67450.5315; train_chrom_access_recon_loss: 9285070.6260; train_global_loss: 23398604.3511; train_optim_loss: 23398604.3511; val_kl_reg_loss: 80592.3016; val_edge_recon_loss: 2688565.4833; val_gene_expr_recon_loss: 11180224.2000; val_masked_gp_l1_reg_loss: 79683.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67272.3828; val_chrom_access_recon_loss: 9422951.3333; val_global_loss: 23519289.6000; val_optim_loss: 23519289.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9830; val_auprc_score: 0.9773; val_best_acc_score: 0.9446; val_best_f1_score: 0.9459; train_kl_reg_loss: 80027.4082; train_edge_recon_loss: 2668895.0725; train_gene_expr_recon_loss: 11219874.4962; train_masked_gp_l1_reg_loss: 79534.7342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64824.5406; train_chrom_access_recon_loss: 9281786.9695; train_global_loss: 23394943.2519; train_optim_loss: 23394943.2519; val_kl_reg_loss: 80667.0891; val_edge_recon_loss: 2685690.4333; val_gene_expr_recon_loss: 11146536.7333; val_masked_gp_l1_reg_loss: 79483.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64520.1875; val_chrom_access_recon_loss: 9381438.6667; val_global_loss: 23438335.6000; val_optim_loss: 23438335.6000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9839; val_auprc_score: 0.9794; val_best_acc_score: 0.9448; val_best_f1_score: 0.9460; train_kl_reg_loss: 80087.6050; train_edge_recon_loss: 2666249.9370; train_gene_expr_recon_loss: 11223298.3359; train_masked_gp_l1_reg_loss: 79467.6088; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64454.2655; train_chrom_access_recon_loss: 9281919.8321; train_global_loss: 23395477.5267; train_optim_loss: 23395477.5267; val_kl_reg_loss: 80332.4604; val_edge_recon_loss: 2686259.9000; val_gene_expr_recon_loss: 11145322.2667; val_masked_gp_l1_reg_loss: 79457.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64411.4844; val_chrom_access_recon_loss: 9398885.6667; val_global_loss: 23454668.9333; val_optim_loss: 23454668.9333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9829; val_auprc_score: 0.9786; val_best_acc_score: 0.9453; val_best_f1_score: 0.9468; train_kl_reg_loss: 80146.1376; train_edge_recon_loss: 2663446.1355; train_gene_expr_recon_loss: 11220062.2214; train_masked_gp_l1_reg_loss: 79449.1899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64366.3963; train_chrom_access_recon_loss: 9280195.1603; train_global_loss: 23387665.1298; train_optim_loss: 23387665.1298; val_kl_reg_loss: 79877.0063; val_edge_recon_loss: 2682201.1167; val_gene_expr_recon_loss: 11145104.8667; val_masked_gp_l1_reg_loss: 79443.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64327.0859; val_chrom_access_recon_loss: 9367727.5333; val_global_loss: 23418680.6667; val_optim_loss: 23418680.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9816; val_auprc_score: 0.9749; val_best_acc_score: 0.9437; val_best_f1_score: 0.9456; train_kl_reg_loss: 80131.8379; train_edge_recon_loss: 2670217.4084; train_gene_expr_recon_loss: 11226850.4122; train_masked_gp_l1_reg_loss: 79439.4966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64290.1140; train_chrom_access_recon_loss: 9288534.6336; train_global_loss: 23409464.0153; train_optim_loss: 23409464.0153; val_kl_reg_loss: 79971.7552; val_edge_recon_loss: 2688613.2500; val_gene_expr_recon_loss: 11174697.2667; val_masked_gp_l1_reg_loss: 79433.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64258.8125; val_chrom_access_recon_loss: 9412420.2000; val_global_loss: 23499394.2667; val_optim_loss: 23499394.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 26 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9843
val AUPRC score: 0.9789
val best accuracy score: 0.9438
val best F1 score: 0.9449
val target rna MSE score: 1.1427
val source rna MSE score: 0.4488
val target atac MSE score: 0.3276
val source atac MSE score: 0.0942
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
