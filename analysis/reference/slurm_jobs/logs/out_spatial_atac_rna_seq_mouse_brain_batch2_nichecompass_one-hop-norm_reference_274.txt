[True]
Run timestamp: 10102023_130644_274.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_274']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8028; val_auprc_score: 0.8173; val_best_acc_score: 0.5271; val_best_f1_score: 0.6783; train_kl_reg_loss: 48204.6765; train_edge_recon_loss: 731985.7533; train_gene_expr_recon_loss: 22162158.0763; train_masked_gp_l1_reg_loss: 96428.8365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2424519.4437; train_chrom_access_recon_loss: 4790341.1527; train_global_loss: 30253638.0305; train_optim_loss: 30253638.0305; val_kl_reg_loss: 66148.8367; val_edge_recon_loss: 812705.5250; val_gene_expr_recon_loss: 21134917.2000; val_masked_gp_l1_reg_loss: 79889.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 932738.3750; val_chrom_access_recon_loss: 4648476.3333; val_global_loss: 27674875.6000; val_optim_loss: 27674875.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8542; val_auprc_score: 0.8594; val_best_acc_score: 0.6874; val_best_f1_score: 0.7490; train_kl_reg_loss: 64540.2395; train_edge_recon_loss: 728606.1966; train_gene_expr_recon_loss: 20884147.0992; train_masked_gp_l1_reg_loss: 77588.8726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 498337.1362; train_chrom_access_recon_loss: 4597123.9924; train_global_loss: 26850343.3893; train_optim_loss: 26850343.3893; val_kl_reg_loss: 62036.7695; val_edge_recon_loss: 808274.1792; val_gene_expr_recon_loss: 20787353.2000; val_masked_gp_l1_reg_loss: 77109.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 267503.7188; val_chrom_access_recon_loss: 4579299.9000; val_global_loss: 26581577.6000; val_optim_loss: 26581577.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8853; val_auprc_score: 0.8860; val_best_acc_score: 0.7944; val_best_f1_score: 0.7793; train_kl_reg_loss: 56892.2253; train_edge_recon_loss: 720652.2094; train_gene_expr_recon_loss: 20581333.3435; train_masked_gp_l1_reg_loss: 77990.9560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 199845.9336; train_chrom_access_recon_loss: 4546237.9542; train_global_loss: 26182952.7176; train_optim_loss: 26182952.7176; val_kl_reg_loss: 58208.4378; val_edge_recon_loss: 784989.1167; val_gene_expr_recon_loss: 20485199.8667; val_masked_gp_l1_reg_loss: 79554.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157140.1719; val_chrom_access_recon_loss: 4524588.9000; val_global_loss: 26089680.1333; val_optim_loss: 26089680.1333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9043; val_auprc_score: 0.8960; val_best_acc_score: 0.8224; val_best_f1_score: 0.8323; train_kl_reg_loss: 52284.7283; train_edge_recon_loss: 695887.8655; train_gene_expr_recon_loss: 20354669.8931; train_masked_gp_l1_reg_loss: 81165.6710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 137810.9244; train_chrom_access_recon_loss: 4501701.8378; train_global_loss: 25823520.8855; train_optim_loss: 25823520.8855; val_kl_reg_loss: 53938.6359; val_edge_recon_loss: 673273.0458; val_gene_expr_recon_loss: 20319724.6667; val_masked_gp_l1_reg_loss: 83020.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123060.2266; val_chrom_access_recon_loss: 4494508.7333; val_global_loss: 25747525.0667; val_optim_loss: 25747525.0667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9120; val_auprc_score: 0.9032; val_best_acc_score: 0.8269; val_best_f1_score: 0.8359; train_kl_reg_loss: 61252.5838; train_edge_recon_loss: 633884.6474; train_gene_expr_recon_loss: 20155813.2061; train_masked_gp_l1_reg_loss: 84185.8430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111743.5193; train_chrom_access_recon_loss: 4461029.0992; train_global_loss: 25507908.7939; train_optim_loss: 25507908.7939; val_kl_reg_loss: 63499.3698; val_edge_recon_loss: 625848.7417; val_gene_expr_recon_loss: 20138465.4667; val_masked_gp_l1_reg_loss: 85735.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101857.3594; val_chrom_access_recon_loss: 4466140.2000; val_global_loss: 25481548.0000; val_optim_loss: 25481548.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9220; val_auprc_score: 0.9138; val_best_acc_score: 0.8402; val_best_f1_score: 0.8484; train_kl_reg_loss: 62769.0359; train_edge_recon_loss: 618470.9680; train_gene_expr_recon_loss: 19989522.0305; train_masked_gp_l1_reg_loss: 87018.6546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95609.5863; train_chrom_access_recon_loss: 4430511.5706; train_global_loss: 25283901.8321; train_optim_loss: 25283901.8321; val_kl_reg_loss: 61383.2570; val_edge_recon_loss: 611249.2042; val_gene_expr_recon_loss: 19923841.6000; val_masked_gp_l1_reg_loss: 88247.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90662.9766; val_chrom_access_recon_loss: 4438939.3833; val_global_loss: 25214323.6000; val_optim_loss: 25214323.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9205; val_auprc_score: 0.9047; val_best_acc_score: 0.8453; val_best_f1_score: 0.8533; train_kl_reg_loss: 61814.6259; train_edge_recon_loss: 608995.2247; train_gene_expr_recon_loss: 19852973.0076; train_masked_gp_l1_reg_loss: 89183.3175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87564.6128; train_chrom_access_recon_loss: 4402079.7920; train_global_loss: 25102610.7481; train_optim_loss: 25102610.7481; val_kl_reg_loss: 61976.3898; val_edge_recon_loss: 610351.7292; val_gene_expr_recon_loss: 19839614.6667; val_masked_gp_l1_reg_loss: 89732.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85278.6250; val_chrom_access_recon_loss: 4395471.8333; val_global_loss: 25082424.6667; val_optim_loss: 25082424.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9339; val_auprc_score: 0.9225; val_best_acc_score: 0.8597; val_best_f1_score: 0.8654; train_kl_reg_loss: 61332.0795; train_edge_recon_loss: 601532.9308; train_gene_expr_recon_loss: 19723539.4962; train_masked_gp_l1_reg_loss: 90585.9036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83961.5722; train_chrom_access_recon_loss: 4372587.7786; train_global_loss: 24933539.8321; train_optim_loss: 24933539.8321; val_kl_reg_loss: 62700.9927; val_edge_recon_loss: 603040.9667; val_gene_expr_recon_loss: 19757426.2667; val_masked_gp_l1_reg_loss: 91351.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81787.7734; val_chrom_access_recon_loss: 4403861.4000; val_global_loss: 25000169.8667; val_optim_loss: 25000169.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9395; val_auprc_score: 0.9274; val_best_acc_score: 0.8692; val_best_f1_score: 0.8758; train_kl_reg_loss: 60679.3847; train_edge_recon_loss: 597300.1150; train_gene_expr_recon_loss: 19607069.1908; train_masked_gp_l1_reg_loss: 91980.8234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80248.4942; train_chrom_access_recon_loss: 4337172.5363; train_global_loss: 24774450.5649; train_optim_loss: 24774450.5649; val_kl_reg_loss: 60244.3328; val_edge_recon_loss: 597924.1917; val_gene_expr_recon_loss: 19629565.8667; val_masked_gp_l1_reg_loss: 92568.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79250.0234; val_chrom_access_recon_loss: 4360344.2833; val_global_loss: 24819896.8000; val_optim_loss: 24819896.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9482; val_auprc_score: 0.9385; val_best_acc_score: 0.8787; val_best_f1_score: 0.8826; train_kl_reg_loss: 59824.0661; train_edge_recon_loss: 594364.9227; train_gene_expr_recon_loss: 19510020.8702; train_masked_gp_l1_reg_loss: 93014.2298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77575.9410; train_chrom_access_recon_loss: 4319301.0458; train_global_loss: 24654101.1145; train_optim_loss: 24654101.1145; val_kl_reg_loss: 59641.5396; val_edge_recon_loss: 589798.8167; val_gene_expr_recon_loss: 19496912.4000; val_masked_gp_l1_reg_loss: 93988.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76667.5469; val_chrom_access_recon_loss: 4328205.0833; val_global_loss: 24645214.4000; val_optim_loss: 24645214.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9466; val_auprc_score: 0.9362; val_best_acc_score: 0.8787; val_best_f1_score: 0.8829; train_kl_reg_loss: 59320.5245; train_edge_recon_loss: 591030.1880; train_gene_expr_recon_loss: 19419437.6641; train_masked_gp_l1_reg_loss: 94209.4180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75317.7589; train_chrom_access_recon_loss: 4294777.0954; train_global_loss: 24534092.5954; train_optim_loss: 24534092.5954; val_kl_reg_loss: 58305.4307; val_edge_recon_loss: 594951.0250; val_gene_expr_recon_loss: 19444038.1333; val_masked_gp_l1_reg_loss: 94949.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74611.7031; val_chrom_access_recon_loss: 4301274.4833; val_global_loss: 24568131.4667; val_optim_loss: 24568131.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9502; val_auprc_score: 0.9408; val_best_acc_score: 0.8861; val_best_f1_score: 0.8910; train_kl_reg_loss: 58581.6954; train_edge_recon_loss: 588896.1555; train_gene_expr_recon_loss: 19331068.0153; train_masked_gp_l1_reg_loss: 95328.2177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73722.7027; train_chrom_access_recon_loss: 4269793.6927; train_global_loss: 24417390.6718; train_optim_loss: 24417390.6718; val_kl_reg_loss: 58217.9190; val_edge_recon_loss: 586960.5250; val_gene_expr_recon_loss: 19232854.9333; val_masked_gp_l1_reg_loss: 96078.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73834.5156; val_chrom_access_recon_loss: 4277974.9500; val_global_loss: 24325920.1333; val_optim_loss: 24325920.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9509; val_auprc_score: 0.9394; val_best_acc_score: 0.8863; val_best_f1_score: 0.8909; train_kl_reg_loss: 58112.9411; train_edge_recon_loss: 587055.4490; train_gene_expr_recon_loss: 19245008.6412; train_masked_gp_l1_reg_loss: 96391.8666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72499.8431; train_chrom_access_recon_loss: 4244895.5687; train_global_loss: 24303964.3359; train_optim_loss: 24303964.3359; val_kl_reg_loss: 58340.5164; val_edge_recon_loss: 590634.0542; val_gene_expr_recon_loss: 19249611.4667; val_masked_gp_l1_reg_loss: 97002.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72498.1406; val_chrom_access_recon_loss: 4230050.2333; val_global_loss: 24298136.2667; val_optim_loss: 24298136.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9530; val_auprc_score: 0.9401; val_best_acc_score: 0.8925; val_best_f1_score: 0.8971; train_kl_reg_loss: 57659.8334; train_edge_recon_loss: 583488.0553; train_gene_expr_recon_loss: 19168196.8397; train_masked_gp_l1_reg_loss: 97474.2236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71567.4545; train_chrom_access_recon_loss: 4220324.6603; train_global_loss: 24198711.1603; train_optim_loss: 24198711.1603; val_kl_reg_loss: 58655.5201; val_edge_recon_loss: 585440.1083; val_gene_expr_recon_loss: 19198462.6667; val_masked_gp_l1_reg_loss: 98089.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70447.7969; val_chrom_access_recon_loss: 4233880.8500; val_global_loss: 24244977.3333; val_optim_loss: 24244977.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9561; val_auprc_score: 0.9448; val_best_acc_score: 0.8954; val_best_f1_score: 0.9009; train_kl_reg_loss: 57213.7386; train_edge_recon_loss: 583923.7419; train_gene_expr_recon_loss: 19116468.9924; train_masked_gp_l1_reg_loss: 98715.1517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70494.6187; train_chrom_access_recon_loss: 4195541.4027; train_global_loss: 24122357.6183; train_optim_loss: 24122357.6183; val_kl_reg_loss: 58317.9141; val_edge_recon_loss: 583337.7750; val_gene_expr_recon_loss: 19148577.6000; val_masked_gp_l1_reg_loss: 99529.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70759.5391; val_chrom_access_recon_loss: 4224590.5333; val_global_loss: 24185113.7333; val_optim_loss: 24185113.7333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9557; val_auprc_score: 0.9445; val_best_acc_score: 0.8963; val_best_f1_score: 0.9004; train_kl_reg_loss: 55689.8126; train_edge_recon_loss: 585045.3411; train_gene_expr_recon_loss: 19065556.3511; train_masked_gp_l1_reg_loss: 100032.0397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70743.3372; train_chrom_access_recon_loss: 4188823.9485; train_global_loss: 24065890.7023; train_optim_loss: 24065890.7023; val_kl_reg_loss: 56796.9289; val_edge_recon_loss: 583589.1167; val_gene_expr_recon_loss: 19162085.6000; val_masked_gp_l1_reg_loss: 99723.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69992.5078; val_chrom_access_recon_loss: 4226636.0833; val_global_loss: 24198823.7333; val_optim_loss: 24198823.7333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9471; val_auprc_score: 0.9296; val_best_acc_score: 0.8857; val_best_f1_score: 0.8914; train_kl_reg_loss: 56817.0918; train_edge_recon_loss: 598224.8683; train_gene_expr_recon_loss: 19116774.6107; train_masked_gp_l1_reg_loss: 100244.2413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75102.1140; train_chrom_access_recon_loss: 4219411.1851; train_global_loss: 24166574.1527; train_optim_loss: 24166574.1527; val_kl_reg_loss: 64891.1031; val_edge_recon_loss: 597306.4792; val_gene_expr_recon_loss: 19154237.0667; val_masked_gp_l1_reg_loss: 100191.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73774.4453; val_chrom_access_recon_loss: 4258432.1333; val_global_loss: 24248832.8000; val_optim_loss: 24248832.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9552; val_auprc_score: 0.9435; val_best_acc_score: 0.8964; val_best_f1_score: 0.9003; train_kl_reg_loss: 64413.7886; train_edge_recon_loss: 588020.4924; train_gene_expr_recon_loss: 19018035.9389; train_masked_gp_l1_reg_loss: 99262.3458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69347.8526; train_chrom_access_recon_loss: 4188576.3263; train_global_loss: 24027656.5802; train_optim_loss: 24027656.5802; val_kl_reg_loss: 62949.2357; val_edge_recon_loss: 588371.5542; val_gene_expr_recon_loss: 19045312.1333; val_masked_gp_l1_reg_loss: 98741.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69067.3984; val_chrom_access_recon_loss: 4226677.4500; val_global_loss: 24091120.5333; val_optim_loss: 24091120.5333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9420; val_auprc_score: 0.9292; val_best_acc_score: 0.8756; val_best_f1_score: 0.8838; train_kl_reg_loss: 26663176.4832; train_edge_recon_loss: 621144.7219; train_gene_expr_recon_loss: 19082515.1450; train_masked_gp_l1_reg_loss: 100576.0966; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77751.5484; train_chrom_access_recon_loss: 4221781.5076; train_global_loss: 50766945.4198; train_optim_loss: 50766945.4198; val_kl_reg_loss: 64519.0372; val_edge_recon_loss: 608230.2833; val_gene_expr_recon_loss: 19062430.1333; val_masked_gp_l1_reg_loss: 96725.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76836.5000; val_chrom_access_recon_loss: 4220879.9000; val_global_loss: 24129621.6000; val_optim_loss: 24129621.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9446; val_auprc_score: 0.9313; val_best_acc_score: 0.8755; val_best_f1_score: 0.8834; train_kl_reg_loss: 64451.5180; train_edge_recon_loss: 596641.3302; train_gene_expr_recon_loss: 18962009.9847; train_masked_gp_l1_reg_loss: 95588.4388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72758.5872; train_chrom_access_recon_loss: 4181219.2576; train_global_loss: 23972669.0992; train_optim_loss: 23972669.0992; val_kl_reg_loss: 65859.3901; val_edge_recon_loss: 594443.4417; val_gene_expr_recon_loss: 18985116.8000; val_masked_gp_l1_reg_loss: 95002.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70295.3984; val_chrom_access_recon_loss: 4189287.7667; val_global_loss: 24000005.0667; val_optim_loss: 24000005.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9513; val_auprc_score: 0.9378; val_best_acc_score: 0.8898; val_best_f1_score: 0.8937; train_kl_reg_loss: 66411.3400; train_edge_recon_loss: 592601.3540; train_gene_expr_recon_loss: 18931711.0534; train_masked_gp_l1_reg_loss: 95500.1424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71386.7151; train_chrom_access_recon_loss: 4173941.7366; train_global_loss: 23931552.1985; train_optim_loss: 23931552.1985; val_kl_reg_loss: 67295.5609; val_edge_recon_loss: 590792.4250; val_gene_expr_recon_loss: 18896262.4000; val_masked_gp_l1_reg_loss: 97723.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70499.9375; val_chrom_access_recon_loss: 4189013.2500; val_global_loss: 23911588.0000; val_optim_loss: 23911588.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9513; val_auprc_score: 0.9423; val_best_acc_score: 0.8852; val_best_f1_score: 0.8900; train_kl_reg_loss: 89824.0742; train_edge_recon_loss: 591671.7891; train_gene_expr_recon_loss: 18952952.2137; train_masked_gp_l1_reg_loss: 95820.4374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72112.5692; train_chrom_access_recon_loss: 4171362.5897; train_global_loss: 23973743.7710; train_optim_loss: 23973743.7710; val_kl_reg_loss: 65558.2818; val_edge_recon_loss: 591825.9625; val_gene_expr_recon_loss: 18996382.4000; val_masked_gp_l1_reg_loss: 95113.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70309.3594; val_chrom_access_recon_loss: 4189166.3500; val_global_loss: 24008357.0667; val_optim_loss: 24008357.0667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9509; val_auprc_score: 0.9404; val_best_acc_score: 0.8883; val_best_f1_score: 0.8934; train_kl_reg_loss: 69189.1734; train_edge_recon_loss: 587026.9814; train_gene_expr_recon_loss: 18879027.4351; train_masked_gp_l1_reg_loss: 95389.1301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70022.3826; train_chrom_access_recon_loss: 4152086.7443; train_global_loss: 23852741.8779; train_optim_loss: 23852741.8779; val_kl_reg_loss: 66329.4068; val_edge_recon_loss: 590368.0083; val_gene_expr_recon_loss: 18863204.8000; val_masked_gp_l1_reg_loss: 95730.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70135.0156; val_chrom_access_recon_loss: 4165323.5333; val_global_loss: 23851091.6000; val_optim_loss: 23851091.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9504; val_auprc_score: 0.9374; val_best_acc_score: 0.8886; val_best_f1_score: 0.8930; train_kl_reg_loss: 67009.9131; train_edge_recon_loss: 585610.9952; train_gene_expr_recon_loss: 18820384.3969; train_masked_gp_l1_reg_loss: 95552.2060; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69209.9885; train_chrom_access_recon_loss: 4135333.1870; train_global_loss: 23773100.5802; train_optim_loss: 23773100.5802; val_kl_reg_loss: 64219.9089; val_edge_recon_loss: 588174.4333; val_gene_expr_recon_loss: 18835082.1333; val_masked_gp_l1_reg_loss: 95640.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68949.2031; val_chrom_access_recon_loss: 4147375.4167; val_global_loss: 23799442.0000; val_optim_loss: 23799442.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9488; val_auprc_score: 0.9353; val_best_acc_score: 0.8886; val_best_f1_score: 0.8928; train_kl_reg_loss: 309934.7720; train_edge_recon_loss: 585739.4885; train_gene_expr_recon_loss: 18916394.7786; train_masked_gp_l1_reg_loss: 95588.7047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68396.4014; train_chrom_access_recon_loss: 4133890.6851; train_global_loss: 24109944.5802; train_optim_loss: 24109944.5802; val_kl_reg_loss: 61645.3969; val_edge_recon_loss: 593375.6208; val_gene_expr_recon_loss: 18913373.6000; val_masked_gp_l1_reg_loss: 95699.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71506.3359; val_chrom_access_recon_loss: 4162283.7333; val_global_loss: 23897884.0000; val_optim_loss: 23897884.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9526; val_auprc_score: 0.9418; val_best_acc_score: 0.8926; val_best_f1_score: 0.8967; train_kl_reg_loss: 63044.9481; train_edge_recon_loss: 588592.4690; train_gene_expr_recon_loss: 18779996.2595; train_masked_gp_l1_reg_loss: 95566.7744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68952.0471; train_chrom_access_recon_loss: 4125640.0725; train_global_loss: 23721792.4122; train_optim_loss: 23721792.4122; val_kl_reg_loss: 63348.8500; val_edge_recon_loss: 588634.3208; val_gene_expr_recon_loss: 18789100.4000; val_masked_gp_l1_reg_loss: 94908.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68330.7031; val_chrom_access_recon_loss: 4136857.2667; val_global_loss: 23741178.6667; val_optim_loss: 23741178.6667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9547; val_auprc_score: 0.9439; val_best_acc_score: 0.8921; val_best_f1_score: 0.8959; train_kl_reg_loss: 64893.4238; train_edge_recon_loss: 585705.2257; train_gene_expr_recon_loss: 18760226.2748; train_masked_gp_l1_reg_loss: 95172.5772; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68129.0944; train_chrom_access_recon_loss: 4115016.0420; train_global_loss: 23689142.6718; train_optim_loss: 23689142.6718; val_kl_reg_loss: 65448.8461; val_edge_recon_loss: 587779.2917; val_gene_expr_recon_loss: 18819496.4000; val_masked_gp_l1_reg_loss: 95295.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67607.3281; val_chrom_access_recon_loss: 4151064.8500; val_global_loss: 23786693.4667; val_optim_loss: 23786693.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9570; val_auprc_score: 0.9501; val_best_acc_score: 0.8936; val_best_f1_score: 0.8986; train_kl_reg_loss: 1433921.9778; train_edge_recon_loss: 586765.4198; train_gene_expr_recon_loss: 18737376.0763; train_masked_gp_l1_reg_loss: 94918.6871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75825.9938; train_chrom_access_recon_loss: 4124057.9599; train_global_loss: 25052866.0305; train_optim_loss: 25052866.0305; val_kl_reg_loss: 66835.6682; val_edge_recon_loss: 589858.2208; val_gene_expr_recon_loss: 18828912.8000; val_masked_gp_l1_reg_loss: 94100.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73974.9219; val_chrom_access_recon_loss: 4141414.0667; val_global_loss: 23795094.1333; val_optim_loss: 23795094.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9390; val_auprc_score: 0.9268; val_best_acc_score: 0.8707; val_best_f1_score: 0.8788; train_kl_reg_loss: 672726573672.0189; train_edge_recon_loss: 606030.6384; train_gene_expr_recon_loss: 19190035.6489; train_masked_gp_l1_reg_loss: 95843.7038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99174.6242; train_chrom_access_recon_loss: 4205414.7481; train_global_loss: 672750799813.6947; train_optim_loss: 672750799813.6947; val_kl_reg_loss: 21831324.8729; val_edge_recon_loss: 626070.3417; val_gene_expr_recon_loss: 18934005.2000; val_masked_gp_l1_reg_loss: 96720.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102293.4297; val_chrom_access_recon_loss: 4240228.0833; val_global_loss: 45830644.5333; val_optim_loss: 45830644.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8840; val_auprc_score: 0.8834; val_best_acc_score: 0.8033; val_best_f1_score: 0.8052; train_kl_reg_loss: 769138415143712980992.0000; train_edge_recon_loss: 679981.0324; train_gene_expr_recon_loss: 28096629.5496; train_masked_gp_l1_reg_loss: 173131.4764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 241280.3086; train_chrom_access_recon_loss: 5218639.0420; train_global_loss: 769138415143745486848.0000; train_optim_loss: 769138415143745486848.0000; val_kl_reg_loss: 7626963663022206222336.0000; val_edge_recon_loss: 808093.1208; val_gene_expr_recon_loss: 46954398.4000; val_masked_gp_l1_reg_loss: 451607.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 535327.2500; val_chrom_access_recon_loss: 6508255.0333; val_global_loss: 7626963663022257602560.0000; val_optim_loss: 7626963663022257602560.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8838; val_auprc_score: 0.8831; val_best_acc_score: 0.8032; val_best_f1_score: 0.8023; train_kl_reg_loss: 3013695942539515.5000; train_edge_recon_loss: 807385.9351; train_gene_expr_recon_loss: 28033411.1908; train_masked_gp_l1_reg_loss: 451881.7106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 448800.9542; train_chrom_access_recon_loss: 5209503.7557; train_global_loss: 3013695977122041.5000; train_optim_loss: 3013695977122041.5000; val_kl_reg_loss: 2148598.1500; val_edge_recon_loss: 807823.0667; val_gene_expr_recon_loss: 25116649.3333; val_masked_gp_l1_reg_loss: 444664.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 381031.5938; val_chrom_access_recon_loss: 4987179.2000; val_global_loss: 33885945.3333; val_optim_loss: 33885945.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8797; val_auprc_score: 0.8791; val_best_acc_score: 0.7863; val_best_f1_score: 0.7794; train_kl_reg_loss: 1986595.3540; train_edge_recon_loss: 807249.8373; train_gene_expr_recon_loss: 24621527.5573; train_masked_gp_l1_reg_loss: 438065.3311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 348721.6338; train_chrom_access_recon_loss: 4908309.0153; train_global_loss: 33110468.6718; train_optim_loss: 33110468.6718; val_kl_reg_loss: 1863513.0583; val_edge_recon_loss: 807055.5125; val_gene_expr_recon_loss: 23900115.2000; val_masked_gp_l1_reg_loss: 431439.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 321664.1562; val_chrom_access_recon_loss: 4885025.6000; val_global_loss: 32208813.2000; val_optim_loss: 32208813.2000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8818; val_auprc_score: 0.8819; val_best_acc_score: 0.7567; val_best_f1_score: 0.7352; train_kl_reg_loss: 33601537.4790; train_edge_recon_loss: 805663.8817; train_gene_expr_recon_loss: 23602975.2672; train_masked_gp_l1_reg_loss: 425653.1493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 302794.9139; train_chrom_access_recon_loss: 4827716.4924; train_global_loss: 63566341.5725; train_optim_loss: 63566341.5725; val_kl_reg_loss: 1325261.2500; val_edge_recon_loss: 804582.3250; val_gene_expr_recon_loss: 23138993.4667; val_masked_gp_l1_reg_loss: 420072.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 284936.5000; val_chrom_access_recon_loss: 4790931.4000; val_global_loss: 30764776.5333; val_optim_loss: 30764776.5333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8805; val_auprc_score: 0.8784; val_best_acc_score: 0.7351; val_best_f1_score: 0.7588; train_kl_reg_loss: 1173395.6508; train_edge_recon_loss: 803103.8101; train_gene_expr_recon_loss: 23018529.6336; train_masked_gp_l1_reg_loss: 414893.8764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 269874.1091; train_chrom_access_recon_loss: 4763989.0115; train_global_loss: 30443786.0153; train_optim_loss: 30443786.0153; val_kl_reg_loss: 1068631.0292; val_edge_recon_loss: 802677.8083; val_gene_expr_recon_loss: 22869309.6000; val_masked_gp_l1_reg_loss: 410270.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 256042.1406; val_chrom_access_recon_loss: 4769469.0667; val_global_loss: 30176399.0667; val_optim_loss: 30176399.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 16 sec.
Using best model state, which was in epoch 26.

--- MODEL EVALUATION ---
val AUROC score: 0.9567
val AUPRC score: 0.9496
val best accuracy score: 0.8929
val best F1 score: 0.8957
val target rna MSE score: 1.3268
val source rna MSE score: 0.5590
val target atac MSE score: 0.4928
val source atac MSE score: 0.1482
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
