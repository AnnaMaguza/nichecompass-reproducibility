[True, True]
Run timestamp: 19022024_170806_46.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'merfish_mouse_brain', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', 'batch21', 'batch22', 'batch23', 'batch24', 'batch25', 'batch26', 'batch27', 'batch28', 'batch29', 'batch30', 'batch31', 'batch32', 'batch33', 'batch34', 'batch35', 'batch36', 'batch37', 'batch38', 'batch39', 'batch40', 'batch41', 'batch42', 'batch43', 'batch44', 'batch45', 'batch46', 'batch47', 'batch48', 'batch49', 'batch50', 'batch51', 'batch52', 'batch53', 'batch54', 'batch55', 'batch56', 'batch57', 'batch58', 'batch59', 'batch60', 'batch61', 'batch62', 'batch63', 'batch64', 'batch65', 'batch66', 'batch67', 'batch68', 'batch69', 'batch70', 'batch71', 'batch72', 'batch73', 'batch74', 'batch75', 'batch76', 'batch77', 'batch78', 'batch79', 'batch80', 'batch81', 'batch82', 'batch83', 'batch84', 'batch85', 'batch86', 'batch87', 'batch88', 'batch89', 'batch90', 'batch91', 'batch92', 'batch93', 'batch94', 'batch95', 'batch96', 'batch97', 'batch98', 'batch99', 'batch100', 'batch101', 'batch102', 'batch103', 'batch104', 'batch105', 'batch106', 'batch107', 'batch108', 'batch109', 'batch110', 'batch111', 'batch112', 'batch113', 'batch114', 'batch115', 'batch116', 'batch117', 'batch118', 'batch119', 'batch120', 'batch121', 'batch122', 'batch123', 'batch124', 'batch125', 'batch126', 'batch127', 'batch128', 'batch129', 'batch130', 'batch131', 'batch132', 'batch133', 'batch134', 'batch135', 'batch136', 'batch137', 'batch138', 'batch139', 'batch140', 'batch141', 'batch142', 'batch143', 'batch144', 'batch145', 'batch146', 'batch147', 'batch148', 'batch149', 'batch150', 'batch151', 'batch152', 'batch153', 'batch154', 'batch155', 'batch156', 'batch157', 'batch158', 'batch159', 'batch160', 'batch161', 'batch162', 'batch163', 'batch164', 'batch165', 'batch166', 'batch167', 'batch168', 'batch169', 'batch170', 'batch171', 'batch172', 'batch173', 'batch174', 'batch175', 'batch176', 'batch177', 'batch178', 'batch179', 'batch180', 'batch181', 'batch182', 'batch183', 'batch184', 'batch185', 'batch186', 'batch187', 'batch188', 'batch189', 'batch190', 'batch191', 'batch192', 'batch193', 'batch194', 'batch195', 'batch196', 'batch197', 'batch198', 'batch199', 'batch200', 'batch201', 'batch202', 'batch203', 'batch204', 'batch205', 'batch206', 'batch207', 'batch208', 'batch209', 'batch210', 'batch211', 'batch212', 'batch213', 'batch214', 'batch215', 'batch216', 'batch217', 'batch218', 'batch219', 'batch220', 'batch221', 'batch222', 'batch223', 'batch224', 'batch225', 'batch226', 'batch227', 'batch228', 'batch229', 'batch230', 'batch231', 'batch232', 'batch233', 'batch234', 'batch235', 'batch236', 'batch237', 'batch238', 'batch239', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'donor_id', 'batch', '--cat_covariates_no_edges', 'True', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '4', '24', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '8', '--n_epochs_all_gps', '2', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000000.', '--lambda_gene_expr_recon', '30000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--edge_val_ratio', '0.01', '--node_val_ratio', '0.01', '--n_sampled_neighbors', '4', '--no-mlflow_tracking', '--no-compute_knn_graph', '--timestamp_suffix', '_46']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch21...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch22...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch23...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch24...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch25...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch26...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch27...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch28...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch29...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch30...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch31...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch32...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch33...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch34...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch35...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch36...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch37...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch38...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch39...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch40...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch41...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch42...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch43...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch44...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch45...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch46...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch47...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch48...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch49...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch50...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch51...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch52...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch53...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch54...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch55...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch56...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch57...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch58...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch59...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch60...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch61...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch62...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch63...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch64...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch65...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch66...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch67...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch68...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch69...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch70...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch71...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch72...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch73...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch74...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch75...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch76...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch77...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch78...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch79...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch80...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch81...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch82...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch83...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch84...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch85...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch86...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch87...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch88...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch89...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch90...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch91...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch92...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch93...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch94...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch95...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch96...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch97...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch98...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch99...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch100...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch101...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch102...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch103...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch104...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch105...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch106...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch107...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch108...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch109...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch110...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch111...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch112...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch113...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch114...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch115...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch116...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch117...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch118...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch119...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch120...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch121...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch122...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch123...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch124...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch125...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch126...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch127...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch128...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch129...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch130...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch131...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch132...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch133...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch134...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch135...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch136...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch137...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch138...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch139...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch140...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch141...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch142...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch143...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch144...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch145...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch146...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch147...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch148...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch149...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch150...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch151...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch152...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch153...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch154...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch155...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch156...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch157...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch158...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch159...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch160...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch161...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch162...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch163...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch164...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch165...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch166...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch167...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch168...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch169...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch170...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch171...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch172...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch173...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch174...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch175...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch176...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch177...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch178...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch179...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch180...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch181...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch182...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch183...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch184...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch185...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch186...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch187...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch188...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch189...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch190...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch191...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch192...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch193...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch194...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch195...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch196...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch197...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch198...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch199...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch200...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch201...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch202...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch203...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch204...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch205...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch206...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch207...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch208...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch209...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch210...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch211...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch212...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch213...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch214...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch215...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch216...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch217...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch218...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch219...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch220...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch221...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch222...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch223...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch224...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch225...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch226...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch227...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch228...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch229...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch230...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch231...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch232...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch233...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch234...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch235...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch236...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch237...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch238...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch239...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1122, n_cat_covariates_embed_input: 0, n_hidden: 1122, n_latent: 1431, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1431, n_addon_gp_input: 100, n_cat_covariates_embed_input: 28, n_output: 1122
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1431, n_addon_gp_input: 100, n_cat_covariates_embed_input: 28, n_output: 1122

--- INITIALIZING TRAINER ---
Number of training nodes: 8296485
Number of validation nodes: 83803
Number of training edges: 20055315
Number of validation edges: 202578
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/8 |██------------------| 12.5% val_auroc_score: 0.9065; val_auprc_score: 0.9991; val_best_acc_score: 0.9949; val_best_f1_score: 0.9974; train_kl_reg_loss: 31654.7305; train_edge_recon_loss: 378059.9453; train_gene_expr_recon_loss: 17498803.8970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17908518.5726; train_optim_loss: 17908518.5726; val_kl_reg_loss: 35108.8626; val_edge_recon_loss: 376009.5508; val_gene_expr_recon_loss: 16172007.9899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 16583126.4040; val_optim_loss: 16583126.4040
Epoch 2/8 |█████---------------| 25.0% val_auroc_score: 0.9284; val_auprc_score: 0.9993; val_best_acc_score: 0.9951; val_best_f1_score: 0.9975; train_kl_reg_loss: 70114.2230; train_edge_recon_loss: 379791.2778; train_gene_expr_recon_loss: 16623511.4681; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17073416.9699; train_optim_loss: 17073416.9699; val_kl_reg_loss: 49781.6930; val_edge_recon_loss: 379990.8488; val_gene_expr_recon_loss: 15954724.9192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 16384497.4141; val_optim_loss: 16384497.4141
Epoch 3/8 |███████-------------| 37.5% val_auroc_score: 0.8644; val_auprc_score: 0.9987; val_best_acc_score: 0.9938; val_best_f1_score: 0.9969; train_kl_reg_loss: 81312.1670; train_edge_recon_loss: 415144.1693; train_gene_expr_recon_loss: 17234991.6194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 17731447.9579; train_optim_loss: 17731447.9579; val_kl_reg_loss: 58132.9090; val_edge_recon_loss: 408706.4235; val_gene_expr_recon_loss: 16503439.2323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 16970278.5909; val_optim_loss: 16970278.5909
Epoch 4/8 |██████████----------| 50.0% val_auroc_score: 0.8862; val_auprc_score: 0.9990; val_best_acc_score: 0.9942; val_best_f1_score: 0.9971; train_kl_reg_loss: 525377885.3461; train_edge_recon_loss: 422754.9234; train_gene_expr_recon_loss: 17784220.4631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 543584851.9656; train_optim_loss: 543584851.9656; val_kl_reg_loss: 91674.6340; val_edge_recon_loss: 390281.3990; val_gene_expr_recon_loss: 15935834.5657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 16417790.6111; val_optim_loss: 16417790.6111
Epoch 5/8 |████████████--------| 62.5% val_auroc_score: 0.8972; val_auprc_score: 0.9991; val_best_acc_score: 0.9944; val_best_f1_score: 0.9972; train_kl_reg_loss: 10736420476.2939; train_edge_recon_loss: 413446.5822; train_gene_expr_recon_loss: 17715344.0914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10754549280.4587; train_optim_loss: 10754549280.4587; val_kl_reg_loss: 131943.5071; val_edge_recon_loss: 400290.1678; val_gene_expr_recon_loss: 16090273.1869; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 16622506.8485; val_optim_loss: 16622506.8485
Epoch 6/8 |███████████████-----| 75.0% val_auroc_score: 0.8163; val_auprc_score: 0.9985; val_best_acc_score: 0.9941; val_best_f1_score: 0.9970; train_kl_reg_loss: 4922130077549401735168.0000; train_edge_recon_loss: 434631.7401; train_gene_expr_recon_loss: 19780453.4676; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4922130077549422706688.0000; train_optim_loss: 4922130077549422706688.0000; val_kl_reg_loss: 736667.5972; val_edge_recon_loss: 463889.1742; val_gene_expr_recon_loss: 24045565.6364; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 25246122.3636; val_optim_loss: 25246122.3636
Epoch 7/8 |█████████████████---| 87.5% val_auroc_score: 0.8693; val_auprc_score: 0.9988; val_best_acc_score: 0.9936; val_best_f1_score: 0.9968; train_kl_reg_loss: 93738172262510864.0000; train_edge_recon_loss: 432416.1177; train_gene_expr_recon_loss: 19207603.4395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 93738172282147712.0000; train_optim_loss: 93738172282147712.0000; val_kl_reg_loss: 831651.4925; val_edge_recon_loss: 414122.4661; val_gene_expr_recon_loss: 16798184.3131; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18043958.2374; val_optim_loss: 18043958.2374
Epoch 8/8 |████████████████████| 100.0% val_auroc_score: 0.8799; val_auprc_score: 0.9990; val_best_acc_score: 0.9942; val_best_f1_score: 0.9971; train_kl_reg_loss: 4361435638704227851236802560.0000; train_edge_recon_loss: 423431.3281; train_gene_expr_recon_loss: 18543114.2519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4361435638704227851236802560.0000; train_optim_loss: 4361435638704227851236802560.0000; val_kl_reg_loss: 190705.4256; val_edge_recon_loss: 387004.7171; val_gene_expr_recon_loss: 15896987.8081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 16474697.9495; val_optim_loss: 16474697.9495


Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Model training finished after 1423 min 29 sec.
Using best model state, which was in epoch 2.

--- MODEL EVALUATION ---
val AUROC score: 0.9275
val AUPRC score: 0.9993
val best accuracy score: 0.9950
val best F1 score: 0.9975
val target rna MSE score: 0.2375
val source rna MSE score: 0.2366
Val cat covariate0 mean sim diff: -0.0006
Val cat covariate1 mean sim diff: -0.0042

Finished model training...

Saving model...
