[True]
Run timestamp: 10102023_010435_95.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_95']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6583; val_auprc_score: 0.6396; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 46488.5703; train_edge_recon_loss: 3510771.2879; train_gene_expr_recon_loss: 14376199.0909; train_masked_gp_l1_reg_loss: 47432.1757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5658283.9129; train_chrom_access_recon_loss: 6982962.0000; train_global_loss: 30622136.9394; train_optim_loss: 30622136.9394; val_kl_reg_loss: 77499.6191; val_edge_recon_loss: 4065741.7188; val_gene_expr_recon_loss: 13097190.6250; val_masked_gp_l1_reg_loss: 56855.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2741152.7500; val_chrom_access_recon_loss: 6681755.5625; val_global_loss: 26720195.7500; val_optim_loss: 26720195.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6740; val_auprc_score: 0.6508; val_best_acc_score: 0.6048; val_best_f1_score: 0.6926; train_kl_reg_loss: 83211.0865; train_edge_recon_loss: 3522037.3068; train_gene_expr_recon_loss: 13061681.5758; train_masked_gp_l1_reg_loss: 59765.8193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1335465.0578; train_chrom_access_recon_loss: 6634679.8333; train_global_loss: 24696841.0303; train_optim_loss: 24696841.0303; val_kl_reg_loss: 92559.5098; val_edge_recon_loss: 4057693.1250; val_gene_expr_recon_loss: 12731749.5000; val_masked_gp_l1_reg_loss: 60748.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 577650.0625; val_chrom_access_recon_loss: 6486185.8125; val_global_loss: 24006585.5000; val_optim_loss: 24006585.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7136; val_auprc_score: 0.6931; val_best_acc_score: 0.6325; val_best_f1_score: 0.7058; train_kl_reg_loss: 85004.4401; train_edge_recon_loss: 3510289.7311; train_gene_expr_recon_loss: 12778060.0606; train_masked_gp_l1_reg_loss: 61479.1912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 388793.2325; train_chrom_access_recon_loss: 6572264.2424; train_global_loss: 23395891.0909; train_optim_loss: 23395891.0909; val_kl_reg_loss: 81901.9727; val_edge_recon_loss: 4056101.9688; val_gene_expr_recon_loss: 12538697.0000; val_masked_gp_l1_reg_loss: 62435.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 268470.4688; val_chrom_access_recon_loss: 6440674.8125; val_global_loss: 23448281.7500; val_optim_loss: 23448281.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7466; val_auprc_score: 0.7243; val_best_acc_score: 0.6693; val_best_f1_score: 0.7113; train_kl_reg_loss: 77646.9852; train_edge_recon_loss: 3504369.6023; train_gene_expr_recon_loss: 12654515.9394; train_masked_gp_l1_reg_loss: 63425.6001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 215825.3258; train_chrom_access_recon_loss: 6525774.0758; train_global_loss: 23041557.6061; train_optim_loss: 23041557.6061; val_kl_reg_loss: 75764.5400; val_edge_recon_loss: 4021596.4062; val_gene_expr_recon_loss: 12329171.3750; val_masked_gp_l1_reg_loss: 64320.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175593.5938; val_chrom_access_recon_loss: 6358793.3125; val_global_loss: 23025240.0000; val_optim_loss: 23025240.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8407; val_auprc_score: 0.8082; val_best_acc_score: 0.7644; val_best_f1_score: 0.7911; train_kl_reg_loss: 64816.2628; train_edge_recon_loss: 3429749.3144; train_gene_expr_recon_loss: 12583150.0000; train_masked_gp_l1_reg_loss: 65619.2601; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153633.9600; train_chrom_access_recon_loss: 6486832.1364; train_global_loss: 22783800.9091; train_optim_loss: 22783800.9091; val_kl_reg_loss: 60176.5537; val_edge_recon_loss: 3250569.8750; val_gene_expr_recon_loss: 12536841.5000; val_masked_gp_l1_reg_loss: 68239.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137776.7344; val_chrom_access_recon_loss: 6461878.4375; val_global_loss: 22515483.5000; val_optim_loss: 22515483.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8731; val_auprc_score: 0.8391; val_best_acc_score: 0.7963; val_best_f1_score: 0.8157; train_kl_reg_loss: 94363.9980; train_edge_recon_loss: 2988256.7197; train_gene_expr_recon_loss: 12509443.3333; train_masked_gp_l1_reg_loss: 72174.7320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126684.3778; train_chrom_access_recon_loss: 6450286.6667; train_global_loss: 22241209.9394; train_optim_loss: 22241209.9394; val_kl_reg_loss: 95572.3750; val_edge_recon_loss: 2919338.2500; val_gene_expr_recon_loss: 12335606.2500; val_masked_gp_l1_reg_loss: 74843.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118048.6250; val_chrom_access_recon_loss: 6361839.6875; val_global_loss: 21905248.5000; val_optim_loss: 21905248.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8710; val_auprc_score: 0.8340; val_best_acc_score: 0.7972; val_best_f1_score: 0.8214; train_kl_reg_loss: 99558.7912; train_edge_recon_loss: 2897216.1212; train_gene_expr_recon_loss: 12444067.3333; train_masked_gp_l1_reg_loss: 76128.0188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113665.2222; train_chrom_access_recon_loss: 6419812.3485; train_global_loss: 22050447.7879; train_optim_loss: 22050447.7879; val_kl_reg_loss: 102453.3760; val_edge_recon_loss: 2934264.4688; val_gene_expr_recon_loss: 12301722.8750; val_masked_gp_l1_reg_loss: 77356.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110486.7422; val_chrom_access_recon_loss: 6315474.7500; val_global_loss: 21841758.0000; val_optim_loss: 21841758.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8884; val_auprc_score: 0.8506; val_best_acc_score: 0.8238; val_best_f1_score: 0.8398; train_kl_reg_loss: 100762.3477; train_edge_recon_loss: 2855360.5455; train_gene_expr_recon_loss: 12369648.0909; train_masked_gp_l1_reg_loss: 78413.7795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108559.1346; train_chrom_access_recon_loss: 6384197.5152; train_global_loss: 21896941.3030; train_optim_loss: 21896941.3030; val_kl_reg_loss: 99564.5566; val_edge_recon_loss: 2878417.0625; val_gene_expr_recon_loss: 12284138.0000; val_masked_gp_l1_reg_loss: 79488.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106905.0625; val_chrom_access_recon_loss: 6297873.5625; val_global_loss: 21746386.2500; val_optim_loss: 21746386.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8872; val_auprc_score: 0.8572; val_best_acc_score: 0.8181; val_best_f1_score: 0.8350; train_kl_reg_loss: 103802.5453; train_edge_recon_loss: 2834625.2500; train_gene_expr_recon_loss: 12313180.0909; train_masked_gp_l1_reg_loss: 80163.0962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105127.5535; train_chrom_access_recon_loss: 6359391.4924; train_global_loss: 21796290.0909; train_optim_loss: 21796290.0909; val_kl_reg_loss: 102081.6631; val_edge_recon_loss: 2877943.9688; val_gene_expr_recon_loss: 12111437.5000; val_masked_gp_l1_reg_loss: 80975.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103681.8047; val_chrom_access_recon_loss: 6255602.6250; val_global_loss: 21531723.5000; val_optim_loss: 21531723.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8964; val_auprc_score: 0.8597; val_best_acc_score: 0.8299; val_best_f1_score: 0.8443; train_kl_reg_loss: 99788.6839; train_edge_recon_loss: 2820253.4659; train_gene_expr_recon_loss: 12266360.6515; train_masked_gp_l1_reg_loss: 81624.5832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102570.3772; train_chrom_access_recon_loss: 6337390.9394; train_global_loss: 21707988.7273; train_optim_loss: 21707988.7273; val_kl_reg_loss: 99382.9863; val_edge_recon_loss: 2841299.4062; val_gene_expr_recon_loss: 12080895.0000; val_masked_gp_l1_reg_loss: 82341.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101722.4297; val_chrom_access_recon_loss: 6272316.4375; val_global_loss: 21477958.2500; val_optim_loss: 21477958.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9006; val_auprc_score: 0.8736; val_best_acc_score: 0.8345; val_best_f1_score: 0.8482; train_kl_reg_loss: 97919.1018; train_edge_recon_loss: 2816889.8939; train_gene_expr_recon_loss: 12204307.5303; train_masked_gp_l1_reg_loss: 82876.9007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101474.5111; train_chrom_access_recon_loss: 6311901.8561; train_global_loss: 21615369.7273; train_optim_loss: 21615369.7273; val_kl_reg_loss: 96034.7920; val_edge_recon_loss: 2854650.3438; val_gene_expr_recon_loss: 12081885.2500; val_masked_gp_l1_reg_loss: 83654.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101488.9062; val_chrom_access_recon_loss: 6247744.1875; val_global_loss: 21465458.5000; val_optim_loss: 21465458.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9096; val_auprc_score: 0.8748; val_best_acc_score: 0.8495; val_best_f1_score: 0.8627; train_kl_reg_loss: 95583.4856; train_edge_recon_loss: 2811578.7159; train_gene_expr_recon_loss: 12159938.0758; train_masked_gp_l1_reg_loss: 84317.8671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101752.0530; train_chrom_access_recon_loss: 6295266.0455; train_global_loss: 21548436.2424; train_optim_loss: 21548436.2424; val_kl_reg_loss: 94197.6084; val_edge_recon_loss: 2804346.2188; val_gene_expr_recon_loss: 11965760.0000; val_masked_gp_l1_reg_loss: 84838.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101797.1953; val_chrom_access_recon_loss: 6150988.1250; val_global_loss: 21201927.2500; val_optim_loss: 21201927.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9067; val_auprc_score: 0.8777; val_best_acc_score: 0.8444; val_best_f1_score: 0.8567; train_kl_reg_loss: 94474.7573; train_edge_recon_loss: 2799470.2689; train_gene_expr_recon_loss: 12115935.2273; train_masked_gp_l1_reg_loss: 85448.1594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102340.5507; train_chrom_access_recon_loss: 6276196.9242; train_global_loss: 21473865.8788; train_optim_loss: 21473865.8788; val_kl_reg_loss: 92369.2197; val_edge_recon_loss: 2822453.1875; val_gene_expr_recon_loss: 12097431.6250; val_masked_gp_l1_reg_loss: 85881.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101622.6094; val_chrom_access_recon_loss: 6240815.6875; val_global_loss: 21440573.5000; val_optim_loss: 21440573.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9101; val_auprc_score: 0.8815; val_best_acc_score: 0.8471; val_best_f1_score: 0.8586; train_kl_reg_loss: 93629.1325; train_edge_recon_loss: 2796509.4659; train_gene_expr_recon_loss: 12079823.4545; train_masked_gp_l1_reg_loss: 86461.9016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101297.6695; train_chrom_access_recon_loss: 6257873.1212; train_global_loss: 21415594.8788; train_optim_loss: 21415594.8788; val_kl_reg_loss: 92478.8779; val_edge_recon_loss: 2841082.5625; val_gene_expr_recon_loss: 12000834.8750; val_masked_gp_l1_reg_loss: 86943.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100961.3359; val_chrom_access_recon_loss: 6168924.1250; val_global_loss: 21291224.0000; val_optim_loss: 21291224.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9167; val_auprc_score: 0.8872; val_best_acc_score: 0.8541; val_best_f1_score: 0.8639; train_kl_reg_loss: 93068.3235; train_edge_recon_loss: 2791383.8864; train_gene_expr_recon_loss: 12042116.1970; train_masked_gp_l1_reg_loss: 87252.6011; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99769.1700; train_chrom_access_recon_loss: 6239692.4394; train_global_loss: 21353282.6667; train_optim_loss: 21353282.6667; val_kl_reg_loss: 95077.7949; val_edge_recon_loss: 2806742.2500; val_gene_expr_recon_loss: 11916661.8750; val_masked_gp_l1_reg_loss: 87727.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99403.3828; val_chrom_access_recon_loss: 6128421.5625; val_global_loss: 21134034.7500; val_optim_loss: 21134034.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9132; val_auprc_score: 0.8838; val_best_acc_score: 0.8501; val_best_f1_score: 0.8620; train_kl_reg_loss: 91704.3166; train_edge_recon_loss: 2778101.3712; train_gene_expr_recon_loss: 11992787.1818; train_masked_gp_l1_reg_loss: 88005.5105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98242.0977; train_chrom_access_recon_loss: 6212002.2348; train_global_loss: 21260842.8788; train_optim_loss: 21260842.8788; val_kl_reg_loss: 96104.3164; val_edge_recon_loss: 2820559.9688; val_gene_expr_recon_loss: 11865754.6250; val_masked_gp_l1_reg_loss: 88322.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97411.7422; val_chrom_access_recon_loss: 6181031.9375; val_global_loss: 21149185.0000; val_optim_loss: 21149185.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9184; val_auprc_score: 0.8904; val_best_acc_score: 0.8565; val_best_f1_score: 0.8651; train_kl_reg_loss: 91803.9366; train_edge_recon_loss: 2766873.2538; train_gene_expr_recon_loss: 11967401.8485; train_masked_gp_l1_reg_loss: 88659.3268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96982.0507; train_chrom_access_recon_loss: 6205187.2197; train_global_loss: 21216907.3636; train_optim_loss: 21216907.3636; val_kl_reg_loss: 93297.8740; val_edge_recon_loss: 2810744.6562; val_gene_expr_recon_loss: 11943740.1250; val_masked_gp_l1_reg_loss: 89008.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96698.9297; val_chrom_access_recon_loss: 6181373.8750; val_global_loss: 21214864.5000; val_optim_loss: 21214864.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9149; val_auprc_score: 0.8845; val_best_acc_score: 0.8560; val_best_f1_score: 0.8651; train_kl_reg_loss: 90709.1754; train_edge_recon_loss: 2761204.8485; train_gene_expr_recon_loss: 11941619.1970; train_masked_gp_l1_reg_loss: 89267.9831; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95880.1643; train_chrom_access_recon_loss: 6188592.0682; train_global_loss: 21167273.3939; train_optim_loss: 21167273.3939; val_kl_reg_loss: 90731.4336; val_edge_recon_loss: 2796619.7188; val_gene_expr_recon_loss: 11855442.5000; val_masked_gp_l1_reg_loss: 89497.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94858.8984; val_chrom_access_recon_loss: 6116505.0625; val_global_loss: 21043655.0000; val_optim_loss: 21043655.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9225; val_auprc_score: 0.8936; val_best_acc_score: 0.8667; val_best_f1_score: 0.8756; train_kl_reg_loss: 89428.9023; train_edge_recon_loss: 2761644.7992; train_gene_expr_recon_loss: 11913104.9848; train_masked_gp_l1_reg_loss: 89935.9046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95085.6602; train_chrom_access_recon_loss: 6176915.3182; train_global_loss: 21126115.5455; train_optim_loss: 21126115.5455; val_kl_reg_loss: 90256.7168; val_edge_recon_loss: 2791190.2188; val_gene_expr_recon_loss: 11799864.2500; val_masked_gp_l1_reg_loss: 90183.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94359.9297; val_chrom_access_recon_loss: 6113647.6875; val_global_loss: 20979503.0000; val_optim_loss: 20979503.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9245; val_auprc_score: 0.8968; val_best_acc_score: 0.8662; val_best_f1_score: 0.8752; train_kl_reg_loss: 89335.7223; train_edge_recon_loss: 2761185.0871; train_gene_expr_recon_loss: 11876880.7727; train_masked_gp_l1_reg_loss: 90383.8059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94010.5717; train_chrom_access_recon_loss: 6152991.6667; train_global_loss: 21064787.8788; train_optim_loss: 21064787.8788; val_kl_reg_loss: 87964.7695; val_edge_recon_loss: 2782886.1875; val_gene_expr_recon_loss: 11826331.6250; val_masked_gp_l1_reg_loss: 90482.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93888.2734; val_chrom_access_recon_loss: 6061836.6250; val_global_loss: 20943390.2500; val_optim_loss: 20943390.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9251; val_auprc_score: 0.8962; val_best_acc_score: 0.8641; val_best_f1_score: 0.8742; train_kl_reg_loss: 88538.9032; train_edge_recon_loss: 2752318.4811; train_gene_expr_recon_loss: 11860302.4545; train_masked_gp_l1_reg_loss: 90702.8031; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93325.1933; train_chrom_access_recon_loss: 6142330.8106; train_global_loss: 21027518.7576; train_optim_loss: 21027518.7576; val_kl_reg_loss: 88315.0781; val_edge_recon_loss: 2771493.3125; val_gene_expr_recon_loss: 11713685.5000; val_masked_gp_l1_reg_loss: 90868.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93028.3359; val_chrom_access_recon_loss: 6103357.0000; val_global_loss: 20860746.7500; val_optim_loss: 20860746.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9320; val_auprc_score: 0.9057; val_best_acc_score: 0.8697; val_best_f1_score: 0.8784; train_kl_reg_loss: 87904.8577; train_edge_recon_loss: 2743473.1705; train_gene_expr_recon_loss: 11831911.4091; train_masked_gp_l1_reg_loss: 91077.6448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92961.3672; train_chrom_access_recon_loss: 6127697.4242; train_global_loss: 20975025.7576; train_optim_loss: 20975025.7576; val_kl_reg_loss: 87659.9932; val_edge_recon_loss: 2765950.9062; val_gene_expr_recon_loss: 11784979.3750; val_masked_gp_l1_reg_loss: 91272.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92572.0547; val_chrom_access_recon_loss: 6031854.0625; val_global_loss: 20854289.2500; val_optim_loss: 20854289.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9321; val_auprc_score: 0.9168; val_best_acc_score: 0.8678; val_best_f1_score: 0.8747; train_kl_reg_loss: 86945.9199; train_edge_recon_loss: 2737001.4015; train_gene_expr_recon_loss: 11812553.4394; train_masked_gp_l1_reg_loss: 91362.3544; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92209.2566; train_chrom_access_recon_loss: 6118829.8788; train_global_loss: 20938902.4242; train_optim_loss: 20938902.4242; val_kl_reg_loss: 89393.7178; val_edge_recon_loss: 2770659.6875; val_gene_expr_recon_loss: 11622615.2500; val_masked_gp_l1_reg_loss: 91616.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91921.6172; val_chrom_access_recon_loss: 6074870.4375; val_global_loss: 20741078.2500; val_optim_loss: 20741078.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9249; val_auprc_score: 0.8944; val_best_acc_score: 0.8657; val_best_f1_score: 0.8748; train_kl_reg_loss: 86577.1991; train_edge_recon_loss: 2740988.1970; train_gene_expr_recon_loss: 11791306.3182; train_masked_gp_l1_reg_loss: 91615.0533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91636.6219; train_chrom_access_recon_loss: 6109250.7121; train_global_loss: 20911374.1818; train_optim_loss: 20911374.1818; val_kl_reg_loss: 85490.1338; val_edge_recon_loss: 2789123.8750; val_gene_expr_recon_loss: 11722865.1250; val_masked_gp_l1_reg_loss: 91514.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91131.7500; val_chrom_access_recon_loss: 6054591.2500; val_global_loss: 20834716.2500; val_optim_loss: 20834716.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9284; val_auprc_score: 0.9023; val_best_acc_score: 0.8724; val_best_f1_score: 0.8804; train_kl_reg_loss: 86124.7062; train_edge_recon_loss: 2735633.7159; train_gene_expr_recon_loss: 11764953.8788; train_masked_gp_l1_reg_loss: 91779.1886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91055.0217; train_chrom_access_recon_loss: 6091009.7424; train_global_loss: 20860556.0909; train_optim_loss: 20860556.0909; val_kl_reg_loss: 90262.0244; val_edge_recon_loss: 2744714.5938; val_gene_expr_recon_loss: 11665487.8750; val_masked_gp_l1_reg_loss: 92019.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90398.3906; val_chrom_access_recon_loss: 6015487.2500; val_global_loss: 20698368.7500; val_optim_loss: 20698368.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9246; val_auprc_score: 0.8936; val_best_acc_score: 0.8673; val_best_f1_score: 0.8764; train_kl_reg_loss: 85541.3125; train_edge_recon_loss: 2735375.6439; train_gene_expr_recon_loss: 11761011.6667; train_masked_gp_l1_reg_loss: 92045.5008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90437.4366; train_chrom_access_recon_loss: 6086907.0758; train_global_loss: 20851318.8485; train_optim_loss: 20851318.8485; val_kl_reg_loss: 83810.9199; val_edge_recon_loss: 2773943.2500; val_gene_expr_recon_loss: 11530221.3750; val_masked_gp_l1_reg_loss: 92264.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90646.0000; val_chrom_access_recon_loss: 5949887.1875; val_global_loss: 20520773.7500; val_optim_loss: 20520773.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9293; val_auprc_score: 0.8969; val_best_acc_score: 0.8745; val_best_f1_score: 0.8819; train_kl_reg_loss: 85911.7514; train_edge_recon_loss: 2721683.8447; train_gene_expr_recon_loss: 11731074.0758; train_masked_gp_l1_reg_loss: 92323.6199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90111.1371; train_chrom_access_recon_loss: 6067922.1136; train_global_loss: 20789026.6364; train_optim_loss: 20789026.6364; val_kl_reg_loss: 85387.8066; val_edge_recon_loss: 2762679.0000; val_gene_expr_recon_loss: 11562612.5000; val_masked_gp_l1_reg_loss: 92371.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90249.0078; val_chrom_access_recon_loss: 5961935.7500; val_global_loss: 20555235.2500; val_optim_loss: 20555235.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9331; val_auprc_score: 0.9061; val_best_acc_score: 0.8767; val_best_f1_score: 0.8833; train_kl_reg_loss: 85076.2055; train_edge_recon_loss: 2724072.8371; train_gene_expr_recon_loss: 11709931.4697; train_masked_gp_l1_reg_loss: 92434.0049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89881.7353; train_chrom_access_recon_loss: 6058870.3788; train_global_loss: 20760266.6970; train_optim_loss: 20760266.6970; val_kl_reg_loss: 83397.2178; val_edge_recon_loss: 2772608.1875; val_gene_expr_recon_loss: 11512158.5000; val_masked_gp_l1_reg_loss: 92563.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90024.6484; val_chrom_access_recon_loss: 5990656.2500; val_global_loss: 20541409.0000; val_optim_loss: 20541409.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9381; val_auprc_score: 0.9145; val_best_acc_score: 0.8823; val_best_f1_score: 0.8883; train_kl_reg_loss: 84540.9238; train_edge_recon_loss: 2723610.6136; train_gene_expr_recon_loss: 11699341.1970; train_masked_gp_l1_reg_loss: 92593.8018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89510.9620; train_chrom_access_recon_loss: 6050804.0000; train_global_loss: 20740401.8485; train_optim_loss: 20740401.8485; val_kl_reg_loss: 84075.7588; val_edge_recon_loss: 2719533.0312; val_gene_expr_recon_loss: 11565277.5000; val_masked_gp_l1_reg_loss: 92614.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88919.1875; val_chrom_access_recon_loss: 5956266.0000; val_global_loss: 20506685.5000; val_optim_loss: 20506685.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9366; val_auprc_score: 0.9111; val_best_acc_score: 0.8799; val_best_f1_score: 0.8866; train_kl_reg_loss: 82301.1690; train_edge_recon_loss: 2730214.8144; train_gene_expr_recon_loss: 11682107.4091; train_masked_gp_l1_reg_loss: 92583.2375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89293.9937; train_chrom_access_recon_loss: 6038313.0909; train_global_loss: 20714813.7273; train_optim_loss: 20714813.7273; val_kl_reg_loss: 82920.8418; val_edge_recon_loss: 2763189.8750; val_gene_expr_recon_loss: 11656362.7500; val_masked_gp_l1_reg_loss: 92677.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89392.6328; val_chrom_access_recon_loss: 6002277.1250; val_global_loss: 20686820.5000; val_optim_loss: 20686820.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9439; val_auprc_score: 0.9204; val_best_acc_score: 0.8845; val_best_f1_score: 0.8899; train_kl_reg_loss: 82533.5903; train_edge_recon_loss: 2721795.7235; train_gene_expr_recon_loss: 11658998.7273; train_masked_gp_l1_reg_loss: 92660.1570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89089.0469; train_chrom_access_recon_loss: 6028400.5606; train_global_loss: 20673477.8182; train_optim_loss: 20673477.8182; val_kl_reg_loss: 82517.5713; val_edge_recon_loss: 2752156.5000; val_gene_expr_recon_loss: 11475390.8750; val_masked_gp_l1_reg_loss: 92675.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88889.6172; val_chrom_access_recon_loss: 5912970.5000; val_global_loss: 20404600.5000; val_optim_loss: 20404600.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9402; val_auprc_score: 0.9185; val_best_acc_score: 0.8829; val_best_f1_score: 0.8888; train_kl_reg_loss: 82602.1731; train_edge_recon_loss: 2727689.5795; train_gene_expr_recon_loss: 11647885.8182; train_masked_gp_l1_reg_loss: 92700.2708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88711.7312; train_chrom_access_recon_loss: 6019607.1667; train_global_loss: 20659196.7273; train_optim_loss: 20659196.7273; val_kl_reg_loss: 83363.9707; val_edge_recon_loss: 2766701.8750; val_gene_expr_recon_loss: 11552093.2500; val_masked_gp_l1_reg_loss: 92602.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88373.8984; val_chrom_access_recon_loss: 5966651.8750; val_global_loss: 20549788.0000; val_optim_loss: 20549788.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9472; val_auprc_score: 0.9270; val_best_acc_score: 0.8917; val_best_f1_score: 0.8951; train_kl_reg_loss: 82653.5366; train_edge_recon_loss: 2709631.4773; train_gene_expr_recon_loss: 11632634.4394; train_masked_gp_l1_reg_loss: 92563.1380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88290.3406; train_chrom_access_recon_loss: 6006932.8939; train_global_loss: 20612705.8182; train_optim_loss: 20612705.8182; val_kl_reg_loss: 82655.2168; val_edge_recon_loss: 2746061.0312; val_gene_expr_recon_loss: 11538279.7500; val_masked_gp_l1_reg_loss: 92628.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88068.5234; val_chrom_access_recon_loss: 5959054.3750; val_global_loss: 20506748.2500; val_optim_loss: 20506748.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9507; val_auprc_score: 0.9317; val_best_acc_score: 0.8941; val_best_f1_score: 0.8987; train_kl_reg_loss: 82515.8284; train_edge_recon_loss: 2713569.8788; train_gene_expr_recon_loss: 11620357.2121; train_masked_gp_l1_reg_loss: 92631.3713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88148.3059; train_chrom_access_recon_loss: 5996740.4621; train_global_loss: 20593962.9394; train_optim_loss: 20593962.9394; val_kl_reg_loss: 82147.5537; val_edge_recon_loss: 2715582.6875; val_gene_expr_recon_loss: 11543248.1250; val_masked_gp_l1_reg_loss: 92627.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88347.0078; val_chrom_access_recon_loss: 5935708.7500; val_global_loss: 20457662.0000; val_optim_loss: 20457662.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9517; val_auprc_score: 0.9306; val_best_acc_score: 0.8947; val_best_f1_score: 0.8980; train_kl_reg_loss: 82151.6353; train_edge_recon_loss: 2715694.9545; train_gene_expr_recon_loss: 11600740.3636; train_masked_gp_l1_reg_loss: 92485.8071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88143.1785; train_chrom_access_recon_loss: 5986149.0227; train_global_loss: 20565364.9697; train_optim_loss: 20565364.9697; val_kl_reg_loss: 83774.1445; val_edge_recon_loss: 2725406.2812; val_gene_expr_recon_loss: 11476998.5000; val_masked_gp_l1_reg_loss: 92476.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88501.2422; val_chrom_access_recon_loss: 5921816.3750; val_global_loss: 20388973.2500; val_optim_loss: 20388973.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9553; val_auprc_score: 0.9375; val_best_acc_score: 0.9009; val_best_f1_score: 0.9032; train_kl_reg_loss: 81649.4349; train_edge_recon_loss: 2707909.2841; train_gene_expr_recon_loss: 11585839.2121; train_masked_gp_l1_reg_loss: 92402.2180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88193.4783; train_chrom_access_recon_loss: 5970958.0455; train_global_loss: 20526951.6667; train_optim_loss: 20526951.6667; val_kl_reg_loss: 83143.8096; val_edge_recon_loss: 2725112.7500; val_gene_expr_recon_loss: 11504745.1250; val_masked_gp_l1_reg_loss: 92393.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88165.3984; val_chrom_access_recon_loss: 5937432.7500; val_global_loss: 20430992.5000; val_optim_loss: 20430992.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9457; val_auprc_score: 0.9226; val_best_acc_score: 0.8958; val_best_f1_score: 0.9014; train_kl_reg_loss: 82195.5542; train_edge_recon_loss: 2706976.3750; train_gene_expr_recon_loss: 11582437.7727; train_masked_gp_l1_reg_loss: 92344.1362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87966.1360; train_chrom_access_recon_loss: 5969735.1894; train_global_loss: 20521655.0909; train_optim_loss: 20521655.0909; val_kl_reg_loss: 80809.8809; val_edge_recon_loss: 2741944.1562; val_gene_expr_recon_loss: 11512323.6250; val_masked_gp_l1_reg_loss: 92166.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88359.5312; val_chrom_access_recon_loss: 5915998.7500; val_global_loss: 20431603.0000; val_optim_loss: 20431603.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9522; val_auprc_score: 0.9339; val_best_acc_score: 0.8939; val_best_f1_score: 0.8998; train_kl_reg_loss: 81030.3741; train_edge_recon_loss: 2714085.0758; train_gene_expr_recon_loss: 11568024.4545; train_masked_gp_l1_reg_loss: 92073.4570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88108.3819; train_chrom_access_recon_loss: 5952067.1970; train_global_loss: 20495388.9394; train_optim_loss: 20495388.9394; val_kl_reg_loss: 81933.7842; val_edge_recon_loss: 2754613.4688; val_gene_expr_recon_loss: 11483476.5000; val_masked_gp_l1_reg_loss: 91952.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88234.8203; val_chrom_access_recon_loss: 5920040.7500; val_global_loss: 20420252.5000; val_optim_loss: 20420252.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9533; val_auprc_score: 0.9329; val_best_acc_score: 0.9017; val_best_f1_score: 0.9051; train_kl_reg_loss: 82285.7727; train_edge_recon_loss: 2705176.7917; train_gene_expr_recon_loss: 11556956.7273; train_masked_gp_l1_reg_loss: 91812.1091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88089.9157; train_chrom_access_recon_loss: 5953441.5682; train_global_loss: 20477762.6667; train_optim_loss: 20477762.6667; val_kl_reg_loss: 80633.4092; val_edge_recon_loss: 2750492.8750; val_gene_expr_recon_loss: 11432818.6250; val_masked_gp_l1_reg_loss: 91520.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87969.2188; val_chrom_access_recon_loss: 5858743.7500; val_global_loss: 20302178.7500; val_optim_loss: 20302178.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9482; val_auprc_score: 0.9268; val_best_acc_score: 0.8939; val_best_f1_score: 0.8998; train_kl_reg_loss: 81189.0496; train_edge_recon_loss: 2699949.2576; train_gene_expr_recon_loss: 11537480.7424; train_masked_gp_l1_reg_loss: 91432.4105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88343.0052; train_chrom_access_recon_loss: 5939365.7121; train_global_loss: 20437760.3333; train_optim_loss: 20437760.3333; val_kl_reg_loss: 81174.4717; val_edge_recon_loss: 2753114.7812; val_gene_expr_recon_loss: 11396957.3750; val_masked_gp_l1_reg_loss: 91422.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88570.7969; val_chrom_access_recon_loss: 5827862.1250; val_global_loss: 20239102.2500; val_optim_loss: 20239102.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9589; val_auprc_score: 0.9441; val_best_acc_score: 0.9092; val_best_f1_score: 0.9111; train_kl_reg_loss: 81528.8520; train_edge_recon_loss: 2711642.4659; train_gene_expr_recon_loss: 11526131.9545; train_masked_gp_l1_reg_loss: 91398.0487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88781.2726; train_chrom_access_recon_loss: 5931805.3258; train_global_loss: 20431287.6364; train_optim_loss: 20431287.6364; val_kl_reg_loss: 81867.4307; val_edge_recon_loss: 2707565.4688; val_gene_expr_recon_loss: 11359441.6250; val_masked_gp_l1_reg_loss: 91318.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88871.3672; val_chrom_access_recon_loss: 5887221.6875; val_global_loss: 20216286.0000; val_optim_loss: 20216286.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9515; val_auprc_score: 0.9321; val_best_acc_score: 0.9017; val_best_f1_score: 0.9050; train_kl_reg_loss: 79735.8549; train_edge_recon_loss: 2705466.7348; train_gene_expr_recon_loss: 11526823.8939; train_masked_gp_l1_reg_loss: 91267.3150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89380.4042; train_chrom_access_recon_loss: 5922365.3409; train_global_loss: 20415039.3939; train_optim_loss: 20415039.3939; val_kl_reg_loss: 80425.8516; val_edge_recon_loss: 2758983.5938; val_gene_expr_recon_loss: 11433437.0000; val_masked_gp_l1_reg_loss: 91384.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90057.4922; val_chrom_access_recon_loss: 5877664.5000; val_global_loss: 20331952.0000; val_optim_loss: 20331952.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9558; val_auprc_score: 0.9402; val_best_acc_score: 0.9073; val_best_f1_score: 0.9110; train_kl_reg_loss: 79581.1974; train_edge_recon_loss: 2697946.1364; train_gene_expr_recon_loss: 11504654.1364; train_masked_gp_l1_reg_loss: 91362.7111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90021.6042; train_chrom_access_recon_loss: 5910974.3561; train_global_loss: 20374539.8788; train_optim_loss: 20374539.8788; val_kl_reg_loss: 80963.0312; val_edge_recon_loss: 2725077.8750; val_gene_expr_recon_loss: 11410190.3750; val_masked_gp_l1_reg_loss: 91254.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90605.2109; val_chrom_access_recon_loss: 5899906.0625; val_global_loss: 20297996.5000; val_optim_loss: 20297996.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9601; val_auprc_score: 0.9455; val_best_acc_score: 0.9138; val_best_f1_score: 0.9171; train_kl_reg_loss: 80379.7379; train_edge_recon_loss: 2697813.1705; train_gene_expr_recon_loss: 11506610.6212; train_masked_gp_l1_reg_loss: 91206.3962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90640.3981; train_chrom_access_recon_loss: 5913176.6667; train_global_loss: 20379826.9091; train_optim_loss: 20379826.9091; val_kl_reg_loss: 82590.6953; val_edge_recon_loss: 2690318.4688; val_gene_expr_recon_loss: 11409265.2500; val_masked_gp_l1_reg_loss: 91056.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91110.0781; val_chrom_access_recon_loss: 5920162.5000; val_global_loss: 20284504.5000; val_optim_loss: 20284504.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9615; val_auprc_score: 0.9470; val_best_acc_score: 0.9116; val_best_f1_score: 0.9142; train_kl_reg_loss: 80030.4776; train_edge_recon_loss: 2693995.5568; train_gene_expr_recon_loss: 11483718.8182; train_masked_gp_l1_reg_loss: 91016.8379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91294.0586; train_chrom_access_recon_loss: 5893435.6591; train_global_loss: 20333491.4545; train_optim_loss: 20333491.4545; val_kl_reg_loss: 78738.0986; val_edge_recon_loss: 2697906.9062; val_gene_expr_recon_loss: 11459347.0000; val_masked_gp_l1_reg_loss: 90960.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91809.5938; val_chrom_access_recon_loss: 5870888.5000; val_global_loss: 20289650.5000; val_optim_loss: 20289650.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9582; val_auprc_score: 0.9377; val_best_acc_score: 0.9103; val_best_f1_score: 0.9142; train_kl_reg_loss: 79392.3291; train_edge_recon_loss: 2695809.9394; train_gene_expr_recon_loss: 11481186.0000; train_masked_gp_l1_reg_loss: 89965.9002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72996.5992; train_chrom_access_recon_loss: 5889528.1591; train_global_loss: 20308878.8788; train_optim_loss: 20308878.8788; val_kl_reg_loss: 82006.4072; val_edge_recon_loss: 2712490.6250; val_gene_expr_recon_loss: 11408758.0000; val_masked_gp_l1_reg_loss: 89524.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69054.5938; val_chrom_access_recon_loss: 5927887.1875; val_global_loss: 20289721.5000; val_optim_loss: 20289721.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9625; val_auprc_score: 0.9456; val_best_acc_score: 0.9108; val_best_f1_score: 0.9142; train_kl_reg_loss: 81075.7365; train_edge_recon_loss: 2695879.9318; train_gene_expr_recon_loss: 11483990.7576; train_masked_gp_l1_reg_loss: 89441.4522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68628.4026; train_chrom_access_recon_loss: 5886420.8485; train_global_loss: 20305437.0606; train_optim_loss: 20305437.0606; val_kl_reg_loss: 82634.7627; val_edge_recon_loss: 2704093.5625; val_gene_expr_recon_loss: 11356899.2500; val_masked_gp_l1_reg_loss: 89394.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68317.3203; val_chrom_access_recon_loss: 5805208.7500; val_global_loss: 20106547.5000; val_optim_loss: 20106547.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9585; val_auprc_score: 0.9408; val_best_acc_score: 0.9046; val_best_f1_score: 0.9082; train_kl_reg_loss: 82189.3294; train_edge_recon_loss: 2693436.0265; train_gene_expr_recon_loss: 11470912.7879; train_masked_gp_l1_reg_loss: 89376.7760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68155.7288; train_chrom_access_recon_loss: 5883124.7576; train_global_loss: 20287195.4545; train_optim_loss: 20287195.4545; val_kl_reg_loss: 83876.6045; val_edge_recon_loss: 2726043.0000; val_gene_expr_recon_loss: 11428902.8750; val_masked_gp_l1_reg_loss: 89332.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67904.1719; val_chrom_access_recon_loss: 5918522.9375; val_global_loss: 20314581.7500; val_optim_loss: 20314581.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9566; val_auprc_score: 0.9381; val_best_acc_score: 0.9044; val_best_f1_score: 0.9077; train_kl_reg_loss: 82589.7067; train_edge_recon_loss: 2692164.1326; train_gene_expr_recon_loss: 11465817.0455; train_masked_gp_l1_reg_loss: 89315.7243; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67752.2836; train_chrom_access_recon_loss: 5883692.6894; train_global_loss: 20281331.6667; train_optim_loss: 20281331.6667; val_kl_reg_loss: 82692.7314; val_edge_recon_loss: 2725562.4375; val_gene_expr_recon_loss: 11365988.2500; val_masked_gp_l1_reg_loss: 89286.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67602.1562; val_chrom_access_recon_loss: 5856131.0000; val_global_loss: 20187263.5000; val_optim_loss: 20187263.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9583; val_auprc_score: 0.9383; val_best_acc_score: 0.9057; val_best_f1_score: 0.9091; train_kl_reg_loss: 82780.2566; train_edge_recon_loss: 2680434.6212; train_gene_expr_recon_loss: 11468493.3636; train_masked_gp_l1_reg_loss: 89258.5142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67486.7764; train_chrom_access_recon_loss: 5876918.0682; train_global_loss: 20265371.7576; train_optim_loss: 20265371.7576; val_kl_reg_loss: 84810.2500; val_edge_recon_loss: 2732463.1875; val_gene_expr_recon_loss: 11450439.2500; val_masked_gp_l1_reg_loss: 89245.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67358.7344; val_chrom_access_recon_loss: 5846868.5000; val_global_loss: 20271185.2500; val_optim_loss: 20271185.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9523; val_auprc_score: 0.9257; val_best_acc_score: 0.9049; val_best_f1_score: 0.9090; train_kl_reg_loss: 82867.5753; train_edge_recon_loss: 2693278.8030; train_gene_expr_recon_loss: 11470892.1667; train_masked_gp_l1_reg_loss: 89225.9863; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67278.1372; train_chrom_access_recon_loss: 5876058.6970; train_global_loss: 20279601.5152; train_optim_loss: 20279601.5152; val_kl_reg_loss: 83817.9766; val_edge_recon_loss: 2717357.2500; val_gene_expr_recon_loss: 11359558.8750; val_masked_gp_l1_reg_loss: 89215.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67185.7969; val_chrom_access_recon_loss: 5878164.4375; val_global_loss: 20195300.5000; val_optim_loss: 20195300.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9549; val_auprc_score: 0.9377; val_best_acc_score: 0.9038; val_best_f1_score: 0.9082; train_kl_reg_loss: 83093.9313; train_edge_recon_loss: 2680284.1970; train_gene_expr_recon_loss: 11465634.1818; train_masked_gp_l1_reg_loss: 89110.7472; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65342.5141; train_chrom_access_recon_loss: 5872289.0833; train_global_loss: 20255754.6061; train_optim_loss: 20255754.6061; val_kl_reg_loss: 84839.2295; val_edge_recon_loss: 2728098.6250; val_gene_expr_recon_loss: 11429890.3750; val_masked_gp_l1_reg_loss: 89059.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64969.1094; val_chrom_access_recon_loss: 5892368.9375; val_global_loss: 20289226.5000; val_optim_loss: 20289226.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9528; val_auprc_score: 0.9343; val_best_acc_score: 0.9033; val_best_f1_score: 0.9073; train_kl_reg_loss: 83221.5487; train_edge_recon_loss: 2698931.8561; train_gene_expr_recon_loss: 11456070.4545; train_masked_gp_l1_reg_loss: 89044.6090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64929.4859; train_chrom_access_recon_loss: 5873550.2197; train_global_loss: 20265748.1515; train_optim_loss: 20265748.1515; val_kl_reg_loss: 84402.4082; val_edge_recon_loss: 2759638.8125; val_gene_expr_recon_loss: 11398765.8750; val_masked_gp_l1_reg_loss: 89034.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64894.3633; val_chrom_access_recon_loss: 5849156.1250; val_global_loss: 20245892.0000; val_optim_loss: 20245892.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9555; val_auprc_score: 0.9427; val_best_acc_score: 0.8979; val_best_f1_score: 0.9035; train_kl_reg_loss: 83096.5154; train_edge_recon_loss: 2687343.5947; train_gene_expr_recon_loss: 11467600.5606; train_masked_gp_l1_reg_loss: 89029.3207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64874.0133; train_chrom_access_recon_loss: 5878638.0682; train_global_loss: 20270582.0909; train_optim_loss: 20270582.0909; val_kl_reg_loss: 83783.1787; val_edge_recon_loss: 2768412.3438; val_gene_expr_recon_loss: 11425197.5000; val_masked_gp_l1_reg_loss: 89023.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64848.5859; val_chrom_access_recon_loss: 5872950.3125; val_global_loss: 20304216.5000; val_optim_loss: 20304216.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9616; val_auprc_score: 0.9443; val_best_acc_score: 0.9108; val_best_f1_score: 0.9144; train_kl_reg_loss: 83096.2333; train_edge_recon_loss: 2688347.5682; train_gene_expr_recon_loss: 11468257.5909; train_masked_gp_l1_reg_loss: 89020.1209; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64832.5408; train_chrom_access_recon_loss: 5877599.1818; train_global_loss: 20271153.2424; train_optim_loss: 20271153.2424; val_kl_reg_loss: 84858.3154; val_edge_recon_loss: 2699573.0625; val_gene_expr_recon_loss: 11381832.5000; val_masked_gp_l1_reg_loss: 89016.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64813.4766; val_chrom_access_recon_loss: 5895839.8125; val_global_loss: 20215933.7500; val_optim_loss: 20215933.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 18 min 37 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9519
val AUPRC score: 0.9261
val best accuracy score: 0.9025
val best F1 score: 0.9069
val target rna MSE score: 1.1685
val source rna MSE score: 0.6138
val target atac MSE score: 0.3120
val source atac MSE score: 0.1263
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
