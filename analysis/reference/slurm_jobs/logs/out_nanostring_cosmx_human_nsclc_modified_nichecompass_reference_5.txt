[True, False]
Run timestamp: 02092023_190859_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '10', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 10, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 126882
Number of validation nodes: 14098
Number of training edges: 300588
Number of validation edges: 33398
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9078; val_auprc_score: 0.9429; val_best_acc_score: 0.8570; val_best_f1_score: 0.8967; train_kl_reg_loss: 16682.1548; train_edge_recon_loss: 1942480.2751; train_gene_expr_recon_loss: 2949703.3975; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4908865.8248; train_optim_loss: 4908865.8248; val_kl_reg_loss: 12653.3597; val_edge_recon_loss: 1867548.4735; val_gene_expr_recon_loss: 2725450.0720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4605651.8939; val_optim_loss: 4605651.8939
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9352; val_auprc_score: 0.9584; val_best_acc_score: 0.8893; val_best_f1_score: 0.9199; train_kl_reg_loss: 12000.7963; train_edge_recon_loss: 1788947.3701; train_gene_expr_recon_loss: 2669613.5978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4470561.7696; train_optim_loss: 4470561.7696; val_kl_reg_loss: 12262.5386; val_edge_recon_loss: 1832496.5114; val_gene_expr_recon_loss: 2587319.5947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4432078.6894; val_optim_loss: 4432078.6894
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9467; val_auprc_score: 0.9644; val_best_acc_score: 0.9023; val_best_f1_score: 0.9285; train_kl_reg_loss: 12204.9943; train_edge_recon_loss: 1773105.6112; train_gene_expr_recon_loss: 2528251.9919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4313562.6012; train_optim_loss: 4313562.6012; val_kl_reg_loss: 12655.8625; val_edge_recon_loss: 1829116.6856; val_gene_expr_recon_loss: 2435396.8712; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4277169.4356; val_optim_loss: 4277169.4356
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9497; val_auprc_score: 0.9650; val_best_acc_score: 0.9080; val_best_f1_score: 0.9326; train_kl_reg_loss: 13468.1384; train_edge_recon_loss: 1767174.0935; train_gene_expr_recon_loss: 2371530.7024; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4152172.9379; train_optim_loss: 4152172.9379; val_kl_reg_loss: 14917.4664; val_edge_recon_loss: 1827310.4129; val_gene_expr_recon_loss: 2296666.6212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4138894.4962; val_optim_loss: 4138894.4962
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9540; val_auprc_score: 0.9682; val_best_acc_score: 0.9131; val_best_f1_score: 0.9361; train_kl_reg_loss: 15054.4489; train_edge_recon_loss: 1763905.0582; train_gene_expr_recon_loss: 2246841.9885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4025801.4953; train_optim_loss: 4025801.4953; val_kl_reg_loss: 16033.9034; val_edge_recon_loss: 1826166.0322; val_gene_expr_recon_loss: 2186310.8371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4028510.7879; val_optim_loss: 4028510.7879
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9565; val_auprc_score: 0.9705; val_best_acc_score: 0.9157; val_best_f1_score: 0.9382; train_kl_reg_loss: 16252.8370; train_edge_recon_loss: 1766803.3189; train_gene_expr_recon_loss: 2159240.9537; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3942297.1080; train_optim_loss: 3942297.1080; val_kl_reg_loss: 16579.4041; val_edge_recon_loss: 1825923.1610; val_gene_expr_recon_loss: 2126752.5473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3969255.1023; val_optim_loss: 3969255.1023
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9575; val_auprc_score: 0.9729; val_best_acc_score: 0.9153; val_best_f1_score: 0.9383; train_kl_reg_loss: 17077.7143; train_edge_recon_loss: 1757444.1792; train_gene_expr_recon_loss: 2096372.7598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3870894.6526; train_optim_loss: 3870894.6526; val_kl_reg_loss: 17182.5430; val_edge_recon_loss: 1812896.6818; val_gene_expr_recon_loss: 2074608.3258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3904687.5530; val_optim_loss: 3904687.5530
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9570; val_auprc_score: 0.9715; val_best_acc_score: 0.9161; val_best_f1_score: 0.9385; train_kl_reg_loss: 17687.2927; train_edge_recon_loss: 1765160.7904; train_gene_expr_recon_loss: 2050703.4339; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3833551.5187; train_optim_loss: 3833551.5187; val_kl_reg_loss: 17883.0633; val_edge_recon_loss: 1824950.9413; val_gene_expr_recon_loss: 2031070.2973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3873904.2955; val_optim_loss: 3873904.2955
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9598; val_auprc_score: 0.9737; val_best_acc_score: 0.9182; val_best_f1_score: 0.9401; train_kl_reg_loss: 18113.9093; train_edge_recon_loss: 1758562.1735; train_gene_expr_recon_loss: 2017460.8591; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3794136.9422; train_optim_loss: 3794136.9422; val_kl_reg_loss: 18455.6063; val_edge_recon_loss: 1802803.1231; val_gene_expr_recon_loss: 2004493.5549; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3825752.2955; val_optim_loss: 3825752.2955
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9607; val_auprc_score: 0.9743; val_best_acc_score: 0.9197; val_best_f1_score: 0.9412; train_kl_reg_loss: 18477.9024; train_edge_recon_loss: 1761846.2315; train_gene_expr_recon_loss: 1989823.9870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3770148.1203; train_optim_loss: 3770148.1203; val_kl_reg_loss: 18693.9432; val_edge_recon_loss: 1799562.8750; val_gene_expr_recon_loss: 1979401.7860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3797658.6136; val_optim_loss: 3797658.6136
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9603; val_auprc_score: 0.9732; val_best_acc_score: 0.9207; val_best_f1_score: 0.9419; train_kl_reg_loss: 18817.1424; train_edge_recon_loss: 1761416.1003; train_gene_expr_recon_loss: 1967694.1078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3747927.3593; train_optim_loss: 3747927.3593; val_kl_reg_loss: 18988.7791; val_edge_recon_loss: 1814299.3731; val_gene_expr_recon_loss: 1963804.1174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3797092.2652; val_optim_loss: 3797092.2652
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9584; val_auprc_score: 0.9715; val_best_acc_score: 0.9205; val_best_f1_score: 0.9416; train_kl_reg_loss: 19105.3011; train_edge_recon_loss: 1759343.7375; train_gene_expr_recon_loss: 1954513.1784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3732962.2177; train_optim_loss: 3732962.2177; val_kl_reg_loss: 19396.8045; val_edge_recon_loss: 1815745.8144; val_gene_expr_recon_loss: 1952693.3220; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3787835.9508; val_optim_loss: 3787835.9508
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9628; val_auprc_score: 0.9743; val_best_acc_score: 0.9247; val_best_f1_score: 0.9443; train_kl_reg_loss: 19261.2135; train_edge_recon_loss: 1761269.6031; train_gene_expr_recon_loss: 1939176.3259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3719707.1441; train_optim_loss: 3719707.1441; val_kl_reg_loss: 19591.0439; val_edge_recon_loss: 1817073.0795; val_gene_expr_recon_loss: 1950561.9811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3787226.1098; val_optim_loss: 3787226.1098
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9646; val_auprc_score: 0.9776; val_best_acc_score: 0.9212; val_best_f1_score: 0.9422; train_kl_reg_loss: 19385.7935; train_edge_recon_loss: 1759932.8057; train_gene_expr_recon_loss: 1926205.2158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3705523.8176; train_optim_loss: 3705523.8176; val_kl_reg_loss: 19255.5655; val_edge_recon_loss: 1814708.4527; val_gene_expr_recon_loss: 1928951.1212; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3762915.1364; val_optim_loss: 3762915.1364
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9627; val_auprc_score: 0.9758; val_best_acc_score: 0.9219; val_best_f1_score: 0.9426; train_kl_reg_loss: 19518.2308; train_edge_recon_loss: 1757544.0840; train_gene_expr_recon_loss: 1917706.2659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3694768.5812; train_optim_loss: 3694768.5812; val_kl_reg_loss: 19598.3147; val_edge_recon_loss: 1814609.0587; val_gene_expr_recon_loss: 1929964.7519; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3764172.1136; val_optim_loss: 3764172.1136
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9589; val_auprc_score: 0.9721; val_best_acc_score: 0.9197; val_best_f1_score: 0.9412; train_kl_reg_loss: 19745.2339; train_edge_recon_loss: 1751588.6690; train_gene_expr_recon_loss: 1911575.4605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3682909.3639; train_optim_loss: 3682909.3639; val_kl_reg_loss: 19955.9417; val_edge_recon_loss: 1824690.1515; val_gene_expr_recon_loss: 1917969.3485; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3762615.4508; val_optim_loss: 3762615.4508
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9615; val_auprc_score: 0.9740; val_best_acc_score: 0.9220; val_best_f1_score: 0.9427; train_kl_reg_loss: 19870.0233; train_edge_recon_loss: 1760506.4972; train_gene_expr_recon_loss: 1900368.5045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3680745.0302; train_optim_loss: 3680745.0302; val_kl_reg_loss: 20288.0423; val_edge_recon_loss: 1821512.5076; val_gene_expr_recon_loss: 1910550.5057; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3752351.0682; val_optim_loss: 3752351.0682
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9627; val_auprc_score: 0.9750; val_best_acc_score: 0.9266; val_best_f1_score: 0.9462; train_kl_reg_loss: 20009.4963; train_edge_recon_loss: 1757591.4035; train_gene_expr_recon_loss: 1894929.5914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3672530.4915; train_optim_loss: 3672530.4915; val_kl_reg_loss: 20411.3454; val_edge_recon_loss: 1802021.9337; val_gene_expr_recon_loss: 1908497.1629; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3730930.4356; val_optim_loss: 3730930.4356
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9631; val_auprc_score: 0.9745; val_best_acc_score: 0.9253; val_best_f1_score: 0.9450; train_kl_reg_loss: 20042.8422; train_edge_recon_loss: 1752480.5506; train_gene_expr_recon_loss: 1884774.2341; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3657297.6224; train_optim_loss: 3657297.6224; val_kl_reg_loss: 20498.3963; val_edge_recon_loss: 1812953.9678; val_gene_expr_recon_loss: 1904032.5966; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3737484.9545; val_optim_loss: 3737484.9545
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9620; val_auprc_score: 0.9744; val_best_acc_score: 0.9235; val_best_f1_score: 0.9441; train_kl_reg_loss: 20193.2599; train_edge_recon_loss: 1756756.4086; train_gene_expr_recon_loss: 1885760.6769; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3662710.3363; train_optim_loss: 3662710.3363; val_kl_reg_loss: 20612.3467; val_edge_recon_loss: 1815594.8163; val_gene_expr_recon_loss: 1900221.0322; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3736428.1742; val_optim_loss: 3736428.1742
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9647; val_auprc_score: 0.9765; val_best_acc_score: 0.9266; val_best_f1_score: 0.9462; train_kl_reg_loss: 20211.5401; train_edge_recon_loss: 1756537.7017; train_gene_expr_recon_loss: 1876915.6973; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3653664.9371; train_optim_loss: 3653664.9371; val_kl_reg_loss: 20379.8162; val_edge_recon_loss: 1807620.7424; val_gene_expr_recon_loss: 1899845.1799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3727845.7462; val_optim_loss: 3727845.7462
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9663; val_auprc_score: 0.9775; val_best_acc_score: 0.9275; val_best_f1_score: 0.9466; train_kl_reg_loss: 20341.8475; train_edge_recon_loss: 1756697.3244; train_gene_expr_recon_loss: 1875027.6505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3652066.8189; train_optim_loss: 3652066.8189; val_kl_reg_loss: 20580.6243; val_edge_recon_loss: 1816465.1477; val_gene_expr_recon_loss: 1889951.4659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3726997.2348; val_optim_loss: 3726997.2348
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9642; val_auprc_score: 0.9758; val_best_acc_score: 0.9266; val_best_f1_score: 0.9461; train_kl_reg_loss: 20609.8297; train_edge_recon_loss: 1757558.1420; train_gene_expr_recon_loss: 1868442.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3646610.7445; train_optim_loss: 3646610.7445; val_kl_reg_loss: 21023.0411; val_edge_recon_loss: 1805877.5890; val_gene_expr_recon_loss: 1892515.9413; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3719416.5758; val_optim_loss: 3719416.5758
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9651; val_auprc_score: 0.9766; val_best_acc_score: 0.9271; val_best_f1_score: 0.9464; train_kl_reg_loss: 20450.5743; train_edge_recon_loss: 1755417.4218; train_gene_expr_recon_loss: 1864698.7983; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3640566.7929; train_optim_loss: 3640566.7929; val_kl_reg_loss: 20763.7414; val_edge_recon_loss: 1807163.8598; val_gene_expr_recon_loss: 1890775.4129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3718703.0076; val_optim_loss: 3718703.0076
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9655; val_auprc_score: 0.9775; val_best_acc_score: 0.9280; val_best_f1_score: 0.9472; train_kl_reg_loss: 20809.1770; train_edge_recon_loss: 1754677.3000; train_gene_expr_recon_loss: 1863054.9794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3638541.4583; train_optim_loss: 3638541.4583; val_kl_reg_loss: 20614.9090; val_edge_recon_loss: 1800755.8845; val_gene_expr_recon_loss: 1883377.0909; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3704747.8902; val_optim_loss: 3704747.8902
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9652; val_auprc_score: 0.9770; val_best_acc_score: 0.9260; val_best_f1_score: 0.9456; train_kl_reg_loss: 20752.4186; train_edge_recon_loss: 1755568.5128; train_gene_expr_recon_loss: 1860529.8153; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3636850.7457; train_optim_loss: 3636850.7457; val_kl_reg_loss: 20772.0153; val_edge_recon_loss: 1804325.8958; val_gene_expr_recon_loss: 1888746.1761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3713844.0871; val_optim_loss: 3713844.0871
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9668; val_auprc_score: 0.9782; val_best_acc_score: 0.9281; val_best_f1_score: 0.9472; train_kl_reg_loss: 20826.4373; train_edge_recon_loss: 1753286.2015; train_gene_expr_recon_loss: 1854071.6828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3628184.3214; train_optim_loss: 3628184.3214; val_kl_reg_loss: 20754.9812; val_edge_recon_loss: 1815326.4318; val_gene_expr_recon_loss: 1875903.1932; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3711984.6023; val_optim_loss: 3711984.6023
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9629; val_auprc_score: 0.9755; val_best_acc_score: 0.9248; val_best_f1_score: 0.9447; train_kl_reg_loss: 20935.8972; train_edge_recon_loss: 1749642.2147; train_gene_expr_recon_loss: 1848451.6135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3619029.7262; train_optim_loss: 3619029.7262; val_kl_reg_loss: 21086.6565; val_edge_recon_loss: 1809809.0322; val_gene_expr_recon_loss: 1877190.3371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3708086.0492; val_optim_loss: 3708086.0492
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9653; val_auprc_score: 0.9763; val_best_acc_score: 0.9286; val_best_f1_score: 0.9477; train_kl_reg_loss: 21176.1320; train_edge_recon_loss: 1757857.0619; train_gene_expr_recon_loss: 1853290.0706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3632323.2657; train_optim_loss: 3632323.2657; val_kl_reg_loss: 21500.6356; val_edge_recon_loss: 1808287.4697; val_gene_expr_recon_loss: 1878690.8580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3708478.9735; val_optim_loss: 3708478.9735

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9669; val_auprc_score: 0.9778; val_best_acc_score: 0.9314; val_best_f1_score: 0.9494; train_kl_reg_loss: 20891.6472; train_edge_recon_loss: 1749089.8057; train_gene_expr_recon_loss: 1823318.9454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3593300.4052; train_optim_loss: 3593300.4052; val_kl_reg_loss: 20663.6606; val_edge_recon_loss: 1799933.7330; val_gene_expr_recon_loss: 1858081.1307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3678678.5152; val_optim_loss: 3678678.5152
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9681; val_auprc_score: 0.9788; val_best_acc_score: 0.9314; val_best_f1_score: 0.9495; train_kl_reg_loss: 20806.9270; train_edge_recon_loss: 1748740.4515; train_gene_expr_recon_loss: 1820190.0553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3589737.4337; train_optim_loss: 3589737.4337; val_kl_reg_loss: 20897.1728; val_edge_recon_loss: 1800300.4924; val_gene_expr_recon_loss: 1855294.5095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3676492.1705; val_optim_loss: 3676492.1705
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9669; val_auprc_score: 0.9779; val_best_acc_score: 0.9322; val_best_f1_score: 0.9504; train_kl_reg_loss: 20822.6943; train_edge_recon_loss: 1753089.7560; train_gene_expr_recon_loss: 1817856.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3591768.8414; train_optim_loss: 3591768.8414; val_kl_reg_loss: 21070.4105; val_edge_recon_loss: 1787362.7538; val_gene_expr_recon_loss: 1853367.9091; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3661801.0682; val_optim_loss: 3661801.0682
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9696; val_auprc_score: 0.9804; val_best_acc_score: 0.9327; val_best_f1_score: 0.9508; train_kl_reg_loss: 20869.5586; train_edge_recon_loss: 1750242.6122; train_gene_expr_recon_loss: 1816707.8442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3587820.0068; train_optim_loss: 3587820.0068; val_kl_reg_loss: 20775.7708; val_edge_recon_loss: 1787064.1364; val_gene_expr_recon_loss: 1855216.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3663056.7008; val_optim_loss: 3663056.7008
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9673; val_auprc_score: 0.9780; val_best_acc_score: 0.9320; val_best_f1_score: 0.9500; train_kl_reg_loss: 20680.4278; train_edge_recon_loss: 1749363.2330; train_gene_expr_recon_loss: 1815589.3138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3585632.9813; train_optim_loss: 3585632.9813; val_kl_reg_loss: 20829.7762; val_edge_recon_loss: 1792148.5663; val_gene_expr_recon_loss: 1851608.2860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3664586.6174; val_optim_loss: 3664586.6174
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9692; val_auprc_score: 0.9790; val_best_acc_score: 0.9344; val_best_f1_score: 0.9516; train_kl_reg_loss: 20675.7900; train_edge_recon_loss: 1751739.2440; train_gene_expr_recon_loss: 1814108.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3586523.2649; train_optim_loss: 3586523.2649; val_kl_reg_loss: 20645.2270; val_edge_recon_loss: 1797563.1723; val_gene_expr_recon_loss: 1849529.4053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3667737.8068; val_optim_loss: 3667737.8068
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9669; val_auprc_score: 0.9774; val_best_acc_score: 0.9313; val_best_f1_score: 0.9494; train_kl_reg_loss: 20524.3691; train_edge_recon_loss: 1750230.1405; train_gene_expr_recon_loss: 1813010.3886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3583764.9026; train_optim_loss: 3583764.9026; val_kl_reg_loss: 20647.9745; val_edge_recon_loss: 1804041.0057; val_gene_expr_recon_loss: 1850586.3390; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3675275.3106; val_optim_loss: 3675275.3106

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9677; val_auprc_score: 0.9780; val_best_acc_score: 0.9334; val_best_f1_score: 0.9511; train_kl_reg_loss: 20554.0706; train_edge_recon_loss: 1748167.9866; train_gene_expr_recon_loss: 1809260.4330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3577982.4821; train_optim_loss: 3577982.4821; val_kl_reg_loss: 20605.1534; val_edge_recon_loss: 1790535.4110; val_gene_expr_recon_loss: 1850162.6496; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3661303.2121; val_optim_loss: 3661303.2121
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9692; val_auprc_score: 0.9797; val_best_acc_score: 0.9343; val_best_f1_score: 0.9516; train_kl_reg_loss: 20519.4995; train_edge_recon_loss: 1748829.9107; train_gene_expr_recon_loss: 1809477.4094; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578826.8295; train_optim_loss: 3578826.8295; val_kl_reg_loss: 20553.3758; val_edge_recon_loss: 1796572.8125; val_gene_expr_recon_loss: 1848830.7254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3665956.9508; val_optim_loss: 3665956.9508
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9682; val_auprc_score: 0.9787; val_best_acc_score: 0.9331; val_best_f1_score: 0.9509; train_kl_reg_loss: 20514.0664; train_edge_recon_loss: 1750762.5206; train_gene_expr_recon_loss: 1810031.4145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3581307.9983; train_optim_loss: 3581307.9983; val_kl_reg_loss: 20561.0186; val_edge_recon_loss: 1791004.0606; val_gene_expr_recon_loss: 1851187.6799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3662752.7652; val_optim_loss: 3662752.7652
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9672; val_auprc_score: 0.9781; val_best_acc_score: 0.9318; val_best_f1_score: 0.9499; train_kl_reg_loss: 20500.2516; train_edge_recon_loss: 1745892.6229; train_gene_expr_recon_loss: 1808464.2838; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3574857.1590; train_optim_loss: 3574857.1590; val_kl_reg_loss: 20581.3428; val_edge_recon_loss: 1790913.2348; val_gene_expr_recon_loss: 1848249.2216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3659743.7727; val_optim_loss: 3659743.7727
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9682; val_auprc_score: 0.9785; val_best_acc_score: 0.9330; val_best_f1_score: 0.9507; train_kl_reg_loss: 20513.9848; train_edge_recon_loss: 1747082.4902; train_gene_expr_recon_loss: 1808307.6628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3575904.1399; train_optim_loss: 3575904.1399; val_kl_reg_loss: 20578.4613; val_edge_recon_loss: 1793961.6610; val_gene_expr_recon_loss: 1848456.8428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3662996.9848; val_optim_loss: 3662996.9848
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9690; val_auprc_score: 0.9796; val_best_acc_score: 0.9327; val_best_f1_score: 0.9507; train_kl_reg_loss: 20463.6752; train_edge_recon_loss: 1748740.6307; train_gene_expr_recon_loss: 1808992.4490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578196.7598; train_optim_loss: 3578196.7598; val_kl_reg_loss: 20522.8092; val_edge_recon_loss: 1789233.6572; val_gene_expr_recon_loss: 1850716.9735; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3660473.4356; val_optim_loss: 3660473.4356
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9680; val_auprc_score: 0.9789; val_best_acc_score: 0.9324; val_best_f1_score: 0.9504; train_kl_reg_loss: 20439.8118; train_edge_recon_loss: 1753865.9562; train_gene_expr_recon_loss: 1808533.2608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3582839.0353; train_optim_loss: 3582839.0353; val_kl_reg_loss: 20511.9857; val_edge_recon_loss: 1790221.0852; val_gene_expr_recon_loss: 1859466.5606; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3670199.6326; val_optim_loss: 3670199.6326
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9694; val_auprc_score: 0.9806; val_best_acc_score: 0.9335; val_best_f1_score: 0.9512; train_kl_reg_loss: 20429.2401; train_edge_recon_loss: 1751592.2251; train_gene_expr_recon_loss: 1809294.0466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3581315.5106; train_optim_loss: 3581315.5106; val_kl_reg_loss: 20418.3510; val_edge_recon_loss: 1788007.1155; val_gene_expr_recon_loss: 1849317.3201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657742.7917; val_optim_loss: 3657742.7917
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9691; val_auprc_score: 0.9792; val_best_acc_score: 0.9340; val_best_f1_score: 0.9514; train_kl_reg_loss: 20368.4697; train_edge_recon_loss: 1749989.7132; train_gene_expr_recon_loss: 1808519.2630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578877.4477; train_optim_loss: 3578877.4477; val_kl_reg_loss: 20456.3043; val_edge_recon_loss: 1791505.0038; val_gene_expr_recon_loss: 1848705.1155; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3660666.4167; val_optim_loss: 3660666.4167
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9688; val_auprc_score: 0.9792; val_best_acc_score: 0.9337; val_best_f1_score: 0.9512; train_kl_reg_loss: 20394.6951; train_edge_recon_loss: 1749011.7362; train_gene_expr_recon_loss: 1809119.8412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578526.2717; train_optim_loss: 3578526.2717; val_kl_reg_loss: 20419.0444; val_edge_recon_loss: 1782677.0189; val_gene_expr_recon_loss: 1846424.5265; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3649520.6098; val_optim_loss: 3649520.6098
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9689; val_auprc_score: 0.9799; val_best_acc_score: 0.9337; val_best_f1_score: 0.9514; train_kl_reg_loss: 20382.4117; train_edge_recon_loss: 1750258.0036; train_gene_expr_recon_loss: 1808460.5536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3579100.9694; train_optim_loss: 3579100.9694; val_kl_reg_loss: 20406.7360; val_edge_recon_loss: 1787304.3958; val_gene_expr_recon_loss: 1849072.0985; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3656783.2197; val_optim_loss: 3656783.2197
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9693; val_auprc_score: 0.9797; val_best_acc_score: 0.9333; val_best_f1_score: 0.9507; train_kl_reg_loss: 20384.4259; train_edge_recon_loss: 1750951.6227; train_gene_expr_recon_loss: 1808001.8588; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3579337.9107; train_optim_loss: 3579337.9107; val_kl_reg_loss: 20482.2648; val_edge_recon_loss: 1806846.4848; val_gene_expr_recon_loss: 1858764.6970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3686093.4508; val_optim_loss: 3686093.4508
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9688; val_auprc_score: 0.9800; val_best_acc_score: 0.9327; val_best_f1_score: 0.9506; train_kl_reg_loss: 20410.0969; train_edge_recon_loss: 1748562.9031; train_gene_expr_recon_loss: 1807880.7940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3576853.7934; train_optim_loss: 3576853.7934; val_kl_reg_loss: 20472.5264; val_edge_recon_loss: 1792357.7822; val_gene_expr_recon_loss: 1850768.2102; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3663598.5189; val_optim_loss: 3663598.5189
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9686; val_auprc_score: 0.9791; val_best_acc_score: 0.9342; val_best_f1_score: 0.9515; train_kl_reg_loss: 20400.1602; train_edge_recon_loss: 1748028.8053; train_gene_expr_recon_loss: 1807687.2447; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3576116.2088; train_optim_loss: 3576116.2088; val_kl_reg_loss: 20456.6256; val_edge_recon_loss: 1790351.5038; val_gene_expr_recon_loss: 1848817.0095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3659625.1136; val_optim_loss: 3659625.1136

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9682; val_auprc_score: 0.9784; val_best_acc_score: 0.9332; val_best_f1_score: 0.9508; train_kl_reg_loss: 20375.1785; train_edge_recon_loss: 1751785.2168; train_gene_expr_recon_loss: 1807981.8714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3580142.2653; train_optim_loss: 3580142.2653; val_kl_reg_loss: 20420.0036; val_edge_recon_loss: 1802594.2917; val_gene_expr_recon_loss: 1845958.1080; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3668972.3788; val_optim_loss: 3668972.3788
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9696; val_auprc_score: 0.9797; val_best_acc_score: 0.9343; val_best_f1_score: 0.9515; train_kl_reg_loss: 20373.9504; train_edge_recon_loss: 1750018.3818; train_gene_expr_recon_loss: 1807850.6473; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3578242.9800; train_optim_loss: 3578242.9800; val_kl_reg_loss: 20437.1890; val_edge_recon_loss: 1802512.7330; val_gene_expr_recon_loss: 1854341.8371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3677291.7614; val_optim_loss: 3677291.7614
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9681; val_auprc_score: 0.9787; val_best_acc_score: 0.9329; val_best_f1_score: 0.9506; train_kl_reg_loss: 20383.0807; train_edge_recon_loss: 1747326.2961; train_gene_expr_recon_loss: 1808338.0308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3576047.4077; train_optim_loss: 3576047.4077; val_kl_reg_loss: 20455.9873; val_edge_recon_loss: 1796753.0587; val_gene_expr_recon_loss: 1846506.2443; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3663715.2879; val_optim_loss: 3663715.2879
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9663; val_auprc_score: 0.9773; val_best_acc_score: 0.9315; val_best_f1_score: 0.9495; train_kl_reg_loss: 20385.5870; train_edge_recon_loss: 1749623.7385; train_gene_expr_recon_loss: 1807434.3046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3577443.6339; train_optim_loss: 3577443.6339; val_kl_reg_loss: 20452.8752; val_edge_recon_loss: 1801648.0833; val_gene_expr_recon_loss: 1848160.3788; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3670261.3333; val_optim_loss: 3670261.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 269 min 47 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9674
val AUPRC score: 0.9785
val best accuracy score: 0.9320
val best F1 score: 0.9502
val target rna MSE score: 0.9886
val source rna MSE score: 0.1132
Val cat covariate0 mean sim diff: -0.0005
Val cat covariate1 mean sim diff: -0.1094

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
