[True]
Run timestamp: 10102023_030507_122.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_122']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7567; val_auprc_score: 0.7815; val_best_acc_score: 0.5571; val_best_f1_score: 0.6892; train_kl_reg_loss: 65647.4815; train_edge_recon_loss: 3511529.2424; train_gene_expr_recon_loss: 13410052.3740; train_masked_gp_l1_reg_loss: 117040.7812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2689787.6684; train_chrom_access_recon_loss: 4752264.0687; train_global_loss: 24546321.6336; train_optim_loss: 24546321.6336; val_kl_reg_loss: 87044.1740; val_edge_recon_loss: 4062145.3000; val_gene_expr_recon_loss: 12561078.6000; val_masked_gp_l1_reg_loss: 99621.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 366257.0625; val_chrom_access_recon_loss: 4577374.4667; val_global_loss: 21753522.1333; val_optim_loss: 21753522.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8215; val_auprc_score: 0.8277; val_best_acc_score: 0.7278; val_best_f1_score: 0.7519; train_kl_reg_loss: 83987.4861; train_edge_recon_loss: 3499286.0324; train_gene_expr_recon_loss: 12632489.1221; train_masked_gp_l1_reg_loss: 99084.0268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 201083.6531; train_chrom_access_recon_loss: 4583263.2824; train_global_loss: 21099193.4962; train_optim_loss: 21099193.4962; val_kl_reg_loss: 74331.0271; val_edge_recon_loss: 3830284.0167; val_gene_expr_recon_loss: 12334174.2000; val_masked_gp_l1_reg_loss: 100755.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129988.0078; val_chrom_access_recon_loss: 4534061.7833; val_global_loss: 21003594.0000; val_optim_loss: 21003594.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8603; val_auprc_score: 0.8554; val_best_acc_score: 0.7625; val_best_f1_score: 0.7866; train_kl_reg_loss: 88813.5239; train_edge_recon_loss: 3133695.1775; train_gene_expr_recon_loss: 12490759.1450; train_masked_gp_l1_reg_loss: 106703.4516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108753.9321; train_chrom_access_recon_loss: 4535280.7252; train_global_loss: 20464005.8473; train_optim_loss: 20464005.8473; val_kl_reg_loss: 104724.6005; val_edge_recon_loss: 3016947.1667; val_gene_expr_recon_loss: 12303817.6667; val_masked_gp_l1_reg_loss: 111534.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94073.6875; val_chrom_access_recon_loss: 4508462.8167; val_global_loss: 20139561.3333; val_optim_loss: 20139561.3333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8980; val_auprc_score: 0.8842; val_best_acc_score: 0.8116; val_best_f1_score: 0.8233; train_kl_reg_loss: 98429.3565; train_edge_recon_loss: 2899028.0363; train_gene_expr_recon_loss: 12347289.4046; train_masked_gp_l1_reg_loss: 114174.6718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87619.2840; train_chrom_access_recon_loss: 4482393.2786; train_global_loss: 20028934.0611; train_optim_loss: 20028934.0611; val_kl_reg_loss: 100048.5943; val_edge_recon_loss: 2885132.8667; val_gene_expr_recon_loss: 12146063.2000; val_masked_gp_l1_reg_loss: 116212.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84489.5078; val_chrom_access_recon_loss: 4460039.7667; val_global_loss: 19791987.7333; val_optim_loss: 19791987.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9124; val_auprc_score: 0.8968; val_best_acc_score: 0.8371; val_best_f1_score: 0.8451; train_kl_reg_loss: 98948.1398; train_edge_recon_loss: 2839919.8340; train_gene_expr_recon_loss: 12221200.0916; train_masked_gp_l1_reg_loss: 117802.4493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83362.4961; train_chrom_access_recon_loss: 4447198.4733; train_global_loss: 19808431.5115; train_optim_loss: 19808431.5115; val_kl_reg_loss: 98344.2151; val_edge_recon_loss: 2840127.5500; val_gene_expr_recon_loss: 11986997.0667; val_masked_gp_l1_reg_loss: 118806.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83501.6016; val_chrom_access_recon_loss: 4404883.3333; val_global_loss: 19532661.2000; val_optim_loss: 19532661.2000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9249; val_auprc_score: 0.9097; val_best_acc_score: 0.8560; val_best_f1_score: 0.8628; train_kl_reg_loss: 96253.4153; train_edge_recon_loss: 2820658.9294; train_gene_expr_recon_loss: 12132943.1374; train_masked_gp_l1_reg_loss: 120131.6249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83645.8444; train_chrom_access_recon_loss: 4420251.6317; train_global_loss: 19673884.5802; train_optim_loss: 19673884.5802; val_kl_reg_loss: 95383.9990; val_edge_recon_loss: 2820901.4833; val_gene_expr_recon_loss: 11856575.2000; val_masked_gp_l1_reg_loss: 121597.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83851.3828; val_chrom_access_recon_loss: 4363129.7500; val_global_loss: 19341439.6000; val_optim_loss: 19341439.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9342; val_auprc_score: 0.9195; val_best_acc_score: 0.8669; val_best_f1_score: 0.8740; train_kl_reg_loss: 95224.8497; train_edge_recon_loss: 2797211.0763; train_gene_expr_recon_loss: 12028328.4733; train_masked_gp_l1_reg_loss: 122301.2301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83787.7195; train_chrom_access_recon_loss: 4385871.1183; train_global_loss: 19512724.4580; train_optim_loss: 19512724.4580; val_kl_reg_loss: 93966.2609; val_edge_recon_loss: 2809384.3500; val_gene_expr_recon_loss: 11814094.8667; val_masked_gp_l1_reg_loss: 123525.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83979.9531; val_chrom_access_recon_loss: 4334329.5667; val_global_loss: 19259279.8667; val_optim_loss: 19259279.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9391; val_auprc_score: 0.9234; val_best_acc_score: 0.8773; val_best_f1_score: 0.8824; train_kl_reg_loss: 93569.9274; train_edge_recon_loss: 2785228.7481; train_gene_expr_recon_loss: 11951135.5115; train_masked_gp_l1_reg_loss: 124137.2600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82912.1527; train_chrom_access_recon_loss: 4363761.2748; train_global_loss: 19400744.7176; train_optim_loss: 19400744.7176; val_kl_reg_loss: 94503.5568; val_edge_recon_loss: 2787646.0333; val_gene_expr_recon_loss: 11754716.6667; val_masked_gp_l1_reg_loss: 124919.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82516.2734; val_chrom_access_recon_loss: 4331053.4667; val_global_loss: 19175354.8000; val_optim_loss: 19175354.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9414; val_auprc_score: 0.9286; val_best_acc_score: 0.8790; val_best_f1_score: 0.8854; train_kl_reg_loss: 94575.7099; train_edge_recon_loss: 2767302.8740; train_gene_expr_recon_loss: 11888752.5802; train_masked_gp_l1_reg_loss: 125382.6385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81074.8659; train_chrom_access_recon_loss: 4340170.8111; train_global_loss: 19297259.2977; train_optim_loss: 19297259.2977; val_kl_reg_loss: 94075.8750; val_edge_recon_loss: 2778620.8500; val_gene_expr_recon_loss: 11646419.5333; val_masked_gp_l1_reg_loss: 125671.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80181.2031; val_chrom_access_recon_loss: 4306827.6333; val_global_loss: 19031795.7333; val_optim_loss: 19031795.7333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9411; val_auprc_score: 0.9271; val_best_acc_score: 0.8759; val_best_f1_score: 0.8820; train_kl_reg_loss: 92883.0721; train_edge_recon_loss: 2755875.5076; train_gene_expr_recon_loss: 11829979.0611; train_masked_gp_l1_reg_loss: 125962.8390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79459.7286; train_chrom_access_recon_loss: 4314299.3092; train_global_loss: 19198459.4809; train_optim_loss: 19198459.4809; val_kl_reg_loss: 93313.1990; val_edge_recon_loss: 2779819.0000; val_gene_expr_recon_loss: 11585087.8667; val_masked_gp_l1_reg_loss: 126269.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78478.5000; val_chrom_access_recon_loss: 4262720.5333; val_global_loss: 18925688.6667; val_optim_loss: 18925688.6667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9448; val_auprc_score: 0.9327; val_best_acc_score: 0.8822; val_best_f1_score: 0.8893; train_kl_reg_loss: 93049.6083; train_edge_recon_loss: 2744949.1527; train_gene_expr_recon_loss: 11770739.0534; train_masked_gp_l1_reg_loss: 126404.6722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78166.1257; train_chrom_access_recon_loss: 4290434.2214; train_global_loss: 19103742.9924; train_optim_loss: 19103742.9924; val_kl_reg_loss: 91864.4276; val_edge_recon_loss: 2769660.9667; val_gene_expr_recon_loss: 11622965.4667; val_masked_gp_l1_reg_loss: 126398.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77658.2734; val_chrom_access_recon_loss: 4274523.2167; val_global_loss: 18963070.2667; val_optim_loss: 18963070.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9453; val_auprc_score: 0.9306; val_best_acc_score: 0.8826; val_best_f1_score: 0.8875; train_kl_reg_loss: 90216.2921; train_edge_recon_loss: 2741591.0115; train_gene_expr_recon_loss: 11734401.1374; train_masked_gp_l1_reg_loss: 126591.3086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77379.6480; train_chrom_access_recon_loss: 4279253.7538; train_global_loss: 19049432.9924; train_optim_loss: 19049432.9924; val_kl_reg_loss: 88302.8755; val_edge_recon_loss: 2768596.4667; val_gene_expr_recon_loss: 11561677.9333; val_masked_gp_l1_reg_loss: 127077.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77550.1953; val_chrom_access_recon_loss: 4271483.4000; val_global_loss: 18894688.5333; val_optim_loss: 18894688.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9505; val_auprc_score: 0.9400; val_best_acc_score: 0.8899; val_best_f1_score: 0.8941; train_kl_reg_loss: 91810.1879; train_edge_recon_loss: 2740983.4427; train_gene_expr_recon_loss: 11683205.7557; train_masked_gp_l1_reg_loss: 126605.8229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76875.3216; train_chrom_access_recon_loss: 4258597.2882; train_global_loss: 18978077.8779; train_optim_loss: 18978077.8779; val_kl_reg_loss: 94408.2984; val_edge_recon_loss: 2741816.5167; val_gene_expr_recon_loss: 11501184.0667; val_masked_gp_l1_reg_loss: 126740.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77135.0391; val_chrom_access_recon_loss: 4221859.5000; val_global_loss: 18763143.6000; val_optim_loss: 18763143.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9511; val_auprc_score: 0.9403; val_best_acc_score: 0.8902; val_best_f1_score: 0.8960; train_kl_reg_loss: 90380.9571; train_edge_recon_loss: 2737527.9466; train_gene_expr_recon_loss: 11649862.1756; train_masked_gp_l1_reg_loss: 126630.2248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76901.7799; train_chrom_access_recon_loss: 4245903.1221; train_global_loss: 18927206.1374; train_optim_loss: 18927206.1374; val_kl_reg_loss: 88232.1344; val_edge_recon_loss: 2745844.7000; val_gene_expr_recon_loss: 11445720.2000; val_masked_gp_l1_reg_loss: 126872.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77246.3828; val_chrom_access_recon_loss: 4204944.4500; val_global_loss: 18688859.6000; val_optim_loss: 18688859.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9541; val_auprc_score: 0.9433; val_best_acc_score: 0.8946; val_best_f1_score: 0.8978; train_kl_reg_loss: 87740.8647; train_edge_recon_loss: 2737397.7557; train_gene_expr_recon_loss: 11602185.3359; train_masked_gp_l1_reg_loss: 127105.2276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78024.6416; train_chrom_access_recon_loss: 4227283.4943; train_global_loss: 18859737.3740; train_optim_loss: 18859737.3740; val_kl_reg_loss: 90482.9818; val_edge_recon_loss: 2755620.2000; val_gene_expr_recon_loss: 11442401.0000; val_masked_gp_l1_reg_loss: 127789.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78391.7734; val_chrom_access_recon_loss: 4207359.0000; val_global_loss: 18702044.2667; val_optim_loss: 18702044.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9576; val_auprc_score: 0.9461; val_best_acc_score: 0.8983; val_best_f1_score: 0.9025; train_kl_reg_loss: 88750.7916; train_edge_recon_loss: 2724913.7653; train_gene_expr_recon_loss: 11582090.0687; train_masked_gp_l1_reg_loss: 127301.3112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78352.3963; train_chrom_access_recon_loss: 4216502.2920; train_global_loss: 18817910.5802; train_optim_loss: 18817910.5802; val_kl_reg_loss: 88754.9391; val_edge_recon_loss: 2737715.8833; val_gene_expr_recon_loss: 11328168.6000; val_masked_gp_l1_reg_loss: 127314.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78942.6875; val_chrom_access_recon_loss: 4162772.0833; val_global_loss: 18523668.6667; val_optim_loss: 18523668.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9574; val_auprc_score: 0.9478; val_best_acc_score: 0.8985; val_best_f1_score: 0.9029; train_kl_reg_loss: 88515.8557; train_edge_recon_loss: 2727653.6565; train_gene_expr_recon_loss: 11543324.2290; train_masked_gp_l1_reg_loss: 127208.0150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78591.1042; train_chrom_access_recon_loss: 4198159.9103; train_global_loss: 18763452.8550; train_optim_loss: 18763452.8550; val_kl_reg_loss: 90722.7948; val_edge_recon_loss: 2747958.9333; val_gene_expr_recon_loss: 11378151.2667; val_masked_gp_l1_reg_loss: 127224.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78706.3750; val_chrom_access_recon_loss: 4172016.7833; val_global_loss: 18594779.8667; val_optim_loss: 18594779.8667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9610; val_auprc_score: 0.9489; val_best_acc_score: 0.9030; val_best_f1_score: 0.9069; train_kl_reg_loss: 86404.7117; train_edge_recon_loss: 2721975.0840; train_gene_expr_recon_loss: 11508900.1679; train_masked_gp_l1_reg_loss: 126943.2383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78536.8503; train_chrom_access_recon_loss: 4182257.8359; train_global_loss: 18705018.0000; train_optim_loss: 18705018.0000; val_kl_reg_loss: 86957.2651; val_edge_recon_loss: 2741906.4500; val_gene_expr_recon_loss: 11274108.4667; val_masked_gp_l1_reg_loss: 127059.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78395.5391; val_chrom_access_recon_loss: 4121994.9667; val_global_loss: 18430422.8000; val_optim_loss: 18430422.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9648; val_auprc_score: 0.9556; val_best_acc_score: 0.9123; val_best_f1_score: 0.9148; train_kl_reg_loss: 87151.3341; train_edge_recon_loss: 2719543.1183; train_gene_expr_recon_loss: 11476857.4427; train_masked_gp_l1_reg_loss: 126694.2595; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78283.5494; train_chrom_access_recon_loss: 4170908.7061; train_global_loss: 18659438.3511; train_optim_loss: 18659438.3511; val_kl_reg_loss: 86906.0615; val_edge_recon_loss: 2718153.8000; val_gene_expr_recon_loss: 11241345.4000; val_masked_gp_l1_reg_loss: 126287.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77858.7344; val_chrom_access_recon_loss: 4119385.4333; val_global_loss: 18369937.7333; val_optim_loss: 18369937.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9661; val_auprc_score: 0.9561; val_best_acc_score: 0.9112; val_best_f1_score: 0.9134; train_kl_reg_loss: 87427.9996; train_edge_recon_loss: 2712917.6031; train_gene_expr_recon_loss: 11463298.2137; train_masked_gp_l1_reg_loss: 126084.3555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77942.1650; train_chrom_access_recon_loss: 4159230.6641; train_global_loss: 18626901.0534; train_optim_loss: 18626901.0534; val_kl_reg_loss: 86197.3484; val_edge_recon_loss: 2717687.4167; val_gene_expr_recon_loss: 11279632.9333; val_masked_gp_l1_reg_loss: 126034.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78462.2812; val_chrom_access_recon_loss: 4129397.1167; val_global_loss: 18417410.6667; val_optim_loss: 18417410.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9649; val_auprc_score: 0.9545; val_best_acc_score: 0.9119; val_best_f1_score: 0.9145; train_kl_reg_loss: 87439.0565; train_edge_recon_loss: 2704069.7042; train_gene_expr_recon_loss: 11440840.2977; train_masked_gp_l1_reg_loss: 125735.6653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77973.2279; train_chrom_access_recon_loss: 4143359.8779; train_global_loss: 18579417.7863; train_optim_loss: 18579417.7863; val_kl_reg_loss: 89763.7026; val_edge_recon_loss: 2708810.8833; val_gene_expr_recon_loss: 11295588.9333; val_masked_gp_l1_reg_loss: 125310.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77620.8672; val_chrom_access_recon_loss: 4124161.3667; val_global_loss: 18421255.7333; val_optim_loss: 18421255.7333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9691; val_auprc_score: 0.9626; val_best_acc_score: 0.9117; val_best_f1_score: 0.9159; train_kl_reg_loss: 85308.0420; train_edge_recon_loss: 2713570.2710; train_gene_expr_recon_loss: 11413640.8779; train_masked_gp_l1_reg_loss: 125083.1465; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77911.8403; train_chrom_access_recon_loss: 4131764.6851; train_global_loss: 18547278.8092; train_optim_loss: 18547278.8092; val_kl_reg_loss: 85529.6760; val_edge_recon_loss: 2710056.1833; val_gene_expr_recon_loss: 11220652.7333; val_masked_gp_l1_reg_loss: 125372.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78959.1484; val_chrom_access_recon_loss: 4103384.1833; val_global_loss: 18323953.7333; val_optim_loss: 18323953.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9698; val_auprc_score: 0.9608; val_best_acc_score: 0.9166; val_best_f1_score: 0.9194; train_kl_reg_loss: 84508.1158; train_edge_recon_loss: 2715684.2156; train_gene_expr_recon_loss: 11401582.7481; train_masked_gp_l1_reg_loss: 124769.1809; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78141.4399; train_chrom_access_recon_loss: 4119417.2595; train_global_loss: 18524102.9160; train_optim_loss: 18524102.9160; val_kl_reg_loss: 86193.8995; val_edge_recon_loss: 2708502.2667; val_gene_expr_recon_loss: 11184589.2000; val_masked_gp_l1_reg_loss: 124590.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78480.1484; val_chrom_access_recon_loss: 4091067.1000; val_global_loss: 18273423.2000; val_optim_loss: 18273423.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9682; val_auprc_score: 0.9582; val_best_acc_score: 0.9184; val_best_f1_score: 0.9216; train_kl_reg_loss: 85489.3419; train_edge_recon_loss: 2702408.7004; train_gene_expr_recon_loss: 11385060.0305; train_masked_gp_l1_reg_loss: 124235.8689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77825.5623; train_chrom_access_recon_loss: 4109408.2939; train_global_loss: 18484427.7405; train_optim_loss: 18484427.7405; val_kl_reg_loss: 86048.4797; val_edge_recon_loss: 2719766.5833; val_gene_expr_recon_loss: 11212409.0000; val_masked_gp_l1_reg_loss: 124088.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77963.2812; val_chrom_access_recon_loss: 4110625.8167; val_global_loss: 18330901.3333; val_optim_loss: 18330901.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9707; val_auprc_score: 0.9653; val_best_acc_score: 0.9170; val_best_f1_score: 0.9215; train_kl_reg_loss: 84932.0562; train_edge_recon_loss: 2698955.9218; train_gene_expr_recon_loss: 11380865.4580; train_masked_gp_l1_reg_loss: 123501.1185; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77794.5061; train_chrom_access_recon_loss: 4097948.2996; train_global_loss: 18463997.4046; train_optim_loss: 18463997.4046; val_kl_reg_loss: 84474.9505; val_edge_recon_loss: 2723472.7333; val_gene_expr_recon_loss: 11184927.9333; val_masked_gp_l1_reg_loss: 123711.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78153.2500; val_chrom_access_recon_loss: 4085575.4000; val_global_loss: 18280315.0667; val_optim_loss: 18280315.0667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9647; val_auprc_score: 0.9527; val_best_acc_score: 0.9077; val_best_f1_score: 0.9119; train_kl_reg_loss: 90575.3083; train_edge_recon_loss: 2754798.2118; train_gene_expr_recon_loss: 10743994.1756; train_masked_gp_l1_reg_loss: 122636.9837; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75113.4224; train_chrom_access_recon_loss: 3936967.6317; train_global_loss: 17724085.5802; train_optim_loss: 17724085.5802; val_kl_reg_loss: 49134.9930; val_edge_recon_loss: 2749103.0500; val_gene_expr_recon_loss: 10568834.2000; val_masked_gp_l1_reg_loss: 122085.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75421.9375; val_chrom_access_recon_loss: 3890847.7333; val_global_loss: 17455428.0000; val_optim_loss: 17455428.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9693; val_auprc_score: 0.9576; val_best_acc_score: 0.9167; val_best_f1_score: 0.9208; train_kl_reg_loss: 80797.2307; train_edge_recon_loss: 2716626.0725; train_gene_expr_recon_loss: 10692895.7405; train_masked_gp_l1_reg_loss: 120700.8978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75712.7858; train_chrom_access_recon_loss: 3905013.3397; train_global_loss: 17591746.1374; train_optim_loss: 17591746.1374; val_kl_reg_loss: 55616.2844; val_edge_recon_loss: 2736487.1333; val_gene_expr_recon_loss: 10501033.2000; val_masked_gp_l1_reg_loss: 119206.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75802.4453; val_chrom_access_recon_loss: 3868463.1500; val_global_loss: 17356607.4667; val_optim_loss: 17356607.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9710; val_auprc_score: 0.9616; val_best_acc_score: 0.9209; val_best_f1_score: 0.9234; train_kl_reg_loss: 76241.7034; train_edge_recon_loss: 2700766.2557; train_gene_expr_recon_loss: 10659582.4809; train_masked_gp_l1_reg_loss: 117591.6960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76107.2624; train_chrom_access_recon_loss: 3881052.7767; train_global_loss: 17511342.1832; train_optim_loss: 17511342.1832; val_kl_reg_loss: 58603.0536; val_edge_recon_loss: 2716496.2000; val_gene_expr_recon_loss: 10524214.9333; val_masked_gp_l1_reg_loss: 116166.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76088.2578; val_chrom_access_recon_loss: 3863447.4500; val_global_loss: 17355015.6000; val_optim_loss: 17355015.6000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9720; val_auprc_score: 0.9635; val_best_acc_score: 0.9214; val_best_f1_score: 0.9235; train_kl_reg_loss: 73760.1724; train_edge_recon_loss: 2702224.9008; train_gene_expr_recon_loss: 10619957.8779; train_masked_gp_l1_reg_loss: 114895.6993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76259.5543; train_chrom_access_recon_loss: 3869644.6374; train_global_loss: 17456742.8015; train_optim_loss: 17456742.8015; val_kl_reg_loss: 60561.8099; val_edge_recon_loss: 2708955.6500; val_gene_expr_recon_loss: 10477616.9333; val_masked_gp_l1_reg_loss: 114008.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76372.7812; val_chrom_access_recon_loss: 3845790.1333; val_global_loss: 17283305.3333; val_optim_loss: 17283305.3333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9726; val_auprc_score: 0.9639; val_best_acc_score: 0.9244; val_best_f1_score: 0.9260; train_kl_reg_loss: 72784.7836; train_edge_recon_loss: 2693061.4599; train_gene_expr_recon_loss: 10605257.2290; train_masked_gp_l1_reg_loss: 113024.7269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76023.8734; train_chrom_access_recon_loss: 3860998.4885; train_global_loss: 17421150.6183; train_optim_loss: 17421150.6183; val_kl_reg_loss: 63190.8234; val_edge_recon_loss: 2711974.7500; val_gene_expr_recon_loss: 10417872.9333; val_masked_gp_l1_reg_loss: 112153.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75910.7500; val_chrom_access_recon_loss: 3813772.8667; val_global_loss: 17194875.2667; val_optim_loss: 17194875.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9716; val_auprc_score: 0.9624; val_best_acc_score: 0.9233; val_best_f1_score: 0.9258; train_kl_reg_loss: 71234.5539; train_edge_recon_loss: 2695597.6145; train_gene_expr_recon_loss: 10579017.5344; train_masked_gp_l1_reg_loss: 111194.1657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75626.2678; train_chrom_access_recon_loss: 3847992.0076; train_global_loss: 17380662.0916; train_optim_loss: 17380662.0916; val_kl_reg_loss: 64524.5690; val_edge_recon_loss: 2702119.6833; val_gene_expr_recon_loss: 10384178.2000; val_masked_gp_l1_reg_loss: 110532.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75571.3125; val_chrom_access_recon_loss: 3831965.6500; val_global_loss: 17168891.3333; val_optim_loss: 17168891.3333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9742; val_auprc_score: 0.9622; val_best_acc_score: 0.9324; val_best_f1_score: 0.9341; train_kl_reg_loss: 70168.2277; train_edge_recon_loss: 2687972.6374; train_gene_expr_recon_loss: 10577148.3969; train_masked_gp_l1_reg_loss: 109880.1549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75467.6653; train_chrom_access_recon_loss: 3845138.8244; train_global_loss: 17365775.9542; train_optim_loss: 17365775.9542; val_kl_reg_loss: 63313.4430; val_edge_recon_loss: 2694335.6500; val_gene_expr_recon_loss: 10372670.7333; val_masked_gp_l1_reg_loss: 109455.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75501.2812; val_chrom_access_recon_loss: 3815531.8333; val_global_loss: 17130808.6667; val_optim_loss: 17130808.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9751; val_auprc_score: 0.9686; val_best_acc_score: 0.9278; val_best_f1_score: 0.9304; train_kl_reg_loss: 69490.1405; train_edge_recon_loss: 2694489.7366; train_gene_expr_recon_loss: 10553435.7405; train_masked_gp_l1_reg_loss: 108984.1365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75369.0268; train_chrom_access_recon_loss: 3836415.1240; train_global_loss: 17338183.9847; train_optim_loss: 17338183.9847; val_kl_reg_loss: 64178.4151; val_edge_recon_loss: 2699932.5167; val_gene_expr_recon_loss: 10367825.6000; val_masked_gp_l1_reg_loss: 108572.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75676.4766; val_chrom_access_recon_loss: 3812514.2833; val_global_loss: 17128700.2667; val_optim_loss: 17128700.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9751; val_auprc_score: 0.9669; val_best_acc_score: 0.9281; val_best_f1_score: 0.9296; train_kl_reg_loss: 71493.5180; train_edge_recon_loss: 2684789.1202; train_gene_expr_recon_loss: 10533943.6183; train_masked_gp_l1_reg_loss: 108066.3950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75038.4340; train_chrom_access_recon_loss: 3824854.9332; train_global_loss: 17298185.8855; train_optim_loss: 17298185.8855; val_kl_reg_loss: 65284.1859; val_edge_recon_loss: 2700833.3667; val_gene_expr_recon_loss: 10400871.9333; val_masked_gp_l1_reg_loss: 107497.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75020.0156; val_chrom_access_recon_loss: 3803820.2167; val_global_loss: 17153326.9333; val_optim_loss: 17153326.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9745; val_auprc_score: 0.9677; val_best_acc_score: 0.9262; val_best_f1_score: 0.9277; train_kl_reg_loss: 69540.4532; train_edge_recon_loss: 2684353.8111; train_gene_expr_recon_loss: 10532670.0840; train_masked_gp_l1_reg_loss: 107196.7462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75126.1991; train_chrom_access_recon_loss: 3831628.3760; train_global_loss: 17300515.5878; train_optim_loss: 17300515.5878; val_kl_reg_loss: 64097.8187; val_edge_recon_loss: 2704540.6667; val_gene_expr_recon_loss: 10380267.2667; val_masked_gp_l1_reg_loss: 107162.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75171.2578; val_chrom_access_recon_loss: 3811160.2833; val_global_loss: 17142399.9333; val_optim_loss: 17142399.9333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9744; val_auprc_score: 0.9637; val_best_acc_score: 0.9291; val_best_f1_score: 0.9307; train_kl_reg_loss: 69411.2920; train_edge_recon_loss: 2679514.2195; train_gene_expr_recon_loss: 10516571.8397; train_masked_gp_l1_reg_loss: 106808.6477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74985.9912; train_chrom_access_recon_loss: 3822439.4065; train_global_loss: 17269731.5038; train_optim_loss: 17269731.5038; val_kl_reg_loss: 65855.0870; val_edge_recon_loss: 2691142.3833; val_gene_expr_recon_loss: 10366953.2000; val_masked_gp_l1_reg_loss: 106741.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75163.4297; val_chrom_access_recon_loss: 3813523.6667; val_global_loss: 17119378.8667; val_optim_loss: 17119378.8667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9779; val_auprc_score: 0.9722; val_best_acc_score: 0.9318; val_best_f1_score: 0.9340; train_kl_reg_loss: 70104.5683; train_edge_recon_loss: 2680796.4752; train_gene_expr_recon_loss: 10490654.2214; train_masked_gp_l1_reg_loss: 106207.5653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74704.5126; train_chrom_access_recon_loss: 3819801.2805; train_global_loss: 17242268.6183; train_optim_loss: 17242268.6183; val_kl_reg_loss: 66806.7078; val_edge_recon_loss: 2694508.9000; val_gene_expr_recon_loss: 10311238.4667; val_masked_gp_l1_reg_loss: 106120.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75301.6016; val_chrom_access_recon_loss: 3782907.8833; val_global_loss: 17036883.8000; val_optim_loss: 17036883.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9755; val_auprc_score: 0.9666; val_best_acc_score: 0.9317; val_best_f1_score: 0.9333; train_kl_reg_loss: 68186.0362; train_edge_recon_loss: 2676488.6546; train_gene_expr_recon_loss: 10479717.8397; train_masked_gp_l1_reg_loss: 105459.6331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74960.0920; train_chrom_access_recon_loss: 3811945.4580; train_global_loss: 17216757.7252; train_optim_loss: 17216757.7252; val_kl_reg_loss: 63418.9031; val_edge_recon_loss: 2719556.7167; val_gene_expr_recon_loss: 10299397.2667; val_masked_gp_l1_reg_loss: 105127.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75055.6797; val_chrom_access_recon_loss: 3769700.4333; val_global_loss: 17032257.4667; val_optim_loss: 17032257.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9741; val_auprc_score: 0.9646; val_best_acc_score: 0.9321; val_best_f1_score: 0.9339; train_kl_reg_loss: 68923.5732; train_edge_recon_loss: 2680006.4466; train_gene_expr_recon_loss: 10461595.6718; train_masked_gp_l1_reg_loss: 104926.7780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74779.6511; train_chrom_access_recon_loss: 3800865.0134; train_global_loss: 17191097.1221; train_optim_loss: 17191097.1221; val_kl_reg_loss: 65100.7169; val_edge_recon_loss: 2697897.9167; val_gene_expr_recon_loss: 10326806.1333; val_masked_gp_l1_reg_loss: 104517.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74506.2109; val_chrom_access_recon_loss: 3783600.2167; val_global_loss: 17052428.2000; val_optim_loss: 17052428.2000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9793; val_auprc_score: 0.9720; val_best_acc_score: 0.9379; val_best_f1_score: 0.9396; train_kl_reg_loss: 68485.8602; train_edge_recon_loss: 2684311.2557; train_gene_expr_recon_loss: 10454814.7252; train_masked_gp_l1_reg_loss: 104259.5512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74736.6220; train_chrom_access_recon_loss: 3800020.7729; train_global_loss: 17186628.7939; train_optim_loss: 17186628.7939; val_kl_reg_loss: 67633.3859; val_edge_recon_loss: 2685842.3833; val_gene_expr_recon_loss: 10315565.3333; val_masked_gp_l1_reg_loss: 103965.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74679.5234; val_chrom_access_recon_loss: 3792057.2000; val_global_loss: 17039743.4000; val_optim_loss: 17039743.4000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9766; val_auprc_score: 0.9684; val_best_acc_score: 0.9302; val_best_f1_score: 0.9322; train_kl_reg_loss: 68702.6904; train_edge_recon_loss: 2686820.6985; train_gene_expr_recon_loss: 10448096.1832; train_masked_gp_l1_reg_loss: 103668.2210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74802.5292; train_chrom_access_recon_loss: 3797885.0210; train_global_loss: 17179975.3282; train_optim_loss: 17179975.3282; val_kl_reg_loss: 64247.6781; val_edge_recon_loss: 2702768.9833; val_gene_expr_recon_loss: 10331299.5333; val_masked_gp_l1_reg_loss: 103221.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74382.0000; val_chrom_access_recon_loss: 3776748.0667; val_global_loss: 17052668.0667; val_optim_loss: 17052668.0667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9762; val_auprc_score: 0.9698; val_best_acc_score: 0.9316; val_best_f1_score: 0.9332; train_kl_reg_loss: 68519.8498; train_edge_recon_loss: 2679881.1622; train_gene_expr_recon_loss: 10446292.8015; train_masked_gp_l1_reg_loss: 102982.3896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74649.6140; train_chrom_access_recon_loss: 3797922.1775; train_global_loss: 17170248.0153; train_optim_loss: 17170248.0153; val_kl_reg_loss: 66170.2706; val_edge_recon_loss: 2701821.1167; val_gene_expr_recon_loss: 10330862.4000; val_masked_gp_l1_reg_loss: 102873.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74705.1406; val_chrom_access_recon_loss: 3825340.0167; val_global_loss: 17101772.4000; val_optim_loss: 17101772.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9772; val_auprc_score: 0.9705; val_best_acc_score: 0.9352; val_best_f1_score: 0.9372; train_kl_reg_loss: 68857.6075; train_edge_recon_loss: 2677108.9103; train_gene_expr_recon_loss: 10427234.4733; train_masked_gp_l1_reg_loss: 99268.2651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60081.7504; train_chrom_access_recon_loss: 3793854.2023; train_global_loss: 17126405.2366; train_optim_loss: 17126405.2366; val_kl_reg_loss: 66500.9104; val_edge_recon_loss: 2681588.7000; val_gene_expr_recon_loss: 10243893.2000; val_masked_gp_l1_reg_loss: 98465.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58146.9570; val_chrom_access_recon_loss: 3759403.9500; val_global_loss: 16907998.8000; val_optim_loss: 16907998.8000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9776; val_auprc_score: 0.9696; val_best_acc_score: 0.9376; val_best_f1_score: 0.9396; train_kl_reg_loss: 71036.4282; train_edge_recon_loss: 2674268.8969; train_gene_expr_recon_loss: 10429130.0916; train_masked_gp_l1_reg_loss: 98329.6549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57690.2231; train_chrom_access_recon_loss: 3789189.8378; train_global_loss: 17119645.1756; train_optim_loss: 17119645.1756; val_kl_reg_loss: 68164.1740; val_edge_recon_loss: 2686704.7333; val_gene_expr_recon_loss: 10300568.3333; val_masked_gp_l1_reg_loss: 98227.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57366.3125; val_chrom_access_recon_loss: 3789315.6833; val_global_loss: 17000347.0667; val_optim_loss: 17000347.0667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9797; val_auprc_score: 0.9745; val_best_acc_score: 0.9371; val_best_f1_score: 0.9384; train_kl_reg_loss: 71389.9370; train_edge_recon_loss: 2677238.4256; train_gene_expr_recon_loss: 10420987.7939; train_masked_gp_l1_reg_loss: 98158.0639; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57137.7496; train_chrom_access_recon_loss: 3788669.5706; train_global_loss: 17113581.5802; train_optim_loss: 17113581.5802; val_kl_reg_loss: 68340.0573; val_edge_recon_loss: 2684353.9000; val_gene_expr_recon_loss: 10261088.2000; val_masked_gp_l1_reg_loss: 98076.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56850.0586; val_chrom_access_recon_loss: 3774093.3000; val_global_loss: 16942802.6000; val_optim_loss: 16942802.6000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9776; val_auprc_score: 0.9723; val_best_acc_score: 0.9349; val_best_f1_score: 0.9369; train_kl_reg_loss: 71879.9194; train_edge_recon_loss: 2674247.8817; train_gene_expr_recon_loss: 10426481.1145; train_masked_gp_l1_reg_loss: 98054.5131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56721.3110; train_chrom_access_recon_loss: 3791243.5649; train_global_loss: 17118628.4046; train_optim_loss: 17118628.4046; val_kl_reg_loss: 68036.8260; val_edge_recon_loss: 2687274.7500; val_gene_expr_recon_loss: 10293974.0667; val_masked_gp_l1_reg_loss: 97995.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56491.5312; val_chrom_access_recon_loss: 3771513.1167; val_global_loss: 16975286.7333; val_optim_loss: 16975286.7333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9795; val_auprc_score: 0.9719; val_best_acc_score: 0.9371; val_best_f1_score: 0.9389; train_kl_reg_loss: 72135.2193; train_edge_recon_loss: 2671872.1527; train_gene_expr_recon_loss: 10417461.5344; train_masked_gp_l1_reg_loss: 97936.4539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56325.2335; train_chrom_access_recon_loss: 3788840.1641; train_global_loss: 17104570.9160; train_optim_loss: 17104570.9160; val_kl_reg_loss: 68840.4531; val_edge_recon_loss: 2660487.8500; val_gene_expr_recon_loss: 10287154.6000; val_masked_gp_l1_reg_loss: 97896.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56096.0820; val_chrom_access_recon_loss: 3774183.2833; val_global_loss: 16944658.4667; val_optim_loss: 16944658.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9776; val_auprc_score: 0.9718; val_best_acc_score: 0.9326; val_best_f1_score: 0.9350; train_kl_reg_loss: 72388.6913; train_edge_recon_loss: 2675838.7290; train_gene_expr_recon_loss: 10419737.9542; train_masked_gp_l1_reg_loss: 97518.7866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54592.8556; train_chrom_access_recon_loss: 3786519.2004; train_global_loss: 17106596.1603; train_optim_loss: 17106596.1603; val_kl_reg_loss: 68212.4365; val_edge_recon_loss: 2689226.2333; val_gene_expr_recon_loss: 10295004.2667; val_masked_gp_l1_reg_loss: 97421.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54400.6797; val_chrom_access_recon_loss: 3807330.8333; val_global_loss: 17011595.4667; val_optim_loss: 17011595.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9764; val_auprc_score: 0.9708; val_best_acc_score: 0.9314; val_best_f1_score: 0.9330; train_kl_reg_loss: 72421.1693; train_edge_recon_loss: 2680930.5420; train_gene_expr_recon_loss: 10432368.1221; train_masked_gp_l1_reg_loss: 97393.9067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54349.1886; train_chrom_access_recon_loss: 3794308.8168; train_global_loss: 17131771.8168; train_optim_loss: 17131771.8168; val_kl_reg_loss: 66825.5477; val_edge_recon_loss: 2692741.9167; val_gene_expr_recon_loss: 10291517.4000; val_masked_gp_l1_reg_loss: 97372.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54304.8242; val_chrom_access_recon_loss: 3768751.4667; val_global_loss: 16971513.2667; val_optim_loss: 16971513.2667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9766; val_auprc_score: 0.9695; val_best_acc_score: 0.9347; val_best_f1_score: 0.9362; train_kl_reg_loss: 72474.5990; train_edge_recon_loss: 2676616.2538; train_gene_expr_recon_loss: 10415973.7634; train_masked_gp_l1_reg_loss: 97359.9115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54270.5663; train_chrom_access_recon_loss: 3788843.8912; train_global_loss: 17105539.0229; train_optim_loss: 17105539.0229; val_kl_reg_loss: 66850.6987; val_edge_recon_loss: 2683887.4667; val_gene_expr_recon_loss: 10291813.9333; val_masked_gp_l1_reg_loss: 97341.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54231.4609; val_chrom_access_recon_loss: 3786106.1000; val_global_loss: 16980231.0000; val_optim_loss: 16980231.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9778; val_auprc_score: 0.9707; val_best_acc_score: 0.9340; val_best_f1_score: 0.9355; train_kl_reg_loss: 72551.0562; train_edge_recon_loss: 2679624.0553; train_gene_expr_recon_loss: 10423607.7252; train_masked_gp_l1_reg_loss: 97335.6827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54206.8254; train_chrom_access_recon_loss: 3791792.2863; train_global_loss: 17119117.7023; train_optim_loss: 17119117.7023; val_kl_reg_loss: 66546.4193; val_edge_recon_loss: 2692939.5667; val_gene_expr_recon_loss: 10274679.0000; val_masked_gp_l1_reg_loss: 97325.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54177.0898; val_chrom_access_recon_loss: 3785322.5167; val_global_loss: 16970990.6000; val_optim_loss: 16970990.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 49 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9757
val AUPRC score: 0.9678
val best accuracy score: 0.9337
val best F1 score: 0.9353
val target rna MSE score: 1.6610
val source rna MSE score: 0.5236
val target atac MSE score: 0.4962
val source atac MSE score: 0.1496
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
