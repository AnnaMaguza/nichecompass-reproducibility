[True]
Run timestamp: 10102023_113401_251.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_251']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6654; val_auprc_score: 0.6559; val_best_acc_score: 0.5062; val_best_f1_score: 0.6691; train_kl_reg_loss: 67889.2206; train_edge_recon_loss: 744894.2121; train_gene_expr_recon_loss: 23117230.6970; train_masked_gp_l1_reg_loss: 56892.6496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6173035.1780; train_chrom_access_recon_loss: 4986445.5227; train_global_loss: 35146387.3939; train_optim_loss: 35146387.3939; val_kl_reg_loss: 89622.4336; val_edge_recon_loss: 813021.1641; val_gene_expr_recon_loss: 21390074.2500; val_masked_gp_l1_reg_loss: 62166.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3586437.5000; val_chrom_access_recon_loss: 4681137.7500; val_global_loss: 30622459.5000; val_optim_loss: 30622459.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6922; val_auprc_score: 0.6734; val_best_acc_score: 0.6013; val_best_f1_score: 0.6968; train_kl_reg_loss: 90041.3501; train_edge_recon_loss: 747233.7074; train_gene_expr_recon_loss: 21295095.0606; train_masked_gp_l1_reg_loss: 62418.5250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2042768.7936; train_chrom_access_recon_loss: 4746855.7879; train_global_loss: 28984413.0909; train_optim_loss: 28984413.0909; val_kl_reg_loss: 86019.2070; val_edge_recon_loss: 811735.8906; val_gene_expr_recon_loss: 21201256.2500; val_masked_gp_l1_reg_loss: 62964.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1035061.8750; val_chrom_access_recon_loss: 4661245.7500; val_global_loss: 27858283.2500; val_optim_loss: 27858283.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7496; val_auprc_score: 0.7413; val_best_acc_score: 0.6843; val_best_f1_score: 0.6978; train_kl_reg_loss: 81291.5421; train_edge_recon_loss: 737505.3807; train_gene_expr_recon_loss: 21082098.1212; train_masked_gp_l1_reg_loss: 63809.1638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 682983.1070; train_chrom_access_recon_loss: 4715251.8636; train_global_loss: 27362939.2727; train_optim_loss: 27362939.2727; val_kl_reg_loss: 77876.4355; val_edge_recon_loss: 805393.0469; val_gene_expr_recon_loss: 21058921.2500; val_masked_gp_l1_reg_loss: 64763.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 451962.5938; val_chrom_access_recon_loss: 4628726.5000; val_global_loss: 27087643.0000; val_optim_loss: 27087643.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8204; val_auprc_score: 0.8039; val_best_acc_score: 0.7464; val_best_f1_score: 0.7605; train_kl_reg_loss: 73069.6805; train_edge_recon_loss: 727819.8598; train_gene_expr_recon_loss: 20923029.7576; train_masked_gp_l1_reg_loss: 65869.7096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 350833.7126; train_chrom_access_recon_loss: 4682899.1591; train_global_loss: 26823521.7879; train_optim_loss: 26823521.7879; val_kl_reg_loss: 71462.9531; val_edge_recon_loss: 778326.5625; val_gene_expr_recon_loss: 20879253.5000; val_masked_gp_l1_reg_loss: 66965.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 275491.1562; val_chrom_access_recon_loss: 4598484.3125; val_global_loss: 26669985.2500; val_optim_loss: 26669985.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8584; val_auprc_score: 0.8257; val_best_acc_score: 0.7859; val_best_f1_score: 0.8049; train_kl_reg_loss: 69153.0417; train_edge_recon_loss: 707596.5360; train_gene_expr_recon_loss: 20786384.6667; train_masked_gp_l1_reg_loss: 68468.4692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 237453.9020; train_chrom_access_recon_loss: 4654786.8864; train_global_loss: 26523843.6970; train_optim_loss: 26523843.6970; val_kl_reg_loss: 68493.1279; val_edge_recon_loss: 715470.4297; val_gene_expr_recon_loss: 20626156.2500; val_masked_gp_l1_reg_loss: 69694.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208606.3281; val_chrom_access_recon_loss: 4537907.3750; val_global_loss: 26226327.2500; val_optim_loss: 26226327.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8705; val_auprc_score: 0.8339; val_best_acc_score: 0.7982; val_best_f1_score: 0.8169; train_kl_reg_loss: 74249.8961; train_edge_recon_loss: 662982.9612; train_gene_expr_recon_loss: 20659626.6970; train_masked_gp_l1_reg_loss: 71035.2080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194599.4233; train_chrom_access_recon_loss: 4635495.6591; train_global_loss: 26297989.7273; train_optim_loss: 26297989.7273; val_kl_reg_loss: 76644.6318; val_edge_recon_loss: 651456.4375; val_gene_expr_recon_loss: 20773246.0000; val_masked_gp_l1_reg_loss: 72771.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 183792.5000; val_chrom_access_recon_loss: 4604915.8125; val_global_loss: 26362827.0000; val_optim_loss: 26362827.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8875; val_auprc_score: 0.8564; val_best_acc_score: 0.8195; val_best_f1_score: 0.8326; train_kl_reg_loss: 80606.8156; train_edge_recon_loss: 631873.2055; train_gene_expr_recon_loss: 20528697.5152; train_masked_gp_l1_reg_loss: 73904.1429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 172752.8499; train_chrom_access_recon_loss: 4611597.8939; train_global_loss: 26099432.3333; train_optim_loss: 26099432.3333; val_kl_reg_loss: 79687.8623; val_edge_recon_loss: 627963.4844; val_gene_expr_recon_loss: 20695364.7500; val_masked_gp_l1_reg_loss: 75127.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163541.3125; val_chrom_access_recon_loss: 4551540.9375; val_global_loss: 26193226.5000; val_optim_loss: 26193226.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8899; val_auprc_score: 0.8574; val_best_acc_score: 0.8248; val_best_f1_score: 0.8377; train_kl_reg_loss: 79357.4213; train_edge_recon_loss: 622758.6326; train_gene_expr_recon_loss: 20420567.3333; train_masked_gp_l1_reg_loss: 76170.8535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 155184.5208; train_chrom_access_recon_loss: 4591293.0455; train_global_loss: 25945332.0000; train_optim_loss: 25945332.0000; val_kl_reg_loss: 78166.3223; val_edge_recon_loss: 625259.0000; val_gene_expr_recon_loss: 20398366.0000; val_masked_gp_l1_reg_loss: 77243.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147682.9844; val_chrom_access_recon_loss: 4511550.5000; val_global_loss: 25838268.0000; val_optim_loss: 25838268.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8966; val_auprc_score: 0.8658; val_best_acc_score: 0.8337; val_best_f1_score: 0.8462; train_kl_reg_loss: 77972.0263; train_edge_recon_loss: 615945.9706; train_gene_expr_recon_loss: 20317698.3636; train_masked_gp_l1_reg_loss: 77962.2569; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141676.6705; train_chrom_access_recon_loss: 4570168.1136; train_global_loss: 25801423.2121; train_optim_loss: 25801423.2121; val_kl_reg_loss: 75118.3076; val_edge_recon_loss: 617351.7188; val_gene_expr_recon_loss: 20362796.7500; val_masked_gp_l1_reg_loss: 78795.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 136857.8438; val_chrom_access_recon_loss: 4490091.7500; val_global_loss: 25761013.0000; val_optim_loss: 25761013.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8964; val_auprc_score: 0.8646; val_best_acc_score: 0.8251; val_best_f1_score: 0.8403; train_kl_reg_loss: 76640.7022; train_edge_recon_loss: 612494.7244; train_gene_expr_recon_loss: 20261899.9091; train_masked_gp_l1_reg_loss: 79475.2989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131806.6094; train_chrom_access_recon_loss: 4557568.2955; train_global_loss: 25719885.4545; train_optim_loss: 25719885.4545; val_kl_reg_loss: 76014.3926; val_edge_recon_loss: 611422.7109; val_gene_expr_recon_loss: 20267345.0000; val_masked_gp_l1_reg_loss: 80096.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128000.1562; val_chrom_access_recon_loss: 4487828.8125; val_global_loss: 25650707.0000; val_optim_loss: 25650707.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8953; val_auprc_score: 0.8666; val_best_acc_score: 0.8248; val_best_f1_score: 0.8386; train_kl_reg_loss: 75895.4508; train_edge_recon_loss: 607655.9167; train_gene_expr_recon_loss: 20156162.8788; train_masked_gp_l1_reg_loss: 80685.2150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124590.7644; train_chrom_access_recon_loss: 4532267.7879; train_global_loss: 25577257.9394; train_optim_loss: 25577257.9394; val_kl_reg_loss: 72563.4277; val_edge_recon_loss: 620497.1172; val_gene_expr_recon_loss: 20153714.0000; val_masked_gp_l1_reg_loss: 81163.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121720.6250; val_chrom_access_recon_loss: 4464354.4375; val_global_loss: 25514013.7500; val_optim_loss: 25514013.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8933; val_auprc_score: 0.8572; val_best_acc_score: 0.8283; val_best_f1_score: 0.8428; train_kl_reg_loss: 73635.1302; train_edge_recon_loss: 606165.0597; train_gene_expr_recon_loss: 20090637.9394; train_masked_gp_l1_reg_loss: 81746.7013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119300.2457; train_chrom_access_recon_loss: 4516239.0833; train_global_loss: 25487724.1212; train_optim_loss: 25487724.1212; val_kl_reg_loss: 73591.4434; val_edge_recon_loss: 617386.5469; val_gene_expr_recon_loss: 19983670.7500; val_masked_gp_l1_reg_loss: 82188.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117738.6172; val_chrom_access_recon_loss: 4424792.3125; val_global_loss: 25299367.2500; val_optim_loss: 25299367.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9080; val_auprc_score: 0.8788; val_best_acc_score: 0.8458; val_best_f1_score: 0.8540; train_kl_reg_loss: 72098.5630; train_edge_recon_loss: 606668.4517; train_gene_expr_recon_loss: 20005393.2121; train_masked_gp_l1_reg_loss: 82558.8519; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116023.0763; train_chrom_access_recon_loss: 4499428.1705; train_global_loss: 25382170.3333; train_optim_loss: 25382170.3333; val_kl_reg_loss: 71215.2188; val_edge_recon_loss: 603637.8047; val_gene_expr_recon_loss: 20029528.0000; val_masked_gp_l1_reg_loss: 83091.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114810.8359; val_chrom_access_recon_loss: 4490614.8750; val_global_loss: 25392898.0000; val_optim_loss: 25392898.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9099; val_auprc_score: 0.8878; val_best_acc_score: 0.8444; val_best_f1_score: 0.8560; train_kl_reg_loss: 71616.9160; train_edge_recon_loss: 602963.4375; train_gene_expr_recon_loss: 19963395.7273; train_masked_gp_l1_reg_loss: 83517.3398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113815.5951; train_chrom_access_recon_loss: 4489780.6667; train_global_loss: 25325089.5758; train_optim_loss: 25325089.5758; val_kl_reg_loss: 70434.3789; val_edge_recon_loss: 607700.8906; val_gene_expr_recon_loss: 19966193.7500; val_masked_gp_l1_reg_loss: 84002.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113200.8203; val_chrom_access_recon_loss: 4385023.1875; val_global_loss: 25226553.7500; val_optim_loss: 25226553.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9196; val_auprc_score: 0.8983; val_best_acc_score: 0.8528; val_best_f1_score: 0.8639; train_kl_reg_loss: 70363.1233; train_edge_recon_loss: 599982.9034; train_gene_expr_recon_loss: 19888260.3333; train_masked_gp_l1_reg_loss: 84275.9429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112238.7638; train_chrom_access_recon_loss: 4468296.4167; train_global_loss: 25223417.4242; train_optim_loss: 25223417.4242; val_kl_reg_loss: 70359.0049; val_edge_recon_loss: 605397.5078; val_gene_expr_recon_loss: 19957113.5000; val_masked_gp_l1_reg_loss: 84734.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111829.0469; val_chrom_access_recon_loss: 4413032.0000; val_global_loss: 25242466.2500; val_optim_loss: 25242466.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9191; val_auprc_score: 0.8903; val_best_acc_score: 0.8603; val_best_f1_score: 0.8671; train_kl_reg_loss: 69535.2805; train_edge_recon_loss: 598335.9972; train_gene_expr_recon_loss: 19837158.8485; train_masked_gp_l1_reg_loss: 85081.9677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110906.9994; train_chrom_access_recon_loss: 4454588.5682; train_global_loss: 25155607.5758; train_optim_loss: 25155607.5758; val_kl_reg_loss: 69084.9297; val_edge_recon_loss: 606911.6797; val_gene_expr_recon_loss: 19873286.0000; val_masked_gp_l1_reg_loss: 85469.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110011.2109; val_chrom_access_recon_loss: 4390912.0625; val_global_loss: 25135676.2500; val_optim_loss: 25135676.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9287; val_auprc_score: 0.9114; val_best_acc_score: 0.8641; val_best_f1_score: 0.8731; train_kl_reg_loss: 69274.6297; train_edge_recon_loss: 595284.9754; train_gene_expr_recon_loss: 19764745.6061; train_masked_gp_l1_reg_loss: 85870.4728; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109084.8117; train_chrom_access_recon_loss: 4432933.8864; train_global_loss: 25057194.3636; train_optim_loss: 25057194.3636; val_kl_reg_loss: 68524.5381; val_edge_recon_loss: 603198.4766; val_gene_expr_recon_loss: 19800600.0000; val_masked_gp_l1_reg_loss: 86525.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108552.0938; val_chrom_access_recon_loss: 4397713.1250; val_global_loss: 25065114.5000; val_optim_loss: 25065114.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9308; val_auprc_score: 0.9063; val_best_acc_score: 0.8692; val_best_f1_score: 0.8773; train_kl_reg_loss: 68143.0623; train_edge_recon_loss: 594867.6591; train_gene_expr_recon_loss: 19707667.9394; train_masked_gp_l1_reg_loss: 86787.8228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107572.2526; train_chrom_access_recon_loss: 4418707.7803; train_global_loss: 24983746.4545; train_optim_loss: 24983746.4545; val_kl_reg_loss: 66526.5723; val_edge_recon_loss: 596695.2188; val_gene_expr_recon_loss: 19599338.2500; val_masked_gp_l1_reg_loss: 87298.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107338.4844; val_chrom_access_recon_loss: 4381543.9688; val_global_loss: 24838740.2500; val_optim_loss: 24838740.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9311; val_auprc_score: 0.9116; val_best_acc_score: 0.8726; val_best_f1_score: 0.8794; train_kl_reg_loss: 67790.4322; train_edge_recon_loss: 591531.6913; train_gene_expr_recon_loss: 19673782.9697; train_masked_gp_l1_reg_loss: 87652.5716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106560.4094; train_chrom_access_recon_loss: 4405905.5492; train_global_loss: 24933223.4848; train_optim_loss: 24933223.4848; val_kl_reg_loss: 66160.3696; val_edge_recon_loss: 598557.1094; val_gene_expr_recon_loss: 19838734.5000; val_masked_gp_l1_reg_loss: 88049.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105531.2656; val_chrom_access_recon_loss: 4384418.1875; val_global_loss: 25081452.2500; val_optim_loss: 25081452.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9405; val_auprc_score: 0.9239; val_best_acc_score: 0.8804; val_best_f1_score: 0.8883; train_kl_reg_loss: 66936.2076; train_edge_recon_loss: 591617.3987; train_gene_expr_recon_loss: 19591462.7273; train_masked_gp_l1_reg_loss: 88508.7880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105049.4614; train_chrom_access_recon_loss: 4383922.6098; train_global_loss: 24827497.2727; train_optim_loss: 24827497.2727; val_kl_reg_loss: 67678.8154; val_edge_recon_loss: 594574.4062; val_gene_expr_recon_loss: 19702988.7500; val_masked_gp_l1_reg_loss: 88915.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105020.4453; val_chrom_access_recon_loss: 4314045.8438; val_global_loss: 24873223.7500; val_optim_loss: 24873223.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9410; val_auprc_score: 0.9223; val_best_acc_score: 0.8818; val_best_f1_score: 0.8871; train_kl_reg_loss: 66520.3712; train_edge_recon_loss: 590281.9337; train_gene_expr_recon_loss: 19547736.6061; train_masked_gp_l1_reg_loss: 89421.2610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104039.9732; train_chrom_access_recon_loss: 4369100.9621; train_global_loss: 24767101.1515; train_optim_loss: 24767101.1515; val_kl_reg_loss: 65749.8125; val_edge_recon_loss: 599129.2656; val_gene_expr_recon_loss: 19574064.5000; val_masked_gp_l1_reg_loss: 89981.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103726.3047; val_chrom_access_recon_loss: 4314776.3125; val_global_loss: 24747427.7500; val_optim_loss: 24747427.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9385; val_auprc_score: 0.9225; val_best_acc_score: 0.8810; val_best_f1_score: 0.8860; train_kl_reg_loss: 65724.5141; train_edge_recon_loss: 590057.8949; train_gene_expr_recon_loss: 19514679.0303; train_masked_gp_l1_reg_loss: 90463.3746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103197.5360; train_chrom_access_recon_loss: 4353938.8902; train_global_loss: 24718061.2424; train_optim_loss: 24718061.2424; val_kl_reg_loss: 66134.3638; val_edge_recon_loss: 596746.5312; val_gene_expr_recon_loss: 19651092.0000; val_masked_gp_l1_reg_loss: 90982.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103040.8203; val_chrom_access_recon_loss: 4334724.7500; val_global_loss: 24842719.2500; val_optim_loss: 24842719.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9369; val_auprc_score: 0.9131; val_best_acc_score: 0.8821; val_best_f1_score: 0.8866; train_kl_reg_loss: 65406.2370; train_edge_recon_loss: 588512.5237; train_gene_expr_recon_loss: 19472452.6364; train_masked_gp_l1_reg_loss: 91406.1394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102428.9980; train_chrom_access_recon_loss: 4337349.7348; train_global_loss: 24657556.3030; train_optim_loss: 24657556.3030; val_kl_reg_loss: 64355.9692; val_edge_recon_loss: 591039.0781; val_gene_expr_recon_loss: 19478548.2500; val_masked_gp_l1_reg_loss: 91920.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102181.4453; val_chrom_access_recon_loss: 4300212.3438; val_global_loss: 24628257.0000; val_optim_loss: 24628257.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9394; val_auprc_score: 0.9207; val_best_acc_score: 0.8837; val_best_f1_score: 0.8887; train_kl_reg_loss: 64923.1445; train_edge_recon_loss: 587627.1790; train_gene_expr_recon_loss: 19420550.2727; train_masked_gp_l1_reg_loss: 92393.5800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101495.5465; train_chrom_access_recon_loss: 4320394.3598; train_global_loss: 24587384.2121; train_optim_loss: 24587384.2121; val_kl_reg_loss: 64792.3867; val_edge_recon_loss: 599440.2031; val_gene_expr_recon_loss: 19522198.5000; val_masked_gp_l1_reg_loss: 92974.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101442.0938; val_chrom_access_recon_loss: 4323936.2812; val_global_loss: 24704783.0000; val_optim_loss: 24704783.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9471; val_auprc_score: 0.9337; val_best_acc_score: 0.8912; val_best_f1_score: 0.8951; train_kl_reg_loss: 64782.8249; train_edge_recon_loss: 585594.2614; train_gene_expr_recon_loss: 19384341.4242; train_masked_gp_l1_reg_loss: 93442.6013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100777.9669; train_chrom_access_recon_loss: 4305162.8106; train_global_loss: 24534101.9394; train_optim_loss: 24534101.9394; val_kl_reg_loss: 65461.8735; val_edge_recon_loss: 585657.7578; val_gene_expr_recon_loss: 19489458.0000; val_masked_gp_l1_reg_loss: 93896.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100736.9531; val_chrom_access_recon_loss: 4278736.1250; val_global_loss: 24613945.5000; val_optim_loss: 24613945.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8687; val_auprc_score: 0.8418; val_best_acc_score: 0.7832; val_best_f1_score: 0.8132; train_kl_reg_loss: 28594.2812; train_edge_recon_loss: 756470.9886; train_gene_expr_recon_loss: 17836835.4242; train_masked_gp_l1_reg_loss: 96097.7037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111346.8981; train_chrom_access_recon_loss: 4060296.0947; train_global_loss: 22889641.1818; train_optim_loss: 22889641.1818; val_kl_reg_loss: 9140.6722; val_edge_recon_loss: 790682.4531; val_gene_expr_recon_loss: 17671091.7500; val_masked_gp_l1_reg_loss: 97025.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123740.8828; val_chrom_access_recon_loss: 3988767.0312; val_global_loss: 22680448.2500; val_optim_loss: 22680448.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8648; val_auprc_score: 0.8272; val_best_acc_score: 0.8001; val_best_f1_score: 0.8195; train_kl_reg_loss: 15642.1614; train_edge_recon_loss: 760861.7197; train_gene_expr_recon_loss: 17496376.5152; train_masked_gp_l1_reg_loss: 94051.2161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125036.6407; train_chrom_access_recon_loss: 3981213.6402; train_global_loss: 22473181.8788; train_optim_loss: 22473181.8788; val_kl_reg_loss: 21068.0671; val_edge_recon_loss: 765283.8359; val_gene_expr_recon_loss: 17554515.7500; val_masked_gp_l1_reg_loss: 91155.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125247.4219; val_chrom_access_recon_loss: 3923957.2188; val_global_loss: 22481228.5000; val_optim_loss: 22481228.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8550; val_auprc_score: 0.8168; val_best_acc_score: 0.7681; val_best_f1_score: 0.7971; train_kl_reg_loss: 20681.8329; train_edge_recon_loss: 735883.3769; train_gene_expr_recon_loss: 17424822.2121; train_masked_gp_l1_reg_loss: 88578.2051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122288.0679; train_chrom_access_recon_loss: 3972418.2311; train_global_loss: 22364672.1212; train_optim_loss: 22364672.1212; val_kl_reg_loss: 15296.1797; val_edge_recon_loss: 779789.0547; val_gene_expr_recon_loss: 17490105.7500; val_masked_gp_l1_reg_loss: 85980.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121541.7109; val_chrom_access_recon_loss: 3922724.2500; val_global_loss: 22415437.5000; val_optim_loss: 22415437.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8592; val_auprc_score: 0.8180; val_best_acc_score: 0.7920; val_best_f1_score: 0.8206; train_kl_reg_loss: 16677.5659; train_edge_recon_loss: 747035.1051; train_gene_expr_recon_loss: 17419620.2879; train_masked_gp_l1_reg_loss: 84123.8640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123827.4909; train_chrom_access_recon_loss: 3970869.5644; train_global_loss: 22362154.0303; train_optim_loss: 22362154.0303; val_kl_reg_loss: 11330.4625; val_edge_recon_loss: 748768.0078; val_gene_expr_recon_loss: 17388735.7500; val_masked_gp_l1_reg_loss: 82500.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123774.3750; val_chrom_access_recon_loss: 3918239.2188; val_global_loss: 22273347.7500; val_optim_loss: 22273347.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8716; val_auprc_score: 0.8343; val_best_acc_score: 0.7953; val_best_f1_score: 0.8212; train_kl_reg_loss: 13697.9775; train_edge_recon_loss: 748641.5616; train_gene_expr_recon_loss: 17358125.0152; train_masked_gp_l1_reg_loss: 81408.4571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124165.8196; train_chrom_access_recon_loss: 3951486.6402; train_global_loss: 22277525.3636; train_optim_loss: 22277525.3636; val_kl_reg_loss: 9687.7363; val_edge_recon_loss: 760102.9219; val_gene_expr_recon_loss: 17374203.8750; val_masked_gp_l1_reg_loss: 80164.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124524.2812; val_chrom_access_recon_loss: 3873024.3438; val_global_loss: 22221707.0000; val_optim_loss: 22221707.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8625; val_auprc_score: 0.8200; val_best_acc_score: 0.7923; val_best_f1_score: 0.8184; train_kl_reg_loss: 13837.7000; train_edge_recon_loss: 733033.9735; train_gene_expr_recon_loss: 17430180.4848; train_masked_gp_l1_reg_loss: 79607.5321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124890.5129; train_chrom_access_recon_loss: 3946985.1932; train_global_loss: 22328535.4545; train_optim_loss: 22328535.4545; val_kl_reg_loss: 9967.0381; val_edge_recon_loss: 743957.5625; val_gene_expr_recon_loss: 17431537.0000; val_masked_gp_l1_reg_loss: 79278.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126197.1875; val_chrom_access_recon_loss: 3888234.5938; val_global_loss: 22279172.5000; val_optim_loss: 22279172.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8482; val_auprc_score: 0.8013; val_best_acc_score: 0.7840; val_best_f1_score: 0.8120; train_kl_reg_loss: 13937.3555; train_edge_recon_loss: 721615.1581; train_gene_expr_recon_loss: 17296905.4545; train_masked_gp_l1_reg_loss: 78183.9991; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125347.7970; train_chrom_access_recon_loss: 3938175.5492; train_global_loss: 22174165.3030; train_optim_loss: 22174165.3030; val_kl_reg_loss: 10531.0596; val_edge_recon_loss: 720194.6016; val_gene_expr_recon_loss: 17418462.3750; val_masked_gp_l1_reg_loss: 76914.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122566.0391; val_chrom_access_recon_loss: 3864570.6250; val_global_loss: 22213238.0000; val_optim_loss: 22213238.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8599; val_auprc_score: 0.8131; val_best_acc_score: 0.7912; val_best_f1_score: 0.8167; train_kl_reg_loss: 14853.7917; train_edge_recon_loss: 709108.8816; train_gene_expr_recon_loss: 17278816.8636; train_masked_gp_l1_reg_loss: 75450.1360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121463.7586; train_chrom_access_recon_loss: 3927980.8674; train_global_loss: 22127674.0606; train_optim_loss: 22127674.0606; val_kl_reg_loss: 11479.2207; val_edge_recon_loss: 710735.9219; val_gene_expr_recon_loss: 17360983.2500; val_masked_gp_l1_reg_loss: 74403.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120285.8750; val_chrom_access_recon_loss: 3858869.6562; val_global_loss: 22136758.0000; val_optim_loss: 22136758.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8463; val_auprc_score: 0.8010; val_best_acc_score: 0.7789; val_best_f1_score: 0.8130; train_kl_reg_loss: 15748.6700; train_edge_recon_loss: 685603.9536; train_gene_expr_recon_loss: 17226576.3636; train_masked_gp_l1_reg_loss: 73676.4078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118798.3014; train_chrom_access_recon_loss: 3911008.9470; train_global_loss: 22031412.5455; train_optim_loss: 22031412.5455; val_kl_reg_loss: 13394.6906; val_edge_recon_loss: 676307.8750; val_gene_expr_recon_loss: 17195664.6250; val_masked_gp_l1_reg_loss: 73084.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116624.3594; val_chrom_access_recon_loss: 3826546.5625; val_global_loss: 21901621.7500; val_optim_loss: 21901621.7500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8383; val_auprc_score: 0.7928; val_best_acc_score: 0.7684; val_best_f1_score: 0.8037; train_kl_reg_loss: 18486.5835; train_edge_recon_loss: 670564.1790; train_gene_expr_recon_loss: 17188276.9545; train_masked_gp_l1_reg_loss: 72322.9603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114783.9503; train_chrom_access_recon_loss: 3903722.0417; train_global_loss: 21968156.7273; train_optim_loss: 21968156.7273; val_kl_reg_loss: 13322.0258; val_edge_recon_loss: 671849.7812; val_gene_expr_recon_loss: 17306338.3750; val_masked_gp_l1_reg_loss: 71658.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113011.5625; val_chrom_access_recon_loss: 3865932.2812; val_global_loss: 22042112.2500; val_optim_loss: 22042112.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8477; val_auprc_score: 0.8020; val_best_acc_score: 0.7816; val_best_f1_score: 0.8110; train_kl_reg_loss: 19808.8828; train_edge_recon_loss: 655783.7301; train_gene_expr_recon_loss: 17163174.2727; train_masked_gp_l1_reg_loss: 71075.1271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111719.0859; train_chrom_access_recon_loss: 3901509.8598; train_global_loss: 21923070.9697; train_optim_loss: 21923070.9697; val_kl_reg_loss: 16222.0088; val_edge_recon_loss: 650006.8125; val_gene_expr_recon_loss: 17237350.3750; val_masked_gp_l1_reg_loss: 70543.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109743.2734; val_chrom_access_recon_loss: 3832873.9688; val_global_loss: 21916741.5000; val_optim_loss: 21916741.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8625; val_auprc_score: 0.8241; val_best_acc_score: 0.7894; val_best_f1_score: 0.8156; train_kl_reg_loss: 22478.2696; train_edge_recon_loss: 639222.3125; train_gene_expr_recon_loss: 17137551.3333; train_masked_gp_l1_reg_loss: 69999.0914; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108895.2715; train_chrom_access_recon_loss: 3897551.1553; train_global_loss: 21875697.4848; train_optim_loss: 21875697.4848; val_kl_reg_loss: 17920.3616; val_edge_recon_loss: 627084.9609; val_gene_expr_recon_loss: 17149310.3750; val_masked_gp_l1_reg_loss: 69639.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107722.9688; val_chrom_access_recon_loss: 3817139.9688; val_global_loss: 21788817.5000; val_optim_loss: 21788817.5000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8549; val_auprc_score: 0.8130; val_best_acc_score: 0.7810; val_best_f1_score: 0.8087; train_kl_reg_loss: 24160.9830; train_edge_recon_loss: 627054.0000; train_gene_expr_recon_loss: 17096264.6061; train_masked_gp_l1_reg_loss: 69128.5083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106640.0965; train_chrom_access_recon_loss: 3878438.1629; train_global_loss: 21801686.5152; train_optim_loss: 21801686.5152; val_kl_reg_loss: 19961.9500; val_edge_recon_loss: 629411.1641; val_gene_expr_recon_loss: 17162568.7500; val_masked_gp_l1_reg_loss: 68708.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105832.9062; val_chrom_access_recon_loss: 3813695.4062; val_global_loss: 21800177.7500; val_optim_loss: 21800177.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8597; val_auprc_score: 0.8206; val_best_acc_score: 0.7894; val_best_f1_score: 0.8151; train_kl_reg_loss: 25636.0015; train_edge_recon_loss: 618012.8977; train_gene_expr_recon_loss: 17077301.3485; train_masked_gp_l1_reg_loss: 68267.0015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104941.6339; train_chrom_access_recon_loss: 3874035.1212; train_global_loss: 21768194.0303; train_optim_loss: 21768194.0303; val_kl_reg_loss: 22068.5146; val_edge_recon_loss: 615917.5234; val_gene_expr_recon_loss: 17155278.0000; val_masked_gp_l1_reg_loss: 67823.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103798.9844; val_chrom_access_recon_loss: 3824124.4375; val_global_loss: 21789010.7500; val_optim_loss: 21789010.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8497; val_auprc_score: 0.8046; val_best_acc_score: 0.7821; val_best_f1_score: 0.8095; train_kl_reg_loss: 26909.2380; train_edge_recon_loss: 613963.3494; train_gene_expr_recon_loss: 17048196.4242; train_masked_gp_l1_reg_loss: 67340.7985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103019.2660; train_chrom_access_recon_loss: 3861696.7273; train_global_loss: 21721125.8788; train_optim_loss: 21721125.8788; val_kl_reg_loss: 23535.2878; val_edge_recon_loss: 612374.4688; val_gene_expr_recon_loss: 17138720.7500; val_masked_gp_l1_reg_loss: 66842.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102604.1406; val_chrom_access_recon_loss: 3875194.9688; val_global_loss: 21819271.0000; val_optim_loss: 21819271.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8592; val_auprc_score: 0.8215; val_best_acc_score: 0.7864; val_best_f1_score: 0.8133; train_kl_reg_loss: 28362.1590; train_edge_recon_loss: 609119.4290; train_gene_expr_recon_loss: 17060595.2727; train_masked_gp_l1_reg_loss: 66385.7760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101503.3830; train_chrom_access_recon_loss: 3867697.0947; train_global_loss: 21733663.0303; train_optim_loss: 21733663.0303; val_kl_reg_loss: 25917.9326; val_edge_recon_loss: 607390.1719; val_gene_expr_recon_loss: 17052207.3750; val_masked_gp_l1_reg_loss: 65855.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101005.8516; val_chrom_access_recon_loss: 3804236.7812; val_global_loss: 21656614.5000; val_optim_loss: 21656614.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8572; val_auprc_score: 0.8104; val_best_acc_score: 0.7821; val_best_f1_score: 0.8082; train_kl_reg_loss: 29836.2607; train_edge_recon_loss: 607259.5852; train_gene_expr_recon_loss: 17011704.4394; train_masked_gp_l1_reg_loss: 65314.5489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100113.5411; train_chrom_access_recon_loss: 3858828.0833; train_global_loss: 21673056.5455; train_optim_loss: 21673056.5455; val_kl_reg_loss: 28450.8391; val_edge_recon_loss: 609135.5312; val_gene_expr_recon_loss: 17051688.2500; val_masked_gp_l1_reg_loss: 64857.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99502.7656; val_chrom_access_recon_loss: 3824697.7500; val_global_loss: 21678332.0000; val_optim_loss: 21678332.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8544; val_auprc_score: 0.8095; val_best_acc_score: 0.7845; val_best_f1_score: 0.8138; train_kl_reg_loss: 31390.8542; train_edge_recon_loss: 605700.6259; train_gene_expr_recon_loss: 16996485.3485; train_masked_gp_l1_reg_loss: 64370.9306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98909.7796; train_chrom_access_recon_loss: 3853684.9356; train_global_loss: 21650542.8182; train_optim_loss: 21650542.8182; val_kl_reg_loss: 26917.5808; val_edge_recon_loss: 609366.5625; val_gene_expr_recon_loss: 16956550.7500; val_masked_gp_l1_reg_loss: 64034.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98292.0234; val_chrom_access_recon_loss: 3805188.3125; val_global_loss: 21560349.7500; val_optim_loss: 21560349.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8690; val_auprc_score: 0.8277; val_best_acc_score: 0.7902; val_best_f1_score: 0.8140; train_kl_reg_loss: 33675.2815; train_edge_recon_loss: 605773.4119; train_gene_expr_recon_loss: 16989457.9242; train_masked_gp_l1_reg_loss: 63754.4436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97699.7765; train_chrom_access_recon_loss: 3856401.7159; train_global_loss: 21646762.4242; train_optim_loss: 21646762.4242; val_kl_reg_loss: 29518.8511; val_edge_recon_loss: 606738.7969; val_gene_expr_recon_loss: 17007508.5000; val_masked_gp_l1_reg_loss: 63393.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97079.3125; val_chrom_access_recon_loss: 3823164.1562; val_global_loss: 21627404.5000; val_optim_loss: 21627404.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8739; val_auprc_score: 0.8413; val_best_acc_score: 0.7955; val_best_f1_score: 0.8196; train_kl_reg_loss: 34809.3413; train_edge_recon_loss: 605210.8087; train_gene_expr_recon_loss: 16971007.1818; train_masked_gp_l1_reg_loss: 63134.3295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96541.5247; train_chrom_access_recon_loss: 3851904.1250; train_global_loss: 21622607.3636; train_optim_loss: 21622607.3636; val_kl_reg_loss: 30385.7085; val_edge_recon_loss: 599327.7969; val_gene_expr_recon_loss: 17101700.0000; val_masked_gp_l1_reg_loss: 62791.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95718.3984; val_chrom_access_recon_loss: 3789691.8750; val_global_loss: 21679615.0000; val_optim_loss: 21679615.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8690; val_auprc_score: 0.8331; val_best_acc_score: 0.7945; val_best_f1_score: 0.8241; train_kl_reg_loss: 35821.9954; train_edge_recon_loss: 595107.4214; train_gene_expr_recon_loss: 16956052.7879; train_masked_gp_l1_reg_loss: 62538.6064; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95311.6966; train_chrom_access_recon_loss: 3845123.2689; train_global_loss: 21589955.6364; train_optim_loss: 21589955.6364; val_kl_reg_loss: 32861.7734; val_edge_recon_loss: 594241.5156; val_gene_expr_recon_loss: 17076722.2500; val_masked_gp_l1_reg_loss: 62326.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95576.3516; val_chrom_access_recon_loss: 3804206.5938; val_global_loss: 21665934.0000; val_optim_loss: 21665934.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8795; val_auprc_score: 0.8459; val_best_acc_score: 0.8049; val_best_f1_score: 0.8256; train_kl_reg_loss: 36069.9158; train_edge_recon_loss: 596618.1023; train_gene_expr_recon_loss: 16944635.1818; train_masked_gp_l1_reg_loss: 62000.2723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94688.9741; train_chrom_access_recon_loss: 3840421.9356; train_global_loss: 21574434.2121; train_optim_loss: 21574434.2121; val_kl_reg_loss: 33874.7495; val_edge_recon_loss: 591734.3828; val_gene_expr_recon_loss: 17050493.2500; val_masked_gp_l1_reg_loss: 61772.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93934.2031; val_chrom_access_recon_loss: 3793427.4375; val_global_loss: 21625236.0000; val_optim_loss: 21625236.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8753; val_auprc_score: 0.8378; val_best_acc_score: 0.8052; val_best_f1_score: 0.8252; train_kl_reg_loss: 36624.6451; train_edge_recon_loss: 595980.0786; train_gene_expr_recon_loss: 16915516.9545; train_masked_gp_l1_reg_loss: 61235.2164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78530.0430; train_chrom_access_recon_loss: 3832041.0189; train_global_loss: 21519927.7273; train_optim_loss: 21519927.7273; val_kl_reg_loss: 33287.2354; val_edge_recon_loss: 593708.9297; val_gene_expr_recon_loss: 16999225.6250; val_masked_gp_l1_reg_loss: 60993.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75342.1406; val_chrom_access_recon_loss: 3741581.1562; val_global_loss: 21504138.7500; val_optim_loss: 21504138.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8737; val_auprc_score: 0.8439; val_best_acc_score: 0.7945; val_best_f1_score: 0.8180; train_kl_reg_loss: 36728.0715; train_edge_recon_loss: 593283.3229; train_gene_expr_recon_loss: 16913775.6212; train_masked_gp_l1_reg_loss: 60915.2518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74904.2409; train_chrom_access_recon_loss: 3828563.0568; train_global_loss: 21508169.4545; train_optim_loss: 21508169.4545; val_kl_reg_loss: 33585.1021; val_edge_recon_loss: 598415.3359; val_gene_expr_recon_loss: 17067129.8750; val_masked_gp_l1_reg_loss: 60862.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74485.3516; val_chrom_access_recon_loss: 3805298.9375; val_global_loss: 21639777.2500; val_optim_loss: 21639777.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8811; val_auprc_score: 0.8465; val_best_acc_score: 0.8052; val_best_f1_score: 0.8234; train_kl_reg_loss: 36992.7723; train_edge_recon_loss: 593583.2955; train_gene_expr_recon_loss: 16912631.0455; train_masked_gp_l1_reg_loss: 60823.5463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74155.1436; train_chrom_access_recon_loss: 3829258.7008; train_global_loss: 21507444.4848; train_optim_loss: 21507444.4848; val_kl_reg_loss: 33837.6719; val_edge_recon_loss: 599022.2812; val_gene_expr_recon_loss: 17140508.0000; val_masked_gp_l1_reg_loss: 60766.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73850.4141; val_chrom_access_recon_loss: 3844221.0312; val_global_loss: 21752205.0000; val_optim_loss: 21752205.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8785; val_auprc_score: 0.8391; val_best_acc_score: 0.8084; val_best_f1_score: 0.8293; train_kl_reg_loss: 37028.1752; train_edge_recon_loss: 594049.5407; train_gene_expr_recon_loss: 16910015.9697; train_masked_gp_l1_reg_loss: 60738.2730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73678.6029; train_chrom_access_recon_loss: 3829266.6477; train_global_loss: 21504777.0000; train_optim_loss: 21504777.0000; val_kl_reg_loss: 34193.6179; val_edge_recon_loss: 587486.2891; val_gene_expr_recon_loss: 17117025.1250; val_masked_gp_l1_reg_loss: 60694.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73417.8047; val_chrom_access_recon_loss: 3802083.6250; val_global_loss: 21674900.5000; val_optim_loss: 21674900.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8804; val_auprc_score: 0.8488; val_best_acc_score: 0.8063; val_best_f1_score: 0.8276; train_kl_reg_loss: 37152.5451; train_edge_recon_loss: 592887.6004; train_gene_expr_recon_loss: 16910977.0758; train_masked_gp_l1_reg_loss: 60658.0872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73240.8226; train_chrom_access_recon_loss: 3825960.9015; train_global_loss: 21500877.0000; train_optim_loss: 21500877.0000; val_kl_reg_loss: 33864.7803; val_edge_recon_loss: 596234.4141; val_gene_expr_recon_loss: 16875303.7500; val_masked_gp_l1_reg_loss: 60619.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73088.8281; val_chrom_access_recon_loss: 3761609.4688; val_global_loss: 21400720.7500; val_optim_loss: 21400720.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8741; val_auprc_score: 0.8383; val_best_acc_score: 0.8023; val_best_f1_score: 0.8233; train_kl_reg_loss: 37294.2591; train_edge_recon_loss: 591678.2500; train_gene_expr_recon_loss: 16910199.8333; train_masked_gp_l1_reg_loss: 60579.9068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72855.7579; train_chrom_access_recon_loss: 3827896.1818; train_global_loss: 21500504.2121; train_optim_loss: 21500504.2121; val_kl_reg_loss: 34350.2231; val_edge_recon_loss: 594759.0469; val_gene_expr_recon_loss: 16944955.3750; val_masked_gp_l1_reg_loss: 60533.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72614.4453; val_chrom_access_recon_loss: 3784187.8438; val_global_loss: 21491400.7500; val_optim_loss: 21491400.7500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8845; val_auprc_score: 0.8547; val_best_acc_score: 0.8125; val_best_f1_score: 0.8300; train_kl_reg_loss: 37466.1390; train_edge_recon_loss: 592979.6080; train_gene_expr_recon_loss: 16896621.3182; train_masked_gp_l1_reg_loss: 60488.9622; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72420.7736; train_chrom_access_recon_loss: 3826741.7121; train_global_loss: 21486718.4242; train_optim_loss: 21486718.4242; val_kl_reg_loss: 34740.6035; val_edge_recon_loss: 590718.8516; val_gene_expr_recon_loss: 17039868.0000; val_masked_gp_l1_reg_loss: 60465.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72290.2656; val_chrom_access_recon_loss: 3785702.5625; val_global_loss: 21583786.0000; val_optim_loss: 21583786.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8753; val_auprc_score: 0.8418; val_best_acc_score: 0.8023; val_best_f1_score: 0.8232; train_kl_reg_loss: 37564.1392; train_edge_recon_loss: 593131.9470; train_gene_expr_recon_loss: 16896431.1364; train_masked_gp_l1_reg_loss: 60424.2540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72094.7847; train_chrom_access_recon_loss: 3825964.1326; train_global_loss: 21485610.4848; train_optim_loss: 21485610.4848; val_kl_reg_loss: 34419.6519; val_edge_recon_loss: 598972.3594; val_gene_expr_recon_loss: 17047269.0000; val_masked_gp_l1_reg_loss: 60376.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71889.5078; val_chrom_access_recon_loss: 3756457.9062; val_global_loss: 21569385.0000; val_optim_loss: 21569385.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8767; val_auprc_score: 0.8454; val_best_acc_score: 0.8012; val_best_f1_score: 0.8217; train_kl_reg_loss: 37603.5954; train_edge_recon_loss: 592650.8220; train_gene_expr_recon_loss: 16911402.7424; train_masked_gp_l1_reg_loss: 60344.9747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71756.3139; train_chrom_access_recon_loss: 3825295.4280; train_global_loss: 21499053.8788; train_optim_loss: 21499053.8788; val_kl_reg_loss: 34606.9790; val_edge_recon_loss: 602581.3672; val_gene_expr_recon_loss: 16850041.5000; val_masked_gp_l1_reg_loss: 60299.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71567.0938; val_chrom_access_recon_loss: 3773923.2500; val_global_loss: 21393020.7500; val_optim_loss: 21393020.7500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8828; val_auprc_score: 0.8472; val_best_acc_score: 0.8135; val_best_f1_score: 0.8277; train_kl_reg_loss: 37743.7216; train_edge_recon_loss: 594275.9044; train_gene_expr_recon_loss: 16904925.8939; train_masked_gp_l1_reg_loss: 60258.9757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71401.9931; train_chrom_access_recon_loss: 3826301.7879; train_global_loss: 21494908.3939; train_optim_loss: 21494908.3939; val_kl_reg_loss: 34510.4912; val_edge_recon_loss: 591918.0781; val_gene_expr_recon_loss: 16892629.1250; val_masked_gp_l1_reg_loss: 60215.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71226.3047; val_chrom_access_recon_loss: 3768590.9375; val_global_loss: 21419090.7500; val_optim_loss: 21419090.7500
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8794; val_auprc_score: 0.8462; val_best_acc_score: 0.8063; val_best_f1_score: 0.8264; train_kl_reg_loss: 37843.6932; train_edge_recon_loss: 592649.5805; train_gene_expr_recon_loss: 16889106.2121; train_masked_gp_l1_reg_loss: 60170.0948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71076.3294; train_chrom_access_recon_loss: 3823763.2879; train_global_loss: 21474609.1818; train_optim_loss: 21474609.1818; val_kl_reg_loss: 34941.3159; val_edge_recon_loss: 598199.7969; val_gene_expr_recon_loss: 17042750.7500; val_masked_gp_l1_reg_loss: 60141.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70890.5625; val_chrom_access_recon_loss: 3820192.3438; val_global_loss: 21627116.5000; val_optim_loss: 21627116.5000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8800; val_auprc_score: 0.8427; val_best_acc_score: 0.8033; val_best_f1_score: 0.8276; train_kl_reg_loss: 37901.9441; train_edge_recon_loss: 591831.7358; train_gene_expr_recon_loss: 16893377.4394; train_masked_gp_l1_reg_loss: 60085.1114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70755.0219; train_chrom_access_recon_loss: 3822698.1174; train_global_loss: 21476649.2424; train_optim_loss: 21476649.2424; val_kl_reg_loss: 35241.2778; val_edge_recon_loss: 600333.4375; val_gene_expr_recon_loss: 17132403.3750; val_masked_gp_l1_reg_loss: 60050.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70646.5625; val_chrom_access_recon_loss: 3790505.9062; val_global_loss: 21689180.0000; val_optim_loss: 21689180.0000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8908; val_auprc_score: 0.8584; val_best_acc_score: 0.8227; val_best_f1_score: 0.8381; train_kl_reg_loss: 38039.5411; train_edge_recon_loss: 592648.4934; train_gene_expr_recon_loss: 16892345.5152; train_masked_gp_l1_reg_loss: 60003.8133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70455.9102; train_chrom_access_recon_loss: 3824244.4318; train_global_loss: 21477737.6061; train_optim_loss: 21477737.6061; val_kl_reg_loss: 35056.3530; val_edge_recon_loss: 586938.6484; val_gene_expr_recon_loss: 17030974.0000; val_masked_gp_l1_reg_loss: 59954.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70278.1562; val_chrom_access_recon_loss: 3817998.7188; val_global_loss: 21601199.7500; val_optim_loss: 21601199.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.8813; val_auprc_score: 0.8540; val_best_acc_score: 0.8063; val_best_f1_score: 0.8280; train_kl_reg_loss: 38154.2752; train_edge_recon_loss: 593113.5634; train_gene_expr_recon_loss: 16885887.6515; train_masked_gp_l1_reg_loss: 59900.8187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68674.5521; train_chrom_access_recon_loss: 3818680.1894; train_global_loss: 21464411.0303; train_optim_loss: 21464411.0303; val_kl_reg_loss: 35434.5977; val_edge_recon_loss: 595869.0391; val_gene_expr_recon_loss: 17010254.2500; val_masked_gp_l1_reg_loss: 59875.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68349.0391; val_chrom_access_recon_loss: 3770902.1875; val_global_loss: 21540686.0000; val_optim_loss: 21540686.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.8792; val_auprc_score: 0.8488; val_best_acc_score: 0.8068; val_best_f1_score: 0.8270; train_kl_reg_loss: 38141.4176; train_edge_recon_loss: 593743.6023; train_gene_expr_recon_loss: 16891512.5152; train_masked_gp_l1_reg_loss: 59863.9788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68297.4626; train_chrom_access_recon_loss: 3820719.4811; train_global_loss: 21472278.6061; train_optim_loss: 21472278.6061; val_kl_reg_loss: 35172.7700; val_edge_recon_loss: 599807.1094; val_gene_expr_recon_loss: 16985930.7500; val_masked_gp_l1_reg_loss: 59855.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68257.6406; val_chrom_access_recon_loss: 3766964.8750; val_global_loss: 21515989.5000; val_optim_loss: 21515989.5000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.8842; val_auprc_score: 0.8509; val_best_acc_score: 0.8127; val_best_f1_score: 0.8309; train_kl_reg_loss: 38131.4917; train_edge_recon_loss: 590656.9972; train_gene_expr_recon_loss: 16888935.9697; train_masked_gp_l1_reg_loss: 59849.0297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68223.3929; train_chrom_access_recon_loss: 3825337.0152; train_global_loss: 21471133.8788; train_optim_loss: 21471133.8788; val_kl_reg_loss: 35366.8223; val_edge_recon_loss: 600190.6094; val_gene_expr_recon_loss: 16964072.0000; val_masked_gp_l1_reg_loss: 59842.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68184.1250; val_chrom_access_recon_loss: 3802694.5312; val_global_loss: 21530349.7500; val_optim_loss: 21530349.7500
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.8836; val_auprc_score: 0.8539; val_best_acc_score: 0.8119; val_best_f1_score: 0.8284; train_kl_reg_loss: 38220.9846; train_edge_recon_loss: 589116.4186; train_gene_expr_recon_loss: 16902281.9848; train_masked_gp_l1_reg_loss: 59838.1409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68151.8691; train_chrom_access_recon_loss: 3827086.5152; train_global_loss: 21484695.7879; train_optim_loss: 21484695.7879; val_kl_reg_loss: 35183.1646; val_edge_recon_loss: 599336.8047; val_gene_expr_recon_loss: 16997144.1250; val_masked_gp_l1_reg_loss: 59831.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68124.5312; val_chrom_access_recon_loss: 3789552.4062; val_global_loss: 21549172.0000; val_optim_loss: 21549172.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 20 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.8811
val AUPRC score: 0.8454
val best accuracy score: 0.8130
val best F1 score: 0.8282
val target rna MSE score: 1.9126
val source rna MSE score: 0.8777
val target atac MSE score: 0.4657
val source atac MSE score: 0.1925
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
