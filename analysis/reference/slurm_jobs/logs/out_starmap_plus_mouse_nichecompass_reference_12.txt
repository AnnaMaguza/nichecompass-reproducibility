[True, True]
Run timestamp: 29012024_123905_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', 'batch8', 'batch9', 'batch10', 'batch11', 'batch12', 'batch13', 'batch14', 'batch15', 'batch16', 'batch17', 'batch18', 'batch19', 'batch20', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'dataset', '--cat_covariates_no_edges', 'True', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '28', '2', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '50000.', '--lambda_gene_expr_recon', '30.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch9...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch10...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch11...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch12...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch13...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch14...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch15...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch16...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch17...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch18...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch19...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch20...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 931, n_cat_covariates_embed_input: 0, n_hidden: 931, n_latent: 1412, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1412, n_addon_gp_input: 10, n_cat_covariates_embed_input: 30, n_output: 931
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1412, n_addon_gp_input: 10, n_cat_covariates_embed_input: 30, n_output: 931

--- INITIALIZING TRAINER ---
Number of training nodes: 982152
Number of validation nodes: 109128
Number of training edges: 4503608
Number of validation edges: 500400
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9508; val_auprc_score: 0.9942; val_best_acc_score: 0.9702; val_best_f1_score: 0.9840; train_kl_reg_loss: 871.9141; train_edge_recon_loss: 4904.2268; train_gene_expr_recon_loss: 15639.3326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 21415.4735; train_optim_loss: 21415.4735; val_kl_reg_loss: 1028.1161; val_edge_recon_loss: 4594.4064; val_gene_expr_recon_loss: 13963.7826; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19586.3051; val_optim_loss: 19586.3051
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9529; val_auprc_score: 0.9944; val_best_acc_score: 0.9697; val_best_f1_score: 0.9837; train_kl_reg_loss: 1029.6415; train_edge_recon_loss: 4907.6377; train_gene_expr_recon_loss: 14000.6282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19937.9074; train_optim_loss: 19937.9074; val_kl_reg_loss: 1081.9708; val_edge_recon_loss: 4689.3115; val_gene_expr_recon_loss: 13568.9268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19340.2091; val_optim_loss: 19340.2091
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9556; val_auprc_score: 0.9948; val_best_acc_score: 0.9714; val_best_f1_score: 0.9846; train_kl_reg_loss: 1074.5493; train_edge_recon_loss: 4914.2290; train_gene_expr_recon_loss: 13697.9137; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19686.6921; train_optim_loss: 19686.6921; val_kl_reg_loss: 1119.0470; val_edge_recon_loss: 4676.6802; val_gene_expr_recon_loss: 13280.3703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19076.0975; val_optim_loss: 19076.0975
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9599; val_auprc_score: 0.9954; val_best_acc_score: 0.9726; val_best_f1_score: 0.9853; train_kl_reg_loss: 1169.8021; train_edge_recon_loss: 4921.4097; train_gene_expr_recon_loss: 13641.3643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19732.5761; train_optim_loss: 19732.5761; val_kl_reg_loss: 1164.4886; val_edge_recon_loss: 4657.8551; val_gene_expr_recon_loss: 13254.5360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19076.8798; val_optim_loss: 19076.8798
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9589; val_auprc_score: 0.9953; val_best_acc_score: 0.9720; val_best_f1_score: 0.9850; train_kl_reg_loss: 1146.0825; train_edge_recon_loss: 4913.2484; train_gene_expr_recon_loss: 13506.4022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19565.7331; train_optim_loss: 19565.7331; val_kl_reg_loss: 1195.7344; val_edge_recon_loss: 4654.4049; val_gene_expr_recon_loss: 13211.3567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19061.4961; val_optim_loss: 19061.4961
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9606; val_auprc_score: 0.9956; val_best_acc_score: 0.9717; val_best_f1_score: 0.9848; train_kl_reg_loss: 1279.3896; train_edge_recon_loss: 4926.8892; train_gene_expr_recon_loss: 13586.2486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19792.5273; train_optim_loss: 19792.5273; val_kl_reg_loss: 1547.7568; val_edge_recon_loss: 4675.9475; val_gene_expr_recon_loss: 13575.9034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19799.6078; val_optim_loss: 19799.6078
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9597; val_auprc_score: 0.9955; val_best_acc_score: 0.9724; val_best_f1_score: 0.9852; train_kl_reg_loss: 1320.8897; train_edge_recon_loss: 4910.2789; train_gene_expr_recon_loss: 13603.5642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19834.7328; train_optim_loss: 19834.7328; val_kl_reg_loss: 1330.8660; val_edge_recon_loss: 4617.7251; val_gene_expr_recon_loss: 13262.4339; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19211.0250; val_optim_loss: 19211.0250
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9617; val_auprc_score: 0.9956; val_best_acc_score: 0.9727; val_best_f1_score: 0.9854; train_kl_reg_loss: 1331.7396; train_edge_recon_loss: 4925.2566; train_gene_expr_recon_loss: 13599.2690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19856.2652; train_optim_loss: 19856.2652; val_kl_reg_loss: 1200.6972; val_edge_recon_loss: 4659.6513; val_gene_expr_recon_loss: 13120.0355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18980.3840; val_optim_loss: 18980.3840
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9606; val_auprc_score: 0.9956; val_best_acc_score: 0.9718; val_best_f1_score: 0.9848; train_kl_reg_loss: 1587.2885; train_edge_recon_loss: 4904.0311; train_gene_expr_recon_loss: 13865.1866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20356.5062; train_optim_loss: 20356.5062; val_kl_reg_loss: 1501.7713; val_edge_recon_loss: 4683.3508; val_gene_expr_recon_loss: 13493.5030; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19678.6251; val_optim_loss: 19678.6251
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9584; val_auprc_score: 0.9952; val_best_acc_score: 0.9720; val_best_f1_score: 0.9850; train_kl_reg_loss: 1563.0498; train_edge_recon_loss: 4884.2742; train_gene_expr_recon_loss: 13916.4503; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20363.7743; train_optim_loss: 20363.7743; val_kl_reg_loss: 1535.3256; val_edge_recon_loss: 4667.2788; val_gene_expr_recon_loss: 13562.0859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19764.6903; val_optim_loss: 19764.6903
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9593; val_auprc_score: 0.9953; val_best_acc_score: 0.9727; val_best_f1_score: 0.9854; train_kl_reg_loss: 1307.7212; train_edge_recon_loss: 4909.5339; train_gene_expr_recon_loss: 13644.1950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19861.4501; train_optim_loss: 19861.4501; val_kl_reg_loss: 1247.9781; val_edge_recon_loss: 4654.2775; val_gene_expr_recon_loss: 13240.3715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19142.6271; val_optim_loss: 19142.6271
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9602; val_auprc_score: 0.9955; val_best_acc_score: 0.9724; val_best_f1_score: 0.9852; train_kl_reg_loss: 1338.4360; train_edge_recon_loss: 4919.4364; train_gene_expr_recon_loss: 13635.2659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19893.1383; train_optim_loss: 19893.1383; val_kl_reg_loss: 1274.1326; val_edge_recon_loss: 4647.1638; val_gene_expr_recon_loss: 13263.4651; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 19184.7614; val_optim_loss: 19184.7614

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9627; val_auprc_score: 0.9958; val_best_acc_score: 0.9726; val_best_f1_score: 0.9853; train_kl_reg_loss: 1147.5750; train_edge_recon_loss: 4916.1904; train_gene_expr_recon_loss: 13353.7050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19417.4704; train_optim_loss: 19417.4704; val_kl_reg_loss: 1111.9015; val_edge_recon_loss: 4628.0047; val_gene_expr_recon_loss: 13015.7578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18755.6640; val_optim_loss: 18755.6640
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9623; val_auprc_score: 0.9957; val_best_acc_score: 0.9729; val_best_f1_score: 0.9854; train_kl_reg_loss: 1097.2493; train_edge_recon_loss: 4910.3126; train_gene_expr_recon_loss: 13264.6780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19272.2400; train_optim_loss: 19272.2400; val_kl_reg_loss: 1095.2417; val_edge_recon_loss: 4658.5576; val_gene_expr_recon_loss: 12955.1498; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18708.9491; val_optim_loss: 18708.9491
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9616; val_auprc_score: 0.9957; val_best_acc_score: 0.9735; val_best_f1_score: 0.9858; train_kl_reg_loss: 1073.7338; train_edge_recon_loss: 4920.5301; train_gene_expr_recon_loss: 13215.9960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19210.2600; train_optim_loss: 19210.2600; val_kl_reg_loss: 1074.5370; val_edge_recon_loss: 4606.9959; val_gene_expr_recon_loss: 12922.1407; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18603.6735; val_optim_loss: 18603.6735
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9614; val_auprc_score: 0.9957; val_best_acc_score: 0.9733; val_best_f1_score: 0.9856; train_kl_reg_loss: 1063.2068; train_edge_recon_loss: 4921.4284; train_gene_expr_recon_loss: 13184.1244; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19168.7597; train_optim_loss: 19168.7597; val_kl_reg_loss: 1061.0575; val_edge_recon_loss: 4550.8203; val_gene_expr_recon_loss: 12902.7551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18514.6328; val_optim_loss: 18514.6328
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9626; val_auprc_score: 0.9957; val_best_acc_score: 0.9736; val_best_f1_score: 0.9858; train_kl_reg_loss: 1057.1107; train_edge_recon_loss: 4935.8249; train_gene_expr_recon_loss: 13164.6419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19157.5775; train_optim_loss: 19157.5775; val_kl_reg_loss: 1062.4765; val_edge_recon_loss: 4601.7935; val_gene_expr_recon_loss: 12892.1241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18556.3941; val_optim_loss: 18556.3941
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9631; val_auprc_score: 0.9959; val_best_acc_score: 0.9734; val_best_f1_score: 0.9857; train_kl_reg_loss: 1053.5453; train_edge_recon_loss: 4919.4555; train_gene_expr_recon_loss: 13144.2659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19117.2667; train_optim_loss: 19117.2667; val_kl_reg_loss: 1081.8023; val_edge_recon_loss: 4628.2016; val_gene_expr_recon_loss: 12875.4686; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18585.4725; val_optim_loss: 18585.4725
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9630; val_auprc_score: 0.9958; val_best_acc_score: 0.9742; val_best_f1_score: 0.9861; train_kl_reg_loss: 1050.3611; train_edge_recon_loss: 4918.4705; train_gene_expr_recon_loss: 13129.7732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19098.6049; train_optim_loss: 19098.6049; val_kl_reg_loss: 1054.1026; val_edge_recon_loss: 4568.9220; val_gene_expr_recon_loss: 12855.2360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18478.2606; val_optim_loss: 18478.2606
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9630; val_auprc_score: 0.9958; val_best_acc_score: 0.9743; val_best_f1_score: 0.9862; train_kl_reg_loss: 1049.2752; train_edge_recon_loss: 4921.2631; train_gene_expr_recon_loss: 13112.2061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19082.7444; train_optim_loss: 19082.7444; val_kl_reg_loss: 1046.3063; val_edge_recon_loss: 4606.9355; val_gene_expr_recon_loss: 12841.8332; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18495.0751; val_optim_loss: 18495.0751
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9623; val_auprc_score: 0.9957; val_best_acc_score: 0.9736; val_best_f1_score: 0.9858; train_kl_reg_loss: 1048.7156; train_edge_recon_loss: 4916.1200; train_gene_expr_recon_loss: 13101.2960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19066.1315; train_optim_loss: 19066.1315; val_kl_reg_loss: 1051.4064; val_edge_recon_loss: 4602.7928; val_gene_expr_recon_loss: 12823.6750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18477.8742; val_optim_loss: 18477.8742
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9619; val_auprc_score: 0.9956; val_best_acc_score: 0.9735; val_best_f1_score: 0.9858; train_kl_reg_loss: 1049.0538; train_edge_recon_loss: 4929.0386; train_gene_expr_recon_loss: 13088.3388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19066.4312; train_optim_loss: 19066.4312; val_kl_reg_loss: 1055.3530; val_edge_recon_loss: 4617.3493; val_gene_expr_recon_loss: 12807.5571; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18480.2594; val_optim_loss: 18480.2594
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9629; val_auprc_score: 0.9957; val_best_acc_score: 0.9741; val_best_f1_score: 0.9861; train_kl_reg_loss: 1049.3934; train_edge_recon_loss: 4913.9979; train_gene_expr_recon_loss: 13080.1208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19043.5121; train_optim_loss: 19043.5121; val_kl_reg_loss: 1057.2496; val_edge_recon_loss: 4643.0916; val_gene_expr_recon_loss: 12813.3490; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18513.6902; val_optim_loss: 18513.6902
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9631; val_auprc_score: 0.9958; val_best_acc_score: 0.9739; val_best_f1_score: 0.9860; train_kl_reg_loss: 1049.4280; train_edge_recon_loss: 4913.8557; train_gene_expr_recon_loss: 13071.4580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19034.7417; train_optim_loss: 19034.7417; val_kl_reg_loss: 1052.8713; val_edge_recon_loss: 4634.2884; val_gene_expr_recon_loss: 12813.4346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18500.5943; val_optim_loss: 18500.5943
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9647; val_auprc_score: 0.9960; val_best_acc_score: 0.9743; val_best_f1_score: 0.9862; train_kl_reg_loss: 1050.4488; train_edge_recon_loss: 4921.5997; train_gene_expr_recon_loss: 13061.2779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 19033.3264; train_optim_loss: 19033.3264; val_kl_reg_loss: 1058.4644; val_edge_recon_loss: 4607.0138; val_gene_expr_recon_loss: 12792.7890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18458.2672; val_optim_loss: 18458.2672
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9639; val_auprc_score: 0.9957; val_best_acc_score: 0.9756; val_best_f1_score: 0.9869; train_kl_reg_loss: 1107.1194; train_edge_recon_loss: 4655.6990; train_gene_expr_recon_loss: 13040.1506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18802.9691; train_optim_loss: 18802.9691; val_kl_reg_loss: 1117.4397; val_edge_recon_loss: 4502.8471; val_gene_expr_recon_loss: 12796.7387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18417.0256; val_optim_loss: 18417.0256
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9649; val_auprc_score: 0.9960; val_best_acc_score: 0.9760; val_best_f1_score: 0.9871; train_kl_reg_loss: 1120.4293; train_edge_recon_loss: 4612.6414; train_gene_expr_recon_loss: 13041.0083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18774.0790; train_optim_loss: 18774.0790; val_kl_reg_loss: 1125.5164; val_edge_recon_loss: 4463.3919; val_gene_expr_recon_loss: 12786.9058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18375.8141; val_optim_loss: 18375.8141
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9665; val_auprc_score: 0.9961; val_best_acc_score: 0.9764; val_best_f1_score: 0.9873; train_kl_reg_loss: 1131.1041; train_edge_recon_loss: 4606.4523; train_gene_expr_recon_loss: 13036.6287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18774.1852; train_optim_loss: 18774.1852; val_kl_reg_loss: 1140.9057; val_edge_recon_loss: 4464.8973; val_gene_expr_recon_loss: 12780.6406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18386.4436; val_optim_loss: 18386.4436
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9664; val_auprc_score: 0.9961; val_best_acc_score: 0.9762; val_best_f1_score: 0.9872; train_kl_reg_loss: 1137.5678; train_edge_recon_loss: 4589.6660; train_gene_expr_recon_loss: 13034.9315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18762.1653; train_optim_loss: 18762.1653; val_kl_reg_loss: 1139.9222; val_edge_recon_loss: 4469.9538; val_gene_expr_recon_loss: 12792.7029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18402.5789; val_optim_loss: 18402.5789
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9660; val_auprc_score: 0.9961; val_best_acc_score: 0.9763; val_best_f1_score: 0.9873; train_kl_reg_loss: 1141.1283; train_edge_recon_loss: 4584.4369; train_gene_expr_recon_loss: 13029.2825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18754.8476; train_optim_loss: 18754.8476; val_kl_reg_loss: 1153.5259; val_edge_recon_loss: 4431.8200; val_gene_expr_recon_loss: 12781.1554; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18366.5013; val_optim_loss: 18366.5013
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9674; val_auprc_score: 0.9963; val_best_acc_score: 0.9766; val_best_f1_score: 0.9875; train_kl_reg_loss: 1145.0861; train_edge_recon_loss: 4568.5171; train_gene_expr_recon_loss: 13023.1162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18736.7193; train_optim_loss: 18736.7193; val_kl_reg_loss: 1158.3677; val_edge_recon_loss: 4443.5830; val_gene_expr_recon_loss: 12775.0580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18377.0087; val_optim_loss: 18377.0087
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9690; val_auprc_score: 0.9965; val_best_acc_score: 0.9770; val_best_f1_score: 0.9877; train_kl_reg_loss: 1149.0279; train_edge_recon_loss: 4573.2272; train_gene_expr_recon_loss: 13017.6739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18739.9289; train_optim_loss: 18739.9289; val_kl_reg_loss: 1150.4501; val_edge_recon_loss: 4439.9244; val_gene_expr_recon_loss: 12774.3937; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18364.7682; val_optim_loss: 18364.7682
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9686; val_auprc_score: 0.9965; val_best_acc_score: 0.9770; val_best_f1_score: 0.9876; train_kl_reg_loss: 1152.6250; train_edge_recon_loss: 4571.9245; train_gene_expr_recon_loss: 13006.6795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18731.2290; train_optim_loss: 18731.2290; val_kl_reg_loss: 1162.8459; val_edge_recon_loss: 4403.1389; val_gene_expr_recon_loss: 12760.5436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18326.5284; val_optim_loss: 18326.5284
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9682; val_auprc_score: 0.9964; val_best_acc_score: 0.9766; val_best_f1_score: 0.9874; train_kl_reg_loss: 1155.6867; train_edge_recon_loss: 4559.7062; train_gene_expr_recon_loss: 13004.4923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18719.8852; train_optim_loss: 18719.8852; val_kl_reg_loss: 1164.4202; val_edge_recon_loss: 4429.0149; val_gene_expr_recon_loss: 12760.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18354.0694; val_optim_loss: 18354.0694
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9681; val_auprc_score: 0.9964; val_best_acc_score: 0.9769; val_best_f1_score: 0.9876; train_kl_reg_loss: 1158.8104; train_edge_recon_loss: 4563.9219; train_gene_expr_recon_loss: 13000.9384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18723.6707; train_optim_loss: 18723.6707; val_kl_reg_loss: 1164.3865; val_edge_recon_loss: 4411.4066; val_gene_expr_recon_loss: 12749.9336; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18325.7267; val_optim_loss: 18325.7267
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9669; val_auprc_score: 0.9962; val_best_acc_score: 0.9767; val_best_f1_score: 0.9875; train_kl_reg_loss: 1160.4083; train_edge_recon_loss: 4551.6778; train_gene_expr_recon_loss: 12990.5255; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18702.6115; train_optim_loss: 18702.6115; val_kl_reg_loss: 1174.3756; val_edge_recon_loss: 4436.1477; val_gene_expr_recon_loss: 12752.3103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18362.8337; val_optim_loss: 18362.8337
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9677; val_auprc_score: 0.9964; val_best_acc_score: 0.9768; val_best_f1_score: 0.9876; train_kl_reg_loss: 1164.7712; train_edge_recon_loss: 4558.8326; train_gene_expr_recon_loss: 12988.5757; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18712.1794; train_optim_loss: 18712.1794; val_kl_reg_loss: 1173.9413; val_edge_recon_loss: 4390.6609; val_gene_expr_recon_loss: 12741.1391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18305.7412; val_optim_loss: 18305.7412
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9683; val_auprc_score: 0.9965; val_best_acc_score: 0.9776; val_best_f1_score: 0.9880; train_kl_reg_loss: 1167.5648; train_edge_recon_loss: 4562.2960; train_gene_expr_recon_loss: 12980.3025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18710.1633; train_optim_loss: 18710.1633; val_kl_reg_loss: 1171.6789; val_edge_recon_loss: 4369.2174; val_gene_expr_recon_loss: 12746.4930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18287.3892; val_optim_loss: 18287.3892
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9692; val_auprc_score: 0.9965; val_best_acc_score: 0.9770; val_best_f1_score: 0.9876; train_kl_reg_loss: 1167.6866; train_edge_recon_loss: 4550.1903; train_gene_expr_recon_loss: 12981.1312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18699.0081; train_optim_loss: 18699.0081; val_kl_reg_loss: 1169.9893; val_edge_recon_loss: 4462.7699; val_gene_expr_recon_loss: 12734.4761; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18367.2353; val_optim_loss: 18367.2353
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9685; val_auprc_score: 0.9965; val_best_acc_score: 0.9771; val_best_f1_score: 0.9877; train_kl_reg_loss: 1170.2100; train_edge_recon_loss: 4553.1619; train_gene_expr_recon_loss: 12971.8307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18695.2025; train_optim_loss: 18695.2025; val_kl_reg_loss: 1182.1841; val_edge_recon_loss: 4430.0885; val_gene_expr_recon_loss: 12731.2046; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18343.4773; val_optim_loss: 18343.4773
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9688; val_auprc_score: 0.9965; val_best_acc_score: 0.9770; val_best_f1_score: 0.9876; train_kl_reg_loss: 1172.8269; train_edge_recon_loss: 4541.4736; train_gene_expr_recon_loss: 12969.8373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18684.1378; train_optim_loss: 18684.1378; val_kl_reg_loss: 1176.2336; val_edge_recon_loss: 4417.7919; val_gene_expr_recon_loss: 12725.0947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18319.1202; val_optim_loss: 18319.1202
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9698; val_auprc_score: 0.9966; val_best_acc_score: 0.9772; val_best_f1_score: 0.9878; train_kl_reg_loss: 1173.4824; train_edge_recon_loss: 4541.1185; train_gene_expr_recon_loss: 12963.5434; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18678.1442; train_optim_loss: 18678.1442; val_kl_reg_loss: 1173.4637; val_edge_recon_loss: 4439.7230; val_gene_expr_recon_loss: 12729.4312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18342.6180; val_optim_loss: 18342.6180

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9685; val_auprc_score: 0.9964; val_best_acc_score: 0.9773; val_best_f1_score: 0.9878; train_kl_reg_loss: 1166.5594; train_edge_recon_loss: 4543.7787; train_gene_expr_recon_loss: 12945.3246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18655.6626; train_optim_loss: 18655.6626; val_kl_reg_loss: 1166.1119; val_edge_recon_loss: 4402.0244; val_gene_expr_recon_loss: 12719.8050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18287.9413; val_optim_loss: 18287.9413
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9684; val_auprc_score: 0.9965; val_best_acc_score: 0.9772; val_best_f1_score: 0.9878; train_kl_reg_loss: 1165.4340; train_edge_recon_loss: 4551.1264; train_gene_expr_recon_loss: 12938.1950; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18654.7555; train_optim_loss: 18654.7555; val_kl_reg_loss: 1165.2619; val_edge_recon_loss: 4396.3696; val_gene_expr_recon_loss: 12703.2085; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18264.8399; val_optim_loss: 18264.8399
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9693; val_auprc_score: 0.9965; val_best_acc_score: 0.9773; val_best_f1_score: 0.9878; train_kl_reg_loss: 1164.7708; train_edge_recon_loss: 4539.9545; train_gene_expr_recon_loss: 12936.0242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18640.7495; train_optim_loss: 18640.7495; val_kl_reg_loss: 1168.7554; val_edge_recon_loss: 4409.1700; val_gene_expr_recon_loss: 12704.0014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18281.9268; val_optim_loss: 18281.9268
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9690; val_auprc_score: 0.9966; val_best_acc_score: 0.9772; val_best_f1_score: 0.9878; train_kl_reg_loss: 1165.3488; train_edge_recon_loss: 4546.4016; train_gene_expr_recon_loss: 12936.5332; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 18648.2835; train_optim_loss: 18648.2835; val_kl_reg_loss: 1170.5639; val_edge_recon_loss: 4399.2166; val_gene_expr_recon_loss: 12705.8941; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18275.6746; val_optim_loss: 18275.6746
