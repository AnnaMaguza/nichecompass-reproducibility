None
Run timestamp: 14082023_203100_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '10.0', '--lambda_l1_masked', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 195913
Number of validation edges: 21768
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9751; val_auprc_score: 0.9655; val_best_acc_score: 0.9382; val_best_f1_score: 0.9399; train_kl_reg_loss: 7722.9125; train_edge_recon_loss: 269825.6890; train_gene_expr_recon_loss: 210096.0269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 2950.0743; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 490594.7019; train_optim_loss: 490594.7019; val_kl_reg_loss: 7539.5700; val_edge_recon_loss: 264319.0209; val_gene_expr_recon_loss: 196069.5345; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3535.4727; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 471463.5948; val_optim_loss: 471463.5948
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9816; val_auprc_score: 0.9738; val_best_acc_score: 0.9492; val_best_f1_score: 0.9503; train_kl_reg_loss: 7532.2319; train_edge_recon_loss: 261649.2660; train_gene_expr_recon_loss: 189258.3219; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 3798.5849; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 462238.4040; train_optim_loss: 462238.4040; val_kl_reg_loss: 7250.5552; val_edge_recon_loss: 262881.7562; val_gene_expr_recon_loss: 187726.8834; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 3992.5996; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 461851.7871; val_optim_loss: 461851.7871
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9818; val_auprc_score: 0.9732; val_best_acc_score: 0.9521; val_best_f1_score: 0.9532; train_kl_reg_loss: 7334.1633; train_edge_recon_loss: 260656.2811; train_gene_expr_recon_loss: 183129.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4126.5149; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 455246.9291; train_optim_loss: 455246.9291; val_kl_reg_loss: 6998.2525; val_edge_recon_loss: 261967.0253; val_gene_expr_recon_loss: 183042.3968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4211.6167; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 456219.3023; val_optim_loss: 456219.3023
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9812; val_auprc_score: 0.9721; val_best_acc_score: 0.9521; val_best_f1_score: 0.9536; train_kl_reg_loss: 7189.7981; train_edge_recon_loss: 260183.6849; train_gene_expr_recon_loss: 179791.8866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4274.6526; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 451440.0237; train_optim_loss: 451440.0237; val_kl_reg_loss: 7014.9763; val_edge_recon_loss: 262993.2362; val_gene_expr_recon_loss: 180060.9346; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4308.5269; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 454377.6806; val_optim_loss: 454377.6806
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9835; val_auprc_score: 0.9766; val_best_acc_score: 0.9565; val_best_f1_score: 0.9576; train_kl_reg_loss: 7080.5820; train_edge_recon_loss: 259883.1061; train_gene_expr_recon_loss: 177830.9732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4298.5373; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449093.1982; train_optim_loss: 449093.1982; val_kl_reg_loss: 6815.0245; val_edge_recon_loss: 262337.2891; val_gene_expr_recon_loss: 179115.5187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4291.0127; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 452558.8354; val_optim_loss: 452558.8354
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9839; val_auprc_score: 0.9773; val_best_acc_score: 0.9572; val_best_f1_score: 0.9583; train_kl_reg_loss: 7016.7471; train_edge_recon_loss: 259461.3110; train_gene_expr_recon_loss: 176591.6389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4260.6049; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447330.3015; train_optim_loss: 447330.3015; val_kl_reg_loss: 6894.0672; val_edge_recon_loss: 261833.9359; val_gene_expr_recon_loss: 178085.8187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4220.5879; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 451034.4142; val_optim_loss: 451034.4142
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9842; val_auprc_score: 0.9775; val_best_acc_score: 0.9581; val_best_f1_score: 0.9590; train_kl_reg_loss: 6957.0125; train_edge_recon_loss: 259135.5648; train_gene_expr_recon_loss: 175851.7353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4206.3901; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446150.7024; train_optim_loss: 446150.7024; val_kl_reg_loss: 6890.1051; val_edge_recon_loss: 261622.3381; val_gene_expr_recon_loss: 177822.8051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4175.0469; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 450510.2987; val_optim_loss: 450510.2987
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9861; val_auprc_score: 0.9802; val_best_acc_score: 0.9605; val_best_f1_score: 0.9614; train_kl_reg_loss: 6916.2735; train_edge_recon_loss: 259185.1133; train_gene_expr_recon_loss: 175402.9085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4171.2686; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445675.5636; train_optim_loss: 445675.5636; val_kl_reg_loss: 6712.5835; val_edge_recon_loss: 260695.7649; val_gene_expr_recon_loss: 177318.3418; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4145.0386; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448871.7213; val_optim_loss: 448871.7213
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9866; val_auprc_score: 0.9804; val_best_acc_score: 0.9632; val_best_f1_score: 0.9639; train_kl_reg_loss: 6880.2550; train_edge_recon_loss: 258987.7766; train_gene_expr_recon_loss: 174811.0481; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4129.0050; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444808.0850; train_optim_loss: 444808.0850; val_kl_reg_loss: 6773.5191; val_edge_recon_loss: 260627.0578; val_gene_expr_recon_loss: 176708.7825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4108.1719; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448217.5334; val_optim_loss: 448217.5334
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9871; val_auprc_score: 0.9824; val_best_acc_score: 0.9616; val_best_f1_score: 0.9625; train_kl_reg_loss: 6847.4735; train_edge_recon_loss: 259022.4293; train_gene_expr_recon_loss: 174736.9564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4101.4545; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444708.3138; train_optim_loss: 444708.3138; val_kl_reg_loss: 6717.5227; val_edge_recon_loss: 260694.2202; val_gene_expr_recon_loss: 176597.4697; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4083.2744; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448092.4942; val_optim_loss: 448092.4942
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9873; val_auprc_score: 0.9820; val_best_acc_score: 0.9641; val_best_f1_score: 0.9649; train_kl_reg_loss: 6842.1714; train_edge_recon_loss: 258683.5514; train_gene_expr_recon_loss: 174522.0335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4085.8693; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 444133.6265; train_optim_loss: 444133.6265; val_kl_reg_loss: 6588.4659; val_edge_recon_loss: 260196.0996; val_gene_expr_recon_loss: 176917.6027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4092.5620; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447794.7329; val_optim_loss: 447794.7329
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9880; val_auprc_score: 0.9829; val_best_acc_score: 0.9650; val_best_f1_score: 0.9658; train_kl_reg_loss: 6828.6461; train_edge_recon_loss: 258625.1552; train_gene_expr_recon_loss: 174162.1156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4090.4553; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443706.3718; train_optim_loss: 443706.3718; val_kl_reg_loss: 6628.8800; val_edge_recon_loss: 260201.3497; val_gene_expr_recon_loss: 176144.7251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4092.6013; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447067.5472; val_optim_loss: 447067.5472
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9872; val_auprc_score: 0.9819; val_best_acc_score: 0.9638; val_best_f1_score: 0.9646; train_kl_reg_loss: 6809.1090; train_edge_recon_loss: 258619.1642; train_gene_expr_recon_loss: 174110.7955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4092.8822; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443631.9505; train_optim_loss: 443631.9505; val_kl_reg_loss: 6749.1294; val_edge_recon_loss: 259979.2478; val_gene_expr_recon_loss: 176310.9064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4076.4905; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447115.7834; val_optim_loss: 447115.7834
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9867; val_auprc_score: 0.9815; val_best_acc_score: 0.9635; val_best_f1_score: 0.9643; train_kl_reg_loss: 6798.0423; train_edge_recon_loss: 258549.5059; train_gene_expr_recon_loss: 174112.1425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4091.7769; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443551.4674; train_optim_loss: 443551.4674; val_kl_reg_loss: 6659.1428; val_edge_recon_loss: 261089.1737; val_gene_expr_recon_loss: 176024.6675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4101.9150; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447874.8921; val_optim_loss: 447874.8921
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9885; val_auprc_score: 0.9839; val_best_acc_score: 0.9654; val_best_f1_score: 0.9661; train_kl_reg_loss: 6796.0172; train_edge_recon_loss: 258467.8995; train_gene_expr_recon_loss: 173737.8465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4099.2224; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 443100.9856; train_optim_loss: 443100.9856; val_kl_reg_loss: 6600.3683; val_edge_recon_loss: 260749.9488; val_gene_expr_recon_loss: 175862.5821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4104.5894; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447317.4909; val_optim_loss: 447317.4909
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9887; val_auprc_score: 0.9843; val_best_acc_score: 0.9662; val_best_f1_score: 0.9669; train_kl_reg_loss: 6787.7960; train_edge_recon_loss: 258340.2972; train_gene_expr_recon_loss: 173632.8683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4108.0845; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442869.0456; train_optim_loss: 442869.0456; val_kl_reg_loss: 6781.6273; val_edge_recon_loss: 259792.5207; val_gene_expr_recon_loss: 176131.6126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4101.1987; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446806.9488; val_optim_loss: 446806.9488
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9894; val_auprc_score: 0.9857; val_best_acc_score: 0.9666; val_best_f1_score: 0.9672; train_kl_reg_loss: 6786.0462; train_edge_recon_loss: 258232.4149; train_gene_expr_recon_loss: 173737.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4117.1931; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442872.7209; train_optim_loss: 442872.7209; val_kl_reg_loss: 6613.8411; val_edge_recon_loss: 260134.0640; val_gene_expr_recon_loss: 176130.8970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4126.2563; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447005.0520; val_optim_loss: 447005.0520
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9897; val_auprc_score: 0.9860; val_best_acc_score: 0.9674; val_best_f1_score: 0.9681; train_kl_reg_loss: 6771.7550; train_edge_recon_loss: 258429.1443; train_gene_expr_recon_loss: 173584.0036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4136.4102; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442921.3137; train_optim_loss: 442921.3137; val_kl_reg_loss: 6735.8544; val_edge_recon_loss: 259958.0634; val_gene_expr_recon_loss: 175762.9221; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4151.6255; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446608.4633; val_optim_loss: 446608.4633
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9896; val_auprc_score: 0.9857; val_best_acc_score: 0.9678; val_best_f1_score: 0.9684; train_kl_reg_loss: 6772.5157; train_edge_recon_loss: 258259.0105; train_gene_expr_recon_loss: 173709.1013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4143.2246; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442883.8531; train_optim_loss: 442883.8531; val_kl_reg_loss: 6578.8796; val_edge_recon_loss: 260049.2260; val_gene_expr_recon_loss: 176061.7734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4146.5303; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446836.4110; val_optim_loss: 446836.4110
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9897; val_auprc_score: 0.9848; val_best_acc_score: 0.9691; val_best_f1_score: 0.9696; train_kl_reg_loss: 6776.9944; train_edge_recon_loss: 258234.2647; train_gene_expr_recon_loss: 173496.1933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4149.1812; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442656.6337; train_optim_loss: 442656.6337; val_kl_reg_loss: 6659.0715; val_edge_recon_loss: 259824.7515; val_gene_expr_recon_loss: 176370.5154; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4145.4468; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446999.7783; val_optim_loss: 446999.7783
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9900; val_auprc_score: 0.9869; val_best_acc_score: 0.9669; val_best_f1_score: 0.9677; train_kl_reg_loss: 6764.8301; train_edge_recon_loss: 258269.5870; train_gene_expr_recon_loss: 173389.7607; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4154.4903; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442578.6682; train_optim_loss: 442578.6682; val_kl_reg_loss: 6827.3116; val_edge_recon_loss: 260975.5669; val_gene_expr_recon_loss: 175801.1980; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4156.7881; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447760.8579; val_optim_loss: 447760.8579
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9907; val_auprc_score: 0.9876; val_best_acc_score: 0.9687; val_best_f1_score: 0.9693; train_kl_reg_loss: 6787.7365; train_edge_recon_loss: 258075.6411; train_gene_expr_recon_loss: 173384.0954; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4165.6710; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442413.1441; train_optim_loss: 442413.1441; val_kl_reg_loss: 6685.4279; val_edge_recon_loss: 259322.2902; val_gene_expr_recon_loss: 175948.5169; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4179.7441; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446135.9858; val_optim_loss: 446135.9858
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9899; val_auprc_score: 0.9863; val_best_acc_score: 0.9685; val_best_f1_score: 0.9690; train_kl_reg_loss: 6762.8769; train_edge_recon_loss: 258114.6666; train_gene_expr_recon_loss: 173224.7477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4175.1073; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442277.3983; train_optim_loss: 442277.3983; val_kl_reg_loss: 6757.3060; val_edge_recon_loss: 259542.7202; val_gene_expr_recon_loss: 175959.7362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4177.5757; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446437.3256; val_optim_loss: 446437.3256
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9910; val_auprc_score: 0.9874; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 6764.9689; train_edge_recon_loss: 258102.9676; train_gene_expr_recon_loss: 173157.9943; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4181.4394; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442207.3702; train_optim_loss: 442207.3702; val_kl_reg_loss: 6689.0498; val_edge_recon_loss: 259701.0799; val_gene_expr_recon_loss: 175891.0187; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4191.5132; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446472.6464; val_optim_loss: 446472.6464
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9906; val_auprc_score: 0.9871; val_best_acc_score: 0.9697; val_best_f1_score: 0.9703; train_kl_reg_loss: 6768.1772; train_edge_recon_loss: 258116.8235; train_gene_expr_recon_loss: 173188.1944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4187.9847; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442261.1802; train_optim_loss: 442261.1802; val_kl_reg_loss: 6673.1842; val_edge_recon_loss: 259550.7344; val_gene_expr_recon_loss: 176092.2674; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4201.6299; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446517.8092; val_optim_loss: 446517.8092
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9906; val_auprc_score: 0.9867; val_best_acc_score: 0.9700; val_best_f1_score: 0.9705; train_kl_reg_loss: 6764.4351; train_edge_recon_loss: 258188.3121; train_gene_expr_recon_loss: 173230.5051; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4195.5085; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 442378.7606; train_optim_loss: 442378.7606; val_kl_reg_loss: 6666.7951; val_edge_recon_loss: 260018.2146; val_gene_expr_recon_loss: 175903.2587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4190.1738; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446778.4571; val_optim_loss: 446778.4571

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9909; val_auprc_score: 0.9875; val_best_acc_score: 0.9708; val_best_f1_score: 0.9712; train_kl_reg_loss: 6707.7454; train_edge_recon_loss: 257887.7130; train_gene_expr_recon_loss: 172839.6809; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4123.2374; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441558.3765; train_optim_loss: 441558.3765; val_kl_reg_loss: 6623.7381; val_edge_recon_loss: 259854.1735; val_gene_expr_recon_loss: 175781.8950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4121.7324; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446381.5240; val_optim_loss: 446381.5240
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9916; val_auprc_score: 0.9881; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 6708.6454; train_edge_recon_loss: 257893.5423; train_gene_expr_recon_loss: 172825.3001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4123.9129; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441551.4023; train_optim_loss: 441551.4023; val_kl_reg_loss: 6652.8681; val_edge_recon_loss: 259380.2249; val_gene_expr_recon_loss: 175999.0127; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4127.6138; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446159.7278; val_optim_loss: 446159.7278
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9914; val_auprc_score: 0.9881; val_best_acc_score: 0.9721; val_best_f1_score: 0.9725; train_kl_reg_loss: 6710.9501; train_edge_recon_loss: 257668.6498; train_gene_expr_recon_loss: 172583.0804; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4127.9343; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441090.6146; train_optim_loss: 441090.6146; val_kl_reg_loss: 6607.4897; val_edge_recon_loss: 259206.6731; val_gene_expr_recon_loss: 175844.6962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4127.5562; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445786.4215; val_optim_loss: 445786.4215
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9921; val_auprc_score: 0.9894; val_best_acc_score: 0.9712; val_best_f1_score: 0.9716; train_kl_reg_loss: 6692.0160; train_edge_recon_loss: 257903.2697; train_gene_expr_recon_loss: 172851.0797; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4129.3519; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441575.7171; train_optim_loss: 441575.7171; val_kl_reg_loss: 6652.9204; val_edge_recon_loss: 259663.9568; val_gene_expr_recon_loss: 175982.7587; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4133.5396; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446433.1672; val_optim_loss: 446433.1672
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9919; val_auprc_score: 0.9894; val_best_acc_score: 0.9710; val_best_f1_score: 0.9715; train_kl_reg_loss: 6694.4407; train_edge_recon_loss: 257751.6029; train_gene_expr_recon_loss: 172612.6723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4133.9194; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441192.6347; train_optim_loss: 441192.6347; val_kl_reg_loss: 6631.5526; val_edge_recon_loss: 259606.5759; val_gene_expr_recon_loss: 175180.2478; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4133.6621; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445552.0356; val_optim_loss: 445552.0356
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9909; val_auprc_score: 0.9877; val_best_acc_score: 0.9699; val_best_f1_score: 0.9705; train_kl_reg_loss: 6696.5195; train_edge_recon_loss: 257716.3223; train_gene_expr_recon_loss: 172635.7573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4135.4711; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441184.0706; train_optim_loss: 441184.0706; val_kl_reg_loss: 6633.8547; val_edge_recon_loss: 260112.8165; val_gene_expr_recon_loss: 175523.9836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4137.3970; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446408.0610; val_optim_loss: 446408.0610
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9916; val_auprc_score: 0.9887; val_best_acc_score: 0.9701; val_best_f1_score: 0.9706; train_kl_reg_loss: 6689.5775; train_edge_recon_loss: 257834.5880; train_gene_expr_recon_loss: 172691.0948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4139.1375; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441354.3977; train_optim_loss: 441354.3977; val_kl_reg_loss: 6623.1797; val_edge_recon_loss: 259519.7293; val_gene_expr_recon_loss: 176174.3775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4141.2393; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446458.5378; val_optim_loss: 446458.5378
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9915; val_auprc_score: 0.9886; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 6689.6344; train_edge_recon_loss: 257675.8963; train_gene_expr_recon_loss: 172466.2408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4143.8338; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440975.6040; train_optim_loss: 440975.6040; val_kl_reg_loss: 6597.3024; val_edge_recon_loss: 259651.5883; val_gene_expr_recon_loss: 175465.0029; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4144.5439; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445858.4241; val_optim_loss: 445858.4241
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9918; val_auprc_score: 0.9889; val_best_acc_score: 0.9717; val_best_f1_score: 0.9721; train_kl_reg_loss: 6692.2432; train_edge_recon_loss: 257683.9915; train_gene_expr_recon_loss: 172648.6690; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4147.2758; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441172.1790; train_optim_loss: 441172.1790; val_kl_reg_loss: 6615.5590; val_edge_recon_loss: 259108.9762; val_gene_expr_recon_loss: 175618.1562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4150.2793; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445492.9727; val_optim_loss: 445492.9727
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9924; val_auprc_score: 0.9902; val_best_acc_score: 0.9722; val_best_f1_score: 0.9727; train_kl_reg_loss: 6684.9138; train_edge_recon_loss: 257618.9176; train_gene_expr_recon_loss: 172542.0015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4153.0795; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440998.9122; train_optim_loss: 440998.9122; val_kl_reg_loss: 6624.4296; val_edge_recon_loss: 259233.7680; val_gene_expr_recon_loss: 175493.1068; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4155.7842; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445507.0868; val_optim_loss: 445507.0868
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9912; val_auprc_score: 0.9882; val_best_acc_score: 0.9705; val_best_f1_score: 0.9711; train_kl_reg_loss: 6679.0314; train_edge_recon_loss: 257592.1453; train_gene_expr_recon_loss: 172668.3912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4155.9086; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441095.4756; train_optim_loss: 441095.4756; val_kl_reg_loss: 6619.9303; val_edge_recon_loss: 259671.9435; val_gene_expr_recon_loss: 175256.6239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4157.2271; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445705.7180; val_optim_loss: 445705.7180
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9913; val_auprc_score: 0.9879; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 6676.1153; train_edge_recon_loss: 257738.2754; train_gene_expr_recon_loss: 172422.1705; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4160.4055; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440996.9665; train_optim_loss: 440996.9665; val_kl_reg_loss: 6596.0581; val_edge_recon_loss: 259690.7727; val_gene_expr_recon_loss: 175620.1361; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4163.2349; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446070.2162; val_optim_loss: 446070.2162
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9914; val_auprc_score: 0.9882; val_best_acc_score: 0.9707; val_best_f1_score: 0.9712; train_kl_reg_loss: 6667.0476; train_edge_recon_loss: 257776.6610; train_gene_expr_recon_loss: 172611.2202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4165.0837; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441220.0126; train_optim_loss: 441220.0126; val_kl_reg_loss: 6614.4679; val_edge_recon_loss: 259729.1295; val_gene_expr_recon_loss: 175417.0523; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4168.4868; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445929.1483; val_optim_loss: 445929.1483

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9922; val_auprc_score: 0.9895; val_best_acc_score: 0.9712; val_best_f1_score: 0.9717; train_kl_reg_loss: 6670.5596; train_edge_recon_loss: 257567.9756; train_gene_expr_recon_loss: 172600.9148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4161.7475; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441001.1974; train_optim_loss: 441001.1974; val_kl_reg_loss: 6590.6620; val_edge_recon_loss: 259259.1408; val_gene_expr_recon_loss: 175795.6817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4161.3711; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445806.8605; val_optim_loss: 445806.8605
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9919; val_auprc_score: 0.9895; val_best_acc_score: 0.9699; val_best_f1_score: 0.9704; train_kl_reg_loss: 6667.4331; train_edge_recon_loss: 257648.2837; train_gene_expr_recon_loss: 172547.3249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4161.4329; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441024.4752; train_optim_loss: 441024.4752; val_kl_reg_loss: 6602.1752; val_edge_recon_loss: 259731.4573; val_gene_expr_recon_loss: 175529.0234; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4161.5098; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446024.1541; val_optim_loss: 446024.1541
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9914; val_auprc_score: 0.9885; val_best_acc_score: 0.9714; val_best_f1_score: 0.9719; train_kl_reg_loss: 6668.4684; train_edge_recon_loss: 257622.4952; train_gene_expr_recon_loss: 172528.6001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4161.4178; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 440980.9819; train_optim_loss: 440980.9819; val_kl_reg_loss: 6598.7589; val_edge_recon_loss: 259335.4286; val_gene_expr_recon_loss: 175841.8588; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4161.4009; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445937.4535; val_optim_loss: 445937.4535
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9911; val_auprc_score: 0.9877; val_best_acc_score: 0.9704; val_best_f1_score: 0.9709; train_kl_reg_loss: 6663.6623; train_edge_recon_loss: 257706.1570; train_gene_expr_recon_loss: 172621.2336; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 4161.4004; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 441152.4530; train_optim_loss: 441152.4530; val_kl_reg_loss: 6595.7447; val_edge_recon_loss: 259960.5387; val_gene_expr_recon_loss: 175094.4282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 4161.4868; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445812.2122; val_optim_loss: 445812.2122

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 85 min 13 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9918
val AUPRC score: 0.9887
val best accuracy score: 0.9716
val best F1 score: 0.9721
val target rna MSE score: 0.5609
val source rna MSE score: 0.1179

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
