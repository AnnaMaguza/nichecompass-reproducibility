None
Run timestamp: 14082023_224422_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'encoder_architecture_ablation', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_fc_layers_encoder', '1', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--lr', '0.001', '--lambda_edge_recon', '500000.0', '--lambda_gene_expr_recon', '300.0', '--lambda_group_lasso', '10.0', '--lambda_l1_masked', '10.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_hidden: 1022, n_latent: 1423, n_addon_latent: 10, n_fc_layers: 1, n_layers: 1, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1423, n_addon_gp_input: 10, n_cat_covariates_embed_input: 0, n_output: 1022

--- INITIALIZING TRAINER ---
Number of training nodes: 82121
Number of validation nodes: 9125
Number of training edges: 376649
Number of validation edges: 41849
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9857; val_auprc_score: 0.9797; val_best_acc_score: 0.9591; val_best_f1_score: 0.9599; train_kl_reg_loss: 7690.2720; train_edge_recon_loss: 265442.3507; train_gene_expr_recon_loss: 206802.5437; train_masked_gp_l1_reg_loss: 1363.7116; train_group_lasso_reg_loss: 2507.7683; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 483806.6459; train_optim_loss: 483806.6459; val_kl_reg_loss: 7396.4578; val_edge_recon_loss: 260993.6050; val_gene_expr_recon_loss: 190489.5996; val_masked_gp_l1_reg_loss: 1537.6935; val_group_lasso_reg_loss: 2941.3162; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 463358.6631; val_optim_loss: 463358.6631
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9882; val_auprc_score: 0.9842; val_best_acc_score: 0.9626; val_best_f1_score: 0.9634; train_kl_reg_loss: 7372.0469; train_edge_recon_loss: 260208.7858; train_gene_expr_recon_loss: 187505.9133; train_masked_gp_l1_reg_loss: 1576.4360; train_group_lasso_reg_loss: 3046.4232; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 459709.6047; train_optim_loss: 459709.6047; val_kl_reg_loss: 7003.8724; val_edge_recon_loss: 260001.8618; val_gene_expr_recon_loss: 182937.0595; val_masked_gp_l1_reg_loss: 1585.0342; val_group_lasso_reg_loss: 3082.0425; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 454609.8561; val_optim_loss: 454609.8561
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9900; val_auprc_score: 0.9864; val_best_acc_score: 0.9659; val_best_f1_score: 0.9665; train_kl_reg_loss: 7131.0201; train_edge_recon_loss: 259456.1478; train_gene_expr_recon_loss: 182509.3798; train_masked_gp_l1_reg_loss: 1551.2433; train_group_lasso_reg_loss: 3034.1437; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 453681.9346; train_optim_loss: 453681.9346; val_kl_reg_loss: 6862.3407; val_edge_recon_loss: 259185.1164; val_gene_expr_recon_loss: 180643.0328; val_masked_gp_l1_reg_loss: 1507.4402; val_group_lasso_reg_loss: 2966.8682; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 451164.8020; val_optim_loss: 451164.8020
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9905; val_auprc_score: 0.9875; val_best_acc_score: 0.9673; val_best_f1_score: 0.9680; train_kl_reg_loss: 6969.9873; train_edge_recon_loss: 258907.4070; train_gene_expr_recon_loss: 180653.5684; train_masked_gp_l1_reg_loss: 1479.9233; train_group_lasso_reg_loss: 2912.0307; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 450922.9170; train_optim_loss: 450922.9170; val_kl_reg_loss: 6832.2167; val_edge_recon_loss: 258789.1916; val_gene_expr_recon_loss: 179767.1430; val_masked_gp_l1_reg_loss: 1450.8290; val_group_lasso_reg_loss: 2857.8711; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 449697.2717; val_optim_loss: 449697.2717
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9910; val_auprc_score: 0.9878; val_best_acc_score: 0.9691; val_best_f1_score: 0.9697; train_kl_reg_loss: 6868.1751; train_edge_recon_loss: 258628.3075; train_gene_expr_recon_loss: 179837.1070; train_masked_gp_l1_reg_loss: 1439.4639; train_group_lasso_reg_loss: 2836.0139; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 449609.0673; train_optim_loss: 449609.0673; val_kl_reg_loss: 6700.9932; val_edge_recon_loss: 258351.5245; val_gene_expr_recon_loss: 178994.8336; val_masked_gp_l1_reg_loss: 1427.0791; val_group_lasso_reg_loss: 2810.3369; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 448284.7889; val_optim_loss: 448284.7889
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9925; val_auprc_score: 0.9901; val_best_acc_score: 0.9711; val_best_f1_score: 0.9716; train_kl_reg_loss: 6804.3724; train_edge_recon_loss: 258401.5533; train_gene_expr_recon_loss: 179464.2345; train_masked_gp_l1_reg_loss: 1420.2484; train_group_lasso_reg_loss: 2797.5546; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 448887.9635; train_optim_loss: 448887.9635; val_kl_reg_loss: 6905.6051; val_edge_recon_loss: 257992.4536; val_gene_expr_recon_loss: 178250.2105; val_masked_gp_l1_reg_loss: 1418.8141; val_group_lasso_reg_loss: 2789.9541; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447357.0503; val_optim_loss: 447357.0503
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9932; val_auprc_score: 0.9909; val_best_acc_score: 0.9726; val_best_f1_score: 0.9730; train_kl_reg_loss: 6768.0727; train_edge_recon_loss: 258197.8254; train_gene_expr_recon_loss: 179194.9827; train_masked_gp_l1_reg_loss: 1419.6049; train_group_lasso_reg_loss: 2790.9235; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 448371.4094; train_optim_loss: 448371.4094; val_kl_reg_loss: 6659.2693; val_edge_recon_loss: 257851.4461; val_gene_expr_recon_loss: 178612.4178; val_masked_gp_l1_reg_loss: 1426.0012; val_group_lasso_reg_loss: 2793.3118; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447342.4442; val_optim_loss: 447342.4442
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9934; val_auprc_score: 0.9913; val_best_acc_score: 0.9723; val_best_f1_score: 0.9726; train_kl_reg_loss: 6755.4167; train_edge_recon_loss: 258072.4936; train_gene_expr_recon_loss: 179091.2225; train_masked_gp_l1_reg_loss: 1424.6559; train_group_lasso_reg_loss: 2795.5289; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 448139.3172; train_optim_loss: 448139.3172; val_kl_reg_loss: 6637.0490; val_edge_recon_loss: 257670.8732; val_gene_expr_recon_loss: 178431.1087; val_masked_gp_l1_reg_loss: 1430.8826; val_group_lasso_reg_loss: 2805.0525; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446974.9689; val_optim_loss: 446974.9689
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9938; val_auprc_score: 0.9915; val_best_acc_score: 0.9750; val_best_f1_score: 0.9754; train_kl_reg_loss: 6724.9796; train_edge_recon_loss: 257946.5461; train_gene_expr_recon_loss: 178980.6925; train_masked_gp_l1_reg_loss: 1428.4413; train_group_lasso_reg_loss: 2796.3274; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447876.9865; train_optim_loss: 447876.9865; val_kl_reg_loss: 6672.6593; val_edge_recon_loss: 257466.7043; val_gene_expr_recon_loss: 178201.3739; val_masked_gp_l1_reg_loss: 1431.1399; val_group_lasso_reg_loss: 2795.3999; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446567.2691; val_optim_loss: 446567.2691
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9940; val_auprc_score: 0.9922; val_best_acc_score: 0.9748; val_best_f1_score: 0.9752; train_kl_reg_loss: 6719.3260; train_edge_recon_loss: 257859.8594; train_gene_expr_recon_loss: 178763.7012; train_masked_gp_l1_reg_loss: 1432.5254; train_group_lasso_reg_loss: 2798.4421; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447573.8546; train_optim_loss: 447573.8546; val_kl_reg_loss: 6676.1670; val_edge_recon_loss: 257798.9715; val_gene_expr_recon_loss: 178332.5817; val_masked_gp_l1_reg_loss: 1427.7167; val_group_lasso_reg_loss: 2786.6807; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 447022.1280; val_optim_loss: 447022.1280
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9943; val_auprc_score: 0.9925; val_best_acc_score: 0.9757; val_best_f1_score: 0.9761; train_kl_reg_loss: 6705.8487; train_edge_recon_loss: 257722.0503; train_gene_expr_recon_loss: 178777.2345; train_masked_gp_l1_reg_loss: 1432.6831; train_group_lasso_reg_loss: 2792.0026; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447429.8188; train_optim_loss: 447429.8188; val_kl_reg_loss: 6696.1778; val_edge_recon_loss: 257487.4576; val_gene_expr_recon_loss: 178456.5357; val_masked_gp_l1_reg_loss: 1436.8020; val_group_lasso_reg_loss: 2793.4155; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446870.3906; val_optim_loss: 446870.3906
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9949; val_auprc_score: 0.9936; val_best_acc_score: 0.9767; val_best_f1_score: 0.9770; train_kl_reg_loss: 6700.2858; train_edge_recon_loss: 257713.9923; train_gene_expr_recon_loss: 178587.7827; train_masked_gp_l1_reg_loss: 1437.8494; train_group_lasso_reg_loss: 2797.5929; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447237.5026; train_optim_loss: 447237.5026; val_kl_reg_loss: 6577.8570; val_edge_recon_loss: 257227.8136; val_gene_expr_recon_loss: 178368.6116; val_masked_gp_l1_reg_loss: 1440.5260; val_group_lasso_reg_loss: 2801.1699; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446415.9705; val_optim_loss: 446415.9705
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9950; val_auprc_score: 0.9933; val_best_acc_score: 0.9760; val_best_f1_score: 0.9763; train_kl_reg_loss: 6688.6282; train_edge_recon_loss: 257729.4716; train_gene_expr_recon_loss: 178698.5833; train_masked_gp_l1_reg_loss: 1439.9317; train_group_lasso_reg_loss: 2797.8227; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447354.4374; train_optim_loss: 447354.4374; val_kl_reg_loss: 6639.3477; val_edge_recon_loss: 257291.9754; val_gene_expr_recon_loss: 178240.0710; val_masked_gp_l1_reg_loss: 1444.9951; val_group_lasso_reg_loss: 2804.3948; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446420.8001; val_optim_loss: 446420.8001
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9949; val_auprc_score: 0.9932; val_best_acc_score: 0.9776; val_best_f1_score: 0.9779; train_kl_reg_loss: 6688.3258; train_edge_recon_loss: 257640.9047; train_gene_expr_recon_loss: 178681.5996; train_masked_gp_l1_reg_loss: 1442.8589; train_group_lasso_reg_loss: 2798.0349; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447251.7237; train_optim_loss: 447251.7237; val_kl_reg_loss: 6556.3243; val_edge_recon_loss: 257203.9156; val_gene_expr_recon_loss: 177828.6285; val_masked_gp_l1_reg_loss: 1447.1991; val_group_lasso_reg_loss: 2800.0659; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445836.1183; val_optim_loss: 445836.1183
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9952; val_auprc_score: 0.9937; val_best_acc_score: 0.9777; val_best_f1_score: 0.9780; train_kl_reg_loss: 6684.8562; train_edge_recon_loss: 257503.6311; train_gene_expr_recon_loss: 178617.1333; train_masked_gp_l1_reg_loss: 1443.0155; train_group_lasso_reg_loss: 2792.8291; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 447041.4652; train_optim_loss: 447041.4652; val_kl_reg_loss: 6598.7413; val_edge_recon_loss: 257112.1411; val_gene_expr_recon_loss: 178081.7829; val_masked_gp_l1_reg_loss: 1446.8793; val_group_lasso_reg_loss: 2799.2192; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446038.7586; val_optim_loss: 446038.7586
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9781; val_best_f1_score: 0.9784; train_kl_reg_loss: 6680.4005; train_edge_recon_loss: 257488.8441; train_gene_expr_recon_loss: 178434.7727; train_masked_gp_l1_reg_loss: 1442.7168; train_group_lasso_reg_loss: 2788.5924; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446835.3261; train_optim_loss: 446835.3261; val_kl_reg_loss: 6654.2708; val_edge_recon_loss: 257261.7613; val_gene_expr_recon_loss: 177859.0682; val_masked_gp_l1_reg_loss: 1438.8464; val_group_lasso_reg_loss: 2789.3967; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446003.3508; val_optim_loss: 446003.3508
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9953; val_auprc_score: 0.9940; val_best_acc_score: 0.9782; val_best_f1_score: 0.9785; train_kl_reg_loss: 6669.5679; train_edge_recon_loss: 257407.8767; train_gene_expr_recon_loss: 178489.6539; train_masked_gp_l1_reg_loss: 1438.6493; train_group_lasso_reg_loss: 2778.5046; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446784.2524; train_optim_loss: 446784.2524; val_kl_reg_loss: 6655.2203; val_edge_recon_loss: 257291.1169; val_gene_expr_recon_loss: 178335.6239; val_masked_gp_l1_reg_loss: 1438.0151; val_group_lasso_reg_loss: 2780.3030; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446500.2731; val_optim_loss: 446500.2731
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9955; val_auprc_score: 0.9938; val_best_acc_score: 0.9794; val_best_f1_score: 0.9796; train_kl_reg_loss: 6673.8317; train_edge_recon_loss: 257382.5038; train_gene_expr_recon_loss: 178379.4144; train_masked_gp_l1_reg_loss: 1439.6479; train_group_lasso_reg_loss: 2782.1998; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446657.5975; train_optim_loss: 446657.5975; val_kl_reg_loss: 6611.2153; val_edge_recon_loss: 257100.1870; val_gene_expr_recon_loss: 178236.0661; val_masked_gp_l1_reg_loss: 1435.8710; val_group_lasso_reg_loss: 2777.3848; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 446160.7182; val_optim_loss: 446160.7182

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9955; val_auprc_score: 0.9941; val_best_acc_score: 0.9796; val_best_f1_score: 0.9798; train_kl_reg_loss: 6631.9020; train_edge_recon_loss: 257349.2202; train_gene_expr_recon_loss: 178331.0998; train_masked_gp_l1_reg_loss: 1377.7052; train_group_lasso_reg_loss: 2721.7121; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446411.6392; train_optim_loss: 446411.6392; val_kl_reg_loss: 6562.5758; val_edge_recon_loss: 256715.0148; val_gene_expr_recon_loss: 178193.6938; val_masked_gp_l1_reg_loss: 1376.4923; val_group_lasso_reg_loss: 2722.8354; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445570.6275; val_optim_loss: 445570.6275
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9960; val_auprc_score: 0.9950; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 6628.8182; train_edge_recon_loss: 257205.7406; train_gene_expr_recon_loss: 178167.0901; train_masked_gp_l1_reg_loss: 1376.2194; train_group_lasso_reg_loss: 2722.1845; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446100.0518; train_optim_loss: 446100.0518; val_kl_reg_loss: 6553.6537; val_edge_recon_loss: 256947.1646; val_gene_expr_recon_loss: 177970.1110; val_masked_gp_l1_reg_loss: 1376.3306; val_group_lasso_reg_loss: 2721.3816; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445568.6486; val_optim_loss: 445568.6486
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9959; val_auprc_score: 0.9945; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6619.5741; train_edge_recon_loss: 257194.2435; train_gene_expr_recon_loss: 178163.1308; train_masked_gp_l1_reg_loss: 1376.0066; train_group_lasso_reg_loss: 2722.3188; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 446075.2739; train_optim_loss: 446075.2739; val_kl_reg_loss: 6586.4800; val_edge_recon_loss: 256651.2014; val_gene_expr_recon_loss: 177557.8297; val_masked_gp_l1_reg_loss: 1376.1517; val_group_lasso_reg_loss: 2724.0337; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444895.7001; val_optim_loss: 444895.7001
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9799; val_best_f1_score: 0.9802; train_kl_reg_loss: 6619.4673; train_edge_recon_loss: 257184.9340; train_gene_expr_recon_loss: 178027.2788; train_masked_gp_l1_reg_loss: 1376.5943; train_group_lasso_reg_loss: 2724.5703; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445932.8445; train_optim_loss: 445932.8445; val_kl_reg_loss: 6569.4102; val_edge_recon_loss: 256725.8717; val_gene_expr_recon_loss: 177699.7945; val_masked_gp_l1_reg_loss: 1376.1748; val_group_lasso_reg_loss: 2724.2134; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445095.4842; val_optim_loss: 445095.4842
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9798; val_best_f1_score: 0.9800; train_kl_reg_loss: 6621.0989; train_edge_recon_loss: 257090.2722; train_gene_expr_recon_loss: 178089.4723; train_masked_gp_l1_reg_loss: 1376.8932; train_group_lasso_reg_loss: 2725.4343; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445903.1707; train_optim_loss: 445903.1707; val_kl_reg_loss: 6565.4863; val_edge_recon_loss: 256746.2124; val_gene_expr_recon_loss: 178083.0642; val_masked_gp_l1_reg_loss: 1377.4688; val_group_lasso_reg_loss: 2726.7566; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445498.9802; val_optim_loss: 445498.9802
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9800; val_best_f1_score: 0.9802; train_kl_reg_loss: 6607.3439; train_edge_recon_loss: 257269.0304; train_gene_expr_recon_loss: 177953.6482; train_masked_gp_l1_reg_loss: 1378.6009; train_group_lasso_reg_loss: 2728.6436; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445937.2677; train_optim_loss: 445937.2677; val_kl_reg_loss: 6567.2840; val_edge_recon_loss: 256704.6731; val_gene_expr_recon_loss: 177616.7526; val_masked_gp_l1_reg_loss: 1379.5400; val_group_lasso_reg_loss: 2731.3765; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 444999.6159; val_optim_loss: 444999.6159
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9958; val_auprc_score: 0.9945; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6604.2924; train_edge_recon_loss: 257050.5693; train_gene_expr_recon_loss: 178145.7462; train_masked_gp_l1_reg_loss: 1379.5821; train_group_lasso_reg_loss: 2731.0275; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445911.2178; train_optim_loss: 445911.2178; val_kl_reg_loss: 6581.9165; val_edge_recon_loss: 256769.3672; val_gene_expr_recon_loss: 178019.7620; val_masked_gp_l1_reg_loss: 1380.4868; val_group_lasso_reg_loss: 2731.3684; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445482.9215; val_optim_loss: 445482.9215

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9961; val_auprc_score: 0.9952; val_best_acc_score: 0.9799; val_best_f1_score: 0.9801; train_kl_reg_loss: 6608.9396; train_edge_recon_loss: 257059.3383; train_gene_expr_recon_loss: 177966.9145; train_masked_gp_l1_reg_loss: 1374.1854; train_group_lasso_reg_loss: 2725.7996; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445735.1768; train_optim_loss: 445735.1768; val_kl_reg_loss: 6564.4665; val_edge_recon_loss: 256824.6612; val_gene_expr_recon_loss: 177880.0489; val_masked_gp_l1_reg_loss: 1373.5974; val_group_lasso_reg_loss: 2725.9395; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445368.7060; val_optim_loss: 445368.7060
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9960; val_auprc_score: 0.9949; val_best_acc_score: 0.9796; val_best_f1_score: 0.9799; train_kl_reg_loss: 6602.4953; train_edge_recon_loss: 257169.1141; train_gene_expr_recon_loss: 178013.0758; train_masked_gp_l1_reg_loss: 1373.5303; train_group_lasso_reg_loss: 2726.2128; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445884.4287; train_optim_loss: 445884.4287; val_kl_reg_loss: 6553.6200; val_edge_recon_loss: 256807.5408; val_gene_expr_recon_loss: 177698.9245; val_masked_gp_l1_reg_loss: 1373.4297; val_group_lasso_reg_loss: 2726.3113; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445159.8350; val_optim_loss: 445159.8350
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9960; val_auprc_score: 0.9946; val_best_acc_score: 0.9803; val_best_f1_score: 0.9805; train_kl_reg_loss: 6595.7062; train_edge_recon_loss: 257132.6781; train_gene_expr_recon_loss: 177996.2565; train_masked_gp_l1_reg_loss: 1373.3856; train_group_lasso_reg_loss: 2726.5019; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445824.5278; train_optim_loss: 445824.5278; val_kl_reg_loss: 6552.1056; val_edge_recon_loss: 256737.6594; val_gene_expr_recon_loss: 177935.7020; val_masked_gp_l1_reg_loss: 1373.4290; val_group_lasso_reg_loss: 2726.7148; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445325.6229; val_optim_loss: 445325.6229
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9960; val_auprc_score: 0.9947; val_best_acc_score: 0.9802; val_best_f1_score: 0.9804; train_kl_reg_loss: 6596.9716; train_edge_recon_loss: 257156.2977; train_gene_expr_recon_loss: 177965.3932; train_masked_gp_l1_reg_loss: 1373.4839; train_group_lasso_reg_loss: 2726.9465; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 445819.0929; train_optim_loss: 445819.0929; val_kl_reg_loss: 6559.2254; val_edge_recon_loss: 256612.2592; val_gene_expr_recon_loss: 178014.7560; val_masked_gp_l1_reg_loss: 1373.6517; val_group_lasso_reg_loss: 2727.3960; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 445287.3030; val_optim_loss: 445287.3030

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 87 min 31 sec.
Using best model state, which was in epoch 21.

--- MODEL EVALUATION ---
val AUROC score: 0.9963
val AUPRC score: 0.9954
val best accuracy score: 0.9805
val best F1 score: 0.9807
val target rna MSE score: 0.6100
val source rna MSE score: 0.0795

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
