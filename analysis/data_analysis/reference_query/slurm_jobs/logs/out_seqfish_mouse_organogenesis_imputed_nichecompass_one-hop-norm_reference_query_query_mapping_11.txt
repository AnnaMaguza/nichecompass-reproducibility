Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--query_batches', 'batch5', 'batch6', '--n_neighbors', '8', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '07082024_124745_7', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1961, n_latent: 1861, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1861, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1861, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1961, n_latent: 1861, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1861, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1861, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 18519
Number of validation nodes: 2058
Number of training edges: 84228
Number of validation edges: 9358
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9395; val_auprc_score: 0.9625; val_best_acc_score: 0.8869; val_best_f1_score: 0.9162; train_kl_reg_loss: 19529.6567; train_edge_recon_loss: 1872749.3061; train_gene_expr_recon_loss: 356843348.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 358735627.8303; train_optim_loss: 358735627.8303; val_kl_reg_loss: 19724.4072; val_edge_recon_loss: 1890818.2703; val_gene_expr_recon_loss: 301675903.1351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 303586446.7027; val_optim_loss: 303586446.7027
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9375; val_auprc_score: 0.9629; val_best_acc_score: 0.8891; val_best_f1_score: 0.9187; train_kl_reg_loss: 19531.6923; train_edge_recon_loss: 1875759.7201; train_gene_expr_recon_loss: 257573862.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 259469153.4061; train_optim_loss: 259469153.4061; val_kl_reg_loss: 19652.6574; val_edge_recon_loss: 1867542.9865; val_gene_expr_recon_loss: 218618868.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 220506064.8649; val_optim_loss: 220506064.8649
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9407; val_auprc_score: 0.9639; val_best_acc_score: 0.8897; val_best_f1_score: 0.9187; train_kl_reg_loss: 19552.7663; train_edge_recon_loss: 1881561.1790; train_gene_expr_recon_loss: 190583535.1273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 192484649.4545; train_optim_loss: 192484649.4545; val_kl_reg_loss: 19700.9495; val_edge_recon_loss: 1880737.5101; val_gene_expr_recon_loss: 164583125.6216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 166483562.3784; val_optim_loss: 166483562.3784
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9370; val_auprc_score: 0.9612; val_best_acc_score: 0.8865; val_best_f1_score: 0.9164; train_kl_reg_loss: 19569.1577; train_edge_recon_loss: 1884027.3034; train_gene_expr_recon_loss: 145481947.2242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 147385543.6848; train_optim_loss: 147385543.6848; val_kl_reg_loss: 19695.4961; val_edge_recon_loss: 1886324.9257; val_gene_expr_recon_loss: 128085954.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 129991975.1351; val_optim_loss: 129991975.1351
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9397; val_auprc_score: 0.9637; val_best_acc_score: 0.8876; val_best_f1_score: 0.9177; train_kl_reg_loss: 19552.8000; train_edge_recon_loss: 1880655.5027; train_gene_expr_recon_loss: 115309717.6242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 117209925.8667; train_optim_loss: 117209925.8667; val_kl_reg_loss: 19627.7438; val_edge_recon_loss: 1866435.1959; val_gene_expr_recon_loss: 103294303.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 105180365.8378; val_optim_loss: 105180365.8378
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9400; val_auprc_score: 0.9632; val_best_acc_score: 0.8894; val_best_f1_score: 0.9187; train_kl_reg_loss: 19533.9643; train_edge_recon_loss: 1881092.9763; train_gene_expr_recon_loss: 94493192.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 96393819.9030; train_optim_loss: 96393819.9030; val_kl_reg_loss: 19679.2479; val_edge_recon_loss: 1880993.3209; val_gene_expr_recon_loss: 85797445.8378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 87698118.4865; val_optim_loss: 87698118.4865
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9381; val_auprc_score: 0.9627; val_best_acc_score: 0.8858; val_best_f1_score: 0.9164; train_kl_reg_loss: 19560.5359; train_edge_recon_loss: 1876664.5875; train_gene_expr_recon_loss: 79771629.7697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 81667854.6909; train_optim_loss: 81667854.6909; val_kl_reg_loss: 19688.4158; val_edge_recon_loss: 1882005.2432; val_gene_expr_recon_loss: 73281176.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 75182870.0541; val_optim_loss: 75182870.0541
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9387; val_auprc_score: 0.9626; val_best_acc_score: 0.8850; val_best_f1_score: 0.9155; train_kl_reg_loss: 19550.0519; train_edge_recon_loss: 1884721.5473; train_gene_expr_recon_loss: 68658782.0364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 70563053.6000; train_optim_loss: 70563053.6000; val_kl_reg_loss: 19637.7130; val_edge_recon_loss: 1904912.2736; val_gene_expr_recon_loss: 63731987.4595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 65656537.2973; val_optim_loss: 65656537.2973
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9395; val_auprc_score: 0.9611; val_best_acc_score: 0.8870; val_best_f1_score: 0.9168; train_kl_reg_loss: 19553.5629; train_edge_recon_loss: 1880442.7042; train_gene_expr_recon_loss: 60144452.1091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 62044448.3636; train_optim_loss: 62044448.3636; val_kl_reg_loss: 19638.9332; val_edge_recon_loss: 1887234.5135; val_gene_expr_recon_loss: 56317462.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 58224335.6757; val_optim_loss: 58224335.6757
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9357; val_auprc_score: 0.9595; val_best_acc_score: 0.8843; val_best_f1_score: 0.9147; train_kl_reg_loss: 19530.1068; train_edge_recon_loss: 1884905.3447; train_gene_expr_recon_loss: 53541313.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 55445749.1152; train_optim_loss: 55445749.1152; val_kl_reg_loss: 19711.9670; val_edge_recon_loss: 1886251.0000; val_gene_expr_recon_loss: 50545384.2162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 52451347.1351; val_optim_loss: 52451347.1351
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9391; val_auprc_score: 0.9638; val_best_acc_score: 0.8887; val_best_f1_score: 0.9181; train_kl_reg_loss: 19520.5903; train_edge_recon_loss: 1885151.7515; train_gene_expr_recon_loss: 48316499.9636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 50221172.2545; train_optim_loss: 50221172.2545; val_kl_reg_loss: 19713.1353; val_edge_recon_loss: 1877011.1655; val_gene_expr_recon_loss: 45948038.0541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 47844762.1622; val_optim_loss: 47844762.1622
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9381; val_auprc_score: 0.9635; val_best_acc_score: 0.8848; val_best_f1_score: 0.9146; train_kl_reg_loss: 19539.4849; train_edge_recon_loss: 1883277.4977; train_gene_expr_recon_loss: 44158758.5212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 46061575.4424; train_optim_loss: 46061575.4424; val_kl_reg_loss: 19639.6484; val_edge_recon_loss: 1901328.0574; val_gene_expr_recon_loss: 42205591.8919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44126559.6757; val_optim_loss: 44126559.6757
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9406; val_auprc_score: 0.9649; val_best_acc_score: 0.8900; val_best_f1_score: 0.9196; train_kl_reg_loss: 19527.9684; train_edge_recon_loss: 1883822.4511; train_gene_expr_recon_loss: 40781398.4606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42684748.9333; train_optim_loss: 42684748.9333; val_kl_reg_loss: 19715.9630; val_edge_recon_loss: 1857599.9662; val_gene_expr_recon_loss: 39254942.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 41132258.7027; val_optim_loss: 41132258.7027
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9362; val_auprc_score: 0.9613; val_best_acc_score: 0.8841; val_best_f1_score: 0.9148; train_kl_reg_loss: 19551.9733; train_edge_recon_loss: 1889836.3178; train_gene_expr_recon_loss: 38100104.8364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40009493.1273; train_optim_loss: 40009493.1273; val_kl_reg_loss: 19662.4755; val_edge_recon_loss: 1894826.9291; val_gene_expr_recon_loss: 36856189.1892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38770678.5946; val_optim_loss: 38770678.5946
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9390; val_auprc_score: 0.9635; val_best_acc_score: 0.8876; val_best_f1_score: 0.9169; train_kl_reg_loss: 19536.2321; train_edge_recon_loss: 1882108.4636; train_gene_expr_recon_loss: 35947121.8667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 37848766.5212; train_optim_loss: 37848766.5212; val_kl_reg_loss: 19678.9240; val_edge_recon_loss: 1879564.3851; val_gene_expr_recon_loss: 34982203.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36881446.7027; val_optim_loss: 36881446.7027
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9366; val_auprc_score: 0.9615; val_best_acc_score: 0.8867; val_best_f1_score: 0.9168; train_kl_reg_loss: 19560.7073; train_edge_recon_loss: 1881989.2265; train_gene_expr_recon_loss: 34292870.6667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36194420.5455; train_optim_loss: 36194420.5455; val_kl_reg_loss: 19680.7522; val_edge_recon_loss: 1891189.5473; val_gene_expr_recon_loss: 33524840.0541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35435710.0541; val_optim_loss: 35435710.0541
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9371; val_auprc_score: 0.9618; val_best_acc_score: 0.8842; val_best_f1_score: 0.9148; train_kl_reg_loss: 19545.5083; train_edge_recon_loss: 1877661.0530; train_gene_expr_recon_loss: 33026251.7394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34923458.2242; train_optim_loss: 34923458.2242; val_kl_reg_loss: 19720.6504; val_edge_recon_loss: 1896541.4966; val_gene_expr_recon_loss: 32473089.4054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34389351.4595; val_optim_loss: 34389351.4595
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9389; val_auprc_score: 0.9631; val_best_acc_score: 0.8869; val_best_f1_score: 0.9170; train_kl_reg_loss: 19553.4360; train_edge_recon_loss: 1888212.8996; train_gene_expr_recon_loss: 32112139.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34019906.1818; train_optim_loss: 34019906.1818; val_kl_reg_loss: 19663.4365; val_edge_recon_loss: 1878505.5642; val_gene_expr_recon_loss: 31655280.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33553449.5135; val_optim_loss: 33553449.5135
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9385; val_auprc_score: 0.9612; val_best_acc_score: 0.8882; val_best_f1_score: 0.9178; train_kl_reg_loss: 19537.4980; train_edge_recon_loss: 1879519.8932; train_gene_expr_recon_loss: 31462964.9636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 33362022.2970; train_optim_loss: 33362022.2970; val_kl_reg_loss: 19723.7999; val_edge_recon_loss: 1886967.5777; val_gene_expr_recon_loss: 31164825.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33071516.6486; val_optim_loss: 33071516.6486
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9404; val_auprc_score: 0.9646; val_best_acc_score: 0.8901; val_best_f1_score: 0.9196; train_kl_reg_loss: 19570.5690; train_edge_recon_loss: 1876204.6792; train_gene_expr_recon_loss: 31034585.4909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32930360.7394; train_optim_loss: 32930360.7394; val_kl_reg_loss: 19667.2530; val_edge_recon_loss: 1873152.8649; val_gene_expr_recon_loss: 30801156.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32693976.9189; val_optim_loss: 32693976.9189
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9367; val_auprc_score: 0.9627; val_best_acc_score: 0.8857; val_best_f1_score: 0.9162; train_kl_reg_loss: 19564.6572; train_edge_recon_loss: 1884845.9470; train_gene_expr_recon_loss: 30754705.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32659115.9697; train_optim_loss: 32659115.9697; val_kl_reg_loss: 19633.0092; val_edge_recon_loss: 1878186.6115; val_gene_expr_recon_loss: 30603986.5405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32501806.2162; val_optim_loss: 32501806.2162
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9378; val_auprc_score: 0.9633; val_best_acc_score: 0.8858; val_best_f1_score: 0.9160; train_kl_reg_loss: 19538.3243; train_edge_recon_loss: 1878901.9242; train_gene_expr_recon_loss: 30596503.8606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32494944.1515; train_optim_loss: 32494944.1515; val_kl_reg_loss: 19626.4626; val_edge_recon_loss: 1877163.3345; val_gene_expr_recon_loss: 30498229.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32395019.5676; val_optim_loss: 32395019.5676
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9407; val_auprc_score: 0.9642; val_best_acc_score: 0.8907; val_best_f1_score: 0.9197; train_kl_reg_loss: 19562.0340; train_edge_recon_loss: 1871038.4655; train_gene_expr_recon_loss: 30523367.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32413967.6545; train_optim_loss: 32413967.6545; val_kl_reg_loss: 19677.4298; val_edge_recon_loss: 1872253.0236; val_gene_expr_recon_loss: 30424339.6757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32316270.2162; val_optim_loss: 32316270.2162
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9418; val_auprc_score: 0.9656; val_best_acc_score: 0.8899; val_best_f1_score: 0.9183; train_kl_reg_loss: 19542.9764; train_edge_recon_loss: 1883997.8231; train_gene_expr_recon_loss: 30478106.9333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32381647.7394; train_optim_loss: 32381647.7394; val_kl_reg_loss: 19698.4182; val_edge_recon_loss: 1883828.4223; val_gene_expr_recon_loss: 30426864.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32330391.8378; val_optim_loss: 32330391.8378
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9377; val_auprc_score: 0.9615; val_best_acc_score: 0.8874; val_best_f1_score: 0.9173; train_kl_reg_loss: 19556.8724; train_edge_recon_loss: 1888457.1080; train_gene_expr_recon_loss: 30468292.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32376306.1576; train_optim_loss: 32376306.1576; val_kl_reg_loss: 19757.2584; val_edge_recon_loss: 1888638.4899; val_gene_expr_recon_loss: 30430988.0541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32339383.8919; val_optim_loss: 32339383.8919
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9376; val_auprc_score: 0.9617; val_best_acc_score: 0.8860; val_best_f1_score: 0.9164; train_kl_reg_loss: 19559.4863; train_edge_recon_loss: 1860948.3008; train_gene_expr_recon_loss: 29887302.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31767810.7515; train_optim_loss: 31767810.7515; val_kl_reg_loss: 19207.1916; val_edge_recon_loss: 1888757.6520; val_gene_expr_recon_loss: 29878530.2162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31786495.0270; val_optim_loss: 31786495.0270
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9387; val_auprc_score: 0.9615; val_best_acc_score: 0.8870; val_best_f1_score: 0.9173; train_kl_reg_loss: 19575.1726; train_edge_recon_loss: 1871413.4042; train_gene_expr_recon_loss: 29887603.1455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31778591.7515; train_optim_loss: 31778591.7515; val_kl_reg_loss: 19172.8449; val_edge_recon_loss: 1880829.3682; val_gene_expr_recon_loss: 29881527.8378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31781530.1622; val_optim_loss: 31781530.1622
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9353; val_auprc_score: 0.9602; val_best_acc_score: 0.8837; val_best_f1_score: 0.9141; train_kl_reg_loss: 19561.0335; train_edge_recon_loss: 1863376.4282; train_gene_expr_recon_loss: 29885338.6545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31768276.1515; train_optim_loss: 31768276.1515; val_kl_reg_loss: 19218.0185; val_edge_recon_loss: 1897073.0777; val_gene_expr_recon_loss: 29878726.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31795017.2973; val_optim_loss: 31795017.2973
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9394; val_auprc_score: 0.9634; val_best_acc_score: 0.8871; val_best_f1_score: 0.9174; train_kl_reg_loss: 19549.6772; train_edge_recon_loss: 1857032.5534; train_gene_expr_recon_loss: 29877260.6485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31753842.8485; train_optim_loss: 31753842.8485; val_kl_reg_loss: 19215.3872; val_edge_recon_loss: 1868206.8885; val_gene_expr_recon_loss: 29881046.2162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31768468.5946; val_optim_loss: 31768468.5946
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9400; val_auprc_score: 0.9634; val_best_acc_score: 0.8875; val_best_f1_score: 0.9175; train_kl_reg_loss: 19549.9677; train_edge_recon_loss: 1872345.3955; train_gene_expr_recon_loss: 29876520.1697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31768415.5091; train_optim_loss: 31768415.5091; val_kl_reg_loss: 19178.2441; val_edge_recon_loss: 1877458.7568; val_gene_expr_recon_loss: 29900193.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31796830.2162; val_optim_loss: 31796830.2162
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9384; val_auprc_score: 0.9618; val_best_acc_score: 0.8875; val_best_f1_score: 0.9173; train_kl_reg_loss: 19542.0318; train_edge_recon_loss: 1858846.8633; train_gene_expr_recon_loss: 29878055.1333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31756444.0061; train_optim_loss: 31756444.0061; val_kl_reg_loss: 19274.5144; val_edge_recon_loss: 1891401.6588; val_gene_expr_recon_loss: 29887479.2973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31798155.3514; val_optim_loss: 31798155.3514
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9363; val_auprc_score: 0.9593; val_best_acc_score: 0.8867; val_best_f1_score: 0.9168; train_kl_reg_loss: 19544.4003; train_edge_recon_loss: 1855400.5966; train_gene_expr_recon_loss: 29877377.2848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31752322.2848; train_optim_loss: 31752322.2848; val_kl_reg_loss: 19212.3924; val_edge_recon_loss: 1895331.1824; val_gene_expr_recon_loss: 29878782.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31793326.1622; val_optim_loss: 31793326.1622
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9384; val_auprc_score: 0.9611; val_best_acc_score: 0.8886; val_best_f1_score: 0.9185; train_kl_reg_loss: 19548.1442; train_edge_recon_loss: 1853800.5193; train_gene_expr_recon_loss: 29872904.5939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31746253.2606; train_optim_loss: 31746253.2606; val_kl_reg_loss: 19225.2465; val_edge_recon_loss: 1869644.2264; val_gene_expr_recon_loss: 29878529.5676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31767398.9730; val_optim_loss: 31767398.9730
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9397; val_auprc_score: 0.9642; val_best_acc_score: 0.8874; val_best_f1_score: 0.9168; train_kl_reg_loss: 19567.4402; train_edge_recon_loss: 1860556.7402; train_gene_expr_recon_loss: 29878181.9758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31758306.1273; train_optim_loss: 31758306.1273; val_kl_reg_loss: 19248.0566; val_edge_recon_loss: 1873315.7703; val_gene_expr_recon_loss: 29890271.6216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31782835.5135; val_optim_loss: 31782835.5135
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9375; val_auprc_score: 0.9620; val_best_acc_score: 0.8854; val_best_f1_score: 0.9153; train_kl_reg_loss: 19550.9472; train_edge_recon_loss: 1850366.7970; train_gene_expr_recon_loss: 29868235.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31738153.3818; train_optim_loss: 31738153.3818; val_kl_reg_loss: 19339.1630; val_edge_recon_loss: 1908978.1757; val_gene_expr_recon_loss: 29896931.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31825248.9730; val_optim_loss: 31825248.9730
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9379; val_auprc_score: 0.9632; val_best_acc_score: 0.8871; val_best_f1_score: 0.9177; train_kl_reg_loss: 19547.6404; train_edge_recon_loss: 1862085.2269; train_gene_expr_recon_loss: 29872714.4121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31754347.2788; train_optim_loss: 31754347.2788; val_kl_reg_loss: 19231.9090; val_edge_recon_loss: 1860119.3074; val_gene_expr_recon_loss: 29872359.4054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31751710.8108; val_optim_loss: 31751710.8108
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9379; val_auprc_score: 0.9611; val_best_acc_score: 0.8865; val_best_f1_score: 0.9160; train_kl_reg_loss: 19558.7073; train_edge_recon_loss: 1860716.4068; train_gene_expr_recon_loss: 29869574.1576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31749849.3152; train_optim_loss: 31749849.3152; val_kl_reg_loss: 19170.5601; val_edge_recon_loss: 1907057.1014; val_gene_expr_recon_loss: 29853955.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31780182.9730; val_optim_loss: 31780182.9730
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9406; val_auprc_score: 0.9645; val_best_acc_score: 0.8895; val_best_f1_score: 0.9186; train_kl_reg_loss: 19552.3381; train_edge_recon_loss: 1855399.9432; train_gene_expr_recon_loss: 29867807.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31742759.3455; train_optim_loss: 31742759.3455; val_kl_reg_loss: 19200.6397; val_edge_recon_loss: 1860804.6385; val_gene_expr_recon_loss: 29864879.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31744884.7568; val_optim_loss: 31744884.7568
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9388; val_auprc_score: 0.9617; val_best_acc_score: 0.8838; val_best_f1_score: 0.9140; train_kl_reg_loss: 19547.6829; train_edge_recon_loss: 1862995.7981; train_gene_expr_recon_loss: 29865114.9273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31747658.4364; train_optim_loss: 31747658.4364; val_kl_reg_loss: 19273.5295; val_edge_recon_loss: 1913961.0101; val_gene_expr_recon_loss: 29867610.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31800845.2432; val_optim_loss: 31800845.2432
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9412; val_auprc_score: 0.9660; val_best_acc_score: 0.8884; val_best_f1_score: 0.9171; train_kl_reg_loss: 19537.7146; train_edge_recon_loss: 1867961.1303; train_gene_expr_recon_loss: 29857599.1697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31745098.0121; train_optim_loss: 31745098.0121; val_kl_reg_loss: 19184.5466; val_edge_recon_loss: 1872924.6993; val_gene_expr_recon_loss: 29869110.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31761219.6216; val_optim_loss: 31761219.6216
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9405; val_auprc_score: 0.9633; val_best_acc_score: 0.8887; val_best_f1_score: 0.9175; train_kl_reg_loss: 19546.3678; train_edge_recon_loss: 1866442.1061; train_gene_expr_recon_loss: 29863964.1818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31749952.6788; train_optim_loss: 31749952.6788; val_kl_reg_loss: 19158.6817; val_edge_recon_loss: 1874073.7466; val_gene_expr_recon_loss: 29849808.7027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31743041.1892; val_optim_loss: 31743041.1892
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9395; val_auprc_score: 0.9636; val_best_acc_score: 0.8878; val_best_f1_score: 0.9176; train_kl_reg_loss: 19541.8264; train_edge_recon_loss: 1865570.2152; train_gene_expr_recon_loss: 29859726.0545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31744838.0848; train_optim_loss: 31744838.0848; val_kl_reg_loss: 19209.7587; val_edge_recon_loss: 1889309.9865; val_gene_expr_recon_loss: 29855101.4595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31763621.2432; val_optim_loss: 31763621.2432
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9402; val_auprc_score: 0.9645; val_best_acc_score: 0.8881; val_best_f1_score: 0.9176; train_kl_reg_loss: 19556.4150; train_edge_recon_loss: 1869967.2121; train_gene_expr_recon_loss: 29858929.4182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31748453.0727; train_optim_loss: 31748453.0727; val_kl_reg_loss: 19196.5098; val_edge_recon_loss: 1874334.3108; val_gene_expr_recon_loss: 29856177.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31749708.5405; val_optim_loss: 31749708.5405
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9365; val_auprc_score: 0.9604; val_best_acc_score: 0.8866; val_best_f1_score: 0.9162; train_kl_reg_loss: 19558.1495; train_edge_recon_loss: 1868799.0273; train_gene_expr_recon_loss: 29856107.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31744464.5939; train_optim_loss: 31744464.5939; val_kl_reg_loss: 19176.8671; val_edge_recon_loss: 1884282.2331; val_gene_expr_recon_loss: 29851801.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31755260.3243; val_optim_loss: 31755260.3243
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9385; val_auprc_score: 0.9625; val_best_acc_score: 0.8867; val_best_f1_score: 0.9168; train_kl_reg_loss: 19544.2223; train_edge_recon_loss: 1864436.4735; train_gene_expr_recon_loss: 29853372.3697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31737353.0364; train_optim_loss: 31737353.0364; val_kl_reg_loss: 19189.2576; val_edge_recon_loss: 1893279.3716; val_gene_expr_recon_loss: 29846661.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31759130.4324; val_optim_loss: 31759130.4324

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9381; val_auprc_score: 0.9629; val_best_acc_score: 0.8855; val_best_f1_score: 0.9161; train_kl_reg_loss: 19532.9044; train_edge_recon_loss: 1864394.2580; train_gene_expr_recon_loss: 29854418.2788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31738345.4848; train_optim_loss: 31738345.4848; val_kl_reg_loss: 19150.4069; val_edge_recon_loss: 1882881.2264; val_gene_expr_recon_loss: 29845128.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31747160.6486; val_optim_loss: 31747160.6486
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9378; val_auprc_score: 0.9616; val_best_acc_score: 0.8836; val_best_f1_score: 0.9146; train_kl_reg_loss: 19545.2687; train_edge_recon_loss: 1868218.9121; train_gene_expr_recon_loss: 29852613.8061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31740377.9879; train_optim_loss: 31740377.9879; val_kl_reg_loss: 19239.9891; val_edge_recon_loss: 1900889.3041; val_gene_expr_recon_loss: 29869410.4324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31789539.8378; val_optim_loss: 31789539.8378
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9381; val_auprc_score: 0.9630; val_best_acc_score: 0.8877; val_best_f1_score: 0.9178; train_kl_reg_loss: 19545.7691; train_edge_recon_loss: 1858587.8114; train_gene_expr_recon_loss: 29858648.3636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31736781.9394; train_optim_loss: 31736781.9394; val_kl_reg_loss: 19138.3297; val_edge_recon_loss: 1874041.3345; val_gene_expr_recon_loss: 29848475.4595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31741654.9189; val_optim_loss: 31741654.9189
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9373; val_auprc_score: 0.9622; val_best_acc_score: 0.8857; val_best_f1_score: 0.9161; train_kl_reg_loss: 19558.0493; train_edge_recon_loss: 1866049.1860; train_gene_expr_recon_loss: 29862846.0121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31748453.2545; train_optim_loss: 31748453.2545; val_kl_reg_loss: 19177.1770; val_edge_recon_loss: 1872142.4054; val_gene_expr_recon_loss: 29864899.6216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31756219.3514; val_optim_loss: 31756219.3514
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9384; val_auprc_score: 0.9633; val_best_acc_score: 0.8861; val_best_f1_score: 0.9167; train_kl_reg_loss: 19569.1657; train_edge_recon_loss: 1859562.8500; train_gene_expr_recon_loss: 29855479.4182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31734611.4061; train_optim_loss: 31734611.4061; val_kl_reg_loss: 19216.8206; val_edge_recon_loss: 1878901.5507; val_gene_expr_recon_loss: 29858249.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31756367.7838; val_optim_loss: 31756367.7838
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9384; val_auprc_score: 0.9613; val_best_acc_score: 0.8894; val_best_f1_score: 0.9181; train_kl_reg_loss: 19550.7476; train_edge_recon_loss: 1863071.6852; train_gene_expr_recon_loss: 29852741.3758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31735363.8121; train_optim_loss: 31735363.8121; val_kl_reg_loss: 19235.5397; val_edge_recon_loss: 1884175.6182; val_gene_expr_recon_loss: 29862495.0811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31765906.2162; val_optim_loss: 31765906.2162
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9397; val_auprc_score: 0.9653; val_best_acc_score: 0.8868; val_best_f1_score: 0.9170; train_kl_reg_loss: 19562.3056; train_edge_recon_loss: 1863770.5080; train_gene_expr_recon_loss: 29856567.2545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31739900.0727; train_optim_loss: 31739900.0727; val_kl_reg_loss: 19251.6819; val_edge_recon_loss: 1863690.6047; val_gene_expr_recon_loss: 29885199.5676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31768141.8378; val_optim_loss: 31768141.8378

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9394; val_auprc_score: 0.9632; val_best_acc_score: 0.8889; val_best_f1_score: 0.9186; train_kl_reg_loss: 19553.4676; train_edge_recon_loss: 1863001.5527; train_gene_expr_recon_loss: 29862347.8061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31744902.8061; train_optim_loss: 31744902.8061; val_kl_reg_loss: 19223.4757; val_edge_recon_loss: 1873664.8480; val_gene_expr_recon_loss: 29860527.8919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31753416.0000; val_optim_loss: 31753416.0000
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9354; val_auprc_score: 0.9620; val_best_acc_score: 0.8815; val_best_f1_score: 0.9137; train_kl_reg_loss: 19555.3459; train_edge_recon_loss: 1865620.8530; train_gene_expr_recon_loss: 29861927.3576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31747103.5515; train_optim_loss: 31747103.5515; val_kl_reg_loss: 19188.2227; val_edge_recon_loss: 1887612.3750; val_gene_expr_recon_loss: 29857076.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31763876.8108; val_optim_loss: 31763876.8108
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9357; val_auprc_score: 0.9606; val_best_acc_score: 0.8821; val_best_f1_score: 0.9130; train_kl_reg_loss: 19557.6158; train_edge_recon_loss: 1866052.7758; train_gene_expr_recon_loss: 29863589.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31749200.0545; train_optim_loss: 31749200.0545; val_kl_reg_loss: 19265.6182; val_edge_recon_loss: 1923861.4257; val_gene_expr_recon_loss: 29876982.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31820109.4595; val_optim_loss: 31820109.4595
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9407; val_auprc_score: 0.9636; val_best_acc_score: 0.8898; val_best_f1_score: 0.9193; train_kl_reg_loss: 19564.2431; train_edge_recon_loss: 1858511.1451; train_gene_expr_recon_loss: 29856981.0061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31735056.4061; train_optim_loss: 31735056.4061; val_kl_reg_loss: 19174.1186; val_edge_recon_loss: 1862131.2703; val_gene_expr_recon_loss: 29850394.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31731700.1622; val_optim_loss: 31731700.1622
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9402; val_auprc_score: 0.9641; val_best_acc_score: 0.8887; val_best_f1_score: 0.9180; train_kl_reg_loss: 19533.6793; train_edge_recon_loss: 1876452.6841; train_gene_expr_recon_loss: 29854582.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31750568.9576; train_optim_loss: 31750568.9576; val_kl_reg_loss: 19224.7099; val_edge_recon_loss: 1884242.9291; val_gene_expr_recon_loss: 29846390.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31749858.2703; val_optim_loss: 31749858.2703
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9373; val_auprc_score: 0.9617; val_best_acc_score: 0.8834; val_best_f1_score: 0.9141; train_kl_reg_loss: 19559.2813; train_edge_recon_loss: 1865290.8875; train_gene_expr_recon_loss: 29858028.1091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31742878.2242; train_optim_loss: 31742878.2242; val_kl_reg_loss: 19129.7746; val_edge_recon_loss: 1881356.1014; val_gene_expr_recon_loss: 29862171.4054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31762657.4054; val_optim_loss: 31762657.4054
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9403; val_auprc_score: 0.9637; val_best_acc_score: 0.8885; val_best_f1_score: 0.9184; train_kl_reg_loss: 19553.9523; train_edge_recon_loss: 1866363.4239; train_gene_expr_recon_loss: 29857368.1636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31743285.5030; train_optim_loss: 31743285.5030; val_kl_reg_loss: 19158.9045; val_edge_recon_loss: 1871316.4493; val_gene_expr_recon_loss: 29843914.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31734389.7838; val_optim_loss: 31734389.7838
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9365; val_auprc_score: 0.9610; val_best_acc_score: 0.8839; val_best_f1_score: 0.9140; train_kl_reg_loss: 19536.1529; train_edge_recon_loss: 1859592.7383; train_gene_expr_recon_loss: 29852225.7091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31731354.6364; train_optim_loss: 31731354.6364; val_kl_reg_loss: 19181.7259; val_edge_recon_loss: 1896398.0709; val_gene_expr_recon_loss: 29855840.3243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31771420.0000; val_optim_loss: 31771420.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9410; val_auprc_score: 0.9647; val_best_acc_score: 0.8886; val_best_f1_score: 0.9180; train_kl_reg_loss: 19547.9368; train_edge_recon_loss: 1864314.3178; train_gene_expr_recon_loss: 29857242.2545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31741104.5091; train_optim_loss: 31741104.5091; val_kl_reg_loss: 19232.5816; val_edge_recon_loss: 1883242.3581; val_gene_expr_recon_loss: 29854269.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31756744.0541; val_optim_loss: 31756744.0541
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9392; val_auprc_score: 0.9634; val_best_acc_score: 0.8871; val_best_f1_score: 0.9172; train_kl_reg_loss: 19544.0782; train_edge_recon_loss: 1855000.4509; train_gene_expr_recon_loss: 29854104.6061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31728649.1697; train_optim_loss: 31728649.1697; val_kl_reg_loss: 19241.9111; val_edge_recon_loss: 1885378.5135; val_gene_expr_recon_loss: 29858271.0811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31762891.4595; val_optim_loss: 31762891.4595
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9384; val_auprc_score: 0.9636; val_best_acc_score: 0.8879; val_best_f1_score: 0.9179; train_kl_reg_loss: 19531.9869; train_edge_recon_loss: 1860973.2909; train_gene_expr_recon_loss: 29852396.5455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31732901.7939; train_optim_loss: 31732901.7939; val_kl_reg_loss: 19206.3339; val_edge_recon_loss: 1877827.8209; val_gene_expr_recon_loss: 29860473.6216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31757507.8919; val_optim_loss: 31757507.8919
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9381; val_auprc_score: 0.9618; val_best_acc_score: 0.8844; val_best_f1_score: 0.9151; train_kl_reg_loss: 19550.2787; train_edge_recon_loss: 1864186.0042; train_gene_expr_recon_loss: 29856507.6364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31740243.9515; train_optim_loss: 31740243.9515; val_kl_reg_loss: 19176.0638; val_edge_recon_loss: 1878790.8649; val_gene_expr_recon_loss: 29859052.9730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31757019.8919; val_optim_loss: 31757019.8919

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 173 min 38 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9395
val AUPRC score: 0.9622
val best accuracy score: 0.8852
val best F1 score: 0.9148
val target rna MSE score: 1.6105
val source rna MSE score: 1.3853
Val cat covariate0 mean sim diff: 0.0008

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
