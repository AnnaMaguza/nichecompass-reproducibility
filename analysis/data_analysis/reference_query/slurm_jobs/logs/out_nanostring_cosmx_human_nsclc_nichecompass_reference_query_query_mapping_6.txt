Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch8', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '02092023_234956_2', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 68882
Number of validation nodes: 7654
Number of training edges: 162180
Number of validation edges: 18020
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9143; val_auprc_score: 0.9169; val_best_acc_score: 0.8317; val_best_f1_score: 0.8352; train_kl_reg_loss: 25670.1823; train_edge_recon_loss: 3185260.7413; train_gene_expr_recon_loss: 2791060.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6001990.9842; train_optim_loss: 6001990.9842; val_kl_reg_loss: 25836.0759; val_edge_recon_loss: 3267816.1736; val_gene_expr_recon_loss: 2510706.8819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5804359.1250; val_optim_loss: 5804359.1250
Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--query_batches', 'batch4', '--n_neighbors', '4', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '03092023_002440_5', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query_mapping', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 75351
Number of validation nodes: 8372
Number of training edges: 175771
Number of validation edges: 19530
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7059; val_auprc_score: 0.7261; val_best_acc_score: 0.6365; val_best_f1_score: 0.7262; train_kl_reg_loss: 29512.3144; train_edge_recon_loss: 3502649.6170; train_gene_expr_recon_loss: 8865438.0828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12397600.0320; train_optim_loss: 12397600.0320; val_kl_reg_loss: 29562.9321; val_edge_recon_loss: 3534211.0449; val_gene_expr_recon_loss: 5389490.9615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8953264.9744; val_optim_loss: 8953264.9744
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9167; val_auprc_score: 0.9200; val_best_acc_score: 0.8350; val_best_f1_score: 0.8363; train_kl_reg_loss: 25677.4783; train_edge_recon_loss: 3185338.1285; train_gene_expr_recon_loss: 2372015.1506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5583030.7650; train_optim_loss: 5583030.7650; val_kl_reg_loss: 25826.7076; val_edge_recon_loss: 3263034.9722; val_gene_expr_recon_loss: 2267342.8611; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5556204.5833; val_optim_loss: 5556204.5833
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7058; val_auprc_score: 0.7250; val_best_acc_score: 0.6361; val_best_f1_score: 0.7260; train_kl_reg_loss: 29504.7478; train_edge_recon_loss: 3500611.5988; train_gene_expr_recon_loss: 5806798.2849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 9336914.6512; train_optim_loss: 9336914.6512; val_kl_reg_loss: 29475.5052; val_edge_recon_loss: 3532367.0897; val_gene_expr_recon_loss: 4925586.2821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8487428.8846; val_optim_loss: 8487428.8846
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9160; val_auprc_score: 0.9185; val_best_acc_score: 0.8334; val_best_f1_score: 0.8377; train_kl_reg_loss: 25680.3466; train_edge_recon_loss: 3185740.1719; train_gene_expr_recon_loss: 2208977.1593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5420397.6814; train_optim_loss: 5420397.6814; val_kl_reg_loss: 25840.8018; val_edge_recon_loss: 3265871.0139; val_gene_expr_recon_loss: 2158442.8299; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5450154.6250; val_optim_loss: 5450154.6250
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7045; val_auprc_score: 0.7239; val_best_acc_score: 0.6355; val_best_f1_score: 0.7253; train_kl_reg_loss: 29484.1630; train_edge_recon_loss: 3502832.0036; train_gene_expr_recon_loss: 5385768.6628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8918084.8169; train_optim_loss: 8918084.8169; val_kl_reg_loss: 29541.4618; val_edge_recon_loss: 3530989.7179; val_gene_expr_recon_loss: 4630428.4103; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8190959.6154; val_optim_loss: 8190959.6154
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9162; val_auprc_score: 0.9191; val_best_acc_score: 0.8339; val_best_f1_score: 0.8374; train_kl_reg_loss: 25673.1935; train_edge_recon_loss: 3185094.2216; train_gene_expr_recon_loss: 2123064.2674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5333831.6893; train_optim_loss: 5333831.6893; val_kl_reg_loss: 25871.7952; val_edge_recon_loss: 3266107.2986; val_gene_expr_recon_loss: 2095967.6424; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5387946.7083; val_optim_loss: 5387946.7083
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7035; val_auprc_score: 0.7242; val_best_acc_score: 0.6356; val_best_f1_score: 0.7260; train_kl_reg_loss: 29498.5039; train_edge_recon_loss: 3501069.6672; train_gene_expr_recon_loss: 5090355.9593; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8620924.1337; train_optim_loss: 8620924.1337; val_kl_reg_loss: 29528.0323; val_edge_recon_loss: 3530214.7692; val_gene_expr_recon_loss: 4332747.5641; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7892490.3462; val_optim_loss: 7892490.3462
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9147; val_auprc_score: 0.9174; val_best_acc_score: 0.8324; val_best_f1_score: 0.8356; train_kl_reg_loss: 25669.6326; train_edge_recon_loss: 3186443.0694; train_gene_expr_recon_loss: 2071235.9641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5283348.6609; train_optim_loss: 5283348.6609; val_kl_reg_loss: 25855.0890; val_edge_recon_loss: 3268508.0972; val_gene_expr_recon_loss: 2058353.7535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5352716.8472; val_optim_loss: 5352716.8472
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7035; val_auprc_score: 0.7226; val_best_acc_score: 0.6352; val_best_f1_score: 0.7259; train_kl_reg_loss: 29500.1042; train_edge_recon_loss: 3495146.8932; train_gene_expr_recon_loss: 4795707.2573; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8320354.2645; train_optim_loss: 8320354.2645; val_kl_reg_loss: 29488.2143; val_edge_recon_loss: 3531251.4872; val_gene_expr_recon_loss: 4035927.5449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7596667.1795; val_optim_loss: 7596667.1795
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9156; val_auprc_score: 0.9183; val_best_acc_score: 0.8339; val_best_f1_score: 0.8369; train_kl_reg_loss: 25672.9926; train_edge_recon_loss: 3186431.9669; train_gene_expr_recon_loss: 2044240.9152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5256345.8833; train_optim_loss: 5256345.8833; val_kl_reg_loss: 25871.3360; val_edge_recon_loss: 3263704.4514; val_gene_expr_recon_loss: 2033640.0278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5323215.9028; val_optim_loss: 5323215.9028
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.7030; val_auprc_score: 0.7226; val_best_acc_score: 0.6360; val_best_f1_score: 0.7264; train_kl_reg_loss: 29497.3098; train_edge_recon_loss: 3499177.8438; train_gene_expr_recon_loss: 4518522.8103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8047197.9826; train_optim_loss: 8047197.9826; val_kl_reg_loss: 29576.7514; val_edge_recon_loss: 3536023.3654; val_gene_expr_recon_loss: 3779358.1859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7344958.2692; val_optim_loss: 7344958.2692
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9147; val_auprc_score: 0.9176; val_best_acc_score: 0.8332; val_best_f1_score: 0.8358; train_kl_reg_loss: 25673.2017; train_edge_recon_loss: 3184474.1183; train_gene_expr_recon_loss: 2023938.4602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5234085.7886; train_optim_loss: 5234085.7886; val_kl_reg_loss: 25864.3212; val_edge_recon_loss: 3267565.4861; val_gene_expr_recon_loss: 2016335.2326; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5309765.0000; val_optim_loss: 5309765.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.7057; val_auprc_score: 0.7252; val_best_acc_score: 0.6348; val_best_f1_score: 0.7254; train_kl_reg_loss: 29513.4831; train_edge_recon_loss: 3501185.8052; train_gene_expr_recon_loss: 4284539.3801; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7815238.6773; train_optim_loss: 7815238.6773; val_kl_reg_loss: 29536.2074; val_edge_recon_loss: 3533485.5128; val_gene_expr_recon_loss: 3556144.2692; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7119166.0000; val_optim_loss: 7119166.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9162; val_auprc_score: 0.9184; val_best_acc_score: 0.8332; val_best_f1_score: 0.8362; train_kl_reg_loss: 25673.1046; train_edge_recon_loss: 3184304.9464; train_gene_expr_recon_loss: 2011203.0741; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5221181.1309; train_optim_loss: 5221181.1309; val_kl_reg_loss: 25835.1241; val_edge_recon_loss: 3263012.7708; val_gene_expr_recon_loss: 2002050.2257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5290898.1111; val_optim_loss: 5290898.1111
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.7044; val_auprc_score: 0.7255; val_best_acc_score: 0.6337; val_best_f1_score: 0.7251; train_kl_reg_loss: 29489.1389; train_edge_recon_loss: 3500850.1475; train_gene_expr_recon_loss: 4078753.5669; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7609092.8735; train_optim_loss: 7609092.8735; val_kl_reg_loss: 29558.1350; val_edge_recon_loss: 3534307.5449; val_gene_expr_recon_loss: 3389196.5064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6953062.1923; val_optim_loss: 6953062.1923
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9159; val_auprc_score: 0.9187; val_best_acc_score: 0.8342; val_best_f1_score: 0.8362; train_kl_reg_loss: 25674.6167; train_edge_recon_loss: 3185589.9109; train_gene_expr_recon_loss: 2005919.0599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5217183.6230; train_optim_loss: 5217183.6230; val_kl_reg_loss: 25853.5468; val_edge_recon_loss: 3263818.8472; val_gene_expr_recon_loss: 2003175.9792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5292848.3611; val_optim_loss: 5292848.3611
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.7017; val_auprc_score: 0.7203; val_best_acc_score: 0.6338; val_best_f1_score: 0.7246; train_kl_reg_loss: 29494.8293; train_edge_recon_loss: 3499674.5225; train_gene_expr_recon_loss: 3922521.1032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7451690.4666; train_optim_loss: 7451690.4666; val_kl_reg_loss: 29540.5349; val_edge_recon_loss: 3538512.6218; val_gene_expr_recon_loss: 3259946.3526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6827999.5385; val_optim_loss: 6827999.5385
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9152; val_auprc_score: 0.9177; val_best_acc_score: 0.8330; val_best_f1_score: 0.8362; train_kl_reg_loss: 25670.6820; train_edge_recon_loss: 3185253.2950; train_gene_expr_recon_loss: 1999822.9377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5210746.9211; train_optim_loss: 5210746.9211; val_kl_reg_loss: 25823.3110; val_edge_recon_loss: 3264774.2986; val_gene_expr_recon_loss: 1990553.2535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5281150.8750; val_optim_loss: 5281150.8750
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.7029; val_auprc_score: 0.7230; val_best_acc_score: 0.6333; val_best_f1_score: 0.7241; train_kl_reg_loss: 29501.8943; train_edge_recon_loss: 3501947.9855; train_gene_expr_recon_loss: 3803808.3430; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7335258.2238; train_optim_loss: 7335258.2238; val_kl_reg_loss: 29540.7118; val_edge_recon_loss: 3542551.9103; val_gene_expr_recon_loss: 3168509.2821; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6740601.9103; val_optim_loss: 6740601.9103
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9155; val_auprc_score: 0.9173; val_best_acc_score: 0.8349; val_best_f1_score: 0.8383; train_kl_reg_loss: 25680.5563; train_edge_recon_loss: 3185190.1065; train_gene_expr_recon_loss: 1995902.1230; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5206772.7902; train_optim_loss: 5206772.7902; val_kl_reg_loss: 25799.6396; val_edge_recon_loss: 3268501.7222; val_gene_expr_recon_loss: 1989716.7847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5284018.1806; val_optim_loss: 5284018.1806
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.7032; val_auprc_score: 0.7233; val_best_acc_score: 0.6336; val_best_f1_score: 0.7250; train_kl_reg_loss: 29490.6344; train_edge_recon_loss: 3501561.7740; train_gene_expr_recon_loss: 3712160.3619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7243212.7820; train_optim_loss: 7243212.7820; val_kl_reg_loss: 29547.4694; val_edge_recon_loss: 3536759.5321; val_gene_expr_recon_loss: 3088248.1795; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6654555.1538; val_optim_loss: 6654555.1538
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9155; val_auprc_score: 0.9180; val_best_acc_score: 0.8337; val_best_f1_score: 0.8375; train_kl_reg_loss: 25676.8153; train_edge_recon_loss: 3186772.9338; train_gene_expr_recon_loss: 1991887.5158; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5204337.2666; train_optim_loss: 5204337.2666; val_kl_reg_loss: 25861.6520; val_edge_recon_loss: 3265457.8750; val_gene_expr_recon_loss: 1985981.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5277301.1389; val_optim_loss: 5277301.1389
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9146; val_auprc_score: 0.9163; val_best_acc_score: 0.8334; val_best_f1_score: 0.8362; train_kl_reg_loss: 25677.9753; train_edge_recon_loss: 3185669.7768; train_gene_expr_recon_loss: 1987021.6420; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5198369.3722; train_optim_loss: 5198369.3722; val_kl_reg_loss: 25852.1424; val_edge_recon_loss: 3266024.0000; val_gene_expr_recon_loss: 1985268.0139; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5277144.0972; val_optim_loss: 5277144.0972
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.7066; val_auprc_score: 0.7224; val_best_acc_score: 0.6392; val_best_f1_score: 0.7274; train_kl_reg_loss: 29513.8378; train_edge_recon_loss: 3502850.1148; train_gene_expr_recon_loss: 3640877.7013; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7173241.6541; train_optim_loss: 7173241.6541; val_kl_reg_loss: 29497.8010; val_edge_recon_loss: 3522627.1154; val_gene_expr_recon_loss: 3032155.6603; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6584280.6282; val_optim_loss: 6584280.6282
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9162; val_auprc_score: 0.9188; val_best_acc_score: 0.8333; val_best_f1_score: 0.8361; train_kl_reg_loss: 25678.0680; train_edge_recon_loss: 3186775.7792; train_gene_expr_recon_loss: 1984614.2015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5197068.0489; train_optim_loss: 5197068.0489; val_kl_reg_loss: 25798.9281; val_edge_recon_loss: 3261973.9236; val_gene_expr_recon_loss: 1978326.1701; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5266099.0000; val_optim_loss: 5266099.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.7038; val_auprc_score: 0.7231; val_best_acc_score: 0.6347; val_best_f1_score: 0.7251; train_kl_reg_loss: 29508.2049; train_edge_recon_loss: 3504827.5821; train_gene_expr_recon_loss: 3584959.9884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7119295.7689; train_optim_loss: 7119295.7689; val_kl_reg_loss: 29560.0866; val_edge_recon_loss: 3538870.0641; val_gene_expr_recon_loss: 2984289.9487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6552720.1282; val_optim_loss: 6552720.1282
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9137; val_auprc_score: 0.9162; val_best_acc_score: 0.8320; val_best_f1_score: 0.8337; train_kl_reg_loss: 25681.0612; train_edge_recon_loss: 3186737.3391; train_gene_expr_recon_loss: 1985936.0410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5198354.4416; train_optim_loss: 5198354.4416; val_kl_reg_loss: 25859.8555; val_edge_recon_loss: 3267773.2083; val_gene_expr_recon_loss: 1977106.6285; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5270739.6528; val_optim_loss: 5270739.6528
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.7039; val_auprc_score: 0.7210; val_best_acc_score: 0.6366; val_best_f1_score: 0.7262; train_kl_reg_loss: 29488.0439; train_edge_recon_loss: 3502198.9528; train_gene_expr_recon_loss: 3539250.8372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7070937.8299; train_optim_loss: 7070937.8299; val_kl_reg_loss: 29491.2692; val_edge_recon_loss: 3527355.2885; val_gene_expr_recon_loss: 2953795.8462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6510642.4231; val_optim_loss: 6510642.4231
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9158; val_auprc_score: 0.9188; val_best_acc_score: 0.8328; val_best_f1_score: 0.8370; train_kl_reg_loss: 25672.2290; train_edge_recon_loss: 3183559.1333; train_gene_expr_recon_loss: 1983436.1625; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5192667.5221; train_optim_loss: 5192667.5221; val_kl_reg_loss: 25853.9224; val_edge_recon_loss: 3264795.0694; val_gene_expr_recon_loss: 1976821.7431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5267470.6806; val_optim_loss: 5267470.6806
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.7031; val_auprc_score: 0.7241; val_best_acc_score: 0.6331; val_best_f1_score: 0.7240; train_kl_reg_loss: 29497.4986; train_edge_recon_loss: 3502488.6323; train_gene_expr_recon_loss: 3497258.6497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7029244.7820; train_optim_loss: 7029244.7820; val_kl_reg_loss: 29517.2132; val_edge_recon_loss: 3544074.1731; val_gene_expr_recon_loss: 2921097.5192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6494688.8846; val_optim_loss: 6494688.8846
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9153; val_auprc_score: 0.9185; val_best_acc_score: 0.8321; val_best_f1_score: 0.8353; train_kl_reg_loss: 25689.5044; train_edge_recon_loss: 3186434.8076; train_gene_expr_recon_loss: 1979021.1491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5191145.4653; train_optim_loss: 5191145.4653; val_kl_reg_loss: 25804.2687; val_edge_recon_loss: 3264828.5000; val_gene_expr_recon_loss: 1971674.8681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5262307.6944; val_optim_loss: 5262307.6944
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.7017; val_auprc_score: 0.7219; val_best_acc_score: 0.6327; val_best_f1_score: 0.7236; train_kl_reg_loss: 29507.2626; train_edge_recon_loss: 3502691.9026; train_gene_expr_recon_loss: 3472050.4855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7004249.6265; train_optim_loss: 7004249.6265; val_kl_reg_loss: 29540.7717; val_edge_recon_loss: 3544291.9936; val_gene_expr_recon_loss: 2904554.8846; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6478387.6795; val_optim_loss: 6478387.6795
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9151; val_auprc_score: 0.9177; val_best_acc_score: 0.8335; val_best_f1_score: 0.8355; train_kl_reg_loss: 25676.4817; train_edge_recon_loss: 3185199.4267; train_gene_expr_recon_loss: 1977157.4775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5188033.3722; train_optim_loss: 5188033.3722; val_kl_reg_loss: 25890.0976; val_edge_recon_loss: 3270079.9097; val_gene_expr_recon_loss: 1976897.7396; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5272867.7222; val_optim_loss: 5272867.7222
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.7036; val_auprc_score: 0.7251; val_best_acc_score: 0.6340; val_best_f1_score: 0.7248; train_kl_reg_loss: 29501.1125; train_edge_recon_loss: 3502753.8321; train_gene_expr_recon_loss: 3442376.3110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6974631.2616; train_optim_loss: 6974631.2616; val_kl_reg_loss: 29544.0080; val_edge_recon_loss: 3540248.7179; val_gene_expr_recon_loss: 2874919.0897; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6444711.7821; val_optim_loss: 6444711.7821
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9152; val_auprc_score: 0.9178; val_best_acc_score: 0.8340; val_best_f1_score: 0.8365; train_kl_reg_loss: 25676.9619; train_edge_recon_loss: 3184363.6451; train_gene_expr_recon_loss: 1976035.9752; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5186076.5852; train_optim_loss: 5186076.5852; val_kl_reg_loss: 25875.3199; val_edge_recon_loss: 3267392.1250; val_gene_expr_recon_loss: 1975453.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5268721.3472; val_optim_loss: 5268721.3472
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.7087; val_auprc_score: 0.7274; val_best_acc_score: 0.6399; val_best_f1_score: 0.7277; train_kl_reg_loss: 29489.9411; train_edge_recon_loss: 3500776.4775; train_gene_expr_recon_loss: 3420983.6584; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6951250.0727; train_optim_loss: 6951250.0727; val_kl_reg_loss: 29522.5735; val_edge_recon_loss: 3522189.8205; val_gene_expr_recon_loss: 2859646.3526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6411358.7949; val_optim_loss: 6411358.7949
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9167; val_auprc_score: 0.9197; val_best_acc_score: 0.8347; val_best_f1_score: 0.8382; train_kl_reg_loss: 25679.4726; train_edge_recon_loss: 3184226.3273; train_gene_expr_recon_loss: 1975698.7567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5185604.5615; train_optim_loss: 5185604.5615; val_kl_reg_loss: 25818.6401; val_edge_recon_loss: 3263575.5139; val_gene_expr_recon_loss: 1971160.7951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5260554.9306; val_optim_loss: 5260554.9306
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.7071; val_auprc_score: 0.7265; val_best_acc_score: 0.6365; val_best_f1_score: 0.7261; train_kl_reg_loss: 29505.6031; train_edge_recon_loss: 3500485.1214; train_gene_expr_recon_loss: 3410773.7565; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6940764.4564; train_optim_loss: 6940764.4564; val_kl_reg_loss: 29465.5032; val_edge_recon_loss: 3529736.4487; val_gene_expr_recon_loss: 2850357.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6409559.8077; val_optim_loss: 6409559.8077
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9145; val_auprc_score: 0.9174; val_best_acc_score: 0.8319; val_best_f1_score: 0.8360; train_kl_reg_loss: 25672.1600; train_edge_recon_loss: 3185098.7847; train_gene_expr_recon_loss: 1973757.9519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5184528.9006; train_optim_loss: 5184528.9006; val_kl_reg_loss: 25863.0267; val_edge_recon_loss: 3271065.7222; val_gene_expr_recon_loss: 1974455.0729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5271383.8472; val_optim_loss: 5271383.8472
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.7011; val_auprc_score: 0.7215; val_best_acc_score: 0.6349; val_best_f1_score: 0.7254; train_kl_reg_loss: 29503.9697; train_edge_recon_loss: 3500892.3176; train_gene_expr_recon_loss: 3392567.4978; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6922963.7922; train_optim_loss: 6922963.7922; val_kl_reg_loss: 29497.3023; val_edge_recon_loss: 3537759.8846; val_gene_expr_recon_loss: 2832524.6859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6399781.9103; val_optim_loss: 6399781.9103
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9152; val_auprc_score: 0.9176; val_best_acc_score: 0.8338; val_best_f1_score: 0.8362; train_kl_reg_loss: 25672.4846; train_edge_recon_loss: 3185958.7713; train_gene_expr_recon_loss: 1972764.3912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5184395.6498; train_optim_loss: 5184395.6498; val_kl_reg_loss: 25849.6386; val_edge_recon_loss: 3269046.2292; val_gene_expr_recon_loss: 1968471.6771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5263367.5556; val_optim_loss: 5263367.5556
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.7027; val_auprc_score: 0.7230; val_best_acc_score: 0.6349; val_best_f1_score: 0.7250; train_kl_reg_loss: 29502.2869; train_edge_recon_loss: 3500177.4586; train_gene_expr_recon_loss: 3385855.2885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6915535.0422; train_optim_loss: 6915535.0422; val_kl_reg_loss: 29566.6883; val_edge_recon_loss: 3537497.4423; val_gene_expr_recon_loss: 2832944.3526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6400008.4487; val_optim_loss: 6400008.4487
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9148; val_auprc_score: 0.9178; val_best_acc_score: 0.8324; val_best_f1_score: 0.8357; train_kl_reg_loss: 25678.9070; train_edge_recon_loss: 3185864.4409; train_gene_expr_recon_loss: 1973806.5568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5185349.9211; train_optim_loss: 5185349.9211; val_kl_reg_loss: 25826.3836; val_edge_recon_loss: 3267043.5625; val_gene_expr_recon_loss: 1965854.0174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5258723.9583; val_optim_loss: 5258723.9583
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.7004; val_auprc_score: 0.7204; val_best_acc_score: 0.6330; val_best_f1_score: 0.7244; train_kl_reg_loss: 29504.5547; train_edge_recon_loss: 3501418.8060; train_gene_expr_recon_loss: 3371556.5603; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6902479.9128; train_optim_loss: 6902479.9128; val_kl_reg_loss: 29573.2841; val_edge_recon_loss: 3543724.7564; val_gene_expr_recon_loss: 2831023.0385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6404321.0385; val_optim_loss: 6404321.0385
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9151; val_auprc_score: 0.9180; val_best_acc_score: 0.8331; val_best_f1_score: 0.8359; train_kl_reg_loss: 25674.2094; train_edge_recon_loss: 3185421.0489; train_gene_expr_recon_loss: 1975074.1002; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5186169.3659; train_optim_loss: 5186169.3659; val_kl_reg_loss: 25847.1766; val_edge_recon_loss: 3270275.2639; val_gene_expr_recon_loss: 1972040.2743; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5268162.7361; val_optim_loss: 5268162.7361
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.7032; val_auprc_score: 0.7233; val_best_acc_score: 0.6353; val_best_f1_score: 0.7256; train_kl_reg_loss: 29506.7666; train_edge_recon_loss: 3504701.3016; train_gene_expr_recon_loss: 3361582.9469; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6895791.0087; train_optim_loss: 6895791.0087; val_kl_reg_loss: 29608.3617; val_edge_recon_loss: 3536891.7372; val_gene_expr_recon_loss: 2826218.0256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6392718.1026; val_optim_loss: 6392718.1026
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9151; val_auprc_score: 0.9181; val_best_acc_score: 0.8322; val_best_f1_score: 0.8352; train_kl_reg_loss: 25674.6087; train_edge_recon_loss: 3185595.1017; train_gene_expr_recon_loss: 1972114.0524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5183383.7697; train_optim_loss: 5183383.7697; val_kl_reg_loss: 25856.2734; val_edge_recon_loss: 3266010.7986; val_gene_expr_recon_loss: 1969627.3021; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5261494.3750; val_optim_loss: 5261494.3750
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.7051; val_auprc_score: 0.7277; val_best_acc_score: 0.6346; val_best_f1_score: 0.7256; train_kl_reg_loss: 29502.9227; train_edge_recon_loss: 3500174.3641; train_gene_expr_recon_loss: 3351934.3612; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6881611.6584; train_optim_loss: 6881611.6584; val_kl_reg_loss: 29499.5381; val_edge_recon_loss: 3539507.3718; val_gene_expr_recon_loss: 2812535.8397; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6381542.7564; val_optim_loss: 6381542.7564
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9122; val_auprc_score: 0.9140; val_best_acc_score: 0.8314; val_best_f1_score: 0.8334; train_kl_reg_loss: 25673.1765; train_edge_recon_loss: 3199766.0063; train_gene_expr_recon_loss: 1861463.8486; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5086903.0205; train_optim_loss: 5086903.0205; val_kl_reg_loss: 24942.1003; val_edge_recon_loss: 3280759.2847; val_gene_expr_recon_loss: 1856884.4340; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5162585.8333; val_optim_loss: 5162585.8333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.7023; val_auprc_score: 0.7231; val_best_acc_score: 0.6329; val_best_f1_score: 0.7247; train_kl_reg_loss: 29491.3226; train_edge_recon_loss: 3498212.8299; train_gene_expr_recon_loss: 3346999.0015; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6874703.1541; train_optim_loss: 6874703.1541; val_kl_reg_loss: 29547.6445; val_edge_recon_loss: 3542626.7885; val_gene_expr_recon_loss: 2809693.4231; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6381867.8462; val_optim_loss: 6381867.8462
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9112; val_auprc_score: 0.9138; val_best_acc_score: 0.8283; val_best_f1_score: 0.8321; train_kl_reg_loss: 25675.9674; train_edge_recon_loss: 3203462.9905; train_gene_expr_recon_loss: 1854654.5580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5083793.5221; train_optim_loss: 5083793.5221; val_kl_reg_loss: 24979.0345; val_edge_recon_loss: 3281401.9514; val_gene_expr_recon_loss: 1850716.0903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5157097.0972; val_optim_loss: 5157097.0972
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.6724; val_auprc_score: 0.6766; val_best_acc_score: 0.6233; val_best_f1_score: 0.7162; train_kl_reg_loss: 29502.7472; train_edge_recon_loss: 3503791.9855; train_gene_expr_recon_loss: 2360740.5828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5894035.3198; train_optim_loss: 5894035.3198; val_kl_reg_loss: 28582.3498; val_edge_recon_loss: 3527266.7051; val_gene_expr_recon_loss: 2348397.4487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5904246.5128; val_optim_loss: 5904246.5128
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9120; val_auprc_score: 0.9142; val_best_acc_score: 0.8295; val_best_f1_score: 0.8332; train_kl_reg_loss: 25673.8159; train_edge_recon_loss: 3202005.8636; train_gene_expr_recon_loss: 1855981.2224; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5083660.9006; train_optim_loss: 5083660.9006; val_kl_reg_loss: 24956.4761; val_edge_recon_loss: 3279062.4514; val_gene_expr_recon_loss: 1857882.2257; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5161901.1806; val_optim_loss: 5161901.1806
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.6673; val_auprc_score: 0.6733; val_best_acc_score: 0.6182; val_best_f1_score: 0.7144; train_kl_reg_loss: 29493.4339; train_edge_recon_loss: 3502122.9215; train_gene_expr_recon_loss: 2331238.5458; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5862854.8953; train_optim_loss: 5862854.8953; val_kl_reg_loss: 28611.9764; val_edge_recon_loss: 3548592.1154; val_gene_expr_recon_loss: 2332332.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5909536.9103; val_optim_loss: 5909536.9103
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9101; val_auprc_score: 0.9121; val_best_acc_score: 0.8273; val_best_f1_score: 0.8314; train_kl_reg_loss: 25668.9690; train_edge_recon_loss: 3204045.8817; train_gene_expr_recon_loss: 1852750.4345; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5082465.2918; train_optim_loss: 5082465.2918; val_kl_reg_loss: 24944.0560; val_edge_recon_loss: 3281915.1597; val_gene_expr_recon_loss: 1854071.7569; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5160930.9722; val_optim_loss: 5160930.9722
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.6671; val_auprc_score: 0.6742; val_best_acc_score: 0.6185; val_best_f1_score: 0.7144; train_kl_reg_loss: 29510.8329; train_edge_recon_loss: 3502728.2711; train_gene_expr_recon_loss: 2313915.8830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5846154.9855; train_optim_loss: 5846154.9855; val_kl_reg_loss: 28592.2279; val_edge_recon_loss: 3545173.1346; val_gene_expr_recon_loss: 2317154.2051; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5890919.5513; val_optim_loss: 5890919.5513
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9118; val_auprc_score: 0.9134; val_best_acc_score: 0.8295; val_best_f1_score: 0.8324; train_kl_reg_loss: 25672.7434; train_edge_recon_loss: 3203977.4921; train_gene_expr_recon_loss: 1852922.0442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5082572.2666; train_optim_loss: 5082572.2666; val_kl_reg_loss: 24965.2591; val_edge_recon_loss: 3280112.4653; val_gene_expr_recon_loss: 1856355.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5161433.2639; val_optim_loss: 5161433.2639
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.6668; val_auprc_score: 0.6758; val_best_acc_score: 0.6166; val_best_f1_score: 0.7131; train_kl_reg_loss: 29497.5506; train_edge_recon_loss: 3501944.8321; train_gene_expr_recon_loss: 2299982.5894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5831424.9680; train_optim_loss: 5831424.9680; val_kl_reg_loss: 28603.6941; val_edge_recon_loss: 3557475.7949; val_gene_expr_recon_loss: 2299654.4551; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5885733.9615; val_optim_loss: 5885733.9615
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9106; val_auprc_score: 0.9129; val_best_acc_score: 0.8259; val_best_f1_score: 0.8311; train_kl_reg_loss: 25674.8823; train_edge_recon_loss: 3202890.0292; train_gene_expr_recon_loss: 1851190.4306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5079755.3754; train_optim_loss: 5079755.3754; val_kl_reg_loss: 24956.9895; val_edge_recon_loss: 3282410.9931; val_gene_expr_recon_loss: 1852657.3681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5160025.3611; val_optim_loss: 5160025.3611
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.6707; val_auprc_score: 0.6764; val_best_acc_score: 0.6209; val_best_f1_score: 0.7153; train_kl_reg_loss: 29508.1202; train_edge_recon_loss: 3505997.3786; train_gene_expr_recon_loss: 2291262.9375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5826768.4331; train_optim_loss: 5826768.4331; val_kl_reg_loss: 28538.2747; val_edge_recon_loss: 3536165.1090; val_gene_expr_recon_loss: 2296939.8462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5861643.2436; val_optim_loss: 5861643.2436

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9111; val_auprc_score: 0.9123; val_best_acc_score: 0.8293; val_best_f1_score: 0.8321; train_kl_reg_loss: 25675.4750; train_edge_recon_loss: 3204655.9377; train_gene_expr_recon_loss: 1852843.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5083174.7035; train_optim_loss: 5083174.7035; val_kl_reg_loss: 24963.0385; val_edge_recon_loss: 3279195.7778; val_gene_expr_recon_loss: 1847630.1736; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5151788.9583; val_optim_loss: 5151788.9583
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.6700; val_auprc_score: 0.6764; val_best_acc_score: 0.6215; val_best_f1_score: 0.7159; train_kl_reg_loss: 29498.6953; train_edge_recon_loss: 3505270.5145; train_gene_expr_recon_loss: 2283491.1119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5818260.3169; train_optim_loss: 5818260.3169; val_kl_reg_loss: 28606.4992; val_edge_recon_loss: 3537255.4744; val_gene_expr_recon_loss: 2289686.5256; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5855548.5641; val_optim_loss: 5855548.5641
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9113; val_auprc_score: 0.9126; val_best_acc_score: 0.8300; val_best_f1_score: 0.8322; train_kl_reg_loss: 25680.5230; train_edge_recon_loss: 3203454.1065; train_gene_expr_recon_loss: 1853142.9499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5082277.5836; train_optim_loss: 5082277.5836; val_kl_reg_loss: 24955.5240; val_edge_recon_loss: 3280753.1181; val_gene_expr_recon_loss: 1851246.3785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5156955.0833; val_optim_loss: 5156955.0833
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9115; val_auprc_score: 0.9137; val_best_acc_score: 0.8283; val_best_f1_score: 0.8325; train_kl_reg_loss: 25686.5661; train_edge_recon_loss: 3203161.9685; train_gene_expr_recon_loss: 1853031.3119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5081879.8533; train_optim_loss: 5081879.8533; val_kl_reg_loss: 24892.9868; val_edge_recon_loss: 3280451.7847; val_gene_expr_recon_loss: 1855773.6111; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5161118.3889; val_optim_loss: 5161118.3889
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.6674; val_auprc_score: 0.6746; val_best_acc_score: 0.6198; val_best_f1_score: 0.7147; train_kl_reg_loss: 29495.5622; train_edge_recon_loss: 3502896.7565; train_gene_expr_recon_loss: 2278519.4437; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5810911.7500; train_optim_loss: 5810911.7500; val_kl_reg_loss: 28597.1824; val_edge_recon_loss: 3541674.1218; val_gene_expr_recon_loss: 2280496.9295; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5850768.2308; val_optim_loss: 5850768.2308
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9096; val_auprc_score: 0.9125; val_best_acc_score: 0.8267; val_best_f1_score: 0.8294; train_kl_reg_loss: 25672.3560; train_edge_recon_loss: 3203907.0978; train_gene_expr_recon_loss: 1851718.8687; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5081298.3233; train_optim_loss: 5081298.3233; val_kl_reg_loss: 24886.6097; val_edge_recon_loss: 3288334.7431; val_gene_expr_recon_loss: 1852494.2847; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5165715.6389; val_optim_loss: 5165715.6389
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.6675; val_auprc_score: 0.6738; val_best_acc_score: 0.6192; val_best_f1_score: 0.7148; train_kl_reg_loss: 29501.4226; train_edge_recon_loss: 3505070.7311; train_gene_expr_recon_loss: 2275078.4862; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5809650.6453; train_optim_loss: 5809650.6453; val_kl_reg_loss: 28578.9525; val_edge_recon_loss: 3536094.3333; val_gene_expr_recon_loss: 2273924.3526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5838597.6667; val_optim_loss: 5838597.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9118; val_auprc_score: 0.9147; val_best_acc_score: 0.8285; val_best_f1_score: 0.8325; train_kl_reg_loss: 25686.0767; train_edge_recon_loss: 3203394.1845; train_gene_expr_recon_loss: 1851897.4018; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5080977.6562; train_optim_loss: 5080977.6562; val_kl_reg_loss: 24900.2988; val_edge_recon_loss: 3281747.9444; val_gene_expr_recon_loss: 1847047.2604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5153695.5139; val_optim_loss: 5153695.5139
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.6697; val_auprc_score: 0.6770; val_best_acc_score: 0.6196; val_best_f1_score: 0.7152; train_kl_reg_loss: 29503.8830; train_edge_recon_loss: 3505566.4826; train_gene_expr_recon_loss: 2270696.0988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5805766.4680; train_optim_loss: 5805766.4680; val_kl_reg_loss: 28588.5093; val_edge_recon_loss: 3538060.3654; val_gene_expr_recon_loss: 2273966.1474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5840615.0641; val_optim_loss: 5840615.0641

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9109; val_auprc_score: 0.9137; val_best_acc_score: 0.8281; val_best_f1_score: 0.8305; train_kl_reg_loss: 25676.8577; train_edge_recon_loss: 3202623.6427; train_gene_expr_recon_loss: 1852256.2666; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5080556.7808; train_optim_loss: 5080556.7808; val_kl_reg_loss: 24886.8877; val_edge_recon_loss: 3282043.7569; val_gene_expr_recon_loss: 1853969.5035; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5160900.1944; val_optim_loss: 5160900.1944
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.6693; val_auprc_score: 0.6757; val_best_acc_score: 0.6207; val_best_f1_score: 0.7149; train_kl_reg_loss: 29497.4500; train_edge_recon_loss: 3505315.5705; train_gene_expr_recon_loss: 2266139.1672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5800952.1991; train_optim_loss: 5800952.1991; val_kl_reg_loss: 28563.2513; val_edge_recon_loss: 3538673.8269; val_gene_expr_recon_loss: 2268311.2308; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5835548.3718; val_optim_loss: 5835548.3718
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9133; val_auprc_score: 0.9166; val_best_acc_score: 0.8309; val_best_f1_score: 0.8347; train_kl_reg_loss: 25680.6630; train_edge_recon_loss: 3204478.1183; train_gene_expr_recon_loss: 1849798.5911; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5079957.3722; train_optim_loss: 5079957.3722; val_kl_reg_loss: 24868.6742; val_edge_recon_loss: 3281719.0694; val_gene_expr_recon_loss: 1845631.5729; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5152219.3750; val_optim_loss: 5152219.3750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.6660; val_auprc_score: 0.6737; val_best_acc_score: 0.6169; val_best_f1_score: 0.7137; train_kl_reg_loss: 29479.5907; train_edge_recon_loss: 3504704.9033; train_gene_expr_recon_loss: 2261107.7384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5795292.2471; train_optim_loss: 5795292.2471; val_kl_reg_loss: 28599.8702; val_edge_recon_loss: 3549334.9936; val_gene_expr_recon_loss: 2269593.2436; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5847528.1282; val_optim_loss: 5847528.1282
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9101; val_auprc_score: 0.9118; val_best_acc_score: 0.8265; val_best_f1_score: 0.8315; train_kl_reg_loss: 25670.8895; train_edge_recon_loss: 3204152.7019; train_gene_expr_recon_loss: 1850482.5966; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5080306.1924; train_optim_loss: 5080306.1924; val_kl_reg_loss: 24873.8081; val_edge_recon_loss: 3282773.5764; val_gene_expr_recon_loss: 1846680.7951; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5154328.2361; val_optim_loss: 5154328.2361
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.6703; val_auprc_score: 0.6770; val_best_acc_score: 0.6209; val_best_f1_score: 0.7157; train_kl_reg_loss: 29483.9471; train_edge_recon_loss: 3500205.0182; train_gene_expr_recon_loss: 2261287.6839; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5790976.6395; train_optim_loss: 5790976.6395; val_kl_reg_loss: 28561.1673; val_edge_recon_loss: 3533470.6667; val_gene_expr_recon_loss: 2271758.5577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5833790.4231; val_optim_loss: 5833790.4231
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9114; val_auprc_score: 0.9130; val_best_acc_score: 0.8293; val_best_f1_score: 0.8331; train_kl_reg_loss: 25670.3662; train_edge_recon_loss: 3204852.0300; train_gene_expr_recon_loss: 1850337.3151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5080859.6940; train_optim_loss: 5080859.6940; val_kl_reg_loss: 24890.1510; val_edge_recon_loss: 3280440.2708; val_gene_expr_recon_loss: 1849079.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5154409.6667; val_optim_loss: 5154409.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.6689; val_auprc_score: 0.6751; val_best_acc_score: 0.6212; val_best_f1_score: 0.7157; train_kl_reg_loss: 29475.5271; train_edge_recon_loss: 3503946.9295; train_gene_expr_recon_loss: 2257482.0312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5790904.4985; train_optim_loss: 5790904.4985; val_kl_reg_loss: 28571.3376; val_edge_recon_loss: 3538045.0513; val_gene_expr_recon_loss: 2266725.5962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5833341.9615; val_optim_loss: 5833341.9615
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.6729; val_auprc_score: 0.6783; val_best_acc_score: 0.6236; val_best_f1_score: 0.7170; train_kl_reg_loss: 29488.3252; train_edge_recon_loss: 3502090.8190; train_gene_expr_recon_loss: 2254690.0073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5786269.1410; train_optim_loss: 5786269.1410; val_kl_reg_loss: 28578.6548; val_edge_recon_loss: 3523970.7179; val_gene_expr_recon_loss: 2269415.7756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5821965.1923; val_optim_loss: 5821965.1923
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.6698; val_auprc_score: 0.6768; val_best_acc_score: 0.6195; val_best_f1_score: 0.7147; train_kl_reg_loss: 29493.5843; train_edge_recon_loss: 3505297.0610; train_gene_expr_recon_loss: 2256375.9099; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5791166.5480; train_optim_loss: 5791166.5480; val_kl_reg_loss: 28560.3376; val_edge_recon_loss: 3540658.1346; val_gene_expr_recon_loss: 2266669.5192; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5835887.9615; val_optim_loss: 5835887.9615
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.6702; val_auprc_score: 0.6746; val_best_acc_score: 0.6224; val_best_f1_score: 0.7161; train_kl_reg_loss: 29481.5875; train_edge_recon_loss: 3504740.2522; train_gene_expr_recon_loss: 2253913.2787; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5788135.1134; train_optim_loss: 5788135.1134; val_kl_reg_loss: 28550.4169; val_edge_recon_loss: 3532762.0000; val_gene_expr_recon_loss: 2264658.9808; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5825971.4359; val_optim_loss: 5825971.4359
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.6689; val_auprc_score: 0.6752; val_best_acc_score: 0.6208; val_best_f1_score: 0.7150; train_kl_reg_loss: 29492.3731; train_edge_recon_loss: 3499580.9360; train_gene_expr_recon_loss: 2252663.5451; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5781736.8503; train_optim_loss: 5781736.8503; val_kl_reg_loss: 28582.5778; val_edge_recon_loss: 3538715.7500; val_gene_expr_recon_loss: 2260687.5385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5827985.8333; val_optim_loss: 5827985.8333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.6689; val_auprc_score: 0.6754; val_best_acc_score: 0.6190; val_best_f1_score: 0.7147; train_kl_reg_loss: 29476.7728; train_edge_recon_loss: 3504683.0051; train_gene_expr_recon_loss: 2250333.7478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5784493.5116; train_optim_loss: 5784493.5116; val_kl_reg_loss: 28570.6775; val_edge_recon_loss: 3539023.4872; val_gene_expr_recon_loss: 2254826.6474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5822420.7821; val_optim_loss: 5822420.7821

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.6672; val_auprc_score: 0.6764; val_best_acc_score: 0.6201; val_best_f1_score: 0.7146; train_kl_reg_loss: 29488.5188; train_edge_recon_loss: 3504535.4353; train_gene_expr_recon_loss: 2251806.5334; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5785830.4695; train_optim_loss: 5785830.4695; val_kl_reg_loss: 28632.6668; val_edge_recon_loss: 3538830.4038; val_gene_expr_recon_loss: 2264509.4359; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5831972.5128; val_optim_loss: 5831972.5128
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.6709; val_auprc_score: 0.6764; val_best_acc_score: 0.6201; val_best_f1_score: 0.7150; train_kl_reg_loss: 29502.4849; train_edge_recon_loss: 3508016.2471; train_gene_expr_recon_loss: 2252092.8314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5789611.5538; train_optim_loss: 5789611.5538; val_kl_reg_loss: 28532.2136; val_edge_recon_loss: 3540817.9167; val_gene_expr_recon_loss: 2257091.1699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5826441.2949; val_optim_loss: 5826441.2949
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.6710; val_auprc_score: 0.6774; val_best_acc_score: 0.6201; val_best_f1_score: 0.7149; train_kl_reg_loss: 29510.4772; train_edge_recon_loss: 3506076.4942; train_gene_expr_recon_loss: 2251674.6443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5787261.6294; train_optim_loss: 5787261.6294; val_kl_reg_loss: 28595.1037; val_edge_recon_loss: 3541070.7179; val_gene_expr_recon_loss: 2258702.0769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5828367.8846; val_optim_loss: 5828367.8846
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.6696; val_auprc_score: 0.6754; val_best_acc_score: 0.6196; val_best_f1_score: 0.7150; train_kl_reg_loss: 29500.4481; train_edge_recon_loss: 3506482.4019; train_gene_expr_recon_loss: 2250342.0236; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5786324.8823; train_optim_loss: 5786324.8823; val_kl_reg_loss: 28561.4801; val_edge_recon_loss: 3534007.3590; val_gene_expr_recon_loss: 2257091.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5819660.7436; val_optim_loss: 5819660.7436
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.6720; val_auprc_score: 0.6767; val_best_acc_score: 0.6222; val_best_f1_score: 0.7157; train_kl_reg_loss: 29496.2437; train_edge_recon_loss: 3502911.1672; train_gene_expr_recon_loss: 2250705.5062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5783112.9273; train_optim_loss: 5783112.9273; val_kl_reg_loss: 28495.1485; val_edge_recon_loss: 3532675.3013; val_gene_expr_recon_loss: 2258968.4936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5820139.0000; val_optim_loss: 5820139.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.6676; val_auprc_score: 0.6742; val_best_acc_score: 0.6174; val_best_f1_score: 0.7137; train_kl_reg_loss: 29500.7312; train_edge_recon_loss: 3506048.0669; train_gene_expr_recon_loss: 2248591.3416; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5784140.1453; train_optim_loss: 5784140.1453; val_kl_reg_loss: 28616.0298; val_edge_recon_loss: 3546786.2372; val_gene_expr_recon_loss: 2256141.3013; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5831543.5641; val_optim_loss: 5831543.5641
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.6679; val_auprc_score: 0.6754; val_best_acc_score: 0.6180; val_best_f1_score: 0.7144; train_kl_reg_loss: 29493.8078; train_edge_recon_loss: 3504677.3634; train_gene_expr_recon_loss: 2248582.4731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5782753.6628; train_optim_loss: 5782753.6628; val_kl_reg_loss: 28573.2297; val_edge_recon_loss: 3543373.8910; val_gene_expr_recon_loss: 2261555.3141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5833502.4359; val_optim_loss: 5833502.4359

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 70 min 7 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9101
val AUPRC score: 0.9118
val best accuracy score: 0.8272
val best F1 score: 0.8314
val target rna MSE score: 2.9373
val source rna MSE score: 0.4255
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0125
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.6708; val_auprc_score: 0.6773; val_best_acc_score: 0.6183; val_best_f1_score: 0.7143; train_kl_reg_loss: 29505.2882; train_edge_recon_loss: 3506347.2558; train_gene_expr_recon_loss: 2251545.5810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5787398.1265; train_optim_loss: 5787398.1265; val_kl_reg_loss: 28523.1876; val_edge_recon_loss: 3540300.5449; val_gene_expr_recon_loss: 2255737.0769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5824560.8205; val_optim_loss: 5824560.8205

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.6664; val_auprc_score: 0.6706; val_best_acc_score: 0.6195; val_best_f1_score: 0.7149; train_kl_reg_loss: 29502.4773; train_edge_recon_loss: 3502736.0349; train_gene_expr_recon_loss: 2250716.7649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5782955.2674; train_optim_loss: 5782955.2674; val_kl_reg_loss: 28567.8604; val_edge_recon_loss: 3544886.2115; val_gene_expr_recon_loss: 2253843.5769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5827297.6795; val_optim_loss: 5827297.6795
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.6698; val_auprc_score: 0.6755; val_best_acc_score: 0.6190; val_best_f1_score: 0.7145; train_kl_reg_loss: 29507.1636; train_edge_recon_loss: 3503846.0799; train_gene_expr_recon_loss: 2248235.4615; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5781588.7108; train_optim_loss: 5781588.7108; val_kl_reg_loss: 28593.7278; val_edge_recon_loss: 3545540.1090; val_gene_expr_recon_loss: 2257877.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5832011.6154; val_optim_loss: 5832011.6154
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.6665; val_auprc_score: 0.6715; val_best_acc_score: 0.6166; val_best_f1_score: 0.7132; train_kl_reg_loss: 29501.7747; train_edge_recon_loss: 3502364.9019; train_gene_expr_recon_loss: 2248600.9484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5780467.6235; train_optim_loss: 5780467.6235; val_kl_reg_loss: 28616.7799; val_edge_recon_loss: 3546327.3910; val_gene_expr_recon_loss: 2260999.6186; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5835943.7821; val_optim_loss: 5835943.7821
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.6711; val_auprc_score: 0.6775; val_best_acc_score: 0.6208; val_best_f1_score: 0.7160; train_kl_reg_loss: 29490.6891; train_edge_recon_loss: 3502415.6134; train_gene_expr_recon_loss: 2247538.6315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5779444.9448; train_optim_loss: 5779444.9448; val_kl_reg_loss: 28531.4091; val_edge_recon_loss: 3533517.6090; val_gene_expr_recon_loss: 2252303.4872; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5814352.5256; val_optim_loss: 5814352.5256
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.6673; val_auprc_score: 0.6722; val_best_acc_score: 0.6207; val_best_f1_score: 0.7152; train_kl_reg_loss: 29507.2652; train_edge_recon_loss: 3506720.2384; train_gene_expr_recon_loss: 2249977.3939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5786204.9055; train_optim_loss: 5786204.9055; val_kl_reg_loss: 28582.3895; val_edge_recon_loss: 3541666.1346; val_gene_expr_recon_loss: 2258546.4038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5828794.9487; val_optim_loss: 5828794.9487
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.6677; val_auprc_score: 0.6732; val_best_acc_score: 0.6202; val_best_f1_score: 0.7154; train_kl_reg_loss: 29504.6097; train_edge_recon_loss: 3505721.8328; train_gene_expr_recon_loss: 2249959.1134; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5785185.5422; train_optim_loss: 5785185.5422; val_kl_reg_loss: 28527.7874; val_edge_recon_loss: 3537819.0577; val_gene_expr_recon_loss: 2254193.3782; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5820540.2051; val_optim_loss: 5820540.2051
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.6674; val_auprc_score: 0.6752; val_best_acc_score: 0.6185; val_best_f1_score: 0.7141; train_kl_reg_loss: 29496.7424; train_edge_recon_loss: 3504779.6824; train_gene_expr_recon_loss: 2249867.7449; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5784144.1788; train_optim_loss: 5784144.1788; val_kl_reg_loss: 28524.9439; val_edge_recon_loss: 3545198.1218; val_gene_expr_recon_loss: 2250313.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5824036.0385; val_optim_loss: 5824036.0385
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.6707; val_auprc_score: 0.6762; val_best_acc_score: 0.6214; val_best_f1_score: 0.7161; train_kl_reg_loss: 29489.2525; train_edge_recon_loss: 3502950.1940; train_gene_expr_recon_loss: 2248692.3100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5781131.7703; train_optim_loss: 5781131.7703; val_kl_reg_loss: 28551.4915; val_edge_recon_loss: 3533199.7244; val_gene_expr_recon_loss: 2257185.4936; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5818936.7051; val_optim_loss: 5818936.7051

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.6691; val_auprc_score: 0.6763; val_best_acc_score: 0.6185; val_best_f1_score: 0.7145; train_kl_reg_loss: 29494.4699; train_edge_recon_loss: 3505759.8721; train_gene_expr_recon_loss: 2251712.9658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5786967.3038; train_optim_loss: 5786967.3038; val_kl_reg_loss: 28492.9519; val_edge_recon_loss: 3541423.9936; val_gene_expr_recon_loss: 2255204.0353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5825121.0128; val_optim_loss: 5825121.0128
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.6699; val_auprc_score: 0.6762; val_best_acc_score: 0.6201; val_best_f1_score: 0.7145; train_kl_reg_loss: 29504.7372; train_edge_recon_loss: 3504521.1890; train_gene_expr_recon_loss: 2250945.9880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5784971.9259; train_optim_loss: 5784971.9259; val_kl_reg_loss: 28570.9121; val_edge_recon_loss: 3543341.3462; val_gene_expr_recon_loss: 2263082.5064; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5834994.7949; val_optim_loss: 5834994.7949
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.6697; val_auprc_score: 0.6754; val_best_acc_score: 0.6192; val_best_f1_score: 0.7145; train_kl_reg_loss: 29520.1678; train_edge_recon_loss: 3504808.4062; train_gene_expr_recon_loss: 2253262.0640; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5787590.6439; train_optim_loss: 5787590.6439; val_kl_reg_loss: 28530.3574; val_edge_recon_loss: 3537342.9615; val_gene_expr_recon_loss: 2250746.9038; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5816620.2179; val_optim_loss: 5816620.2179
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.6705; val_auprc_score: 0.6781; val_best_acc_score: 0.6203; val_best_f1_score: 0.7157; train_kl_reg_loss: 29499.1633; train_edge_recon_loss: 3505635.9390; train_gene_expr_recon_loss: 2249138.0658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5784273.1570; train_optim_loss: 5784273.1570; val_kl_reg_loss: 28546.1535; val_edge_recon_loss: 3539072.0000; val_gene_expr_recon_loss: 2258706.1218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5826324.2692; val_optim_loss: 5826324.2692

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 133 min 13 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.6708
val AUPRC score: 0.6780
val best accuracy score: 0.6193
val best F1 score: 0.7149
val target rna MSE score: 17.2668
val source rna MSE score: 0.9331
Val cat covariate0 mean sim diff: nan
Val cat covariate1 mean sim diff: -0.0438
Val cat covariate2 mean sim diff: nan

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
