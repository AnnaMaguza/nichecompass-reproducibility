[True]
Run timestamp: 07072023_185811_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'starmap_plus_mouse_cns', '--reference_batches', 'batch1', 'batch2', '--n_neighbors', '8', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '0.1', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'one-hop-norm_reference_query_reference_only', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gcnconv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '250000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--edge_batch_size', '1024', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2324.
Number of gene programs after filtering and combining: 1818.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ENCODER -> n_input: 1022, n_cat_covariates_embed_input: 0, n_layers: 1, n_hidden: 1022, n_latent: 1423, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 1423, n_cat_covariates_embed_input: 3, n_addon_input: 0, n_output: 2044
ONE HOP GCN NORM NODE LABEL AGGREGATOR

--- INITIALIZING TRAINER ---
Number of training nodes: 193574
Number of validation nodes: 21508
Number of training edges: 896733
Number of validation edges: 99637
Edge batch size: 1024
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9488; val_auprc_score: 0.9618; val_best_acc_score: 0.9336; val_best_f1_score: 0.9514; train_kl_reg_loss: 6757.9365; train_edge_recon_loss: 185658.5607; train_cat_covariates_contrastive_loss: 80328.7119; train_gene_expr_recon_loss: 108571.1735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 381316.3833; train_optim_loss: 381316.3833; val_kl_reg_loss: 6290.1873; val_edge_recon_loss: 178189.1145; val_cat_covariates_contrastive_loss: 79244.7350; val_gene_expr_recon_loss: 96277.0685; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 360001.1049; val_optim_loss: 360001.1049
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9494; val_auprc_score: 0.9609; val_best_acc_score: 0.9427; val_best_f1_score: 0.9580; train_kl_reg_loss: 6383.3071; train_edge_recon_loss: 177208.0501; train_cat_covariates_contrastive_loss: 79586.0043; train_gene_expr_recon_loss: 93960.7331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 357138.0953; train_optim_loss: 357138.0953; val_kl_reg_loss: 6358.6813; val_edge_recon_loss: 177050.5059; val_cat_covariates_contrastive_loss: 79122.0171; val_gene_expr_recon_loss: 92091.4273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 354622.6291; val_optim_loss: 354622.6291
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9515; val_auprc_score: 0.9631; val_best_acc_score: 0.9464; val_best_f1_score: 0.9607; train_kl_reg_loss: 6312.1622; train_edge_recon_loss: 176870.2553; train_cat_covariates_contrastive_loss: 79519.4832; train_gene_expr_recon_loss: 91338.5090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 354040.4101; train_optim_loss: 354040.4101; val_kl_reg_loss: 6097.9462; val_edge_recon_loss: 175608.0246; val_cat_covariates_contrastive_loss: 78978.2296; val_gene_expr_recon_loss: 90705.0706; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 351389.2720; val_optim_loss: 351389.2720
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9493; val_auprc_score: 0.9606; val_best_acc_score: 0.9484; val_best_f1_score: 0.9621; train_kl_reg_loss: 6323.9079; train_edge_recon_loss: 176386.2726; train_cat_covariates_contrastive_loss: 79511.3306; train_gene_expr_recon_loss: 89672.3456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 351893.8571; train_optim_loss: 351893.8571; val_kl_reg_loss: 6492.5679; val_edge_recon_loss: 176042.8525; val_cat_covariates_contrastive_loss: 78997.8434; val_gene_expr_recon_loss: 88844.9075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 350378.1725; val_optim_loss: 350378.1725
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9497; val_auprc_score: 0.9611; val_best_acc_score: 0.9491; val_best_f1_score: 0.9626; train_kl_reg_loss: 6358.4711; train_edge_recon_loss: 176265.7625; train_cat_covariates_contrastive_loss: 79529.7928; train_gene_expr_recon_loss: 88587.4369; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 350741.4637; train_optim_loss: 350741.4637; val_kl_reg_loss: 6255.9991; val_edge_recon_loss: 176207.3857; val_cat_covariates_contrastive_loss: 79039.0453; val_gene_expr_recon_loss: 87952.8823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349455.3131; val_optim_loss: 349455.3131
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9509; val_auprc_score: 0.9624; val_best_acc_score: 0.9493; val_best_f1_score: 0.9628; train_kl_reg_loss: 6393.3540; train_edge_recon_loss: 176208.6261; train_cat_covariates_contrastive_loss: 79532.5339; train_gene_expr_recon_loss: 87800.9695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349935.4830; train_optim_loss: 349935.4830; val_kl_reg_loss: 6503.2356; val_edge_recon_loss: 175846.3450; val_cat_covariates_contrastive_loss: 79149.6187; val_gene_expr_recon_loss: 87907.3756; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 349406.5749; val_optim_loss: 349406.5749
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9511; val_auprc_score: 0.9623; val_best_acc_score: 0.9519; val_best_f1_score: 0.9647; train_kl_reg_loss: 6446.8139; train_edge_recon_loss: 176495.5532; train_cat_covariates_contrastive_loss: 79562.7373; train_gene_expr_recon_loss: 87294.8127; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 349799.9169; train_optim_loss: 349799.9169; val_kl_reg_loss: 6276.1115; val_edge_recon_loss: 175386.6842; val_cat_covariates_contrastive_loss: 79159.3118; val_gene_expr_recon_loss: 87190.8682; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348012.9754; val_optim_loss: 348012.9754
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9517; val_auprc_score: 0.9631; val_best_acc_score: 0.9518; val_best_f1_score: 0.9645; train_kl_reg_loss: 6480.8049; train_edge_recon_loss: 175888.6134; train_cat_covariates_contrastive_loss: 79544.8889; train_gene_expr_recon_loss: 86904.3533; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348818.6600; train_optim_loss: 348818.6600; val_kl_reg_loss: 6463.1956; val_edge_recon_loss: 176295.6100; val_cat_covariates_contrastive_loss: 79091.2376; val_gene_expr_recon_loss: 86563.7953; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348413.8371; val_optim_loss: 348413.8371
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9518; val_auprc_score: 0.9625; val_best_acc_score: 0.9526; val_best_f1_score: 0.9652; train_kl_reg_loss: 6501.8088; train_edge_recon_loss: 175781.9316; train_cat_covariates_contrastive_loss: 79534.7037; train_gene_expr_recon_loss: 86492.0825; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348310.5268; train_optim_loss: 348310.5268; val_kl_reg_loss: 6479.2374; val_edge_recon_loss: 175669.3686; val_cat_covariates_contrastive_loss: 79099.4868; val_gene_expr_recon_loss: 86878.4062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348126.5000; val_optim_loss: 348126.5000
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9521; val_auprc_score: 0.9629; val_best_acc_score: 0.9533; val_best_f1_score: 0.9655; train_kl_reg_loss: 6524.7981; train_edge_recon_loss: 175825.4696; train_cat_covariates_contrastive_loss: 79505.5760; train_gene_expr_recon_loss: 86236.9110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 348092.7544; train_optim_loss: 348092.7544; val_kl_reg_loss: 6554.0578; val_edge_recon_loss: 176746.0630; val_cat_covariates_contrastive_loss: 79066.9966; val_gene_expr_recon_loss: 86295.4094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 348662.5265; val_optim_loss: 348662.5265
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9523; val_auprc_score: 0.9632; val_best_acc_score: 0.9535; val_best_f1_score: 0.9658; train_kl_reg_loss: 6533.8051; train_edge_recon_loss: 175829.8687; train_cat_covariates_contrastive_loss: 79486.1396; train_gene_expr_recon_loss: 86003.0784; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347852.8920; train_optim_loss: 347852.8920; val_kl_reg_loss: 6542.2089; val_edge_recon_loss: 176020.8074; val_cat_covariates_contrastive_loss: 79182.9003; val_gene_expr_recon_loss: 85914.4771; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347660.3948; val_optim_loss: 347660.3948
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9512; val_auprc_score: 0.9621; val_best_acc_score: 0.9533; val_best_f1_score: 0.9657; train_kl_reg_loss: 6557.9463; train_edge_recon_loss: 175523.8755; train_cat_covariates_contrastive_loss: 79502.7556; train_gene_expr_recon_loss: 85752.3317; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347336.9089; train_optim_loss: 347336.9089; val_kl_reg_loss: 6337.2492; val_edge_recon_loss: 175914.1140; val_cat_covariates_contrastive_loss: 79101.6088; val_gene_expr_recon_loss: 85962.7128; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347315.6853; val_optim_loss: 347315.6853
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9518; val_auprc_score: 0.9629; val_best_acc_score: 0.9544; val_best_f1_score: 0.9665; train_kl_reg_loss: 6572.5041; train_edge_recon_loss: 175661.4008; train_cat_covariates_contrastive_loss: 79481.8327; train_gene_expr_recon_loss: 85543.2697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347259.0085; train_optim_loss: 347259.0085; val_kl_reg_loss: 6425.2589; val_edge_recon_loss: 175110.8061; val_cat_covariates_contrastive_loss: 79068.0032; val_gene_expr_recon_loss: 85963.1787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346567.2484; val_optim_loss: 346567.2484
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9502; val_auprc_score: 0.9610; val_best_acc_score: 0.9534; val_best_f1_score: 0.9657; train_kl_reg_loss: 6585.5766; train_edge_recon_loss: 175770.4747; train_cat_covariates_contrastive_loss: 79470.7831; train_gene_expr_recon_loss: 85411.4692; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 347238.3034; train_optim_loss: 347238.3034; val_kl_reg_loss: 6572.4913; val_edge_recon_loss: 176495.2313; val_cat_covariates_contrastive_loss: 79079.0935; val_gene_expr_recon_loss: 85527.1016; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 347673.9196; val_optim_loss: 347673.9196
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9518; val_auprc_score: 0.9623; val_best_acc_score: 0.9549; val_best_f1_score: 0.9668; train_kl_reg_loss: 6599.3725; train_edge_recon_loss: 175422.4034; train_cat_covariates_contrastive_loss: 79475.7614; train_gene_expr_recon_loss: 85301.2023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346798.7384; train_optim_loss: 346798.7384; val_kl_reg_loss: 6495.7327; val_edge_recon_loss: 175096.7333; val_cat_covariates_contrastive_loss: 79143.9479; val_gene_expr_recon_loss: 85576.8365; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346313.2513; val_optim_loss: 346313.2513
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9520; val_auprc_score: 0.9625; val_best_acc_score: 0.9550; val_best_f1_score: 0.9669; train_kl_reg_loss: 6618.5466; train_edge_recon_loss: 175463.1540; train_cat_covariates_contrastive_loss: 79452.8236; train_gene_expr_recon_loss: 85159.2782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346693.8021; train_optim_loss: 346693.8021; val_kl_reg_loss: 6547.3372; val_edge_recon_loss: 175134.8760; val_cat_covariates_contrastive_loss: 79045.7447; val_gene_expr_recon_loss: 85497.2348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346225.1920; val_optim_loss: 346225.1920
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9520; val_auprc_score: 0.9627; val_best_acc_score: 0.9550; val_best_f1_score: 0.9668; train_kl_reg_loss: 6629.2662; train_edge_recon_loss: 175612.3362; train_cat_covariates_contrastive_loss: 79452.2848; train_gene_expr_recon_loss: 85035.5180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346729.4053; train_optim_loss: 346729.4053; val_kl_reg_loss: 6529.2385; val_edge_recon_loss: 175687.8401; val_cat_covariates_contrastive_loss: 79085.3883; val_gene_expr_recon_loss: 85182.3786; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346484.8453; val_optim_loss: 346484.8453
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9528; val_auprc_score: 0.9637; val_best_acc_score: 0.9554; val_best_f1_score: 0.9671; train_kl_reg_loss: 6645.0983; train_edge_recon_loss: 175594.9820; train_cat_covariates_contrastive_loss: 79467.0766; train_gene_expr_recon_loss: 84919.1599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346626.3174; train_optim_loss: 346626.3174; val_kl_reg_loss: 6555.3044; val_edge_recon_loss: 175394.6523; val_cat_covariates_contrastive_loss: 79216.8041; val_gene_expr_recon_loss: 85377.6590; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346544.4209; val_optim_loss: 346544.4209
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9501; val_auprc_score: 0.9608; val_best_acc_score: 0.9555; val_best_f1_score: 0.9673; train_kl_reg_loss: 6651.3797; train_edge_recon_loss: 175350.3903; train_cat_covariates_contrastive_loss: 79449.8746; train_gene_expr_recon_loss: 84776.0064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346227.6507; train_optim_loss: 346227.6507; val_kl_reg_loss: 6729.7478; val_edge_recon_loss: 174690.8090; val_cat_covariates_contrastive_loss: 79028.7376; val_gene_expr_recon_loss: 85204.3134; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345653.6075; val_optim_loss: 345653.6075
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9509; val_auprc_score: 0.9618; val_best_acc_score: 0.9553; val_best_f1_score: 0.9671; train_kl_reg_loss: 6663.9546; train_edge_recon_loss: 175666.6448; train_cat_covariates_contrastive_loss: 79417.6846; train_gene_expr_recon_loss: 84715.8095; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346464.0932; train_optim_loss: 346464.0932; val_kl_reg_loss: 6582.8641; val_edge_recon_loss: 175295.3809; val_cat_covariates_contrastive_loss: 79098.2912; val_gene_expr_recon_loss: 85047.2191; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346023.7564; val_optim_loss: 346023.7564
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9534; val_auprc_score: 0.9644; val_best_acc_score: 0.9562; val_best_f1_score: 0.9678; train_kl_reg_loss: 6668.2731; train_edge_recon_loss: 175252.5497; train_cat_covariates_contrastive_loss: 79429.7812; train_gene_expr_recon_loss: 84640.3352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345990.9393; train_optim_loss: 345990.9393; val_kl_reg_loss: 6573.0014; val_edge_recon_loss: 174891.4606; val_cat_covariates_contrastive_loss: 79108.6134; val_gene_expr_recon_loss: 85012.7693; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345585.8434; val_optim_loss: 345585.8434
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9533; val_auprc_score: 0.9643; val_best_acc_score: 0.9568; val_best_f1_score: 0.9681; train_kl_reg_loss: 6682.2980; train_edge_recon_loss: 175562.2760; train_cat_covariates_contrastive_loss: 79419.3085; train_gene_expr_recon_loss: 84566.8065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 346230.6889; train_optim_loss: 346230.6889; val_kl_reg_loss: 6683.7432; val_edge_recon_loss: 174850.6129; val_cat_covariates_contrastive_loss: 79046.4051; val_gene_expr_recon_loss: 84853.9562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345434.7165; val_optim_loss: 345434.7165
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9512; val_auprc_score: 0.9620; val_best_acc_score: 0.9556; val_best_f1_score: 0.9674; train_kl_reg_loss: 6680.9676; train_edge_recon_loss: 175450.7464; train_cat_covariates_contrastive_loss: 79411.6964; train_gene_expr_recon_loss: 84435.6085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345979.0194; train_optim_loss: 345979.0194; val_kl_reg_loss: 6605.3593; val_edge_recon_loss: 174818.3659; val_cat_covariates_contrastive_loss: 79022.8131; val_gene_expr_recon_loss: 85199.0930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345645.6323; val_optim_loss: 345645.6323
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9509; val_auprc_score: 0.9616; val_best_acc_score: 0.9559; val_best_f1_score: 0.9675; train_kl_reg_loss: 6692.9464; train_edge_recon_loss: 174997.8418; train_cat_covariates_contrastive_loss: 79400.0733; train_gene_expr_recon_loss: 84347.6576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345438.5191; train_optim_loss: 345438.5191; val_kl_reg_loss: 6629.8726; val_edge_recon_loss: 175515.4576; val_cat_covariates_contrastive_loss: 79028.0072; val_gene_expr_recon_loss: 85218.2370; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 346391.5727; val_optim_loss: 346391.5727
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9521; val_auprc_score: 0.9635; val_best_acc_score: 0.9559; val_best_f1_score: 0.9675; train_kl_reg_loss: 6696.5098; train_edge_recon_loss: 175341.4059; train_cat_covariates_contrastive_loss: 79403.0170; train_gene_expr_recon_loss: 84328.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345769.0688; train_optim_loss: 345769.0688; val_kl_reg_loss: 6702.9142; val_edge_recon_loss: 175423.6295; val_cat_covariates_contrastive_loss: 79105.2518; val_gene_expr_recon_loss: 84614.2728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345846.0676; val_optim_loss: 345846.0676
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9505; val_auprc_score: 0.9615; val_best_acc_score: 0.9558; val_best_f1_score: 0.9675; train_kl_reg_loss: 6708.5126; train_edge_recon_loss: 175522.4238; train_cat_covariates_contrastive_loss: 79407.7000; train_gene_expr_recon_loss: 84254.0163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345892.6529; train_optim_loss: 345892.6529; val_kl_reg_loss: 6611.2046; val_edge_recon_loss: 175017.6663; val_cat_covariates_contrastive_loss: 79073.9563; val_gene_expr_recon_loss: 84858.7962; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345561.6228; val_optim_loss: 345561.6228

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9511; val_auprc_score: 0.9618; val_best_acc_score: 0.9569; val_best_f1_score: 0.9683; train_kl_reg_loss: 6688.9624; train_edge_recon_loss: 175374.2137; train_cat_covariates_contrastive_loss: 79426.7173; train_gene_expr_recon_loss: 83611.2353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 345101.1284; train_optim_loss: 345101.1284; val_kl_reg_loss: 6601.1734; val_edge_recon_loss: 174777.8182; val_cat_covariates_contrastive_loss: 79164.0650; val_gene_expr_recon_loss: 84413.6488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344956.7031; val_optim_loss: 344956.7031
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9516; val_auprc_score: 0.9622; val_best_acc_score: 0.9561; val_best_f1_score: 0.9676; train_kl_reg_loss: 6683.2929; train_edge_recon_loss: 174928.4169; train_cat_covariates_contrastive_loss: 79396.2063; train_gene_expr_recon_loss: 83533.8739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344541.7896; train_optim_loss: 344541.7896; val_kl_reg_loss: 6620.5601; val_edge_recon_loss: 175152.6217; val_cat_covariates_contrastive_loss: 79092.2129; val_gene_expr_recon_loss: 84273.8115; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345139.2044; val_optim_loss: 345139.2044
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9502; val_auprc_score: 0.9611; val_best_acc_score: 0.9559; val_best_f1_score: 0.9676; train_kl_reg_loss: 6690.4313; train_edge_recon_loss: 175173.0863; train_cat_covariates_contrastive_loss: 79429.1005; train_gene_expr_recon_loss: 83490.3816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344782.9992; train_optim_loss: 344782.9992; val_kl_reg_loss: 6616.8516; val_edge_recon_loss: 174949.7851; val_cat_covariates_contrastive_loss: 79132.4955; val_gene_expr_recon_loss: 84554.4910; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345253.6209; val_optim_loss: 345253.6209
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9517; val_auprc_score: 0.9622; val_best_acc_score: 0.9572; val_best_f1_score: 0.9686; train_kl_reg_loss: 6681.0574; train_edge_recon_loss: 175151.6882; train_cat_covariates_contrastive_loss: 79405.7939; train_gene_expr_recon_loss: 83440.7774; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344679.3170; train_optim_loss: 344679.3170; val_kl_reg_loss: 6619.9359; val_edge_recon_loss: 174651.2364; val_cat_covariates_contrastive_loss: 79257.2278; val_gene_expr_recon_loss: 84117.0330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344645.4340; val_optim_loss: 344645.4340
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9505; val_auprc_score: 0.9611; val_best_acc_score: 0.9564; val_best_f1_score: 0.9679; train_kl_reg_loss: 6686.3452; train_edge_recon_loss: 175460.8992; train_cat_covariates_contrastive_loss: 79391.9330; train_gene_expr_recon_loss: 83437.9720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344977.1493; train_optim_loss: 344977.1493; val_kl_reg_loss: 6675.3987; val_edge_recon_loss: 175212.7604; val_cat_covariates_contrastive_loss: 79090.7232; val_gene_expr_recon_loss: 84629.1307; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345608.0108; val_optim_loss: 345608.0108
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9514; val_auprc_score: 0.9621; val_best_acc_score: 0.9562; val_best_f1_score: 0.9678; train_kl_reg_loss: 6682.3850; train_edge_recon_loss: 175380.1025; train_cat_covariates_contrastive_loss: 79390.7471; train_gene_expr_recon_loss: 83367.4763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344820.7113; train_optim_loss: 344820.7113; val_kl_reg_loss: 6622.3747; val_edge_recon_loss: 175155.5269; val_cat_covariates_contrastive_loss: 79056.8956; val_gene_expr_recon_loss: 84416.7924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345251.5906; val_optim_loss: 345251.5906
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9506; val_auprc_score: 0.9614; val_best_acc_score: 0.9565; val_best_f1_score: 0.9680; train_kl_reg_loss: 6686.4714; train_edge_recon_loss: 175308.1521; train_cat_covariates_contrastive_loss: 79396.7521; train_gene_expr_recon_loss: 83359.3242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344750.6995; train_optim_loss: 344750.6995; val_kl_reg_loss: 6613.1569; val_edge_recon_loss: 175020.8056; val_cat_covariates_contrastive_loss: 79056.4935; val_gene_expr_recon_loss: 84595.0787; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345285.5348; val_optim_loss: 345285.5348
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9515; val_auprc_score: 0.9622; val_best_acc_score: 0.9567; val_best_f1_score: 0.9682; train_kl_reg_loss: 6695.9877; train_edge_recon_loss: 174843.5023; train_cat_covariates_contrastive_loss: 79398.5701; train_gene_expr_recon_loss: 83353.3492; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344291.4087; train_optim_loss: 344291.4087; val_kl_reg_loss: 6625.8169; val_edge_recon_loss: 174762.2527; val_cat_covariates_contrastive_loss: 79130.3360; val_gene_expr_recon_loss: 84178.8034; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344697.2066; val_optim_loss: 344697.2066

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9519; val_auprc_score: 0.9622; val_best_acc_score: 0.9565; val_best_f1_score: 0.9680; train_kl_reg_loss: 6686.1339; train_edge_recon_loss: 175060.0292; train_cat_covariates_contrastive_loss: 79394.5903; train_gene_expr_recon_loss: 83247.2029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344387.9564; train_optim_loss: 344387.9564; val_kl_reg_loss: 6624.4421; val_edge_recon_loss: 175500.2143; val_cat_covariates_contrastive_loss: 79054.7430; val_gene_expr_recon_loss: 84387.4260; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345566.8256; val_optim_loss: 345566.8256
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9510; val_auprc_score: 0.9616; val_best_acc_score: 0.9567; val_best_f1_score: 0.9681; train_kl_reg_loss: 6686.2754; train_edge_recon_loss: 175213.6319; train_cat_covariates_contrastive_loss: 79411.2567; train_gene_expr_recon_loss: 83250.1475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344561.3105; train_optim_loss: 344561.3105; val_kl_reg_loss: 6649.5127; val_edge_recon_loss: 175304.5442; val_cat_covariates_contrastive_loss: 79075.6667; val_gene_expr_recon_loss: 84225.1904; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345254.9104; val_optim_loss: 345254.9104
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9502; val_auprc_score: 0.9611; val_best_acc_score: 0.9558; val_best_f1_score: 0.9674; train_kl_reg_loss: 6686.2812; train_edge_recon_loss: 175138.7688; train_cat_covariates_contrastive_loss: 79409.7054; train_gene_expr_recon_loss: 83239.9931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344474.7487; train_optim_loss: 344474.7487; val_kl_reg_loss: 6633.3958; val_edge_recon_loss: 175436.9150; val_cat_covariates_contrastive_loss: 79060.3127; val_gene_expr_recon_loss: 84096.5993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345227.2200; val_optim_loss: 345227.2200
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9516; val_auprc_score: 0.9623; val_best_acc_score: 0.9568; val_best_f1_score: 0.9682; train_kl_reg_loss: 6684.8186; train_edge_recon_loss: 175266.1375; train_cat_covariates_contrastive_loss: 79396.9706; train_gene_expr_recon_loss: 83225.5668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344573.4932; train_optim_loss: 344573.4932; val_kl_reg_loss: 6634.2467; val_edge_recon_loss: 174443.0625; val_cat_covariates_contrastive_loss: 79052.8016; val_gene_expr_recon_loss: 84091.2518; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344221.3645; val_optim_loss: 344221.3645
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9500; val_auprc_score: 0.9608; val_best_acc_score: 0.9565; val_best_f1_score: 0.9680; train_kl_reg_loss: 6687.3776; train_edge_recon_loss: 175243.7494; train_cat_covariates_contrastive_loss: 79409.0420; train_gene_expr_recon_loss: 83249.9386; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344590.1081; train_optim_loss: 344590.1081; val_kl_reg_loss: 6660.1198; val_edge_recon_loss: 174881.4501; val_cat_covariates_contrastive_loss: 79062.7097; val_gene_expr_recon_loss: 84064.0156; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344668.2934; val_optim_loss: 344668.2934
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9512; val_auprc_score: 0.9620; val_best_acc_score: 0.9569; val_best_f1_score: 0.9683; train_kl_reg_loss: 6687.8580; train_edge_recon_loss: 175118.2044; train_cat_covariates_contrastive_loss: 79401.9512; train_gene_expr_recon_loss: 83260.4990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344468.5124; train_optim_loss: 344468.5124; val_kl_reg_loss: 6643.8840; val_edge_recon_loss: 174526.7830; val_cat_covariates_contrastive_loss: 79072.1861; val_gene_expr_recon_loss: 84058.5844; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344301.4391; val_optim_loss: 344301.4391
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9515; val_auprc_score: 0.9618; val_best_acc_score: 0.9571; val_best_f1_score: 0.9684; train_kl_reg_loss: 6692.1401; train_edge_recon_loss: 175255.1022; train_cat_covariates_contrastive_loss: 79405.9243; train_gene_expr_recon_loss: 83198.2988; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344551.4654; train_optim_loss: 344551.4654; val_kl_reg_loss: 6633.3346; val_edge_recon_loss: 174955.8563; val_cat_covariates_contrastive_loss: 79118.8194; val_gene_expr_recon_loss: 84336.1721; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345044.1821; val_optim_loss: 345044.1821
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9510; val_auprc_score: 0.9617; val_best_acc_score: 0.9570; val_best_f1_score: 0.9684; train_kl_reg_loss: 6678.2215; train_edge_recon_loss: 174897.6538; train_cat_covariates_contrastive_loss: 79396.5578; train_gene_expr_recon_loss: 83218.1110; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344190.5436; train_optim_loss: 344190.5436; val_kl_reg_loss: 6626.8577; val_edge_recon_loss: 174582.9705; val_cat_covariates_contrastive_loss: 79081.0053; val_gene_expr_recon_loss: 84265.3263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344556.1598; val_optim_loss: 344556.1598

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9497; val_auprc_score: 0.9608; val_best_acc_score: 0.9556; val_best_f1_score: 0.9674; train_kl_reg_loss: 6680.1649; train_edge_recon_loss: 175105.2863; train_cat_covariates_contrastive_loss: 79405.1397; train_gene_expr_recon_loss: 83155.2181; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344345.8089; train_optim_loss: 344345.8089; val_kl_reg_loss: 6627.0217; val_edge_recon_loss: 175155.2211; val_cat_covariates_contrastive_loss: 79134.7767; val_gene_expr_recon_loss: 84056.8696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344973.8906; val_optim_loss: 344973.8906
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9512; val_auprc_score: 0.9618; val_best_acc_score: 0.9569; val_best_f1_score: 0.9683; train_kl_reg_loss: 6682.4797; train_edge_recon_loss: 175218.2818; train_cat_covariates_contrastive_loss: 79409.2270; train_gene_expr_recon_loss: 83226.1389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344536.1267; train_optim_loss: 344536.1267; val_kl_reg_loss: 6638.1047; val_edge_recon_loss: 174586.9324; val_cat_covariates_contrastive_loss: 79141.6570; val_gene_expr_recon_loss: 84276.5213; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344643.2149; val_optim_loss: 344643.2149
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9515; val_auprc_score: 0.9621; val_best_acc_score: 0.9567; val_best_f1_score: 0.9681; train_kl_reg_loss: 6683.0893; train_edge_recon_loss: 175275.8985; train_cat_covariates_contrastive_loss: 79420.5943; train_gene_expr_recon_loss: 83237.4432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344617.0253; train_optim_loss: 344617.0253; val_kl_reg_loss: 6635.0797; val_edge_recon_loss: 175484.1948; val_cat_covariates_contrastive_loss: 79135.7745; val_gene_expr_recon_loss: 84009.4193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 345264.4688; val_optim_loss: 345264.4688
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9509; val_auprc_score: 0.9620; val_best_acc_score: 0.9562; val_best_f1_score: 0.9678; train_kl_reg_loss: 6687.2323; train_edge_recon_loss: 175130.7337; train_cat_covariates_contrastive_loss: 79414.4467; train_gene_expr_recon_loss: 83144.8695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 344377.2820; train_optim_loss: 344377.2820; val_kl_reg_loss: 6631.8563; val_edge_recon_loss: 174495.7696; val_cat_covariates_contrastive_loss: 79035.5369; val_gene_expr_recon_loss: 84248.7211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 344411.8830; val_optim_loss: 344411.8830

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 293 min 52 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
Val AUROC score: 0.9518
Val AUPRC score: 0.9623
Val best accuracy score: 0.9571
Val best F1 score: 0.9683
Val gene expr MSE score: 0.5047

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
