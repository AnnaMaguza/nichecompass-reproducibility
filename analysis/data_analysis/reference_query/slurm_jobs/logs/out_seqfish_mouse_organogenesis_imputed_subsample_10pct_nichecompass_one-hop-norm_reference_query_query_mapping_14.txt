Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--reference_dataset', 'seqfish_mouse_organogenesis_imputed_subsample_10pct', '--query_dataset', 'seqfish_mouse_organogenesis_imputed', '--query_batches', 'batch5', 'batch6', '--n_neighbors', '8', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '08082024_140042_14', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1840, n_latent: 1840, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1840, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1840, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1840, n_latent: 1840, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1840, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1840, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 18519
Number of validation nodes: 2058
Number of training edges: 84228
Number of validation edges: 9358
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8519; val_auprc_score: 0.9201; val_best_acc_score: 0.7817; val_best_f1_score: 0.8470; train_kl_reg_loss: 49037.4252; train_edge_recon_loss: 2212859.3504; train_gene_expr_recon_loss: 22117453.3091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24379350.1152; train_optim_loss: 24379350.1152; val_kl_reg_loss: 49880.8498; val_edge_recon_loss: 2254972.5101; val_gene_expr_recon_loss: 20673854.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22978707.8378; val_optim_loss: 22978707.8378
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8538; val_auprc_score: 0.9230; val_best_acc_score: 0.7848; val_best_f1_score: 0.8496; train_kl_reg_loss: 49099.9873; train_edge_recon_loss: 2213888.2879; train_gene_expr_recon_loss: 19646115.5152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21909103.8485; train_optim_loss: 21909103.8485; val_kl_reg_loss: 49606.1042; val_edge_recon_loss: 2228910.4122; val_gene_expr_recon_loss: 18654883.6216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20933400.1622; val_optim_loss: 20933400.1622
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8532; val_auprc_score: 0.9225; val_best_acc_score: 0.7822; val_best_f1_score: 0.8481; train_kl_reg_loss: 49071.4336; train_edge_recon_loss: 2222841.3973; train_gene_expr_recon_loss: 17977701.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20249613.8364; train_optim_loss: 20249613.8364; val_kl_reg_loss: 49539.0924; val_edge_recon_loss: 2251838.4764; val_gene_expr_recon_loss: 17267110.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19568488.0000; val_optim_loss: 19568488.0000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8562; val_auprc_score: 0.9234; val_best_acc_score: 0.7831; val_best_f1_score: 0.8493; train_kl_reg_loss: 49140.7840; train_edge_recon_loss: 2222048.3564; train_gene_expr_recon_loss: 16749299.3667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19020488.5091; train_optim_loss: 19020488.5091; val_kl_reg_loss: 49564.5734; val_edge_recon_loss: 2233442.1723; val_gene_expr_recon_loss: 16212432.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18495439.6216; val_optim_loss: 18495439.6216
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8531; val_auprc_score: 0.9226; val_best_acc_score: 0.7838; val_best_f1_score: 0.8501; train_kl_reg_loss: 49057.6631; train_edge_recon_loss: 2215569.5636; train_gene_expr_recon_loss: 15827676.9030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18092304.1394; train_optim_loss: 18092304.1394; val_kl_reg_loss: 49282.7695; val_edge_recon_loss: 2230639.5541; val_gene_expr_recon_loss: 15403207.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17683130.2162; val_optim_loss: 17683130.2162
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8530; val_auprc_score: 0.9218; val_best_acc_score: 0.7826; val_best_f1_score: 0.8486; train_kl_reg_loss: 49035.0341; train_edge_recon_loss: 2218848.3167; train_gene_expr_recon_loss: 15116356.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17384240.3758; train_optim_loss: 17384240.3758; val_kl_reg_loss: 49636.6473; val_edge_recon_loss: 2239065.4426; val_gene_expr_recon_loss: 14767907.4054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17056609.3514; val_optim_loss: 17056609.3514
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8550; val_auprc_score: 0.9234; val_best_acc_score: 0.7832; val_best_f1_score: 0.8486; train_kl_reg_loss: 49084.5312; train_edge_recon_loss: 2217416.6780; train_gene_expr_recon_loss: 14587118.3091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16853619.5485; train_optim_loss: 16853619.5485; val_kl_reg_loss: 49436.1645; val_edge_recon_loss: 2233253.4932; val_gene_expr_recon_loss: 14314143.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16596833.6216; val_optim_loss: 16596833.6216
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8589; val_auprc_score: 0.9250; val_best_acc_score: 0.7856; val_best_f1_score: 0.8485; train_kl_reg_loss: 49049.4763; train_edge_recon_loss: 2228566.4311; train_gene_expr_recon_loss: 14169039.7242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16446655.5970; train_optim_loss: 16446655.5970; val_kl_reg_loss: 49401.9529; val_edge_recon_loss: 2259801.2365; val_gene_expr_recon_loss: 13941069.5676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16250272.8378; val_optim_loss: 16250272.8378
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8529; val_auprc_score: 0.9204; val_best_acc_score: 0.7780; val_best_f1_score: 0.8469; train_kl_reg_loss: 49056.7344; train_edge_recon_loss: 2219361.2784; train_gene_expr_recon_loss: 13861652.4212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16130070.4152; train_optim_loss: 16130070.4152; val_kl_reg_loss: 49328.5420; val_edge_recon_loss: 2250141.0912; val_gene_expr_recon_loss: 13692919.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15992389.3784; val_optim_loss: 15992389.3784
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8555; val_auprc_score: 0.9211; val_best_acc_score: 0.7875; val_best_f1_score: 0.8512; train_kl_reg_loss: 49058.2736; train_edge_recon_loss: 2224287.6413; train_gene_expr_recon_loss: 13629900.9667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15903246.8727; train_optim_loss: 15903246.8727; val_kl_reg_loss: 49518.6595; val_edge_recon_loss: 2225859.8345; val_gene_expr_recon_loss: 13510389.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15785768.2703; val_optim_loss: 15785768.2703
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8528; val_auprc_score: 0.9231; val_best_acc_score: 0.7810; val_best_f1_score: 0.8474; train_kl_reg_loss: 48999.7257; train_edge_recon_loss: 2224905.5000; train_gene_expr_recon_loss: 13463807.8818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15737713.1121; train_optim_loss: 15737713.1121; val_kl_reg_loss: 49529.9032; val_edge_recon_loss: 2239750.1824; val_gene_expr_recon_loss: 13375717.0270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15664997.1081; val_optim_loss: 15664997.1081
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8575; val_auprc_score: 0.9245; val_best_acc_score: 0.7858; val_best_f1_score: 0.8504; train_kl_reg_loss: 49040.8918; train_edge_recon_loss: 2217994.0129; train_gene_expr_recon_loss: 13353332.2212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15620367.1364; train_optim_loss: 15620367.1364; val_kl_reg_loss: 49567.8555; val_edge_recon_loss: 2241222.1115; val_gene_expr_recon_loss: 13241640.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15532430.2162; val_optim_loss: 15532430.2162
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8562; val_auprc_score: 0.9257; val_best_acc_score: 0.7859; val_best_f1_score: 0.8510; train_kl_reg_loss: 49041.4740; train_edge_recon_loss: 2228015.4152; train_gene_expr_recon_loss: 13273828.5939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15550885.5364; train_optim_loss: 15550885.5364; val_kl_reg_loss: 49624.7443; val_edge_recon_loss: 2219850.1993; val_gene_expr_recon_loss: 13209183.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15478658.5405; val_optim_loss: 15478658.5405
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8543; val_auprc_score: 0.9222; val_best_acc_score: 0.7845; val_best_f1_score: 0.8497; train_kl_reg_loss: 49106.3065; train_edge_recon_loss: 2227268.7996; train_gene_expr_recon_loss: 13225290.9758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15501666.0697; train_optim_loss: 15501666.0697; val_kl_reg_loss: 49471.3751; val_edge_recon_loss: 2238457.0642; val_gene_expr_recon_loss: 13182779.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15470708.1081; val_optim_loss: 15470708.1081
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8559; val_auprc_score: 0.9245; val_best_acc_score: 0.7868; val_best_f1_score: 0.8502; train_kl_reg_loss: 49041.8715; train_edge_recon_loss: 2222470.5242; train_gene_expr_recon_loss: 13193970.8606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15465483.2303; train_optim_loss: 15465483.2303; val_kl_reg_loss: 49719.6836; val_edge_recon_loss: 2232718.4291; val_gene_expr_recon_loss: 13149263.1892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15431701.2162; val_optim_loss: 15431701.2162
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8515; val_auprc_score: 0.9202; val_best_acc_score: 0.7811; val_best_f1_score: 0.8468; train_kl_reg_loss: 49104.1741; train_edge_recon_loss: 2219002.9284; train_gene_expr_recon_loss: 13179711.3758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15447818.4970; train_optim_loss: 15447818.4970; val_kl_reg_loss: 49599.3102; val_edge_recon_loss: 2252849.4189; val_gene_expr_recon_loss: 13133969.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15436417.7297; val_optim_loss: 15436417.7297
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8520; val_auprc_score: 0.9215; val_best_acc_score: 0.7817; val_best_f1_score: 0.8476; train_kl_reg_loss: 49081.2093; train_edge_recon_loss: 2216549.0144; train_gene_expr_recon_loss: 13171675.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15437306.1212; train_optim_loss: 15437306.1212; val_kl_reg_loss: 49700.1904; val_edge_recon_loss: 2257162.4797; val_gene_expr_recon_loss: 13149597.9730; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15456460.6486; val_optim_loss: 15456460.6486
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8566; val_auprc_score: 0.9250; val_best_acc_score: 0.7837; val_best_f1_score: 0.8491; train_kl_reg_loss: 49098.0444; train_edge_recon_loss: 2225600.8545; train_gene_expr_recon_loss: 13172476.3879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15447175.3061; train_optim_loss: 15447175.3061; val_kl_reg_loss: 49493.6817; val_edge_recon_loss: 2236624.7601; val_gene_expr_recon_loss: 13128480.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15414598.9730; val_optim_loss: 15414598.9730
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8583; val_auprc_score: 0.9247; val_best_acc_score: 0.7856; val_best_f1_score: 0.8500; train_kl_reg_loss: 49014.3388; train_edge_recon_loss: 2220616.9352; train_gene_expr_recon_loss: 13172120.1424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15441751.4333; train_optim_loss: 15441751.4333; val_kl_reg_loss: 49682.2480; val_edge_recon_loss: 2241028.2669; val_gene_expr_recon_loss: 13140979.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15431690.4054; val_optim_loss: 15431690.4054
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8540; val_auprc_score: 0.9225; val_best_acc_score: 0.7842; val_best_f1_score: 0.8500; train_kl_reg_loss: 49097.8332; train_edge_recon_loss: 2217056.2314; train_gene_expr_recon_loss: 13169968.0545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15436122.1121; train_optim_loss: 15436122.1121; val_kl_reg_loss: 49370.1928; val_edge_recon_loss: 2233729.8243; val_gene_expr_recon_loss: 13143057.7027; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15426157.6216; val_optim_loss: 15426157.6216
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8564; val_auprc_score: 0.9243; val_best_acc_score: 0.7849; val_best_f1_score: 0.8505; train_kl_reg_loss: 49121.8924; train_edge_recon_loss: 2229617.2822; train_gene_expr_recon_loss: 13165318.3455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15444057.5091; train_optim_loss: 15444057.5091; val_kl_reg_loss: 49290.3383; val_edge_recon_loss: 2217802.0101; val_gene_expr_recon_loss: 13126188.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15393280.5676; val_optim_loss: 15393280.5676
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8551; val_auprc_score: 0.9252; val_best_acc_score: 0.7823; val_best_f1_score: 0.8477; train_kl_reg_loss: 49034.1216; train_edge_recon_loss: 2219669.7992; train_gene_expr_recon_loss: 13167233.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15435937.0212; train_optim_loss: 15435937.0212; val_kl_reg_loss: 49464.9908; val_edge_recon_loss: 2233724.3514; val_gene_expr_recon_loss: 13134896.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15418085.9730; val_optim_loss: 15418085.9730
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8537; val_auprc_score: 0.9234; val_best_acc_score: 0.7814; val_best_f1_score: 0.8489; train_kl_reg_loss: 49075.6375; train_edge_recon_loss: 2209647.7568; train_gene_expr_recon_loss: 13171616.6909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15430340.0758; train_optim_loss: 15430340.0758; val_kl_reg_loss: 49346.8623; val_edge_recon_loss: 2235065.4628; val_gene_expr_recon_loss: 13132301.1892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15416713.4595; val_optim_loss: 15416713.4595
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8537; val_auprc_score: 0.9220; val_best_acc_score: 0.7818; val_best_f1_score: 0.8478; train_kl_reg_loss: 49069.7965; train_edge_recon_loss: 2225430.0848; train_gene_expr_recon_loss: 13165560.0758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15440059.9515; train_optim_loss: 15440059.9515; val_kl_reg_loss: 49475.7562; val_edge_recon_loss: 2251155.9392; val_gene_expr_recon_loss: 13136389.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15437021.4595; val_optim_loss: 15437021.4595
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8509; val_auprc_score: 0.9203; val_best_acc_score: 0.7820; val_best_f1_score: 0.8483; train_kl_reg_loss: 49097.4828; train_edge_recon_loss: 2229640.8068; train_gene_expr_recon_loss: 13166821.0485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15445559.3697; train_optim_loss: 15445559.3697; val_kl_reg_loss: 49851.7581; val_edge_recon_loss: 2248361.6081; val_gene_expr_recon_loss: 13147203.5405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15445416.8378; val_optim_loss: 15445416.8378

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8547; val_auprc_score: 0.9227; val_best_acc_score: 0.7820; val_best_f1_score: 0.8479; train_kl_reg_loss: 49125.3530; train_edge_recon_loss: 2224908.9758; train_gene_expr_recon_loss: 12855440.0121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15129474.3576; train_optim_loss: 15129474.3576; val_kl_reg_loss: 48463.8121; val_edge_recon_loss: 2252585.9155; val_gene_expr_recon_loss: 12870864.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15171913.8649; val_optim_loss: 15171913.8649
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8514; val_auprc_score: 0.9198; val_best_acc_score: 0.7793; val_best_f1_score: 0.8468; train_kl_reg_loss: 49133.8915; train_edge_recon_loss: 2236644.2409; train_gene_expr_recon_loss: 12855248.1455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15141026.2879; train_optim_loss: 15141026.2879; val_kl_reg_loss: 48334.4738; val_edge_recon_loss: 2244465.6284; val_gene_expr_recon_loss: 12856230.2973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15149030.3514; val_optim_loss: 15149030.3514
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8555; val_auprc_score: 0.9227; val_best_acc_score: 0.7820; val_best_f1_score: 0.8477; train_kl_reg_loss: 49119.1588; train_edge_recon_loss: 2232262.6451; train_gene_expr_recon_loss: 12852109.5970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15133491.3909; train_optim_loss: 15133491.3909; val_kl_reg_loss: 48685.0828; val_edge_recon_loss: 2253542.4527; val_gene_expr_recon_loss: 12841098.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15143325.4865; val_optim_loss: 15143325.4865
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8575; val_auprc_score: 0.9248; val_best_acc_score: 0.7874; val_best_f1_score: 0.8520; train_kl_reg_loss: 49036.8009; train_edge_recon_loss: 2219837.2739; train_gene_expr_recon_loss: 12855337.1909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15124211.2848; train_optim_loss: 15124211.2848; val_kl_reg_loss: 48507.2120; val_edge_recon_loss: 2218205.4291; val_gene_expr_recon_loss: 12866841.0811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15133553.7838; val_optim_loss: 15133553.7838
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8561; val_auprc_score: 0.9236; val_best_acc_score: 0.7827; val_best_f1_score: 0.8489; train_kl_reg_loss: 49105.7680; train_edge_recon_loss: 2238693.3152; train_gene_expr_recon_loss: 12853443.2303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15141242.3000; train_optim_loss: 15141242.3000; val_kl_reg_loss: 48434.3588; val_edge_recon_loss: 2237938.8784; val_gene_expr_recon_loss: 12878795.4595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15165168.7297; val_optim_loss: 15165168.7297
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8571; val_auprc_score: 0.9233; val_best_acc_score: 0.7858; val_best_f1_score: 0.8499; train_kl_reg_loss: 49035.3353; train_edge_recon_loss: 2222050.5534; train_gene_expr_recon_loss: 12853832.8424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15124918.7394; train_optim_loss: 15124918.7394; val_kl_reg_loss: 48761.2366; val_edge_recon_loss: 2245974.9730; val_gene_expr_recon_loss: 12857514.0270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15152250.2432; val_optim_loss: 15152250.2432
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8509; val_auprc_score: 0.9187; val_best_acc_score: 0.7800; val_best_f1_score: 0.8463; train_kl_reg_loss: 49098.3690; train_edge_recon_loss: 2219827.7083; train_gene_expr_recon_loss: 12852823.1485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15121749.2636; train_optim_loss: 15121749.2636; val_kl_reg_loss: 48496.7229; val_edge_recon_loss: 2265804.9831; val_gene_expr_recon_loss: 12875817.0811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15190118.7838; val_optim_loss: 15190118.7838
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8567; val_auprc_score: 0.9232; val_best_acc_score: 0.7864; val_best_f1_score: 0.8509; train_kl_reg_loss: 49087.0727; train_edge_recon_loss: 2214685.1008; train_gene_expr_recon_loss: 12850603.1879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15114375.3606; train_optim_loss: 15114375.3606; val_kl_reg_loss: 48306.8764; val_edge_recon_loss: 2224843.3649; val_gene_expr_recon_loss: 12863648.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15136799.0811; val_optim_loss: 15136799.0811

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8568; val_auprc_score: 0.9253; val_best_acc_score: 0.7840; val_best_f1_score: 0.8493; train_kl_reg_loss: 49124.1504; train_edge_recon_loss: 2221133.0134; train_gene_expr_recon_loss: 12852596.9879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15122854.1091; train_optim_loss: 15122854.1091; val_kl_reg_loss: 48505.8053; val_edge_recon_loss: 2232192.1081; val_gene_expr_recon_loss: 12876776.2162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15157474.1892; val_optim_loss: 15157474.1892
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8553; val_auprc_score: 0.9229; val_best_acc_score: 0.7797; val_best_f1_score: 0.8462; train_kl_reg_loss: 49061.6124; train_edge_recon_loss: 2212706.6678; train_gene_expr_recon_loss: 12851979.5515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15113747.8303; train_optim_loss: 15113747.8303; val_kl_reg_loss: 48953.7333; val_edge_recon_loss: 2266667.1216; val_gene_expr_recon_loss: 12852355.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15167976.7568; val_optim_loss: 15167976.7568
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8555; val_auprc_score: 0.9250; val_best_acc_score: 0.7852; val_best_f1_score: 0.8509; train_kl_reg_loss: 49060.0821; train_edge_recon_loss: 2229627.1580; train_gene_expr_recon_loss: 12853112.8364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15131800.0970; train_optim_loss: 15131800.0970; val_kl_reg_loss: 48479.0745; val_edge_recon_loss: 2213712.7432; val_gene_expr_recon_loss: 12873067.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15135259.0000; val_optim_loss: 15135259.0000
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8546; val_auprc_score: 0.9208; val_best_acc_score: 0.7830; val_best_f1_score: 0.8476; train_kl_reg_loss: 49133.4999; train_edge_recon_loss: 2224577.0413; train_gene_expr_recon_loss: 12851234.9424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15124945.4788; train_optim_loss: 15124945.4788; val_kl_reg_loss: 48332.2494; val_edge_recon_loss: 2270067.1520; val_gene_expr_recon_loss: 12856489.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15174889.2162; val_optim_loss: 15174889.2162

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 80 min 58 sec.
Using best model state, which was in epoch 29.

--- MODEL EVALUATION ---
val AUROC score: 0.8517
val AUPRC score: 0.9225
val best accuracy score: 0.7806
val best F1 score: 0.8495
val target rna MSE score: 5.1585
val source rna MSE score: 8.8753
Val cat covariate0 mean sim diff: -0.0038

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
