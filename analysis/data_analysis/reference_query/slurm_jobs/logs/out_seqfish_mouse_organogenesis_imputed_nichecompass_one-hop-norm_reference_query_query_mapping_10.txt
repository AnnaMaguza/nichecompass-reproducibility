Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--query_batches', 'batch1', 'batch2', 'batch5', 'batch6', '--n_neighbors', '8', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '07082024_124745_8', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1964, n_latent: 1864, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1864, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1864, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1964, n_latent: 1864, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1864, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1864, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 34545
Number of validation nodes: 3838
Number of training edges: 156703
Number of validation edges: 17411
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9654; val_auprc_score: 0.9885; val_best_acc_score: 0.9459; val_best_f1_score: 0.9668; train_kl_reg_loss: 18676.7543; train_edge_recon_loss: 1104660.3899; train_gene_expr_recon_loss: 246582386.5840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 247705723.8238; train_optim_loss: 247705723.8238; val_kl_reg_loss: 18701.5507; val_edge_recon_loss: 1108206.7382; val_gene_expr_recon_loss: 181151235.2464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 182278142.8406; val_optim_loss: 182278142.8406
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9645; val_auprc_score: 0.9879; val_best_acc_score: 0.9466; val_best_f1_score: 0.9668; train_kl_reg_loss: 18676.5229; train_edge_recon_loss: 1117282.1707; train_gene_expr_recon_loss: 141854536.5351; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 142990495.2170; train_optim_loss: 142990495.2170; val_kl_reg_loss: 18704.1816; val_edge_recon_loss: 1141916.4864; val_gene_expr_recon_loss: 111313543.8841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 112474165.1014; val_optim_loss: 112474165.1014
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9641; val_auprc_score: 0.9875; val_best_acc_score: 0.9457; val_best_f1_score: 0.9664; train_kl_reg_loss: 18669.5922; train_edge_recon_loss: 1118095.6362; train_gene_expr_recon_loss: 92385476.8548; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 93522242.0359; train_optim_loss: 93522242.0359; val_kl_reg_loss: 18704.0496; val_edge_recon_loss: 1112961.9429; val_gene_expr_recon_loss: 77088199.1884; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 78219865.1594; val_optim_loss: 78219865.1594
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9672; val_auprc_score: 0.9885; val_best_acc_score: 0.9475; val_best_f1_score: 0.9676; train_kl_reg_loss: 18676.3681; train_edge_recon_loss: 1115199.0746; train_gene_expr_recon_loss: 67137923.0016; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 68271798.4731; train_optim_loss: 68271798.4731; val_kl_reg_loss: 18696.4366; val_edge_recon_loss: 1098536.9701; val_gene_expr_recon_loss: 58614799.5942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 59732033.1594; val_optim_loss: 59732033.1594
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9673; val_auprc_score: 0.9890; val_best_acc_score: 0.9480; val_best_f1_score: 0.9679; train_kl_reg_loss: 18682.3014; train_edge_recon_loss: 1124002.3950; train_gene_expr_recon_loss: 52939597.6444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 54082282.3034; train_optim_loss: 54082282.3034; val_kl_reg_loss: 18708.7399; val_edge_recon_loss: 1086334.1938; val_gene_expr_recon_loss: 47836805.4493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 48941848.2899; val_optim_loss: 48941848.2899
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9646; val_auprc_score: 0.9876; val_best_acc_score: 0.9476; val_best_f1_score: 0.9675; train_kl_reg_loss: 18677.6264; train_edge_recon_loss: 1114600.5997; train_gene_expr_recon_loss: 44411719.4976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45544997.7684; train_optim_loss: 45544997.7684; val_kl_reg_loss: 18706.2556; val_edge_recon_loss: 1111370.8415; val_gene_expr_recon_loss: 41190543.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 42320620.9275; val_optim_loss: 42320620.9275
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9637; val_auprc_score: 0.9872; val_best_acc_score: 0.9451; val_best_f1_score: 0.9659; train_kl_reg_loss: 18674.7639; train_edge_recon_loss: 1110521.4471; train_gene_expr_recon_loss: 39169592.1697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40298788.4894; train_optim_loss: 40298788.4894; val_kl_reg_loss: 18696.3580; val_edge_recon_loss: 1119627.8958; val_gene_expr_recon_loss: 37193032.6377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38331356.8696; val_optim_loss: 38331356.8696
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9647; val_auprc_score: 0.9870; val_best_acc_score: 0.9484; val_best_f1_score: 0.9680; train_kl_reg_loss: 18671.6252; train_edge_recon_loss: 1117132.1026; train_gene_expr_recon_loss: 36104399.8499; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 37240203.5693; train_optim_loss: 37240203.5693; val_kl_reg_loss: 18668.4862; val_edge_recon_loss: 1113650.6168; val_gene_expr_recon_loss: 34937038.5507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36069357.6232; val_optim_loss: 36069357.6232
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9652; val_auprc_score: 0.9882; val_best_acc_score: 0.9488; val_best_f1_score: 0.9684; train_kl_reg_loss: 18674.9946; train_edge_recon_loss: 1116003.4103; train_gene_expr_recon_loss: 34475656.3132; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35610334.7406; train_optim_loss: 35610334.7406; val_kl_reg_loss: 18699.2504; val_edge_recon_loss: 1080643.1567; val_gene_expr_recon_loss: 33844546.0290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34943888.5797; val_optim_loss: 34943888.5797
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9638; val_auprc_score: 0.9871; val_best_acc_score: 0.9469; val_best_f1_score: 0.9671; train_kl_reg_loss: 18682.8215; train_edge_recon_loss: 1115964.6990; train_gene_expr_recon_loss: 33747310.5873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34881958.0881; train_optim_loss: 34881958.0881; val_kl_reg_loss: 18711.5138; val_edge_recon_loss: 1128681.1132; val_gene_expr_recon_loss: 33400032.4928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34547424.8696; val_optim_loss: 34547424.8696
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9645; val_auprc_score: 0.9878; val_best_acc_score: 0.9474; val_best_f1_score: 0.9675; train_kl_reg_loss: 18671.2799; train_edge_recon_loss: 1121827.6546; train_gene_expr_recon_loss: 33441875.3475; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34582374.2577; train_optim_loss: 34582374.2577; val_kl_reg_loss: 18700.1390; val_edge_recon_loss: 1130799.9755; val_gene_expr_recon_loss: 33224085.2464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34373585.3333; val_optim_loss: 34373585.3333
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9648; val_auprc_score: 0.9881; val_best_acc_score: 0.9450; val_best_f1_score: 0.9662; train_kl_reg_loss: 18669.6510; train_edge_recon_loss: 1117267.2980; train_gene_expr_recon_loss: 33341261.8075; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34477198.7602; train_optim_loss: 34477198.7602; val_kl_reg_loss: 18685.5747; val_edge_recon_loss: 1101514.3768; val_gene_expr_recon_loss: 33154839.4203; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34275039.3623; val_optim_loss: 34275039.3623
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9651; val_auprc_score: 0.9872; val_best_acc_score: 0.9470; val_best_f1_score: 0.9672; train_kl_reg_loss: 18681.9264; train_edge_recon_loss: 1114739.8987; train_gene_expr_recon_loss: 33295532.8157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34428954.6754; train_optim_loss: 34428954.6754; val_kl_reg_loss: 18743.0873; val_edge_recon_loss: 1115031.8342; val_gene_expr_recon_loss: 33105752.4348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34239527.5942; val_optim_loss: 34239527.5942
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9660; val_auprc_score: 0.9884; val_best_acc_score: 0.9477; val_best_f1_score: 0.9675; train_kl_reg_loss: 18667.3741; train_edge_recon_loss: 1115955.8059; train_gene_expr_recon_loss: 33280082.1240; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34414705.2790; train_optim_loss: 34414705.2790; val_kl_reg_loss: 18693.4846; val_edge_recon_loss: 1115062.3225; val_gene_expr_recon_loss: 33109511.7391; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34243267.3623; val_optim_loss: 34243267.3623
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9664; val_auprc_score: 0.9877; val_best_acc_score: 0.9467; val_best_f1_score: 0.9671; train_kl_reg_loss: 18674.7326; train_edge_recon_loss: 1109608.0493; train_gene_expr_recon_loss: 33276286.0294; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34404568.8287; train_optim_loss: 34404568.8287; val_kl_reg_loss: 18724.0251; val_edge_recon_loss: 1134180.7346; val_gene_expr_recon_loss: 33112133.3623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34265038.2609; val_optim_loss: 34265038.2609
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9653; val_auprc_score: 0.9880; val_best_acc_score: 0.9486; val_best_f1_score: 0.9683; train_kl_reg_loss: 18670.6614; train_edge_recon_loss: 1116509.6795; train_gene_expr_recon_loss: 33272875.3344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34408055.7259; train_optim_loss: 34408055.7259; val_kl_reg_loss: 18697.1483; val_edge_recon_loss: 1108301.5127; val_gene_expr_recon_loss: 33120157.5072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34247156.1739; val_optim_loss: 34247156.1739
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9617; val_auprc_score: 0.9858; val_best_acc_score: 0.9460; val_best_f1_score: 0.9665; train_kl_reg_loss: 18679.4170; train_edge_recon_loss: 1119229.1587; train_gene_expr_recon_loss: 33270855.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34408763.6998; train_optim_loss: 34408763.6998; val_kl_reg_loss: 18698.0759; val_edge_recon_loss: 1113372.1168; val_gene_expr_recon_loss: 33102809.7101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34234879.9710; val_optim_loss: 34234879.9710
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9666; val_auprc_score: 0.9885; val_best_acc_score: 0.9475; val_best_f1_score: 0.9676; train_kl_reg_loss: 18673.6598; train_edge_recon_loss: 1114924.3963; train_gene_expr_recon_loss: 33272652.7113; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34406250.7471; train_optim_loss: 34406250.7471; val_kl_reg_loss: 18692.2492; val_edge_recon_loss: 1101536.5127; val_gene_expr_recon_loss: 33113598.8406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34233827.4203; val_optim_loss: 34233827.4203
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9682; val_auprc_score: 0.9892; val_best_acc_score: 0.9512; val_best_f1_score: 0.9700; train_kl_reg_loss: 18672.8138; train_edge_recon_loss: 1116166.2447; train_gene_expr_recon_loss: 33272573.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34407412.2023; train_optim_loss: 34407412.2023; val_kl_reg_loss: 18736.1696; val_edge_recon_loss: 1080891.9330; val_gene_expr_recon_loss: 33094521.3913; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34194149.6232; val_optim_loss: 34194149.6232
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9666; val_auprc_score: 0.9889; val_best_acc_score: 0.9477; val_best_f1_score: 0.9678; train_kl_reg_loss: 18669.4657; train_edge_recon_loss: 1117139.1360; train_gene_expr_recon_loss: 33274795.5987; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34410604.2741; train_optim_loss: 34410604.2741; val_kl_reg_loss: 18693.5592; val_edge_recon_loss: 1087200.8913; val_gene_expr_recon_loss: 33125608.4058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34231502.7246; val_optim_loss: 34231502.7246
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9659; val_auprc_score: 0.9884; val_best_acc_score: 0.9469; val_best_f1_score: 0.9672; train_kl_reg_loss: 18676.7871; train_edge_recon_loss: 1118490.0285; train_gene_expr_recon_loss: 33276664.5383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34413831.3670; train_optim_loss: 34413831.3670; val_kl_reg_loss: 18684.5487; val_edge_recon_loss: 1094469.3297; val_gene_expr_recon_loss: 33102835.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34215989.0145; val_optim_loss: 34215989.0145
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9639; val_auprc_score: 0.9867; val_best_acc_score: 0.9460; val_best_f1_score: 0.9665; train_kl_reg_loss: 18675.5725; train_edge_recon_loss: 1116398.2309; train_gene_expr_recon_loss: 33274474.4894; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34409548.3132; train_optim_loss: 34409548.3132; val_kl_reg_loss: 18689.4394; val_edge_recon_loss: 1115027.0326; val_gene_expr_recon_loss: 33126897.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34260614.1449; val_optim_loss: 34260614.1449
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9668; val_auprc_score: 0.9891; val_best_acc_score: 0.9480; val_best_f1_score: 0.9679; train_kl_reg_loss: 18676.5716; train_edge_recon_loss: 1118856.5146; train_gene_expr_recon_loss: 33272478.1272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34410011.1452; train_optim_loss: 34410011.1452; val_kl_reg_loss: 18719.7885; val_edge_recon_loss: 1108183.6241; val_gene_expr_recon_loss: 33104239.8841; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34231143.2464; val_optim_loss: 34231143.2464

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9646; val_auprc_score: 0.9881; val_best_acc_score: 0.9482; val_best_f1_score: 0.9678; train_kl_reg_loss: 18676.2380; train_edge_recon_loss: 1112138.1923; train_gene_expr_recon_loss: 33273566.0881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34404380.6069; train_optim_loss: 34404380.6069; val_kl_reg_loss: 18721.1657; val_edge_recon_loss: 1088760.7201; val_gene_expr_recon_loss: 33108375.6812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34215857.5072; val_optim_loss: 34215857.5072
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9661; val_auprc_score: 0.9882; val_best_acc_score: 0.9489; val_best_f1_score: 0.9684; train_kl_reg_loss: 18670.7028; train_edge_recon_loss: 1107207.0840; train_gene_expr_recon_loss: 33274347.7814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34400225.5987; train_optim_loss: 34400225.5987; val_kl_reg_loss: 18699.9549; val_edge_recon_loss: 1115416.0426; val_gene_expr_recon_loss: 33101720.9275; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34235836.9275; val_optim_loss: 34235836.9275
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9671; val_auprc_score: 0.9884; val_best_acc_score: 0.9470; val_best_f1_score: 0.9671; train_kl_reg_loss: 18681.1126; train_edge_recon_loss: 1105629.5239; train_gene_expr_recon_loss: 30682669.4780; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31806980.1272; train_optim_loss: 31806980.1272; val_kl_reg_loss: 18564.7950; val_edge_recon_loss: 1107579.4819; val_gene_expr_recon_loss: 30650406.8696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31776551.1884; val_optim_loss: 31776551.1884
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9661; val_auprc_score: 0.9882; val_best_acc_score: 0.9480; val_best_f1_score: 0.9677; train_kl_reg_loss: 18673.2896; train_edge_recon_loss: 1109775.8055; train_gene_expr_recon_loss: 30676077.9086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31804527.0179; train_optim_loss: 31804527.0179; val_kl_reg_loss: 18570.8448; val_edge_recon_loss: 1099501.6703; val_gene_expr_recon_loss: 30656952.7536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31775025.1884; val_optim_loss: 31775025.1884
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9638; val_auprc_score: 0.9881; val_best_acc_score: 0.9482; val_best_f1_score: 0.9682; train_kl_reg_loss: 18671.9569; train_edge_recon_loss: 1103404.8069; train_gene_expr_recon_loss: 30677987.4290; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31800064.2219; train_optim_loss: 31800064.2219; val_kl_reg_loss: 18564.7195; val_edge_recon_loss: 1069037.5362; val_gene_expr_recon_loss: 30638562.3768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31726164.5797; val_optim_loss: 31726164.5797
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9673; val_auprc_score: 0.9886; val_best_acc_score: 0.9484; val_best_f1_score: 0.9681; train_kl_reg_loss: 18672.8813; train_edge_recon_loss: 1102959.7207; train_gene_expr_recon_loss: 30678045.0701; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31799677.7227; train_optim_loss: 31799677.7227; val_kl_reg_loss: 18565.4363; val_edge_recon_loss: 1093870.0299; val_gene_expr_recon_loss: 30629872.4348; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31742307.9420; val_optim_loss: 31742307.9420
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9678; val_auprc_score: 0.9882; val_best_acc_score: 0.9490; val_best_f1_score: 0.9683; train_kl_reg_loss: 18682.8059; train_edge_recon_loss: 1105346.7190; train_gene_expr_recon_loss: 30678581.2463; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31802610.7602; train_optim_loss: 31802610.7602; val_kl_reg_loss: 18588.9208; val_edge_recon_loss: 1122314.5426; val_gene_expr_recon_loss: 30651279.0725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31792182.5797; val_optim_loss: 31792182.5797
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9662; val_auprc_score: 0.9885; val_best_acc_score: 0.9472; val_best_f1_score: 0.9674; train_kl_reg_loss: 18676.1825; train_edge_recon_loss: 1111788.4971; train_gene_expr_recon_loss: 30682539.0408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31813003.7292; train_optim_loss: 31813003.7292; val_kl_reg_loss: 18556.3886; val_edge_recon_loss: 1087466.3813; val_gene_expr_recon_loss: 30642771.0145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31748793.7681; val_optim_loss: 31748793.7681
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9665; val_auprc_score: 0.9877; val_best_acc_score: 0.9482; val_best_f1_score: 0.9680; train_kl_reg_loss: 18685.9210; train_edge_recon_loss: 1100982.0434; train_gene_expr_recon_loss: 30681712.0718; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31801380.0718; train_optim_loss: 31801380.0718; val_kl_reg_loss: 18569.0511; val_edge_recon_loss: 1085875.7772; val_gene_expr_recon_loss: 30645537.2464; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31749982.1159; val_optim_loss: 31749982.1159

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9682; val_auprc_score: 0.9894; val_best_acc_score: 0.9490; val_best_f1_score: 0.9685; train_kl_reg_loss: 18671.3342; train_edge_recon_loss: 1102309.7522; train_gene_expr_recon_loss: 30677337.1126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31798318.2382; train_optim_loss: 31798318.2382; val_kl_reg_loss: 18581.8061; val_edge_recon_loss: 1098216.8995; val_gene_expr_recon_loss: 30662898.1449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31779696.9855; val_optim_loss: 31779696.9855
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9651; val_auprc_score: 0.9875; val_best_acc_score: 0.9473; val_best_f1_score: 0.9675; train_kl_reg_loss: 18683.4336; train_edge_recon_loss: 1103164.2431; train_gene_expr_recon_loss: 30681714.4731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31803562.1794; train_optim_loss: 31803562.1794; val_kl_reg_loss: 18556.5800; val_edge_recon_loss: 1092974.7174; val_gene_expr_recon_loss: 30646309.4493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31757840.7246; val_optim_loss: 31757840.7246
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9662; val_auprc_score: 0.9886; val_best_acc_score: 0.9477; val_best_f1_score: 0.9676; train_kl_reg_loss: 18671.0859; train_edge_recon_loss: 1100238.6576; train_gene_expr_recon_loss: 30674435.0114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31793344.7374; train_optim_loss: 31793344.7374; val_kl_reg_loss: 18568.3039; val_edge_recon_loss: 1098935.9583; val_gene_expr_recon_loss: 30645261.6232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31762765.8841; val_optim_loss: 31762765.8841
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9657; val_auprc_score: 0.9884; val_best_acc_score: 0.9471; val_best_f1_score: 0.9674; train_kl_reg_loss: 18672.6317; train_edge_recon_loss: 1103019.8343; train_gene_expr_recon_loss: 30686438.8287; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31808131.3051; train_optim_loss: 31808131.3051; val_kl_reg_loss: 18555.6141; val_edge_recon_loss: 1091339.7953; val_gene_expr_recon_loss: 30651696.3768; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31761591.7971; val_optim_loss: 31761591.7971

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 93 min 22 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9654
val AUPRC score: 0.9880
val best accuracy score: 0.9467
val best F1 score: 0.9669
val target rna MSE score: 1.5522
val source rna MSE score: 1.5607
Val cat covariate0 mean sim diff: -0.0054

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
