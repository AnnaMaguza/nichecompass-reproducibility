Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--query_batches', 'batch3', 'batch4', '--n_neighbors', '8', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '31072024_212252_2', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000.', '--lambda_gene_expr_recon', '300.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1956, n_latent: 1856, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1856, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1856, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1956, n_latent: 1856, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1856, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1856, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 12767
Number of validation nodes: 1418
Number of training edges: 57317
Number of validation edges: 6368
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9686; val_auprc_score: 0.9800; val_best_acc_score: 0.9324; val_best_f1_score: 0.9505; train_kl_reg_loss: 12798.3637; train_edge_recon_loss: 182752.2648; train_gene_expr_recon_loss: 47754699.1786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 47950249.6429; train_optim_loss: 47950249.6429; val_kl_reg_loss: 12710.9469; val_edge_recon_loss: 180668.6856; val_gene_expr_recon_loss: 43865397.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 44058777.2800; val_optim_loss: 44058777.2800
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9666; val_auprc_score: 0.9786; val_best_acc_score: 0.9301; val_best_f1_score: 0.9484; train_kl_reg_loss: 12776.6441; train_edge_recon_loss: 183686.2899; train_gene_expr_recon_loss: 40416831.2321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 40613294.1250; train_optim_loss: 40613294.1250; val_kl_reg_loss: 12780.8399; val_edge_recon_loss: 181436.2762; val_gene_expr_recon_loss: 37155784.9600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37350002.2400; val_optim_loss: 37350002.2400
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9668; val_auprc_score: 0.9788; val_best_acc_score: 0.9303; val_best_f1_score: 0.9489; train_kl_reg_loss: 12782.6904; train_edge_recon_loss: 182487.3218; train_gene_expr_recon_loss: 34019913.4643; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34215183.4821; train_optim_loss: 34215183.4821; val_kl_reg_loss: 12734.9229; val_edge_recon_loss: 183054.6700; val_gene_expr_recon_loss: 30972427.6800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31168217.2000; val_optim_loss: 31168217.2000
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9698; val_auprc_score: 0.9810; val_best_acc_score: 0.9323; val_best_f1_score: 0.9505; train_kl_reg_loss: 12783.5605; train_edge_recon_loss: 183062.8629; train_gene_expr_recon_loss: 28454092.8929; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 28649939.2946; train_optim_loss: 28649939.2946; val_kl_reg_loss: 12762.0131; val_edge_recon_loss: 180937.8606; val_gene_expr_recon_loss: 26196650.8800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 26390350.8800; val_optim_loss: 26390350.8800
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9700; val_auprc_score: 0.9815; val_best_acc_score: 0.9332; val_best_f1_score: 0.9511; train_kl_reg_loss: 12782.4883; train_edge_recon_loss: 183053.0216; train_gene_expr_recon_loss: 23735141.4107; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 23930976.9464; train_optim_loss: 23930976.9464; val_kl_reg_loss: 12767.1332; val_edge_recon_loss: 179373.1663; val_gene_expr_recon_loss: 21838837.7600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 22030978.0000; val_optim_loss: 22030978.0000
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9694; val_auprc_score: 0.9804; val_best_acc_score: 0.9325; val_best_f1_score: 0.9506; train_kl_reg_loss: 12795.8273; train_edge_recon_loss: 181253.8998; train_gene_expr_recon_loss: 19850993.0893; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 20045042.7857; train_optim_loss: 20045042.7857; val_kl_reg_loss: 12797.1354; val_edge_recon_loss: 179808.2456; val_gene_expr_recon_loss: 18343158.5200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 18535763.9600; val_optim_loss: 18535763.9600
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9692; val_auprc_score: 0.9779; val_best_acc_score: 0.9324; val_best_f1_score: 0.9502; train_kl_reg_loss: 12797.4186; train_edge_recon_loss: 183516.3941; train_gene_expr_recon_loss: 16667479.1027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 16863792.9464; train_optim_loss: 16863792.9464; val_kl_reg_loss: 12779.4059; val_edge_recon_loss: 182855.4256; val_gene_expr_recon_loss: 15384176.2800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 15579811.2000; val_optim_loss: 15579811.2000
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9692; val_auprc_score: 0.9799; val_best_acc_score: 0.9307; val_best_f1_score: 0.9494; train_kl_reg_loss: 12781.3373; train_edge_recon_loss: 183237.5323; train_gene_expr_recon_loss: 14066254.9152; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 14262273.7589; train_optim_loss: 14262273.7589; val_kl_reg_loss: 12776.0126; val_edge_recon_loss: 180554.3525; val_gene_expr_recon_loss: 13016450.6400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 13209781.0400; val_optim_loss: 13209781.0400
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9684; val_auprc_score: 0.9795; val_best_acc_score: 0.9305; val_best_f1_score: 0.9487; train_kl_reg_loss: 12780.9567; train_edge_recon_loss: 182952.0272; train_gene_expr_recon_loss: 11989402.0580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 12185135.0223; train_optim_loss: 12185135.0223; val_kl_reg_loss: 12783.2015; val_edge_recon_loss: 181470.6556; val_gene_expr_recon_loss: 11145773.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 11340027.3600; val_optim_loss: 11340027.3600
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9676; val_auprc_score: 0.9788; val_best_acc_score: 0.9307; val_best_f1_score: 0.9494; train_kl_reg_loss: 12785.2806; train_edge_recon_loss: 182481.1470; train_gene_expr_recon_loss: 10333005.2545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 10528271.7143; train_optim_loss: 10528271.7143; val_kl_reg_loss: 12789.9112; val_edge_recon_loss: 180173.8656; val_gene_expr_recon_loss: 9616527.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 9809490.8000; val_optim_loss: 9809490.8000
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9686; val_auprc_score: 0.9779; val_best_acc_score: 0.9327; val_best_f1_score: 0.9510; train_kl_reg_loss: 12775.9477; train_edge_recon_loss: 182795.1149; train_gene_expr_recon_loss: 8980735.3438; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 9176306.3817; train_optim_loss: 9176306.3817; val_kl_reg_loss: 12787.1695; val_edge_recon_loss: 178432.3469; val_gene_expr_recon_loss: 8435862.6000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 8627082.0800; val_optim_loss: 8627082.0800
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9702; val_auprc_score: 0.9801; val_best_acc_score: 0.9330; val_best_f1_score: 0.9506; train_kl_reg_loss: 12788.0543; train_edge_recon_loss: 182084.5110; train_gene_expr_recon_loss: 7904250.5246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 8099123.1138; train_optim_loss: 8099123.1138; val_kl_reg_loss: 12784.1663; val_edge_recon_loss: 181894.9194; val_gene_expr_recon_loss: 7436833.0600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 7631512.1200; val_optim_loss: 7631512.1200
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9683; val_auprc_score: 0.9778; val_best_acc_score: 0.9291; val_best_f1_score: 0.9480; train_kl_reg_loss: 12780.8154; train_edge_recon_loss: 182758.2348; train_gene_expr_recon_loss: 7015826.0536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 7211365.0871; train_optim_loss: 7211365.0871; val_kl_reg_loss: 12766.1936; val_edge_recon_loss: 182068.7431; val_gene_expr_recon_loss: 6630395.3400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6825230.3000; val_optim_loss: 6825230.3000
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9677; val_auprc_score: 0.9772; val_best_acc_score: 0.9316; val_best_f1_score: 0.9496; train_kl_reg_loss: 12800.4181; train_edge_recon_loss: 183129.6674; train_gene_expr_recon_loss: 6305160.8259; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 6501090.9219; train_optim_loss: 6501090.9219; val_kl_reg_loss: 12791.0321; val_edge_recon_loss: 182851.0731; val_gene_expr_recon_loss: 5979369.4800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 6175011.5800; val_optim_loss: 6175011.5800
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9677; val_auprc_score: 0.9781; val_best_acc_score: 0.9290; val_best_f1_score: 0.9474; train_kl_reg_loss: 12780.9506; train_edge_recon_loss: 182961.8935; train_gene_expr_recon_loss: 5702724.3304; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5898467.1853; train_optim_loss: 5898467.1853; val_kl_reg_loss: 12742.4941; val_edge_recon_loss: 183875.6913; val_gene_expr_recon_loss: 5430942.9600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5627561.1400; val_optim_loss: 5627561.1400
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9727; val_auprc_score: 0.9817; val_best_acc_score: 0.9342; val_best_f1_score: 0.9518; train_kl_reg_loss: 12788.9698; train_edge_recon_loss: 183120.5469; train_gene_expr_recon_loss: 5212675.8683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 5408585.3817; train_optim_loss: 5408585.3817; val_kl_reg_loss: 12755.7957; val_edge_recon_loss: 179570.0894; val_gene_expr_recon_loss: 4977994.7800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 5170320.6800; val_optim_loss: 5170320.6800
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9678; val_auprc_score: 0.9793; val_best_acc_score: 0.9313; val_best_f1_score: 0.9499; train_kl_reg_loss: 12787.4018; train_edge_recon_loss: 182426.8637; train_gene_expr_recon_loss: 4799079.2344; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4994293.4933; train_optim_loss: 4994293.4933; val_kl_reg_loss: 12780.0246; val_edge_recon_loss: 181214.6231; val_gene_expr_recon_loss: 4606081.8800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4800076.5000; val_optim_loss: 4800076.5000
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9657; val_auprc_score: 0.9753; val_best_acc_score: 0.9271; val_best_f1_score: 0.9465; train_kl_reg_loss: 12789.6452; train_edge_recon_loss: 183540.0502; train_gene_expr_recon_loss: 4449647.9621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4645977.6518; train_optim_loss: 4645977.6518; val_kl_reg_loss: 12759.3936; val_edge_recon_loss: 183249.6762; val_gene_expr_recon_loss: 4283607.2900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4479616.3400; val_optim_loss: 4479616.3400
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9653; val_auprc_score: 0.9766; val_best_acc_score: 0.9311; val_best_f1_score: 0.9498; train_kl_reg_loss: 12773.3215; train_edge_recon_loss: 181314.9420; train_gene_expr_recon_loss: 4158308.7388; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4352397.0033; train_optim_loss: 4352397.0033; val_kl_reg_loss: 12782.6337; val_edge_recon_loss: 180797.1175; val_gene_expr_recon_loss: 4025098.2100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 4218677.9500; val_optim_loss: 4218677.9500
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9680; val_auprc_score: 0.9807; val_best_acc_score: 0.9287; val_best_f1_score: 0.9482; train_kl_reg_loss: 12775.0015; train_edge_recon_loss: 182057.1320; train_gene_expr_recon_loss: 3914576.0078; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 4109408.1473; train_optim_loss: 4109408.1473; val_kl_reg_loss: 12779.9968; val_edge_recon_loss: 178807.1350; val_gene_expr_recon_loss: 3796339.4400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3987926.5800; val_optim_loss: 3987926.5800
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9674; val_auprc_score: 0.9785; val_best_acc_score: 0.9308; val_best_f1_score: 0.9497; train_kl_reg_loss: 12789.3182; train_edge_recon_loss: 182245.7252; train_gene_expr_recon_loss: 3712624.4654; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3907659.5145; train_optim_loss: 3907659.5145; val_kl_reg_loss: 12759.2637; val_edge_recon_loss: 179229.2375; val_gene_expr_recon_loss: 3612082.3800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3804070.8700; val_optim_loss: 3804070.8700
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9686; val_auprc_score: 0.9779; val_best_acc_score: 0.9309; val_best_f1_score: 0.9490; train_kl_reg_loss: 12784.1404; train_edge_recon_loss: 182371.7282; train_gene_expr_recon_loss: 3543484.8672; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3738640.7444; train_optim_loss: 3738640.7444; val_kl_reg_loss: 12760.5917; val_edge_recon_loss: 183582.1237; val_gene_expr_recon_loss: 3460850.6500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3657193.3600; val_optim_loss: 3657193.3600
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9684; val_auprc_score: 0.9776; val_best_acc_score: 0.9302; val_best_f1_score: 0.9483; train_kl_reg_loss: 12779.8484; train_edge_recon_loss: 183604.9817; train_gene_expr_recon_loss: 3405422.2600; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3601807.0770; train_optim_loss: 3601807.0770; val_kl_reg_loss: 12701.5943; val_edge_recon_loss: 182690.9181; val_gene_expr_recon_loss: 3335585.6900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3530978.2000; val_optim_loss: 3530978.2000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9679; val_auprc_score: 0.9769; val_best_acc_score: 0.9310; val_best_f1_score: 0.9489; train_kl_reg_loss: 12776.9978; train_edge_recon_loss: 182720.2243; train_gene_expr_recon_loss: 3294666.0580; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3490163.2723; train_optim_loss: 3490163.2723; val_kl_reg_loss: 12775.8439; val_edge_recon_loss: 185233.3450; val_gene_expr_recon_loss: 3238944.4300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3436953.6300; val_optim_loss: 3436953.6300
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9667; val_auprc_score: 0.9783; val_best_acc_score: 0.9325; val_best_f1_score: 0.9509; train_kl_reg_loss: 12788.7437; train_edge_recon_loss: 182525.9659; train_gene_expr_recon_loss: 3207884.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3403198.8058; train_optim_loss: 3403198.8058; val_kl_reg_loss: 12769.4530; val_edge_recon_loss: 179304.6837; val_gene_expr_recon_loss: 3162754.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3354828.4200; val_optim_loss: 3354828.4200
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9689; val_auprc_score: 0.9787; val_best_acc_score: 0.9307; val_best_f1_score: 0.9494; train_kl_reg_loss: 12785.4235; train_edge_recon_loss: 180122.5324; train_gene_expr_recon_loss: 3131868.2020; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3324776.1607; train_optim_loss: 3324776.1607; val_kl_reg_loss: 12738.8981; val_edge_recon_loss: 179868.0550; val_gene_expr_recon_loss: 3099374.5200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3291981.4900; val_optim_loss: 3291981.4900
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9653; val_auprc_score: 0.9765; val_best_acc_score: 0.9287; val_best_f1_score: 0.9478; train_kl_reg_loss: 12775.6517; train_edge_recon_loss: 179954.2148; train_gene_expr_recon_loss: 3081094.0145; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3273823.8783; train_optim_loss: 3273823.8783; val_kl_reg_loss: 12768.3001; val_edge_recon_loss: 182434.9056; val_gene_expr_recon_loss: 3056742.0800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3251945.2800; val_optim_loss: 3251945.2800
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9674; val_auprc_score: 0.9789; val_best_acc_score: 0.9301; val_best_f1_score: 0.9490; train_kl_reg_loss: 12784.6394; train_edge_recon_loss: 180681.5170; train_gene_expr_recon_loss: 3044756.0960; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3238222.2511; train_optim_loss: 3238222.2511; val_kl_reg_loss: 12728.1187; val_edge_recon_loss: 179871.8194; val_gene_expr_recon_loss: 3024190.7400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3216790.6700; val_optim_loss: 3216790.6700
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9711; val_auprc_score: 0.9811; val_best_acc_score: 0.9348; val_best_f1_score: 0.9516; train_kl_reg_loss: 12792.5771; train_edge_recon_loss: 179844.8774; train_gene_expr_recon_loss: 3019178.9241; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3211816.3728; train_optim_loss: 3211816.3728; val_kl_reg_loss: 12758.7203; val_edge_recon_loss: 181221.2969; val_gene_expr_recon_loss: 3006218.6300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3200198.6500; val_optim_loss: 3200198.6500
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9650; val_auprc_score: 0.9776; val_best_acc_score: 0.9281; val_best_f1_score: 0.9473; train_kl_reg_loss: 12798.6212; train_edge_recon_loss: 179684.5894; train_gene_expr_recon_loss: 3000853.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3193336.2333; train_optim_loss: 3193336.2333; val_kl_reg_loss: 12689.9303; val_edge_recon_loss: 180314.3519; val_gene_expr_recon_loss: 2987943.2600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3180947.5200; val_optim_loss: 3180947.5200
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9693; val_auprc_score: 0.9789; val_best_acc_score: 0.9339; val_best_f1_score: 0.9516; train_kl_reg_loss: 12782.0698; train_edge_recon_loss: 179143.6521; train_gene_expr_recon_loss: 2989891.4732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3181817.1931; train_optim_loss: 3181817.1931; val_kl_reg_loss: 12729.2910; val_edge_recon_loss: 179201.6531; val_gene_expr_recon_loss: 2981088.5900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3173019.5300; val_optim_loss: 3173019.5300
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9723; val_auprc_score: 0.9806; val_best_acc_score: 0.9353; val_best_f1_score: 0.9526; train_kl_reg_loss: 12783.4788; train_edge_recon_loss: 180010.9918; train_gene_expr_recon_loss: 2982465.8415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3175260.3170; train_optim_loss: 3175260.3170; val_kl_reg_loss: 12792.6301; val_edge_recon_loss: 181571.9937; val_gene_expr_recon_loss: 2978172.9900; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3172537.6200; val_optim_loss: 3172537.6200
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9668; val_auprc_score: 0.9785; val_best_acc_score: 0.9301; val_best_f1_score: 0.9488; train_kl_reg_loss: 12783.7400; train_edge_recon_loss: 180173.2965; train_gene_expr_recon_loss: 2978416.4598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3171373.4933; train_optim_loss: 3171373.4933; val_kl_reg_loss: 12742.7571; val_edge_recon_loss: 180797.7881; val_gene_expr_recon_loss: 2973101.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3166642.0400; val_optim_loss: 3166642.0400
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9714; val_auprc_score: 0.9812; val_best_acc_score: 0.9326; val_best_f1_score: 0.9506; train_kl_reg_loss: 12775.9629; train_edge_recon_loss: 179665.7077; train_gene_expr_recon_loss: 2975917.3415; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3168359.0045; train_optim_loss: 3168359.0045; val_kl_reg_loss: 12724.6049; val_edge_recon_loss: 181574.4656; val_gene_expr_recon_loss: 2970098.4000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3164397.4700; val_optim_loss: 3164397.4700
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9699; val_auprc_score: 0.9811; val_best_acc_score: 0.9315; val_best_f1_score: 0.9497; train_kl_reg_loss: 12784.0386; train_edge_recon_loss: 179194.6420; train_gene_expr_recon_loss: 2974997.0938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166975.7801; train_optim_loss: 3166975.7801; val_kl_reg_loss: 12701.7944; val_edge_recon_loss: 180398.8831; val_gene_expr_recon_loss: 2968362.0100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3161462.6700; val_optim_loss: 3161462.6700
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9668; val_auprc_score: 0.9782; val_best_acc_score: 0.9296; val_best_f1_score: 0.9486; train_kl_reg_loss: 12775.1237; train_edge_recon_loss: 180984.3346; train_gene_expr_recon_loss: 2974284.5971; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3168044.0491; train_optim_loss: 3168044.0491; val_kl_reg_loss: 12752.9499; val_edge_recon_loss: 181037.1850; val_gene_expr_recon_loss: 2968434.7700; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3162224.9100; val_optim_loss: 3162224.9100
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9679; val_auprc_score: 0.9784; val_best_acc_score: 0.9311; val_best_f1_score: 0.9498; train_kl_reg_loss: 12776.9674; train_edge_recon_loss: 180438.9510; train_gene_expr_recon_loss: 2974532.9330; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3167748.8527; train_optim_loss: 3167748.8527; val_kl_reg_loss: 12708.0268; val_edge_recon_loss: 181251.0644; val_gene_expr_recon_loss: 2969361.3000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3163320.3900; val_optim_loss: 3163320.3900
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9708; val_auprc_score: 0.9824; val_best_acc_score: 0.9311; val_best_f1_score: 0.9497; train_kl_reg_loss: 12784.5521; train_edge_recon_loss: 179689.5977; train_gene_expr_recon_loss: 2974229.8873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166704.0324; train_optim_loss: 3166704.0324; val_kl_reg_loss: 12715.8565; val_edge_recon_loss: 180134.7456; val_gene_expr_recon_loss: 2970259.0600; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3163109.6900; val_optim_loss: 3163109.6900
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9687; val_auprc_score: 0.9786; val_best_acc_score: 0.9288; val_best_f1_score: 0.9476; train_kl_reg_loss: 12794.5508; train_edge_recon_loss: 180394.8862; train_gene_expr_recon_loss: 2974408.1696; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3167597.6038; train_optim_loss: 3167597.6038; val_kl_reg_loss: 12703.2029; val_edge_recon_loss: 182551.2238; val_gene_expr_recon_loss: 2968062.1300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3163316.5800; val_optim_loss: 3163316.5800

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9695; val_auprc_score: 0.9807; val_best_acc_score: 0.9317; val_best_f1_score: 0.9502; train_kl_reg_loss: 12776.5607; train_edge_recon_loss: 179841.8156; train_gene_expr_recon_loss: 2974075.8036; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3166694.1786; train_optim_loss: 3166694.1786; val_kl_reg_loss: 12778.9165; val_edge_recon_loss: 179207.3531; val_gene_expr_recon_loss: 2971234.1300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3163220.4000; val_optim_loss: 3163220.4000
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9727; val_auprc_score: 0.9831; val_best_acc_score: 0.9348; val_best_f1_score: 0.9520; train_kl_reg_loss: 12788.0460; train_edge_recon_loss: 180167.5225; train_gene_expr_recon_loss: 2974439.3571; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3167394.9275; train_optim_loss: 3167394.9275; val_kl_reg_loss: 12746.0332; val_edge_recon_loss: 179095.6931; val_gene_expr_recon_loss: 2969780.1400; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3161621.8600; val_optim_loss: 3161621.8600
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9695; val_auprc_score: 0.9798; val_best_acc_score: 0.9304; val_best_f1_score: 0.9487; train_kl_reg_loss: 12790.8260; train_edge_recon_loss: 179881.8420; train_gene_expr_recon_loss: 2974621.2366; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3167293.9018; train_optim_loss: 3167293.9018; val_kl_reg_loss: 12734.5652; val_edge_recon_loss: 183019.0075; val_gene_expr_recon_loss: 2969623.3200; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3165376.8700; val_optim_loss: 3165376.8700
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9687; val_auprc_score: 0.9806; val_best_acc_score: 0.9299; val_best_f1_score: 0.9490; train_kl_reg_loss: 12784.2609; train_edge_recon_loss: 180481.8763; train_gene_expr_recon_loss: 2974327.6083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 3167593.7556; train_optim_loss: 3167593.7556; val_kl_reg_loss: 12709.0497; val_edge_recon_loss: 180337.8044; val_gene_expr_recon_loss: 2970305.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 3163351.8800; val_optim_loss: 3163351.8800

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 40 min 36 sec.
Using best model state, which was in epoch 35.

--- MODEL EVALUATION ---
val AUROC score: 0.9666
val AUPRC score: 0.9776
val best accuracy score: 0.9292
val best F1 score: 0.9483
val target rna MSE score: 0.9638
val source rna MSE score: 0.4633
Val cat covariate0 mean sim diff: -0.0022

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
