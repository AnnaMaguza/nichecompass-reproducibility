Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9359; val_auprc_score: 0.9590; val_best_acc_score: 0.8926; val_best_f1_score: 0.9227; train_kl_reg_loss: 18981.5152; train_edge_recon_loss: 1967958.7167; train_gene_expr_recon_loss: 24806655.7818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26793595.9879; train_optim_loss: 26793595.9879; val_kl_reg_loss: 18878.6668; val_edge_recon_loss: 1967343.6382; val_gene_expr_recon_loss: 23103324.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 25089547.3684; val_optim_loss: 25089547.3684
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9334; val_auprc_score: 0.9557; val_best_acc_score: 0.8911; val_best_f1_score: 0.9206; train_kl_reg_loss: 18976.2407; train_edge_recon_loss: 1979328.7273; train_gene_expr_recon_loss: 23680007.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25678312.0242; train_optim_loss: 25678312.0242; val_kl_reg_loss: 18859.3324; val_edge_recon_loss: 2016373.5329; val_gene_expr_recon_loss: 21984073.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24019306.3158; val_optim_loss: 24019306.3158
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9300; val_auprc_score: 0.9548; val_best_acc_score: 0.8853; val_best_f1_score: 0.9175; train_kl_reg_loss: 18982.9970; train_edge_recon_loss: 1978935.6356; train_gene_expr_recon_loss: 22616339.3212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 24614257.8788; train_optim_loss: 24614257.8788; val_kl_reg_loss: 18916.8772; val_edge_recon_loss: 1966335.2829; val_gene_expr_recon_loss: 21148461.5789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23133713.6842; val_optim_loss: 23133713.6842
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9356; val_auprc_score: 0.9598; val_best_acc_score: 0.8905; val_best_f1_score: 0.9216; train_kl_reg_loss: 19008.4013; train_edge_recon_loss: 1971639.9879; train_gene_expr_recon_loss: 21792805.6848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23783454.0606; train_optim_loss: 23783454.0606; val_kl_reg_loss: 18856.8316; val_edge_recon_loss: 1933640.5395; val_gene_expr_recon_loss: 20334506.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22287004.2105; val_optim_loss: 22287004.2105
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9369; val_auprc_score: 0.9584; val_best_acc_score: 0.8941; val_best_f1_score: 0.9226; train_kl_reg_loss: 18978.9543; train_edge_recon_loss: 1966881.0197; train_gene_expr_recon_loss: 16892078.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18877938.8727; train_optim_loss: 18877938.8727; val_kl_reg_loss: 18471.2422; val_edge_recon_loss: 1964517.7171; val_gene_expr_recon_loss: 16338384.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18321373.1579; val_optim_loss: 18321373.1579
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9357; val_auprc_score: 0.9553; val_best_acc_score: 0.8911; val_best_f1_score: 0.9204; train_kl_reg_loss: 18984.8491; train_edge_recon_loss: 1948657.4826; train_gene_expr_recon_loss: 16143299.2364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18110941.5758; train_optim_loss: 18110941.5758; val_kl_reg_loss: 18565.8230; val_edge_recon_loss: 1989858.6579; val_gene_expr_recon_loss: 15746576.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17755001.4737; val_optim_loss: 17755001.4737
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9372; val_auprc_score: 0.9589; val_best_acc_score: 0.8898; val_best_f1_score: 0.9202; train_kl_reg_loss: 19012.7422; train_edge_recon_loss: 1983378.1614; train_gene_expr_recon_loss: 15537430.1273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17539821.0061; train_optim_loss: 17539821.0061; val_kl_reg_loss: 18397.8310; val_edge_recon_loss: 1968819.4408; val_gene_expr_recon_loss: 15046163.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17033380.3158; val_optim_loss: 17033380.3158
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9358; val_auprc_score: 0.9567; val_best_acc_score: 0.8892; val_best_f1_score: 0.9194; train_kl_reg_loss: 18985.1330; train_edge_recon_loss: 1967406.5523; train_gene_expr_recon_loss: 14952758.5758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16939150.2545; train_optim_loss: 16939150.2545; val_kl_reg_loss: 18361.3316; val_edge_recon_loss: 2001636.7368; val_gene_expr_recon_loss: 14473132.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16493131.0000; val_optim_loss: 16493131.0000
Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--reference_dataset', 'seqfish_mouse_organogenesis_imputed_subsample_50pct', '--query_dataset', 'seqfish_mouse_organogenesis_imputed', '--query_batches', 'batch5', 'batch6', '--n_neighbors', '8', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '08082024_095147_12', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1851, n_latent: 1851, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1851, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1851, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1851, n_latent: 1851, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1851, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1851, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 18519
Number of validation nodes: 2058
Number of training edges: 84228
Number of validation edges: 9358
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.9466; val_auprc_score: 0.9665; val_best_acc_score: 0.8934; val_best_f1_score: 0.9215; train_kl_reg_loss: 19779.0603; train_edge_recon_loss: 1921191.2451; train_gene_expr_recon_loss: 132972570.3515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 134913540.6303; train_optim_loss: 134913540.6303; val_kl_reg_loss: 19994.4721; val_edge_recon_loss: 1940154.7905; val_gene_expr_recon_loss: 121653980.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 123614129.5135; val_optim_loss: 123614129.5135
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9325; val_auprc_score: 0.9543; val_best_acc_score: 0.8865; val_best_f1_score: 0.9178; train_kl_reg_loss: 18977.6204; train_edge_recon_loss: 1958453.5970; train_gene_expr_recon_loss: 14433779.6606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16411210.8667; train_optim_loss: 16411210.8667; val_kl_reg_loss: 18401.0926; val_edge_recon_loss: 2015801.7039; val_gene_expr_recon_loss: 14056794.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16090997.5263; val_optim_loss: 16090997.5263
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9432; val_auprc_score: 0.9653; val_best_acc_score: 0.8951; val_best_f1_score: 0.9229; train_kl_reg_loss: 19800.2329; train_edge_recon_loss: 1921850.5917; train_gene_expr_recon_loss: 110038491.5394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 111980142.3273; train_optim_loss: 111980142.3273; val_kl_reg_loss: 19946.3568; val_edge_recon_loss: 1918394.4730; val_gene_expr_recon_loss: 99906988.5405; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 101845329.2973; val_optim_loss: 101845329.2973
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9408; val_auprc_score: 0.9632; val_best_acc_score: 0.8922; val_best_f1_score: 0.9214; train_kl_reg_loss: 18981.8632; train_edge_recon_loss: 1951787.2955; train_gene_expr_recon_loss: 13991991.7333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15962760.9030; train_optim_loss: 15962760.9030; val_kl_reg_loss: 18390.5986; val_edge_recon_loss: 1960856.2895; val_gene_expr_recon_loss: 13716190.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15695437.2632; val_optim_loss: 15695437.2632
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9397; val_auprc_score: 0.9606; val_best_acc_score: 0.8934; val_best_f1_score: 0.9228; train_kl_reg_loss: 18992.7388; train_edge_recon_loss: 1953842.3977; train_gene_expr_recon_loss: 13595719.8909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15568555.0242; train_optim_loss: 15568555.0242; val_kl_reg_loss: 18358.1731; val_edge_recon_loss: 1981597.2237; val_gene_expr_recon_loss: 13260734.7895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15260690.1579; val_optim_loss: 15260690.1579
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9472; val_auprc_score: 0.9673; val_best_acc_score: 0.8970; val_best_f1_score: 0.9237; train_kl_reg_loss: 19803.6985; train_edge_recon_loss: 1930552.9996; train_gene_expr_recon_loss: 91174235.0788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 93124591.6364; train_optim_loss: 93124591.6364; val_kl_reg_loss: 19997.0797; val_edge_recon_loss: 1929516.5608; val_gene_expr_recon_loss: 82131054.4865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 84080567.5676; val_optim_loss: 84080567.5676
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9371; val_auprc_score: 0.9558; val_best_acc_score: 0.8901; val_best_f1_score: 0.9185; train_kl_reg_loss: 18987.1848; train_edge_recon_loss: 1961242.9015; train_gene_expr_recon_loss: 13250425.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 15230656.0848; train_optim_loss: 15230656.0848; val_kl_reg_loss: 18589.8888; val_edge_recon_loss: 2057479.7500; val_gene_expr_recon_loss: 13044622.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 15120691.7895; val_optim_loss: 15120691.7895
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9449; val_auprc_score: 0.9651; val_best_acc_score: 0.8939; val_best_f1_score: 0.9219; train_kl_reg_loss: 19802.0077; train_edge_recon_loss: 1931893.4447; train_gene_expr_recon_loss: 75471458.3515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 77423153.7091; train_optim_loss: 77423153.7091; val_kl_reg_loss: 20002.2592; val_edge_recon_loss: 1930423.1453; val_gene_expr_recon_loss: 68164656.3243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 70115081.8378; val_optim_loss: 70115081.8378
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9315; val_auprc_score: 0.9574; val_best_acc_score: 0.8890; val_best_f1_score: 0.9205; train_kl_reg_loss: 18993.4963; train_edge_recon_loss: 1963429.8909; train_gene_expr_recon_loss: 12950709.8121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14933133.1818; train_optim_loss: 14933133.1818; val_kl_reg_loss: 18472.6256; val_edge_recon_loss: 1953050.0592; val_gene_expr_recon_loss: 12689724.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14661246.9474; val_optim_loss: 14661246.9474
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9412; val_auprc_score: 0.9628; val_best_acc_score: 0.8942; val_best_f1_score: 0.9228; train_kl_reg_loss: 18996.2852; train_edge_recon_loss: 1962144.1121; train_gene_expr_recon_loss: 12655783.4182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14636923.8242; train_optim_loss: 14636923.8242; val_kl_reg_loss: 18382.5694; val_edge_recon_loss: 1953113.7500; val_gene_expr_recon_loss: 12434246.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14405742.2105; val_optim_loss: 14405742.2105
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9446; val_auprc_score: 0.9654; val_best_acc_score: 0.8950; val_best_f1_score: 0.9229; train_kl_reg_loss: 19795.5690; train_edge_recon_loss: 1926532.9436; train_gene_expr_recon_loss: 62775472.9091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64721801.2485; train_optim_loss: 64721801.2485; val_kl_reg_loss: 19936.4535; val_edge_recon_loss: 1918769.3919; val_gene_expr_recon_loss: 56559538.4865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 58498244.2162; val_optim_loss: 58498244.2162
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9372; val_auprc_score: 0.9590; val_best_acc_score: 0.8893; val_best_f1_score: 0.9191; train_kl_reg_loss: 18990.5138; train_edge_recon_loss: 1963366.1879; train_gene_expr_recon_loss: 12401328.0061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14383684.6909; train_optim_loss: 14383684.6909; val_kl_reg_loss: 18446.2539; val_edge_recon_loss: 2005983.3487; val_gene_expr_recon_loss: 12219631.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14244061.2632; val_optim_loss: 14244061.2632
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9466; val_auprc_score: 0.9667; val_best_acc_score: 0.8965; val_best_f1_score: 0.9228; train_kl_reg_loss: 19785.1599; train_edge_recon_loss: 1929751.5644; train_gene_expr_recon_loss: 52628760.0242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 54578296.7879; train_optim_loss: 54578296.7879; val_kl_reg_loss: 19977.2761; val_edge_recon_loss: 1925417.2466; val_gene_expr_recon_loss: 47312964.4324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 49258359.1351; val_optim_loss: 49258359.1351
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9362; val_auprc_score: 0.9586; val_best_acc_score: 0.8865; val_best_f1_score: 0.9175; train_kl_reg_loss: 18972.8492; train_edge_recon_loss: 1958705.6212; train_gene_expr_recon_loss: 12195290.3394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14172968.8121; train_optim_loss: 14172968.8121; val_kl_reg_loss: 18346.0725; val_edge_recon_loss: 1981632.1118; val_gene_expr_recon_loss: 11989650.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13989628.3684; val_optim_loss: 13989628.3684
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9277; val_auprc_score: 0.9532; val_best_acc_score: 0.8837; val_best_f1_score: 0.9159; train_kl_reg_loss: 18997.6260; train_edge_recon_loss: 1970095.9008; train_gene_expr_recon_loss: 12021267.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14010361.5091; train_optim_loss: 14010361.5091; val_kl_reg_loss: 18375.6461; val_edge_recon_loss: 1987024.5789; val_gene_expr_recon_loss: 11888594.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13893994.3158; val_optim_loss: 13893994.3158
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9449; val_auprc_score: 0.9663; val_best_acc_score: 0.8925; val_best_f1_score: 0.9209; train_kl_reg_loss: 19796.1761; train_edge_recon_loss: 1926586.2890; train_gene_expr_recon_loss: 44624509.4788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 46570891.9515; train_optim_loss: 46570891.9515; val_kl_reg_loss: 19929.5725; val_edge_recon_loss: 1929586.2669; val_gene_expr_recon_loss: 40231879.4595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 42181395.2432; val_optim_loss: 42181395.2432
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9354; val_auprc_score: 0.9589; val_best_acc_score: 0.8848; val_best_f1_score: 0.9162; train_kl_reg_loss: 18974.8515; train_edge_recon_loss: 1969151.0462; train_gene_expr_recon_loss: 11863990.2667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13852116.1939; train_optim_loss: 13852116.1939; val_kl_reg_loss: 18552.4115; val_edge_recon_loss: 1987873.1053; val_gene_expr_recon_loss: 11769281.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13775706.6316; val_optim_loss: 13775706.6316
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9453; val_auprc_score: 0.9664; val_best_acc_score: 0.8921; val_best_f1_score: 0.9200; train_kl_reg_loss: 19801.5959; train_edge_recon_loss: 1932784.1784; train_gene_expr_recon_loss: 38227852.7394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 40180438.5273; train_optim_loss: 40180438.5273; val_kl_reg_loss: 19923.8367; val_edge_recon_loss: 1952170.3514; val_gene_expr_recon_loss: 34627056.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 36599149.9459; val_optim_loss: 36599149.9459
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9334; val_auprc_score: 0.9558; val_best_acc_score: 0.8913; val_best_f1_score: 0.9216; train_kl_reg_loss: 18990.2110; train_edge_recon_loss: 1953520.1674; train_gene_expr_recon_loss: 11721507.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13694018.3818; train_optim_loss: 13694018.3818; val_kl_reg_loss: 18498.7122; val_edge_recon_loss: 1980429.0461; val_gene_expr_recon_loss: 11637029.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13635956.9474; val_optim_loss: 13635956.9474
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9336; val_auprc_score: 0.9560; val_best_acc_score: 0.8875; val_best_f1_score: 0.9184; train_kl_reg_loss: 18976.7615; train_edge_recon_loss: 1971644.2144; train_gene_expr_recon_loss: 11604964.0303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13595584.9939; train_optim_loss: 13595584.9939; val_kl_reg_loss: 18470.1343; val_edge_recon_loss: 1995391.1776; val_gene_expr_recon_loss: 11495964.8421; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13509826.2105; val_optim_loss: 13509826.2105
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9447; val_auprc_score: 0.9631; val_best_acc_score: 0.8965; val_best_f1_score: 0.9226; train_kl_reg_loss: 19793.9029; train_edge_recon_loss: 1929381.7284; train_gene_expr_recon_loss: 33125447.3030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 35074623.0727; train_optim_loss: 35074623.0727; val_kl_reg_loss: 19967.4203; val_edge_recon_loss: 1934900.2365; val_gene_expr_recon_loss: 30180134.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 32135002.5946; val_optim_loss: 32135002.5946
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9343; val_auprc_score: 0.9582; val_best_acc_score: 0.8858; val_best_f1_score: 0.9175; train_kl_reg_loss: 18999.7913; train_edge_recon_loss: 1969182.6894; train_gene_expr_recon_loss: 11501524.5636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13489707.0485; train_optim_loss: 13489707.0485; val_kl_reg_loss: 18354.7473; val_edge_recon_loss: 1996052.2500; val_gene_expr_recon_loss: 11406768.3684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13421175.3158; val_optim_loss: 13421175.3158
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9412; val_auprc_score: 0.9616; val_best_acc_score: 0.8926; val_best_f1_score: 0.9211; train_kl_reg_loss: 19795.4233; train_edge_recon_loss: 1931330.1002; train_gene_expr_recon_loss: 29190405.2364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 31141530.7455; train_optim_loss: 31141530.7455; val_kl_reg_loss: 19996.0411; val_edge_recon_loss: 1930942.1791; val_gene_expr_recon_loss: 26819474.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 28770412.2162; val_optim_loss: 28770412.2162
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9391; val_auprc_score: 0.9620; val_best_acc_score: 0.8900; val_best_f1_score: 0.9204; train_kl_reg_loss: 18999.3777; train_edge_recon_loss: 1957893.0098; train_gene_expr_recon_loss: 11417115.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13394008.4182; train_optim_loss: 13394008.4182; val_kl_reg_loss: 18460.3602; val_edge_recon_loss: 1988558.5658; val_gene_expr_recon_loss: 11334170.5789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13341189.5789; val_optim_loss: 13341189.5789
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9346; val_auprc_score: 0.9574; val_best_acc_score: 0.8898; val_best_f1_score: 0.9201; train_kl_reg_loss: 18993.4238; train_edge_recon_loss: 1965329.0902; train_gene_expr_recon_loss: 11328532.7212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13312855.2182; train_optim_loss: 13312855.2182; val_kl_reg_loss: 18383.8386; val_edge_recon_loss: 1976539.7368; val_gene_expr_recon_loss: 11251422.5789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13246346.1579; val_optim_loss: 13246346.1579
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9445; val_auprc_score: 0.9661; val_best_acc_score: 0.8933; val_best_f1_score: 0.9218; train_kl_reg_loss: 19788.2816; train_edge_recon_loss: 1932745.7598; train_gene_expr_recon_loss: 26066572.6545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 28019106.7273; train_optim_loss: 28019106.7273; val_kl_reg_loss: 19983.7150; val_edge_recon_loss: 1922727.9899; val_gene_expr_recon_loss: 24144627.8919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26087339.5676; val_optim_loss: 26087339.5676
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9369; val_auprc_score: 0.9599; val_best_acc_score: 0.8876; val_best_f1_score: 0.9180; train_kl_reg_loss: 18963.2434; train_edge_recon_loss: 1971723.0500; train_gene_expr_recon_loss: 11258834.0788; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13249520.3758; train_optim_loss: 13249520.3758; val_kl_reg_loss: 18435.7374; val_edge_recon_loss: 1984000.0329; val_gene_expr_recon_loss: 11210864.6316; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13213300.4737; val_optim_loss: 13213300.4737
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9373; val_auprc_score: 0.9591; val_best_acc_score: 0.8903; val_best_f1_score: 0.9199; train_kl_reg_loss: 18995.6017; train_edge_recon_loss: 1968599.8992; train_gene_expr_recon_loss: 11208201.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13195797.0788; train_optim_loss: 13195797.0788; val_kl_reg_loss: 18404.6167; val_edge_recon_loss: 1979862.8421; val_gene_expr_recon_loss: 11151623.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13149891.0526; val_optim_loss: 13149891.0526
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9446; val_auprc_score: 0.9666; val_best_acc_score: 0.8925; val_best_f1_score: 0.9209; train_kl_reg_loss: 19794.6571; train_edge_recon_loss: 1930122.9905; train_gene_expr_recon_loss: 23719805.4545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 25669723.1273; train_optim_loss: 25669723.1273; val_kl_reg_loss: 19903.8176; val_edge_recon_loss: 1946171.4291; val_gene_expr_recon_loss: 22003795.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 23969870.7568; val_optim_loss: 23969870.7568
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9368; val_auprc_score: 0.9588; val_best_acc_score: 0.8920; val_best_f1_score: 0.9229; train_kl_reg_loss: 18993.5556; train_edge_recon_loss: 1952167.0409; train_gene_expr_recon_loss: 11151663.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13122823.6424; train_optim_loss: 13122823.6424; val_kl_reg_loss: 18325.1343; val_edge_recon_loss: 1929612.3816; val_gene_expr_recon_loss: 11101935.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13049872.4737; val_optim_loss: 13049872.4737
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9473; val_auprc_score: 0.9675; val_best_acc_score: 0.8970; val_best_f1_score: 0.9240; train_kl_reg_loss: 19792.1771; train_edge_recon_loss: 1931628.3920; train_gene_expr_recon_loss: 21832002.9939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23783423.5091; train_optim_loss: 23783423.5091; val_kl_reg_loss: 19951.9707; val_edge_recon_loss: 1904768.5946; val_gene_expr_recon_loss: 20489697.2973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22414417.9459; val_optim_loss: 22414417.9459
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9313; val_auprc_score: 0.9564; val_best_acc_score: 0.8864; val_best_f1_score: 0.9175; train_kl_reg_loss: 18992.5217; train_edge_recon_loss: 1962538.3174; train_gene_expr_recon_loss: 11104207.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13085737.9152; train_optim_loss: 13085737.9152; val_kl_reg_loss: 18337.1486; val_edge_recon_loss: 1988515.9145; val_gene_expr_recon_loss: 11062006.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13068859.2105; val_optim_loss: 13068859.2105
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9390; val_auprc_score: 0.9617; val_best_acc_score: 0.8902; val_best_f1_score: 0.9208; train_kl_reg_loss: 18987.2947; train_edge_recon_loss: 1948972.1644; train_gene_expr_recon_loss: 11066510.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13034470.2424; train_optim_loss: 13034470.2424; val_kl_reg_loss: 18356.9383; val_edge_recon_loss: 1942403.8684; val_gene_expr_recon_loss: 11054950.7895; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13015711.6842; val_optim_loss: 13015711.6842
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9437; val_auprc_score: 0.9649; val_best_acc_score: 0.8940; val_best_f1_score: 0.9214; train_kl_reg_loss: 19799.7859; train_edge_recon_loss: 1936010.6890; train_gene_expr_recon_loss: 20419855.4000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22375665.8727; train_optim_loss: 22375665.8727; val_kl_reg_loss: 19963.8884; val_edge_recon_loss: 1937561.3682; val_gene_expr_recon_loss: 19266546.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21224072.0000; val_optim_loss: 21224072.0000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9376; val_auprc_score: 0.9586; val_best_acc_score: 0.8930; val_best_f1_score: 0.9221; train_kl_reg_loss: 18990.1333; train_edge_recon_loss: 1974608.9227; train_gene_expr_recon_loss: 11032646.9758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13026246.0303; train_optim_loss: 13026246.0303; val_kl_reg_loss: 18430.1031; val_edge_recon_loss: 1976768.2434; val_gene_expr_recon_loss: 11011275.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13006473.4211; val_optim_loss: 13006473.4211
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9460; val_auprc_score: 0.9669; val_best_acc_score: 0.8953; val_best_f1_score: 0.9226; train_kl_reg_loss: 19784.8925; train_edge_recon_loss: 1929978.0655; train_gene_expr_recon_loss: 19283857.8970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 21233620.8182; train_optim_loss: 21233620.8182; val_kl_reg_loss: 19987.4772; val_edge_recon_loss: 1925420.3885; val_gene_expr_recon_loss: 18361418.8649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 20306826.7027; val_optim_loss: 20306826.7027
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9310; val_auprc_score: 0.9546; val_best_acc_score: 0.8864; val_best_f1_score: 0.9187; train_kl_reg_loss: 18991.3343; train_edge_recon_loss: 1963697.4568; train_gene_expr_recon_loss: 11004449.3091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12987138.1273; train_optim_loss: 12987138.1273; val_kl_reg_loss: 18402.8841; val_edge_recon_loss: 1949970.4342; val_gene_expr_recon_loss: 10968080.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12936453.8947; val_optim_loss: 12936453.8947
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9340; val_auprc_score: 0.9569; val_best_acc_score: 0.8871; val_best_f1_score: 0.9179; train_kl_reg_loss: 18970.0851; train_edge_recon_loss: 1963970.0788; train_gene_expr_recon_loss: 10974207.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12957147.5273; train_optim_loss: 12957147.5273; val_kl_reg_loss: 18412.1666; val_edge_recon_loss: 2009635.6184; val_gene_expr_recon_loss: 10946705.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12974753.1053; val_optim_loss: 12974753.1053
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9429; val_auprc_score: 0.9640; val_best_acc_score: 0.8926; val_best_f1_score: 0.9211; train_kl_reg_loss: 19801.0660; train_edge_recon_loss: 1927967.7220; train_gene_expr_recon_loss: 18475208.9394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20422977.7212; train_optim_loss: 20422977.7212; val_kl_reg_loss: 19970.5097; val_edge_recon_loss: 1942499.6453; val_gene_expr_recon_loss: 17633203.7297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19595673.8919; val_optim_loss: 19595673.8919
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9370; val_auprc_score: 0.9605; val_best_acc_score: 0.8895; val_best_f1_score: 0.9199; train_kl_reg_loss: 18993.6601; train_edge_recon_loss: 1957838.7568; train_gene_expr_recon_loss: 10954113.0121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12930945.4424; train_optim_loss: 12930945.4424; val_kl_reg_loss: 18405.3271; val_edge_recon_loss: 1959878.0592; val_gene_expr_recon_loss: 10935797.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12914081.2105; val_optim_loss: 12914081.2105
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9431; val_auprc_score: 0.9656; val_best_acc_score: 0.8929; val_best_f1_score: 0.9205; train_kl_reg_loss: 19791.9012; train_edge_recon_loss: 1925049.1114; train_gene_expr_recon_loss: 17845199.0727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19790040.0970; train_optim_loss: 19790040.0970; val_kl_reg_loss: 20057.0462; val_edge_recon_loss: 1941746.4223; val_gene_expr_recon_loss: 17176989.8378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19138793.1892; val_optim_loss: 19138793.1892
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9409; val_auprc_score: 0.9627; val_best_acc_score: 0.8957; val_best_f1_score: 0.9246; train_kl_reg_loss: 18977.3750; train_edge_recon_loss: 1969152.2583; train_gene_expr_recon_loss: 10928997.2485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12917126.8848; train_optim_loss: 12917126.8848; val_kl_reg_loss: 18393.5761; val_edge_recon_loss: 1911737.5066; val_gene_expr_recon_loss: 10919522.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12849653.6316; val_optim_loss: 12849653.6316
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9362; val_auprc_score: 0.9576; val_best_acc_score: 0.8889; val_best_f1_score: 0.9196; train_kl_reg_loss: 18996.6971; train_edge_recon_loss: 1962527.0379; train_gene_expr_recon_loss: 10915970.5030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12897494.2424; train_optim_loss: 12897494.2424; val_kl_reg_loss: 18372.7917; val_edge_recon_loss: 1991911.8355; val_gene_expr_recon_loss: 10893695.2105; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12903979.7368; val_optim_loss: 12903979.7368
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9457; val_auprc_score: 0.9668; val_best_acc_score: 0.8930; val_best_f1_score: 0.9215; train_kl_reg_loss: 19803.4573; train_edge_recon_loss: 1935038.0348; train_gene_expr_recon_loss: 17396461.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19351303.3394; train_optim_loss: 19351303.3394; val_kl_reg_loss: 19937.9776; val_edge_recon_loss: 1923898.4527; val_gene_expr_recon_loss: 16744474.0541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18688310.3243; val_optim_loss: 18688310.3243
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9322; val_auprc_score: 0.9549; val_best_acc_score: 0.8872; val_best_f1_score: 0.9183; train_kl_reg_loss: 18992.9654; train_edge_recon_loss: 1963466.8015; train_gene_expr_recon_loss: 10901748.7394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12884208.5455; train_optim_loss: 12884208.5455; val_kl_reg_loss: 18553.4585; val_edge_recon_loss: 1995589.0066; val_gene_expr_recon_loss: 10904416.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12918558.5263; val_optim_loss: 12918558.5263
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9470; val_auprc_score: 0.9666; val_best_acc_score: 0.8969; val_best_f1_score: 0.9232; train_kl_reg_loss: 19795.8661; train_edge_recon_loss: 1928265.3542; train_gene_expr_recon_loss: 17063447.3485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19011508.5394; train_optim_loss: 19011508.5394; val_kl_reg_loss: 19996.6006; val_edge_recon_loss: 1931622.8784; val_gene_expr_recon_loss: 16524056.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18475675.8378; val_optim_loss: 18475675.8378
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9327; val_auprc_score: 0.9559; val_best_acc_score: 0.8863; val_best_f1_score: 0.9181; train_kl_reg_loss: 19007.9736; train_edge_recon_loss: 1966276.5091; train_gene_expr_recon_loss: 10888355.2606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12873639.7394; train_optim_loss: 12873639.7394; val_kl_reg_loss: 18361.9230; val_edge_recon_loss: 1978550.6711; val_gene_expr_recon_loss: 10903288.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12900200.8947; val_optim_loss: 12900200.8947
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9330; val_auprc_score: 0.9570; val_best_acc_score: 0.8878; val_best_f1_score: 0.9184; train_kl_reg_loss: 18987.4997; train_edge_recon_loss: 1960996.4273; train_gene_expr_recon_loss: 10876855.0909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12856838.9758; train_optim_loss: 12856838.9758; val_kl_reg_loss: 18458.3959; val_edge_recon_loss: 1988326.5329; val_gene_expr_recon_loss: 10874525.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12881310.6316; val_optim_loss: 12881310.6316
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9470; val_auprc_score: 0.9677; val_best_acc_score: 0.8989; val_best_f1_score: 0.9256; train_kl_reg_loss: 19809.4735; train_edge_recon_loss: 1925878.9239; train_gene_expr_recon_loss: 16822821.6333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18768510.0727; train_optim_loss: 18768510.0727; val_kl_reg_loss: 19997.0437; val_edge_recon_loss: 1917704.2500; val_gene_expr_recon_loss: 16317290.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18254992.2162; val_optim_loss: 18254992.2162

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9375; val_auprc_score: 0.9577; val_best_acc_score: 0.8891; val_best_f1_score: 0.9191; train_kl_reg_loss: 18978.0027; train_edge_recon_loss: 1957586.4152; train_gene_expr_recon_loss: 10869045.1394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12845609.5333; train_optim_loss: 12845609.5333; val_kl_reg_loss: 18389.2440; val_edge_recon_loss: 1991649.4013; val_gene_expr_recon_loss: 10850889.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12860928.4737; val_optim_loss: 12860928.4737
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9352; val_auprc_score: 0.9578; val_best_acc_score: 0.8917; val_best_f1_score: 0.9212; train_kl_reg_loss: 18978.4383; train_edge_recon_loss: 1960062.7212; train_gene_expr_recon_loss: 10869027.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12848068.2545; train_optim_loss: 12848068.2545; val_kl_reg_loss: 18403.3636; val_edge_recon_loss: 1970346.8355; val_gene_expr_recon_loss: 10871179.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12859929.3158; val_optim_loss: 12859929.3158
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9442; val_auprc_score: 0.9655; val_best_acc_score: 0.8964; val_best_f1_score: 0.9238; train_kl_reg_loss: 19802.3301; train_edge_recon_loss: 1932603.3973; train_gene_expr_recon_loss: 16648021.6394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18600427.3697; train_optim_loss: 18600427.3697; val_kl_reg_loss: 19946.8944; val_edge_recon_loss: 1916527.9493; val_gene_expr_recon_loss: 16169146.8378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18105621.7297; val_optim_loss: 18105621.7297
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9366; val_auprc_score: 0.9578; val_best_acc_score: 0.8901; val_best_f1_score: 0.9203; train_kl_reg_loss: 19020.4364; train_edge_recon_loss: 1959533.4220; train_gene_expr_recon_loss: 10871871.1879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12850425.0182; train_optim_loss: 12850425.0182; val_kl_reg_loss: 18387.6072; val_edge_recon_loss: 1982461.1711; val_gene_expr_recon_loss: 10859300.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12860148.7368; val_optim_loss: 12860148.7368
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9442; val_auprc_score: 0.9665; val_best_acc_score: 0.8942; val_best_f1_score: 0.9221; train_kl_reg_loss: 19785.8239; train_edge_recon_loss: 1926863.1727; train_gene_expr_recon_loss: 16530772.6030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18477421.6000; train_optim_loss: 18477421.6000; val_kl_reg_loss: 19953.3279; val_edge_recon_loss: 1922380.4189; val_gene_expr_recon_loss: 16100781.3243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18043115.1351; val_optim_loss: 18043115.1351
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9374; val_auprc_score: 0.9584; val_best_acc_score: 0.8918; val_best_f1_score: 0.9221; train_kl_reg_loss: 18981.3157; train_edge_recon_loss: 1963474.6136; train_gene_expr_recon_loss: 10865644.5818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12848100.5333; train_optim_loss: 12848100.5333; val_kl_reg_loss: 18535.7049; val_edge_recon_loss: 1964844.4342; val_gene_expr_recon_loss: 10899721.4211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12883101.5263; val_optim_loss: 12883101.5263
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9486; val_auprc_score: 0.9682; val_best_acc_score: 0.8988; val_best_f1_score: 0.9256; train_kl_reg_loss: 19796.5235; train_edge_recon_loss: 1918073.2557; train_gene_expr_recon_loss: 16457580.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18395450.1394; train_optim_loss: 18395450.1394; val_kl_reg_loss: 19951.1670; val_edge_recon_loss: 1914422.6655; val_gene_expr_recon_loss: 16026925.3243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17961298.9730; val_optim_loss: 17961298.9730

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 69 min 12 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9366
val AUPRC score: 0.9602
val best accuracy score: 0.8880
val best F1 score: 0.9183
val target rna MSE score: 1.8937
val source rna MSE score: 1.5924
Val cat covariate0 mean sim diff: -0.0054

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9487; val_auprc_score: 0.9690; val_best_acc_score: 0.8963; val_best_f1_score: 0.9224; train_kl_reg_loss: 19791.7749; train_edge_recon_loss: 1933005.0663; train_gene_expr_recon_loss: 16396849.6545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18349646.4667; train_optim_loss: 18349646.4667; val_kl_reg_loss: 19985.9211; val_edge_recon_loss: 1931609.0203; val_gene_expr_recon_loss: 16010216.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17961811.1892; val_optim_loss: 17961811.1892
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9439; val_auprc_score: 0.9651; val_best_acc_score: 0.8949; val_best_f1_score: 0.9218; train_kl_reg_loss: 19795.7488; train_edge_recon_loss: 1935351.6754; train_gene_expr_recon_loss: 16361622.6697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18316770.0667; train_optim_loss: 18316770.0667; val_kl_reg_loss: 20033.5780; val_edge_recon_loss: 1935722.9324; val_gene_expr_recon_loss: 16001448.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17957205.2973; val_optim_loss: 17957205.2973
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9461; val_auprc_score: 0.9673; val_best_acc_score: 0.8938; val_best_f1_score: 0.9213; train_kl_reg_loss: 19808.5375; train_edge_recon_loss: 1908911.1390; train_gene_expr_recon_loss: 11426443.5545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13355163.2424; train_optim_loss: 13355163.2424; val_kl_reg_loss: 19485.8692; val_edge_recon_loss: 1938331.1520; val_gene_expr_recon_loss: 11338635.2973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13296452.3514; val_optim_loss: 13296452.3514
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9447; val_auprc_score: 0.9643; val_best_acc_score: 0.8935; val_best_f1_score: 0.9213; train_kl_reg_loss: 19803.6551; train_edge_recon_loss: 1918955.9924; train_gene_expr_recon_loss: 11286583.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13225343.2545; train_optim_loss: 13225343.2545; val_kl_reg_loss: 19397.8196; val_edge_recon_loss: 1930290.6858; val_gene_expr_recon_loss: 11233043.4324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13182731.9459; val_optim_loss: 13182731.9459
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9442; val_auprc_score: 0.9660; val_best_acc_score: 0.8944; val_best_f1_score: 0.9217; train_kl_reg_loss: 19807.8882; train_edge_recon_loss: 1911598.3303; train_gene_expr_recon_loss: 11192309.4515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13123715.6515; train_optim_loss: 13123715.6515; val_kl_reg_loss: 19404.0122; val_edge_recon_loss: 1941159.7162; val_gene_expr_recon_loss: 11149070.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13109634.2973; val_optim_loss: 13109634.2973
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9451; val_auprc_score: 0.9656; val_best_acc_score: 0.8960; val_best_f1_score: 0.9231; train_kl_reg_loss: 19800.1012; train_edge_recon_loss: 1904055.9534; train_gene_expr_recon_loss: 11124159.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13048015.1424; train_optim_loss: 13048015.1424; val_kl_reg_loss: 19443.3417; val_edge_recon_loss: 1914615.8581; val_gene_expr_recon_loss: 11103036.7297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13037095.9730; val_optim_loss: 13037095.9730
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9499; val_auprc_score: 0.9691; val_best_acc_score: 0.8981; val_best_f1_score: 0.9248; train_kl_reg_loss: 19802.2419; train_edge_recon_loss: 1921748.4648; train_gene_expr_recon_loss: 11079599.0333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13021149.7424; train_optim_loss: 13021149.7424; val_kl_reg_loss: 19435.5733; val_edge_recon_loss: 1916923.1081; val_gene_expr_recon_loss: 11066972.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13003331.6486; val_optim_loss: 13003331.6486
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9454; val_auprc_score: 0.9649; val_best_acc_score: 0.8948; val_best_f1_score: 0.9223; train_kl_reg_loss: 19800.7711; train_edge_recon_loss: 1908963.4106; train_gene_expr_recon_loss: 11048028.0667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12976792.2515; train_optim_loss: 12976792.2515; val_kl_reg_loss: 19444.0572; val_edge_recon_loss: 1933664.4493; val_gene_expr_recon_loss: 11043253.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12996362.3514; val_optim_loss: 12996362.3514
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9442; val_auprc_score: 0.9636; val_best_acc_score: 0.8960; val_best_f1_score: 0.9227; train_kl_reg_loss: 19796.3210; train_edge_recon_loss: 1903605.2949; train_gene_expr_recon_loss: 11022632.4061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12946034.0242; train_optim_loss: 12946034.0242; val_kl_reg_loss: 19437.6765; val_edge_recon_loss: 1940741.9392; val_gene_expr_recon_loss: 11016213.6757; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12976393.3514; val_optim_loss: 12976393.3514
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9460; val_auprc_score: 0.9650; val_best_acc_score: 0.8953; val_best_f1_score: 0.9229; train_kl_reg_loss: 19798.2468; train_edge_recon_loss: 1900858.9473; train_gene_expr_recon_loss: 11004554.1424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12925211.3152; train_optim_loss: 12925211.3152; val_kl_reg_loss: 19394.0781; val_edge_recon_loss: 1913189.2635; val_gene_expr_recon_loss: 11003221.5676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12935804.8649; val_optim_loss: 12935804.8649
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9479; val_auprc_score: 0.9679; val_best_acc_score: 0.8967; val_best_f1_score: 0.9235; train_kl_reg_loss: 19800.2472; train_edge_recon_loss: 1907795.0852; train_gene_expr_recon_loss: 10995892.8182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12923488.1364; train_optim_loss: 12923488.1364; val_kl_reg_loss: 19432.8047; val_edge_recon_loss: 1915281.6182; val_gene_expr_recon_loss: 10997720.2162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12932434.6486; val_optim_loss: 12932434.6486
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9446; val_auprc_score: 0.9650; val_best_acc_score: 0.8927; val_best_f1_score: 0.9204; train_kl_reg_loss: 19797.9885; train_edge_recon_loss: 1896928.2750; train_gene_expr_recon_loss: 10987207.9212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12903934.1576; train_optim_loss: 12903934.1576; val_kl_reg_loss: 19501.6754; val_edge_recon_loss: 1952434.1926; val_gene_expr_recon_loss: 10990677.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12962613.2162; val_optim_loss: 12962613.2162
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9452; val_auprc_score: 0.9667; val_best_acc_score: 0.8953; val_best_f1_score: 0.9229; train_kl_reg_loss: 19793.1520; train_edge_recon_loss: 1911303.5064; train_gene_expr_recon_loss: 10983624.7970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12914721.4727; train_optim_loss: 12914721.4727; val_kl_reg_loss: 19443.9259; val_edge_recon_loss: 1906501.0912; val_gene_expr_recon_loss: 10989119.6216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12915064.7027; val_optim_loss: 12915064.7027
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9452; val_auprc_score: 0.9651; val_best_acc_score: 0.8956; val_best_f1_score: 0.9225; train_kl_reg_loss: 19803.0541; train_edge_recon_loss: 1909965.5871; train_gene_expr_recon_loss: 10979283.7606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12909052.3939; train_optim_loss: 12909052.3939; val_kl_reg_loss: 19403.0230; val_edge_recon_loss: 1949914.9291; val_gene_expr_recon_loss: 10975007.0541; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12944325.0000; val_optim_loss: 12944325.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9486; val_auprc_score: 0.9693; val_best_acc_score: 0.8972; val_best_f1_score: 0.9240; train_kl_reg_loss: 19799.8117; train_edge_recon_loss: 1902192.6902; train_gene_expr_recon_loss: 10978996.4970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12900988.9758; train_optim_loss: 12900988.9758; val_kl_reg_loss: 19363.5325; val_edge_recon_loss: 1906193.6318; val_gene_expr_recon_loss: 10972165.1892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12897722.3514; val_optim_loss: 12897722.3514
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9467; val_auprc_score: 0.9656; val_best_acc_score: 0.8954; val_best_f1_score: 0.9224; train_kl_reg_loss: 19799.9178; train_edge_recon_loss: 1908959.0583; train_gene_expr_recon_loss: 10977548.2970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12906307.3061; train_optim_loss: 12906307.3061; val_kl_reg_loss: 19482.9334; val_edge_recon_loss: 1952910.7027; val_gene_expr_recon_loss: 10972943.4324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12945337.0270; val_optim_loss: 12945337.0270
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9482; val_auprc_score: 0.9687; val_best_acc_score: 0.8958; val_best_f1_score: 0.9233; train_kl_reg_loss: 19789.4756; train_edge_recon_loss: 1916299.6008; train_gene_expr_recon_loss: 10973970.6606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12910059.7606; train_optim_loss: 12910059.7606; val_kl_reg_loss: 19405.9863; val_edge_recon_loss: 1915245.3885; val_gene_expr_recon_loss: 10978230.8378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12912882.1351; val_optim_loss: 12912882.1351
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9471; val_auprc_score: 0.9673; val_best_acc_score: 0.8952; val_best_f1_score: 0.9225; train_kl_reg_loss: 19787.1371; train_edge_recon_loss: 1914626.9095; train_gene_expr_recon_loss: 10977687.8394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12912101.9121; train_optim_loss: 12912101.9121; val_kl_reg_loss: 19359.4621; val_edge_recon_loss: 1926710.7230; val_gene_expr_recon_loss: 10969463.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12915533.5405; val_optim_loss: 12915533.5405
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9470; val_auprc_score: 0.9679; val_best_acc_score: 0.8946; val_best_f1_score: 0.9221; train_kl_reg_loss: 19787.9474; train_edge_recon_loss: 1913170.4500; train_gene_expr_recon_loss: 10975633.8000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12908592.1939; train_optim_loss: 12908592.1939; val_kl_reg_loss: 19391.6917; val_edge_recon_loss: 1937852.3919; val_gene_expr_recon_loss: 10979014.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12936258.4324; val_optim_loss: 12936258.4324

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9465; val_auprc_score: 0.9673; val_best_acc_score: 0.8956; val_best_f1_score: 0.9227; train_kl_reg_loss: 19798.5447; train_edge_recon_loss: 1918572.1356; train_gene_expr_recon_loss: 10977010.6091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12915381.2879; train_optim_loss: 12915381.2879; val_kl_reg_loss: 19448.7523; val_edge_recon_loss: 1922329.1419; val_gene_expr_recon_loss: 10973177.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12914955.4595; val_optim_loss: 12914955.4595
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9440; val_auprc_score: 0.9650; val_best_acc_score: 0.8938; val_best_f1_score: 0.9214; train_kl_reg_loss: 19822.5023; train_edge_recon_loss: 1915762.7133; train_gene_expr_recon_loss: 10976369.8576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12911955.0788; train_optim_loss: 12911955.0788; val_kl_reg_loss: 19379.3410; val_edge_recon_loss: 1931080.7601; val_gene_expr_recon_loss: 10967492.0811; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12917952.1081; val_optim_loss: 12917952.1081
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9462; val_auprc_score: 0.9663; val_best_acc_score: 0.8967; val_best_f1_score: 0.9234; train_kl_reg_loss: 19802.9811; train_edge_recon_loss: 1912141.2629; train_gene_expr_recon_loss: 10975233.7909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12907178.0455; train_optim_loss: 12907178.0455; val_kl_reg_loss: 19418.7439; val_edge_recon_loss: 1935096.7534; val_gene_expr_recon_loss: 10970975.4865; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12925491.1081; val_optim_loss: 12925491.1081
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9447; val_auprc_score: 0.9664; val_best_acc_score: 0.8936; val_best_f1_score: 0.9216; train_kl_reg_loss: 19787.6505; train_edge_recon_loss: 1912377.8144; train_gene_expr_recon_loss: 10975231.0424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12907396.5152; train_optim_loss: 12907396.5152; val_kl_reg_loss: 19368.6427; val_edge_recon_loss: 1929579.2838; val_gene_expr_recon_loss: 10966590.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12915538.7297; val_optim_loss: 12915538.7297

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 107 min 51 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9430
val AUPRC score: 0.9651
val best accuracy score: 0.8922
val best F1 score: 0.9204
val target rna MSE score: 1.8717
val source rna MSE score: 1.7588
Val cat covariate0 mean sim diff: -0.0051

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
