Script arguments:
['../map_query_on_nichecompass_reference_model.py', '--reference_dataset', 'seqfish_mouse_organogenesis_imputed_subsample_25pct', '--query_dataset', 'seqfish_mouse_organogenesis_imputed', '--query_batches', 'batch5', 'batch6', '--n_neighbors', '8', '--spatial_key', 'spatial', '--mapping_entity_key', 'mapping_entity', '--gp_names_key', 'nichecompass_gp_names', '--reference_model_label', 'reference', '--load_timestamp', '08082024_095147_13', '--query_model_label', 'query', '--reference_query_model_label', 'reference_query', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.', '--edge_batch_size', '256', '--node_batch_size', 'None']
Retrieving reference model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1839, n_latent: 1839, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1839, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1839, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering for genes used in reference...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1839, n_latent: 1839, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1839, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1839, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 18519
Number of validation nodes: 2058
Number of training edges: 84228
Number of validation edges: 9358
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8868; val_auprc_score: 0.9381; val_best_acc_score: 0.8184; val_best_f1_score: 0.8677; train_kl_reg_loss: 28693.3702; train_edge_recon_loss: 2109401.2311; train_gene_expr_recon_loss: 119232470.7879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 121370565.1636; train_optim_loss: 121370565.1636; val_kl_reg_loss: 29099.2171; val_edge_recon_loss: 2147002.3716; val_gene_expr_recon_loss: 105449319.1351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 107625420.3243; val_optim_loss: 107625420.3243
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8851; val_auprc_score: 0.9381; val_best_acc_score: 0.8189; val_best_f1_score: 0.8679; train_kl_reg_loss: 28724.1569; train_edge_recon_loss: 2112007.5689; train_gene_expr_recon_loss: 95268819.0545; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 97409550.9576; train_optim_loss: 97409550.9576; val_kl_reg_loss: 28916.0190; val_edge_recon_loss: 2131218.3784; val_gene_expr_recon_loss: 83542849.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 85702984.0000; val_optim_loss: 85702984.0000
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8878; val_auprc_score: 0.9390; val_best_acc_score: 0.8203; val_best_f1_score: 0.8682; train_kl_reg_loss: 28730.1736; train_edge_recon_loss: 2121190.1625; train_gene_expr_recon_loss: 76593654.1091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 78743574.4848; train_optim_loss: 78743574.4848; val_kl_reg_loss: 28893.5676; val_edge_recon_loss: 2146801.4797; val_gene_expr_recon_loss: 67138371.1351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 69314065.9459; val_optim_loss: 69314065.9459
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8873; val_auprc_score: 0.9381; val_best_acc_score: 0.8203; val_best_f1_score: 0.8692; train_kl_reg_loss: 28755.5394; train_edge_recon_loss: 2121282.3951; train_gene_expr_recon_loss: 61907350.3758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 64057388.3394; train_optim_loss: 64057388.3394; val_kl_reg_loss: 28960.9352; val_edge_recon_loss: 2138104.6554; val_gene_expr_recon_loss: 54333861.5135; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 56500927.0270; val_optim_loss: 56500927.0270
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.8877; val_auprc_score: 0.9389; val_best_acc_score: 0.8205; val_best_f1_score: 0.8690; train_kl_reg_loss: 28742.9311; train_edge_recon_loss: 2113819.9583; train_gene_expr_recon_loss: 50582607.4182; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 52725170.2061; train_optim_loss: 52725170.2061; val_kl_reg_loss: 28820.0840; val_edge_recon_loss: 2123655.0980; val_gene_expr_recon_loss: 44824219.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 46976694.7027; val_optim_loss: 46976694.7027
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.8894; val_auprc_score: 0.9393; val_best_acc_score: 0.8244; val_best_f1_score: 0.8711; train_kl_reg_loss: 28702.9332; train_edge_recon_loss: 2118884.2136; train_gene_expr_recon_loss: 42073435.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 44221022.4727; train_optim_loss: 44221022.4727; val_kl_reg_loss: 28922.6359; val_edge_recon_loss: 2129187.6892; val_gene_expr_recon_loss: 37447889.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 39605999.5676; val_optim_loss: 39605999.5676
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.8867; val_auprc_score: 0.9385; val_best_acc_score: 0.8202; val_best_f1_score: 0.8689; train_kl_reg_loss: 28729.4973; train_edge_recon_loss: 2116830.0371; train_gene_expr_recon_loss: 35700431.4606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 37845991.0242; train_optim_loss: 37845991.0242; val_kl_reg_loss: 28883.8685; val_edge_recon_loss: 2130299.7872; val_gene_expr_recon_loss: 32087928.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 34247112.3243; val_optim_loss: 34247112.3243
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.8899; val_auprc_score: 0.9393; val_best_acc_score: 0.8231; val_best_f1_score: 0.8696; train_kl_reg_loss: 28717.1979; train_edge_recon_loss: 2123400.5462; train_gene_expr_recon_loss: 30761376.6000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 32913494.4061; train_optim_loss: 32913494.4061; val_kl_reg_loss: 28804.3277; val_edge_recon_loss: 2153752.4257; val_gene_expr_recon_loss: 27937266.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 30119823.3514; val_optim_loss: 30119823.3514
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.8881; val_auprc_score: 0.9376; val_best_acc_score: 0.8201; val_best_f1_score: 0.8682; train_kl_reg_loss: 28714.5581; train_edge_recon_loss: 2118832.8352; train_gene_expr_recon_loss: 26926341.4667; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 29073888.9333; train_optim_loss: 29073888.9333; val_kl_reg_loss: 28815.7430; val_edge_recon_loss: 2148607.9088; val_gene_expr_recon_loss: 24745801.0270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 26923224.7568; val_optim_loss: 26923224.7568
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.8833; val_auprc_score: 0.9338; val_best_acc_score: 0.8191; val_best_f1_score: 0.8685; train_kl_reg_loss: 28682.1767; train_edge_recon_loss: 2122523.6879; train_gene_expr_recon_loss: 24080447.6242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 26231653.5273; train_optim_loss: 26231653.5273; val_kl_reg_loss: 28997.7592; val_edge_recon_loss: 2134133.0439; val_gene_expr_recon_loss: 22374863.5676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 24537994.4865; val_optim_loss: 24537994.4865
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.8873; val_auprc_score: 0.9400; val_best_acc_score: 0.8185; val_best_f1_score: 0.8688; train_kl_reg_loss: 28669.2871; train_edge_recon_loss: 2123786.7867; train_gene_expr_recon_loss: 21826190.1091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 23978646.2182; train_optim_loss: 23978646.2182; val_kl_reg_loss: 28879.2238; val_edge_recon_loss: 2133425.7331; val_gene_expr_recon_loss: 20470625.9459; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 22632930.8649; val_optim_loss: 22632930.8649
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.8893; val_auprc_score: 0.9397; val_best_acc_score: 0.8237; val_best_f1_score: 0.8703; train_kl_reg_loss: 28703.4159; train_edge_recon_loss: 2119580.5008; train_gene_expr_recon_loss: 20104697.0970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 22252981.0182; train_optim_loss: 22252981.0182; val_kl_reg_loss: 28838.5052; val_edge_recon_loss: 2143493.7365; val_gene_expr_recon_loss: 18958800.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 21131133.0811; val_optim_loss: 21131133.0811
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.8887; val_auprc_score: 0.9405; val_best_acc_score: 0.8241; val_best_f1_score: 0.8717; train_kl_reg_loss: 28685.7427; train_edge_recon_loss: 2124016.8242; train_gene_expr_recon_loss: 18712833.2727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 20865535.8242; train_optim_loss: 20865535.8242; val_kl_reg_loss: 28872.7153; val_edge_recon_loss: 2117495.2297; val_gene_expr_recon_loss: 17783632.9189; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 19930000.8649; val_optim_loss: 19930000.8649
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.8876; val_auprc_score: 0.9386; val_best_acc_score: 0.8211; val_best_f1_score: 0.8689; train_kl_reg_loss: 28726.7796; train_edge_recon_loss: 2127370.6398; train_gene_expr_recon_loss: 17628085.2333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 19784182.7152; train_optim_loss: 19784182.7152; val_kl_reg_loss: 28828.4826; val_edge_recon_loss: 2137041.4527; val_gene_expr_recon_loss: 16831503.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18997373.6757; val_optim_loss: 18997373.6757
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.8878; val_auprc_score: 0.9396; val_best_acc_score: 0.8206; val_best_f1_score: 0.8689; train_kl_reg_loss: 28696.1254; train_edge_recon_loss: 2119235.2561; train_gene_expr_recon_loss: 16745809.4576; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18893740.8303; train_optim_loss: 18893740.8303; val_kl_reg_loss: 29015.4776; val_edge_recon_loss: 2126863.8041; val_gene_expr_recon_loss: 16094446.0270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 18250325.1351; val_optim_loss: 18250325.1351
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.8841; val_auprc_score: 0.9352; val_best_acc_score: 0.8201; val_best_f1_score: 0.8683; train_kl_reg_loss: 28757.4328; train_edge_recon_loss: 2115745.1311; train_gene_expr_recon_loss: 16091369.5333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 18235872.1152; train_optim_loss: 18235872.1152; val_kl_reg_loss: 28928.2198; val_edge_recon_loss: 2150248.0912; val_gene_expr_recon_loss: 15492103.2162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17671279.4054; val_optim_loss: 17671279.4054
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.8846; val_auprc_score: 0.9370; val_best_acc_score: 0.8164; val_best_f1_score: 0.8659; train_kl_reg_loss: 28708.7959; train_edge_recon_loss: 2115223.8352; train_gene_expr_recon_loss: 15575612.1879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17719544.8182; train_optim_loss: 17719544.8182; val_kl_reg_loss: 29006.7310; val_edge_recon_loss: 2153833.2128; val_gene_expr_recon_loss: 15093596.6216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 17276436.5946; val_optim_loss: 17276436.5946
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.8878; val_auprc_score: 0.9387; val_best_acc_score: 0.8227; val_best_f1_score: 0.8701; train_kl_reg_loss: 28728.3455; train_edge_recon_loss: 2123928.5163; train_gene_expr_recon_loss: 15196443.5939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17349100.4455; train_optim_loss: 17349100.4455; val_kl_reg_loss: 28825.0839; val_edge_recon_loss: 2133765.5304; val_gene_expr_recon_loss: 14735796.3243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16898386.9189; val_optim_loss: 16898386.9189
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.8916; val_auprc_score: 0.9409; val_best_acc_score: 0.8236; val_best_f1_score: 0.8705; train_kl_reg_loss: 28679.0990; train_edge_recon_loss: 2118287.0398; train_gene_expr_recon_loss: 14919175.5879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 17066141.7212; train_optim_loss: 17066141.7212; val_kl_reg_loss: 29017.3142; val_edge_recon_loss: 2138145.2838; val_gene_expr_recon_loss: 14543004.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16710166.8378; val_optim_loss: 16710166.8378
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.8892; val_auprc_score: 0.9396; val_best_acc_score: 0.8239; val_best_f1_score: 0.8714; train_kl_reg_loss: 28762.1018; train_edge_recon_loss: 2114616.2909; train_gene_expr_recon_loss: 14723622.9242; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16867001.2818; train_optim_loss: 16867001.2818; val_kl_reg_loss: 28855.7345; val_edge_recon_loss: 2128117.7905; val_gene_expr_recon_loss: 14389659.1351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16546632.7027; val_optim_loss: 16546632.7027
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.8885; val_auprc_score: 0.9393; val_best_acc_score: 0.8230; val_best_f1_score: 0.8706; train_kl_reg_loss: 28759.8573; train_edge_recon_loss: 2124955.0481; train_gene_expr_recon_loss: 14588165.4697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16741880.3879; train_optim_loss: 16741880.3879; val_kl_reg_loss: 28797.6845; val_edge_recon_loss: 2121354.2331; val_gene_expr_recon_loss: 14271705.8919; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16421857.9189; val_optim_loss: 16421857.9189
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.8885; val_auprc_score: 0.9413; val_best_acc_score: 0.8200; val_best_f1_score: 0.8687; train_kl_reg_loss: 28705.5397; train_edge_recon_loss: 2116728.3174; train_gene_expr_recon_loss: 14504813.1091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16650246.9364; train_optim_loss: 16650246.9364; val_kl_reg_loss: 28820.6583; val_edge_recon_loss: 2132096.1385; val_gene_expr_recon_loss: 14231484.6486; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16392401.3784; val_optim_loss: 16392401.3784
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.8880; val_auprc_score: 0.9392; val_best_acc_score: 0.8225; val_best_f1_score: 0.8702; train_kl_reg_loss: 28735.2707; train_edge_recon_loss: 2106773.1833; train_gene_expr_recon_loss: 14470197.0394; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16605705.5000; train_optim_loss: 16605705.5000; val_kl_reg_loss: 28855.0847; val_edge_recon_loss: 2125183.6520; val_gene_expr_recon_loss: 14187517.5676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16341556.3514; val_optim_loss: 16341556.3514
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.8902; val_auprc_score: 0.9407; val_best_acc_score: 0.8227; val_best_f1_score: 0.8697; train_kl_reg_loss: 28689.7614; train_edge_recon_loss: 2123097.7754; train_gene_expr_recon_loss: 14439537.6758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16591325.1970; train_optim_loss: 16591325.1970; val_kl_reg_loss: 28876.8351; val_edge_recon_loss: 2142640.0034; val_gene_expr_recon_loss: 14184562.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16356079.4595; val_optim_loss: 16356079.4595
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.8868; val_auprc_score: 0.9374; val_best_acc_score: 0.8203; val_best_f1_score: 0.8688; train_kl_reg_loss: 28749.2824; train_edge_recon_loss: 2123473.5197; train_gene_expr_recon_loss: 14432278.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16584501.6030; train_optim_loss: 16584501.6030; val_kl_reg_loss: 29174.9438; val_edge_recon_loss: 2141205.3446; val_gene_expr_recon_loss: 14204015.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 16374395.5946; val_optim_loss: 16374395.5946
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8893; val_auprc_score: 0.9396; val_best_acc_score: 0.8217; val_best_f1_score: 0.8691; train_kl_reg_loss: 28748.0392; train_edge_recon_loss: 2117389.2027; train_gene_expr_recon_loss: 12200210.7818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14346348.0333; train_optim_loss: 14346348.0333; val_kl_reg_loss: 28162.8675; val_edge_recon_loss: 2148569.5642; val_gene_expr_recon_loss: 12140547.4595; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14317279.8378; val_optim_loss: 14317279.8378
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8861; val_auprc_score: 0.9377; val_best_acc_score: 0.8170; val_best_f1_score: 0.8664; train_kl_reg_loss: 28772.0635; train_edge_recon_loss: 2127969.7962; train_gene_expr_recon_loss: 12146717.4091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14303459.2848; train_optim_loss: 14303459.2848; val_kl_reg_loss: 28085.1966; val_edge_recon_loss: 2146359.9696; val_gene_expr_recon_loss: 12056340.4324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14230785.5946; val_optim_loss: 14230785.5946
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8869; val_auprc_score: 0.9377; val_best_acc_score: 0.8205; val_best_f1_score: 0.8692; train_kl_reg_loss: 28757.3838; train_edge_recon_loss: 2122446.0500; train_gene_expr_recon_loss: 12125550.2879; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14276753.7242; train_optim_loss: 14276753.7242; val_kl_reg_loss: 28239.3515; val_edge_recon_loss: 2152926.2196; val_gene_expr_recon_loss: 12037229.0270; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14218394.6216; val_optim_loss: 14218394.6216
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8893; val_auprc_score: 0.9393; val_best_acc_score: 0.8232; val_best_f1_score: 0.8709; train_kl_reg_loss: 28704.6852; train_edge_recon_loss: 2111148.3697; train_gene_expr_recon_loss: 12120781.7515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14260634.8000; train_optim_loss: 14260634.8000; val_kl_reg_loss: 28251.9976; val_edge_recon_loss: 2122270.8243; val_gene_expr_recon_loss: 12060296.1351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14210818.9459; val_optim_loss: 14210818.9459
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8912; val_auprc_score: 0.9410; val_best_acc_score: 0.8232; val_best_f1_score: 0.8708; train_kl_reg_loss: 28741.8516; train_edge_recon_loss: 2129861.4883; train_gene_expr_recon_loss: 12105500.8970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14264104.2303; train_optim_loss: 14264104.2303; val_kl_reg_loss: 28097.7362; val_edge_recon_loss: 2132471.0439; val_gene_expr_recon_loss: 12069989.1622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14230557.8919; val_optim_loss: 14230557.8919
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8895; val_auprc_score: 0.9392; val_best_acc_score: 0.8215; val_best_f1_score: 0.8706; train_kl_reg_loss: 28711.4041; train_edge_recon_loss: 2116787.6667; train_gene_expr_recon_loss: 12095502.1303; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14241001.1970; train_optim_loss: 14241001.1970; val_kl_reg_loss: 28290.5179; val_edge_recon_loss: 2147380.6385; val_gene_expr_recon_loss: 12051301.8108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14226973.0000; val_optim_loss: 14226973.0000
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8871; val_auprc_score: 0.9363; val_best_acc_score: 0.8219; val_best_f1_score: 0.8694; train_kl_reg_loss: 28733.0885; train_edge_recon_loss: 2112490.5985; train_gene_expr_recon_loss: 12094776.1515; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14235999.8394; train_optim_loss: 14235999.8394; val_kl_reg_loss: 28198.8272; val_edge_recon_loss: 2155014.6588; val_gene_expr_recon_loss: 12067543.7838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14250757.3243; val_optim_loss: 14250757.3243
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8891; val_auprc_score: 0.9381; val_best_acc_score: 0.8220; val_best_f1_score: 0.8709; train_kl_reg_loss: 28723.1326; train_edge_recon_loss: 2105198.1186; train_gene_expr_recon_loss: 12110181.3364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14244102.6121; train_optim_loss: 14244102.6121; val_kl_reg_loss: 28107.7193; val_edge_recon_loss: 2120946.1959; val_gene_expr_recon_loss: 12043579.4054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14192633.2973; val_optim_loss: 14192633.2973
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.8913; val_auprc_score: 0.9418; val_best_acc_score: 0.8225; val_best_f1_score: 0.8709; train_kl_reg_loss: 28762.9188; train_edge_recon_loss: 2115617.3420; train_gene_expr_recon_loss: 12089401.1061; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14233781.3667; train_optim_loss: 14233781.3667; val_kl_reg_loss: 28139.9555; val_edge_recon_loss: 2128932.9358; val_gene_expr_recon_loss: 12056974.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14214047.2432; val_optim_loss: 14214047.2432
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.8881; val_auprc_score: 0.9381; val_best_acc_score: 0.8213; val_best_f1_score: 0.8686; train_kl_reg_loss: 28735.3506; train_edge_recon_loss: 2103725.6508; train_gene_expr_recon_loss: 12088469.4364; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14220930.4364; train_optim_loss: 14220930.4364; val_kl_reg_loss: 28564.7589; val_edge_recon_loss: 2161034.7230; val_gene_expr_recon_loss: 12035273.8378; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14224873.2973; val_optim_loss: 14224873.2973
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.8874; val_auprc_score: 0.9393; val_best_acc_score: 0.8216; val_best_f1_score: 0.8707; train_kl_reg_loss: 28705.1560; train_edge_recon_loss: 2121232.3852; train_gene_expr_recon_loss: 12094248.2273; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14244185.7758; train_optim_loss: 14244185.7758; val_kl_reg_loss: 28177.7632; val_edge_recon_loss: 2111612.3885; val_gene_expr_recon_loss: 12053815.3514; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14193605.4595; val_optim_loss: 14193605.4595
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.8895; val_auprc_score: 0.9379; val_best_acc_score: 0.8248; val_best_f1_score: 0.8702; train_kl_reg_loss: 28757.1228; train_edge_recon_loss: 2115777.9273; train_gene_expr_recon_loss: 12085340.8333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14229875.8848; train_optim_loss: 14229875.8848; val_kl_reg_loss: 28069.4758; val_edge_recon_loss: 2162183.9696; val_gene_expr_recon_loss: 12024291.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14214544.3784; val_optim_loss: 14214544.3784

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.8937; val_auprc_score: 0.9441; val_best_acc_score: 0.8237; val_best_f1_score: 0.8706; train_kl_reg_loss: 28733.7743; train_edge_recon_loss: 2107105.5591; train_gene_expr_recon_loss: 12089438.6424; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14225277.9636; train_optim_loss: 14225277.9636; val_kl_reg_loss: 28175.3575; val_edge_recon_loss: 2113946.0777; val_gene_expr_recon_loss: 12016092.2703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14158213.6486; val_optim_loss: 14158213.6486
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.8919; val_auprc_score: 0.9393; val_best_acc_score: 0.8240; val_best_f1_score: 0.8706; train_kl_reg_loss: 28704.2421; train_edge_recon_loss: 2114604.0167; train_gene_expr_recon_loss: 12093643.4818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14236951.7515; train_optim_loss: 14236951.7515; val_kl_reg_loss: 28431.0296; val_edge_recon_loss: 2161644.1419; val_gene_expr_recon_loss: 12030864.7568; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14220939.9189; val_optim_loss: 14220939.9189
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.8916; val_auprc_score: 0.9421; val_best_acc_score: 0.8241; val_best_f1_score: 0.8719; train_kl_reg_loss: 28700.9716; train_edge_recon_loss: 2123260.4852; train_gene_expr_recon_loss: 12078698.2970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14230659.7394; train_optim_loss: 14230659.7394; val_kl_reg_loss: 28099.7404; val_edge_recon_loss: 2125098.5541; val_gene_expr_recon_loss: 12034552.2162; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14187750.5135; val_optim_loss: 14187750.5135
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.8903; val_auprc_score: 0.9407; val_best_acc_score: 0.8232; val_best_f1_score: 0.8707; train_kl_reg_loss: 28713.3012; train_edge_recon_loss: 2122062.8996; train_gene_expr_recon_loss: 12090364.9818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14241141.1939; train_optim_loss: 14241141.1939; val_kl_reg_loss: 28136.2503; val_edge_recon_loss: 2134476.2466; val_gene_expr_recon_loss: 12011241.5946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14173854.0270; val_optim_loss: 14173854.0270
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.8897; val_auprc_score: 0.9409; val_best_acc_score: 0.8217; val_best_f1_score: 0.8706; train_kl_reg_loss: 28704.3338; train_edge_recon_loss: 2122334.5795; train_gene_expr_recon_loss: 12088504.5909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14239543.4970; train_optim_loss: 14239543.4970; val_kl_reg_loss: 28171.6680; val_edge_recon_loss: 2149087.6351; val_gene_expr_recon_loss: 12039373.2432; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14216632.5946; val_optim_loss: 14216632.5946

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.8899; val_auprc_score: 0.9415; val_best_acc_score: 0.8212; val_best_f1_score: 0.8703; train_kl_reg_loss: 28711.8990; train_edge_recon_loss: 2127003.4845; train_gene_expr_recon_loss: 12082180.7727; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14237896.1515; train_optim_loss: 14237896.1515; val_kl_reg_loss: 28240.3672; val_edge_recon_loss: 2134587.1824; val_gene_expr_recon_loss: 12033311.1081; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14196138.7027; val_optim_loss: 14196138.7027
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.8875; val_auprc_score: 0.9380; val_best_acc_score: 0.8223; val_best_f1_score: 0.8701; train_kl_reg_loss: 28731.7604; train_edge_recon_loss: 2123605.9621; train_gene_expr_recon_loss: 12088410.7909; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14240748.5030; train_optim_loss: 14240748.5030; val_kl_reg_loss: 28023.4200; val_edge_recon_loss: 2137475.0878; val_gene_expr_recon_loss: 12027108.3784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14192606.8919; val_optim_loss: 14192606.8919
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.8880; val_auprc_score: 0.9386; val_best_acc_score: 0.8221; val_best_f1_score: 0.8705; train_kl_reg_loss: 28708.0478; train_edge_recon_loss: 2123731.6583; train_gene_expr_recon_loss: 12084595.0455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14237034.7485; train_optim_loss: 14237034.7485; val_kl_reg_loss: 28157.7446; val_edge_recon_loss: 2153142.3311; val_gene_expr_recon_loss: 12025839.7297; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14207139.9459; val_optim_loss: 14207139.9459
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.8856; val_auprc_score: 0.9385; val_best_acc_score: 0.8186; val_best_f1_score: 0.8690; train_kl_reg_loss: 28685.7041; train_edge_recon_loss: 2122319.2148; train_gene_expr_recon_loss: 12086010.3333; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 14237015.2667; train_optim_loss: 14237015.2667; val_kl_reg_loss: 28110.7764; val_edge_recon_loss: 2141620.9426; val_gene_expr_recon_loss: 12021375.2973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14191107.0811; val_optim_loss: 14191107.0811

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 59 min 0 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.8839
val AUPRC score: 0.9366
val best accuracy score: 0.8159
val best F1 score: 0.8678
val target rna MSE score: 4.2385
val source rna MSE score: 2.7540
Val cat covariate0 mean sim diff: -0.0045

Saving query model...

Integrating reference and query adata...

Computing reference query latent embedding...

Computing neighbor graph...

Computing UMAP embedding...

Saving reference query model...
