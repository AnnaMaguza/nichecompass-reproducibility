[True]
Run timestamp: 07082024_105223_15.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--no-include_omnipath_gps', '--no-include_nichenet_gps', '--no-include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--seed', '0', '--timestamp_suffix', '_15']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1072.
Number of gene programs after filtering and combining: 1003.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 995, n_latent: 895, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 895, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 895, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8911; val_auprc_score: 0.9770; val_best_acc_score: 0.8893; val_best_f1_score: 0.9374; train_kl_reg_loss: 109824.6184; train_edge_recon_loss: 1026966.4746; train_gene_expr_recon_loss: 43358457.0657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44495248.1195; train_optim_loss: 44495248.1195; val_kl_reg_loss: 85774.8537; val_edge_recon_loss: 948969.8522; val_gene_expr_recon_loss: 39241065.7204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40275810.5376; val_optim_loss: 40275810.5376
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9127; val_auprc_score: 0.9820; val_best_acc_score: 0.9099; val_best_f1_score: 0.9483; train_kl_reg_loss: 78037.3330; train_edge_recon_loss: 896888.0240; train_gene_expr_recon_loss: 37364505.2186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38339430.6380; train_optim_loss: 38339430.6380; val_kl_reg_loss: 71501.6882; val_edge_recon_loss: 865889.4019; val_gene_expr_recon_loss: 35792788.3871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36730179.3978; val_optim_loss: 36730179.3978
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9256; val_auprc_score: 0.9827; val_best_acc_score: 0.9193; val_best_f1_score: 0.9534; train_kl_reg_loss: 65033.4180; train_edge_recon_loss: 860039.4222; train_gene_expr_recon_loss: 34594642.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35519714.8578; train_optim_loss: 35519714.8578; val_kl_reg_loss: 60766.3051; val_edge_recon_loss: 859614.0618; val_gene_expr_recon_loss: 33567081.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34487462.2796; val_optim_loss: 34487462.2796
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9365; val_auprc_score: 0.9861; val_best_acc_score: 0.9253; val_best_f1_score: 0.9570; train_kl_reg_loss: 56247.3691; train_edge_recon_loss: 841824.5974; train_gene_expr_recon_loss: 32758671.3477; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 33656743.3142; train_optim_loss: 33656743.3142; val_kl_reg_loss: 52940.7673; val_edge_recon_loss: 850033.1559; val_gene_expr_recon_loss: 32060765.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32963739.8065; val_optim_loss: 32963739.8065
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9402; val_auprc_score: 0.9862; val_best_acc_score: 0.9311; val_best_f1_score: 0.9600; train_kl_reg_loss: 48871.4135; train_edge_recon_loss: 831340.4202; train_gene_expr_recon_loss: 31515929.3524; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32396141.1708; train_optim_loss: 32396141.1708; val_kl_reg_loss: 45431.0703; val_edge_recon_loss: 851930.4066; val_gene_expr_recon_loss: 31031067.9140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31928429.4624; val_optim_loss: 31928429.4624
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9468; val_auprc_score: 0.9876; val_best_acc_score: 0.9384; val_best_f1_score: 0.9644; train_kl_reg_loss: 43095.2201; train_edge_recon_loss: 818654.9250; train_gene_expr_recon_loss: 30674603.1350; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31536353.2951; train_optim_loss: 31536353.2951; val_kl_reg_loss: 41060.5202; val_edge_recon_loss: 807364.1983; val_gene_expr_recon_loss: 30368245.8280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31216670.5161; val_optim_loss: 31216670.5161
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9518; val_auprc_score: 0.9893; val_best_acc_score: 0.9399; val_best_f1_score: 0.9653; train_kl_reg_loss: 37840.9186; train_edge_recon_loss: 812981.9104; train_gene_expr_recon_loss: 30095324.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30946147.3477; train_optim_loss: 30946147.3477; val_kl_reg_loss: 35589.0104; val_edge_recon_loss: 804757.1048; val_gene_expr_recon_loss: 29905502.7312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30745848.8387; val_optim_loss: 30745848.8387
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9552; val_auprc_score: 0.9901; val_best_acc_score: 0.9408; val_best_f1_score: 0.9659; train_kl_reg_loss: 33203.4216; train_edge_recon_loss: 800976.3121; train_gene_expr_recon_loss: 29713291.6487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30547471.4217; train_optim_loss: 30547471.4217; val_kl_reg_loss: 32032.9328; val_edge_recon_loss: 814972.3024; val_gene_expr_recon_loss: 29595038.3871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30442043.7849; val_optim_loss: 30442043.7849
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9573; val_auprc_score: 0.9894; val_best_acc_score: 0.9470; val_best_f1_score: 0.9692; train_kl_reg_loss: 29878.2902; train_edge_recon_loss: 806622.7829; train_gene_expr_recon_loss: 29451094.4875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30287595.5842; train_optim_loss: 30287595.5842; val_kl_reg_loss: 28661.2925; val_edge_recon_loss: 799247.8743; val_gene_expr_recon_loss: 29335591.2688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30163500.4086; val_optim_loss: 30163500.4086
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9542; val_auprc_score: 0.9889; val_best_acc_score: 0.9467; val_best_f1_score: 0.9691; train_kl_reg_loss: 27428.9988; train_edge_recon_loss: 791728.9267; train_gene_expr_recon_loss: 29276476.0502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30095634.0000; train_optim_loss: 30095634.0000; val_kl_reg_loss: 26126.6229; val_edge_recon_loss: 805587.8575; val_gene_expr_recon_loss: 29206005.3763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30037719.8495; val_optim_loss: 30037719.8495
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9594; val_auprc_score: 0.9902; val_best_acc_score: 0.9488; val_best_f1_score: 0.9702; train_kl_reg_loss: 25694.2524; train_edge_recon_loss: 785059.3607; train_gene_expr_recon_loss: 29149874.3775; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29960627.9522; train_optim_loss: 29960627.9522; val_kl_reg_loss: 24815.1630; val_edge_recon_loss: 813181.7345; val_gene_expr_recon_loss: 29099915.3978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29937912.3011; val_optim_loss: 29937912.3011
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9616; val_auprc_score: 0.9912; val_best_acc_score: 0.9496; val_best_f1_score: 0.9707; train_kl_reg_loss: 24358.9872; train_edge_recon_loss: 788467.5355; train_gene_expr_recon_loss: 29069574.7312; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29882401.2569; train_optim_loss: 29882401.2569; val_kl_reg_loss: 23572.9489; val_edge_recon_loss: 790735.7910; val_gene_expr_recon_loss: 29106562.8172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29920871.5699; val_optim_loss: 29920871.5699
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9606; val_auprc_score: 0.9911; val_best_acc_score: 0.9477; val_best_f1_score: 0.9696; train_kl_reg_loss: 23239.5311; train_edge_recon_loss: 795728.1812; train_gene_expr_recon_loss: 29006794.2246; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29825761.9642; train_optim_loss: 29825761.9642; val_kl_reg_loss: 22931.2106; val_edge_recon_loss: 805601.6747; val_gene_expr_recon_loss: 29073656.6022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29902189.4839; val_optim_loss: 29902189.4839
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9622; val_auprc_score: 0.9908; val_best_acc_score: 0.9493; val_best_f1_score: 0.9706; train_kl_reg_loss: 22249.3892; train_edge_recon_loss: 792416.8768; train_gene_expr_recon_loss: 28966928.3967; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29781594.6595; train_optim_loss: 29781594.6595; val_kl_reg_loss: 22094.4150; val_edge_recon_loss: 784195.1022; val_gene_expr_recon_loss: 28939627.9355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29745917.5699; val_optim_loss: 29745917.5699
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9626; val_auprc_score: 0.9915; val_best_acc_score: 0.9491; val_best_f1_score: 0.9703; train_kl_reg_loss: 21392.7832; train_edge_recon_loss: 780349.4626; train_gene_expr_recon_loss: 28931531.7204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29733273.9952; train_optim_loss: 29733273.9952; val_kl_reg_loss: 22049.7380; val_edge_recon_loss: 809813.6821; val_gene_expr_recon_loss: 28994795.7634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29826659.2043; val_optim_loss: 29826659.2043
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9623; val_auprc_score: 0.9917; val_best_acc_score: 0.9508; val_best_f1_score: 0.9714; train_kl_reg_loss: 20795.2267; train_edge_recon_loss: 782147.5293; train_gene_expr_recon_loss: 28907347.5795; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29710290.3393; train_optim_loss: 29710290.3393; val_kl_reg_loss: 21035.0353; val_edge_recon_loss: 789515.8414; val_gene_expr_recon_loss: 28954812.7312; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29765363.6774; val_optim_loss: 29765363.6774
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9637; val_auprc_score: 0.9913; val_best_acc_score: 0.9533; val_best_f1_score: 0.9728; train_kl_reg_loss: 20199.1643; train_edge_recon_loss: 783528.2110; train_gene_expr_recon_loss: 28888609.6918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29692337.0370; train_optim_loss: 29692337.0370; val_kl_reg_loss: 19641.2177; val_edge_recon_loss: 797223.3233; val_gene_expr_recon_loss: 28901796.4946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29718661.0968; val_optim_loss: 29718661.0968
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9665; val_auprc_score: 0.9921; val_best_acc_score: 0.9546; val_best_f1_score: 0.9735; train_kl_reg_loss: 19687.5976; train_edge_recon_loss: 781661.9279; train_gene_expr_recon_loss: 28872404.1649; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29673753.6941; train_optim_loss: 29673753.6941; val_kl_reg_loss: 20382.9362; val_edge_recon_loss: 797323.4751; val_gene_expr_recon_loss: 28951097.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29768804.3011; val_optim_loss: 29768804.3011
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9659; val_auprc_score: 0.9927; val_best_acc_score: 0.9520; val_best_f1_score: 0.9721; train_kl_reg_loss: 19325.6032; train_edge_recon_loss: 785024.8758; train_gene_expr_recon_loss: 28861955.0108; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29666305.5054; train_optim_loss: 29666305.5054; val_kl_reg_loss: 20075.7418; val_edge_recon_loss: 802223.7285; val_gene_expr_recon_loss: 28948721.2903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29771020.6882; val_optim_loss: 29771020.6882
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9638; val_auprc_score: 0.9905; val_best_acc_score: 0.9532; val_best_f1_score: 0.9727; train_kl_reg_loss: 18951.3966; train_edge_recon_loss: 776922.8680; train_gene_expr_recon_loss: 28854908.3919; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29650782.6260; train_optim_loss: 29650782.6260; val_kl_reg_loss: 18836.7780; val_edge_recon_loss: 801206.3024; val_gene_expr_recon_loss: 28853557.7634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29673600.7957; val_optim_loss: 29673600.7957
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9671; val_auprc_score: 0.9927; val_best_acc_score: 0.9559; val_best_f1_score: 0.9744; train_kl_reg_loss: 18462.9471; train_edge_recon_loss: 777260.6097; train_gene_expr_recon_loss: 28850386.6738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29646110.2485; train_optim_loss: 29646110.2485; val_kl_reg_loss: 18200.5246; val_edge_recon_loss: 771723.8663; val_gene_expr_recon_loss: 28845967.9355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29635892.2796; val_optim_loss: 29635892.2796
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9652; val_auprc_score: 0.9911; val_best_acc_score: 0.9562; val_best_f1_score: 0.9744; train_kl_reg_loss: 18105.5729; train_edge_recon_loss: 780050.6053; train_gene_expr_recon_loss: 28844804.4779; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29642960.6523; train_optim_loss: 29642960.6523; val_kl_reg_loss: 17924.5686; val_edge_recon_loss: 801681.9785; val_gene_expr_recon_loss: 28845890.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29665496.9247; val_optim_loss: 29665496.9247
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9683; val_auprc_score: 0.9929; val_best_acc_score: 0.9566; val_best_f1_score: 0.9747; train_kl_reg_loss: 17850.5518; train_edge_recon_loss: 772687.5765; train_gene_expr_recon_loss: 28837770.7384; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29628308.8889; train_optim_loss: 29628308.8889; val_kl_reg_loss: 17572.5848; val_edge_recon_loss: 787376.5954; val_gene_expr_recon_loss: 28834018.4731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29638967.6989; val_optim_loss: 29638967.6989
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9660; val_auprc_score: 0.9912; val_best_acc_score: 0.9570; val_best_f1_score: 0.9750; train_kl_reg_loss: 17598.8204; train_edge_recon_loss: 777324.6917; train_gene_expr_recon_loss: 28836388.9462; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29631312.4970; train_optim_loss: 29631312.4970; val_kl_reg_loss: 17268.8547; val_edge_recon_loss: 780697.4933; val_gene_expr_recon_loss: 28856765.8065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29654732.2581; val_optim_loss: 29654732.2581
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9642; val_auprc_score: 0.9918; val_best_acc_score: 0.9519; val_best_f1_score: 0.9721; train_kl_reg_loss: 17405.7507; train_edge_recon_loss: 775775.7581; train_gene_expr_recon_loss: 28833996.8578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29627178.3823; train_optim_loss: 29627178.3823; val_kl_reg_loss: 17851.5889; val_edge_recon_loss: 786800.3128; val_gene_expr_recon_loss: 28979573.3548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29784225.2473; val_optim_loss: 29784225.2473

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9656; val_auprc_score: 0.9917; val_best_acc_score: 0.9556; val_best_f1_score: 0.9740; train_kl_reg_loss: 17361.5317; train_edge_recon_loss: 775116.7118; train_gene_expr_recon_loss: 28782939.6750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29575417.9235; train_optim_loss: 29575417.9235; val_kl_reg_loss: 16098.8068; val_edge_recon_loss: 793325.9879; val_gene_expr_recon_loss: 28776208.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29585633.2258; val_optim_loss: 29585633.2258
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9677; val_auprc_score: 0.9921; val_best_acc_score: 0.9574; val_best_f1_score: 0.9753; train_kl_reg_loss: 17332.8708; train_edge_recon_loss: 773883.2681; train_gene_expr_recon_loss: 28776910.8029; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29568126.9415; train_optim_loss: 29568126.9415; val_kl_reg_loss: 16126.8022; val_edge_recon_loss: 771903.1250; val_gene_expr_recon_loss: 28785557.6129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29573587.5484; val_optim_loss: 29573587.5484
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9672; val_auprc_score: 0.9917; val_best_acc_score: 0.9556; val_best_f1_score: 0.9741; train_kl_reg_loss: 17274.1378; train_edge_recon_loss: 778256.3054; train_gene_expr_recon_loss: 28777247.9307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29572778.3632; train_optim_loss: 29572778.3632; val_kl_reg_loss: 16134.1387; val_edge_recon_loss: 797969.9913; val_gene_expr_recon_loss: 28785376.1935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29599480.3226; val_optim_loss: 29599480.3226
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9684; val_auprc_score: 0.9926; val_best_acc_score: 0.9571; val_best_f1_score: 0.9750; train_kl_reg_loss: 17193.0041; train_edge_recon_loss: 776800.0507; train_gene_expr_recon_loss: 28776769.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29570762.4014; train_optim_loss: 29570762.4014; val_kl_reg_loss: 16043.9224; val_edge_recon_loss: 782831.2648; val_gene_expr_recon_loss: 28779713.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29578589.1183; val_optim_loss: 29578589.1183
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9655; val_auprc_score: 0.9916; val_best_acc_score: 0.9562; val_best_f1_score: 0.9745; train_kl_reg_loss: 17072.1424; train_edge_recon_loss: 779645.5177; train_gene_expr_recon_loss: 28773854.0980; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29570571.7658; train_optim_loss: 29570571.7658; val_kl_reg_loss: 16141.4796; val_edge_recon_loss: 796970.2413; val_gene_expr_recon_loss: 28776542.8172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29589654.5806; val_optim_loss: 29589654.5806
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9649; val_auprc_score: 0.9921; val_best_acc_score: 0.9563; val_best_f1_score: 0.9746; train_kl_reg_loss: 16975.3547; train_edge_recon_loss: 776271.8359; train_gene_expr_recon_loss: 28773230.0119; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29566477.2115; train_optim_loss: 29566477.2115; val_kl_reg_loss: 16166.5289; val_edge_recon_loss: 777393.9180; val_gene_expr_recon_loss: 28777497.5484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29571058.0215; val_optim_loss: 29571058.0215
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9694; val_auprc_score: 0.9922; val_best_acc_score: 0.9582; val_best_f1_score: 0.9756; train_kl_reg_loss: 16887.0876; train_edge_recon_loss: 780125.7222; train_gene_expr_recon_loss: 28771561.1637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29568574.0287; train_optim_loss: 29568574.0287; val_kl_reg_loss: 16170.6417; val_edge_recon_loss: 780236.0810; val_gene_expr_recon_loss: 28784311.7634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29580718.5161; val_optim_loss: 29580718.5161
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9683; val_auprc_score: 0.9918; val_best_acc_score: 0.9569; val_best_f1_score: 0.9750; train_kl_reg_loss: 16798.9967; train_edge_recon_loss: 780370.1986; train_gene_expr_recon_loss: 28772290.4946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29569459.6941; train_optim_loss: 29569459.6941; val_kl_reg_loss: 16174.5585; val_edge_recon_loss: 782517.5941; val_gene_expr_recon_loss: 28775107.8280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29573800.0215; val_optim_loss: 29573800.0215
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9669; val_auprc_score: 0.9916; val_best_acc_score: 0.9585; val_best_f1_score: 0.9758; train_kl_reg_loss: 16717.4083; train_edge_recon_loss: 778845.7778; train_gene_expr_recon_loss: 28770384.8650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29565948.0191; train_optim_loss: 29565948.0191; val_kl_reg_loss: 16251.9983; val_edge_recon_loss: 789403.4530; val_gene_expr_recon_loss: 28789231.9140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29594887.2473; val_optim_loss: 29594887.2473
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9683; val_auprc_score: 0.9925; val_best_acc_score: 0.9589; val_best_f1_score: 0.9761; train_kl_reg_loss: 16633.9788; train_edge_recon_loss: 776377.0594; train_gene_expr_recon_loss: 28769098.1912; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29562109.2258; train_optim_loss: 29562109.2258; val_kl_reg_loss: 16172.7012; val_edge_recon_loss: 784824.6445; val_gene_expr_recon_loss: 28781756.5376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29582753.8280; val_optim_loss: 29582753.8280

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9704; val_auprc_score: 0.9929; val_best_acc_score: 0.9598; val_best_f1_score: 0.9765; train_kl_reg_loss: 16594.4719; train_edge_recon_loss: 777108.0775; train_gene_expr_recon_loss: 28766130.3250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29559832.9176; train_optim_loss: 29559832.9176; val_kl_reg_loss: 16167.2990; val_edge_recon_loss: 794537.3031; val_gene_expr_recon_loss: 28777244.2151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29587948.7527; val_optim_loss: 29587948.7527
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9661; val_auprc_score: 0.9911; val_best_acc_score: 0.9583; val_best_f1_score: 0.9758; train_kl_reg_loss: 16595.9728; train_edge_recon_loss: 774988.4930; train_gene_expr_recon_loss: 28768327.8614; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29559912.3011; train_optim_loss: 29559912.3011; val_kl_reg_loss: 16141.7134; val_edge_recon_loss: 783397.9308; val_gene_expr_recon_loss: 28766162.8387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29565702.3871; val_optim_loss: 29565702.3871
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9696; val_auprc_score: 0.9924; val_best_acc_score: 0.9602; val_best_f1_score: 0.9769; train_kl_reg_loss: 16580.6202; train_edge_recon_loss: 779699.4913; train_gene_expr_recon_loss: 28763459.3166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29559739.4480; train_optim_loss: 29559739.4480; val_kl_reg_loss: 16147.8581; val_edge_recon_loss: 767205.4036; val_gene_expr_recon_loss: 28763990.0215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29547343.2473; val_optim_loss: 29547343.2473
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9668; val_auprc_score: 0.9919; val_best_acc_score: 0.9579; val_best_f1_score: 0.9755; train_kl_reg_loss: 16573.6891; train_edge_recon_loss: 776752.7498; train_gene_expr_recon_loss: 28762137.7611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29555464.1744; train_optim_loss: 29555464.1744; val_kl_reg_loss: 16182.4754; val_edge_recon_loss: 788278.9046; val_gene_expr_recon_loss: 28772712.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29577173.7849; val_optim_loss: 29577173.7849
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9665; val_auprc_score: 0.9917; val_best_acc_score: 0.9591; val_best_f1_score: 0.9761; train_kl_reg_loss: 16561.1742; train_edge_recon_loss: 778956.2585; train_gene_expr_recon_loss: 28763361.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29558879.0060; train_optim_loss: 29558879.0060; val_kl_reg_loss: 16175.4246; val_edge_recon_loss: 778944.6176; val_gene_expr_recon_loss: 28781893.0753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29577013.0538; val_optim_loss: 29577013.0538
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9686; val_auprc_score: 0.9925; val_best_acc_score: 0.9597; val_best_f1_score: 0.9764; train_kl_reg_loss: 16567.5224; train_edge_recon_loss: 773271.9412; train_gene_expr_recon_loss: 28767176.7599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29557016.2461; train_optim_loss: 29557016.2461; val_kl_reg_loss: 16170.7800; val_edge_recon_loss: 794016.9886; val_gene_expr_recon_loss: 28764826.4946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29575014.3441; val_optim_loss: 29575014.3441
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9690; val_auprc_score: 0.9926; val_best_acc_score: 0.9596; val_best_f1_score: 0.9765; train_kl_reg_loss: 16548.5797; train_edge_recon_loss: 771442.5117; train_gene_expr_recon_loss: 28762507.7157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29550498.8029; train_optim_loss: 29550498.8029; val_kl_reg_loss: 16170.2442; val_edge_recon_loss: 762902.6485; val_gene_expr_recon_loss: 28778908.7527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29557981.5914; val_optim_loss: 29557981.5914

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9672; val_auprc_score: 0.9919; val_best_acc_score: 0.9568; val_best_f1_score: 0.9749; train_kl_reg_loss: 16564.0922; train_edge_recon_loss: 782407.4086; train_gene_expr_recon_loss: 28763966.9032; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29562938.4062; train_optim_loss: 29562938.4062; val_kl_reg_loss: 16146.9322; val_edge_recon_loss: 782540.1868; val_gene_expr_recon_loss: 28768229.3763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29566916.5376; val_optim_loss: 29566916.5376
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9673; val_auprc_score: 0.9921; val_best_acc_score: 0.9581; val_best_f1_score: 0.9757; train_kl_reg_loss: 16562.4967; train_edge_recon_loss: 772286.3794; train_gene_expr_recon_loss: 28763086.7001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29551935.6010; train_optim_loss: 29551935.6010; val_kl_reg_loss: 16174.8837; val_edge_recon_loss: 785201.7742; val_gene_expr_recon_loss: 28775218.2581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29576594.9892; val_optim_loss: 29576594.9892
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9671; val_auprc_score: 0.9916; val_best_acc_score: 0.9582; val_best_f1_score: 0.9757; train_kl_reg_loss: 16548.5464; train_edge_recon_loss: 776822.5570; train_gene_expr_recon_loss: 28762167.6105; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29555538.7121; train_optim_loss: 29555538.7121; val_kl_reg_loss: 16178.3335; val_edge_recon_loss: 780329.4953; val_gene_expr_recon_loss: 28769556.2151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29566064.0215; val_optim_loss: 29566064.0215
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9681; val_auprc_score: 0.9914; val_best_acc_score: 0.9588; val_best_f1_score: 0.9760; train_kl_reg_loss: 16561.5066; train_edge_recon_loss: 776060.7849; train_gene_expr_recon_loss: 28764707.7539; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29557330.0550; train_optim_loss: 29557330.0550; val_kl_reg_loss: 16191.1849; val_edge_recon_loss: 786732.0131; val_gene_expr_recon_loss: 28763502.6452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29566425.8495; val_optim_loss: 29566425.8495

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 81 min 58 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9675
val AUPRC score: 0.9922
val best accuracy score: 0.9576
val best F1 score: 0.9753
val target rna MSE score: 0.9188
val source rna MSE score: 0.3020
Val cat covariate0 mean sim diff: -0.0017

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
