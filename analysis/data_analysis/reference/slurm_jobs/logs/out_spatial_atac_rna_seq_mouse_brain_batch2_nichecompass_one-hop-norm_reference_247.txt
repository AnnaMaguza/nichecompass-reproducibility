[True]
Run timestamp: 10102023_111314_247.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_247']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6427; val_auprc_score: 0.6367; val_best_acc_score: 0.5062; val_best_f1_score: 0.6693; train_kl_reg_loss: 61175.9543; train_edge_recon_loss: 751706.2614; train_gene_expr_recon_loss: 23402107.4242; train_masked_gp_l1_reg_loss: 40538.7231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4014518.1364; train_chrom_access_recon_loss: 11524563.1667; train_global_loss: 39794609.9394; train_optim_loss: 39794609.9394; val_kl_reg_loss: 68653.0947; val_edge_recon_loss: 813034.2891; val_gene_expr_recon_loss: 21750947.5000; val_masked_gp_l1_reg_loss: 47672.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2680991.2500; val_chrom_access_recon_loss: 11029150.3750; val_global_loss: 36390448.0000; val_optim_loss: 36390448.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6830; val_auprc_score: 0.6742; val_best_acc_score: 0.5650; val_best_f1_score: 0.6857; train_kl_reg_loss: 84052.9426; train_edge_recon_loss: 751457.4867; train_gene_expr_recon_loss: 21306276.4848; train_masked_gp_l1_reg_loss: 47796.2250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1728961.5720; train_chrom_access_recon_loss: 11004149.3788; train_global_loss: 34922694.2424; train_optim_loss: 34922694.2424; val_kl_reg_loss: 86265.8467; val_edge_recon_loss: 812024.3359; val_gene_expr_recon_loss: 21128586.0000; val_masked_gp_l1_reg_loss: 47860.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1019950.8750; val_chrom_access_recon_loss: 10853583.5000; val_global_loss: 33948269.5000; val_optim_loss: 33948269.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7632; val_auprc_score: 0.7506; val_best_acc_score: 0.6024; val_best_f1_score: 0.7027; train_kl_reg_loss: 78308.0457; train_edge_recon_loss: 739000.0104; train_gene_expr_recon_loss: 21043922.6364; train_masked_gp_l1_reg_loss: 48262.0319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 706612.3504; train_chrom_access_recon_loss: 10920933.7727; train_global_loss: 33537038.9394; train_optim_loss: 33537038.9394; val_kl_reg_loss: 59925.5088; val_edge_recon_loss: 811749.8594; val_gene_expr_recon_loss: 21006921.2500; val_masked_gp_l1_reg_loss: 48786.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 485654.1875; val_chrom_access_recon_loss: 10817265.2500; val_global_loss: 33230301.7500; val_optim_loss: 33230301.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8196; val_auprc_score: 0.7998; val_best_acc_score: 0.7534; val_best_f1_score: 0.7641; train_kl_reg_loss: 71709.5236; train_edge_recon_loss: 732841.4915; train_gene_expr_recon_loss: 20894979.5758; train_masked_gp_l1_reg_loss: 49298.7176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 380776.7055; train_chrom_access_recon_loss: 10846303.6364; train_global_loss: 32975909.6061; train_optim_loss: 32975909.6061; val_kl_reg_loss: 68441.0557; val_edge_recon_loss: 807169.1250; val_gene_expr_recon_loss: 21034627.2500; val_masked_gp_l1_reg_loss: 49926.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 300181.6250; val_chrom_access_recon_loss: 10679282.1250; val_global_loss: 32939627.5000; val_optim_loss: 32939627.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8533; val_auprc_score: 0.8239; val_best_acc_score: 0.7638; val_best_f1_score: 0.7963; train_kl_reg_loss: 65898.6504; train_edge_recon_loss: 726435.9631; train_gene_expr_recon_loss: 20706788.6970; train_masked_gp_l1_reg_loss: 50539.6898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 258230.1482; train_chrom_access_recon_loss: 10775201.2879; train_global_loss: 32583094.3636; train_optim_loss: 32583094.3636; val_kl_reg_loss: 65103.0459; val_edge_recon_loss: 787923.4531; val_gene_expr_recon_loss: 20670024.0000; val_masked_gp_l1_reg_loss: 51334.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 224353.5938; val_chrom_access_recon_loss: 10689560.8750; val_global_loss: 32488299.5000; val_optim_loss: 32488299.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8516; val_auprc_score: 0.8092; val_best_acc_score: 0.7802; val_best_f1_score: 0.8064; train_kl_reg_loss: 61258.3971; train_edge_recon_loss: 712363.8996; train_gene_expr_recon_loss: 20550443.5152; train_masked_gp_l1_reg_loss: 52245.5822; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 202957.3397; train_chrom_access_recon_loss: 10713370.7273; train_global_loss: 32292639.5455; train_optim_loss: 32292639.5455; val_kl_reg_loss: 59202.3379; val_edge_recon_loss: 735193.1250; val_gene_expr_recon_loss: 20531606.0000; val_masked_gp_l1_reg_loss: 53308.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184243.6094; val_chrom_access_recon_loss: 10620250.3750; val_global_loss: 32183803.7500; val_optim_loss: 32183803.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8642; val_auprc_score: 0.8259; val_best_acc_score: 0.7926; val_best_f1_score: 0.8151; train_kl_reg_loss: 63645.4474; train_edge_recon_loss: 671912.4867; train_gene_expr_recon_loss: 20455551.8788; train_masked_gp_l1_reg_loss: 54075.3186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 168298.4505; train_chrom_access_recon_loss: 10669970.0000; train_global_loss: 32083453.6061; train_optim_loss: 32083453.6061; val_kl_reg_loss: 71444.2500; val_edge_recon_loss: 653124.2734; val_gene_expr_recon_loss: 20807057.2500; val_masked_gp_l1_reg_loss: 54998.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155500.7500; val_chrom_access_recon_loss: 10756304.0000; val_global_loss: 32498427.5000; val_optim_loss: 32498427.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8763; val_auprc_score: 0.8459; val_best_acc_score: 0.8015; val_best_f1_score: 0.8234; train_kl_reg_loss: 71452.2805; train_edge_recon_loss: 639617.8191; train_gene_expr_recon_loss: 20353719.3939; train_masked_gp_l1_reg_loss: 55814.4170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144472.4654; train_chrom_access_recon_loss: 10621939.3939; train_global_loss: 31887015.6667; train_optim_loss: 31887015.6667; val_kl_reg_loss: 70564.9424; val_edge_recon_loss: 638952.1953; val_gene_expr_recon_loss: 20495801.2500; val_masked_gp_l1_reg_loss: 56542.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134701.7500; val_chrom_access_recon_loss: 10705226.2500; val_global_loss: 32101788.7500; val_optim_loss: 32101788.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8799; val_auprc_score: 0.8467; val_best_acc_score: 0.8055; val_best_f1_score: 0.8295; train_kl_reg_loss: 71890.6258; train_edge_recon_loss: 626769.7992; train_gene_expr_recon_loss: 20256304.1212; train_masked_gp_l1_reg_loss: 57148.6826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127499.3014; train_chrom_access_recon_loss: 10582431.2273; train_global_loss: 31722043.5758; train_optim_loss: 31722043.5758; val_kl_reg_loss: 69494.5586; val_edge_recon_loss: 624125.5234; val_gene_expr_recon_loss: 20179070.7500; val_masked_gp_l1_reg_loss: 57796.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121132.3438; val_chrom_access_recon_loss: 10449911.0000; val_global_loss: 31501530.0000; val_optim_loss: 31501530.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8910; val_auprc_score: 0.8558; val_best_acc_score: 0.8143; val_best_f1_score: 0.8307; train_kl_reg_loss: 70583.2841; train_edge_recon_loss: 620137.9195; train_gene_expr_recon_loss: 20185390.5758; train_masked_gp_l1_reg_loss: 58403.3531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116084.7159; train_chrom_access_recon_loss: 10544966.5000; train_global_loss: 31595566.3333; train_optim_loss: 31595566.3333; val_kl_reg_loss: 69244.4180; val_edge_recon_loss: 618496.1562; val_gene_expr_recon_loss: 20073562.2500; val_masked_gp_l1_reg_loss: 59001.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111815.2188; val_chrom_access_recon_loss: 10393483.2500; val_global_loss: 31325604.2500; val_optim_loss: 31325604.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9050; val_auprc_score: 0.8781; val_best_acc_score: 0.8280; val_best_f1_score: 0.8416; train_kl_reg_loss: 69418.4154; train_edge_recon_loss: 613032.3854; train_gene_expr_recon_loss: 20107741.1818; train_masked_gp_l1_reg_loss: 59437.6963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108194.6319; train_chrom_access_recon_loss: 10501286.0000; train_global_loss: 31459110.4848; train_optim_loss: 31459110.4848; val_kl_reg_loss: 67983.1514; val_edge_recon_loss: 619646.8672; val_gene_expr_recon_loss: 20192449.5000; val_masked_gp_l1_reg_loss: 59981.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104173.1328; val_chrom_access_recon_loss: 10430491.8750; val_global_loss: 31474727.5000; val_optim_loss: 31474727.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9064; val_auprc_score: 0.8760; val_best_acc_score: 0.8388; val_best_f1_score: 0.8492; train_kl_reg_loss: 67824.0766; train_edge_recon_loss: 610312.0076; train_gene_expr_recon_loss: 20049095.2727; train_masked_gp_l1_reg_loss: 60425.2361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102017.6559; train_chrom_access_recon_loss: 10475834.6970; train_global_loss: 31365509.0909; train_optim_loss: 31365509.0909; val_kl_reg_loss: 65606.0288; val_edge_recon_loss: 610714.9219; val_gene_expr_recon_loss: 20041528.2500; val_masked_gp_l1_reg_loss: 60832.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100408.7969; val_chrom_access_recon_loss: 10353598.0000; val_global_loss: 31232687.5000; val_optim_loss: 31232687.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8951; val_auprc_score: 0.8621; val_best_acc_score: 0.8297; val_best_f1_score: 0.8403; train_kl_reg_loss: 67188.3813; train_edge_recon_loss: 604503.9062; train_gene_expr_recon_loss: 19965451.1212; train_masked_gp_l1_reg_loss: 61285.7084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98457.4000; train_chrom_access_recon_loss: 10432266.8636; train_global_loss: 31229153.2727; train_optim_loss: 31229153.2727; val_kl_reg_loss: 66439.8081; val_edge_recon_loss: 613379.6562; val_gene_expr_recon_loss: 19996768.5000; val_masked_gp_l1_reg_loss: 61706.0039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97287.2891; val_chrom_access_recon_loss: 10472116.1250; val_global_loss: 31307698.0000; val_optim_loss: 31307698.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9116; val_auprc_score: 0.8792; val_best_acc_score: 0.8428; val_best_f1_score: 0.8525; train_kl_reg_loss: 65691.0981; train_edge_recon_loss: 603691.4489; train_gene_expr_recon_loss: 19908797.4545; train_masked_gp_l1_reg_loss: 62108.0232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95972.4049; train_chrom_access_recon_loss: 10401253.2273; train_global_loss: 31137513.5758; train_optim_loss: 31137513.5758; val_kl_reg_loss: 64169.9722; val_edge_recon_loss: 608021.4453; val_gene_expr_recon_loss: 19694004.2500; val_masked_gp_l1_reg_loss: 62461.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94338.2891; val_chrom_access_recon_loss: 10232585.5000; val_global_loss: 30755580.7500; val_optim_loss: 30755580.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9084; val_auprc_score: 0.8800; val_best_acc_score: 0.8447; val_best_f1_score: 0.8546; train_kl_reg_loss: 65017.2158; train_edge_recon_loss: 599263.6941; train_gene_expr_recon_loss: 19833979.9394; train_masked_gp_l1_reg_loss: 62757.3488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93837.7617; train_chrom_access_recon_loss: 10361843.8485; train_global_loss: 31016699.9394; train_optim_loss: 31016699.9394; val_kl_reg_loss: 63616.3047; val_edge_recon_loss: 604223.9141; val_gene_expr_recon_loss: 20025422.2500; val_masked_gp_l1_reg_loss: 63161.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92868.1250; val_chrom_access_recon_loss: 10340842.1250; val_global_loss: 31190134.0000; val_optim_loss: 31190134.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9232; val_auprc_score: 0.9056; val_best_acc_score: 0.8544; val_best_f1_score: 0.8637; train_kl_reg_loss: 64604.4609; train_edge_recon_loss: 596509.1496; train_gene_expr_recon_loss: 19812632.5455; train_masked_gp_l1_reg_loss: 63481.9824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91964.5861; train_chrom_access_recon_loss: 10346212.6364; train_global_loss: 30975405.2727; train_optim_loss: 30975405.2727; val_kl_reg_loss: 64958.2241; val_edge_recon_loss: 595395.0078; val_gene_expr_recon_loss: 19913982.7500; val_masked_gp_l1_reg_loss: 63864.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90911.9766; val_chrom_access_recon_loss: 10268192.0000; val_global_loss: 30997304.0000; val_optim_loss: 30997304.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9164; val_auprc_score: 0.8980; val_best_acc_score: 0.8463; val_best_f1_score: 0.8598; train_kl_reg_loss: 63574.7926; train_edge_recon_loss: 596284.1828; train_gene_expr_recon_loss: 19732215.9394; train_masked_gp_l1_reg_loss: 64150.8017; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90182.1170; train_chrom_access_recon_loss: 10300790.0152; train_global_loss: 30847197.9394; train_optim_loss: 30847197.9394; val_kl_reg_loss: 63735.2607; val_edge_recon_loss: 601612.3672; val_gene_expr_recon_loss: 19710498.2500; val_masked_gp_l1_reg_loss: 64476.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89544.0859; val_chrom_access_recon_loss: 10244451.2500; val_global_loss: 30774317.2500; val_optim_loss: 30774317.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9258; val_auprc_score: 0.9033; val_best_acc_score: 0.8592; val_best_f1_score: 0.8670; train_kl_reg_loss: 62763.6483; train_edge_recon_loss: 592219.5881; train_gene_expr_recon_loss: 19682345.0909; train_masked_gp_l1_reg_loss: 64743.4748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88619.5189; train_chrom_access_recon_loss: 10273761.5909; train_global_loss: 30764452.9091; train_optim_loss: 30764452.9091; val_kl_reg_loss: 62095.5015; val_edge_recon_loss: 604140.0469; val_gene_expr_recon_loss: 19856371.5000; val_masked_gp_l1_reg_loss: 65088.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87827.3516; val_chrom_access_recon_loss: 10388532.1250; val_global_loss: 31064055.2500; val_optim_loss: 31064055.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9105; val_auprc_score: 0.8817; val_best_acc_score: 0.8469; val_best_f1_score: 0.8559; train_kl_reg_loss: 62368.2145; train_edge_recon_loss: 592842.4413; train_gene_expr_recon_loss: 19641369.1818; train_masked_gp_l1_reg_loss: 64581.5503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71896.3642; train_chrom_access_recon_loss: 10241018.0000; train_global_loss: 30674075.7273; train_optim_loss: 30674075.7273; val_kl_reg_loss: 63720.8350; val_edge_recon_loss: 603388.0312; val_gene_expr_recon_loss: 19648662.5000; val_masked_gp_l1_reg_loss: 64246.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66868.8359; val_chrom_access_recon_loss: 10215081.7500; val_global_loss: 30661967.2500; val_optim_loss: 30661967.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9206; val_auprc_score: 0.8997; val_best_acc_score: 0.8573; val_best_f1_score: 0.8655; train_kl_reg_loss: 63374.6290; train_edge_recon_loss: 592492.0445; train_gene_expr_recon_loss: 19631949.8182; train_masked_gp_l1_reg_loss: 64167.2304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66221.7011; train_chrom_access_recon_loss: 10235318.4545; train_global_loss: 30653523.6364; train_optim_loss: 30653523.6364; val_kl_reg_loss: 63382.8760; val_edge_recon_loss: 597226.5234; val_gene_expr_recon_loss: 19642907.7500; val_masked_gp_l1_reg_loss: 64121.6758; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65773.4297; val_chrom_access_recon_loss: 10218778.1250; val_global_loss: 30652191.5000; val_optim_loss: 30652191.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9140; val_auprc_score: 0.8896; val_best_acc_score: 0.8436; val_best_f1_score: 0.8543; train_kl_reg_loss: 63468.7325; train_edge_recon_loss: 591716.6913; train_gene_expr_recon_loss: 19621795.8485; train_masked_gp_l1_reg_loss: 64120.7280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65445.5192; train_chrom_access_recon_loss: 10231008.8030; train_global_loss: 30637556.4545; train_optim_loss: 30637556.4545; val_kl_reg_loss: 64000.3989; val_edge_recon_loss: 601889.3594; val_gene_expr_recon_loss: 19611276.0000; val_masked_gp_l1_reg_loss: 64117.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65219.1875; val_chrom_access_recon_loss: 10159679.6250; val_global_loss: 30566183.2500; val_optim_loss: 30566183.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9271; val_auprc_score: 0.9091; val_best_acc_score: 0.8568; val_best_f1_score: 0.8641; train_kl_reg_loss: 63659.1386; train_edge_recon_loss: 591627.2917; train_gene_expr_recon_loss: 19614693.0000; train_masked_gp_l1_reg_loss: 64122.3025; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64901.2444; train_chrom_access_recon_loss: 10230165.6364; train_global_loss: 30629168.5758; train_optim_loss: 30629168.5758; val_kl_reg_loss: 64216.5923; val_edge_recon_loss: 599224.1328; val_gene_expr_recon_loss: 19872861.7500; val_masked_gp_l1_reg_loss: 64131.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64722.0352; val_chrom_access_recon_loss: 10360258.8750; val_global_loss: 31025415.5000; val_optim_loss: 31025415.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9239; val_auprc_score: 0.9042; val_best_acc_score: 0.8573; val_best_f1_score: 0.8655; train_kl_reg_loss: 63607.1060; train_edge_recon_loss: 591537.1799; train_gene_expr_recon_loss: 19619080.4848; train_masked_gp_l1_reg_loss: 64143.5424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64483.0987; train_chrom_access_recon_loss: 10233222.9394; train_global_loss: 30636074.2727; train_optim_loss: 30636074.2727; val_kl_reg_loss: 64089.6001; val_edge_recon_loss: 595703.4219; val_gene_expr_recon_loss: 19552945.5000; val_masked_gp_l1_reg_loss: 64168.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64316.1523; val_chrom_access_recon_loss: 10160941.6250; val_global_loss: 30502164.0000; val_optim_loss: 30502164.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9250; val_auprc_score: 0.9061; val_best_acc_score: 0.8600; val_best_f1_score: 0.8672; train_kl_reg_loss: 63688.8076; train_edge_recon_loss: 588703.1866; train_gene_expr_recon_loss: 19619205.7879; train_masked_gp_l1_reg_loss: 64179.3460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64047.2571; train_chrom_access_recon_loss: 10229246.7273; train_global_loss: 30629071.2121; train_optim_loss: 30629071.2121; val_kl_reg_loss: 64235.3047; val_edge_recon_loss: 593137.6875; val_gene_expr_recon_loss: 19921129.5000; val_masked_gp_l1_reg_loss: 64202.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63888.1523; val_chrom_access_recon_loss: 10220362.7500; val_global_loss: 30926955.2500; val_optim_loss: 30926955.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9219; val_auprc_score: 0.8982; val_best_acc_score: 0.8560; val_best_f1_score: 0.8657; train_kl_reg_loss: 63770.3246; train_edge_recon_loss: 590358.8144; train_gene_expr_recon_loss: 19598999.3939; train_masked_gp_l1_reg_loss: 64223.2753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63610.5481; train_chrom_access_recon_loss: 10220349.5455; train_global_loss: 30601311.8788; train_optim_loss: 30601311.8788; val_kl_reg_loss: 64076.6738; val_edge_recon_loss: 597230.5469; val_gene_expr_recon_loss: 19574340.5000; val_masked_gp_l1_reg_loss: 64247.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63449.6602; val_chrom_access_recon_loss: 10117837.7500; val_global_loss: 30481183.7500; val_optim_loss: 30481183.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9231; val_auprc_score: 0.9008; val_best_acc_score: 0.8536; val_best_f1_score: 0.8667; train_kl_reg_loss: 63010.0777; train_edge_recon_loss: 740016.4366; train_gene_expr_recon_loss: 18226305.4242; train_masked_gp_l1_reg_loss: 64277.3952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62340.0109; train_chrom_access_recon_loss: 10283920.9697; train_global_loss: 29439870.2727; train_optim_loss: 29439870.2727; val_kl_reg_loss: 26634.5823; val_edge_recon_loss: 765893.7500; val_gene_expr_recon_loss: 17687095.6250; val_masked_gp_l1_reg_loss: 64243.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61679.2930; val_chrom_access_recon_loss: 9546473.3750; val_global_loss: 28152021.5000; val_optim_loss: 28152021.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9192; val_auprc_score: 0.9026; val_best_acc_score: 0.8517; val_best_f1_score: 0.8594; train_kl_reg_loss: 66872.7241; train_edge_recon_loss: 719947.5294; train_gene_expr_recon_loss: 17905907.1818; train_masked_gp_l1_reg_loss: 64063.7428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61160.7422; train_chrom_access_recon_loss: 9565501.5758; train_global_loss: 28383453.4242; train_optim_loss: 28383453.4242; val_kl_reg_loss: 29230.2329; val_edge_recon_loss: 780300.7812; val_gene_expr_recon_loss: 17956074.5000; val_masked_gp_l1_reg_loss: 63857.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60708.7656; val_chrom_access_recon_loss: 9461582.1250; val_global_loss: 28351753.5000; val_optim_loss: 28351753.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9184; val_auprc_score: 0.9013; val_best_acc_score: 0.8323; val_best_f1_score: 0.8500; train_kl_reg_loss: 60946.9805; train_edge_recon_loss: 726322.2017; train_gene_expr_recon_loss: 17857635.8788; train_masked_gp_l1_reg_loss: 63641.2490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60465.7624; train_chrom_access_recon_loss: 9476251.1515; train_global_loss: 28245263.1515; train_optim_loss: 28245263.1515; val_kl_reg_loss: 30441.3611; val_edge_recon_loss: 789445.0234; val_gene_expr_recon_loss: 17879586.2500; val_masked_gp_l1_reg_loss: 63434.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60248.5469; val_chrom_access_recon_loss: 9350191.8750; val_global_loss: 28173346.0000; val_optim_loss: 28173346.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9208; val_auprc_score: 0.9025; val_best_acc_score: 0.8358; val_best_f1_score: 0.8517; train_kl_reg_loss: 51832.0315; train_edge_recon_loss: 734610.0256; train_gene_expr_recon_loss: 17858008.8485; train_masked_gp_l1_reg_loss: 63241.9007; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60137.3482; train_chrom_access_recon_loss: 9458793.1818; train_global_loss: 28226623.3939; train_optim_loss: 28226623.3939; val_kl_reg_loss: 23419.9109; val_edge_recon_loss: 786750.8516; val_gene_expr_recon_loss: 17795840.7500; val_masked_gp_l1_reg_loss: 63060.6680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60015.4219; val_chrom_access_recon_loss: 9350342.0000; val_global_loss: 28079429.7500; val_optim_loss: 28079429.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9158; val_auprc_score: 0.8935; val_best_acc_score: 0.8409; val_best_f1_score: 0.8550; train_kl_reg_loss: 50316.3980; train_edge_recon_loss: 731962.9896; train_gene_expr_recon_loss: 17838527.4545; train_masked_gp_l1_reg_loss: 62859.7412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59828.7995; train_chrom_access_recon_loss: 9446496.1818; train_global_loss: 28189991.7273; train_optim_loss: 28189991.7273; val_kl_reg_loss: 25366.5461; val_edge_recon_loss: 786099.9297; val_gene_expr_recon_loss: 17726348.6250; val_masked_gp_l1_reg_loss: 62641.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59629.0273; val_chrom_access_recon_loss: 9313074.0000; val_global_loss: 27973161.0000; val_optim_loss: 27973161.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9124; val_auprc_score: 0.8899; val_best_acc_score: 0.8377; val_best_f1_score: 0.8522; train_kl_reg_loss: 48007.5449; train_edge_recon_loss: 728870.6875; train_gene_expr_recon_loss: 17838460.7879; train_masked_gp_l1_reg_loss: 62449.1954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59465.0158; train_chrom_access_recon_loss: 9432308.8030; train_global_loss: 28169562.1818; train_optim_loss: 28169562.1818; val_kl_reg_loss: 27800.3337; val_edge_recon_loss: 784476.3594; val_gene_expr_recon_loss: 17843195.0000; val_masked_gp_l1_reg_loss: 62267.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59323.5547; val_chrom_access_recon_loss: 9375002.7500; val_global_loss: 28152066.5000; val_optim_loss: 28152066.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9182; val_auprc_score: 0.8968; val_best_acc_score: 0.8428; val_best_f1_score: 0.8558; train_kl_reg_loss: 47245.6065; train_edge_recon_loss: 726963.6326; train_gene_expr_recon_loss: 17826741.2121; train_masked_gp_l1_reg_loss: 62051.9892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59093.7063; train_chrom_access_recon_loss: 9420998.0909; train_global_loss: 28143094.3333; train_optim_loss: 28143094.3333; val_kl_reg_loss: 25783.8860; val_edge_recon_loss: 784694.0938; val_gene_expr_recon_loss: 17884436.0000; val_masked_gp_l1_reg_loss: 61832.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58908.7617; val_chrom_access_recon_loss: 9364173.7500; val_global_loss: 28179827.2500; val_optim_loss: 28179827.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9079; val_auprc_score: 0.8820; val_best_acc_score: 0.8385; val_best_f1_score: 0.8521; train_kl_reg_loss: 45559.3964; train_edge_recon_loss: 726232.9706; train_gene_expr_recon_loss: 17813840.9697; train_masked_gp_l1_reg_loss: 61622.8039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58740.3335; train_chrom_access_recon_loss: 9421586.1364; train_global_loss: 28127582.3636; train_optim_loss: 28127582.3636; val_kl_reg_loss: 27110.7197; val_edge_recon_loss: 784293.5156; val_gene_expr_recon_loss: 17686710.3750; val_masked_gp_l1_reg_loss: 61403.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58576.5625; val_chrom_access_recon_loss: 9325831.8750; val_global_loss: 27943926.7500; val_optim_loss: 27943926.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9125; val_auprc_score: 0.8841; val_best_acc_score: 0.8426; val_best_f1_score: 0.8544; train_kl_reg_loss: 44557.8333; train_edge_recon_loss: 725827.4167; train_gene_expr_recon_loss: 17820519.1818; train_masked_gp_l1_reg_loss: 61183.3884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58388.8147; train_chrom_access_recon_loss: 9421584.0758; train_global_loss: 28132060.7576; train_optim_loss: 28132060.7576; val_kl_reg_loss: 26196.7837; val_edge_recon_loss: 781865.7500; val_gene_expr_recon_loss: 17745615.5000; val_masked_gp_l1_reg_loss: 60960.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58205.0820; val_chrom_access_recon_loss: 9326530.6250; val_global_loss: 27999374.5000; val_optim_loss: 27999374.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9128; val_auprc_score: 0.8871; val_best_acc_score: 0.8415; val_best_f1_score: 0.8532; train_kl_reg_loss: 44540.4884; train_edge_recon_loss: 722504.0360; train_gene_expr_recon_loss: 17807271.2121; train_masked_gp_l1_reg_loss: 60750.0114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58034.6661; train_chrom_access_recon_loss: 9419486.2576; train_global_loss: 28112586.6667; train_optim_loss: 28112586.6667; val_kl_reg_loss: 24941.9648; val_edge_recon_loss: 780398.1641; val_gene_expr_recon_loss: 17950673.5000; val_masked_gp_l1_reg_loss: 60522.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57848.7500; val_chrom_access_recon_loss: 9418588.7500; val_global_loss: 28292972.2500; val_optim_loss: 28292972.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9113; val_auprc_score: 0.8899; val_best_acc_score: 0.8434; val_best_f1_score: 0.8533; train_kl_reg_loss: 44377.2881; train_edge_recon_loss: 721799.8400; train_gene_expr_recon_loss: 17794602.7879; train_masked_gp_l1_reg_loss: 60306.4103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57663.4377; train_chrom_access_recon_loss: 9407387.6818; train_global_loss: 28086137.3333; train_optim_loss: 28086137.3333; val_kl_reg_loss: 26960.6643; val_edge_recon_loss: 777308.6719; val_gene_expr_recon_loss: 17811616.2500; val_masked_gp_l1_reg_loss: 60085.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57470.6133; val_chrom_access_recon_loss: 9354996.0000; val_global_loss: 28088438.0000; val_optim_loss: 28088438.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9107; val_auprc_score: 0.8902; val_best_acc_score: 0.8423; val_best_f1_score: 0.8516; train_kl_reg_loss: 42607.7008; train_edge_recon_loss: 720807.4792; train_gene_expr_recon_loss: 17787136.5152; train_masked_gp_l1_reg_loss: 59876.0157; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57357.5517; train_chrom_access_recon_loss: 9407579.8788; train_global_loss: 28075364.9697; train_optim_loss: 28075364.9697; val_kl_reg_loss: 27609.9968; val_edge_recon_loss: 778051.8516; val_gene_expr_recon_loss: 17642517.7500; val_masked_gp_l1_reg_loss: 59673.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57169.0000; val_chrom_access_recon_loss: 9345691.1250; val_global_loss: 27910714.0000; val_optim_loss: 27910714.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9109; val_auprc_score: 0.8902; val_best_acc_score: 0.8420; val_best_f1_score: 0.8504; train_kl_reg_loss: 42762.7334; train_edge_recon_loss: 718634.8258; train_gene_expr_recon_loss: 17774176.2424; train_masked_gp_l1_reg_loss: 59462.1984; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57000.0903; train_chrom_access_recon_loss: 9398110.8030; train_global_loss: 28050146.6061; train_optim_loss: 28050146.6061; val_kl_reg_loss: 27495.3875; val_edge_recon_loss: 776272.8594; val_gene_expr_recon_loss: 17892414.7500; val_masked_gp_l1_reg_loss: 59230.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56814.3203; val_chrom_access_recon_loss: 9363867.5000; val_global_loss: 28176094.7500; val_optim_loss: 28176094.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9121; val_auprc_score: 0.8880; val_best_acc_score: 0.8431; val_best_f1_score: 0.8511; train_kl_reg_loss: 40962.5511; train_edge_recon_loss: 719251.0445; train_gene_expr_recon_loss: 17775996.2727; train_masked_gp_l1_reg_loss: 59024.8937; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56677.9988; train_chrom_access_recon_loss: 9398028.3939; train_global_loss: 28049941.2727; train_optim_loss: 28049941.2727; val_kl_reg_loss: 24360.7083; val_edge_recon_loss: 774069.0547; val_gene_expr_recon_loss: 17848360.5000; val_masked_gp_l1_reg_loss: 58815.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56607.5703; val_chrom_access_recon_loss: 9298188.3750; val_global_loss: 28060402.0000; val_optim_loss: 28060402.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9123; val_auprc_score: 0.8882; val_best_acc_score: 0.8420; val_best_f1_score: 0.8494; train_kl_reg_loss: 40506.4044; train_edge_recon_loss: 719807.8996; train_gene_expr_recon_loss: 17775970.7879; train_masked_gp_l1_reg_loss: 58604.4578; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56479.9368; train_chrom_access_recon_loss: 9394642.1818; train_global_loss: 28046011.6061; train_optim_loss: 28046011.6061; val_kl_reg_loss: 27287.4619; val_edge_recon_loss: 774024.5156; val_gene_expr_recon_loss: 17846382.5000; val_masked_gp_l1_reg_loss: 58391.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56346.5039; val_chrom_access_recon_loss: 9286351.8750; val_global_loss: 28048784.5000; val_optim_loss: 28048784.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9045; val_auprc_score: 0.8800; val_best_acc_score: 0.8321; val_best_f1_score: 0.8406; train_kl_reg_loss: 41464.2974; train_edge_recon_loss: 715218.3106; train_gene_expr_recon_loss: 17753201.0909; train_masked_gp_l1_reg_loss: 58164.7562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56225.3851; train_chrom_access_recon_loss: 9383464.2727; train_global_loss: 28007737.9394; train_optim_loss: 28007737.9394; val_kl_reg_loss: 27918.0144; val_edge_recon_loss: 773159.5469; val_gene_expr_recon_loss: 18006881.0000; val_masked_gp_l1_reg_loss: 57939.4336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56064.5078; val_chrom_access_recon_loss: 9454415.6250; val_global_loss: 28376378.0000; val_optim_loss: 28376378.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9045; val_auprc_score: 0.8741; val_best_acc_score: 0.8353; val_best_f1_score: 0.8429; train_kl_reg_loss: 41204.1721; train_edge_recon_loss: 715076.6316; train_gene_expr_recon_loss: 17737918.1515; train_masked_gp_l1_reg_loss: 57895.9859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55192.8578; train_chrom_access_recon_loss: 9376895.2121; train_global_loss: 27984183.0000; train_optim_loss: 27984183.0000; val_kl_reg_loss: 27353.8752; val_edge_recon_loss: 771110.4688; val_gene_expr_recon_loss: 17829602.5000; val_masked_gp_l1_reg_loss: 57860.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55004.8008; val_chrom_access_recon_loss: 9350531.3750; val_global_loss: 28091462.2500; val_optim_loss: 28091462.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8971; val_auprc_score: 0.8700; val_best_acc_score: 0.8216; val_best_f1_score: 0.8318; train_kl_reg_loss: 40876.9081; train_edge_recon_loss: 715889.4233; train_gene_expr_recon_loss: 17743496.2121; train_masked_gp_l1_reg_loss: 57832.1936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54971.7320; train_chrom_access_recon_loss: 9386009.1364; train_global_loss: 27999075.5455; train_optim_loss: 27999075.5455; val_kl_reg_loss: 27068.1208; val_edge_recon_loss: 773484.2422; val_gene_expr_recon_loss: 17897774.7500; val_masked_gp_l1_reg_loss: 57803.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54940.7422; val_chrom_access_recon_loss: 9322823.8750; val_global_loss: 28133894.7500; val_optim_loss: 28133894.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9109; val_auprc_score: 0.8859; val_best_acc_score: 0.8391; val_best_f1_score: 0.8458; train_kl_reg_loss: 40473.6973; train_edge_recon_loss: 715965.2888; train_gene_expr_recon_loss: 17744353.3939; train_masked_gp_l1_reg_loss: 57777.0091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54912.0431; train_chrom_access_recon_loss: 9377836.3636; train_global_loss: 27991317.7273; train_optim_loss: 27991317.7273; val_kl_reg_loss: 26941.0876; val_edge_recon_loss: 772365.6641; val_gene_expr_recon_loss: 17746223.2500; val_masked_gp_l1_reg_loss: 57750.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54888.0039; val_chrom_access_recon_loss: 9301774.6250; val_global_loss: 27959942.5000; val_optim_loss: 27959942.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9127; val_auprc_score: 0.8872; val_best_acc_score: 0.8385; val_best_f1_score: 0.8470; train_kl_reg_loss: 40548.9376; train_edge_recon_loss: 715837.5975; train_gene_expr_recon_loss: 17745649.0909; train_masked_gp_l1_reg_loss: 57725.0038; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54865.2605; train_chrom_access_recon_loss: 9380519.4848; train_global_loss: 27995145.4545; train_optim_loss: 27995145.4545; val_kl_reg_loss: 26963.7734; val_edge_recon_loss: 769869.3359; val_gene_expr_recon_loss: 17732008.5000; val_masked_gp_l1_reg_loss: 57698.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54841.6250; val_chrom_access_recon_loss: 9281553.3750; val_global_loss: 27922935.0000; val_optim_loss: 27922935.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 34 sec.
Using best model state, which was in epoch 37.

--- MODEL EVALUATION ---
val AUROC score: 0.9094
val AUPRC score: 0.8873
val best accuracy score: 0.8361
val best F1 score: 0.8467
val target rna MSE score: 3.0967
val source rna MSE score: 1.4373
val target atac MSE score: 0.3178
val source atac MSE score: 0.1377
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
