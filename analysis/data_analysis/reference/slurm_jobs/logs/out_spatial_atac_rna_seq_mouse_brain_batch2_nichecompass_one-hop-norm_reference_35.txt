[True]
Run timestamp: 09102023_210119_35.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_35']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6713; val_auprc_score: 0.6464; val_best_acc_score: 0.5110; val_best_f1_score: 0.6706; train_kl_reg_loss: 45221.4025; train_edge_recon_loss: 3498472.7462; train_gene_expr_recon_loss: 13990855.4697; train_masked_gp_l1_reg_loss: 32000.3155; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3618713.5246; train_chrom_access_recon_loss: 993886.0009; train_global_loss: 22179149.2727; train_optim_loss: 22179149.2727; val_kl_reg_loss: 90850.6660; val_edge_recon_loss: 4064492.1875; val_gene_expr_recon_loss: 13083976.7500; val_masked_gp_l1_reg_loss: 37643.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1981511.3750; val_chrom_access_recon_loss: 966754.2812; val_global_loss: 20225230.0000; val_optim_loss: 20225230.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6916; val_auprc_score: 0.6703; val_best_acc_score: 0.5970; val_best_f1_score: 0.6943; train_kl_reg_loss: 84354.2873; train_edge_recon_loss: 3510439.2538; train_gene_expr_recon_loss: 12827008.3788; train_masked_gp_l1_reg_loss: 39381.5467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1068136.3589; train_chrom_access_recon_loss: 944589.0956; train_global_loss: 18473909.0000; train_optim_loss: 18473909.0000; val_kl_reg_loss: 84834.9609; val_edge_recon_loss: 4058051.0938; val_gene_expr_recon_loss: 12807727.7500; val_masked_gp_l1_reg_loss: 41109.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 509031.1562; val_chrom_access_recon_loss: 954345.1250; val_global_loss: 18455101.0000; val_optim_loss: 18455101.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7429; val_auprc_score: 0.7181; val_best_acc_score: 0.6545; val_best_f1_score: 0.7181; train_kl_reg_loss: 76605.1915; train_edge_recon_loss: 3500903.7121; train_gene_expr_recon_loss: 12690976.7121; train_masked_gp_l1_reg_loss: 42563.1326; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 338821.5291; train_chrom_access_recon_loss: 936468.5606; train_global_loss: 17586339.0909; train_optim_loss: 17586339.0909; val_kl_reg_loss: 65097.0723; val_edge_recon_loss: 3972890.8438; val_gene_expr_recon_loss: 12768328.3750; val_masked_gp_l1_reg_loss: 44108.9570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230888.8594; val_chrom_access_recon_loss: 944784.0781; val_global_loss: 18026097.2500; val_optim_loss: 18026097.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7961; val_auprc_score: 0.7876; val_best_acc_score: 0.7098; val_best_f1_score: 0.7463; train_kl_reg_loss: 57031.7740; train_edge_recon_loss: 3366336.3636; train_gene_expr_recon_loss: 12615261.5303; train_masked_gp_l1_reg_loss: 46036.5502; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 188442.6165; train_chrom_access_recon_loss: 931986.6610; train_global_loss: 17205095.6970; train_optim_loss: 17205095.6970; val_kl_reg_loss: 71513.6572; val_edge_recon_loss: 3255479.1562; val_gene_expr_recon_loss: 12675392.1250; val_masked_gp_l1_reg_loss: 48428.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158390.6094; val_chrom_access_recon_loss: 944042.0859; val_global_loss: 17153245.8750; val_optim_loss: 17153245.8750
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8669; val_auprc_score: 0.8428; val_best_acc_score: 0.7915; val_best_f1_score: 0.8114; train_kl_reg_loss: 78127.2798; train_edge_recon_loss: 3043731.7841; train_gene_expr_recon_loss: 12560029.7121; train_masked_gp_l1_reg_loss: 50556.4248; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 140889.7612; train_chrom_access_recon_loss: 928105.4347; train_global_loss: 16801440.4848; train_optim_loss: 16801440.4848; val_kl_reg_loss: 86907.3916; val_edge_recon_loss: 2953171.2812; val_gene_expr_recon_loss: 12584379.8750; val_masked_gp_l1_reg_loss: 52804.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129971.3047; val_chrom_access_recon_loss: 934148.8672; val_global_loss: 16741383.5000; val_optim_loss: 16741383.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8856; val_auprc_score: 0.8482; val_best_acc_score: 0.8192; val_best_f1_score: 0.8341; train_kl_reg_loss: 95459.8279; train_edge_recon_loss: 2862322.3333; train_gene_expr_recon_loss: 12453784.1818; train_masked_gp_l1_reg_loss: 54717.3887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121690.8442; train_chrom_access_recon_loss: 922865.9119; train_global_loss: 16510840.4091; train_optim_loss: 16510840.4091; val_kl_reg_loss: 99520.4229; val_edge_recon_loss: 2894683.4688; val_gene_expr_recon_loss: 12544933.0000; val_masked_gp_l1_reg_loss: 56447.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114452.2734; val_chrom_access_recon_loss: 933498.1328; val_global_loss: 16643533.7500; val_optim_loss: 16643533.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8963; val_auprc_score: 0.8631; val_best_acc_score: 0.8318; val_best_f1_score: 0.8434; train_kl_reg_loss: 96479.9660; train_edge_recon_loss: 2834139.3030; train_gene_expr_recon_loss: 12376503.8030; train_masked_gp_l1_reg_loss: 57641.0866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108324.7789; train_chrom_access_recon_loss: 918454.5445; train_global_loss: 16391543.5758; train_optim_loss: 16391543.5758; val_kl_reg_loss: 98335.5312; val_edge_recon_loss: 2862271.2188; val_gene_expr_recon_loss: 12449243.7500; val_masked_gp_l1_reg_loss: 58814.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104535.8359; val_chrom_access_recon_loss: 927908.5938; val_global_loss: 16501108.8750; val_optim_loss: 16501108.8750
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9107; val_auprc_score: 0.8776; val_best_acc_score: 0.8512; val_best_f1_score: 0.8601; train_kl_reg_loss: 95904.7204; train_edge_recon_loss: 2813355.6742; train_gene_expr_recon_loss: 12303324.1970; train_masked_gp_l1_reg_loss: 59763.9386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100030.7231; train_chrom_access_recon_loss: 913360.8902; train_global_loss: 16285740.1515; train_optim_loss: 16285740.1515; val_kl_reg_loss: 99669.5039; val_edge_recon_loss: 2807329.0625; val_gene_expr_recon_loss: 12399997.3750; val_masked_gp_l1_reg_loss: 60871.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96605.3438; val_chrom_access_recon_loss: 921958.5859; val_global_loss: 16386431.6250; val_optim_loss: 16386431.6250
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9123; val_auprc_score: 0.8858; val_best_acc_score: 0.8420; val_best_f1_score: 0.8562; train_kl_reg_loss: 94691.9561; train_edge_recon_loss: 2795152.3636; train_gene_expr_recon_loss: 12250547.2879; train_masked_gp_l1_reg_loss: 61719.6228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93472.1529; train_chrom_access_recon_loss: 910116.0748; train_global_loss: 16205699.4697; train_optim_loss: 16205699.4697; val_kl_reg_loss: 91847.0908; val_edge_recon_loss: 2800307.3438; val_gene_expr_recon_loss: 12187319.8750; val_masked_gp_l1_reg_loss: 62606.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90956.8750; val_chrom_access_recon_loss: 911294.8047; val_global_loss: 16144332.1250; val_optim_loss: 16144332.1250
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9047; val_auprc_score: 0.8736; val_best_acc_score: 0.8426; val_best_f1_score: 0.8534; train_kl_reg_loss: 93229.5650; train_edge_recon_loss: 2787687.9356; train_gene_expr_recon_loss: 12189043.6970; train_masked_gp_l1_reg_loss: 63326.1280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88543.3896; train_chrom_access_recon_loss: 907059.3731; train_global_loss: 16128890.1364; train_optim_loss: 16128890.1364; val_kl_reg_loss: 90893.0459; val_edge_recon_loss: 2810164.1250; val_gene_expr_recon_loss: 12209334.3750; val_masked_gp_l1_reg_loss: 64020.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87245.6016; val_chrom_access_recon_loss: 924952.1172; val_global_loss: 16186610.7500; val_optim_loss: 16186610.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9084; val_auprc_score: 0.8810; val_best_acc_score: 0.8385; val_best_f1_score: 0.8478; train_kl_reg_loss: 89805.5806; train_edge_recon_loss: 2792960.2273; train_gene_expr_recon_loss: 12143844.8030; train_masked_gp_l1_reg_loss: 64701.3433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85447.4259; train_chrom_access_recon_loss: 903670.8409; train_global_loss: 16080430.2273; train_optim_loss: 16080430.2273; val_kl_reg_loss: 88013.4336; val_edge_recon_loss: 2853486.2188; val_gene_expr_recon_loss: 12172686.5000; val_masked_gp_l1_reg_loss: 65339.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84139.6016; val_chrom_access_recon_loss: 906708.0703; val_global_loss: 16170373.2500; val_optim_loss: 16170373.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9174; val_auprc_score: 0.8856; val_best_acc_score: 0.8581; val_best_f1_score: 0.8671; train_kl_reg_loss: 86795.9607; train_edge_recon_loss: 2783903.0795; train_gene_expr_recon_loss: 12098547.5000; train_masked_gp_l1_reg_loss: 66030.9760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82901.3408; train_chrom_access_recon_loss: 901243.5256; train_global_loss: 16019422.3636; train_optim_loss: 16019422.3636; val_kl_reg_loss: 84784.6533; val_edge_recon_loss: 2790737.2188; val_gene_expr_recon_loss: 12035050.2500; val_masked_gp_l1_reg_loss: 66651.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81629.2891; val_chrom_access_recon_loss: 902497.8047; val_global_loss: 15961349.8750; val_optim_loss: 15961349.8750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9131; val_auprc_score: 0.8821; val_best_acc_score: 0.8603; val_best_f1_score: 0.8677; train_kl_reg_loss: 84872.3103; train_edge_recon_loss: 2786163.7197; train_gene_expr_recon_loss: 12059315.8788; train_masked_gp_l1_reg_loss: 67133.7035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80561.8005; train_chrom_access_recon_loss: 898008.5758; train_global_loss: 15976055.8939; train_optim_loss: 15976055.8939; val_kl_reg_loss: 85401.7295; val_edge_recon_loss: 2795952.9375; val_gene_expr_recon_loss: 12061137.1250; val_masked_gp_l1_reg_loss: 67800.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80430.4531; val_chrom_access_recon_loss: 897959.9375; val_global_loss: 15988682.0000; val_optim_loss: 15988682.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9113; val_auprc_score: 0.8812; val_best_acc_score: 0.8528; val_best_f1_score: 0.8613; train_kl_reg_loss: 82901.4732; train_edge_recon_loss: 2779644.4129; train_gene_expr_recon_loss: 12020324.3788; train_masked_gp_l1_reg_loss: 68181.9680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79304.2401; train_chrom_access_recon_loss: 896037.3267; train_global_loss: 15926393.7424; train_optim_loss: 15926393.7424; val_kl_reg_loss: 80862.6299; val_edge_recon_loss: 2811831.0000; val_gene_expr_recon_loss: 12050654.2500; val_masked_gp_l1_reg_loss: 68627.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77798.5625; val_chrom_access_recon_loss: 906805.9531; val_global_loss: 15996579.7500; val_optim_loss: 15996579.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9110; val_auprc_score: 0.8822; val_best_acc_score: 0.8509; val_best_f1_score: 0.8604; train_kl_reg_loss: 80793.1521; train_edge_recon_loss: 2760326.6515; train_gene_expr_recon_loss: 11974963.1364; train_masked_gp_l1_reg_loss: 69156.7383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77330.7402; train_chrom_access_recon_loss: 892880.9744; train_global_loss: 15855451.2273; train_optim_loss: 15855451.2273; val_kl_reg_loss: 79946.1699; val_edge_recon_loss: 2820042.2500; val_gene_expr_recon_loss: 12087155.5000; val_masked_gp_l1_reg_loss: 69729.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77035.3906; val_chrom_access_recon_loss: 902387.0391; val_global_loss: 16036296.0000; val_optim_loss: 16036296.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9209; val_auprc_score: 0.8950; val_best_acc_score: 0.8614; val_best_f1_score: 0.8690; train_kl_reg_loss: 81891.9878; train_edge_recon_loss: 2752671.8258; train_gene_expr_recon_loss: 11941028.2879; train_masked_gp_l1_reg_loss: 70145.1315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76072.2495; train_chrom_access_recon_loss: 889339.7576; train_global_loss: 15811149.3182; train_optim_loss: 15811149.3182; val_kl_reg_loss: 84098.5557; val_edge_recon_loss: 2772055.1250; val_gene_expr_recon_loss: 11931422.3750; val_masked_gp_l1_reg_loss: 70559.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75714.6953; val_chrom_access_recon_loss: 899618.4375; val_global_loss: 15833468.3750; val_optim_loss: 15833468.3750
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9201; val_auprc_score: 0.8912; val_best_acc_score: 0.8576; val_best_f1_score: 0.8659; train_kl_reg_loss: 79692.7060; train_edge_recon_loss: 2753145.3561; train_gene_expr_recon_loss: 11902725.2576; train_masked_gp_l1_reg_loss: 71000.2440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75158.9394; train_chrom_access_recon_loss: 887404.5862; train_global_loss: 15769127.0606; train_optim_loss: 15769127.0606; val_kl_reg_loss: 78503.6924; val_edge_recon_loss: 2782525.8438; val_gene_expr_recon_loss: 12023929.3750; val_masked_gp_l1_reg_loss: 71368.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74444.5859; val_chrom_access_recon_loss: 902115.4141; val_global_loss: 15932888.1250; val_optim_loss: 15932888.1250
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9231; val_auprc_score: 0.8997; val_best_acc_score: 0.8584; val_best_f1_score: 0.8672; train_kl_reg_loss: 78688.8390; train_edge_recon_loss: 2750370.3977; train_gene_expr_recon_loss: 11882517.3636; train_masked_gp_l1_reg_loss: 71764.6880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74069.3189; train_chrom_access_recon_loss: 886682.2131; train_global_loss: 15744092.7576; train_optim_loss: 15744092.7576; val_kl_reg_loss: 78359.4980; val_edge_recon_loss: 2784182.4062; val_gene_expr_recon_loss: 11937882.3750; val_masked_gp_l1_reg_loss: 72206.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73738.9766; val_chrom_access_recon_loss: 899371.5938; val_global_loss: 15845741.8750; val_optim_loss: 15845741.8750
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9296; val_auprc_score: 0.9023; val_best_acc_score: 0.8700; val_best_f1_score: 0.8782; train_kl_reg_loss: 78564.6225; train_edge_recon_loss: 2730124.9053; train_gene_expr_recon_loss: 11848834.5152; train_masked_gp_l1_reg_loss: 72503.2771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73302.8691; train_chrom_access_recon_loss: 883399.7472; train_global_loss: 15686729.8939; train_optim_loss: 15686729.8939; val_kl_reg_loss: 75198.1748; val_edge_recon_loss: 2752291.8438; val_gene_expr_recon_loss: 11905116.1250; val_masked_gp_l1_reg_loss: 72891.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72856.6719; val_chrom_access_recon_loss: 892080.1406; val_global_loss: 15770434.3750; val_optim_loss: 15770434.3750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9324; val_auprc_score: 0.9067; val_best_acc_score: 0.8694; val_best_f1_score: 0.8797; train_kl_reg_loss: 77899.3919; train_edge_recon_loss: 2724067.5492; train_gene_expr_recon_loss: 11827756.4394; train_masked_gp_l1_reg_loss: 73251.2283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72531.6269; train_chrom_access_recon_loss: 881933.7528; train_global_loss: 15657439.9394; train_optim_loss: 15657439.9394; val_kl_reg_loss: 83313.1377; val_edge_recon_loss: 2761070.0625; val_gene_expr_recon_loss: 11886224.1250; val_masked_gp_l1_reg_loss: 73624.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72485.1172; val_chrom_access_recon_loss: 892122.2266; val_global_loss: 15768838.6250; val_optim_loss: 15768838.6250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9392; val_auprc_score: 0.9191; val_best_acc_score: 0.8751; val_best_f1_score: 0.8819; train_kl_reg_loss: 76739.4792; train_edge_recon_loss: 2718769.0000; train_gene_expr_recon_loss: 11793021.6667; train_masked_gp_l1_reg_loss: 73919.8085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72307.5173; train_chrom_access_recon_loss: 879164.1591; train_global_loss: 15613921.6667; train_optim_loss: 15613921.6667; val_kl_reg_loss: 77639.3115; val_edge_recon_loss: 2757659.2188; val_gene_expr_recon_loss: 11924215.5000; val_masked_gp_l1_reg_loss: 74255.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72079.7734; val_chrom_access_recon_loss: 887292.4453; val_global_loss: 15793141.3750; val_optim_loss: 15793141.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9353; val_auprc_score: 0.9192; val_best_acc_score: 0.8745; val_best_f1_score: 0.8821; train_kl_reg_loss: 77515.9406; train_edge_recon_loss: 2722019.9848; train_gene_expr_recon_loss: 11766046.4091; train_masked_gp_l1_reg_loss: 74511.2556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71832.4118; train_chrom_access_recon_loss: 877476.7083; train_global_loss: 15589402.7273; train_optim_loss: 15589402.7273; val_kl_reg_loss: 75830.3398; val_edge_recon_loss: 2748593.9062; val_gene_expr_recon_loss: 11744902.1250; val_masked_gp_l1_reg_loss: 74815.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71497.0156; val_chrom_access_recon_loss: 884610.7578; val_global_loss: 15600250.1250; val_optim_loss: 15600250.1250
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9352; val_auprc_score: 0.9107; val_best_acc_score: 0.8772; val_best_f1_score: 0.8844; train_kl_reg_loss: 76590.4306; train_edge_recon_loss: 2716633.6932; train_gene_expr_recon_loss: 11754430.3333; train_masked_gp_l1_reg_loss: 74943.9361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71468.5080; train_chrom_access_recon_loss: 876791.0284; train_global_loss: 15570857.9394; train_optim_loss: 15570857.9394; val_kl_reg_loss: 79813.1104; val_edge_recon_loss: 2777825.6562; val_gene_expr_recon_loss: 11921917.7500; val_masked_gp_l1_reg_loss: 75240.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71658.2969; val_chrom_access_recon_loss: 886649.6562; val_global_loss: 15813104.0000; val_optim_loss: 15813104.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9403; val_auprc_score: 0.9208; val_best_acc_score: 0.8794; val_best_f1_score: 0.8872; train_kl_reg_loss: 76206.4916; train_edge_recon_loss: 2706984.2689; train_gene_expr_recon_loss: 11725300.5455; train_masked_gp_l1_reg_loss: 75491.7312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71415.3482; train_chrom_access_recon_loss: 874052.7396; train_global_loss: 15529451.0758; train_optim_loss: 15529451.0758; val_kl_reg_loss: 76960.6152; val_edge_recon_loss: 2748515.1250; val_gene_expr_recon_loss: 11818523.5000; val_masked_gp_l1_reg_loss: 75706.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70874.4219; val_chrom_access_recon_loss: 894715.4453; val_global_loss: 15685294.6250; val_optim_loss: 15685294.6250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9451; val_auprc_score: 0.9229; val_best_acc_score: 0.8864; val_best_f1_score: 0.8928; train_kl_reg_loss: 75182.2663; train_edge_recon_loss: 2710747.4394; train_gene_expr_recon_loss: 11695517.2121; train_masked_gp_l1_reg_loss: 75883.3340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70849.9493; train_chrom_access_recon_loss: 872704.9195; train_global_loss: 15500885.1061; train_optim_loss: 15500885.1061; val_kl_reg_loss: 77098.0430; val_edge_recon_loss: 2739524.3438; val_gene_expr_recon_loss: 11859032.8750; val_masked_gp_l1_reg_loss: 76117.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71063.1016; val_chrom_access_recon_loss: 886935.6250; val_global_loss: 15709771.8750; val_optim_loss: 15709771.8750
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9492; val_auprc_score: 0.9325; val_best_acc_score: 0.8901; val_best_f1_score: 0.8930; train_kl_reg_loss: 75814.4746; train_edge_recon_loss: 2706650.1629; train_gene_expr_recon_loss: 11684587.0455; train_masked_gp_l1_reg_loss: 76286.7485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70749.4476; train_chrom_access_recon_loss: 872021.9602; train_global_loss: 15486109.8485; train_optim_loss: 15486109.8485; val_kl_reg_loss: 79168.7363; val_edge_recon_loss: 2731647.5625; val_gene_expr_recon_loss: 11853120.2500; val_masked_gp_l1_reg_loss: 76557.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71192.0000; val_chrom_access_recon_loss: 896466.3359; val_global_loss: 15708151.8750; val_optim_loss: 15708151.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9462; val_auprc_score: 0.9293; val_best_acc_score: 0.8866; val_best_f1_score: 0.8914; train_kl_reg_loss: 76774.0858; train_edge_recon_loss: 2704693.6136; train_gene_expr_recon_loss: 11669062.6970; train_masked_gp_l1_reg_loss: 75893.8402; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56929.0915; train_chrom_access_recon_loss: 870678.3580; train_global_loss: 15454031.5758; train_optim_loss: 15454031.5758; val_kl_reg_loss: 77703.3652; val_edge_recon_loss: 2749210.8125; val_gene_expr_recon_loss: 11732603.1250; val_masked_gp_l1_reg_loss: 75552.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53017.8125; val_chrom_access_recon_loss: 873551.3750; val_global_loss: 15561638.7500; val_optim_loss: 15561638.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9454; val_auprc_score: 0.9191; val_best_acc_score: 0.8909; val_best_f1_score: 0.8958; train_kl_reg_loss: 77070.7539; train_edge_recon_loss: 2690265.2803; train_gene_expr_recon_loss: 11660998.4242; train_masked_gp_l1_reg_loss: 75478.1832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52524.3862; train_chrom_access_recon_loss: 869062.9015; train_global_loss: 15425399.9394; train_optim_loss: 15425399.9394; val_kl_reg_loss: 78029.2764; val_edge_recon_loss: 2715364.9062; val_gene_expr_recon_loss: 11750762.8750; val_masked_gp_l1_reg_loss: 75437.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52174.0039; val_chrom_access_recon_loss: 873851.6094; val_global_loss: 15545619.7500; val_optim_loss: 15545619.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9514; val_auprc_score: 0.9345; val_best_acc_score: 0.8909; val_best_f1_score: 0.8963; train_kl_reg_loss: 77161.8670; train_edge_recon_loss: 2701217.8750; train_gene_expr_recon_loss: 11659158.7727; train_masked_gp_l1_reg_loss: 75419.0677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52009.7466; train_chrom_access_recon_loss: 868828.7936; train_global_loss: 15433796.0606; train_optim_loss: 15433796.0606; val_kl_reg_loss: 78242.4238; val_edge_recon_loss: 2713786.2500; val_gene_expr_recon_loss: 11691455.7500; val_masked_gp_l1_reg_loss: 75424.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51851.4805; val_chrom_access_recon_loss: 877923.4922; val_global_loss: 15488682.8750; val_optim_loss: 15488682.8750
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9473; val_auprc_score: 0.9283; val_best_acc_score: 0.8909; val_best_f1_score: 0.8953; train_kl_reg_loss: 76496.5482; train_edge_recon_loss: 2695982.5947; train_gene_expr_recon_loss: 11649506.2879; train_masked_gp_l1_reg_loss: 75434.9883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51755.4235; train_chrom_access_recon_loss: 868434.1212; train_global_loss: 15417610.0000; train_optim_loss: 15417610.0000; val_kl_reg_loss: 77414.6006; val_edge_recon_loss: 2738280.5625; val_gene_expr_recon_loss: 11704328.3750; val_masked_gp_l1_reg_loss: 75446.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51607.8633; val_chrom_access_recon_loss: 875921.3828; val_global_loss: 15522998.8750; val_optim_loss: 15522998.8750
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9510; val_auprc_score: 0.9331; val_best_acc_score: 0.8971; val_best_f1_score: 0.8996; train_kl_reg_loss: 76004.5968; train_edge_recon_loss: 2699149.5114; train_gene_expr_recon_loss: 11647419.5000; train_masked_gp_l1_reg_loss: 75471.0485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51529.0069; train_chrom_access_recon_loss: 867816.7869; train_global_loss: 15417390.4545; train_optim_loss: 15417390.4545; val_kl_reg_loss: 77693.3271; val_edge_recon_loss: 2742486.2188; val_gene_expr_recon_loss: 11800217.1250; val_masked_gp_l1_reg_loss: 75493.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51488.4297; val_chrom_access_recon_loss: 886315.8750; val_global_loss: 15633693.7500; val_optim_loss: 15633693.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9455; val_auprc_score: 0.9199; val_best_acc_score: 0.8896; val_best_f1_score: 0.8954; train_kl_reg_loss: 76644.7003; train_edge_recon_loss: 2692695.7462; train_gene_expr_recon_loss: 11642325.9394; train_masked_gp_l1_reg_loss: 75499.3777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51389.9132; train_chrom_access_recon_loss: 867314.2301; train_global_loss: 15405869.9091; train_optim_loss: 15405869.9091; val_kl_reg_loss: 77525.0107; val_edge_recon_loss: 2703471.8438; val_gene_expr_recon_loss: 11586493.0000; val_masked_gp_l1_reg_loss: 75512.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51285.1875; val_chrom_access_recon_loss: 867151.8047; val_global_loss: 15361438.3750; val_optim_loss: 15361438.3750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9456; val_auprc_score: 0.9256; val_best_acc_score: 0.8896; val_best_f1_score: 0.8947; train_kl_reg_loss: 76776.5299; train_edge_recon_loss: 2703790.7462; train_gene_expr_recon_loss: 11656821.2576; train_masked_gp_l1_reg_loss: 75541.5916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51253.3204; train_chrom_access_recon_loss: 868994.2718; train_global_loss: 15433177.7273; train_optim_loss: 15433177.7273; val_kl_reg_loss: 77406.4160; val_edge_recon_loss: 2748769.1875; val_gene_expr_recon_loss: 11742139.6250; val_masked_gp_l1_reg_loss: 75553.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51184.0703; val_chrom_access_recon_loss: 880423.7969; val_global_loss: 15575476.1250; val_optim_loss: 15575476.1250
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9500; val_auprc_score: 0.9330; val_best_acc_score: 0.8912; val_best_f1_score: 0.8953; train_kl_reg_loss: 76877.7346; train_edge_recon_loss: 2689576.2576; train_gene_expr_recon_loss: 11646546.8636; train_masked_gp_l1_reg_loss: 75575.5874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51133.4306; train_chrom_access_recon_loss: 868564.4432; train_global_loss: 15408274.3788; train_optim_loss: 15408274.3788; val_kl_reg_loss: 77713.4404; val_edge_recon_loss: 2724748.9375; val_gene_expr_recon_loss: 11684805.1250; val_masked_gp_l1_reg_loss: 75587.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51086.3477; val_chrom_access_recon_loss: 880151.4609; val_global_loss: 15494093.0000; val_optim_loss: 15494093.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9483; val_auprc_score: 0.9315; val_best_acc_score: 0.8920; val_best_f1_score: 0.8977; train_kl_reg_loss: 76522.3484; train_edge_recon_loss: 2704868.1894; train_gene_expr_recon_loss: 11635984.7727; train_masked_gp_l1_reg_loss: 75613.1049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51022.2926; train_chrom_access_recon_loss: 867769.9536; train_global_loss: 15411780.7727; train_optim_loss: 15411780.7727; val_kl_reg_loss: 77522.2441; val_edge_recon_loss: 2718507.7188; val_gene_expr_recon_loss: 11668432.1250; val_masked_gp_l1_reg_loss: 75634.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50975.7109; val_chrom_access_recon_loss: 871460.9375; val_global_loss: 15462534.0000; val_optim_loss: 15462534.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9582; val_auprc_score: 0.9452; val_best_acc_score: 0.9033; val_best_f1_score: 0.9050; train_kl_reg_loss: 76458.8705; train_edge_recon_loss: 2694323.4167; train_gene_expr_recon_loss: 11633020.9697; train_masked_gp_l1_reg_loss: 75651.4215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50914.8593; train_chrom_access_recon_loss: 867227.1856; train_global_loss: 15397596.8333; train_optim_loss: 15397596.8333; val_kl_reg_loss: 77905.7471; val_edge_recon_loss: 2697908.4375; val_gene_expr_recon_loss: 11627925.1250; val_masked_gp_l1_reg_loss: 75681.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50877.4492; val_chrom_access_recon_loss: 874976.5859; val_global_loss: 15405274.6250; val_optim_loss: 15405274.6250

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9504; val_auprc_score: 0.9308; val_best_acc_score: 0.8995; val_best_f1_score: 0.9034; train_kl_reg_loss: 76197.6184; train_edge_recon_loss: 2693966.7045; train_gene_expr_recon_loss: 11645004.5758; train_masked_gp_l1_reg_loss: 75613.1979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49488.5130; train_chrom_access_recon_loss: 867676.3220; train_global_loss: 15407946.8030; train_optim_loss: 15407946.8030; val_kl_reg_loss: 76879.6543; val_edge_recon_loss: 2703380.6562; val_gene_expr_recon_loss: 11688967.0000; val_masked_gp_l1_reg_loss: 75572.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49127.1797; val_chrom_access_recon_loss: 878538.0156; val_global_loss: 15472464.3750; val_optim_loss: 15472464.3750
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9516; val_auprc_score: 0.9378; val_best_acc_score: 0.8933; val_best_f1_score: 0.8973; train_kl_reg_loss: 76305.0214; train_edge_recon_loss: 2696871.7311; train_gene_expr_recon_loss: 11636404.1212; train_masked_gp_l1_reg_loss: 75561.3804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49075.5835; train_chrom_access_recon_loss: 867947.1544; train_global_loss: 15402164.9848; train_optim_loss: 15402164.9848; val_kl_reg_loss: 76896.9473; val_edge_recon_loss: 2728305.8125; val_gene_expr_recon_loss: 11754120.5000; val_masked_gp_l1_reg_loss: 75553.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49035.2227; val_chrom_access_recon_loss: 867095.6797; val_global_loss: 15551007.8750; val_optim_loss: 15551007.8750
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9461; val_auprc_score: 0.9268; val_best_acc_score: 0.8898; val_best_f1_score: 0.8948; train_kl_reg_loss: 76287.8995; train_edge_recon_loss: 2697274.7045; train_gene_expr_recon_loss: 11632329.5000; train_masked_gp_l1_reg_loss: 75550.0954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49009.3931; train_chrom_access_recon_loss: 866749.1572; train_global_loss: 15397200.8788; train_optim_loss: 15397200.8788; val_kl_reg_loss: 77611.5664; val_edge_recon_loss: 2729473.9688; val_gene_expr_recon_loss: 11710765.3750; val_masked_gp_l1_reg_loss: 75547.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48985.9258; val_chrom_access_recon_loss: 889219.6406; val_global_loss: 15531604.6250; val_optim_loss: 15531604.6250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9521; val_auprc_score: 0.9292; val_best_acc_score: 0.8974; val_best_f1_score: 0.9015; train_kl_reg_loss: 76467.5058; train_edge_recon_loss: 2694080.5303; train_gene_expr_recon_loss: 11639045.6667; train_masked_gp_l1_reg_loss: 75547.7612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48970.3027; train_chrom_access_recon_loss: 867203.3523; train_global_loss: 15401315.1515; train_optim_loss: 15401315.1515; val_kl_reg_loss: 77582.8535; val_edge_recon_loss: 2700549.1250; val_gene_expr_recon_loss: 11785537.6250; val_masked_gp_l1_reg_loss: 75549.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48953.6328; val_chrom_access_recon_loss: 880089.1250; val_global_loss: 15568262.7500; val_optim_loss: 15568262.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 11 min 47 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9491
val AUPRC score: 0.9302
val best accuracy score: 0.8907
val best F1 score: 0.8961
val target rna MSE score: 1.2115
val source rna MSE score: 0.6590
val target atac MSE score: 0.4848
val source atac MSE score: 0.2015
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
