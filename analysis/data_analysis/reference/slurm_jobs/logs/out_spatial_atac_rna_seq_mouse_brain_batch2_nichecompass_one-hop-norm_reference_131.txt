[True]
Run timestamp: 10102023_034159_131.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_131']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6691; val_auprc_score: 0.6510; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 42587.0340; train_edge_recon_loss: 3507956.5947; train_gene_expr_recon_loss: 14117577.9242; train_masked_gp_l1_reg_loss: 33380.6287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3621471.9280; train_chrom_access_recon_loss: 4972779.8182; train_global_loss: 26295753.9394; train_optim_loss: 26295753.9394; val_kl_reg_loss: 77100.4697; val_edge_recon_loss: 4065461.1875; val_gene_expr_recon_loss: 13103273.8750; val_masked_gp_l1_reg_loss: 41831.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2019928.1250; val_chrom_access_recon_loss: 4763234.9375; val_global_loss: 24070830.0000; val_optim_loss: 24070830.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6847; val_auprc_score: 0.6613; val_best_acc_score: 0.5865; val_best_f1_score: 0.6959; train_kl_reg_loss: 80974.7611; train_edge_recon_loss: 3511518.1894; train_gene_expr_recon_loss: 12883871.8485; train_masked_gp_l1_reg_loss: 44240.3771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1109014.3030; train_chrom_access_recon_loss: 4737957.7348; train_global_loss: 22367577.3636; train_optim_loss: 22367577.3636; val_kl_reg_loss: 84989.8506; val_edge_recon_loss: 4059317.1875; val_gene_expr_recon_loss: 12807210.0000; val_masked_gp_l1_reg_loss: 45462.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 541577.6875; val_chrom_access_recon_loss: 4648995.6875; val_global_loss: 22187552.7500; val_optim_loss: 22187552.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7399; val_auprc_score: 0.7266; val_best_acc_score: 0.6706; val_best_f1_score: 0.6967; train_kl_reg_loss: 79212.0868; train_edge_recon_loss: 3507599.8030; train_gene_expr_recon_loss: 12693650.3939; train_masked_gp_l1_reg_loss: 45971.2853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 365399.8776; train_chrom_access_recon_loss: 4695808.8864; train_global_loss: 21387642.3636; train_optim_loss: 21387642.3636; val_kl_reg_loss: 78526.0928; val_edge_recon_loss: 4036494.0000; val_gene_expr_recon_loss: 12706620.5000; val_masked_gp_l1_reg_loss: 46885.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 250485.7031; val_chrom_access_recon_loss: 4690905.0000; val_global_loss: 21809917.5000; val_optim_loss: 21809917.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8233; val_auprc_score: 0.8046; val_best_acc_score: 0.7434; val_best_f1_score: 0.7642; train_kl_reg_loss: 69274.6034; train_edge_recon_loss: 3489554.7462; train_gene_expr_recon_loss: 12603191.3182; train_masked_gp_l1_reg_loss: 47710.1706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 197777.5450; train_chrom_access_recon_loss: 4667577.7121; train_global_loss: 21075085.9091; train_optim_loss: 21075085.9091; val_kl_reg_loss: 53742.9209; val_edge_recon_loss: 3797807.4062; val_gene_expr_recon_loss: 12492826.5000; val_masked_gp_l1_reg_loss: 48955.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158640.4375; val_chrom_access_recon_loss: 4602133.0625; val_global_loss: 21154106.0000; val_optim_loss: 21154106.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8670; val_auprc_score: 0.8342; val_best_acc_score: 0.8041; val_best_f1_score: 0.8213; train_kl_reg_loss: 62148.2219; train_edge_recon_loss: 3159670.5871; train_gene_expr_recon_loss: 12566324.7576; train_masked_gp_l1_reg_loss: 51470.5076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135584.8290; train_chrom_access_recon_loss: 4657671.0227; train_global_loss: 20632869.8485; train_optim_loss: 20632869.8485; val_kl_reg_loss: 87814.1387; val_edge_recon_loss: 2914890.4688; val_gene_expr_recon_loss: 12638932.2500; val_masked_gp_l1_reg_loss: 54439.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116675.4297; val_chrom_access_recon_loss: 4625482.9375; val_global_loss: 20438234.7500; val_optim_loss: 20438234.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8986; val_auprc_score: 0.8677; val_best_acc_score: 0.8350; val_best_f1_score: 0.8476; train_kl_reg_loss: 96517.3288; train_edge_recon_loss: 2865425.5871; train_gene_expr_recon_loss: 12468576.6970; train_masked_gp_l1_reg_loss: 56008.6381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108163.3456; train_chrom_access_recon_loss: 4620760.8258; train_global_loss: 20215452.4848; train_optim_loss: 20215452.4848; val_kl_reg_loss: 93685.5527; val_edge_recon_loss: 2858933.3750; val_gene_expr_recon_loss: 12469135.8750; val_masked_gp_l1_reg_loss: 57526.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102007.7188; val_chrom_access_recon_loss: 4619901.9375; val_global_loss: 20201190.5000; val_optim_loss: 20201190.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8979; val_auprc_score: 0.8636; val_best_acc_score: 0.8388; val_best_f1_score: 0.8493; train_kl_reg_loss: 98613.8781; train_edge_recon_loss: 2827117.9129; train_gene_expr_recon_loss: 12396791.7727; train_masked_gp_l1_reg_loss: 58614.0887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96874.9448; train_chrom_access_recon_loss: 4595629.8939; train_global_loss: 20073642.4848; train_optim_loss: 20073642.4848; val_kl_reg_loss: 99314.1621; val_edge_recon_loss: 2836925.8125; val_gene_expr_recon_loss: 12455177.1250; val_masked_gp_l1_reg_loss: 59784.3242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92805.8516; val_chrom_access_recon_loss: 4614067.2500; val_global_loss: 20158074.2500; val_optim_loss: 20158074.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9053; val_auprc_score: 0.8798; val_best_acc_score: 0.8415; val_best_f1_score: 0.8533; train_kl_reg_loss: 96934.9008; train_edge_recon_loss: 2822564.1705; train_gene_expr_recon_loss: 12325116.8636; train_masked_gp_l1_reg_loss: 60764.1873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88769.5833; train_chrom_access_recon_loss: 4576763.0985; train_global_loss: 19970912.8182; train_optim_loss: 19970912.8182; val_kl_reg_loss: 97143.5723; val_edge_recon_loss: 2861111.0000; val_gene_expr_recon_loss: 12227666.6250; val_masked_gp_l1_reg_loss: 61808.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85790.2109; val_chrom_access_recon_loss: 4537828.8750; val_global_loss: 19871348.0000; val_optim_loss: 19871348.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9069; val_auprc_score: 0.8736; val_best_acc_score: 0.8506; val_best_f1_score: 0.8606; train_kl_reg_loss: 95253.1720; train_edge_recon_loss: 2801758.6477; train_gene_expr_recon_loss: 12271987.8939; train_masked_gp_l1_reg_loss: 62547.5558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83983.9498; train_chrom_access_recon_loss: 4558249.2727; train_global_loss: 19873780.3636; train_optim_loss: 19873780.3636; val_kl_reg_loss: 92426.5410; val_edge_recon_loss: 2837665.8438; val_gene_expr_recon_loss: 12289285.2500; val_masked_gp_l1_reg_loss: 63452.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83297.8750; val_chrom_access_recon_loss: 4535584.8750; val_global_loss: 19901712.5000; val_optim_loss: 19901712.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9167; val_auprc_score: 0.8892; val_best_acc_score: 0.8579; val_best_f1_score: 0.8675; train_kl_reg_loss: 90891.2834; train_edge_recon_loss: 2800223.3636; train_gene_expr_recon_loss: 12213209.3788; train_masked_gp_l1_reg_loss: 64207.6004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82937.6271; train_chrom_access_recon_loss: 4539994.5227; train_global_loss: 19791463.7879; train_optim_loss: 19791463.7879; val_kl_reg_loss: 90149.6943; val_edge_recon_loss: 2798873.9688; val_gene_expr_recon_loss: 12269175.0000; val_masked_gp_l1_reg_loss: 65058.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82518.6406; val_chrom_access_recon_loss: 4529918.3750; val_global_loss: 19835694.2500; val_optim_loss: 19835694.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9148; val_auprc_score: 0.8851; val_best_acc_score: 0.8576; val_best_f1_score: 0.8643; train_kl_reg_loss: 90759.7584; train_edge_recon_loss: 2789895.7121; train_gene_expr_recon_loss: 12156685.6515; train_masked_gp_l1_reg_loss: 65670.8615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81124.3685; train_chrom_access_recon_loss: 4522030.6136; train_global_loss: 19706166.9697; train_optim_loss: 19706166.9697; val_kl_reg_loss: 90163.4512; val_edge_recon_loss: 2789234.1562; val_gene_expr_recon_loss: 12306781.0000; val_masked_gp_l1_reg_loss: 66356.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80136.3203; val_chrom_access_recon_loss: 4563353.4375; val_global_loss: 19896023.7500; val_optim_loss: 19896023.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9179; val_auprc_score: 0.8956; val_best_acc_score: 0.8568; val_best_f1_score: 0.8656; train_kl_reg_loss: 88525.1643; train_edge_recon_loss: 2770642.1061; train_gene_expr_recon_loss: 12110311.4697; train_masked_gp_l1_reg_loss: 66911.1257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78920.1225; train_chrom_access_recon_loss: 4503338.1667; train_global_loss: 19618648.0909; train_optim_loss: 19618648.0909; val_kl_reg_loss: 88624.4688; val_edge_recon_loss: 2795297.5312; val_gene_expr_recon_loss: 12084283.7500; val_masked_gp_l1_reg_loss: 67542.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78108.7656; val_chrom_access_recon_loss: 4514587.1250; val_global_loss: 19628445.2500; val_optim_loss: 19628445.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9174; val_auprc_score: 0.8860; val_best_acc_score: 0.8614; val_best_f1_score: 0.8684; train_kl_reg_loss: 86134.1817; train_edge_recon_loss: 2786390.7273; train_gene_expr_recon_loss: 12075637.5455; train_masked_gp_l1_reg_loss: 68095.0304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77031.5101; train_chrom_access_recon_loss: 4493357.4924; train_global_loss: 19586646.3636; train_optim_loss: 19586646.3636; val_kl_reg_loss: 86726.7783; val_edge_recon_loss: 2785497.0938; val_gene_expr_recon_loss: 12123660.1250; val_masked_gp_l1_reg_loss: 68698.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76246.6797; val_chrom_access_recon_loss: 4485798.6250; val_global_loss: 19626627.7500; val_optim_loss: 19626627.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9130; val_auprc_score: 0.8873; val_best_acc_score: 0.8541; val_best_f1_score: 0.8628; train_kl_reg_loss: 85940.3711; train_edge_recon_loss: 2776970.3106; train_gene_expr_recon_loss: 12039728.1818; train_masked_gp_l1_reg_loss: 69209.6554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75572.1444; train_chrom_access_recon_loss: 4485278.1591; train_global_loss: 19532698.7879; train_optim_loss: 19532698.7879; val_kl_reg_loss: 82460.1074; val_edge_recon_loss: 2843157.3750; val_gene_expr_recon_loss: 12046505.3750; val_masked_gp_l1_reg_loss: 69678.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74611.8828; val_chrom_access_recon_loss: 4479160.1250; val_global_loss: 19595573.0000; val_optim_loss: 19595573.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9254; val_auprc_score: 0.9028; val_best_acc_score: 0.8667; val_best_f1_score: 0.8740; train_kl_reg_loss: 84169.4824; train_edge_recon_loss: 2773567.2462; train_gene_expr_recon_loss: 11989822.1061; train_masked_gp_l1_reg_loss: 70080.5509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74130.5836; train_chrom_access_recon_loss: 4460036.7727; train_global_loss: 19451806.6061; train_optim_loss: 19451806.6061; val_kl_reg_loss: 83213.6875; val_edge_recon_loss: 2813342.8750; val_gene_expr_recon_loss: 11969660.7500; val_masked_gp_l1_reg_loss: 70601.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74253.4062; val_chrom_access_recon_loss: 4439027.1250; val_global_loss: 19450098.2500; val_optim_loss: 19450098.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9218; val_auprc_score: 0.8935; val_best_acc_score: 0.8681; val_best_f1_score: 0.8763; train_kl_reg_loss: 82413.0468; train_edge_recon_loss: 2770897.0606; train_gene_expr_recon_loss: 11958099.0909; train_masked_gp_l1_reg_loss: 70928.9529; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73564.3518; train_chrom_access_recon_loss: 4454365.7879; train_global_loss: 19410268.4848; train_optim_loss: 19410268.4848; val_kl_reg_loss: 80994.5391; val_edge_recon_loss: 2795580.7188; val_gene_expr_recon_loss: 11946808.1250; val_masked_gp_l1_reg_loss: 71362.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73644.4688; val_chrom_access_recon_loss: 4436860.5625; val_global_loss: 19405250.2500; val_optim_loss: 19405250.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9211; val_auprc_score: 0.8966; val_best_acc_score: 0.8581; val_best_f1_score: 0.8676; train_kl_reg_loss: 82285.5439; train_edge_recon_loss: 2756131.1894; train_gene_expr_recon_loss: 11929050.5606; train_masked_gp_l1_reg_loss: 71713.6067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73166.3621; train_chrom_access_recon_loss: 4441057.9508; train_global_loss: 19353405.2121; train_optim_loss: 19353405.2121; val_kl_reg_loss: 84238.0156; val_edge_recon_loss: 2811525.1562; val_gene_expr_recon_loss: 11906650.8750; val_masked_gp_l1_reg_loss: 72037.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72764.6641; val_chrom_access_recon_loss: 4418417.6875; val_global_loss: 19365633.5000; val_optim_loss: 19365633.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9238; val_auprc_score: 0.8996; val_best_acc_score: 0.8624; val_best_f1_score: 0.8702; train_kl_reg_loss: 81611.9183; train_edge_recon_loss: 2762948.9924; train_gene_expr_recon_loss: 11894964.6212; train_masked_gp_l1_reg_loss: 72255.4061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72678.0014; train_chrom_access_recon_loss: 4431488.5455; train_global_loss: 19315947.4242; train_optim_loss: 19315947.4242; val_kl_reg_loss: 78823.2295; val_edge_recon_loss: 2797626.4062; val_gene_expr_recon_loss: 12021990.8750; val_masked_gp_l1_reg_loss: 72559.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72532.7109; val_chrom_access_recon_loss: 4424680.0000; val_global_loss: 19468212.7500; val_optim_loss: 19468212.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9160; val_auprc_score: 0.8899; val_best_acc_score: 0.8573; val_best_f1_score: 0.8664; train_kl_reg_loss: 80358.8832; train_edge_recon_loss: 2748250.9924; train_gene_expr_recon_loss: 11864403.1061; train_masked_gp_l1_reg_loss: 72901.0289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72072.7836; train_chrom_access_recon_loss: 4417880.0909; train_global_loss: 19255866.7576; train_optim_loss: 19255866.7576; val_kl_reg_loss: 79265.9785; val_edge_recon_loss: 2794808.6562; val_gene_expr_recon_loss: 11964484.0000; val_masked_gp_l1_reg_loss: 73251.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71855.1094; val_chrom_access_recon_loss: 4425878.1250; val_global_loss: 19409542.5000; val_optim_loss: 19409542.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9247; val_auprc_score: 0.9008; val_best_acc_score: 0.8616; val_best_f1_score: 0.8709; train_kl_reg_loss: 79902.9906; train_edge_recon_loss: 2734936.3598; train_gene_expr_recon_loss: 11843040.4848; train_masked_gp_l1_reg_loss: 73483.2219; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71464.8963; train_chrom_access_recon_loss: 4408839.7462; train_global_loss: 19211667.5152; train_optim_loss: 19211667.5152; val_kl_reg_loss: 83168.0391; val_edge_recon_loss: 2767658.5625; val_gene_expr_recon_loss: 11921777.1250; val_masked_gp_l1_reg_loss: 73853.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71318.0078; val_chrom_access_recon_loss: 4400059.6875; val_global_loss: 19317834.7500; val_optim_loss: 19317834.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9180; val_auprc_score: 0.8885; val_best_acc_score: 0.8560; val_best_f1_score: 0.8645; train_kl_reg_loss: 81301.2498; train_edge_recon_loss: 2741604.9205; train_gene_expr_recon_loss: 11806679.5303; train_masked_gp_l1_reg_loss: 74064.5926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71168.4845; train_chrom_access_recon_loss: 4394867.4659; train_global_loss: 19169686.1515; train_optim_loss: 19169686.1515; val_kl_reg_loss: 79807.1836; val_edge_recon_loss: 2776056.2812; val_gene_expr_recon_loss: 11712598.8750; val_masked_gp_l1_reg_loss: 74256.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70800.6016; val_chrom_access_recon_loss: 4372316.6250; val_global_loss: 19085835.5000; val_optim_loss: 19085835.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9279; val_auprc_score: 0.8984; val_best_acc_score: 0.8713; val_best_f1_score: 0.8804; train_kl_reg_loss: 79823.8571; train_edge_recon_loss: 2735269.9205; train_gene_expr_recon_loss: 11786824.3939; train_masked_gp_l1_reg_loss: 74505.4485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70691.9232; train_chrom_access_recon_loss: 4383415.8106; train_global_loss: 19130531.5758; train_optim_loss: 19130531.5758; val_kl_reg_loss: 79182.0244; val_edge_recon_loss: 2747053.8750; val_gene_expr_recon_loss: 11842631.8750; val_masked_gp_l1_reg_loss: 74801.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70834.6562; val_chrom_access_recon_loss: 4383846.4375; val_global_loss: 19198351.2500; val_optim_loss: 19198351.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9302; val_auprc_score: 0.9051; val_best_acc_score: 0.8697; val_best_f1_score: 0.8759; train_kl_reg_loss: 78503.4781; train_edge_recon_loss: 2736417.3864; train_gene_expr_recon_loss: 11759239.2273; train_masked_gp_l1_reg_loss: 75024.0588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70312.8310; train_chrom_access_recon_loss: 4373139.4318; train_global_loss: 19092636.3939; train_optim_loss: 19092636.3939; val_kl_reg_loss: 76381.9727; val_edge_recon_loss: 2757302.6875; val_gene_expr_recon_loss: 11765505.3750; val_masked_gp_l1_reg_loss: 75202.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70342.7812; val_chrom_access_recon_loss: 4385303.6250; val_global_loss: 19130038.7500; val_optim_loss: 19130038.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9357; val_auprc_score: 0.9185; val_best_acc_score: 0.8761; val_best_f1_score: 0.8813; train_kl_reg_loss: 77862.6777; train_edge_recon_loss: 2719611.7045; train_gene_expr_recon_loss: 11748408.2576; train_masked_gp_l1_reg_loss: 75410.9023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69871.8400; train_chrom_access_recon_loss: 4367915.4962; train_global_loss: 19059080.7879; train_optim_loss: 19059080.7879; val_kl_reg_loss: 77295.1172; val_edge_recon_loss: 2754887.9375; val_gene_expr_recon_loss: 11780998.2500; val_masked_gp_l1_reg_loss: 75752.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69882.3594; val_chrom_access_recon_loss: 4373400.8438; val_global_loss: 19132216.0000; val_optim_loss: 19132216.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9346; val_auprc_score: 0.9157; val_best_acc_score: 0.8748; val_best_f1_score: 0.8803; train_kl_reg_loss: 77185.8458; train_edge_recon_loss: 2721958.3712; train_gene_expr_recon_loss: 11717750.8485; train_masked_gp_l1_reg_loss: 75881.3958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69690.3176; train_chrom_access_recon_loss: 4355744.5871; train_global_loss: 19018211.3636; train_optim_loss: 19018211.3636; val_kl_reg_loss: 77044.2666; val_edge_recon_loss: 2748279.3438; val_gene_expr_recon_loss: 11731429.6250; val_masked_gp_l1_reg_loss: 76073.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69649.4141; val_chrom_access_recon_loss: 4332445.5938; val_global_loss: 19034921.2500; val_optim_loss: 19034921.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9402; val_auprc_score: 0.9214; val_best_acc_score: 0.8807; val_best_f1_score: 0.8858; train_kl_reg_loss: 78357.0868; train_edge_recon_loss: 2712819.4886; train_gene_expr_recon_loss: 11697355.0303; train_masked_gp_l1_reg_loss: 76238.8053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69271.3891; train_chrom_access_recon_loss: 4344823.8977; train_global_loss: 18978865.8182; train_optim_loss: 18978865.8182; val_kl_reg_loss: 76526.3145; val_edge_recon_loss: 2742820.5000; val_gene_expr_recon_loss: 11799848.6250; val_masked_gp_l1_reg_loss: 76379.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69402.9844; val_chrom_access_recon_loss: 4335433.8125; val_global_loss: 19100412.0000; val_optim_loss: 19100412.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9423; val_auprc_score: 0.9244; val_best_acc_score: 0.8845; val_best_f1_score: 0.8889; train_kl_reg_loss: 75186.8219; train_edge_recon_loss: 2717562.7045; train_gene_expr_recon_loss: 11683751.5909; train_masked_gp_l1_reg_loss: 76593.5985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69087.2290; train_chrom_access_recon_loss: 4334697.2386; train_global_loss: 18956879.1818; train_optim_loss: 18956879.1818; val_kl_reg_loss: 75637.4365; val_edge_recon_loss: 2749827.5312; val_gene_expr_recon_loss: 11690144.7500; val_masked_gp_l1_reg_loss: 76880.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69046.6406; val_chrom_access_recon_loss: 4299322.5000; val_global_loss: 18960859.0000; val_optim_loss: 18960859.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9414; val_auprc_score: 0.9192; val_best_acc_score: 0.8826; val_best_f1_score: 0.8887; train_kl_reg_loss: 74630.1278; train_edge_recon_loss: 2713337.1212; train_gene_expr_recon_loss: 11660424.8939; train_masked_gp_l1_reg_loss: 77096.7591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68852.6931; train_chrom_access_recon_loss: 4327072.2235; train_global_loss: 18921413.8182; train_optim_loss: 18921413.8182; val_kl_reg_loss: 75742.7109; val_edge_recon_loss: 2726913.5312; val_gene_expr_recon_loss: 11606386.1250; val_masked_gp_l1_reg_loss: 77253.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68589.7734; val_chrom_access_recon_loss: 4300946.9062; val_global_loss: 18855832.0000; val_optim_loss: 18855832.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9413; val_auprc_score: 0.9214; val_best_acc_score: 0.8866; val_best_f1_score: 0.8906; train_kl_reg_loss: 75695.8145; train_edge_recon_loss: 2703810.3674; train_gene_expr_recon_loss: 11654680.9242; train_masked_gp_l1_reg_loss: 77382.2195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68591.2062; train_chrom_access_recon_loss: 4320091.8447; train_global_loss: 18900252.4545; train_optim_loss: 18900252.4545; val_kl_reg_loss: 75371.1689; val_edge_recon_loss: 2740414.5312; val_gene_expr_recon_loss: 11697911.7500; val_masked_gp_l1_reg_loss: 77633.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68810.8438; val_chrom_access_recon_loss: 4281978.8750; val_global_loss: 18942121.2500; val_optim_loss: 18942121.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9435; val_auprc_score: 0.9252; val_best_acc_score: 0.8869; val_best_f1_score: 0.8920; train_kl_reg_loss: 75685.4401; train_edge_recon_loss: 2700580.9432; train_gene_expr_recon_loss: 11627641.3636; train_masked_gp_l1_reg_loss: 77735.6267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68433.1327; train_chrom_access_recon_loss: 4306163.1705; train_global_loss: 18856239.6061; train_optim_loss: 18856239.6061; val_kl_reg_loss: 76193.5889; val_edge_recon_loss: 2733944.9375; val_gene_expr_recon_loss: 11699362.6250; val_masked_gp_l1_reg_loss: 77943.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68588.6250; val_chrom_access_recon_loss: 4316662.3750; val_global_loss: 18972695.2500; val_optim_loss: 18972695.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9491; val_auprc_score: 0.9302; val_best_acc_score: 0.8941; val_best_f1_score: 0.8975; train_kl_reg_loss: 74191.1361; train_edge_recon_loss: 2707735.9356; train_gene_expr_recon_loss: 11605346.4697; train_masked_gp_l1_reg_loss: 78058.9904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68183.9244; train_chrom_access_recon_loss: 4294704.6705; train_global_loss: 18828221.1818; train_optim_loss: 18828221.1818; val_kl_reg_loss: 72736.9189; val_edge_recon_loss: 2736952.3125; val_gene_expr_recon_loss: 11675256.8750; val_masked_gp_l1_reg_loss: 78176.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68433.6250; val_chrom_access_recon_loss: 4320874.4375; val_global_loss: 18952430.2500; val_optim_loss: 18952430.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9495; val_auprc_score: 0.9362; val_best_acc_score: 0.8885; val_best_f1_score: 0.8942; train_kl_reg_loss: 74176.5563; train_edge_recon_loss: 2702584.0909; train_gene_expr_recon_loss: 11594088.7727; train_masked_gp_l1_reg_loss: 78372.8072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68101.9820; train_chrom_access_recon_loss: 4284376.9773; train_global_loss: 18801701.1515; train_optim_loss: 18801701.1515; val_kl_reg_loss: 75866.8271; val_edge_recon_loss: 2727362.8750; val_gene_expr_recon_loss: 11652480.8750; val_masked_gp_l1_reg_loss: 78543.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68231.8984; val_chrom_access_recon_loss: 4261761.8750; val_global_loss: 18864247.2500; val_optim_loss: 18864247.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9493; val_auprc_score: 0.9292; val_best_acc_score: 0.8966; val_best_f1_score: 0.8997; train_kl_reg_loss: 75337.6501; train_edge_recon_loss: 2696349.9015; train_gene_expr_recon_loss: 11576420.9091; train_masked_gp_l1_reg_loss: 77848.7414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55483.1607; train_chrom_access_recon_loss: 4268925.1326; train_global_loss: 18750365.4545; train_optim_loss: 18750365.4545; val_kl_reg_loss: 75911.9023; val_edge_recon_loss: 2726349.6562; val_gene_expr_recon_loss: 11636258.1250; val_masked_gp_l1_reg_loss: 77516.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52465.7148; val_chrom_access_recon_loss: 4310480.8125; val_global_loss: 18878983.5000; val_optim_loss: 18878983.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9417; val_auprc_score: 0.9216; val_best_acc_score: 0.8812; val_best_f1_score: 0.8881; train_kl_reg_loss: 75206.7320; train_edge_recon_loss: 2696625.4848; train_gene_expr_recon_loss: 11571010.1970; train_masked_gp_l1_reg_loss: 77452.5704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52161.9041; train_chrom_access_recon_loss: 4267572.9394; train_global_loss: 18740029.7576; train_optim_loss: 18740029.7576; val_kl_reg_loss: 75905.8203; val_edge_recon_loss: 2762565.5000; val_gene_expr_recon_loss: 11618503.1250; val_masked_gp_l1_reg_loss: 77421.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51929.4727; val_chrom_access_recon_loss: 4255747.0938; val_global_loss: 18842073.0000; val_optim_loss: 18842073.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9498; val_auprc_score: 0.9334; val_best_acc_score: 0.8939; val_best_f1_score: 0.8997; train_kl_reg_loss: 75889.3661; train_edge_recon_loss: 2708685.0833; train_gene_expr_recon_loss: 11572101.2727; train_masked_gp_l1_reg_loss: 77410.7644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51747.7403; train_chrom_access_recon_loss: 4265697.6553; train_global_loss: 18751531.9091; train_optim_loss: 18751531.9091; val_kl_reg_loss: 76129.2266; val_edge_recon_loss: 2713754.1562; val_gene_expr_recon_loss: 11603351.2500; val_masked_gp_l1_reg_loss: 77405.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51607.9727; val_chrom_access_recon_loss: 4271424.2188; val_global_loss: 18793673.2500; val_optim_loss: 18793673.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9501; val_auprc_score: 0.9335; val_best_acc_score: 0.8952; val_best_f1_score: 0.8989; train_kl_reg_loss: 75452.9384; train_edge_recon_loss: 2696742.7917; train_gene_expr_recon_loss: 11581428.3030; train_masked_gp_l1_reg_loss: 77413.6562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51502.3345; train_chrom_access_recon_loss: 4268284.2045; train_global_loss: 18750824.3939; train_optim_loss: 18750824.3939; val_kl_reg_loss: 76875.9688; val_edge_recon_loss: 2730944.0625; val_gene_expr_recon_loss: 11655357.1250; val_masked_gp_l1_reg_loss: 77424.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51402.8906; val_chrom_access_recon_loss: 4246491.1250; val_global_loss: 18838495.5000; val_optim_loss: 18838495.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9553; val_auprc_score: 0.9426; val_best_acc_score: 0.9001; val_best_f1_score: 0.9038; train_kl_reg_loss: 76118.5618; train_edge_recon_loss: 2691995.8636; train_gene_expr_recon_loss: 11572302.2727; train_masked_gp_l1_reg_loss: 77418.1275; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51260.0935; train_chrom_access_recon_loss: 4263535.6212; train_global_loss: 18732630.4848; train_optim_loss: 18732630.4848; val_kl_reg_loss: 76689.1348; val_edge_recon_loss: 2715244.5938; val_gene_expr_recon_loss: 11685598.5000; val_masked_gp_l1_reg_loss: 77425.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51192.6641; val_chrom_access_recon_loss: 4271748.2188; val_global_loss: 18877898.7500; val_optim_loss: 18877898.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9476; val_auprc_score: 0.9286; val_best_acc_score: 0.8909; val_best_f1_score: 0.8949; train_kl_reg_loss: 76334.9145; train_edge_recon_loss: 2696905.0152; train_gene_expr_recon_loss: 11558175.8939; train_masked_gp_l1_reg_loss: 77438.6735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51121.0413; train_chrom_access_recon_loss: 4258513.7652; train_global_loss: 18718489.1515; train_optim_loss: 18718489.1515; val_kl_reg_loss: 76113.9453; val_edge_recon_loss: 2758158.9688; val_gene_expr_recon_loss: 11592530.2500; val_masked_gp_l1_reg_loss: 77444.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50995.1953; val_chrom_access_recon_loss: 4252579.1250; val_global_loss: 18807821.5000; val_optim_loss: 18807821.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9513; val_auprc_score: 0.9358; val_best_acc_score: 0.8936; val_best_f1_score: 0.8975; train_kl_reg_loss: 76269.2584; train_edge_recon_loss: 2692861.3636; train_gene_expr_recon_loss: 11561185.0000; train_masked_gp_l1_reg_loss: 77448.0071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50927.9299; train_chrom_access_recon_loss: 4261955.8712; train_global_loss: 18720647.3333; train_optim_loss: 18720647.3333; val_kl_reg_loss: 76924.3125; val_edge_recon_loss: 2730153.8438; val_gene_expr_recon_loss: 11475839.3750; val_masked_gp_l1_reg_loss: 77451.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50848.6719; val_chrom_access_recon_loss: 4274047.3438; val_global_loss: 18685265.7500; val_optim_loss: 18685265.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9376; val_auprc_score: 0.9143; val_best_acc_score: 0.8837; val_best_f1_score: 0.8904; train_kl_reg_loss: 76566.1765; train_edge_recon_loss: 2693864.0985; train_gene_expr_recon_loss: 11551404.7121; train_masked_gp_l1_reg_loss: 77456.6095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50766.7244; train_chrom_access_recon_loss: 4257057.9962; train_global_loss: 18707116.2424; train_optim_loss: 18707116.2424; val_kl_reg_loss: 76787.0166; val_edge_recon_loss: 2766929.4062; val_gene_expr_recon_loss: 11599485.8750; val_masked_gp_l1_reg_loss: 77465.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50681.5234; val_chrom_access_recon_loss: 4264720.3125; val_global_loss: 18836070.2500; val_optim_loss: 18836070.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9437; val_auprc_score: 0.9243; val_best_acc_score: 0.8898; val_best_f1_score: 0.8955; train_kl_reg_loss: 77024.0333; train_edge_recon_loss: 2684417.0909; train_gene_expr_recon_loss: 11551639.9697; train_masked_gp_l1_reg_loss: 77472.0861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50614.1392; train_chrom_access_recon_loss: 4258187.9394; train_global_loss: 18699355.3636; train_optim_loss: 18699355.3636; val_kl_reg_loss: 77590.0703; val_edge_recon_loss: 2730752.4688; val_gene_expr_recon_loss: 11695726.1250; val_masked_gp_l1_reg_loss: 77473.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50560.0586; val_chrom_access_recon_loss: 4303260.8750; val_global_loss: 18935362.5000; val_optim_loss: 18935362.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9489; val_auprc_score: 0.9314; val_best_acc_score: 0.8939; val_best_f1_score: 0.8982; train_kl_reg_loss: 76735.2159; train_edge_recon_loss: 2686235.7008; train_gene_expr_recon_loss: 11555038.0152; train_masked_gp_l1_reg_loss: 77485.7670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50495.5641; train_chrom_access_recon_loss: 4254028.3561; train_global_loss: 18700018.5758; train_optim_loss: 18700018.5758; val_kl_reg_loss: 77173.7627; val_edge_recon_loss: 2741545.8438; val_gene_expr_recon_loss: 11621811.5000; val_masked_gp_l1_reg_loss: 77508.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50449.1367; val_chrom_access_recon_loss: 4257882.5938; val_global_loss: 18826372.0000; val_optim_loss: 18826372.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9472; val_auprc_score: 0.9280; val_best_acc_score: 0.8936; val_best_f1_score: 0.8990; train_kl_reg_loss: 76224.7244; train_edge_recon_loss: 2697435.6439; train_gene_expr_recon_loss: 11559151.3788; train_masked_gp_l1_reg_loss: 77521.6713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50422.9396; train_chrom_access_recon_loss: 4257718.1326; train_global_loss: 18718474.5152; train_optim_loss: 18718474.5152; val_kl_reg_loss: 76648.7812; val_edge_recon_loss: 2756440.7812; val_gene_expr_recon_loss: 11667509.5000; val_masked_gp_l1_reg_loss: 77529.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50380.4258; val_chrom_access_recon_loss: 4289112.2500; val_global_loss: 18917621.5000; val_optim_loss: 18917621.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9496; val_auprc_score: 0.9299; val_best_acc_score: 0.8958; val_best_f1_score: 0.9009; train_kl_reg_loss: 76303.3930; train_edge_recon_loss: 2695017.7083; train_gene_expr_recon_loss: 11552529.9091; train_masked_gp_l1_reg_loss: 77466.7946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49124.7461; train_chrom_access_recon_loss: 4259279.9394; train_global_loss: 18709722.4848; train_optim_loss: 18709722.4848; val_kl_reg_loss: 77119.2656; val_edge_recon_loss: 2718196.5625; val_gene_expr_recon_loss: 11758069.2500; val_masked_gp_l1_reg_loss: 77426.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48839.1719; val_chrom_access_recon_loss: 4296704.2188; val_global_loss: 18976354.5000; val_optim_loss: 18976354.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9394; val_auprc_score: 0.9151; val_best_acc_score: 0.8826; val_best_f1_score: 0.8895; train_kl_reg_loss: 76175.9111; train_edge_recon_loss: 2691979.9659; train_gene_expr_recon_loss: 11556379.2576; train_masked_gp_l1_reg_loss: 77412.6023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48806.3456; train_chrom_access_recon_loss: 4255459.1705; train_global_loss: 18706213.3030; train_optim_loss: 18706213.3030; val_kl_reg_loss: 76759.8740; val_edge_recon_loss: 2744691.7500; val_gene_expr_recon_loss: 11639575.1250; val_masked_gp_l1_reg_loss: 77405.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48780.8164; val_chrom_access_recon_loss: 4267273.6562; val_global_loss: 18854486.2500; val_optim_loss: 18854486.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9497; val_auprc_score: 0.9334; val_best_acc_score: 0.8933; val_best_f1_score: 0.8990; train_kl_reg_loss: 76452.1250; train_edge_recon_loss: 2689668.2348; train_gene_expr_recon_loss: 11554023.3030; train_masked_gp_l1_reg_loss: 77402.3928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48763.1045; train_chrom_access_recon_loss: 4250135.3068; train_global_loss: 18696444.3636; train_optim_loss: 18696444.3636; val_kl_reg_loss: 76631.0156; val_edge_recon_loss: 2732331.0312; val_gene_expr_recon_loss: 11674264.2500; val_masked_gp_l1_reg_loss: 77399.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48745.8125; val_chrom_access_recon_loss: 4274670.8125; val_global_loss: 18884042.2500; val_optim_loss: 18884042.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9474; val_auprc_score: 0.9308; val_best_acc_score: 0.8968; val_best_f1_score: 0.9006; train_kl_reg_loss: 76544.4042; train_edge_recon_loss: 2701340.8826; train_gene_expr_recon_loss: 11561842.2121; train_masked_gp_l1_reg_loss: 77399.1539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 48731.3569; train_chrom_access_recon_loss: 4253200.8295; train_global_loss: 18719058.5758; train_optim_loss: 18719058.5758; val_kl_reg_loss: 77068.8740; val_edge_recon_loss: 2708748.5938; val_gene_expr_recon_loss: 11618288.0000; val_masked_gp_l1_reg_loss: 77397.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48717.3516; val_chrom_access_recon_loss: 4261385.6875; val_global_loss: 18791605.7500; val_optim_loss: 18791605.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 49 sec.
Using best model state, which was in epoch 39.

--- MODEL EVALUATION ---
val AUROC score: 0.9515
val AUPRC score: 0.9350
val best accuracy score: 0.8979
val best F1 score: 0.9037
val target rna MSE score: 1.2613
val source rna MSE score: 0.7009
val target atac MSE score: 0.4674
val source atac MSE score: 0.1881
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
