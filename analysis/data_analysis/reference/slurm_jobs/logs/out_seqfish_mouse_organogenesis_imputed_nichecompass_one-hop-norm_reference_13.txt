[True]
Run timestamp: 07082024_105223_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--no-include_omnipath_gps', '--include_nichenet_gps', '--no-include_mebocost_gps', '--no-include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--seed', '0', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1287.
Number of gene programs after filtering and combining: 1287.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1386, n_latent: 1286, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1286, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8479; val_auprc_score: 0.9689; val_best_acc_score: 0.8669; val_best_f1_score: 0.9265; train_kl_reg_loss: 109189.4717; train_edge_recon_loss: 1140523.4468; train_gene_expr_recon_loss: 44090535.9140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 45340248.8459; train_optim_loss: 45340248.8459; val_kl_reg_loss: 81814.1508; val_edge_recon_loss: 1116458.4012; val_gene_expr_recon_loss: 39716392.4731; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40914665.2043; val_optim_loss: 40914665.2043
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8718; val_auprc_score: 0.9737; val_best_acc_score: 0.8823; val_best_f1_score: 0.9338; train_kl_reg_loss: 84858.3744; train_edge_recon_loss: 1007382.8594; train_gene_expr_recon_loss: 37809315.9474; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38901557.2186; train_optim_loss: 38901557.2186; val_kl_reg_loss: 82149.0234; val_edge_recon_loss: 944693.1022; val_gene_expr_recon_loss: 36209479.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37236322.1075; val_optim_loss: 37236322.1075
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8866; val_auprc_score: 0.9753; val_best_acc_score: 0.8869; val_best_f1_score: 0.9363; train_kl_reg_loss: 76155.1958; train_edge_recon_loss: 928280.1561; train_gene_expr_recon_loss: 35002100.5639; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36006535.9044; train_optim_loss: 36006535.9044; val_kl_reg_loss: 71140.4214; val_edge_recon_loss: 913012.2224; val_gene_expr_recon_loss: 33945720.5591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34929872.9462; val_optim_loss: 34929872.9462
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8989; val_auprc_score: 0.9784; val_best_acc_score: 0.8993; val_best_f1_score: 0.9426; train_kl_reg_loss: 67153.8792; train_edge_recon_loss: 892505.9029; train_gene_expr_recon_loss: 33113300.8578; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34072960.7312; train_optim_loss: 34072960.7312; val_kl_reg_loss: 63634.1092; val_edge_recon_loss: 894542.1828; val_gene_expr_recon_loss: 32391054.8387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33349231.1398; val_optim_loss: 33349231.1398
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9044; val_auprc_score: 0.9790; val_best_acc_score: 0.9038; val_best_f1_score: 0.9449; train_kl_reg_loss: 59630.8212; train_edge_recon_loss: 873042.9462; train_gene_expr_recon_loss: 31818809.5579; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32751483.3094; train_optim_loss: 32751483.3094; val_kl_reg_loss: 55706.0165; val_edge_recon_loss: 887067.0316; val_gene_expr_recon_loss: 31313189.9355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32255963.0968; val_optim_loss: 32255963.0968
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9130; val_auprc_score: 0.9813; val_best_acc_score: 0.9103; val_best_f1_score: 0.9489; train_kl_reg_loss: 52648.4841; train_edge_recon_loss: 855555.9550; train_gene_expr_recon_loss: 30926016.6260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31834221.0657; train_optim_loss: 31834221.0657; val_kl_reg_loss: 49249.0128; val_edge_recon_loss: 838641.5524; val_gene_expr_recon_loss: 30578649.1828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31466539.6129; val_optim_loss: 31466539.6129
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9187; val_auprc_score: 0.9828; val_best_acc_score: 0.9106; val_best_f1_score: 0.9484; train_kl_reg_loss: 46424.5511; train_edge_recon_loss: 847458.6004; train_gene_expr_recon_loss: 30310459.1828; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31204342.3226; train_optim_loss: 31204342.3226; val_kl_reg_loss: 44058.5038; val_edge_recon_loss: 835085.1828; val_gene_expr_recon_loss: 30110283.8280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30989427.3978; val_optim_loss: 30989427.3978
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9277; val_auprc_score: 0.9847; val_best_acc_score: 0.9156; val_best_f1_score: 0.9517; train_kl_reg_loss: 41218.8490; train_edge_recon_loss: 831191.5267; train_gene_expr_recon_loss: 29898722.9343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30771133.3142; train_optim_loss: 30771133.3142; val_kl_reg_loss: 38154.6916; val_edge_recon_loss: 837971.9301; val_gene_expr_recon_loss: 29751185.6559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30627312.2796; val_optim_loss: 30627312.2796
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9285; val_auprc_score: 0.9840; val_best_acc_score: 0.9174; val_best_f1_score: 0.9524; train_kl_reg_loss: 36802.0984; train_edge_recon_loss: 835532.3496; train_gene_expr_recon_loss: 29615190.9869; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30487525.4337; train_optim_loss: 30487525.4337; val_kl_reg_loss: 34873.0383; val_edge_recon_loss: 827330.9435; val_gene_expr_recon_loss: 29507186.4516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30369390.4731; val_optim_loss: 30369390.4731
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9311; val_auprc_score: 0.9845; val_best_acc_score: 0.9208; val_best_f1_score: 0.9543; train_kl_reg_loss: 33435.8196; train_edge_recon_loss: 818301.2461; train_gene_expr_recon_loss: 29428320.4516; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30280057.4839; train_optim_loss: 30280057.4839; val_kl_reg_loss: 32288.0311; val_edge_recon_loss: 830359.0538; val_gene_expr_recon_loss: 29336098.0860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30198745.2258; val_optim_loss: 30198745.2258
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9404; val_auprc_score: 0.9861; val_best_acc_score: 0.9276; val_best_f1_score: 0.9584; train_kl_reg_loss: 30800.3759; train_edge_recon_loss: 807691.9130; train_gene_expr_recon_loss: 29291990.2867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30130482.5687; train_optim_loss: 30130482.5687; val_kl_reg_loss: 29097.9009; val_edge_recon_loss: 835392.0632; val_gene_expr_recon_loss: 29251125.8280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30115615.8065; val_optim_loss: 30115615.8065
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9451; val_auprc_score: 0.9882; val_best_acc_score: 0.9312; val_best_f1_score: 0.9605; train_kl_reg_loss: 28686.9184; train_edge_recon_loss: 807498.0173; train_gene_expr_recon_loss: 29198864.3059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30035049.2616; train_optim_loss: 30035049.2616; val_kl_reg_loss: 27587.3279; val_edge_recon_loss: 806290.6929; val_gene_expr_recon_loss: 29179892.7957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30013770.8172; val_optim_loss: 30013770.8172
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9439; val_auprc_score: 0.9879; val_best_acc_score: 0.9315; val_best_f1_score: 0.9607; train_kl_reg_loss: 27061.3189; train_edge_recon_loss: 813830.7948; train_gene_expr_recon_loss: 29131033.0060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29971925.1302; train_optim_loss: 29971925.1302; val_kl_reg_loss: 26089.7965; val_edge_recon_loss: 816557.6835; val_gene_expr_recon_loss: 29143808.9462; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29986456.3871; val_optim_loss: 29986456.3871
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9484; val_auprc_score: 0.9884; val_best_acc_score: 0.9347; val_best_f1_score: 0.9624; train_kl_reg_loss: 25619.2758; train_edge_recon_loss: 808360.6642; train_gene_expr_recon_loss: 29088566.2103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29922546.1386; train_optim_loss: 29922546.1386; val_kl_reg_loss: 25390.4722; val_edge_recon_loss: 796921.9126; val_gene_expr_recon_loss: 29051648.6022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29873960.9677; val_optim_loss: 29873960.9677
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9531; val_auprc_score: 0.9898; val_best_acc_score: 0.9380; val_best_f1_score: 0.9640; train_kl_reg_loss: 24527.7878; train_edge_recon_loss: 794446.2880; train_gene_expr_recon_loss: 29051285.8853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29870259.9450; train_optim_loss: 29870259.9450; val_kl_reg_loss: 24413.8481; val_edge_recon_loss: 819978.5766; val_gene_expr_recon_loss: 29069544.3011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29913936.7957; val_optim_loss: 29913936.7957
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9509; val_auprc_score: 0.9890; val_best_acc_score: 0.9405; val_best_f1_score: 0.9656; train_kl_reg_loss: 23513.5354; train_edge_recon_loss: 795743.0752; train_gene_expr_recon_loss: 29025131.6941; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29844388.2987; train_optim_loss: 29844388.2987; val_kl_reg_loss: 23674.5202; val_edge_recon_loss: 797395.9274; val_gene_expr_recon_loss: 29043485.0753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29864555.4409; val_optim_loss: 29864555.4409
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9529; val_auprc_score: 0.9892; val_best_acc_score: 0.9421; val_best_f1_score: 0.9667; train_kl_reg_loss: 22653.5440; train_edge_recon_loss: 795728.7176; train_gene_expr_recon_loss: 29004788.4444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29823170.7168; train_optim_loss: 29823170.7168; val_kl_reg_loss: 22309.3752; val_edge_recon_loss: 808939.5645; val_gene_expr_recon_loss: 28991090.1935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29822339.2258; val_optim_loss: 29822339.2258
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9569; val_auprc_score: 0.9902; val_best_acc_score: 0.9431; val_best_f1_score: 0.9670; train_kl_reg_loss: 21897.1256; train_edge_recon_loss: 792103.2112; train_gene_expr_recon_loss: 28988088.3202; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29802088.6619; train_optim_loss: 29802088.6619; val_kl_reg_loss: 22398.6092; val_edge_recon_loss: 804109.3380; val_gene_expr_recon_loss: 29049778.3441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29876286.3011; val_optim_loss: 29876286.3011
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9586; val_auprc_score: 0.9908; val_best_acc_score: 0.9465; val_best_f1_score: 0.9689; train_kl_reg_loss: 21215.5351; train_edge_recon_loss: 795591.9230; train_gene_expr_recon_loss: 28979782.3847; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29796589.8519; train_optim_loss: 29796589.8519; val_kl_reg_loss: 20965.9440; val_edge_recon_loss: 801680.8642; val_gene_expr_recon_loss: 28992320.5591; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29814967.4624; val_optim_loss: 29814967.4624
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9572; val_auprc_score: 0.9895; val_best_acc_score: 0.9455; val_best_f1_score: 0.9685; train_kl_reg_loss: 20739.7733; train_edge_recon_loss: 785563.7639; train_gene_expr_recon_loss: 28968935.2115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29775238.8029; train_optim_loss: 29775238.8029; val_kl_reg_loss: 20430.0898; val_edge_recon_loss: 809577.1237; val_gene_expr_recon_loss: 28981043.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29811050.5806; val_optim_loss: 29811050.5806
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9610; val_auprc_score: 0.9914; val_best_acc_score: 0.9500; val_best_f1_score: 0.9712; train_kl_reg_loss: 20222.0687; train_edge_recon_loss: 785689.4285; train_gene_expr_recon_loss: 28965206.6237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29771118.0932; train_optim_loss: 29771118.0932; val_kl_reg_loss: 19923.5234; val_edge_recon_loss: 777718.4328; val_gene_expr_recon_loss: 28943026.8387; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29740668.7957; val_optim_loss: 29740668.7957
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9570; val_auprc_score: 0.9896; val_best_acc_score: 0.9456; val_best_f1_score: 0.9685; train_kl_reg_loss: 19695.8161; train_edge_recon_loss: 787389.4899; train_gene_expr_recon_loss: 28961454.1816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29768539.5125; train_optim_loss: 29768539.5125; val_kl_reg_loss: 19572.2119; val_edge_recon_loss: 812090.2386; val_gene_expr_recon_loss: 28959166.0215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29790828.5161; val_optim_loss: 29790828.5161
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9646; val_auprc_score: 0.9923; val_best_acc_score: 0.9505; val_best_f1_score: 0.9713; train_kl_reg_loss: 19324.4517; train_edge_recon_loss: 780961.8312; train_gene_expr_recon_loss: 28949912.5114; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29750198.8100; train_optim_loss: 29750198.8100; val_kl_reg_loss: 19064.0508; val_edge_recon_loss: 791944.0995; val_gene_expr_recon_loss: 28943707.3118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29754715.3978; val_optim_loss: 29754715.3978
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9591; val_auprc_score: 0.9901; val_best_acc_score: 0.9462; val_best_f1_score: 0.9689; train_kl_reg_loss: 19003.9331; train_edge_recon_loss: 784069.5545; train_gene_expr_recon_loss: 28947315.9976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29750389.4743; train_optim_loss: 29750389.4743; val_kl_reg_loss: 19002.4722; val_edge_recon_loss: 796116.5202; val_gene_expr_recon_loss: 28990351.8065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29805470.9032; val_optim_loss: 29805470.9032
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9611; val_auprc_score: 0.9914; val_best_acc_score: 0.9490; val_best_f1_score: 0.9706; train_kl_reg_loss: 18741.7139; train_edge_recon_loss: 781612.5249; train_gene_expr_recon_loss: 28945569.7348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29745923.9809; train_optim_loss: 29745923.9809; val_kl_reg_loss: 18741.5836; val_edge_recon_loss: 775063.6216; val_gene_expr_recon_loss: 28942401.6559; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29736206.7957; val_optim_loss: 29736206.7957
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9505; val_auprc_score: 0.9884; val_best_acc_score: 0.9385; val_best_f1_score: 0.9643; train_kl_reg_loss: 16142.5064; train_edge_recon_loss: 794193.9593; train_gene_expr_recon_loss: 29253412.0239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30063748.4683; train_optim_loss: 30063748.4683; val_kl_reg_loss: 16061.1640; val_edge_recon_loss: 806247.4284; val_gene_expr_recon_loss: 29041386.6022; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29863695.1828; val_optim_loss: 29863695.1828
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9560; val_auprc_score: 0.9904; val_best_acc_score: 0.9429; val_best_f1_score: 0.9670; train_kl_reg_loss: 16126.4958; train_edge_recon_loss: 784483.5676; train_gene_expr_recon_loss: 29028057.2186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29828667.3047; train_optim_loss: 29828667.3047; val_kl_reg_loss: 16291.2898; val_edge_recon_loss: 784180.9657; val_gene_expr_recon_loss: 29020767.9140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29821240.1505; val_optim_loss: 29821240.1505
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9556; val_auprc_score: 0.9899; val_best_acc_score: 0.9420; val_best_f1_score: 0.9665; train_kl_reg_loss: 16016.9703; train_edge_recon_loss: 787704.9654; train_gene_expr_recon_loss: 29005933.6368; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29809655.5627; train_optim_loss: 29809655.5627; val_kl_reg_loss: 15961.0966; val_edge_recon_loss: 814049.9819; val_gene_expr_recon_loss: 29074419.5054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29904430.5806; val_optim_loss: 29904430.5806
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9577; val_auprc_score: 0.9905; val_best_acc_score: 0.9465; val_best_f1_score: 0.9690; train_kl_reg_loss: 15886.1651; train_edge_recon_loss: 784194.7242; train_gene_expr_recon_loss: 28993962.9749; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29794043.8949; train_optim_loss: 29794043.8949; val_kl_reg_loss: 15736.9986; val_edge_recon_loss: 790622.2577; val_gene_expr_recon_loss: 28995964.7742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29802323.9570; val_optim_loss: 29802323.9570

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9578; val_auprc_score: 0.9901; val_best_acc_score: 0.9471; val_best_f1_score: 0.9694; train_kl_reg_loss: 15995.0948; train_edge_recon_loss: 786661.0797; train_gene_expr_recon_loss: 28938279.8925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29740936.0789; train_optim_loss: 29740936.0789; val_kl_reg_loss: 16006.6622; val_edge_recon_loss: 803269.3972; val_gene_expr_recon_loss: 28931421.2903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29750697.2688; val_optim_loss: 29750697.2688
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9559; val_auprc_score: 0.9900; val_best_acc_score: 0.9475; val_best_f1_score: 0.9697; train_kl_reg_loss: 16016.0867; train_edge_recon_loss: 782718.0648; train_gene_expr_recon_loss: 28934429.4194; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29733163.5675; train_optim_loss: 29733163.5675; val_kl_reg_loss: 16102.9017; val_edge_recon_loss: 784002.7056; val_gene_expr_recon_loss: 28932788.7957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29732894.4731; val_optim_loss: 29732894.4731
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9612; val_auprc_score: 0.9908; val_best_acc_score: 0.9492; val_best_f1_score: 0.9706; train_kl_reg_loss: 16110.2504; train_edge_recon_loss: 786390.9111; train_gene_expr_recon_loss: 28931603.5412; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29734104.6834; train_optim_loss: 29734104.6834; val_kl_reg_loss: 16214.4666; val_edge_recon_loss: 786722.3918; val_gene_expr_recon_loss: 28939175.5269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29742112.4516; val_optim_loss: 29742112.4516
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9590; val_auprc_score: 0.9905; val_best_acc_score: 0.9473; val_best_f1_score: 0.9695; train_kl_reg_loss: 16198.0650; train_edge_recon_loss: 786252.4920; train_gene_expr_recon_loss: 28931731.3572; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29734181.9068; train_optim_loss: 29734181.9068; val_kl_reg_loss: 16226.2424; val_edge_recon_loss: 789558.2406; val_gene_expr_recon_loss: 28930149.2473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29735933.6774; val_optim_loss: 29735933.6774
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9589; val_auprc_score: 0.9901; val_best_acc_score: 0.9498; val_best_f1_score: 0.9709; train_kl_reg_loss: 16282.5078; train_edge_recon_loss: 784677.9860; train_gene_expr_recon_loss: 28928959.7706; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29729920.2342; train_optim_loss: 29729920.2342; val_kl_reg_loss: 16388.4819; val_edge_recon_loss: 793831.9946; val_gene_expr_recon_loss: 28943018.4946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29753239.0753; val_optim_loss: 29753239.0753
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9596; val_auprc_score: 0.9908; val_best_acc_score: 0.9470; val_best_f1_score: 0.9693; train_kl_reg_loss: 16353.8144; train_edge_recon_loss: 782201.3635; train_gene_expr_recon_loss: 28926288.3990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29724843.5603; train_optim_loss: 29724843.5603; val_kl_reg_loss: 16523.6430; val_edge_recon_loss: 792632.2947; val_gene_expr_recon_loss: 28933401.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29742557.8280; val_optim_loss: 29742557.8280

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9628; val_auprc_score: 0.9915; val_best_acc_score: 0.9497; val_best_f1_score: 0.9707; train_kl_reg_loss: 16420.4818; train_edge_recon_loss: 782981.6480; train_gene_expr_recon_loss: 28922492.1505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29721894.2820; train_optim_loss: 29721894.2820; val_kl_reg_loss: 16461.7266; val_edge_recon_loss: 804198.8777; val_gene_expr_recon_loss: 28929332.7527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29749993.2473; val_optim_loss: 29749993.2473
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9585; val_auprc_score: 0.9902; val_best_acc_score: 0.9477; val_best_f1_score: 0.9697; train_kl_reg_loss: 16432.1414; train_edge_recon_loss: 780813.6684; train_gene_expr_recon_loss: 28924887.6559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29722133.4910; train_optim_loss: 29722133.4910; val_kl_reg_loss: 16451.2955; val_edge_recon_loss: 790366.0255; val_gene_expr_recon_loss: 28917854.2151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29724671.6129; val_optim_loss: 29724671.6129
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9617; val_auprc_score: 0.9908; val_best_acc_score: 0.9519; val_best_f1_score: 0.9722; train_kl_reg_loss: 16437.2713; train_edge_recon_loss: 786834.2742; train_gene_expr_recon_loss: 28919793.5484; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29723065.1016; train_optim_loss: 29723065.1016; val_kl_reg_loss: 16456.2335; val_edge_recon_loss: 773713.9882; val_gene_expr_recon_loss: 28914190.2366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29704360.4946; val_optim_loss: 29704360.4946
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9591; val_auprc_score: 0.9905; val_best_acc_score: 0.9491; val_best_f1_score: 0.9705; train_kl_reg_loss: 16434.4930; train_edge_recon_loss: 782237.1667; train_gene_expr_recon_loss: 28918211.0060; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29716882.6476; train_optim_loss: 29716882.6476; val_kl_reg_loss: 16504.1524; val_edge_recon_loss: 793240.1767; val_gene_expr_recon_loss: 28925914.0645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29735658.4516; val_optim_loss: 29735658.4516
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9583; val_auprc_score: 0.9903; val_best_acc_score: 0.9490; val_best_f1_score: 0.9706; train_kl_reg_loss: 16443.6184; train_edge_recon_loss: 784245.3123; train_gene_expr_recon_loss: 28919202.0789; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29719891.0179; train_optim_loss: 29719891.0179; val_kl_reg_loss: 16473.1082; val_edge_recon_loss: 785922.6284; val_gene_expr_recon_loss: 28933321.5484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29735717.3548; val_optim_loss: 29735717.3548
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9615; val_auprc_score: 0.9908; val_best_acc_score: 0.9509; val_best_f1_score: 0.9715; train_kl_reg_loss: 16455.4479; train_edge_recon_loss: 778989.1481; train_gene_expr_recon_loss: 28922982.3513; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29718426.9223; train_optim_loss: 29718426.9223; val_kl_reg_loss: 16501.7131; val_edge_recon_loss: 800302.2083; val_gene_expr_recon_loss: 28918671.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29735475.8065; val_optim_loss: 29735475.8065
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9613; val_auprc_score: 0.9914; val_best_acc_score: 0.9510; val_best_f1_score: 0.9717; train_kl_reg_loss: 16465.0991; train_edge_recon_loss: 777510.0924; train_gene_expr_recon_loss: 28918550.4014; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29712525.5986; train_optim_loss: 29712525.5986; val_kl_reg_loss: 16493.9321; val_edge_recon_loss: 769019.2426; val_gene_expr_recon_loss: 28929598.5806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29715111.8710; val_optim_loss: 29715111.8710

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9589; val_auprc_score: 0.9902; val_best_acc_score: 0.9484; val_best_f1_score: 0.9702; train_kl_reg_loss: 16466.4514; train_edge_recon_loss: 788104.8173; train_gene_expr_recon_loss: 28918920.1816; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29723491.4528; train_optim_loss: 29723491.4528; val_kl_reg_loss: 16491.4472; val_edge_recon_loss: 790085.5155; val_gene_expr_recon_loss: 28920710.2366; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29727287.1398; val_optim_loss: 29727287.1398
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9610; val_auprc_score: 0.9912; val_best_acc_score: 0.9485; val_best_f1_score: 0.9701; train_kl_reg_loss: 16465.2948; train_edge_recon_loss: 777888.4723; train_gene_expr_recon_loss: 28919580.5806; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29713934.3321; train_optim_loss: 29713934.3321; val_kl_reg_loss: 16489.2956; val_edge_recon_loss: 792058.9980; val_gene_expr_recon_loss: 28927849.2473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29736397.5269; val_optim_loss: 29736397.5269
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9598; val_auprc_score: 0.9905; val_best_acc_score: 0.9486; val_best_f1_score: 0.9702; train_kl_reg_loss: 16461.8102; train_edge_recon_loss: 783678.7530; train_gene_expr_recon_loss: 28917273.7157; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29717414.2581; train_optim_loss: 29717414.2581; val_kl_reg_loss: 16516.6188; val_edge_recon_loss: 786037.8495; val_gene_expr_recon_loss: 28919779.2258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29722333.6774; val_optim_loss: 29722333.6774
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9592; val_auprc_score: 0.9897; val_best_acc_score: 0.9498; val_best_f1_score: 0.9708; train_kl_reg_loss: 16475.3737; train_edge_recon_loss: 782000.8093; train_gene_expr_recon_loss: 28920197.7037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29718673.8734; train_optim_loss: 29718673.8734; val_kl_reg_loss: 16522.9312; val_edge_recon_loss: 793254.5397; val_gene_expr_recon_loss: 28914359.5914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29724137.0753; val_optim_loss: 29724137.0753

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 114 min 55 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9584
val AUPRC score: 0.9904
val best accuracy score: 0.9493
val best F1 score: 0.9708
val target rna MSE score: 0.9925
val source rna MSE score: 0.3927
Val cat covariate0 mean sim diff: -0.0042

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
