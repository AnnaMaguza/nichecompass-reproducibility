[True]
Run timestamp: 09102023_211832_39.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_39']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7017; val_auprc_score: 0.6789; val_best_acc_score: 0.5062; val_best_f1_score: 0.6687; train_kl_reg_loss: 40683.8614; train_edge_recon_loss: 3514850.2008; train_gene_expr_recon_loss: 14151962.3030; train_masked_gp_l1_reg_loss: 32170.0681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3725424.3371; train_chrom_access_recon_loss: 2327235.8295; train_global_loss: 23792326.4545; train_optim_loss: 23792326.4545; val_kl_reg_loss: 72722.1348; val_edge_recon_loss: 4064547.1875; val_gene_expr_recon_loss: 13087113.5000; val_masked_gp_l1_reg_loss: 38249.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2159566.7500; val_chrom_access_recon_loss: 2227186.3125; val_global_loss: 21649385.2500; val_optim_loss: 21649385.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6750; val_auprc_score: 0.6551; val_best_acc_score: 0.5623; val_best_f1_score: 0.6883; train_kl_reg_loss: 70275.8517; train_edge_recon_loss: 3507565.2273; train_gene_expr_recon_loss: 12939751.9848; train_masked_gp_l1_reg_loss: 41300.4404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1239906.1411; train_chrom_access_recon_loss: 2222171.7538; train_global_loss: 20020971.4242; train_optim_loss: 20020971.4242; val_kl_reg_loss: 69025.9961; val_edge_recon_loss: 4061917.9688; val_gene_expr_recon_loss: 12855208.2500; val_masked_gp_l1_reg_loss: 43949.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 646129.3125; val_chrom_access_recon_loss: 2210775.2188; val_global_loss: 19887007.5000; val_optim_loss: 19887007.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.6743; val_auprc_score: 0.6576; val_best_acc_score: 0.6145; val_best_f1_score: 0.6962; train_kl_reg_loss: 70412.9380; train_edge_recon_loss: 3504722.5492; train_gene_expr_recon_loss: 12729357.1212; train_masked_gp_l1_reg_loss: 45278.7196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 441650.6009; train_chrom_access_recon_loss: 2196391.8504; train_global_loss: 18987813.7576; train_optim_loss: 18987813.7576; val_kl_reg_loss: 75630.2168; val_edge_recon_loss: 4057524.8125; val_gene_expr_recon_loss: 12732974.5000; val_masked_gp_l1_reg_loss: 46340.7305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 297131.9688; val_chrom_access_recon_loss: 2184399.8438; val_global_loss: 19394001.5000; val_optim_loss: 19394001.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7303; val_auprc_score: 0.7155; val_best_acc_score: 0.6612; val_best_f1_score: 0.6982; train_kl_reg_loss: 70067.4060; train_edge_recon_loss: 3498074.8030; train_gene_expr_recon_loss: 12612274.9697; train_masked_gp_l1_reg_loss: 47218.0524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 230206.5490; train_chrom_access_recon_loss: 2184991.5473; train_global_loss: 18642833.3636; train_optim_loss: 18642833.3636; val_kl_reg_loss: 65751.0640; val_edge_recon_loss: 4034639.9688; val_gene_expr_recon_loss: 12587588.7500; val_masked_gp_l1_reg_loss: 48226.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179299.1562; val_chrom_access_recon_loss: 2163476.9062; val_global_loss: 19078982.0000; val_optim_loss: 19078982.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.7860; val_auprc_score: 0.7634; val_best_acc_score: 0.7136; val_best_f1_score: 0.7475; train_kl_reg_loss: 59976.6007; train_edge_recon_loss: 3476575.1742; train_gene_expr_recon_loss: 12526158.3030; train_masked_gp_l1_reg_loss: 49392.4788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151966.5642; train_chrom_access_recon_loss: 2170536.8826; train_global_loss: 18434606.0909; train_optim_loss: 18434606.0909; val_kl_reg_loss: 49462.9248; val_edge_recon_loss: 3617847.2812; val_gene_expr_recon_loss: 12568622.6250; val_masked_gp_l1_reg_loss: 50813.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130907.7266; val_chrom_access_recon_loss: 2153832.0000; val_global_loss: 18571485.7500; val_optim_loss: 18571485.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8106; val_auprc_score: 0.7763; val_best_acc_score: 0.7329; val_best_f1_score: 0.7773; train_kl_reg_loss: 68105.4322; train_edge_recon_loss: 3101228.3220; train_gene_expr_recon_loss: 12472964.1818; train_masked_gp_l1_reg_loss: 53804.1190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120316.7437; train_chrom_access_recon_loss: 2162395.6402; train_global_loss: 17978814.3333; train_optim_loss: 17978814.3333; val_kl_reg_loss: 89899.9248; val_edge_recon_loss: 3046099.6875; val_gene_expr_recon_loss: 12432130.8750; val_masked_gp_l1_reg_loss: 56119.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112988.3203; val_chrom_access_recon_loss: 2152864.3906; val_global_loss: 17890102.2500; val_optim_loss: 17890102.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8635; val_auprc_score: 0.8355; val_best_acc_score: 0.7886; val_best_f1_score: 0.8096; train_kl_reg_loss: 86535.6197; train_edge_recon_loss: 2966485.0795; train_gene_expr_recon_loss: 12372210.4242; train_masked_gp_l1_reg_loss: 57366.1641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106582.8288; train_chrom_access_recon_loss: 2146316.3220; train_global_loss: 17735496.3333; train_optim_loss: 17735496.3333; val_kl_reg_loss: 71300.8506; val_edge_recon_loss: 2932561.2812; val_gene_expr_recon_loss: 12451674.7500; val_masked_gp_l1_reg_loss: 58706.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99761.3438; val_chrom_access_recon_loss: 2142222.5000; val_global_loss: 17756227.5000; val_optim_loss: 17756227.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8774; val_auprc_score: 0.8391; val_best_acc_score: 0.8114; val_best_f1_score: 0.8296; train_kl_reg_loss: 82887.2596; train_edge_recon_loss: 2882193.3523; train_gene_expr_recon_loss: 12321145.6818; train_masked_gp_l1_reg_loss: 60128.6512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93729.6737; train_chrom_access_recon_loss: 2139127.1818; train_global_loss: 17579211.7879; train_optim_loss: 17579211.7879; val_kl_reg_loss: 86411.0527; val_edge_recon_loss: 2889451.0000; val_gene_expr_recon_loss: 12310220.5000; val_masked_gp_l1_reg_loss: 61542.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88715.9375; val_chrom_access_recon_loss: 2124134.9688; val_global_loss: 17560476.2500; val_optim_loss: 17560476.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8936; val_auprc_score: 0.8644; val_best_acc_score: 0.8297; val_best_f1_score: 0.8415; train_kl_reg_loss: 89345.9495; train_edge_recon_loss: 2844611.0682; train_gene_expr_recon_loss: 12254242.4394; train_masked_gp_l1_reg_loss: 62532.4091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85049.1690; train_chrom_access_recon_loss: 2125488.0928; train_global_loss: 17461269.0152; train_optim_loss: 17461269.0152; val_kl_reg_loss: 89503.2197; val_edge_recon_loss: 2856250.8750; val_gene_expr_recon_loss: 12255331.1250; val_masked_gp_l1_reg_loss: 63638.3789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82096.2969; val_chrom_access_recon_loss: 2130539.3125; val_global_loss: 17477358.5000; val_optim_loss: 17477358.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8997; val_auprc_score: 0.8641; val_best_acc_score: 0.8396; val_best_f1_score: 0.8529; train_kl_reg_loss: 90284.3857; train_edge_recon_loss: 2820829.6439; train_gene_expr_recon_loss: 12189798.3939; train_masked_gp_l1_reg_loss: 64374.7322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80469.2041; train_chrom_access_recon_loss: 2115529.3182; train_global_loss: 17361285.6364; train_optim_loss: 17361285.6364; val_kl_reg_loss: 88382.5215; val_edge_recon_loss: 2818975.5000; val_gene_expr_recon_loss: 12318314.5000; val_masked_gp_l1_reg_loss: 65271.2305; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79609.1875; val_chrom_access_recon_loss: 2127991.9688; val_global_loss: 17498544.2500; val_optim_loss: 17498544.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9060; val_auprc_score: 0.8707; val_best_acc_score: 0.8455; val_best_f1_score: 0.8579; train_kl_reg_loss: 87445.1752; train_edge_recon_loss: 2818893.7045; train_gene_expr_recon_loss: 12157898.4697; train_masked_gp_l1_reg_loss: 66057.0765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79375.5380; train_chrom_access_recon_loss: 2110583.2633; train_global_loss: 17320253.1515; train_optim_loss: 17320253.1515; val_kl_reg_loss: 85193.7676; val_edge_recon_loss: 2851410.4375; val_gene_expr_recon_loss: 12205398.7500; val_masked_gp_l1_reg_loss: 66868.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79954.0078; val_chrom_access_recon_loss: 2115315.6094; val_global_loss: 17404140.2500; val_optim_loss: 17404140.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9075; val_auprc_score: 0.8723; val_best_acc_score: 0.8557; val_best_f1_score: 0.8648; train_kl_reg_loss: 85672.8220; train_edge_recon_loss: 2800386.7311; train_gene_expr_recon_loss: 12099516.7727; train_masked_gp_l1_reg_loss: 67628.2672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79296.7964; train_chrom_access_recon_loss: 2104088.0530; train_global_loss: 17236589.3030; train_optim_loss: 17236589.3030; val_kl_reg_loss: 85983.3115; val_edge_recon_loss: 2830395.4375; val_gene_expr_recon_loss: 12097855.3750; val_masked_gp_l1_reg_loss: 68238.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78220.2031; val_chrom_access_recon_loss: 2075081.1094; val_global_loss: 17235773.8750; val_optim_loss: 17235773.8750
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9068; val_auprc_score: 0.8718; val_best_acc_score: 0.8503; val_best_f1_score: 0.8614; train_kl_reg_loss: 85964.7191; train_edge_recon_loss: 2779583.3902; train_gene_expr_recon_loss: 12062629.1212; train_masked_gp_l1_reg_loss: 68898.2660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76952.3267; train_chrom_access_recon_loss: 2097109.7121; train_global_loss: 17171137.5152; train_optim_loss: 17171137.5152; val_kl_reg_loss: 88237.9727; val_edge_recon_loss: 2805856.9062; val_gene_expr_recon_loss: 12043786.1250; val_masked_gp_l1_reg_loss: 69705.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75943.0391; val_chrom_access_recon_loss: 2094103.9219; val_global_loss: 17177633.5000; val_optim_loss: 17177633.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9155; val_auprc_score: 0.8837; val_best_acc_score: 0.8557; val_best_f1_score: 0.8661; train_kl_reg_loss: 83835.1918; train_edge_recon_loss: 2782951.5000; train_gene_expr_recon_loss: 12012752.0303; train_masked_gp_l1_reg_loss: 70150.6615; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74999.8278; train_chrom_access_recon_loss: 2088076.2330; train_global_loss: 17112765.5758; train_optim_loss: 17112765.5758; val_kl_reg_loss: 83547.4473; val_edge_recon_loss: 2805716.5312; val_gene_expr_recon_loss: 11938791.7500; val_masked_gp_l1_reg_loss: 70785.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73942.9219; val_chrom_access_recon_loss: 2072353.2031; val_global_loss: 17045138.2500; val_optim_loss: 17045138.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9163; val_auprc_score: 0.8835; val_best_acc_score: 0.8630; val_best_f1_score: 0.8725; train_kl_reg_loss: 84221.9459; train_edge_recon_loss: 2782041.3030; train_gene_expr_recon_loss: 11975824.9545; train_masked_gp_l1_reg_loss: 71203.8441; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73212.1136; train_chrom_access_recon_loss: 2083284.4375; train_global_loss: 17069788.6212; train_optim_loss: 17069788.6212; val_kl_reg_loss: 79884.8662; val_edge_recon_loss: 2811300.3750; val_gene_expr_recon_loss: 12045491.0000; val_masked_gp_l1_reg_loss: 71674.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72479.2578; val_chrom_access_recon_loss: 2079420.2656; val_global_loss: 17160250.2500; val_optim_loss: 17160250.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9294; val_auprc_score: 0.9067; val_best_acc_score: 0.8665; val_best_f1_score: 0.8728; train_kl_reg_loss: 80974.8819; train_edge_recon_loss: 2766281.4848; train_gene_expr_recon_loss: 11949797.0303; train_masked_gp_l1_reg_loss: 72158.6560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72074.0281; train_chrom_access_recon_loss: 2078098.1742; train_global_loss: 17019384.4091; train_optim_loss: 17019384.4091; val_kl_reg_loss: 79445.8096; val_edge_recon_loss: 2809007.4375; val_gene_expr_recon_loss: 11997584.0000; val_masked_gp_l1_reg_loss: 72621.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71874.7734; val_chrom_access_recon_loss: 2082411.9375; val_global_loss: 17112945.7500; val_optim_loss: 17112945.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9227; val_auprc_score: 0.8972; val_best_acc_score: 0.8622; val_best_f1_score: 0.8715; train_kl_reg_loss: 80993.8151; train_edge_recon_loss: 2762903.2538; train_gene_expr_recon_loss: 11918334.1364; train_masked_gp_l1_reg_loss: 73000.2134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71231.1387; train_chrom_access_recon_loss: 2073069.9242; train_global_loss: 16979532.3939; train_optim_loss: 16979532.3939; val_kl_reg_loss: 79223.8486; val_edge_recon_loss: 2767128.2500; val_gene_expr_recon_loss: 11929234.1250; val_masked_gp_l1_reg_loss: 73367.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70850.9062; val_chrom_access_recon_loss: 2073417.2188; val_global_loss: 16993222.3750; val_optim_loss: 16993222.3750
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9244; val_auprc_score: 0.8995; val_best_acc_score: 0.8641; val_best_f1_score: 0.8737; train_kl_reg_loss: 80168.8885; train_edge_recon_loss: 2754871.3864; train_gene_expr_recon_loss: 11891137.0152; train_masked_gp_l1_reg_loss: 73679.9112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70604.7852; train_chrom_access_recon_loss: 2067695.4754; train_global_loss: 16938157.3788; train_optim_loss: 16938157.3788; val_kl_reg_loss: 81157.6045; val_edge_recon_loss: 2770157.7812; val_gene_expr_recon_loss: 11903109.2500; val_masked_gp_l1_reg_loss: 74059.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70684.9297; val_chrom_access_recon_loss: 2037234.8125; val_global_loss: 16936403.7500; val_optim_loss: 16936403.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9230; val_auprc_score: 0.8959; val_best_acc_score: 0.8667; val_best_f1_score: 0.8753; train_kl_reg_loss: 79719.8260; train_edge_recon_loss: 2755720.9470; train_gene_expr_recon_loss: 11852987.4697; train_masked_gp_l1_reg_loss: 74328.7391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70795.9570; train_chrom_access_recon_loss: 2062327.3807; train_global_loss: 16895880.3030; train_optim_loss: 16895880.3030; val_kl_reg_loss: 77912.9160; val_edge_recon_loss: 2806978.0938; val_gene_expr_recon_loss: 11889535.8750; val_masked_gp_l1_reg_loss: 74786.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71555.0469; val_chrom_access_recon_loss: 2039928.9219; val_global_loss: 16960696.6250; val_optim_loss: 16960696.6250
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9235; val_auprc_score: 0.8936; val_best_acc_score: 0.8646; val_best_f1_score: 0.8739; train_kl_reg_loss: 78417.4757; train_edge_recon_loss: 2754917.7386; train_gene_expr_recon_loss: 11834142.5303; train_masked_gp_l1_reg_loss: 75015.3911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71396.3623; train_chrom_access_recon_loss: 2056911.8220; train_global_loss: 16870801.2121; train_optim_loss: 16870801.2121; val_kl_reg_loss: 77341.2676; val_edge_recon_loss: 2796977.9062; val_gene_expr_recon_loss: 11884724.8750; val_masked_gp_l1_reg_loss: 75393.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72013.3906; val_chrom_access_recon_loss: 2078308.3906; val_global_loss: 16984759.2500; val_optim_loss: 16984759.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9260; val_auprc_score: 0.8881; val_best_acc_score: 0.8713; val_best_f1_score: 0.8802; train_kl_reg_loss: 78556.9033; train_edge_recon_loss: 2738475.8826; train_gene_expr_recon_loss: 11803034.9545; train_masked_gp_l1_reg_loss: 75557.8099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71745.5623; train_chrom_access_recon_loss: 2052575.2746; train_global_loss: 16819946.3788; train_optim_loss: 16819946.3788; val_kl_reg_loss: 77991.8652; val_edge_recon_loss: 2782595.5000; val_gene_expr_recon_loss: 11821522.3750; val_masked_gp_l1_reg_loss: 75825.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71912.9844; val_chrom_access_recon_loss: 2049514.3594; val_global_loss: 16879362.3750; val_optim_loss: 16879362.3750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9256; val_auprc_score: 0.8946; val_best_acc_score: 0.8667; val_best_f1_score: 0.8739; train_kl_reg_loss: 78263.8945; train_edge_recon_loss: 2735424.9394; train_gene_expr_recon_loss: 11788534.7121; train_masked_gp_l1_reg_loss: 76027.5610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72188.8228; train_chrom_access_recon_loss: 2051004.2311; train_global_loss: 16801444.1212; train_optim_loss: 16801444.1212; val_kl_reg_loss: 75044.6650; val_edge_recon_loss: 2786461.9062; val_gene_expr_recon_loss: 11856296.2500; val_masked_gp_l1_reg_loss: 76203.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71976.4219; val_chrom_access_recon_loss: 2064567.4688; val_global_loss: 16930549.3750; val_optim_loss: 16930549.3750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9244; val_auprc_score: 0.8871; val_best_acc_score: 0.8721; val_best_f1_score: 0.8797; train_kl_reg_loss: 76887.5189; train_edge_recon_loss: 2729883.8939; train_gene_expr_recon_loss: 11760427.6212; train_masked_gp_l1_reg_loss: 76466.6880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71977.5102; train_chrom_access_recon_loss: 2044421.7083; train_global_loss: 16760064.9242; train_optim_loss: 16760064.9242; val_kl_reg_loss: 75613.8232; val_edge_recon_loss: 2771573.5938; val_gene_expr_recon_loss: 11764533.6250; val_masked_gp_l1_reg_loss: 76659.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71925.6328; val_chrom_access_recon_loss: 2040988.7812; val_global_loss: 16801296.0000; val_optim_loss: 16801296.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9310; val_auprc_score: 0.9037; val_best_acc_score: 0.8751; val_best_f1_score: 0.8837; train_kl_reg_loss: 75081.0418; train_edge_recon_loss: 2731897.4470; train_gene_expr_recon_loss: 11719937.4848; train_masked_gp_l1_reg_loss: 76882.3915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71691.3946; train_chrom_access_recon_loss: 2038550.8295; train_global_loss: 16714040.4697; train_optim_loss: 16714040.4697; val_kl_reg_loss: 76734.0098; val_edge_recon_loss: 2750776.2812; val_gene_expr_recon_loss: 11805095.7500; val_masked_gp_l1_reg_loss: 77078.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71996.7500; val_chrom_access_recon_loss: 2054819.7969; val_global_loss: 16836501.1250; val_optim_loss: 16836501.1250
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9363; val_auprc_score: 0.9168; val_best_acc_score: 0.8780; val_best_f1_score: 0.8829; train_kl_reg_loss: 75004.5997; train_edge_recon_loss: 2724994.7727; train_gene_expr_recon_loss: 11708179.4697; train_masked_gp_l1_reg_loss: 77321.5603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71856.7817; train_chrom_access_recon_loss: 2036091.7462; train_global_loss: 16693448.8636; train_optim_loss: 16693448.8636; val_kl_reg_loss: 76033.4805; val_edge_recon_loss: 2787432.1562; val_gene_expr_recon_loss: 11775485.3750; val_masked_gp_l1_reg_loss: 77541.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71773.9453; val_chrom_access_recon_loss: 2026391.9219; val_global_loss: 16814659.1250; val_optim_loss: 16814659.1250
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9405; val_auprc_score: 0.9137; val_best_acc_score: 0.8866; val_best_f1_score: 0.8926; train_kl_reg_loss: 75452.1879; train_edge_recon_loss: 2711795.1742; train_gene_expr_recon_loss: 11695938.4697; train_masked_gp_l1_reg_loss: 77712.3556; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71861.1487; train_chrom_access_recon_loss: 2032687.8958; train_global_loss: 16665447.2273; train_optim_loss: 16665447.2273; val_kl_reg_loss: 73667.9502; val_edge_recon_loss: 2748525.0625; val_gene_expr_recon_loss: 11694741.2500; val_masked_gp_l1_reg_loss: 77928.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71669.6328; val_chrom_access_recon_loss: 2019439.2500; val_global_loss: 16685972.6250; val_optim_loss: 16685972.6250
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9408; val_auprc_score: 0.9228; val_best_acc_score: 0.8791; val_best_f1_score: 0.8872; train_kl_reg_loss: 73829.0991; train_edge_recon_loss: 2724984.4318; train_gene_expr_recon_loss: 11665854.1061; train_masked_gp_l1_reg_loss: 78063.9611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71711.7173; train_chrom_access_recon_loss: 2027326.2292; train_global_loss: 16641769.4848; train_optim_loss: 16641769.4848; val_kl_reg_loss: 73816.3057; val_edge_recon_loss: 2767180.7500; val_gene_expr_recon_loss: 11698480.6250; val_masked_gp_l1_reg_loss: 78336.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71860.5781; val_chrom_access_recon_loss: 2027740.5312; val_global_loss: 16717415.3750; val_optim_loss: 16717415.3750
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9368; val_auprc_score: 0.9059; val_best_acc_score: 0.8826; val_best_f1_score: 0.8906; train_kl_reg_loss: 74238.9912; train_edge_recon_loss: 2713734.9773; train_gene_expr_recon_loss: 11653970.4848; train_masked_gp_l1_reg_loss: 78428.8439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71536.4599; train_chrom_access_recon_loss: 2025067.2424; train_global_loss: 16616976.8788; train_optim_loss: 16616976.8788; val_kl_reg_loss: 74522.3193; val_edge_recon_loss: 2738801.6250; val_gene_expr_recon_loss: 11658236.1250; val_masked_gp_l1_reg_loss: 78581.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71147.6094; val_chrom_access_recon_loss: 2016696.7188; val_global_loss: 16637985.5000; val_optim_loss: 16637985.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9459; val_auprc_score: 0.9244; val_best_acc_score: 0.8874; val_best_f1_score: 0.8933; train_kl_reg_loss: 74246.9306; train_edge_recon_loss: 2707443.3144; train_gene_expr_recon_loss: 11629584.4697; train_masked_gp_l1_reg_loss: 78674.1313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71353.4010; train_chrom_access_recon_loss: 2020924.0568; train_global_loss: 16582226.3030; train_optim_loss: 16582226.3030; val_kl_reg_loss: 75068.7402; val_edge_recon_loss: 2736531.4688; val_gene_expr_recon_loss: 11698523.8750; val_masked_gp_l1_reg_loss: 78847.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71229.8281; val_chrom_access_recon_loss: 2031068.4062; val_global_loss: 16691270.7500; val_optim_loss: 16691270.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9446; val_auprc_score: 0.9233; val_best_acc_score: 0.8949; val_best_f1_score: 0.8991; train_kl_reg_loss: 72959.2898; train_edge_recon_loss: 2707673.5152; train_gene_expr_recon_loss: 11613575.1970; train_masked_gp_l1_reg_loss: 78895.0283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71223.0746; train_chrom_access_recon_loss: 2016863.8409; train_global_loss: 16561189.8788; train_optim_loss: 16561189.8788; val_kl_reg_loss: 73517.6719; val_edge_recon_loss: 2741269.3750; val_gene_expr_recon_loss: 11614492.3750; val_masked_gp_l1_reg_loss: 78992.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71719.6562; val_chrom_access_recon_loss: 2023064.2031; val_global_loss: 16603055.5000; val_optim_loss: 16603055.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9474; val_auprc_score: 0.9280; val_best_acc_score: 0.8890; val_best_f1_score: 0.8946; train_kl_reg_loss: 72362.9363; train_edge_recon_loss: 2710269.6970; train_gene_expr_recon_loss: 11602258.3788; train_masked_gp_l1_reg_loss: 79237.1745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71520.9248; train_chrom_access_recon_loss: 2014623.1591; train_global_loss: 16550272.1970; train_optim_loss: 16550272.1970; val_kl_reg_loss: 72987.1543; val_edge_recon_loss: 2741819.3750; val_gene_expr_recon_loss: 11638183.0000; val_masked_gp_l1_reg_loss: 79326.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71122.2031; val_chrom_access_recon_loss: 2021179.8281; val_global_loss: 16624617.5000; val_optim_loss: 16624617.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9525; val_auprc_score: 0.9315; val_best_acc_score: 0.8971; val_best_f1_score: 0.9031; train_kl_reg_loss: 72474.7681; train_edge_recon_loss: 2712422.8030; train_gene_expr_recon_loss: 11591956.3485; train_masked_gp_l1_reg_loss: 79365.0855; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71233.6101; train_chrom_access_recon_loss: 2013289.2140; train_global_loss: 16540741.7424; train_optim_loss: 16540741.7424; val_kl_reg_loss: 73790.4297; val_edge_recon_loss: 2727873.4375; val_gene_expr_recon_loss: 11635311.7500; val_masked_gp_l1_reg_loss: 79473.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71081.5078; val_chrom_access_recon_loss: 2016208.1562; val_global_loss: 16603738.3750; val_optim_loss: 16603738.3750
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9468; val_auprc_score: 0.9234; val_best_acc_score: 0.8925; val_best_f1_score: 0.8987; train_kl_reg_loss: 72966.0863; train_edge_recon_loss: 2698181.3220; train_gene_expr_recon_loss: 11562714.7727; train_masked_gp_l1_reg_loss: 79557.0375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71004.2225; train_chrom_access_recon_loss: 2007386.2159; train_global_loss: 16491809.6212; train_optim_loss: 16491809.6212; val_kl_reg_loss: 73801.1025; val_edge_recon_loss: 2731636.4688; val_gene_expr_recon_loss: 11573644.1250; val_masked_gp_l1_reg_loss: 79632.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70827.7031; val_chrom_access_recon_loss: 2008130.1250; val_global_loss: 16537671.8750; val_optim_loss: 16537671.8750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9501; val_auprc_score: 0.9249; val_best_acc_score: 0.8998; val_best_f1_score: 0.9051; train_kl_reg_loss: 71593.4671; train_edge_recon_loss: 2698131.7538; train_gene_expr_recon_loss: 11567252.9394; train_masked_gp_l1_reg_loss: 79613.0597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70728.6232; train_chrom_access_recon_loss: 2010072.3220; train_global_loss: 16497392.1818; train_optim_loss: 16497392.1818; val_kl_reg_loss: 71984.8916; val_edge_recon_loss: 2737581.8750; val_gene_expr_recon_loss: 11610023.2500; val_masked_gp_l1_reg_loss: 79869.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70936.4844; val_chrom_access_recon_loss: 1997351.7188; val_global_loss: 16567746.6250; val_optim_loss: 16567746.6250
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9491; val_auprc_score: 0.9259; val_best_acc_score: 0.8971; val_best_f1_score: 0.9005; train_kl_reg_loss: 72290.1075; train_edge_recon_loss: 2699126.0530; train_gene_expr_recon_loss: 11544023.4545; train_masked_gp_l1_reg_loss: 79921.9013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70935.3239; train_chrom_access_recon_loss: 2004669.3902; train_global_loss: 16470966.2424; train_optim_loss: 16470966.2424; val_kl_reg_loss: 73536.2461; val_edge_recon_loss: 2740015.4375; val_gene_expr_recon_loss: 11547994.5000; val_masked_gp_l1_reg_loss: 79881.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70843.5625; val_chrom_access_recon_loss: 2000075.9688; val_global_loss: 16512347.8750; val_optim_loss: 16512347.8750
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9530; val_auprc_score: 0.9296; val_best_acc_score: 0.8990; val_best_f1_score: 0.9049; train_kl_reg_loss: 72746.8060; train_edge_recon_loss: 2689252.5189; train_gene_expr_recon_loss: 11532658.5455; train_masked_gp_l1_reg_loss: 79907.1048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70629.2956; train_chrom_access_recon_loss: 2001964.8258; train_global_loss: 16447159.0758; train_optim_loss: 16447159.0758; val_kl_reg_loss: 72922.1748; val_edge_recon_loss: 2723180.8125; val_gene_expr_recon_loss: 11593431.5000; val_masked_gp_l1_reg_loss: 79961.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70410.2344; val_chrom_access_recon_loss: 2005734.4062; val_global_loss: 16545640.8750; val_optim_loss: 16545640.8750
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9547; val_auprc_score: 0.9336; val_best_acc_score: 0.9014; val_best_f1_score: 0.9055; train_kl_reg_loss: 71201.8393; train_edge_recon_loss: 2693982.8902; train_gene_expr_recon_loss: 11524536.6970; train_masked_gp_l1_reg_loss: 80024.5885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70308.7869; train_chrom_access_recon_loss: 2000325.7292; train_global_loss: 16440380.6212; train_optim_loss: 16440380.6212; val_kl_reg_loss: 68918.4844; val_edge_recon_loss: 2724884.6562; val_gene_expr_recon_loss: 11515620.2500; val_masked_gp_l1_reg_loss: 80140.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70320.5000; val_chrom_access_recon_loss: 1988368.2969; val_global_loss: 16448251.6250; val_optim_loss: 16448251.6250
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9467; val_auprc_score: 0.9255; val_best_acc_score: 0.9001; val_best_f1_score: 0.9040; train_kl_reg_loss: 70908.7818; train_edge_recon_loss: 2702030.8220; train_gene_expr_recon_loss: 11512683.9091; train_masked_gp_l1_reg_loss: 80222.3725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70269.4503; train_chrom_access_recon_loss: 1995654.5417; train_global_loss: 16431769.9091; train_optim_loss: 16431769.9091; val_kl_reg_loss: 71291.7900; val_edge_recon_loss: 2719109.7812; val_gene_expr_recon_loss: 11666682.2500; val_masked_gp_l1_reg_loss: 80240.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70539.4141; val_chrom_access_recon_loss: 2016348.9688; val_global_loss: 16624212.7500; val_optim_loss: 16624212.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9577; val_auprc_score: 0.9399; val_best_acc_score: 0.9078; val_best_f1_score: 0.9103; train_kl_reg_loss: 71905.9851; train_edge_recon_loss: 2690450.0644; train_gene_expr_recon_loss: 11504767.6515; train_masked_gp_l1_reg_loss: 80229.1957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70557.0580; train_chrom_access_recon_loss: 1996878.1193; train_global_loss: 16414788.1364; train_optim_loss: 16414788.1364; val_kl_reg_loss: 73643.6885; val_edge_recon_loss: 2715189.1562; val_gene_expr_recon_loss: 11561919.5000; val_masked_gp_l1_reg_loss: 80284.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70700.5312; val_chrom_access_recon_loss: 1995011.3438; val_global_loss: 16496748.7500; val_optim_loss: 16496748.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9565; val_auprc_score: 0.9399; val_best_acc_score: 0.9035; val_best_f1_score: 0.9065; train_kl_reg_loss: 71781.2371; train_edge_recon_loss: 2689433.1591; train_gene_expr_recon_loss: 11491529.6667; train_masked_gp_l1_reg_loss: 80299.4650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70470.4457; train_chrom_access_recon_loss: 1993152.5833; train_global_loss: 16396666.6970; train_optim_loss: 16396666.6970; val_kl_reg_loss: 71648.8848; val_edge_recon_loss: 2721409.7812; val_gene_expr_recon_loss: 11541304.2500; val_masked_gp_l1_reg_loss: 80377.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70443.0703; val_chrom_access_recon_loss: 2007059.0156; val_global_loss: 16492241.7500; val_optim_loss: 16492241.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9549; val_auprc_score: 0.9335; val_best_acc_score: 0.9078; val_best_f1_score: 0.9119; train_kl_reg_loss: 71231.6720; train_edge_recon_loss: 2690863.9924; train_gene_expr_recon_loss: 11467723.0909; train_masked_gp_l1_reg_loss: 80331.9841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70293.1023; train_chrom_access_recon_loss: 1989698.7879; train_global_loss: 16370142.6667; train_optim_loss: 16370142.6667; val_kl_reg_loss: 71063.6504; val_edge_recon_loss: 2721457.3438; val_gene_expr_recon_loss: 11545972.0000; val_masked_gp_l1_reg_loss: 80425.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70384.8047; val_chrom_access_recon_loss: 1976999.8125; val_global_loss: 16466302.7500; val_optim_loss: 16466302.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9593; val_auprc_score: 0.9436; val_best_acc_score: 0.9100; val_best_f1_score: 0.9132; train_kl_reg_loss: 71295.0411; train_edge_recon_loss: 2695914.2538; train_gene_expr_recon_loss: 11460852.0455; train_masked_gp_l1_reg_loss: 79714.0380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57941.8241; train_chrom_access_recon_loss: 1986501.4981; train_global_loss: 16352218.7273; train_optim_loss: 16352218.7273; val_kl_reg_loss: 71606.3887; val_edge_recon_loss: 2692752.5312; val_gene_expr_recon_loss: 11587179.0000; val_masked_gp_l1_reg_loss: 79355.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54784.9688; val_chrom_access_recon_loss: 2011109.0000; val_global_loss: 16496786.7500; val_optim_loss: 16496786.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9607; val_auprc_score: 0.9465; val_best_acc_score: 0.9078; val_best_f1_score: 0.9115; train_kl_reg_loss: 71825.6370; train_edge_recon_loss: 2688542.2917; train_gene_expr_recon_loss: 11465671.0152; train_masked_gp_l1_reg_loss: 79280.8812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54352.8637; train_chrom_access_recon_loss: 1987965.2311; train_global_loss: 16347637.6970; train_optim_loss: 16347637.6970; val_kl_reg_loss: 72040.5938; val_edge_recon_loss: 2727236.7188; val_gene_expr_recon_loss: 11462985.8750; val_masked_gp_l1_reg_loss: 79239.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54056.3047; val_chrom_access_recon_loss: 1988704.4062; val_global_loss: 16384263.7500; val_optim_loss: 16384263.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9574; val_auprc_score: 0.9380; val_best_acc_score: 0.9111; val_best_f1_score: 0.9154; train_kl_reg_loss: 72372.7865; train_edge_recon_loss: 2690544.0871; train_gene_expr_recon_loss: 11460223.0303; train_masked_gp_l1_reg_loss: 79235.4992; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53891.5239; train_chrom_access_recon_loss: 1987102.8182; train_global_loss: 16343369.6667; train_optim_loss: 16343369.6667; val_kl_reg_loss: 73081.0918; val_edge_recon_loss: 2701596.8438; val_gene_expr_recon_loss: 11685975.2500; val_masked_gp_l1_reg_loss: 79225.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53680.9648; val_chrom_access_recon_loss: 2000470.9062; val_global_loss: 16594031.0000; val_optim_loss: 16594031.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9537; val_auprc_score: 0.9366; val_best_acc_score: 0.9001; val_best_f1_score: 0.9054; train_kl_reg_loss: 72560.1074; train_edge_recon_loss: 2687880.4015; train_gene_expr_recon_loss: 11458889.6364; train_masked_gp_l1_reg_loss: 79222.1055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53560.0401; train_chrom_access_recon_loss: 1985862.4773; train_global_loss: 16337974.7879; train_optim_loss: 16337974.7879; val_kl_reg_loss: 73142.3750; val_edge_recon_loss: 2735522.6875; val_gene_expr_recon_loss: 11566824.6250; val_masked_gp_l1_reg_loss: 79211.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53454.6016; val_chrom_access_recon_loss: 1987503.7812; val_global_loss: 16495659.6250; val_optim_loss: 16495659.6250
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9589; val_auprc_score: 0.9429; val_best_acc_score: 0.9105; val_best_f1_score: 0.9140; train_kl_reg_loss: 72396.6299; train_edge_recon_loss: 2689994.4205; train_gene_expr_recon_loss: 11446614.1515; train_masked_gp_l1_reg_loss: 79216.9422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53367.6058; train_chrom_access_recon_loss: 1983202.0720; train_global_loss: 16324791.8939; train_optim_loss: 16324791.8939; val_kl_reg_loss: 72710.1865; val_edge_recon_loss: 2686259.7188; val_gene_expr_recon_loss: 11428366.2500; val_masked_gp_l1_reg_loss: 79223.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53322.0977; val_chrom_access_recon_loss: 1978100.0938; val_global_loss: 16297982.2500; val_optim_loss: 16297982.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9543; val_auprc_score: 0.9361; val_best_acc_score: 0.9057; val_best_f1_score: 0.9109; train_kl_reg_loss: 72492.0258; train_edge_recon_loss: 2680839.0947; train_gene_expr_recon_loss: 11451256.5606; train_masked_gp_l1_reg_loss: 79220.7713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53211.5655; train_chrom_access_recon_loss: 1984245.4527; train_global_loss: 16321265.4545; train_optim_loss: 16321265.4545; val_kl_reg_loss: 72960.5957; val_edge_recon_loss: 2706853.6875; val_gene_expr_recon_loss: 11493068.0000; val_masked_gp_l1_reg_loss: 79223.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53137.8828; val_chrom_access_recon_loss: 1982874.1562; val_global_loss: 16388118.5000; val_optim_loss: 16388118.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9541; val_auprc_score: 0.9318; val_best_acc_score: 0.9076; val_best_f1_score: 0.9125; train_kl_reg_loss: 73047.3020; train_edge_recon_loss: 2683293.4318; train_gene_expr_recon_loss: 11446475.0152; train_masked_gp_l1_reg_loss: 79226.1887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53062.2060; train_chrom_access_recon_loss: 1983313.9886; train_global_loss: 16318418.1364; train_optim_loss: 16318418.1364; val_kl_reg_loss: 73872.5703; val_edge_recon_loss: 2710497.8438; val_gene_expr_recon_loss: 11571511.2500; val_masked_gp_l1_reg_loss: 79234.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52979.2070; val_chrom_access_recon_loss: 1980640.4375; val_global_loss: 16468735.1250; val_optim_loss: 16468735.1250
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9575; val_auprc_score: 0.9413; val_best_acc_score: 0.9076; val_best_f1_score: 0.9111; train_kl_reg_loss: 73604.5477; train_edge_recon_loss: 2681355.8788; train_gene_expr_recon_loss: 11454599.2727; train_masked_gp_l1_reg_loss: 79236.4598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52915.5181; train_chrom_access_recon_loss: 1985852.8011; train_global_loss: 16327564.5152; train_optim_loss: 16327564.5152; val_kl_reg_loss: 73994.5830; val_edge_recon_loss: 2723145.5625; val_gene_expr_recon_loss: 11544048.6250; val_masked_gp_l1_reg_loss: 79242.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52817.7969; val_chrom_access_recon_loss: 1977053.2031; val_global_loss: 16450302.1250; val_optim_loss: 16450302.1250
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9552; val_auprc_score: 0.9345; val_best_acc_score: 0.9111; val_best_f1_score: 0.9155; train_kl_reg_loss: 73216.8990; train_edge_recon_loss: 2679630.2803; train_gene_expr_recon_loss: 11452141.6818; train_masked_gp_l1_reg_loss: 79234.4303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52752.9016; train_chrom_access_recon_loss: 1984628.4223; train_global_loss: 16321604.6818; train_optim_loss: 16321604.6818; val_kl_reg_loss: 73495.4795; val_edge_recon_loss: 2703609.4688; val_gene_expr_recon_loss: 11498145.8750; val_masked_gp_l1_reg_loss: 79233.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52697.6172; val_chrom_access_recon_loss: 1979306.1094; val_global_loss: 16386487.7500; val_optim_loss: 16386487.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9571; val_auprc_score: 0.9346; val_best_acc_score: 0.9113; val_best_f1_score: 0.9158; train_kl_reg_loss: 73425.0105; train_edge_recon_loss: 2681412.7538; train_gene_expr_recon_loss: 11453197.2879; train_masked_gp_l1_reg_loss: 79168.0018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51483.6666; train_chrom_access_recon_loss: 1984791.3598; train_global_loss: 16323478.0000; train_optim_loss: 16323478.0000; val_kl_reg_loss: 73389.3896; val_edge_recon_loss: 2717119.9062; val_gene_expr_recon_loss: 11452733.7500; val_masked_gp_l1_reg_loss: 79131.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51199.1914; val_chrom_access_recon_loss: 1974788.3906; val_global_loss: 16348361.3750; val_optim_loss: 16348361.3750
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9552; val_auprc_score: 0.9378; val_best_acc_score: 0.9068; val_best_f1_score: 0.9087; train_kl_reg_loss: 73437.6016; train_edge_recon_loss: 2673018.6288; train_gene_expr_recon_loss: 11455140.7424; train_masked_gp_l1_reg_loss: 79119.5883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51156.0852; train_chrom_access_recon_loss: 1986312.5928; train_global_loss: 16318185.1667; train_optim_loss: 16318185.1667; val_kl_reg_loss: 74041.8623; val_edge_recon_loss: 2729912.1875; val_gene_expr_recon_loss: 11459696.2500; val_masked_gp_l1_reg_loss: 79111.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51120.0391; val_chrom_access_recon_loss: 1974038.0625; val_global_loss: 16367920.5000; val_optim_loss: 16367920.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9513; val_auprc_score: 0.9297; val_best_acc_score: 0.9054; val_best_f1_score: 0.9101; train_kl_reg_loss: 73492.8911; train_edge_recon_loss: 2681023.9242; train_gene_expr_recon_loss: 11448527.3030; train_masked_gp_l1_reg_loss: 79107.5304; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51095.4709; train_chrom_access_recon_loss: 1984800.3617; train_global_loss: 16318047.5606; train_optim_loss: 16318047.5606; val_kl_reg_loss: 73550.1641; val_edge_recon_loss: 2727492.8750; val_gene_expr_recon_loss: 11532259.5000; val_masked_gp_l1_reg_loss: 79103.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51072.9492; val_chrom_access_recon_loss: 1987531.7969; val_global_loss: 16451011.5000; val_optim_loss: 16451011.5000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9590; val_auprc_score: 0.9390; val_best_acc_score: 0.9089; val_best_f1_score: 0.9136; train_kl_reg_loss: 73324.0344; train_edge_recon_loss: 2677352.3258; train_gene_expr_recon_loss: 11451019.3939; train_masked_gp_l1_reg_loss: 79103.3129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51056.9492; train_chrom_access_recon_loss: 1984151.3428; train_global_loss: 16316007.3182; train_optim_loss: 16316007.3182; val_kl_reg_loss: 73266.0273; val_edge_recon_loss: 2722848.3438; val_gene_expr_recon_loss: 11551014.6250; val_masked_gp_l1_reg_loss: 79100.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51040.0508; val_chrom_access_recon_loss: 1979211.6094; val_global_loss: 16456481.5000; val_optim_loss: 16456481.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 36 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9559
val AUPRC score: 0.9350
val best accuracy score: 0.9076
val best F1 score: 0.9108
val target rna MSE score: 1.1988
val source rna MSE score: 0.7257
val target atac MSE score: 0.3265
val source atac MSE score: 0.1346
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
