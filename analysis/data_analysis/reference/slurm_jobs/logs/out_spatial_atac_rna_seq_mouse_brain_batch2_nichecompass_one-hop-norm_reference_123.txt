[True]
Run timestamp: 10102023_031233_123.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_123']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6902; val_auprc_score: 0.6622; val_best_acc_score: 0.5215; val_best_f1_score: 0.6752; train_kl_reg_loss: 62022.4489; train_edge_recon_loss: 3508607.6136; train_gene_expr_recon_loss: 13873291.1061; train_masked_gp_l1_reg_loss: 45238.0924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5548594.8182; train_chrom_access_recon_loss: 4961898.2197; train_global_loss: 27999652.0909; train_optim_loss: 27999652.0909; val_kl_reg_loss: 103707.6094; val_edge_recon_loss: 4064127.8750; val_gene_expr_recon_loss: 12749402.7500; val_masked_gp_l1_reg_loss: 50741.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2547890.7500; val_chrom_access_recon_loss: 4676116.7500; val_global_loss: 24191986.7500; val_optim_loss: 24191986.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7100; val_auprc_score: 0.6884; val_best_acc_score: 0.6397; val_best_f1_score: 0.7057; train_kl_reg_loss: 100690.7994; train_edge_recon_loss: 3520395.0227; train_gene_expr_recon_loss: 12777665.3939; train_masked_gp_l1_reg_loss: 53110.2711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1158319.9389; train_chrom_access_recon_loss: 4739347.6136; train_global_loss: 22349528.9394; train_optim_loss: 22349528.9394; val_kl_reg_loss: 91266.8877; val_edge_recon_loss: 4053630.5938; val_gene_expr_recon_loss: 12536762.3750; val_masked_gp_l1_reg_loss: 55479.6602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 449305.4375; val_chrom_access_recon_loss: 4589318.3125; val_global_loss: 21775763.5000; val_optim_loss: 21775763.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7713; val_auprc_score: 0.7474; val_best_acc_score: 0.7007; val_best_f1_score: 0.7327; train_kl_reg_loss: 87335.6966; train_edge_recon_loss: 3508252.0871; train_gene_expr_recon_loss: 12659642.0303; train_masked_gp_l1_reg_loss: 57059.9608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 301239.9420; train_chrom_access_recon_loss: 4707236.3864; train_global_loss: 21320766.1818; train_optim_loss: 21320766.1818; val_kl_reg_loss: 96162.2725; val_edge_recon_loss: 3891378.1562; val_gene_expr_recon_loss: 12496524.6250; val_masked_gp_l1_reg_loss: 58929.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 214601.7500; val_chrom_access_recon_loss: 4609986.3125; val_global_loss: 21367583.2500; val_optim_loss: 21367583.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8508; val_auprc_score: 0.8236; val_best_acc_score: 0.7749; val_best_f1_score: 0.7996; train_kl_reg_loss: 72986.8136; train_edge_recon_loss: 3248160.2689; train_gene_expr_recon_loss: 12594484.9394; train_masked_gp_l1_reg_loss: 61825.6654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180103.4467; train_chrom_access_recon_loss: 4680111.1515; train_global_loss: 20837672.2424; train_optim_loss: 20837672.2424; val_kl_reg_loss: 104583.6826; val_edge_recon_loss: 3019512.0000; val_gene_expr_recon_loss: 12455131.2500; val_masked_gp_l1_reg_loss: 65661.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 153819.5469; val_chrom_access_recon_loss: 4605579.0625; val_global_loss: 20404287.0000; val_optim_loss: 20404287.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8648; val_auprc_score: 0.8289; val_best_acc_score: 0.7953; val_best_f1_score: 0.8228; train_kl_reg_loss: 113339.3728; train_edge_recon_loss: 2902319.9811; train_gene_expr_recon_loss: 12522912.1818; train_masked_gp_l1_reg_loss: 68108.6725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138494.4616; train_chrom_access_recon_loss: 4647163.5606; train_global_loss: 20392338.2424; train_optim_loss: 20392338.2424; val_kl_reg_loss: 112265.3418; val_edge_recon_loss: 2872632.8125; val_gene_expr_recon_loss: 12376122.2500; val_masked_gp_l1_reg_loss: 70175.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127527.3906; val_chrom_access_recon_loss: 4582287.3750; val_global_loss: 20141010.7500; val_optim_loss: 20141010.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8652; val_auprc_score: 0.8174; val_best_acc_score: 0.8106; val_best_f1_score: 0.8267; train_kl_reg_loss: 110545.2302; train_edge_recon_loss: 2869386.7765; train_gene_expr_recon_loss: 12461525.3939; train_masked_gp_l1_reg_loss: 71545.8363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120074.5651; train_chrom_access_recon_loss: 4630440.6515; train_global_loss: 20263518.5758; train_optim_loss: 20263518.5758; val_kl_reg_loss: 114102.6895; val_edge_recon_loss: 2866844.2500; val_gene_expr_recon_loss: 12428828.6250; val_masked_gp_l1_reg_loss: 72879.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114601.1016; val_chrom_access_recon_loss: 4557647.2500; val_global_loss: 20154903.5000; val_optim_loss: 20154903.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8759; val_auprc_score: 0.8329; val_best_acc_score: 0.8125; val_best_f1_score: 0.8299; train_kl_reg_loss: 107130.0599; train_edge_recon_loss: 2851733.7045; train_gene_expr_recon_loss: 12382864.0152; train_masked_gp_l1_reg_loss: 73973.7923; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112458.8645; train_chrom_access_recon_loss: 4602625.2500; train_global_loss: 20130785.6364; train_optim_loss: 20130785.6364; val_kl_reg_loss: 106117.9619; val_edge_recon_loss: 2890566.2500; val_gene_expr_recon_loss: 12255930.2500; val_masked_gp_l1_reg_loss: 75469.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110223.3750; val_chrom_access_recon_loss: 4507229.8750; val_global_loss: 19945537.7500; val_optim_loss: 19945537.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8808; val_auprc_score: 0.8386; val_best_acc_score: 0.8203; val_best_f1_score: 0.8356; train_kl_reg_loss: 106188.3819; train_edge_recon_loss: 2838923.4205; train_gene_expr_recon_loss: 12317989.5606; train_masked_gp_l1_reg_loss: 76459.8964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108144.8278; train_chrom_access_recon_loss: 4581429.2576; train_global_loss: 20029135.3333; train_optim_loss: 20029135.3333; val_kl_reg_loss: 107873.8379; val_edge_recon_loss: 2864129.6250; val_gene_expr_recon_loss: 12140031.3750; val_masked_gp_l1_reg_loss: 77512.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107403.4531; val_chrom_access_recon_loss: 4502134.9375; val_global_loss: 19799085.5000; val_optim_loss: 19799085.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8874; val_auprc_score: 0.8545; val_best_acc_score: 0.8278; val_best_f1_score: 0.8422; train_kl_reg_loss: 104424.3482; train_edge_recon_loss: 2824526.8144; train_gene_expr_recon_loss: 12254217.1515; train_masked_gp_l1_reg_loss: 78308.8237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106236.3777; train_chrom_access_recon_loss: 4560286.4091; train_global_loss: 19927999.9091; train_optim_loss: 19927999.9091; val_kl_reg_loss: 101494.4414; val_edge_recon_loss: 2893093.5625; val_gene_expr_recon_loss: 12179859.1250; val_masked_gp_l1_reg_loss: 79353.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106027.9922; val_chrom_access_recon_loss: 4476792.0000; val_global_loss: 19836620.2500; val_optim_loss: 19836620.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9003; val_auprc_score: 0.8719; val_best_acc_score: 0.8385; val_best_f1_score: 0.8519; train_kl_reg_loss: 101107.7348; train_edge_recon_loss: 2815237.7159; train_gene_expr_recon_loss: 12219345.6970; train_masked_gp_l1_reg_loss: 80092.7603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104722.1954; train_chrom_access_recon_loss: 4553100.0909; train_global_loss: 19873606.1818; train_optim_loss: 19873606.1818; val_kl_reg_loss: 102727.1064; val_edge_recon_loss: 2837670.2812; val_gene_expr_recon_loss: 12133380.0000; val_masked_gp_l1_reg_loss: 80955.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103680.2109; val_chrom_access_recon_loss: 4525822.0625; val_global_loss: 19784234.5000; val_optim_loss: 19784234.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9131; val_auprc_score: 0.8873; val_best_acc_score: 0.8517; val_best_f1_score: 0.8624; train_kl_reg_loss: 99036.3388; train_edge_recon_loss: 2817090.1553; train_gene_expr_recon_loss: 12162861.8182; train_masked_gp_l1_reg_loss: 81660.1372; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102992.0167; train_chrom_access_recon_loss: 4532535.3258; train_global_loss: 19796175.6364; train_optim_loss: 19796175.6364; val_kl_reg_loss: 101896.6836; val_edge_recon_loss: 2794618.6250; val_gene_expr_recon_loss: 12112049.1250; val_masked_gp_l1_reg_loss: 82332.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102251.3438; val_chrom_access_recon_loss: 4490402.6875; val_global_loss: 19683550.2500; val_optim_loss: 19683550.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9062; val_auprc_score: 0.8626; val_best_acc_score: 0.8455; val_best_f1_score: 0.8562; train_kl_reg_loss: 98070.8465; train_edge_recon_loss: 2800376.1326; train_gene_expr_recon_loss: 12115948.0606; train_masked_gp_l1_reg_loss: 82877.6490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101297.0191; train_chrom_access_recon_loss: 4515142.7273; train_global_loss: 19713712.3939; train_optim_loss: 19713712.3939; val_kl_reg_loss: 96083.0371; val_edge_recon_loss: 2844403.3438; val_gene_expr_recon_loss: 12038507.8750; val_masked_gp_l1_reg_loss: 83479.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100694.5625; val_chrom_access_recon_loss: 4472452.1875; val_global_loss: 19635620.5000; val_optim_loss: 19635620.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9103; val_auprc_score: 0.8828; val_best_acc_score: 0.8522; val_best_f1_score: 0.8623; train_kl_reg_loss: 95475.5211; train_edge_recon_loss: 2773484.0568; train_gene_expr_recon_loss: 12073371.4091; train_masked_gp_l1_reg_loss: 84022.1014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99548.8906; train_chrom_access_recon_loss: 4494679.7045; train_global_loss: 19620581.6970; train_optim_loss: 19620581.6970; val_kl_reg_loss: 96384.8320; val_edge_recon_loss: 2802662.4688; val_gene_expr_recon_loss: 12057123.1250; val_masked_gp_l1_reg_loss: 84743.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98729.0000; val_chrom_access_recon_loss: 4423213.6250; val_global_loss: 19562857.0000; val_optim_loss: 19562857.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9162; val_auprc_score: 0.8902; val_best_acc_score: 0.8552; val_best_f1_score: 0.8665; train_kl_reg_loss: 95297.3256; train_edge_recon_loss: 2769096.2386; train_gene_expr_recon_loss: 12031086.3939; train_masked_gp_l1_reg_loss: 85213.4255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97661.3819; train_chrom_access_recon_loss: 4477956.7159; train_global_loss: 19556311.3333; train_optim_loss: 19556311.3333; val_kl_reg_loss: 95544.1826; val_edge_recon_loss: 2802536.3125; val_gene_expr_recon_loss: 11992190.8750; val_masked_gp_l1_reg_loss: 85697.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97629.8359; val_chrom_access_recon_loss: 4458055.8750; val_global_loss: 19531655.2500; val_optim_loss: 19531655.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9127; val_auprc_score: 0.8841; val_best_acc_score: 0.8525; val_best_f1_score: 0.8638; train_kl_reg_loss: 92654.1932; train_edge_recon_loss: 2781391.1212; train_gene_expr_recon_loss: 11996679.6515; train_masked_gp_l1_reg_loss: 86106.0748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96441.0722; train_chrom_access_recon_loss: 4465528.7424; train_global_loss: 19518800.8788; train_optim_loss: 19518800.8788; val_kl_reg_loss: 95152.5400; val_edge_recon_loss: 2828720.3438; val_gene_expr_recon_loss: 11875013.3750; val_masked_gp_l1_reg_loss: 86574.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95747.7891; val_chrom_access_recon_loss: 4404422.8750; val_global_loss: 19385631.0000; val_optim_loss: 19385631.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9236; val_auprc_score: 0.8942; val_best_acc_score: 0.8589; val_best_f1_score: 0.8686; train_kl_reg_loss: 92308.4640; train_edge_recon_loss: 2767036.9697; train_gene_expr_recon_loss: 11963820.6970; train_masked_gp_l1_reg_loss: 86935.0388; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94794.6709; train_chrom_access_recon_loss: 4453142.5833; train_global_loss: 19458038.5152; train_optim_loss: 19458038.5152; val_kl_reg_loss: 95642.6826; val_edge_recon_loss: 2788711.7500; val_gene_expr_recon_loss: 11820591.8750; val_masked_gp_l1_reg_loss: 87417.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94137.8203; val_chrom_access_recon_loss: 4410988.8750; val_global_loss: 19297490.0000; val_optim_loss: 19297490.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9159; val_auprc_score: 0.8808; val_best_acc_score: 0.8589; val_best_f1_score: 0.8668; train_kl_reg_loss: 93053.2741; train_edge_recon_loss: 2748739.6970; train_gene_expr_recon_loss: 11933603.9697; train_masked_gp_l1_reg_loss: 87753.6523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93513.9622; train_chrom_access_recon_loss: 4441330.3485; train_global_loss: 19397994.6970; train_optim_loss: 19397994.6970; val_kl_reg_loss: 94248.6279; val_edge_recon_loss: 2777969.7812; val_gene_expr_recon_loss: 11777691.5000; val_masked_gp_l1_reg_loss: 88274.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93636.6094; val_chrom_access_recon_loss: 4365767.8750; val_global_loss: 19197588.7500; val_optim_loss: 19197588.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9212; val_auprc_score: 0.8912; val_best_acc_score: 0.8616; val_best_f1_score: 0.8709; train_kl_reg_loss: 91085.5116; train_edge_recon_loss: 2756953.2614; train_gene_expr_recon_loss: 11903905.6818; train_masked_gp_l1_reg_loss: 88540.2074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93078.1248; train_chrom_access_recon_loss: 4425671.6288; train_global_loss: 19359234.2121; train_optim_loss: 19359234.2121; val_kl_reg_loss: 94086.5615; val_edge_recon_loss: 2804206.8750; val_gene_expr_recon_loss: 11713945.3750; val_masked_gp_l1_reg_loss: 88929.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93139.5625; val_chrom_access_recon_loss: 4325929.9375; val_global_loss: 19120239.0000; val_optim_loss: 19120239.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9264; val_auprc_score: 0.8993; val_best_acc_score: 0.8654; val_best_f1_score: 0.8738; train_kl_reg_loss: 91072.5543; train_edge_recon_loss: 2753697.4470; train_gene_expr_recon_loss: 11877265.5455; train_masked_gp_l1_reg_loss: 89145.7405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92278.2492; train_chrom_access_recon_loss: 4411294.0152; train_global_loss: 19314753.7879; train_optim_loss: 19314753.7879; val_kl_reg_loss: 90656.9453; val_edge_recon_loss: 2781830.3438; val_gene_expr_recon_loss: 11716591.8750; val_masked_gp_l1_reg_loss: 89341.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91691.2109; val_chrom_access_recon_loss: 4363313.5625; val_global_loss: 19133426.0000; val_optim_loss: 19133426.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9327; val_auprc_score: 0.9132; val_best_acc_score: 0.8694; val_best_f1_score: 0.8784; train_kl_reg_loss: 89874.4064; train_edge_recon_loss: 2747033.4318; train_gene_expr_recon_loss: 11848530.8182; train_masked_gp_l1_reg_loss: 89566.4415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91685.1985; train_chrom_access_recon_loss: 4401107.1515; train_global_loss: 19267797.5455; train_optim_loss: 19267797.5455; val_kl_reg_loss: 89934.3154; val_edge_recon_loss: 2767093.0938; val_gene_expr_recon_loss: 11743055.1250; val_masked_gp_l1_reg_loss: 89814.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92078.0156; val_chrom_access_recon_loss: 4357023.7500; val_global_loss: 19138998.2500; val_optim_loss: 19138998.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9275; val_auprc_score: 0.8978; val_best_acc_score: 0.8708; val_best_f1_score: 0.8780; train_kl_reg_loss: 89206.9265; train_edge_recon_loss: 2750404.5568; train_gene_expr_recon_loss: 11822768.8333; train_masked_gp_l1_reg_loss: 90100.0760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91690.1957; train_chrom_access_recon_loss: 4386008.7197; train_global_loss: 19230179.3636; train_optim_loss: 19230179.3636; val_kl_reg_loss: 90962.3262; val_edge_recon_loss: 2769088.0625; val_gene_expr_recon_loss: 11714664.8750; val_masked_gp_l1_reg_loss: 90345.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91893.7656; val_chrom_access_recon_loss: 4337763.3125; val_global_loss: 19094718.0000; val_optim_loss: 19094718.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9291; val_auprc_score: 0.8999; val_best_acc_score: 0.8743; val_best_f1_score: 0.8815; train_kl_reg_loss: 88196.6114; train_edge_recon_loss: 2741847.4356; train_gene_expr_recon_loss: 11802011.7879; train_masked_gp_l1_reg_loss: 90391.5331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91495.6246; train_chrom_access_recon_loss: 4371538.5455; train_global_loss: 19185481.6364; train_optim_loss: 19185481.6364; val_kl_reg_loss: 87879.0459; val_edge_recon_loss: 2782988.4062; val_gene_expr_recon_loss: 11653591.6250; val_masked_gp_l1_reg_loss: 90629.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91684.7891; val_chrom_access_recon_loss: 4278018.8125; val_global_loss: 18984791.5000; val_optim_loss: 18984791.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9294; val_auprc_score: 0.9042; val_best_acc_score: 0.8689; val_best_f1_score: 0.8763; train_kl_reg_loss: 88005.8915; train_edge_recon_loss: 2733446.5265; train_gene_expr_recon_loss: 11773210.5455; train_masked_gp_l1_reg_loss: 90839.3475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91780.2598; train_chrom_access_recon_loss: 4359709.1818; train_global_loss: 19136991.8485; train_optim_loss: 19136991.8485; val_kl_reg_loss: 88771.3857; val_edge_recon_loss: 2781459.9062; val_gene_expr_recon_loss: 11646249.1250; val_masked_gp_l1_reg_loss: 90915.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91853.4922; val_chrom_access_recon_loss: 4290025.8750; val_global_loss: 18989274.7500; val_optim_loss: 18989274.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9329; val_auprc_score: 0.9116; val_best_acc_score: 0.8735; val_best_f1_score: 0.8809; train_kl_reg_loss: 87167.3596; train_edge_recon_loss: 2728970.0303; train_gene_expr_recon_loss: 11748226.6970; train_masked_gp_l1_reg_loss: 91076.3880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92235.5082; train_chrom_access_recon_loss: 4348640.5227; train_global_loss: 19096316.4242; train_optim_loss: 19096316.4242; val_kl_reg_loss: 88219.4775; val_edge_recon_loss: 2761322.7812; val_gene_expr_recon_loss: 11688248.5000; val_masked_gp_l1_reg_loss: 91239.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92409.3594; val_chrom_access_recon_loss: 4314648.5625; val_global_loss: 19036087.5000; val_optim_loss: 19036087.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9344; val_auprc_score: 0.9049; val_best_acc_score: 0.8799; val_best_f1_score: 0.8874; train_kl_reg_loss: 85303.3158; train_edge_recon_loss: 2737128.0265; train_gene_expr_recon_loss: 11733495.3030; train_masked_gp_l1_reg_loss: 91376.4798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92814.2140; train_chrom_access_recon_loss: 4336817.2121; train_global_loss: 19076934.4848; train_optim_loss: 19076934.4848; val_kl_reg_loss: 85904.2002; val_edge_recon_loss: 2767304.6250; val_gene_expr_recon_loss: 11564034.6250; val_masked_gp_l1_reg_loss: 91615.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92918.4531; val_chrom_access_recon_loss: 4262513.2500; val_global_loss: 18864291.0000; val_optim_loss: 18864291.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9298; val_auprc_score: 0.9045; val_best_acc_score: 0.8724; val_best_f1_score: 0.8821; train_kl_reg_loss: 102299.2215; train_edge_recon_loss: 2815067.4015; train_gene_expr_recon_loss: 10832897.9091; train_masked_gp_l1_reg_loss: 91524.3594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91948.6042; train_chrom_access_recon_loss: 4093801.8220; train_global_loss: 18027539.3636; train_optim_loss: 18027539.3636; val_kl_reg_loss: 41132.9648; val_edge_recon_loss: 2792903.7188; val_gene_expr_recon_loss: 10675762.6250; val_masked_gp_l1_reg_loss: 91092.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91947.3125; val_chrom_access_recon_loss: 3986273.9688; val_global_loss: 17679113.2500; val_optim_loss: 17679113.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9310; val_auprc_score: 0.9068; val_best_acc_score: 0.8767; val_best_f1_score: 0.8860; train_kl_reg_loss: 84339.8420; train_edge_recon_loss: 2752455.7500; train_gene_expr_recon_loss: 10775847.1667; train_masked_gp_l1_reg_loss: 90536.7475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91866.5520; train_chrom_access_recon_loss: 4025033.5114; train_global_loss: 17820079.4848; train_optim_loss: 17820079.4848; val_kl_reg_loss: 47116.9106; val_edge_recon_loss: 2764434.7812; val_gene_expr_recon_loss: 10645124.1250; val_masked_gp_l1_reg_loss: 89925.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91827.7188; val_chrom_access_recon_loss: 3933664.3125; val_global_loss: 17572093.0000; val_optim_loss: 17572093.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9337; val_auprc_score: 0.9089; val_best_acc_score: 0.8839; val_best_f1_score: 0.8888; train_kl_reg_loss: 75405.3997; train_edge_recon_loss: 2725978.3636; train_gene_expr_recon_loss: 10748702.3788; train_masked_gp_l1_reg_loss: 89144.2325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91303.7204; train_chrom_access_recon_loss: 4009785.7917; train_global_loss: 17740319.8182; train_optim_loss: 17740319.8182; val_kl_reg_loss: 55262.6875; val_edge_recon_loss: 2755276.5938; val_gene_expr_recon_loss: 10600194.2500; val_masked_gp_l1_reg_loss: 88306.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91316.2422; val_chrom_access_recon_loss: 3944840.8125; val_global_loss: 17535197.5000; val_optim_loss: 17535197.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9346; val_auprc_score: 0.9092; val_best_acc_score: 0.8788; val_best_f1_score: 0.8866; train_kl_reg_loss: 70741.6100; train_edge_recon_loss: 2718154.4129; train_gene_expr_recon_loss: 10741982.5455; train_masked_gp_l1_reg_loss: 87538.5539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91107.4619; train_chrom_access_recon_loss: 4008903.6212; train_global_loss: 17718428.3030; train_optim_loss: 17718428.3030; val_kl_reg_loss: 60901.9404; val_edge_recon_loss: 2759397.7188; val_gene_expr_recon_loss: 10562911.7500; val_masked_gp_l1_reg_loss: 86821.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90986.8750; val_chrom_access_recon_loss: 3914149.4688; val_global_loss: 17475170.0000; val_optim_loss: 17475170.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9420; val_auprc_score: 0.9145; val_best_acc_score: 0.8880; val_best_f1_score: 0.8946; train_kl_reg_loss: 69746.2378; train_edge_recon_loss: 2717966.4773; train_gene_expr_recon_loss: 10715930.2424; train_masked_gp_l1_reg_loss: 86052.8285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90924.8735; train_chrom_access_recon_loss: 3997104.6667; train_global_loss: 17677725.3636; train_optim_loss: 17677725.3636; val_kl_reg_loss: 61063.8813; val_edge_recon_loss: 2745348.8438; val_gene_expr_recon_loss: 10648655.7500; val_masked_gp_l1_reg_loss: 85346.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90787.3359; val_chrom_access_recon_loss: 3939998.5625; val_global_loss: 17571201.5000; val_optim_loss: 17571201.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9462; val_auprc_score: 0.9274; val_best_acc_score: 0.8901; val_best_f1_score: 0.8935; train_kl_reg_loss: 68355.9310; train_edge_recon_loss: 2716972.3523; train_gene_expr_recon_loss: 10695845.6515; train_masked_gp_l1_reg_loss: 84647.9979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90716.8722; train_chrom_access_recon_loss: 3989426.9659; train_global_loss: 17645965.7879; train_optim_loss: 17645965.7879; val_kl_reg_loss: 59080.7056; val_edge_recon_loss: 2762752.0625; val_gene_expr_recon_loss: 10578898.8750; val_masked_gp_l1_reg_loss: 83955.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91288.5547; val_chrom_access_recon_loss: 3957486.4375; val_global_loss: 17533463.5000; val_optim_loss: 17533463.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9357; val_auprc_score: 0.9092; val_best_acc_score: 0.8818; val_best_f1_score: 0.8891; train_kl_reg_loss: 67984.8058; train_edge_recon_loss: 2706812.2803; train_gene_expr_recon_loss: 10668275.0909; train_masked_gp_l1_reg_loss: 83292.1179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91101.6866; train_chrom_access_recon_loss: 3983956.8295; train_global_loss: 17601422.8182; train_optim_loss: 17601422.8182; val_kl_reg_loss: 62838.6631; val_edge_recon_loss: 2758583.5000; val_gene_expr_recon_loss: 10625260.5000; val_masked_gp_l1_reg_loss: 82614.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91353.5938; val_chrom_access_recon_loss: 3948412.0000; val_global_loss: 17569062.7500; val_optim_loss: 17569062.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9405; val_auprc_score: 0.9125; val_best_acc_score: 0.8920; val_best_f1_score: 0.8987; train_kl_reg_loss: 66581.4203; train_edge_recon_loss: 2703673.9356; train_gene_expr_recon_loss: 10643663.4091; train_masked_gp_l1_reg_loss: 81988.3777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91091.4105; train_chrom_access_recon_loss: 3976953.7727; train_global_loss: 17563952.3636; train_optim_loss: 17563952.3636; val_kl_reg_loss: 61697.0483; val_edge_recon_loss: 2749985.1250; val_gene_expr_recon_loss: 10548879.2500; val_masked_gp_l1_reg_loss: 81512.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91641.5078; val_chrom_access_recon_loss: 3930824.4375; val_global_loss: 17464539.7500; val_optim_loss: 17464539.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9408; val_auprc_score: 0.9191; val_best_acc_score: 0.8842; val_best_f1_score: 0.8904; train_kl_reg_loss: 68225.1932; train_edge_recon_loss: 2704505.5606; train_gene_expr_recon_loss: 10631218.3182; train_masked_gp_l1_reg_loss: 81097.8880; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91076.4259; train_chrom_access_recon_loss: 3973599.2045; train_global_loss: 17549722.5909; train_optim_loss: 17549722.5909; val_kl_reg_loss: 60430.5781; val_edge_recon_loss: 2763768.0312; val_gene_expr_recon_loss: 10556254.2500; val_masked_gp_l1_reg_loss: 80678.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91106.5469; val_chrom_access_recon_loss: 3915086.0000; val_global_loss: 17467324.0000; val_optim_loss: 17467324.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9476; val_auprc_score: 0.9259; val_best_acc_score: 0.8947; val_best_f1_score: 0.8996; train_kl_reg_loss: 67121.1351; train_edge_recon_loss: 2701338.1402; train_gene_expr_recon_loss: 10621593.6364; train_masked_gp_l1_reg_loss: 80314.1719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91072.6415; train_chrom_access_recon_loss: 3968380.0644; train_global_loss: 17529819.8182; train_optim_loss: 17529819.8182; val_kl_reg_loss: 62967.0220; val_edge_recon_loss: 2722424.8750; val_gene_expr_recon_loss: 10553577.2500; val_masked_gp_l1_reg_loss: 80006.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91668.5078; val_chrom_access_recon_loss: 3932197.1875; val_global_loss: 17442841.5000; val_optim_loss: 17442841.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9495; val_auprc_score: 0.9325; val_best_acc_score: 0.8952; val_best_f1_score: 0.8994; train_kl_reg_loss: 67457.6913; train_edge_recon_loss: 2699299.2386; train_gene_expr_recon_loss: 10592666.2576; train_masked_gp_l1_reg_loss: 79652.9938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90904.6944; train_chrom_access_recon_loss: 3956993.9886; train_global_loss: 17486974.8939; train_optim_loss: 17486974.8939; val_kl_reg_loss: 63228.6768; val_edge_recon_loss: 2732545.2812; val_gene_expr_recon_loss: 10499858.2500; val_masked_gp_l1_reg_loss: 79321.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91013.1094; val_chrom_access_recon_loss: 3923132.5312; val_global_loss: 17389098.7500; val_optim_loss: 17389098.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9499; val_auprc_score: 0.9277; val_best_acc_score: 0.9019; val_best_f1_score: 0.9070; train_kl_reg_loss: 67902.4955; train_edge_recon_loss: 2702162.6098; train_gene_expr_recon_loss: 10560577.5303; train_masked_gp_l1_reg_loss: 79045.5856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90883.5811; train_chrom_access_recon_loss: 3947338.0833; train_global_loss: 17447909.7273; train_optim_loss: 17447909.7273; val_kl_reg_loss: 64176.1597; val_edge_recon_loss: 2710118.3438; val_gene_expr_recon_loss: 10446590.0000; val_masked_gp_l1_reg_loss: 78693.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90993.6328; val_chrom_access_recon_loss: 3863818.5938; val_global_loss: 17254391.0000; val_optim_loss: 17254391.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9487; val_auprc_score: 0.9307; val_best_acc_score: 0.8987; val_best_f1_score: 0.9043; train_kl_reg_loss: 67081.0190; train_edge_recon_loss: 2694096.1667; train_gene_expr_recon_loss: 10549351.8485; train_masked_gp_l1_reg_loss: 78323.1009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90617.4661; train_chrom_access_recon_loss: 3936749.7386; train_global_loss: 17416219.1970; train_optim_loss: 17416219.1970; val_kl_reg_loss: 61229.3477; val_edge_recon_loss: 2722947.1562; val_gene_expr_recon_loss: 10405970.7500; val_masked_gp_l1_reg_loss: 78030.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90797.6406; val_chrom_access_recon_loss: 3865597.8438; val_global_loss: 17224574.0000; val_optim_loss: 17224574.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9527; val_auprc_score: 0.9371; val_best_acc_score: 0.8971; val_best_f1_score: 0.9013; train_kl_reg_loss: 67628.4966; train_edge_recon_loss: 2693952.8902; train_gene_expr_recon_loss: 10545486.6515; train_masked_gp_l1_reg_loss: 77794.6062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90530.5958; train_chrom_access_recon_loss: 3936038.4394; train_global_loss: 17411431.6515; train_optim_loss: 17411431.6515; val_kl_reg_loss: 63270.8643; val_edge_recon_loss: 2719407.3438; val_gene_expr_recon_loss: 10479731.1250; val_masked_gp_l1_reg_loss: 77600.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90519.3047; val_chrom_access_recon_loss: 3889147.8750; val_global_loss: 17319677.2500; val_optim_loss: 17319677.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9552; val_auprc_score: 0.9359; val_best_acc_score: 0.9033; val_best_f1_score: 0.9086; train_kl_reg_loss: 66007.7158; train_edge_recon_loss: 2684973.6515; train_gene_expr_recon_loss: 10527989.7121; train_masked_gp_l1_reg_loss: 77356.4092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90355.2551; train_chrom_access_recon_loss: 3932800.0568; train_global_loss: 17379482.6364; train_optim_loss: 17379482.6364; val_kl_reg_loss: 61577.4741; val_edge_recon_loss: 2696349.2812; val_gene_expr_recon_loss: 10437899.5000; val_masked_gp_l1_reg_loss: 77302.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90943.7266; val_chrom_access_recon_loss: 3911836.9375; val_global_loss: 17275910.5000; val_optim_loss: 17275910.5000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9506; val_auprc_score: 0.9365; val_best_acc_score: 0.8890; val_best_f1_score: 0.8963; train_kl_reg_loss: 66339.1149; train_edge_recon_loss: 2685764.9811; train_gene_expr_recon_loss: 10499490.9697; train_masked_gp_l1_reg_loss: 77106.0633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90507.2924; train_chrom_access_recon_loss: 3921755.5985; train_global_loss: 17340964.0303; train_optim_loss: 17340964.0303; val_kl_reg_loss: 60107.6011; val_edge_recon_loss: 2770961.2500; val_gene_expr_recon_loss: 10405291.2500; val_masked_gp_l1_reg_loss: 76888.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90107.2812; val_chrom_access_recon_loss: 3881042.0938; val_global_loss: 17284398.0000; val_optim_loss: 17284398.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9545; val_auprc_score: 0.9330; val_best_acc_score: 0.9111; val_best_f1_score: 0.9149; train_kl_reg_loss: 66707.7760; train_edge_recon_loss: 2689330.6098; train_gene_expr_recon_loss: 10493425.8788; train_masked_gp_l1_reg_loss: 76714.8655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90169.3291; train_chrom_access_recon_loss: 3923015.0985; train_global_loss: 17339363.5000; train_optim_loss: 17339363.5000; val_kl_reg_loss: 63749.7573; val_edge_recon_loss: 2721096.5625; val_gene_expr_recon_loss: 10373389.7500; val_masked_gp_l1_reg_loss: 76462.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89796.5781; val_chrom_access_recon_loss: 3896695.4375; val_global_loss: 17221190.5000; val_optim_loss: 17221190.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9565; val_auprc_score: 0.9389; val_best_acc_score: 0.9009; val_best_f1_score: 0.9064; train_kl_reg_loss: 65656.9764; train_edge_recon_loss: 2685079.0758; train_gene_expr_recon_loss: 10485728.3182; train_masked_gp_l1_reg_loss: 76164.6229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89957.9776; train_chrom_access_recon_loss: 3917051.1515; train_global_loss: 17319638.1818; train_optim_loss: 17319638.1818; val_kl_reg_loss: 61874.2500; val_edge_recon_loss: 2725480.6250; val_gene_expr_recon_loss: 10381059.0000; val_masked_gp_l1_reg_loss: 75972.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90401.3828; val_chrom_access_recon_loss: 3878993.0938; val_global_loss: 17213781.0000; val_optim_loss: 17213781.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9548; val_auprc_score: 0.9330; val_best_acc_score: 0.9038; val_best_f1_score: 0.9086; train_kl_reg_loss: 64635.5355; train_edge_recon_loss: 2691285.9773; train_gene_expr_recon_loss: 10473715.2727; train_masked_gp_l1_reg_loss: 75776.7343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89963.6675; train_chrom_access_recon_loss: 3912598.0341; train_global_loss: 17307975.1970; train_optim_loss: 17307975.1970; val_kl_reg_loss: 59702.4067; val_edge_recon_loss: 2704379.7812; val_gene_expr_recon_loss: 10343491.7500; val_masked_gp_l1_reg_loss: 75526.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89840.6094; val_chrom_access_recon_loss: 3825269.8750; val_global_loss: 17098212.0000; val_optim_loss: 17098212.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9558; val_auprc_score: 0.9380; val_best_acc_score: 0.9076; val_best_f1_score: 0.9107; train_kl_reg_loss: 62887.8336; train_edge_recon_loss: 2687506.9053; train_gene_expr_recon_loss: 10454416.5152; train_masked_gp_l1_reg_loss: 75380.4568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90176.6039; train_chrom_access_recon_loss: 3904295.6742; train_global_loss: 17274663.9697; train_optim_loss: 17274663.9697; val_kl_reg_loss: 60213.3584; val_edge_recon_loss: 2725837.4688; val_gene_expr_recon_loss: 10294235.8750; val_masked_gp_l1_reg_loss: 75168.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89889.8984; val_chrom_access_recon_loss: 3818490.9375; val_global_loss: 17063836.0000; val_optim_loss: 17063836.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9594; val_auprc_score: 0.9446; val_best_acc_score: 0.9111; val_best_f1_score: 0.9147; train_kl_reg_loss: 65264.4440; train_edge_recon_loss: 2690429.7045; train_gene_expr_recon_loss: 10431113.6212; train_masked_gp_l1_reg_loss: 74948.8382; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89952.2480; train_chrom_access_recon_loss: 3900059.7386; train_global_loss: 17251768.4242; train_optim_loss: 17251768.4242; val_kl_reg_loss: 63378.8218; val_edge_recon_loss: 2700831.0312; val_gene_expr_recon_loss: 10296287.2500; val_masked_gp_l1_reg_loss: 74610.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90156.0156; val_chrom_access_recon_loss: 3839045.0938; val_global_loss: 17064308.1250; val_optim_loss: 17064308.1250
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9570; val_auprc_score: 0.9374; val_best_acc_score: 0.9113; val_best_f1_score: 0.9158; train_kl_reg_loss: 63888.7106; train_edge_recon_loss: 2678697.6667; train_gene_expr_recon_loss: 10431673.2273; train_masked_gp_l1_reg_loss: 74354.0560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89939.9579; train_chrom_access_recon_loss: 3898312.4583; train_global_loss: 17236866.1212; train_optim_loss: 17236866.1212; val_kl_reg_loss: 64428.7017; val_edge_recon_loss: 2695266.6562; val_gene_expr_recon_loss: 10338871.5000; val_masked_gp_l1_reg_loss: 74064.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89898.2969; val_chrom_access_recon_loss: 3836764.4375; val_global_loss: 17099293.3750; val_optim_loss: 17099293.3750
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9579; val_auprc_score: 0.9381; val_best_acc_score: 0.9121; val_best_f1_score: 0.9166; train_kl_reg_loss: 64453.7752; train_edge_recon_loss: 2682049.3295; train_gene_expr_recon_loss: 10442013.8788; train_masked_gp_l1_reg_loss: 73863.7585; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89802.0688; train_chrom_access_recon_loss: 3903470.5189; train_global_loss: 17255653.2727; train_optim_loss: 17255653.2727; val_kl_reg_loss: 59315.3921; val_edge_recon_loss: 2695186.6875; val_gene_expr_recon_loss: 10388912.7500; val_masked_gp_l1_reg_loss: 73635.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89957.4609; val_chrom_access_recon_loss: 3839706.5625; val_global_loss: 17146714.2500; val_optim_loss: 17146714.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9575; val_auprc_score: 0.9355; val_best_acc_score: 0.9108; val_best_f1_score: 0.9151; train_kl_reg_loss: 63327.5043; train_edge_recon_loss: 2685455.3220; train_gene_expr_recon_loss: 10423614.8182; train_masked_gp_l1_reg_loss: 73466.9852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89966.1093; train_chrom_access_recon_loss: 3894649.7197; train_global_loss: 17230480.4242; train_optim_loss: 17230480.4242; val_kl_reg_loss: 59489.0107; val_edge_recon_loss: 2704341.2500; val_gene_expr_recon_loss: 10452628.7500; val_masked_gp_l1_reg_loss: 73332.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90158.1094; val_chrom_access_recon_loss: 3881808.5000; val_global_loss: 17261758.2500; val_optim_loss: 17261758.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9615; val_auprc_score: 0.9433; val_best_acc_score: 0.9143; val_best_f1_score: 0.9181; train_kl_reg_loss: 58226.1090; train_edge_recon_loss: 2688365.0833; train_gene_expr_recon_loss: 10429252.1818; train_masked_gp_l1_reg_loss: 72753.6641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73953.4806; train_chrom_access_recon_loss: 3965593.1780; train_global_loss: 17288143.6061; train_optim_loss: 17288143.6061; val_kl_reg_loss: 52819.8960; val_edge_recon_loss: 2687979.7188; val_gene_expr_recon_loss: 10353716.7500; val_masked_gp_l1_reg_loss: 72561.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70608.1719; val_chrom_access_recon_loss: 3873778.7812; val_global_loss: 17111463.7500; val_optim_loss: 17111463.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9559; val_auprc_score: 0.9391; val_best_acc_score: 0.9068; val_best_f1_score: 0.9116; train_kl_reg_loss: 56437.7346; train_edge_recon_loss: 2695380.5114; train_gene_expr_recon_loss: 10423324.9091; train_masked_gp_l1_reg_loss: 72569.2726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70553.8578; train_chrom_access_recon_loss: 3918345.3561; train_global_loss: 17236611.5000; train_optim_loss: 17236611.5000; val_kl_reg_loss: 55612.4941; val_edge_recon_loss: 2698497.8750; val_gene_expr_recon_loss: 10351004.5000; val_masked_gp_l1_reg_loss: 72576.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70674.5312; val_chrom_access_recon_loss: 3902874.8125; val_global_loss: 17151240.8750; val_optim_loss: 17151240.8750
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9603; val_auprc_score: 0.9481; val_best_acc_score: 0.9084; val_best_f1_score: 0.9127; train_kl_reg_loss: 59188.4648; train_edge_recon_loss: 2681276.6402; train_gene_expr_recon_loss: 10414056.1515; train_masked_gp_l1_reg_loss: 72567.2412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70768.3349; train_chrom_access_recon_loss: 3908553.5720; train_global_loss: 17206410.5152; train_optim_loss: 17206410.5152; val_kl_reg_loss: 58609.8638; val_edge_recon_loss: 2710307.8125; val_gene_expr_recon_loss: 10384937.1250; val_masked_gp_l1_reg_loss: 72574.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70807.4609; val_chrom_access_recon_loss: 3859284.6562; val_global_loss: 17156521.7500; val_optim_loss: 17156521.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9581; val_auprc_score: 0.9398; val_best_acc_score: 0.9113; val_best_f1_score: 0.9157; train_kl_reg_loss: 61041.3288; train_edge_recon_loss: 2694655.4356; train_gene_expr_recon_loss: 10416711.4697; train_masked_gp_l1_reg_loss: 72561.7099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70860.0464; train_chrom_access_recon_loss: 3909212.9773; train_global_loss: 17225043.0000; train_optim_loss: 17225043.0000; val_kl_reg_loss: 59726.8228; val_edge_recon_loss: 2694279.7500; val_gene_expr_recon_loss: 10453593.3750; val_masked_gp_l1_reg_loss: 72556.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70936.1172; val_chrom_access_recon_loss: 3869807.5625; val_global_loss: 17220900.2500; val_optim_loss: 17220900.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 56 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9587
val AUPRC score: 0.9435
val best accuracy score: 0.9103
val best F1 score: 0.9140
val target rna MSE score: 1.7668
val source rna MSE score: 1.0607
val target atac MSE score: 0.6376
val source atac MSE score: 0.7377
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
