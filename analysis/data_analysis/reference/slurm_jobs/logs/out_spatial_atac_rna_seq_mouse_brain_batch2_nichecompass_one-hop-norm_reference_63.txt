[True]
Run timestamp: 09102023_225323_63.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_63']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6625; val_auprc_score: 0.6506; val_best_acc_score: 0.5005; val_best_f1_score: 0.6668; train_kl_reg_loss: 41437.6713; train_edge_recon_loss: 3506994.7576; train_gene_expr_recon_loss: 14283343.9848; train_masked_gp_l1_reg_loss: 47456.8110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5618689.3030; train_chrom_access_recon_loss: 6953224.2273; train_global_loss: 30451146.8182; train_optim_loss: 30451146.8182; val_kl_reg_loss: 91614.0947; val_edge_recon_loss: 4065247.7188; val_gene_expr_recon_loss: 13080020.2500; val_masked_gp_l1_reg_loss: 57457.5117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2659879.5000; val_chrom_access_recon_loss: 6717085.4375; val_global_loss: 26671306.0000; val_optim_loss: 26671306.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6804; val_auprc_score: 0.6704; val_best_acc_score: 0.5991; val_best_f1_score: 0.6959; train_kl_reg_loss: 88007.7173; train_edge_recon_loss: 3513564.5720; train_gene_expr_recon_loss: 12899803.5606; train_masked_gp_l1_reg_loss: 58147.5553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1246681.1539; train_chrom_access_recon_loss: 6610150.0530; train_global_loss: 24416354.6364; train_optim_loss: 24416354.6364; val_kl_reg_loss: 90337.9805; val_edge_recon_loss: 4057617.8438; val_gene_expr_recon_loss: 12757133.2500; val_masked_gp_l1_reg_loss: 59261.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 503414.6562; val_chrom_access_recon_loss: 6685533.6875; val_global_loss: 24153299.0000; val_optim_loss: 24153299.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7137; val_auprc_score: 0.7086; val_best_acc_score: 0.6443; val_best_f1_score: 0.6961; train_kl_reg_loss: 85643.8080; train_edge_recon_loss: 3510285.3030; train_gene_expr_recon_loss: 12727925.5758; train_masked_gp_l1_reg_loss: 60642.0324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 335753.3028; train_chrom_access_recon_loss: 6561925.1439; train_global_loss: 23282175.3636; train_optim_loss: 23282175.3636; val_kl_reg_loss: 75494.2783; val_edge_recon_loss: 4036263.0000; val_gene_expr_recon_loss: 12646738.2500; val_masked_gp_l1_reg_loss: 62136.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 235361.2344; val_chrom_access_recon_loss: 6589040.0000; val_global_loss: 23645033.0000; val_optim_loss: 23645033.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8090; val_auprc_score: 0.7806; val_best_acc_score: 0.7354; val_best_f1_score: 0.7620; train_kl_reg_loss: 73760.3381; train_edge_recon_loss: 3489594.9811; train_gene_expr_recon_loss: 12620174.6364; train_masked_gp_l1_reg_loss: 63557.1829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194223.1759; train_chrom_access_recon_loss: 6507721.7273; train_global_loss: 22949031.8788; train_optim_loss: 22949031.8788; val_kl_reg_loss: 62488.7607; val_edge_recon_loss: 3723856.0625; val_gene_expr_recon_loss: 12569268.6250; val_masked_gp_l1_reg_loss: 64982.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163708.4375; val_chrom_access_recon_loss: 6548826.3750; val_global_loss: 23133129.7500; val_optim_loss: 23133129.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8836; val_auprc_score: 0.8562; val_best_acc_score: 0.8211; val_best_f1_score: 0.8386; train_kl_reg_loss: 69009.4980; train_edge_recon_loss: 3091677.4053; train_gene_expr_recon_loss: 12576162.6212; train_masked_gp_l1_reg_loss: 68980.0690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 147488.2254; train_chrom_access_recon_loss: 6477095.4621; train_global_loss: 22430413.3939; train_optim_loss: 22430413.3939; val_kl_reg_loss: 101194.8359; val_edge_recon_loss: 2902943.2188; val_gene_expr_recon_loss: 12523222.2500; val_masked_gp_l1_reg_loss: 73279.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137019.4062; val_chrom_access_recon_loss: 6583292.1250; val_global_loss: 22320951.5000; val_optim_loss: 22320951.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9002; val_auprc_score: 0.8690; val_best_acc_score: 0.8353; val_best_f1_score: 0.8471; train_kl_reg_loss: 102389.1508; train_edge_recon_loss: 2861316.5303; train_gene_expr_recon_loss: 12480543.9848; train_masked_gp_l1_reg_loss: 75039.5971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128881.5292; train_chrom_access_recon_loss: 6425987.5682; train_global_loss: 22074158.3636; train_optim_loss: 22074158.3636; val_kl_reg_loss: 103608.0703; val_edge_recon_loss: 2861959.5938; val_gene_expr_recon_loss: 12508447.3750; val_masked_gp_l1_reg_loss: 76547.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122977.2656; val_chrom_access_recon_loss: 6542041.7500; val_global_loss: 22215582.0000; val_optim_loss: 22215582.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8936; val_auprc_score: 0.8581; val_best_acc_score: 0.8350; val_best_f1_score: 0.8468; train_kl_reg_loss: 107448.2706; train_edge_recon_loss: 2835297.3674; train_gene_expr_recon_loss: 12419198.0909; train_masked_gp_l1_reg_loss: 77365.8943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119082.7965; train_chrom_access_recon_loss: 6405219.1288; train_global_loss: 21963611.7576; train_optim_loss: 21963611.7576; val_kl_reg_loss: 102924.3203; val_edge_recon_loss: 2837077.4375; val_gene_expr_recon_loss: 12457630.5000; val_masked_gp_l1_reg_loss: 78376.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116022.3516; val_chrom_access_recon_loss: 6522388.1875; val_global_loss: 22114419.2500; val_optim_loss: 22114419.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8976; val_auprc_score: 0.8613; val_best_acc_score: 0.8358; val_best_f1_score: 0.8485; train_kl_reg_loss: 104344.2011; train_edge_recon_loss: 2823808.9432; train_gene_expr_recon_loss: 12345781.9394; train_masked_gp_l1_reg_loss: 79343.7918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112657.0210; train_chrom_access_recon_loss: 6369951.2197; train_global_loss: 21835887.3636; train_optim_loss: 21835887.3636; val_kl_reg_loss: 103640.5400; val_edge_recon_loss: 2840672.7812; val_gene_expr_recon_loss: 12340265.0000; val_masked_gp_l1_reg_loss: 80346.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110877.2031; val_chrom_access_recon_loss: 6440123.5000; val_global_loss: 21915926.2500; val_optim_loss: 21915926.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9041; val_auprc_score: 0.8695; val_best_acc_score: 0.8423; val_best_f1_score: 0.8517; train_kl_reg_loss: 101471.8473; train_edge_recon_loss: 2809584.3826; train_gene_expr_recon_loss: 12287811.1970; train_masked_gp_l1_reg_loss: 81025.5322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108240.1508; train_chrom_access_recon_loss: 6345676.8333; train_global_loss: 21733810.0909; train_optim_loss: 21733810.0909; val_kl_reg_loss: 98619.9111; val_edge_recon_loss: 2847643.1875; val_gene_expr_recon_loss: 12285442.3750; val_masked_gp_l1_reg_loss: 81759.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106926.8359; val_chrom_access_recon_loss: 6453554.7500; val_global_loss: 21873947.2500; val_optim_loss: 21873947.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9090; val_auprc_score: 0.8784; val_best_acc_score: 0.8512; val_best_f1_score: 0.8612; train_kl_reg_loss: 100722.1499; train_edge_recon_loss: 2804082.3144; train_gene_expr_recon_loss: 12242116.3182; train_masked_gp_l1_reg_loss: 82560.7404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105454.2036; train_chrom_access_recon_loss: 6329195.2727; train_global_loss: 21664131.1515; train_optim_loss: 21664131.1515; val_kl_reg_loss: 98129.1807; val_edge_recon_loss: 2798137.4688; val_gene_expr_recon_loss: 12281204.5000; val_masked_gp_l1_reg_loss: 83188.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104658.0391; val_chrom_access_recon_loss: 6442046.6875; val_global_loss: 21807365.0000; val_optim_loss: 21807365.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9040; val_auprc_score: 0.8752; val_best_acc_score: 0.8393; val_best_f1_score: 0.8518; train_kl_reg_loss: 97556.0774; train_edge_recon_loss: 2810597.2992; train_gene_expr_recon_loss: 12183900.8636; train_masked_gp_l1_reg_loss: 83722.3839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103848.3468; train_chrom_access_recon_loss: 6305274.8030; train_global_loss: 21584899.9394; train_optim_loss: 21584899.9394; val_kl_reg_loss: 98943.2520; val_edge_recon_loss: 2834399.4375; val_gene_expr_recon_loss: 12186544.1250; val_masked_gp_l1_reg_loss: 84215.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102106.0703; val_chrom_access_recon_loss: 6344851.8125; val_global_loss: 21651060.5000; val_optim_loss: 21651060.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9045; val_auprc_score: 0.8733; val_best_acc_score: 0.8452; val_best_f1_score: 0.8554; train_kl_reg_loss: 96343.3461; train_edge_recon_loss: 2798201.0152; train_gene_expr_recon_loss: 12155581.3030; train_masked_gp_l1_reg_loss: 84846.3751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101980.7647; train_chrom_access_recon_loss: 6295646.9545; train_global_loss: 21532599.6970; train_optim_loss: 21532599.6970; val_kl_reg_loss: 97691.7266; val_edge_recon_loss: 2817884.6875; val_gene_expr_recon_loss: 12254698.2500; val_masked_gp_l1_reg_loss: 85408.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100962.5234; val_chrom_access_recon_loss: 6398017.2500; val_global_loss: 21754663.0000; val_optim_loss: 21754663.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9170; val_auprc_score: 0.8884; val_best_acc_score: 0.8576; val_best_f1_score: 0.8666; train_kl_reg_loss: 95281.6860; train_edge_recon_loss: 2785512.8598; train_gene_expr_recon_loss: 12099011.9394; train_masked_gp_l1_reg_loss: 85787.7469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100417.8428; train_chrom_access_recon_loss: 6257805.7879; train_global_loss: 21423817.8788; train_optim_loss: 21423817.8788; val_kl_reg_loss: 96525.9492; val_edge_recon_loss: 2781938.3438; val_gene_expr_recon_loss: 12134725.6250; val_masked_gp_l1_reg_loss: 86358.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100141.3906; val_chrom_access_recon_loss: 6328186.1875; val_global_loss: 21527876.2500; val_optim_loss: 21527876.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9101; val_auprc_score: 0.8782; val_best_acc_score: 0.8530; val_best_f1_score: 0.8634; train_kl_reg_loss: 93544.9489; train_edge_recon_loss: 2789959.2992; train_gene_expr_recon_loss: 12071357.9394; train_masked_gp_l1_reg_loss: 86504.6387; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99159.7871; train_chrom_access_recon_loss: 6249746.0455; train_global_loss: 21390272.7273; train_optim_loss: 21390272.7273; val_kl_reg_loss: 91311.7637; val_edge_recon_loss: 2812093.2188; val_gene_expr_recon_loss: 11963104.0000; val_masked_gp_l1_reg_loss: 86937.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98603.9844; val_chrom_access_recon_loss: 6254938.5625; val_global_loss: 21306988.7500; val_optim_loss: 21306988.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9152; val_auprc_score: 0.8821; val_best_acc_score: 0.8549; val_best_f1_score: 0.8645; train_kl_reg_loss: 92097.8168; train_edge_recon_loss: 2774500.1780; train_gene_expr_recon_loss: 12023029.8939; train_masked_gp_l1_reg_loss: 87265.9910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97588.6609; train_chrom_access_recon_loss: 6219472.5985; train_global_loss: 21293955.1212; train_optim_loss: 21293955.1212; val_kl_reg_loss: 91031.9170; val_edge_recon_loss: 2819229.6562; val_gene_expr_recon_loss: 12056786.0000; val_masked_gp_l1_reg_loss: 87744.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96848.5469; val_chrom_access_recon_loss: 6296998.2500; val_global_loss: 21448640.0000; val_optim_loss: 21448640.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9234; val_auprc_score: 0.8873; val_best_acc_score: 0.8697; val_best_f1_score: 0.8766; train_kl_reg_loss: 89819.6270; train_edge_recon_loss: 2775095.5076; train_gene_expr_recon_loss: 11991372.0303; train_masked_gp_l1_reg_loss: 88105.9691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96156.3355; train_chrom_access_recon_loss: 6207225.4697; train_global_loss: 21247774.7879; train_optim_loss: 21247774.7879; val_kl_reg_loss: 88883.8203; val_edge_recon_loss: 2787217.3125; val_gene_expr_recon_loss: 11913156.1250; val_masked_gp_l1_reg_loss: 88562.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95809.7656; val_chrom_access_recon_loss: 6234935.3750; val_global_loss: 21208564.7500; val_optim_loss: 21208564.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9187; val_auprc_score: 0.8864; val_best_acc_score: 0.8651; val_best_f1_score: 0.8738; train_kl_reg_loss: 88221.6959; train_edge_recon_loss: 2776256.4091; train_gene_expr_recon_loss: 11966638.6212; train_masked_gp_l1_reg_loss: 88817.1631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95081.3279; train_chrom_access_recon_loss: 6196569.0152; train_global_loss: 21211584.2424; train_optim_loss: 21211584.2424; val_kl_reg_loss: 88660.4512; val_edge_recon_loss: 2787143.8750; val_gene_expr_recon_loss: 11945334.2500; val_masked_gp_l1_reg_loss: 89119.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94824.8594; val_chrom_access_recon_loss: 6268239.1250; val_global_loss: 21273322.5000; val_optim_loss: 21273322.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9239; val_auprc_score: 0.9001; val_best_acc_score: 0.8675; val_best_f1_score: 0.8759; train_kl_reg_loss: 87334.7938; train_edge_recon_loss: 2756528.0379; train_gene_expr_recon_loss: 11936597.1667; train_masked_gp_l1_reg_loss: 89469.2208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94019.2047; train_chrom_access_recon_loss: 6181434.3788; train_global_loss: 21145382.7273; train_optim_loss: 21145382.7273; val_kl_reg_loss: 85581.4873; val_edge_recon_loss: 2787521.7812; val_gene_expr_recon_loss: 11904130.3750; val_masked_gp_l1_reg_loss: 89911.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93841.3203; val_chrom_access_recon_loss: 6222921.6875; val_global_loss: 21183907.2500; val_optim_loss: 21183907.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9257; val_auprc_score: 0.9003; val_best_acc_score: 0.8643; val_best_f1_score: 0.8739; train_kl_reg_loss: 86420.8983; train_edge_recon_loss: 2762757.1250; train_gene_expr_recon_loss: 11902500.4697; train_masked_gp_l1_reg_loss: 90192.5328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93033.2389; train_chrom_access_recon_loss: 6160889.8485; train_global_loss: 21095794.0909; train_optim_loss: 21095794.0909; val_kl_reg_loss: 84131.2236; val_edge_recon_loss: 2781902.9062; val_gene_expr_recon_loss: 11890670.5000; val_masked_gp_l1_reg_loss: 90426.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92501.8750; val_chrom_access_recon_loss: 6214820.5000; val_global_loss: 21154454.2500; val_optim_loss: 21154454.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9276; val_auprc_score: 0.8977; val_best_acc_score: 0.8694; val_best_f1_score: 0.8768; train_kl_reg_loss: 85329.5143; train_edge_recon_loss: 2748948.1629; train_gene_expr_recon_loss: 11877003.3030; train_masked_gp_l1_reg_loss: 90780.7210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92165.4888; train_chrom_access_recon_loss: 6143935.8333; train_global_loss: 21038162.9697; train_optim_loss: 21038162.9697; val_kl_reg_loss: 89327.8516; val_edge_recon_loss: 2776486.0000; val_gene_expr_recon_loss: 11866815.3750; val_masked_gp_l1_reg_loss: 91013.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91673.5391; val_chrom_access_recon_loss: 6195660.8750; val_global_loss: 21110977.0000; val_optim_loss: 21110977.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9205; val_auprc_score: 0.8870; val_best_acc_score: 0.8657; val_best_f1_score: 0.8739; train_kl_reg_loss: 86384.1609; train_edge_recon_loss: 2753589.9394; train_gene_expr_recon_loss: 11846344.9545; train_masked_gp_l1_reg_loss: 91104.1738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91415.5858; train_chrom_access_recon_loss: 6129879.5682; train_global_loss: 20998718.3030; train_optim_loss: 20998718.3030; val_kl_reg_loss: 85907.5029; val_edge_recon_loss: 2780460.5938; val_gene_expr_recon_loss: 11832445.5000; val_masked_gp_l1_reg_loss: 91356.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91943.7188; val_chrom_access_recon_loss: 6172671.0625; val_global_loss: 21054785.5000; val_optim_loss: 21054785.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9297; val_auprc_score: 0.9038; val_best_acc_score: 0.8737; val_best_f1_score: 0.8794; train_kl_reg_loss: 87063.1804; train_edge_recon_loss: 2746365.5303; train_gene_expr_recon_loss: 11832102.2273; train_masked_gp_l1_reg_loss: 91416.2354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91046.5536; train_chrom_access_recon_loss: 6117864.4394; train_global_loss: 20965858.3636; train_optim_loss: 20965858.3636; val_kl_reg_loss: 85450.1836; val_edge_recon_loss: 2782181.7500; val_gene_expr_recon_loss: 11857807.2500; val_masked_gp_l1_reg_loss: 91494.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90808.4297; val_chrom_access_recon_loss: 6213701.4375; val_global_loss: 21121442.7500; val_optim_loss: 21121442.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9266; val_auprc_score: 0.8964; val_best_acc_score: 0.8708; val_best_f1_score: 0.8790; train_kl_reg_loss: 86719.5159; train_edge_recon_loss: 2751545.3674; train_gene_expr_recon_loss: 11803753.0152; train_masked_gp_l1_reg_loss: 91610.5644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90268.3846; train_chrom_access_recon_loss: 6101993.9621; train_global_loss: 20925890.7879; train_optim_loss: 20925890.7879; val_kl_reg_loss: 86298.7930; val_edge_recon_loss: 2780531.8438; val_gene_expr_recon_loss: 11856207.3750; val_masked_gp_l1_reg_loss: 91717.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90220.1562; val_chrom_access_recon_loss: 6190576.6875; val_global_loss: 21095552.7500; val_optim_loss: 21095552.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9260; val_auprc_score: 0.8998; val_best_acc_score: 0.8708; val_best_f1_score: 0.8778; train_kl_reg_loss: 84388.1863; train_edge_recon_loss: 2730017.4432; train_gene_expr_recon_loss: 11775252.6970; train_masked_gp_l1_reg_loss: 91779.4200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89969.6399; train_chrom_access_recon_loss: 6086149.5303; train_global_loss: 20857557.0000; train_optim_loss: 20857557.0000; val_kl_reg_loss: 84463.9219; val_edge_recon_loss: 2791085.8750; val_gene_expr_recon_loss: 11784312.5000; val_masked_gp_l1_reg_loss: 91941.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89905.2031; val_chrom_access_recon_loss: 6192997.3125; val_global_loss: 21034705.7500; val_optim_loss: 21034705.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9281; val_auprc_score: 0.9044; val_best_acc_score: 0.8702; val_best_f1_score: 0.8773; train_kl_reg_loss: 84443.1795; train_edge_recon_loss: 2728859.4432; train_gene_expr_recon_loss: 11757269.3636; train_masked_gp_l1_reg_loss: 92094.5888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89636.8935; train_chrom_access_recon_loss: 6077304.1742; train_global_loss: 20829607.6970; train_optim_loss: 20829607.6970; val_kl_reg_loss: 84492.9082; val_edge_recon_loss: 2796928.7188; val_gene_expr_recon_loss: 11789070.6250; val_masked_gp_l1_reg_loss: 92068.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89233.6094; val_chrom_access_recon_loss: 6150017.6875; val_global_loss: 21001812.0000; val_optim_loss: 21001812.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9223; val_auprc_score: 0.8939; val_best_acc_score: 0.8662; val_best_f1_score: 0.8735; train_kl_reg_loss: 107380.2254; train_edge_recon_loss: 2865418.1932; train_gene_expr_recon_loss: 10513131.6970; train_masked_gp_l1_reg_loss: 91623.2416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88479.0884; train_chrom_access_recon_loss: 5538240.6288; train_global_loss: 19204273.0303; train_optim_loss: 19204273.0303; val_kl_reg_loss: 27617.6331; val_edge_recon_loss: 2820885.0625; val_gene_expr_recon_loss: 10443197.0000; val_masked_gp_l1_reg_loss: 90773.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91208.9219; val_chrom_access_recon_loss: 5519767.0000; val_global_loss: 18993449.0000; val_optim_loss: 18993449.0000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9224; val_auprc_score: 0.8875; val_best_acc_score: 0.8641; val_best_f1_score: 0.8752; train_kl_reg_loss: 93562.5092; train_edge_recon_loss: 2771410.9432; train_gene_expr_recon_loss: 10428518.6212; train_masked_gp_l1_reg_loss: 89384.3310; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90877.3274; train_chrom_access_recon_loss: 5447046.6894; train_global_loss: 18920800.6061; train_optim_loss: 18920800.6061; val_kl_reg_loss: 34812.0283; val_edge_recon_loss: 2773899.3750; val_gene_expr_recon_loss: 10387774.7500; val_masked_gp_l1_reg_loss: 87953.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91044.0391; val_chrom_access_recon_loss: 5483449.6250; val_global_loss: 18858933.5000; val_optim_loss: 18858933.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9155; val_auprc_score: 0.8835; val_best_acc_score: 0.8579; val_best_f1_score: 0.8702; train_kl_reg_loss: 73306.3147; train_edge_recon_loss: 2747893.9242; train_gene_expr_recon_loss: 10393556.7879; train_masked_gp_l1_reg_loss: 86619.3111; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90327.6386; train_chrom_access_recon_loss: 5423347.4848; train_global_loss: 18815051.4848; train_optim_loss: 18815051.4848; val_kl_reg_loss: 36128.4805; val_edge_recon_loss: 2790122.7500; val_gene_expr_recon_loss: 10363856.1250; val_masked_gp_l1_reg_loss: 85474.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89958.8594; val_chrom_access_recon_loss: 5481040.9375; val_global_loss: 18846582.2500; val_optim_loss: 18846582.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9252; val_auprc_score: 0.8949; val_best_acc_score: 0.8622; val_best_f1_score: 0.8712; train_kl_reg_loss: 66486.2935; train_edge_recon_loss: 2740391.7424; train_gene_expr_recon_loss: 10372074.3485; train_masked_gp_l1_reg_loss: 84543.5607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89912.7462; train_chrom_access_recon_loss: 5411537.9167; train_global_loss: 18764946.6667; train_optim_loss: 18764946.6667; val_kl_reg_loss: 44657.1963; val_edge_recon_loss: 2784461.4688; val_gene_expr_recon_loss: 10396821.2500; val_masked_gp_l1_reg_loss: 83442.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89875.5000; val_chrom_access_recon_loss: 5556255.3125; val_global_loss: 18955513.5000; val_optim_loss: 18955513.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9243; val_auprc_score: 0.8987; val_best_acc_score: 0.8595; val_best_f1_score: 0.8681; train_kl_reg_loss: 66112.7449; train_edge_recon_loss: 2721338.9129; train_gene_expr_recon_loss: 10356941.3485; train_masked_gp_l1_reg_loss: 82342.2650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89785.7017; train_chrom_access_recon_loss: 5406752.8788; train_global_loss: 18723273.7879; train_optim_loss: 18723273.7879; val_kl_reg_loss: 47417.4458; val_edge_recon_loss: 2777031.2500; val_gene_expr_recon_loss: 10334958.7500; val_masked_gp_l1_reg_loss: 81214.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89659.0938; val_chrom_access_recon_loss: 5493061.5000; val_global_loss: 18823343.0000; val_optim_loss: 18823343.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9186; val_auprc_score: 0.8846; val_best_acc_score: 0.8632; val_best_f1_score: 0.8725; train_kl_reg_loss: 61124.7218; train_edge_recon_loss: 2725490.6515; train_gene_expr_recon_loss: 10337846.5909; train_masked_gp_l1_reg_loss: 80362.4348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89574.0298; train_chrom_access_recon_loss: 5391788.9318; train_global_loss: 18686187.4545; train_optim_loss: 18686187.4545; val_kl_reg_loss: 49296.4819; val_edge_recon_loss: 2780763.7500; val_gene_expr_recon_loss: 10359566.5000; val_masked_gp_l1_reg_loss: 79466.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89562.6016; val_chrom_access_recon_loss: 5473600.7500; val_global_loss: 18832256.5000; val_optim_loss: 18832256.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9266; val_auprc_score: 0.8916; val_best_acc_score: 0.8705; val_best_f1_score: 0.8782; train_kl_reg_loss: 62938.6903; train_edge_recon_loss: 2719087.7765; train_gene_expr_recon_loss: 10321881.8939; train_masked_gp_l1_reg_loss: 78672.6738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89152.6645; train_chrom_access_recon_loss: 5385811.6742; train_global_loss: 18657545.3939; train_optim_loss: 18657545.3939; val_kl_reg_loss: 50211.0771; val_edge_recon_loss: 2760708.5938; val_gene_expr_recon_loss: 10297733.0000; val_masked_gp_l1_reg_loss: 77879.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89651.9609; val_chrom_access_recon_loss: 5407259.0625; val_global_loss: 18683442.2500; val_optim_loss: 18683442.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9357; val_auprc_score: 0.9082; val_best_acc_score: 0.8804; val_best_f1_score: 0.8865; train_kl_reg_loss: 63042.5258; train_edge_recon_loss: 2712470.6212; train_gene_expr_recon_loss: 10304590.3636; train_masked_gp_l1_reg_loss: 77144.5208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88931.7103; train_chrom_access_recon_loss: 5377110.7424; train_global_loss: 18623290.6667; train_optim_loss: 18623290.6667; val_kl_reg_loss: 49395.9976; val_edge_recon_loss: 2736485.6562; val_gene_expr_recon_loss: 10342256.1250; val_masked_gp_l1_reg_loss: 76453.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88932.4141; val_chrom_access_recon_loss: 5442466.3125; val_global_loss: 18735990.0000; val_optim_loss: 18735990.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9290; val_auprc_score: 0.9005; val_best_acc_score: 0.8767; val_best_f1_score: 0.8835; train_kl_reg_loss: 61946.1948; train_edge_recon_loss: 2707331.0379; train_gene_expr_recon_loss: 10291030.6667; train_masked_gp_l1_reg_loss: 75828.0315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88502.5684; train_chrom_access_recon_loss: 5362585.3485; train_global_loss: 18587224.0606; train_optim_loss: 18587224.0606; val_kl_reg_loss: 52606.4751; val_edge_recon_loss: 2740580.5000; val_gene_expr_recon_loss: 10358085.6250; val_masked_gp_l1_reg_loss: 75204.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87983.2344; val_chrom_access_recon_loss: 5436338.8125; val_global_loss: 18750799.5000; val_optim_loss: 18750799.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9338; val_auprc_score: 0.9026; val_best_acc_score: 0.8834; val_best_f1_score: 0.8885; train_kl_reg_loss: 61027.6540; train_edge_recon_loss: 2709795.3788; train_gene_expr_recon_loss: 10268283.2727; train_masked_gp_l1_reg_loss: 74583.8428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88089.0723; train_chrom_access_recon_loss: 5356388.9848; train_global_loss: 18558168.2121; train_optim_loss: 18558168.2121; val_kl_reg_loss: 53035.7549; val_edge_recon_loss: 2731661.0000; val_gene_expr_recon_loss: 10310537.1250; val_masked_gp_l1_reg_loss: 74003.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88263.2188; val_chrom_access_recon_loss: 5470630.1875; val_global_loss: 18728130.7500; val_optim_loss: 18728130.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9347; val_auprc_score: 0.9150; val_best_acc_score: 0.8710; val_best_f1_score: 0.8776; train_kl_reg_loss: 58921.9446; train_edge_recon_loss: 2709422.3030; train_gene_expr_recon_loss: 10250273.2121; train_masked_gp_l1_reg_loss: 73545.7169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88008.7564; train_chrom_access_recon_loss: 5350946.4924; train_global_loss: 18531118.4242; train_optim_loss: 18531118.4242; val_kl_reg_loss: 52128.5791; val_edge_recon_loss: 2751997.9688; val_gene_expr_recon_loss: 10226597.1250; val_masked_gp_l1_reg_loss: 73005.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87939.5938; val_chrom_access_recon_loss: 5387936.1250; val_global_loss: 18579604.7500; val_optim_loss: 18579604.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9366; val_auprc_score: 0.9164; val_best_acc_score: 0.8753; val_best_f1_score: 0.8826; train_kl_reg_loss: 59198.5085; train_edge_recon_loss: 2702323.8333; train_gene_expr_recon_loss: 10238786.0758; train_masked_gp_l1_reg_loss: 72531.3478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88103.7255; train_chrom_access_recon_loss: 5345154.3636; train_global_loss: 18506097.9091; train_optim_loss: 18506097.9091; val_kl_reg_loss: 53364.2139; val_edge_recon_loss: 2734192.1562; val_gene_expr_recon_loss: 10311343.3750; val_masked_gp_l1_reg_loss: 72105.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87642.4141; val_chrom_access_recon_loss: 5446445.8750; val_global_loss: 18705092.7500; val_optim_loss: 18705092.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9273; val_auprc_score: 0.8926; val_best_acc_score: 0.8780; val_best_f1_score: 0.8850; train_kl_reg_loss: 58419.5971; train_edge_recon_loss: 2701619.1364; train_gene_expr_recon_loss: 10214537.1212; train_masked_gp_l1_reg_loss: 71753.0833; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87748.0889; train_chrom_access_recon_loss: 5335824.0379; train_global_loss: 18469900.9697; train_optim_loss: 18469900.9697; val_kl_reg_loss: 52954.2363; val_edge_recon_loss: 2733371.5000; val_gene_expr_recon_loss: 10182622.3750; val_masked_gp_l1_reg_loss: 71312.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87257.2812; val_chrom_access_recon_loss: 5372094.1250; val_global_loss: 18499611.5000; val_optim_loss: 18499611.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9354; val_auprc_score: 0.9067; val_best_acc_score: 0.8837; val_best_f1_score: 0.8917; train_kl_reg_loss: 58162.9635; train_edge_recon_loss: 2713153.4735; train_gene_expr_recon_loss: 10206325.6667; train_masked_gp_l1_reg_loss: 70887.4013; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87462.8505; train_chrom_access_recon_loss: 5331064.1212; train_global_loss: 18467056.5455; train_optim_loss: 18467056.5455; val_kl_reg_loss: 53221.0356; val_edge_recon_loss: 2707368.1875; val_gene_expr_recon_loss: 10199573.0000; val_masked_gp_l1_reg_loss: 70561.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87483.9375; val_chrom_access_recon_loss: 5415741.8125; val_global_loss: 18533948.7500; val_optim_loss: 18533948.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9359; val_auprc_score: 0.9046; val_best_acc_score: 0.8821; val_best_f1_score: 0.8888; train_kl_reg_loss: 58282.1884; train_edge_recon_loss: 2702764.5947; train_gene_expr_recon_loss: 10203706.2273; train_masked_gp_l1_reg_loss: 70205.2430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87259.6886; train_chrom_access_recon_loss: 5327605.6364; train_global_loss: 18449823.6667; train_optim_loss: 18449823.6667; val_kl_reg_loss: 53842.7241; val_edge_recon_loss: 2739095.3750; val_gene_expr_recon_loss: 10244957.6250; val_masked_gp_l1_reg_loss: 69895.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87412.3203; val_chrom_access_recon_loss: 5421580.4375; val_global_loss: 18616783.0000; val_optim_loss: 18616783.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9319; val_auprc_score: 0.9048; val_best_acc_score: 0.8759; val_best_f1_score: 0.8849; train_kl_reg_loss: 58447.6228; train_edge_recon_loss: 2713166.3220; train_gene_expr_recon_loss: 10188002.0606; train_masked_gp_l1_reg_loss: 69533.9769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87094.0075; train_chrom_access_recon_loss: 5321818.8409; train_global_loss: 18438062.7879; train_optim_loss: 18438062.7879; val_kl_reg_loss: 53276.1167; val_edge_recon_loss: 2741494.5625; val_gene_expr_recon_loss: 10286824.2500; val_masked_gp_l1_reg_loss: 69233.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86897.3516; val_chrom_access_recon_loss: 5496706.7500; val_global_loss: 18734432.7500; val_optim_loss: 18734432.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9387; val_auprc_score: 0.9102; val_best_acc_score: 0.8783; val_best_f1_score: 0.8863; train_kl_reg_loss: 58389.8062; train_edge_recon_loss: 2698429.2538; train_gene_expr_recon_loss: 10174929.4242; train_masked_gp_l1_reg_loss: 68940.0839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87011.3752; train_chrom_access_recon_loss: 5308319.4167; train_global_loss: 18396019.1818; train_optim_loss: 18396019.1818; val_kl_reg_loss: 53979.6973; val_edge_recon_loss: 2733714.0625; val_gene_expr_recon_loss: 10229889.5000; val_masked_gp_l1_reg_loss: 68513.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86961.2266; val_chrom_access_recon_loss: 5403998.0000; val_global_loss: 18577055.5000; val_optim_loss: 18577055.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9381; val_auprc_score: 0.9110; val_best_acc_score: 0.8845; val_best_f1_score: 0.8932; train_kl_reg_loss: 58441.3000; train_edge_recon_loss: 2694436.7348; train_gene_expr_recon_loss: 10166893.5606; train_masked_gp_l1_reg_loss: 68007.1180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71780.8479; train_chrom_access_recon_loss: 5307142.8258; train_global_loss: 18366702.4545; train_optim_loss: 18366702.4545; val_kl_reg_loss: 54232.5762; val_edge_recon_loss: 2728064.0000; val_gene_expr_recon_loss: 10144017.6250; val_masked_gp_l1_reg_loss: 67829.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68863.5391; val_chrom_access_recon_loss: 5337190.8125; val_global_loss: 18400198.0000; val_optim_loss: 18400198.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9327; val_auprc_score: 0.8975; val_best_acc_score: 0.8783; val_best_f1_score: 0.8863; train_kl_reg_loss: 58833.1384; train_edge_recon_loss: 2685159.4735; train_gene_expr_recon_loss: 10159963.9091; train_masked_gp_l1_reg_loss: 67787.3986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68561.7129; train_chrom_access_recon_loss: 5301900.2348; train_global_loss: 18342205.7879; train_optim_loss: 18342205.7879; val_kl_reg_loss: 55075.4199; val_edge_recon_loss: 2726932.9375; val_gene_expr_recon_loss: 10174165.2500; val_masked_gp_l1_reg_loss: 67759.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68294.6484; val_chrom_access_recon_loss: 5391269.1875; val_global_loss: 18483496.7500; val_optim_loss: 18483496.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9381; val_auprc_score: 0.9106; val_best_acc_score: 0.8799; val_best_f1_score: 0.8882; train_kl_reg_loss: 59357.6689; train_edge_recon_loss: 2699447.7614; train_gene_expr_recon_loss: 10156387.4848; train_masked_gp_l1_reg_loss: 67728.5882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68082.9325; train_chrom_access_recon_loss: 5303966.9697; train_global_loss: 18354971.3636; train_optim_loss: 18354971.3636; val_kl_reg_loss: 55419.9409; val_edge_recon_loss: 2748534.6875; val_gene_expr_recon_loss: 10176328.3750; val_masked_gp_l1_reg_loss: 67700.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67889.0156; val_chrom_access_recon_loss: 5396785.9375; val_global_loss: 18512657.7500; val_optim_loss: 18512657.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9438; val_auprc_score: 0.9252; val_best_acc_score: 0.8864; val_best_f1_score: 0.8943; train_kl_reg_loss: 59233.1931; train_edge_recon_loss: 2683286.7159; train_gene_expr_recon_loss: 10150247.7424; train_masked_gp_l1_reg_loss: 67675.6829; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67829.3318; train_chrom_access_recon_loss: 5293590.2652; train_global_loss: 18321862.7273; train_optim_loss: 18321862.7273; val_kl_reg_loss: 56106.8164; val_edge_recon_loss: 2712579.6562; val_gene_expr_recon_loss: 10195437.1250; val_masked_gp_l1_reg_loss: 67648.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67685.7969; val_chrom_access_recon_loss: 5389304.1875; val_global_loss: 18488761.7500; val_optim_loss: 18488761.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9422; val_auprc_score: 0.9233; val_best_acc_score: 0.8845; val_best_f1_score: 0.8917; train_kl_reg_loss: 59702.2824; train_edge_recon_loss: 2692940.4318; train_gene_expr_recon_loss: 10151439.9394; train_masked_gp_l1_reg_loss: 67612.3099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67601.4777; train_chrom_access_recon_loss: 5297099.8258; train_global_loss: 18336396.2121; train_optim_loss: 18336396.2121; val_kl_reg_loss: 56040.4829; val_edge_recon_loss: 2733937.0000; val_gene_expr_recon_loss: 10132990.0000; val_masked_gp_l1_reg_loss: 67583.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67481.7500; val_chrom_access_recon_loss: 5361054.4375; val_global_loss: 18419086.7500; val_optim_loss: 18419086.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9362; val_auprc_score: 0.9011; val_best_acc_score: 0.8823; val_best_f1_score: 0.8897; train_kl_reg_loss: 59992.0413; train_edge_recon_loss: 2683328.2045; train_gene_expr_recon_loss: 10160356.4697; train_masked_gp_l1_reg_loss: 67529.5930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65813.6025; train_chrom_access_recon_loss: 5302759.5530; train_global_loss: 18339779.5152; train_optim_loss: 18339779.5152; val_kl_reg_loss: 56454.3657; val_edge_recon_loss: 2727752.6875; val_gene_expr_recon_loss: 10199545.8750; val_masked_gp_l1_reg_loss: 67509.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65491.7773; val_chrom_access_recon_loss: 5372789.7500; val_global_loss: 18489543.7500; val_optim_loss: 18489543.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9402; val_auprc_score: 0.9135; val_best_acc_score: 0.8853; val_best_f1_score: 0.8921; train_kl_reg_loss: 59946.6057; train_edge_recon_loss: 2687906.0720; train_gene_expr_recon_loss: 10151836.6970; train_masked_gp_l1_reg_loss: 67501.7514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65464.4366; train_chrom_access_recon_loss: 5297854.6439; train_global_loss: 18330510.3333; train_optim_loss: 18330510.3333; val_kl_reg_loss: 56543.7183; val_edge_recon_loss: 2704020.8125; val_gene_expr_recon_loss: 10183493.1250; val_masked_gp_l1_reg_loss: 67495.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65437.9180; val_chrom_access_recon_loss: 5411589.8750; val_global_loss: 18488581.7500; val_optim_loss: 18488581.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9361; val_auprc_score: 0.9103; val_best_acc_score: 0.8810; val_best_f1_score: 0.8893; train_kl_reg_loss: 59799.8494; train_edge_recon_loss: 2701770.2879; train_gene_expr_recon_loss: 10141172.5000; train_masked_gp_l1_reg_loss: 67489.2753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65419.8671; train_chrom_access_recon_loss: 5288244.0530; train_global_loss: 18323895.9091; train_optim_loss: 18323895.9091; val_kl_reg_loss: 55962.6987; val_edge_recon_loss: 2723842.8438; val_gene_expr_recon_loss: 10178564.1250; val_masked_gp_l1_reg_loss: 67484.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65397.3477; val_chrom_access_recon_loss: 5398922.6250; val_global_loss: 18490173.7500; val_optim_loss: 18490173.7500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9429; val_auprc_score: 0.9202; val_best_acc_score: 0.8858; val_best_f1_score: 0.8939; train_kl_reg_loss: 59852.4931; train_edge_recon_loss: 2686382.6288; train_gene_expr_recon_loss: 10155349.7273; train_masked_gp_l1_reg_loss: 67480.6587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65381.7700; train_chrom_access_recon_loss: 5303057.2273; train_global_loss: 18337504.3636; train_optim_loss: 18337504.3636; val_kl_reg_loss: 55986.4419; val_edge_recon_loss: 2721896.9062; val_gene_expr_recon_loss: 10175347.5000; val_masked_gp_l1_reg_loss: 67476.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65367.1055; val_chrom_access_recon_loss: 5432653.6250; val_global_loss: 18518727.2500; val_optim_loss: 18518727.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 16 min 45 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9439
val AUPRC score: 0.9222
val best accuracy score: 0.8907
val best F1 score: 0.8962
val target rna MSE score: 2.2022
val source rna MSE score: 1.1447
val target atac MSE score: 0.3375
val source atac MSE score: 0.1392
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
