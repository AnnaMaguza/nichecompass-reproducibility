[True]
Run timestamp: 10102023_004238_91.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_91']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7146; val_auprc_score: 0.6866; val_best_acc_score: 0.5013; val_best_f1_score: 0.6669; train_kl_reg_loss: 40352.4425; train_edge_recon_loss: 3501812.1364; train_gene_expr_recon_loss: 14048160.7273; train_masked_gp_l1_reg_loss: 44657.9663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5503797.6477; train_chrom_access_recon_loss: 2991730.2841; train_global_loss: 26130511.0606; train_optim_loss: 26130511.0606; val_kl_reg_loss: 87981.0264; val_edge_recon_loss: 4064980.3438; val_gene_expr_recon_loss: 13163973.5000; val_masked_gp_l1_reg_loss: 53781.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2489970.5000; val_chrom_access_recon_loss: 2849044.0000; val_global_loss: 22709731.0000; val_optim_loss: 22709731.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6657; val_auprc_score: 0.6414; val_best_acc_score: 0.5965; val_best_f1_score: 0.6921; train_kl_reg_loss: 84130.0148; train_edge_recon_loss: 3510761.7614; train_gene_expr_recon_loss: 12907891.1818; train_masked_gp_l1_reg_loss: 57351.5611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1132766.8958; train_chrom_access_recon_loss: 2850518.7197; train_global_loss: 20543420.0606; train_optim_loss: 20543420.0606; val_kl_reg_loss: 90845.2754; val_edge_recon_loss: 4058736.0312; val_gene_expr_recon_loss: 12684050.5000; val_masked_gp_l1_reg_loss: 59388.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 448871.3438; val_chrom_access_recon_loss: 2790794.4375; val_global_loss: 20132686.7500; val_optim_loss: 20132686.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7103; val_auprc_score: 0.6892; val_best_acc_score: 0.6308; val_best_f1_score: 0.7108; train_kl_reg_loss: 80817.5112; train_edge_recon_loss: 3508505.3523; train_gene_expr_recon_loss: 12712451.1818; train_masked_gp_l1_reg_loss: 60481.2568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 305768.3134; train_chrom_access_recon_loss: 2821256.9621; train_global_loss: 19489280.5152; train_optim_loss: 19489280.5152; val_kl_reg_loss: 69594.9121; val_edge_recon_loss: 4030830.5938; val_gene_expr_recon_loss: 12737778.2500; val_masked_gp_l1_reg_loss: 61507.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 216663.5781; val_chrom_access_recon_loss: 2783599.6250; val_global_loss: 19899975.5000; val_optim_loss: 19899975.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7694; val_auprc_score: 0.7571; val_best_acc_score: 0.6980; val_best_f1_score: 0.7263; train_kl_reg_loss: 66288.4235; train_edge_recon_loss: 3466745.1326; train_gene_expr_recon_loss: 12626840.7727; train_masked_gp_l1_reg_loss: 62631.2692; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181211.2289; train_chrom_access_recon_loss: 2808599.0227; train_global_loss: 19212315.9697; train_optim_loss: 19212315.9697; val_kl_reg_loss: 49240.9541; val_edge_recon_loss: 3516124.6562; val_gene_expr_recon_loss: 12502322.8750; val_masked_gp_l1_reg_loss: 64387.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154908.9688; val_chrom_access_recon_loss: 2771451.1875; val_global_loss: 19058436.5000; val_optim_loss: 19058436.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8166; val_auprc_score: 0.8085; val_best_acc_score: 0.7324; val_best_f1_score: 0.7567; train_kl_reg_loss: 62799.0929; train_edge_recon_loss: 3164488.1856; train_gene_expr_recon_loss: 12580150.5152; train_masked_gp_l1_reg_loss: 67577.8446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138487.3955; train_chrom_access_recon_loss: 2794808.8826; train_global_loss: 18808311.9697; train_optim_loss: 18808311.9697; val_kl_reg_loss: 72452.2705; val_edge_recon_loss: 3139339.6875; val_gene_expr_recon_loss: 12582299.7500; val_masked_gp_l1_reg_loss: 70593.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125968.5391; val_chrom_access_recon_loss: 2749492.0625; val_global_loss: 18740145.2500; val_optim_loss: 18740145.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8673; val_auprc_score: 0.8316; val_best_acc_score: 0.8023; val_best_f1_score: 0.8178; train_kl_reg_loss: 83522.3707; train_edge_recon_loss: 2942014.4583; train_gene_expr_recon_loss: 12496134.0455; train_masked_gp_l1_reg_loss: 73223.2420; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120346.8291; train_chrom_access_recon_loss: 2780546.4621; train_global_loss: 18495787.3333; train_optim_loss: 18495787.3333; val_kl_reg_loss: 93739.3184; val_edge_recon_loss: 2950562.4062; val_gene_expr_recon_loss: 12419598.5000; val_masked_gp_l1_reg_loss: 75810.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117341.3125; val_chrom_access_recon_loss: 2713532.5625; val_global_loss: 18370584.5000; val_optim_loss: 18370584.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8888; val_auprc_score: 0.8583; val_best_acc_score: 0.8184; val_best_f1_score: 0.8335; train_kl_reg_loss: 103278.5833; train_edge_recon_loss: 2837852.6742; train_gene_expr_recon_loss: 12413696.0909; train_masked_gp_l1_reg_loss: 77443.9580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116077.0717; train_chrom_access_recon_loss: 2762997.0417; train_global_loss: 18311345.4545; train_optim_loss: 18311345.4545; val_kl_reg_loss: 99228.1367; val_edge_recon_loss: 2886911.6562; val_gene_expr_recon_loss: 12345687.7500; val_masked_gp_l1_reg_loss: 78704.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115103.5938; val_chrom_access_recon_loss: 2726285.9062; val_global_loss: 18251921.2500; val_optim_loss: 18251921.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9061; val_auprc_score: 0.8790; val_best_acc_score: 0.8404; val_best_f1_score: 0.8519; train_kl_reg_loss: 100514.7051; train_edge_recon_loss: 2817386.4924; train_gene_expr_recon_loss: 12337991.9697; train_masked_gp_l1_reg_loss: 79584.5604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113719.4229; train_chrom_access_recon_loss: 2752056.8977; train_global_loss: 18201254.1212; train_optim_loss: 18201254.1212; val_kl_reg_loss: 97221.5146; val_edge_recon_loss: 2816838.3438; val_gene_expr_recon_loss: 12321655.8750; val_masked_gp_l1_reg_loss: 80475.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111824.2578; val_chrom_access_recon_loss: 2701785.7500; val_global_loss: 18129800.7500; val_optim_loss: 18129800.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8959; val_auprc_score: 0.8601; val_best_acc_score: 0.8294; val_best_f1_score: 0.8437; train_kl_reg_loss: 101334.7507; train_edge_recon_loss: 2816377.8523; train_gene_expr_recon_loss: 12274793.3485; train_masked_gp_l1_reg_loss: 81176.0008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110672.9194; train_chrom_access_recon_loss: 2741552.3258; train_global_loss: 18125907.3939; train_optim_loss: 18125907.3939; val_kl_reg_loss: 98776.4355; val_edge_recon_loss: 2847909.5938; val_gene_expr_recon_loss: 12171151.2500; val_masked_gp_l1_reg_loss: 81841.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109849.4453; val_chrom_access_recon_loss: 2693218.7812; val_global_loss: 18002746.0000; val_optim_loss: 18002746.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9073; val_auprc_score: 0.8797; val_best_acc_score: 0.8490; val_best_f1_score: 0.8571; train_kl_reg_loss: 99125.2902; train_edge_recon_loss: 2804362.3561; train_gene_expr_recon_loss: 12218934.8788; train_masked_gp_l1_reg_loss: 82473.1860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108259.1042; train_chrom_access_recon_loss: 2727209.6364; train_global_loss: 18040364.3030; train_optim_loss: 18040364.3030; val_kl_reg_loss: 94160.6445; val_edge_recon_loss: 2846253.9062; val_gene_expr_recon_loss: 12200313.5000; val_masked_gp_l1_reg_loss: 83133.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107453.7734; val_chrom_access_recon_loss: 2675688.0312; val_global_loss: 18007003.2500; val_optim_loss: 18007003.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9016; val_auprc_score: 0.8701; val_best_acc_score: 0.8383; val_best_f1_score: 0.8493; train_kl_reg_loss: 95993.8623; train_edge_recon_loss: 2788921.9697; train_gene_expr_recon_loss: 12181197.4697; train_masked_gp_l1_reg_loss: 83616.3268; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105524.7965; train_chrom_access_recon_loss: 2719941.3561; train_global_loss: 17975195.8485; train_optim_loss: 17975195.8485; val_kl_reg_loss: 90781.2725; val_edge_recon_loss: 2845041.7812; val_gene_expr_recon_loss: 12214541.3750; val_masked_gp_l1_reg_loss: 84151.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104443.5234; val_chrom_access_recon_loss: 2665486.4375; val_global_loss: 18004446.0000; val_optim_loss: 18004446.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9145; val_auprc_score: 0.8846; val_best_acc_score: 0.8538; val_best_f1_score: 0.8627; train_kl_reg_loss: 92439.4522; train_edge_recon_loss: 2795365.7689; train_gene_expr_recon_loss: 12127125.5909; train_masked_gp_l1_reg_loss: 84647.1952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102758.0085; train_chrom_access_recon_loss: 2709532.9167; train_global_loss: 17911868.8182; train_optim_loss: 17911868.8182; val_kl_reg_loss: 90456.0596; val_edge_recon_loss: 2802822.8438; val_gene_expr_recon_loss: 12101195.5000; val_masked_gp_l1_reg_loss: 85396.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101944.3906; val_chrom_access_recon_loss: 2652547.0000; val_global_loss: 17834362.7500; val_optim_loss: 17834362.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9157; val_auprc_score: 0.8946; val_best_acc_score: 0.8546; val_best_f1_score: 0.8642; train_kl_reg_loss: 90407.1435; train_edge_recon_loss: 2783877.3333; train_gene_expr_recon_loss: 12093127.6061; train_masked_gp_l1_reg_loss: 85870.6676; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100320.7373; train_chrom_access_recon_loss: 2703958.5720; train_global_loss: 17857562.0303; train_optim_loss: 17857562.0303; val_kl_reg_loss: 89304.0332; val_edge_recon_loss: 2819691.6250; val_gene_expr_recon_loss: 12061054.7500; val_masked_gp_l1_reg_loss: 86443.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99509.1562; val_chrom_access_recon_loss: 2655302.7812; val_global_loss: 17811305.0000; val_optim_loss: 17811305.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9099; val_auprc_score: 0.8737; val_best_acc_score: 0.8549; val_best_f1_score: 0.8618; train_kl_reg_loss: 89743.3506; train_edge_recon_loss: 2784377.2689; train_gene_expr_recon_loss: 12060371.6667; train_masked_gp_l1_reg_loss: 86880.7365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98854.1729; train_chrom_access_recon_loss: 2696766.5795; train_global_loss: 17816993.7879; train_optim_loss: 17816993.7879; val_kl_reg_loss: 89969.8271; val_edge_recon_loss: 2841655.7500; val_gene_expr_recon_loss: 12028414.0000; val_masked_gp_l1_reg_loss: 87230.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98903.2812; val_chrom_access_recon_loss: 2654917.4062; val_global_loss: 17801090.0000; val_optim_loss: 17801090.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9118; val_auprc_score: 0.8801; val_best_acc_score: 0.8557; val_best_f1_score: 0.8649; train_kl_reg_loss: 89988.5778; train_edge_recon_loss: 2769682.1098; train_gene_expr_recon_loss: 12009073.5606; train_masked_gp_l1_reg_loss: 87569.1663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97526.9310; train_chrom_access_recon_loss: 2684595.5000; train_global_loss: 17738435.8788; train_optim_loss: 17738435.8788; val_kl_reg_loss: 91703.9160; val_edge_recon_loss: 2825214.7812; val_gene_expr_recon_loss: 12049987.3750; val_masked_gp_l1_reg_loss: 87864.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96413.3672; val_chrom_access_recon_loss: 2645986.5000; val_global_loss: 17797170.2500; val_optim_loss: 17797170.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9095; val_auprc_score: 0.8688; val_best_acc_score: 0.8536; val_best_f1_score: 0.8634; train_kl_reg_loss: 89349.3558; train_edge_recon_loss: 2773854.2538; train_gene_expr_recon_loss: 11972246.6515; train_masked_gp_l1_reg_loss: 88135.8179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96297.9197; train_chrom_access_recon_loss: 2676126.2689; train_global_loss: 17696010.3333; train_optim_loss: 17696010.3333; val_kl_reg_loss: 89222.9639; val_edge_recon_loss: 2822921.3750; val_gene_expr_recon_loss: 11999974.5000; val_masked_gp_l1_reg_loss: 88391.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96210.7812; val_chrom_access_recon_loss: 2629741.2188; val_global_loss: 17726462.7500; val_optim_loss: 17726462.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9142; val_auprc_score: 0.8882; val_best_acc_score: 0.8533; val_best_f1_score: 0.8623; train_kl_reg_loss: 89250.2674; train_edge_recon_loss: 2771037.6742; train_gene_expr_recon_loss: 11951569.4545; train_masked_gp_l1_reg_loss: 88742.5878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95412.1792; train_chrom_access_recon_loss: 2669483.5038; train_global_loss: 17665495.6061; train_optim_loss: 17665495.6061; val_kl_reg_loss: 88448.4990; val_edge_recon_loss: 2812570.3438; val_gene_expr_recon_loss: 11918269.2500; val_masked_gp_l1_reg_loss: 89033.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94532.8359; val_chrom_access_recon_loss: 2611618.8438; val_global_loss: 17614472.7500; val_optim_loss: 17614472.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9294; val_auprc_score: 0.9109; val_best_acc_score: 0.8681; val_best_f1_score: 0.8756; train_kl_reg_loss: 89178.5489; train_edge_recon_loss: 2747732.5833; train_gene_expr_recon_loss: 11924352.1515; train_masked_gp_l1_reg_loss: 89277.9757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93868.2044; train_chrom_access_recon_loss: 2664337.5492; train_global_loss: 17608747.2121; train_optim_loss: 17608747.2121; val_kl_reg_loss: 91958.1777; val_edge_recon_loss: 2781872.2812; val_gene_expr_recon_loss: 11846571.8750; val_masked_gp_l1_reg_loss: 89409.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93689.1797; val_chrom_access_recon_loss: 2639690.1562; val_global_loss: 17543191.7500; val_optim_loss: 17543191.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9226; val_auprc_score: 0.8985; val_best_acc_score: 0.8598; val_best_f1_score: 0.8681; train_kl_reg_loss: 87396.0146; train_edge_recon_loss: 2743405.2879; train_gene_expr_recon_loss: 11889390.1061; train_masked_gp_l1_reg_loss: 89748.6340; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93276.8224; train_chrom_access_recon_loss: 2655921.1023; train_global_loss: 17559137.9091; train_optim_loss: 17559137.9091; val_kl_reg_loss: 87042.8945; val_edge_recon_loss: 2782011.4375; val_gene_expr_recon_loss: 11896299.0000; val_masked_gp_l1_reg_loss: 89983.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93179.1562; val_chrom_access_recon_loss: 2609354.0938; val_global_loss: 17557869.5000; val_optim_loss: 17557869.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9288; val_auprc_score: 0.9054; val_best_acc_score: 0.8641; val_best_f1_score: 0.8723; train_kl_reg_loss: 86918.9706; train_edge_recon_loss: 2742305.1212; train_gene_expr_recon_loss: 11861353.6515; train_masked_gp_l1_reg_loss: 90127.5121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92463.3641; train_chrom_access_recon_loss: 2649911.7879; train_global_loss: 17523080.4242; train_optim_loss: 17523080.4242; val_kl_reg_loss: 87578.4297; val_edge_recon_loss: 2788721.0312; val_gene_expr_recon_loss: 11933269.8750; val_masked_gp_l1_reg_loss: 90422.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92403.7266; val_chrom_access_recon_loss: 2637246.1875; val_global_loss: 17629641.5000; val_optim_loss: 17629641.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9318; val_auprc_score: 0.9100; val_best_acc_score: 0.8713; val_best_f1_score: 0.8793; train_kl_reg_loss: 86655.0838; train_edge_recon_loss: 2751682.5492; train_gene_expr_recon_loss: 11830817.4848; train_masked_gp_l1_reg_loss: 90498.8227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92313.8822; train_chrom_access_recon_loss: 2642248.1439; train_global_loss: 17494215.9242; train_optim_loss: 17494215.9242; val_kl_reg_loss: 85494.6973; val_edge_recon_loss: 2761260.0938; val_gene_expr_recon_loss: 11827187.6250; val_masked_gp_l1_reg_loss: 90669.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92607.5469; val_chrom_access_recon_loss: 2592938.5312; val_global_loss: 17450158.0000; val_optim_loss: 17450158.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9337; val_auprc_score: 0.9091; val_best_acc_score: 0.8778; val_best_f1_score: 0.8840; train_kl_reg_loss: 85830.9077; train_edge_recon_loss: 2736195.8371; train_gene_expr_recon_loss: 11801974.1818; train_masked_gp_l1_reg_loss: 90811.3967; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92150.3106; train_chrom_access_recon_loss: 2637903.8106; train_global_loss: 17444866.3030; train_optim_loss: 17444866.3030; val_kl_reg_loss: 84315.6162; val_edge_recon_loss: 2719217.9062; val_gene_expr_recon_loss: 11805218.5000; val_masked_gp_l1_reg_loss: 90960.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92475.5391; val_chrom_access_recon_loss: 2587376.1562; val_global_loss: 17379565.5000; val_optim_loss: 17379565.5000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9319; val_auprc_score: 0.9014; val_best_acc_score: 0.8716; val_best_f1_score: 0.8786; train_kl_reg_loss: 84636.8394; train_edge_recon_loss: 2739494.2311; train_gene_expr_recon_loss: 11775337.8636; train_masked_gp_l1_reg_loss: 91097.4321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92050.6651; train_chrom_access_recon_loss: 2630317.9811; train_global_loss: 17412935.0455; train_optim_loss: 17412935.0455; val_kl_reg_loss: 85031.2354; val_edge_recon_loss: 2760100.5625; val_gene_expr_recon_loss: 11811986.1250; val_masked_gp_l1_reg_loss: 91198.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92065.8281; val_chrom_access_recon_loss: 2605992.4375; val_global_loss: 17446374.5000; val_optim_loss: 17446374.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9376; val_auprc_score: 0.9186; val_best_acc_score: 0.8761; val_best_f1_score: 0.8824; train_kl_reg_loss: 86198.1874; train_edge_recon_loss: 2734476.1136; train_gene_expr_recon_loss: 11755289.1667; train_masked_gp_l1_reg_loss: 91275.9839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91882.8169; train_chrom_access_recon_loss: 2624712.8409; train_global_loss: 17383835.0303; train_optim_loss: 17383835.0303; val_kl_reg_loss: 87297.4336; val_edge_recon_loss: 2775309.8750; val_gene_expr_recon_loss: 11726200.2500; val_masked_gp_l1_reg_loss: 91561.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92742.6875; val_chrom_access_recon_loss: 2589272.5312; val_global_loss: 17362384.0000; val_optim_loss: 17362384.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9349; val_auprc_score: 0.9144; val_best_acc_score: 0.8761; val_best_f1_score: 0.8840; train_kl_reg_loss: 84143.4654; train_edge_recon_loss: 2719322.7121; train_gene_expr_recon_loss: 11723952.8182; train_masked_gp_l1_reg_loss: 91614.8828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92286.5392; train_chrom_access_recon_loss: 2621585.6553; train_global_loss: 17332906.0909; train_optim_loss: 17332906.0909; val_kl_reg_loss: 82127.0449; val_edge_recon_loss: 2772502.0938; val_gene_expr_recon_loss: 11828535.7500; val_masked_gp_l1_reg_loss: 91637.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92641.0156; val_chrom_access_recon_loss: 2599956.7812; val_global_loss: 17467400.5000; val_optim_loss: 17467400.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9342; val_auprc_score: 0.9107; val_best_acc_score: 0.8759; val_best_f1_score: 0.8837; train_kl_reg_loss: 83768.9493; train_edge_recon_loss: 2724749.3788; train_gene_expr_recon_loss: 11719669.0152; train_masked_gp_l1_reg_loss: 91688.6907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92372.1378; train_chrom_access_recon_loss: 2618983.9811; train_global_loss: 17331232.1818; train_optim_loss: 17331232.1818; val_kl_reg_loss: 85610.6699; val_edge_recon_loss: 2764264.9688; val_gene_expr_recon_loss: 11660930.1250; val_masked_gp_l1_reg_loss: 91747.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92069.6719; val_chrom_access_recon_loss: 2593170.6562; val_global_loss: 17287793.2500; val_optim_loss: 17287793.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9386; val_auprc_score: 0.9153; val_best_acc_score: 0.8823; val_best_f1_score: 0.8866; train_kl_reg_loss: 83440.5826; train_edge_recon_loss: 2715475.5606; train_gene_expr_recon_loss: 11697003.2576; train_masked_gp_l1_reg_loss: 91791.8092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92065.6934; train_chrom_access_recon_loss: 2612379.8144; train_global_loss: 17292156.6515; train_optim_loss: 17292156.6515; val_kl_reg_loss: 83322.3457; val_edge_recon_loss: 2767787.5000; val_gene_expr_recon_loss: 11670906.1250; val_masked_gp_l1_reg_loss: 91953.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92387.2109; val_chrom_access_recon_loss: 2564123.8438; val_global_loss: 17270481.2500; val_optim_loss: 17270481.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9362; val_auprc_score: 0.9132; val_best_acc_score: 0.8775; val_best_f1_score: 0.8832; train_kl_reg_loss: 83841.7418; train_edge_recon_loss: 2721086.5720; train_gene_expr_recon_loss: 11670814.3939; train_masked_gp_l1_reg_loss: 91951.8790; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92064.8042; train_chrom_access_recon_loss: 2606454.0379; train_global_loss: 17266213.3333; train_optim_loss: 17266213.3333; val_kl_reg_loss: 83773.3027; val_edge_recon_loss: 2778463.5938; val_gene_expr_recon_loss: 11654184.8750; val_masked_gp_l1_reg_loss: 92004.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92092.7812; val_chrom_access_recon_loss: 2575608.6562; val_global_loss: 17276128.2500; val_optim_loss: 17276128.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9399; val_auprc_score: 0.9182; val_best_acc_score: 0.8821; val_best_f1_score: 0.8853; train_kl_reg_loss: 83841.5432; train_edge_recon_loss: 2717520.7765; train_gene_expr_recon_loss: 11662232.6212; train_masked_gp_l1_reg_loss: 91981.8458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91760.2346; train_chrom_access_recon_loss: 2604787.8182; train_global_loss: 17252124.8788; train_optim_loss: 17252124.8788; val_kl_reg_loss: 80918.2256; val_edge_recon_loss: 2787768.5000; val_gene_expr_recon_loss: 11586410.3750; val_masked_gp_l1_reg_loss: 91841.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91585.7734; val_chrom_access_recon_loss: 2548634.0000; val_global_loss: 17187158.0000; val_optim_loss: 17187158.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9424; val_auprc_score: 0.9206; val_best_acc_score: 0.8826; val_best_f1_score: 0.8877; train_kl_reg_loss: 82774.5178; train_edge_recon_loss: 2713900.0758; train_gene_expr_recon_loss: 11650493.7576; train_masked_gp_l1_reg_loss: 91945.9239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91705.4835; train_chrom_access_recon_loss: 2599705.0303; train_global_loss: 17230524.7424; train_optim_loss: 17230524.7424; val_kl_reg_loss: 83795.4844; val_edge_recon_loss: 2756643.5625; val_gene_expr_recon_loss: 11626200.8750; val_masked_gp_l1_reg_loss: 91922.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91906.1875; val_chrom_access_recon_loss: 2577875.2188; val_global_loss: 17228344.0000; val_optim_loss: 17228344.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9463; val_auprc_score: 0.9291; val_best_acc_score: 0.8885; val_best_f1_score: 0.8950; train_kl_reg_loss: 82566.7096; train_edge_recon_loss: 2711866.0758; train_gene_expr_recon_loss: 11634472.4848; train_masked_gp_l1_reg_loss: 92025.8093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92178.0876; train_chrom_access_recon_loss: 2594410.1288; train_global_loss: 17207519.3636; train_optim_loss: 17207519.3636; val_kl_reg_loss: 82061.1807; val_edge_recon_loss: 2751614.5938; val_gene_expr_recon_loss: 11627013.7500; val_masked_gp_l1_reg_loss: 92115.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91949.1406; val_chrom_access_recon_loss: 2570038.0312; val_global_loss: 17214792.6250; val_optim_loss: 17214792.6250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9479; val_auprc_score: 0.9287; val_best_acc_score: 0.8923; val_best_f1_score: 0.8983; train_kl_reg_loss: 81806.7649; train_edge_recon_loss: 2711639.1629; train_gene_expr_recon_loss: 11609605.2273; train_masked_gp_l1_reg_loss: 92102.4600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91841.5342; train_chrom_access_recon_loss: 2588900.0417; train_global_loss: 17175895.1515; train_optim_loss: 17175895.1515; val_kl_reg_loss: 81780.8721; val_edge_recon_loss: 2724159.1562; val_gene_expr_recon_loss: 11601776.3750; val_masked_gp_l1_reg_loss: 92309.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91776.1172; val_chrom_access_recon_loss: 2546064.7500; val_global_loss: 17137865.5000; val_optim_loss: 17137865.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9466; val_auprc_score: 0.9303; val_best_acc_score: 0.8893; val_best_f1_score: 0.8943; train_kl_reg_loss: 82375.3736; train_edge_recon_loss: 2707154.5682; train_gene_expr_recon_loss: 11596721.2727; train_masked_gp_l1_reg_loss: 92261.3145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91679.9741; train_chrom_access_recon_loss: 2586478.3371; train_global_loss: 17156670.7424; train_optim_loss: 17156670.7424; val_kl_reg_loss: 82030.7803; val_edge_recon_loss: 2750638.9375; val_gene_expr_recon_loss: 11630886.1250; val_masked_gp_l1_reg_loss: 92202.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91819.0000; val_chrom_access_recon_loss: 2570391.3438; val_global_loss: 17217969.2500; val_optim_loss: 17217969.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9481; val_auprc_score: 0.9317; val_best_acc_score: 0.8936; val_best_f1_score: 0.8984; train_kl_reg_loss: 82366.5838; train_edge_recon_loss: 2698981.6932; train_gene_expr_recon_loss: 11585065.3939; train_masked_gp_l1_reg_loss: 92104.5653; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91834.0286; train_chrom_access_recon_loss: 2581769.5606; train_global_loss: 17132121.9242; train_optim_loss: 17132121.9242; val_kl_reg_loss: 83224.9561; val_edge_recon_loss: 2732757.6562; val_gene_expr_recon_loss: 11555856.3750; val_masked_gp_l1_reg_loss: 92187.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91455.2188; val_chrom_access_recon_loss: 2533077.1562; val_global_loss: 17088559.0000; val_optim_loss: 17088559.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9496; val_auprc_score: 0.9334; val_best_acc_score: 0.8963; val_best_f1_score: 0.9002; train_kl_reg_loss: 80896.6947; train_edge_recon_loss: 2708777.1705; train_gene_expr_recon_loss: 11565461.7424; train_masked_gp_l1_reg_loss: 92084.0503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91401.1487; train_chrom_access_recon_loss: 2576075.8523; train_global_loss: 17114696.7273; train_optim_loss: 17114696.7273; val_kl_reg_loss: 80434.1836; val_edge_recon_loss: 2737135.2500; val_gene_expr_recon_loss: 11576209.8750; val_masked_gp_l1_reg_loss: 92274.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92066.5703; val_chrom_access_recon_loss: 2549902.2188; val_global_loss: 17128022.6250; val_optim_loss: 17128022.6250
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9438; val_auprc_score: 0.9207; val_best_acc_score: 0.8885; val_best_f1_score: 0.8942; train_kl_reg_loss: 81417.9918; train_edge_recon_loss: 2707643.3144; train_gene_expr_recon_loss: 11546113.7273; train_masked_gp_l1_reg_loss: 92189.7533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91587.8770; train_chrom_access_recon_loss: 2569830.2424; train_global_loss: 17088782.9545; train_optim_loss: 17088782.9545; val_kl_reg_loss: 80236.1191; val_edge_recon_loss: 2762953.9062; val_gene_expr_recon_loss: 11646447.8750; val_masked_gp_l1_reg_loss: 92224.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91774.9375; val_chrom_access_recon_loss: 2548833.7188; val_global_loss: 17222471.0000; val_optim_loss: 17222471.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9469; val_auprc_score: 0.9269; val_best_acc_score: 0.8990; val_best_f1_score: 0.9045; train_kl_reg_loss: 80186.6802; train_edge_recon_loss: 2706503.2689; train_gene_expr_recon_loss: 11543525.2727; train_masked_gp_l1_reg_loss: 92161.7365; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91652.0618; train_chrom_access_recon_loss: 2569115.4242; train_global_loss: 17083144.3939; train_optim_loss: 17083144.3939; val_kl_reg_loss: 78356.9609; val_edge_recon_loss: 2748338.3438; val_gene_expr_recon_loss: 11622667.1250; val_masked_gp_l1_reg_loss: 92210.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91976.6562; val_chrom_access_recon_loss: 2550006.6875; val_global_loss: 17183557.0000; val_optim_loss: 17183557.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9505; val_auprc_score: 0.9346; val_best_acc_score: 0.8944; val_best_f1_score: 0.8989; train_kl_reg_loss: 79958.7016; train_edge_recon_loss: 2698692.6629; train_gene_expr_recon_loss: 11538323.0303; train_masked_gp_l1_reg_loss: 92285.5488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91688.3249; train_chrom_access_recon_loss: 2565873.3030; train_global_loss: 17066821.6364; train_optim_loss: 17066821.6364; val_kl_reg_loss: 79478.8965; val_edge_recon_loss: 2748931.9062; val_gene_expr_recon_loss: 11572497.1250; val_masked_gp_l1_reg_loss: 92309.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91795.0156; val_chrom_access_recon_loss: 2541993.6562; val_global_loss: 17127006.5000; val_optim_loss: 17127006.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9552; val_auprc_score: 0.9359; val_best_acc_score: 0.9033; val_best_f1_score: 0.9077; train_kl_reg_loss: 80453.6999; train_edge_recon_loss: 2703448.9659; train_gene_expr_recon_loss: 11514698.8939; train_masked_gp_l1_reg_loss: 91271.6142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71881.5716; train_chrom_access_recon_loss: 2555738.9962; train_global_loss: 17017493.9091; train_optim_loss: 17017493.9091; val_kl_reg_loss: 81962.2705; val_edge_recon_loss: 2729636.4062; val_gene_expr_recon_loss: 11466422.1250; val_masked_gp_l1_reg_loss: 90804.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67358.5781; val_chrom_access_recon_loss: 2501939.8125; val_global_loss: 16938123.6250; val_optim_loss: 16938123.6250
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9528; val_auprc_score: 0.9332; val_best_acc_score: 0.8979; val_best_f1_score: 0.9015; train_kl_reg_loss: 81278.3797; train_edge_recon_loss: 2694056.5833; train_gene_expr_recon_loss: 11505847.3939; train_masked_gp_l1_reg_loss: 90715.1036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66901.0438; train_chrom_access_recon_loss: 2554215.3409; train_global_loss: 16993013.9848; train_optim_loss: 16993013.9848; val_kl_reg_loss: 81652.4521; val_edge_recon_loss: 2744762.5938; val_gene_expr_recon_loss: 11640115.5000; val_masked_gp_l1_reg_loss: 90656.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66598.7500; val_chrom_access_recon_loss: 2566422.1875; val_global_loss: 17190208.7500; val_optim_loss: 17190208.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9557; val_auprc_score: 0.9415; val_best_acc_score: 0.9017; val_best_f1_score: 0.9056; train_kl_reg_loss: 81868.0400; train_edge_recon_loss: 2693418.8750; train_gene_expr_recon_loss: 11513384.9091; train_masked_gp_l1_reg_loss: 90625.1052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66412.9499; train_chrom_access_recon_loss: 2555718.7879; train_global_loss: 17001428.5909; train_optim_loss: 17001428.5909; val_kl_reg_loss: 81856.7676; val_edge_recon_loss: 2734138.4375; val_gene_expr_recon_loss: 11441903.3750; val_masked_gp_l1_reg_loss: 90610.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66149.3516; val_chrom_access_recon_loss: 2511647.7812; val_global_loss: 16926306.2500; val_optim_loss: 16926306.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9534; val_auprc_score: 0.9348; val_best_acc_score: 0.9046; val_best_f1_score: 0.9086; train_kl_reg_loss: 82313.4729; train_edge_recon_loss: 2687802.2008; train_gene_expr_recon_loss: 11511160.2424; train_masked_gp_l1_reg_loss: 90585.9741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66034.0621; train_chrom_access_recon_loss: 2556222.4280; train_global_loss: 16994118.1061; train_optim_loss: 16994118.1061; val_kl_reg_loss: 82466.9932; val_edge_recon_loss: 2716031.0625; val_gene_expr_recon_loss: 11504927.7500; val_masked_gp_l1_reg_loss: 90562.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65870.1641; val_chrom_access_recon_loss: 2517208.5312; val_global_loss: 16977067.2500; val_optim_loss: 16977067.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9569; val_auprc_score: 0.9321; val_best_acc_score: 0.9076; val_best_f1_score: 0.9103; train_kl_reg_loss: 82421.1600; train_edge_recon_loss: 2697261.6250; train_gene_expr_recon_loss: 11515947.2121; train_masked_gp_l1_reg_loss: 90555.8164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65717.2437; train_chrom_access_recon_loss: 2557476.6970; train_global_loss: 17009379.7727; train_optim_loss: 17009379.7727; val_kl_reg_loss: 82953.2207; val_edge_recon_loss: 2710101.5938; val_gene_expr_recon_loss: 11427977.6250; val_masked_gp_l1_reg_loss: 90556.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65669.1562; val_chrom_access_recon_loss: 2496358.9062; val_global_loss: 16873616.3750; val_optim_loss: 16873616.3750
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9531; val_auprc_score: 0.9371; val_best_acc_score: 0.9011; val_best_f1_score: 0.9053; train_kl_reg_loss: 82569.5327; train_edge_recon_loss: 2693834.8977; train_gene_expr_recon_loss: 11501434.7273; train_masked_gp_l1_reg_loss: 90532.5554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65625.2576; train_chrom_access_recon_loss: 2554114.7311; train_global_loss: 16988111.6970; train_optim_loss: 16988111.6970; val_kl_reg_loss: 82939.7568; val_edge_recon_loss: 2710026.8125; val_gene_expr_recon_loss: 11577009.6250; val_masked_gp_l1_reg_loss: 90527.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65462.9531; val_chrom_access_recon_loss: 2518131.5312; val_global_loss: 17044098.8750; val_optim_loss: 17044098.8750
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9523; val_auprc_score: 0.9358; val_best_acc_score: 0.9011; val_best_f1_score: 0.9049; train_kl_reg_loss: 82669.4901; train_edge_recon_loss: 2693753.9735; train_gene_expr_recon_loss: 11501702.5909; train_masked_gp_l1_reg_loss: 90511.0993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65379.1670; train_chrom_access_recon_loss: 2550730.5568; train_global_loss: 16984746.8636; train_optim_loss: 16984746.8636; val_kl_reg_loss: 82277.0488; val_edge_recon_loss: 2719610.5938; val_gene_expr_recon_loss: 11635274.7500; val_masked_gp_l1_reg_loss: 90504.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65263.0469; val_chrom_access_recon_loss: 2566727.8750; val_global_loss: 17159657.0000; val_optim_loss: 17159657.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9551; val_auprc_score: 0.9396; val_best_acc_score: 0.9062; val_best_f1_score: 0.9101; train_kl_reg_loss: 82351.4032; train_edge_recon_loss: 2694884.7576; train_gene_expr_recon_loss: 11496867.6364; train_masked_gp_l1_reg_loss: 90497.2665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65213.7457; train_chrom_access_recon_loss: 2549282.2576; train_global_loss: 16979097.1364; train_optim_loss: 16979097.1364; val_kl_reg_loss: 82850.1650; val_edge_recon_loss: 2721432.6875; val_gene_expr_recon_loss: 11456530.2500; val_masked_gp_l1_reg_loss: 90487.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65140.2344; val_chrom_access_recon_loss: 2544832.7500; val_global_loss: 16961272.5000; val_optim_loss: 16961272.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9580; val_auprc_score: 0.9393; val_best_acc_score: 0.9100; val_best_f1_score: 0.9144; train_kl_reg_loss: 82769.5268; train_edge_recon_loss: 2690739.6970; train_gene_expr_recon_loss: 11493974.4091; train_masked_gp_l1_reg_loss: 90489.8216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65065.3391; train_chrom_access_recon_loss: 2548935.1818; train_global_loss: 16971974.0152; train_optim_loss: 16971974.0152; val_kl_reg_loss: 83509.5693; val_edge_recon_loss: 2680104.0312; val_gene_expr_recon_loss: 11471184.7500; val_masked_gp_l1_reg_loss: 90473.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64996.1719; val_chrom_access_recon_loss: 2507158.5625; val_global_loss: 16897426.8750; val_optim_loss: 16897426.8750

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9543; val_auprc_score: 0.9365; val_best_acc_score: 0.9068; val_best_f1_score: 0.9111; train_kl_reg_loss: 82985.4163; train_edge_recon_loss: 2694369.1818; train_gene_expr_recon_loss: 11495526.4697; train_masked_gp_l1_reg_loss: 90367.6641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63051.6777; train_chrom_access_recon_loss: 2551309.9848; train_global_loss: 16977610.3030; train_optim_loss: 16977610.3030; val_kl_reg_loss: 83452.9814; val_edge_recon_loss: 2704671.5625; val_gene_expr_recon_loss: 11492688.7500; val_masked_gp_l1_reg_loss: 90315.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62627.0547; val_chrom_access_recon_loss: 2518710.9688; val_global_loss: 16952467.2500; val_optim_loss: 16952467.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9521; val_auprc_score: 0.9342; val_best_acc_score: 0.9006; val_best_f1_score: 0.9055; train_kl_reg_loss: 82721.6123; train_edge_recon_loss: 2693439.7197; train_gene_expr_recon_loss: 11491478.7424; train_masked_gp_l1_reg_loss: 90301.7785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62564.7464; train_chrom_access_recon_loss: 2550021.3258; train_global_loss: 16970527.9545; train_optim_loss: 16970527.9545; val_kl_reg_loss: 83026.5176; val_edge_recon_loss: 2731679.4062; val_gene_expr_recon_loss: 11531935.8750; val_masked_gp_l1_reg_loss: 90291.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62523.7188; val_chrom_access_recon_loss: 2538374.6875; val_global_loss: 17037832.2500; val_optim_loss: 17037832.2500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9484; val_auprc_score: 0.9291; val_best_acc_score: 0.8960; val_best_f1_score: 0.9014; train_kl_reg_loss: 82769.6201; train_edge_recon_loss: 2698778.0152; train_gene_expr_recon_loss: 11493176.9848; train_masked_gp_l1_reg_loss: 90286.1464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62492.9901; train_chrom_access_recon_loss: 2548548.2083; train_global_loss: 16976051.9848; train_optim_loss: 16976051.9848; val_kl_reg_loss: 83498.8945; val_edge_recon_loss: 2737848.7188; val_gene_expr_recon_loss: 11477264.0000; val_masked_gp_l1_reg_loss: 90281.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62462.5234; val_chrom_access_recon_loss: 2510233.8125; val_global_loss: 16961590.6250; val_optim_loss: 16961590.6250
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9497; val_auprc_score: 0.9276; val_best_acc_score: 0.8971; val_best_f1_score: 0.9026; train_kl_reg_loss: 82659.2603; train_edge_recon_loss: 2691744.0758; train_gene_expr_recon_loss: 11497840.9697; train_masked_gp_l1_reg_loss: 90278.6662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62436.3971; train_chrom_access_recon_loss: 2548782.7121; train_global_loss: 16973742.1515; train_optim_loss: 16973742.1515; val_kl_reg_loss: 83324.7490; val_edge_recon_loss: 2731966.8750; val_gene_expr_recon_loss: 11601652.2500; val_masked_gp_l1_reg_loss: 90274.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62414.0781; val_chrom_access_recon_loss: 2546064.0625; val_global_loss: 17115697.1250; val_optim_loss: 17115697.1250

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 57 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9525
val AUPRC score: 0.9321
val best accuracy score: 0.9038
val best F1 score: 0.9069
val target rna MSE score: 1.1932
val source rna MSE score: 0.6640
val target atac MSE score: 0.4581
val source atac MSE score: 0.1893
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
