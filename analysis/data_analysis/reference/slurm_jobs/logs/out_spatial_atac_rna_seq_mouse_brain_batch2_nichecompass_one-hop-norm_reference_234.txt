[True]
Run timestamp: 10102023_103419_234.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_234']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7612; val_auprc_score: 0.7868; val_best_acc_score: 0.5181; val_best_f1_score: 0.6735; train_kl_reg_loss: 56866.0385; train_edge_recon_loss: 735716.0854; train_gene_expr_recon_loss: 22103925.2824; train_masked_gp_l1_reg_loss: 130707.9170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3329840.8321; train_chrom_access_recon_loss: 2856318.1985; train_global_loss: 29213374.2443; train_optim_loss: 29213374.2443; val_kl_reg_loss: 87684.0427; val_edge_recon_loss: 812835.8167; val_gene_expr_recon_loss: 21304134.9333; val_masked_gp_l1_reg_loss: 108080.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 837503.5625; val_chrom_access_recon_loss: 2811980.3833; val_global_loss: 25962219.2000; val_optim_loss: 25962219.2000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8595; val_auprc_score: 0.8707; val_best_acc_score: 0.6702; val_best_f1_score: 0.7423; train_kl_reg_loss: 71463.1433; train_edge_recon_loss: 733314.7600; train_gene_expr_recon_loss: 20890563.6489; train_masked_gp_l1_reg_loss: 102652.4948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 430246.9505; train_chrom_access_recon_loss: 2744928.1126; train_global_loss: 24973169.1756; train_optim_loss: 24973169.1756; val_kl_reg_loss: 70954.8562; val_edge_recon_loss: 810327.1500; val_gene_expr_recon_loss: 21072695.8667; val_masked_gp_l1_reg_loss: 101331.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 236335.5469; val_chrom_access_recon_loss: 2786629.7833; val_global_loss: 25078275.2000; val_optim_loss: 25078275.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9001; val_auprc_score: 0.8972; val_best_acc_score: 0.7930; val_best_f1_score: 0.8072; train_kl_reg_loss: 62968.0281; train_edge_recon_loss: 724562.6159; train_gene_expr_recon_loss: 20601178.8092; train_masked_gp_l1_reg_loss: 102334.5174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176856.2524; train_chrom_access_recon_loss: 2713758.9351; train_global_loss: 24381659.1756; train_optim_loss: 24381659.1756; val_kl_reg_loss: 65894.8201; val_edge_recon_loss: 782730.5000; val_gene_expr_recon_loss: 20792316.8000; val_masked_gp_l1_reg_loss: 104400.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140092.3281; val_chrom_access_recon_loss: 2754636.6000; val_global_loss: 24640070.8000; val_optim_loss: 24640070.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9021; val_auprc_score: 0.8900; val_best_acc_score: 0.8151; val_best_f1_score: 0.8244; train_kl_reg_loss: 61998.3409; train_edge_recon_loss: 684459.9633; train_gene_expr_recon_loss: 20387647.4351; train_masked_gp_l1_reg_loss: 106233.9631; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130383.7544; train_chrom_access_recon_loss: 2691001.9828; train_global_loss: 24061725.3740; train_optim_loss: 24061725.3740; val_kl_reg_loss: 70435.9052; val_edge_recon_loss: 645381.6083; val_gene_expr_recon_loss: 20544033.6000; val_masked_gp_l1_reg_loss: 108551.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128582.0156; val_chrom_access_recon_loss: 2718691.5167; val_global_loss: 24215676.8000; val_optim_loss: 24215676.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9162; val_auprc_score: 0.9068; val_best_acc_score: 0.8345; val_best_f1_score: 0.8425; train_kl_reg_loss: 72442.2583; train_edge_recon_loss: 629751.2156; train_gene_expr_recon_loss: 20159019.2061; train_masked_gp_l1_reg_loss: 109713.9812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119257.8217; train_chrom_access_recon_loss: 2665849.4752; train_global_loss: 23756033.9542; train_optim_loss: 23756033.9542; val_kl_reg_loss: 72371.2740; val_edge_recon_loss: 624066.9292; val_gene_expr_recon_loss: 20395081.2000; val_masked_gp_l1_reg_loss: 111031.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112555.6328; val_chrom_access_recon_loss: 2711415.1500; val_global_loss: 24026522.5333; val_optim_loss: 24026522.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9183; val_auprc_score: 0.9048; val_best_acc_score: 0.8417; val_best_f1_score: 0.8515; train_kl_reg_loss: 71494.5771; train_edge_recon_loss: 618902.8678; train_gene_expr_recon_loss: 20000324.9618; train_masked_gp_l1_reg_loss: 112040.9801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106376.5817; train_chrom_access_recon_loss: 2647732.1603; train_global_loss: 23556871.9542; train_optim_loss: 23556871.9542; val_kl_reg_loss: 70743.8292; val_edge_recon_loss: 616647.7542; val_gene_expr_recon_loss: 20188544.6667; val_masked_gp_l1_reg_loss: 113138.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102379.6250; val_chrom_access_recon_loss: 2689107.7833; val_global_loss: 23780562.0000; val_optim_loss: 23780562.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9228; val_auprc_score: 0.9055; val_best_acc_score: 0.8471; val_best_f1_score: 0.8537; train_kl_reg_loss: 70906.4947; train_edge_recon_loss: 611251.8330; train_gene_expr_recon_loss: 19875939.5115; train_masked_gp_l1_reg_loss: 114161.5376; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97749.2994; train_chrom_access_recon_loss: 2632227.7844; train_global_loss: 23402236.5038; train_optim_loss: 23402236.5038; val_kl_reg_loss: 69021.1656; val_edge_recon_loss: 613748.2625; val_gene_expr_recon_loss: 20030773.0667; val_masked_gp_l1_reg_loss: 114922.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95238.8906; val_chrom_access_recon_loss: 2663126.2667; val_global_loss: 23586828.9333; val_optim_loss: 23586828.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9312; val_auprc_score: 0.9200; val_best_acc_score: 0.8596; val_best_f1_score: 0.8664; train_kl_reg_loss: 70670.7993; train_edge_recon_loss: 606332.2438; train_gene_expr_recon_loss: 19741427.9847; train_masked_gp_l1_reg_loss: 115385.2963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92142.9479; train_chrom_access_recon_loss: 2612287.7156; train_global_loss: 23238247.1145; train_optim_loss: 23238247.1145; val_kl_reg_loss: 68665.5443; val_edge_recon_loss: 611073.8500; val_gene_expr_recon_loss: 19915350.4000; val_masked_gp_l1_reg_loss: 116254.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91165.5391; val_chrom_access_recon_loss: 2642965.2333; val_global_loss: 23445474.8000; val_optim_loss: 23445474.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9388; val_auprc_score: 0.9261; val_best_acc_score: 0.8694; val_best_f1_score: 0.8765; train_kl_reg_loss: 69161.9686; train_edge_recon_loss: 604938.7958; train_gene_expr_recon_loss: 19631184.5191; train_masked_gp_l1_reg_loss: 116464.7362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88469.2560; train_chrom_access_recon_loss: 2597637.0172; train_global_loss: 23107856.3664; train_optim_loss: 23107856.3664; val_kl_reg_loss: 70221.1333; val_edge_recon_loss: 601816.8542; val_gene_expr_recon_loss: 19835333.8667; val_masked_gp_l1_reg_loss: 117481.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88089.4531; val_chrom_access_recon_loss: 2631186.8833; val_global_loss: 23344130.8000; val_optim_loss: 23344130.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9414; val_auprc_score: 0.9298; val_best_acc_score: 0.8775; val_best_f1_score: 0.8838; train_kl_reg_loss: 68747.6624; train_edge_recon_loss: 600584.5787; train_gene_expr_recon_loss: 19522931.4962; train_masked_gp_l1_reg_loss: 117546.7508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86907.9608; train_chrom_access_recon_loss: 2582191.8779; train_global_loss: 22978910.3206; train_optim_loss: 22978910.3206; val_kl_reg_loss: 68782.8797; val_edge_recon_loss: 597619.9625; val_gene_expr_recon_loss: 19755687.8667; val_masked_gp_l1_reg_loss: 118222.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87254.7188; val_chrom_access_recon_loss: 2624712.5833; val_global_loss: 23252279.0667; val_optim_loss: 23252279.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9458; val_auprc_score: 0.9354; val_best_acc_score: 0.8782; val_best_f1_score: 0.8834; train_kl_reg_loss: 68366.6068; train_edge_recon_loss: 597959.7171; train_gene_expr_recon_loss: 19433242.2748; train_masked_gp_l1_reg_loss: 118188.6541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88176.7687; train_chrom_access_recon_loss: 2572186.0153; train_global_loss: 22878119.9695; train_optim_loss: 22878119.9695; val_kl_reg_loss: 69113.3542; val_edge_recon_loss: 599570.6708; val_gene_expr_recon_loss: 19630986.8000; val_masked_gp_l1_reg_loss: 118752.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89449.0078; val_chrom_access_recon_loss: 2616826.4667; val_global_loss: 23124699.6000; val_optim_loss: 23124699.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9483; val_auprc_score: 0.9375; val_best_acc_score: 0.8859; val_best_f1_score: 0.8915; train_kl_reg_loss: 67666.6571; train_edge_recon_loss: 597742.1517; train_gene_expr_recon_loss: 19345063.5573; train_masked_gp_l1_reg_loss: 119074.3389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89349.5873; train_chrom_access_recon_loss: 2560032.1698; train_global_loss: 22778928.6107; train_optim_loss: 22778928.6107; val_kl_reg_loss: 65741.9193; val_edge_recon_loss: 596334.5250; val_gene_expr_recon_loss: 19562900.9333; val_masked_gp_l1_reg_loss: 119333.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89143.5781; val_chrom_access_recon_loss: 2594407.4500; val_global_loss: 23027862.9333; val_optim_loss: 23027862.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9523; val_auprc_score: 0.9375; val_best_acc_score: 0.8933; val_best_f1_score: 0.8972; train_kl_reg_loss: 67345.2853; train_edge_recon_loss: 594321.5014; train_gene_expr_recon_loss: 19275078.7328; train_masked_gp_l1_reg_loss: 119722.7169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88388.9543; train_chrom_access_recon_loss: 2551396.5973; train_global_loss: 22696253.7710; train_optim_loss: 22696253.7710; val_kl_reg_loss: 65526.5714; val_edge_recon_loss: 593949.8708; val_gene_expr_recon_loss: 19466807.8667; val_masked_gp_l1_reg_loss: 120402.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88807.2344; val_chrom_access_recon_loss: 2585774.0167; val_global_loss: 22921268.4000; val_optim_loss: 22921268.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9548; val_auprc_score: 0.9393; val_best_acc_score: 0.8976; val_best_f1_score: 0.9001; train_kl_reg_loss: 66773.1882; train_edge_recon_loss: 593204.6584; train_gene_expr_recon_loss: 19183137.3740; train_masked_gp_l1_reg_loss: 120952.7921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87424.0843; train_chrom_access_recon_loss: 2538445.3817; train_global_loss: 22589937.4351; train_optim_loss: 22589937.4351; val_kl_reg_loss: 68348.3740; val_edge_recon_loss: 593618.9708; val_gene_expr_recon_loss: 19439782.2667; val_masked_gp_l1_reg_loss: 121533.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87718.7188; val_chrom_access_recon_loss: 2586824.8667; val_global_loss: 22897826.2667; val_optim_loss: 22897826.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9540; val_auprc_score: 0.9413; val_best_acc_score: 0.8968; val_best_f1_score: 0.9014; train_kl_reg_loss: 66348.5884; train_edge_recon_loss: 591416.9132; train_gene_expr_recon_loss: 19121454.6260; train_masked_gp_l1_reg_loss: 121975.0215; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86834.4957; train_chrom_access_recon_loss: 2529515.3588; train_global_loss: 22517544.8855; train_optim_loss: 22517544.8855; val_kl_reg_loss: 66737.9034; val_edge_recon_loss: 595209.5458; val_gene_expr_recon_loss: 19453995.7333; val_masked_gp_l1_reg_loss: 122543.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85991.4219; val_chrom_access_recon_loss: 2588440.2833; val_global_loss: 22912919.7333; val_optim_loss: 22912919.7333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9544; val_auprc_score: 0.9397; val_best_acc_score: 0.8981; val_best_f1_score: 0.9042; train_kl_reg_loss: 65999.5371; train_edge_recon_loss: 588667.1102; train_gene_expr_recon_loss: 19032265.2977; train_masked_gp_l1_reg_loss: 123382.2733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86293.5848; train_chrom_access_recon_loss: 2517988.5840; train_global_loss: 22414596.2901; train_optim_loss: 22414596.2901; val_kl_reg_loss: 65072.4992; val_edge_recon_loss: 594274.4750; val_gene_expr_recon_loss: 19229933.7333; val_masked_gp_l1_reg_loss: 124081.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86170.5781; val_chrom_access_recon_loss: 2556347.1167; val_global_loss: 22655879.8667; val_optim_loss: 22655879.8667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9589; val_auprc_score: 0.9474; val_best_acc_score: 0.9039; val_best_f1_score: 0.9080; train_kl_reg_loss: 65206.4743; train_edge_recon_loss: 589769.9031; train_gene_expr_recon_loss: 18977453.6183; train_masked_gp_l1_reg_loss: 125114.7267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86497.9575; train_chrom_access_recon_loss: 2508747.3206; train_global_loss: 22352789.8779; train_optim_loss: 22352789.8779; val_kl_reg_loss: 64531.2688; val_edge_recon_loss: 589316.0792; val_gene_expr_recon_loss: 19300098.6667; val_masked_gp_l1_reg_loss: 125849.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86130.9844; val_chrom_access_recon_loss: 2563948.0500; val_global_loss: 22729873.7333; val_optim_loss: 22729873.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9584; val_auprc_score: 0.9464; val_best_acc_score: 0.9010; val_best_f1_score: 0.9054; train_kl_reg_loss: 64588.2495; train_edge_recon_loss: 588461.9704; train_gene_expr_recon_loss: 18906976.1221; train_masked_gp_l1_reg_loss: 126717.8638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86328.9238; train_chrom_access_recon_loss: 2499625.3989; train_global_loss: 22272698.5038; train_optim_loss: 22272698.5038; val_kl_reg_loss: 65046.4026; val_edge_recon_loss: 589819.1708; val_gene_expr_recon_loss: 19182619.4667; val_masked_gp_l1_reg_loss: 127898.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87146.4844; val_chrom_access_recon_loss: 2552706.1000; val_global_loss: 22605235.0667; val_optim_loss: 22605235.0667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9596; val_auprc_score: 0.9476; val_best_acc_score: 0.9039; val_best_f1_score: 0.9074; train_kl_reg_loss: 63875.3738; train_edge_recon_loss: 588475.6546; train_gene_expr_recon_loss: 18814266.7939; train_masked_gp_l1_reg_loss: 128915.0594; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86658.0722; train_chrom_access_recon_loss: 2491112.9313; train_global_loss: 22173303.9542; train_optim_loss: 22173303.9542; val_kl_reg_loss: 63759.3036; val_edge_recon_loss: 588268.4458; val_gene_expr_recon_loss: 19140061.2000; val_masked_gp_l1_reg_loss: 129984.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86977.4219; val_chrom_access_recon_loss: 2531046.4667; val_global_loss: 22540097.2000; val_optim_loss: 22540097.2000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9600; val_auprc_score: 0.9486; val_best_acc_score: 0.9076; val_best_f1_score: 0.9115; train_kl_reg_loss: 63867.2911; train_edge_recon_loss: 585934.8445; train_gene_expr_recon_loss: 18755675.6183; train_masked_gp_l1_reg_loss: 130998.3313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86780.2227; train_chrom_access_recon_loss: 2483280.0897; train_global_loss: 22106536.3664; train_optim_loss: 22106536.3664; val_kl_reg_loss: 63588.8398; val_edge_recon_loss: 588018.8708; val_gene_expr_recon_loss: 19093756.1333; val_masked_gp_l1_reg_loss: 131972.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87073.3047; val_chrom_access_recon_loss: 2525273.2167; val_global_loss: 22489683.0667; val_optim_loss: 22489683.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9627; val_auprc_score: 0.9529; val_best_acc_score: 0.9073; val_best_f1_score: 0.9106; train_kl_reg_loss: 63337.6601; train_edge_recon_loss: 585795.8631; train_gene_expr_recon_loss: 18689785.5725; train_masked_gp_l1_reg_loss: 132976.1765; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86495.2895; train_chrom_access_recon_loss: 2473107.1202; train_global_loss: 22031497.4809; train_optim_loss: 22031497.4809; val_kl_reg_loss: 61893.3812; val_edge_recon_loss: 585240.6167; val_gene_expr_recon_loss: 18999664.1333; val_masked_gp_l1_reg_loss: 134073.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87438.6016; val_chrom_access_recon_loss: 2523497.3000; val_global_loss: 22391807.4667; val_optim_loss: 22391807.4667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9625; val_auprc_score: 0.9460; val_best_acc_score: 0.9101; val_best_f1_score: 0.9134; train_kl_reg_loss: 63104.3894; train_edge_recon_loss: 585680.2882; train_gene_expr_recon_loss: 18611105.9542; train_masked_gp_l1_reg_loss: 134965.1871; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86787.7626; train_chrom_access_recon_loss: 2461145.2958; train_global_loss: 21942788.7939; train_optim_loss: 21942788.7939; val_kl_reg_loss: 61913.8492; val_edge_recon_loss: 585589.8750; val_gene_expr_recon_loss: 18986152.0000; val_masked_gp_l1_reg_loss: 135836.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87976.6484; val_chrom_access_recon_loss: 2520252.5833; val_global_loss: 22377720.6667; val_optim_loss: 22377720.6667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9630; val_auprc_score: 0.9514; val_best_acc_score: 0.9104; val_best_f1_score: 0.9152; train_kl_reg_loss: 63274.0670; train_edge_recon_loss: 584015.6279; train_gene_expr_recon_loss: 18540773.1908; train_masked_gp_l1_reg_loss: 136696.7244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86573.9353; train_chrom_access_recon_loss: 2451179.6622; train_global_loss: 21862513.1298; train_optim_loss: 21862513.1298; val_kl_reg_loss: 61919.3138; val_edge_recon_loss: 587920.8042; val_gene_expr_recon_loss: 18896424.6667; val_masked_gp_l1_reg_loss: 137398.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86754.7031; val_chrom_access_recon_loss: 2511830.8333; val_global_loss: 22282247.6000; val_optim_loss: 22282247.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9606; val_auprc_score: 0.9499; val_best_acc_score: 0.9095; val_best_f1_score: 0.9123; train_kl_reg_loss: 63407.0451; train_edge_recon_loss: 583530.3831; train_gene_expr_recon_loss: 18482104.3817; train_masked_gp_l1_reg_loss: 137880.5825; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86350.7288; train_chrom_access_recon_loss: 2447114.6450; train_global_loss: 21800387.7405; train_optim_loss: 21800387.7405; val_kl_reg_loss: 64446.9313; val_edge_recon_loss: 590124.1833; val_gene_expr_recon_loss: 18804924.2667; val_masked_gp_l1_reg_loss: 139074.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87009.6953; val_chrom_access_recon_loss: 2498653.1833; val_global_loss: 22184232.8000; val_optim_loss: 22184232.8000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9617; val_auprc_score: 0.9505; val_best_acc_score: 0.9062; val_best_f1_score: 0.9092; train_kl_reg_loss: 63523.8465; train_edge_recon_loss: 583825.8430; train_gene_expr_recon_loss: 18423557.4198; train_masked_gp_l1_reg_loss: 139039.5865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86265.5103; train_chrom_access_recon_loss: 2436994.8340; train_global_loss: 21733207.0076; train_optim_loss: 21733207.0076; val_kl_reg_loss: 63938.8177; val_edge_recon_loss: 587450.6833; val_gene_expr_recon_loss: 18788476.4000; val_masked_gp_l1_reg_loss: 139524.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87468.9609; val_chrom_access_recon_loss: 2502238.9833; val_global_loss: 22169096.9333; val_optim_loss: 22169096.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9593; val_auprc_score: 0.9454; val_best_acc_score: 0.9134; val_best_f1_score: 0.9161; train_kl_reg_loss: 63628.2202; train_edge_recon_loss: 584208.4327; train_gene_expr_recon_loss: 18379408.1603; train_masked_gp_l1_reg_loss: 139669.5682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86458.1783; train_chrom_access_recon_loss: 2431257.4542; train_global_loss: 21684630.0153; train_optim_loss: 21684630.0153; val_kl_reg_loss: 64194.7438; val_edge_recon_loss: 583715.4708; val_gene_expr_recon_loss: 18758222.4000; val_masked_gp_l1_reg_loss: 140171.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87986.8438; val_chrom_access_recon_loss: 2495116.2000; val_global_loss: 22129406.9333; val_optim_loss: 22129406.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9596; val_auprc_score: 0.9480; val_best_acc_score: 0.9061; val_best_f1_score: 0.9095; train_kl_reg_loss: 64514.8544; train_edge_recon_loss: 583462.1560; train_gene_expr_recon_loss: 18320100.7099; train_masked_gp_l1_reg_loss: 140095.8709; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86361.1308; train_chrom_access_recon_loss: 2420030.0935; train_global_loss: 21614564.8397; train_optim_loss: 21614564.8397; val_kl_reg_loss: 65388.0008; val_edge_recon_loss: 589875.7833; val_gene_expr_recon_loss: 18755617.0667; val_masked_gp_l1_reg_loss: 140062.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86247.5703; val_chrom_access_recon_loss: 2499529.5167; val_global_loss: 22136720.4000; val_optim_loss: 22136720.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9604; val_auprc_score: 0.9505; val_best_acc_score: 0.9080; val_best_f1_score: 0.9129; train_kl_reg_loss: 64506.9051; train_edge_recon_loss: 584867.9461; train_gene_expr_recon_loss: 18262611.0687; train_masked_gp_l1_reg_loss: 140389.2405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86070.7333; train_chrom_access_recon_loss: 2409913.8092; train_global_loss: 21548359.7252; train_optim_loss: 21548359.7252; val_kl_reg_loss: 64838.9951; val_edge_recon_loss: 587206.3500; val_gene_expr_recon_loss: 18717263.8667; val_masked_gp_l1_reg_loss: 140750.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86338.6250; val_chrom_access_recon_loss: 2476065.9167; val_global_loss: 22072463.4667; val_optim_loss: 22072463.4667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9611; val_auprc_score: 0.9499; val_best_acc_score: 0.9045; val_best_f1_score: 0.9077; train_kl_reg_loss: 64649.4030; train_edge_recon_loss: 584769.6908; train_gene_expr_recon_loss: 18209563.7252; train_masked_gp_l1_reg_loss: 141112.4286; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86367.1694; train_chrom_access_recon_loss: 2401936.6870; train_global_loss: 21488399.0382; train_optim_loss: 21488399.0382; val_kl_reg_loss: 64145.4146; val_edge_recon_loss: 591219.2208; val_gene_expr_recon_loss: 18614956.4000; val_masked_gp_l1_reg_loss: 141264.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86636.2344; val_chrom_access_recon_loss: 2482603.0833; val_global_loss: 21980824.5333; val_optim_loss: 21980824.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9599; val_auprc_score: 0.9459; val_best_acc_score: 0.9058; val_best_f1_score: 0.9099; train_kl_reg_loss: 64728.2968; train_edge_recon_loss: 585004.2653; train_gene_expr_recon_loss: 18158862.4885; train_masked_gp_l1_reg_loss: 141690.8021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86648.5652; train_chrom_access_recon_loss: 2392684.2347; train_global_loss: 21429618.6718; train_optim_loss: 21429618.6718; val_kl_reg_loss: 65230.0716; val_edge_recon_loss: 590077.7167; val_gene_expr_recon_loss: 18587005.3333; val_masked_gp_l1_reg_loss: 141853.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86972.8281; val_chrom_access_recon_loss: 2466209.9500; val_global_loss: 21937349.3333; val_optim_loss: 21937349.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9641; val_auprc_score: 0.9527; val_best_acc_score: 0.9116; val_best_f1_score: 0.9152; train_kl_reg_loss: 65174.4447; train_edge_recon_loss: 585847.3168; train_gene_expr_recon_loss: 18120211.5878; train_masked_gp_l1_reg_loss: 141891.2750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86846.8326; train_chrom_access_recon_loss: 2386229.3626; train_global_loss: 21386200.7939; train_optim_loss: 21386200.7939; val_kl_reg_loss: 65535.0951; val_edge_recon_loss: 589408.4375; val_gene_expr_recon_loss: 18532388.5333; val_masked_gp_l1_reg_loss: 142036.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86651.2734; val_chrom_access_recon_loss: 2467613.1500; val_global_loss: 21883633.0667; val_optim_loss: 21883633.0667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9604; val_auprc_score: 0.9491; val_best_acc_score: 0.9049; val_best_f1_score: 0.9087; train_kl_reg_loss: 65753.9398; train_edge_recon_loss: 584712.6827; train_gene_expr_recon_loss: 18073413.3740; train_masked_gp_l1_reg_loss: 142214.5254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86879.8092; train_chrom_access_recon_loss: 2378554.7863; train_global_loss: 21331529.1450; train_optim_loss: 21331529.1450; val_kl_reg_loss: 66516.1805; val_edge_recon_loss: 591015.9167; val_gene_expr_recon_loss: 18515235.6000; val_masked_gp_l1_reg_loss: 142666.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87754.0156; val_chrom_access_recon_loss: 2468564.1833; val_global_loss: 21871752.0000; val_optim_loss: 21871752.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9619; val_auprc_score: 0.9495; val_best_acc_score: 0.9095; val_best_f1_score: 0.9132; train_kl_reg_loss: 66352.5771; train_edge_recon_loss: 585038.6713; train_gene_expr_recon_loss: 18050730.9160; train_masked_gp_l1_reg_loss: 142611.3053; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87303.6976; train_chrom_access_recon_loss: 2372266.6355; train_global_loss: 21304303.6794; train_optim_loss: 21304303.6794; val_kl_reg_loss: 65973.8443; val_edge_recon_loss: 587358.2292; val_gene_expr_recon_loss: 18479970.1333; val_masked_gp_l1_reg_loss: 142482.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87825.0234; val_chrom_access_recon_loss: 2480748.7500; val_global_loss: 21844358.8000; val_optim_loss: 21844358.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9641; val_auprc_score: 0.9524; val_best_acc_score: 0.9140; val_best_f1_score: 0.9169; train_kl_reg_loss: 66525.5233; train_edge_recon_loss: 586484.0439; train_gene_expr_recon_loss: 18010294.0000; train_masked_gp_l1_reg_loss: 142601.3250; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87384.5037; train_chrom_access_recon_loss: 2364471.2347; train_global_loss: 21257760.6718; train_optim_loss: 21257760.6718; val_kl_reg_loss: 66949.2323; val_edge_recon_loss: 588873.5875; val_gene_expr_recon_loss: 18507542.8000; val_masked_gp_l1_reg_loss: 143036.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88395.6953; val_chrom_access_recon_loss: 2461590.2833; val_global_loss: 21856387.8667; val_optim_loss: 21856387.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9640; val_auprc_score: 0.9527; val_best_acc_score: 0.9105; val_best_f1_score: 0.9136; train_kl_reg_loss: 66953.1159; train_edge_recon_loss: 586824.1231; train_gene_expr_recon_loss: 17964645.4504; train_masked_gp_l1_reg_loss: 142936.2743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87637.7114; train_chrom_access_recon_loss: 2356655.1660; train_global_loss: 21205652.0000; train_optim_loss: 21205652.0000; val_kl_reg_loss: 67425.8781; val_edge_recon_loss: 593074.8750; val_gene_expr_recon_loss: 18515994.6667; val_masked_gp_l1_reg_loss: 143070.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88354.8281; val_chrom_access_recon_loss: 2464671.8000; val_global_loss: 21872591.2000; val_optim_loss: 21872591.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9603; val_auprc_score: 0.9466; val_best_acc_score: 0.9070; val_best_f1_score: 0.9111; train_kl_reg_loss: 67416.9087; train_edge_recon_loss: 586850.1741; train_gene_expr_recon_loss: 17958367.4962; train_masked_gp_l1_reg_loss: 143158.2510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88111.6868; train_chrom_access_recon_loss: 2354088.7443; train_global_loss: 21197993.3435; train_optim_loss: 21197993.3435; val_kl_reg_loss: 68157.5526; val_edge_recon_loss: 594323.3750; val_gene_expr_recon_loss: 18504978.5333; val_masked_gp_l1_reg_loss: 143216.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88381.4609; val_chrom_access_recon_loss: 2465898.2833; val_global_loss: 21864956.0000; val_optim_loss: 21864956.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9613; val_auprc_score: 0.9473; val_best_acc_score: 0.9103; val_best_f1_score: 0.9133; train_kl_reg_loss: 68148.0197; train_edge_recon_loss: 585991.6527; train_gene_expr_recon_loss: 17910048.1603; train_masked_gp_l1_reg_loss: 142900.7737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88540.7905; train_chrom_access_recon_loss: 2343270.6908; train_global_loss: 21138900.0305; train_optim_loss: 21138900.0305; val_kl_reg_loss: 68660.2526; val_edge_recon_loss: 592185.4875; val_gene_expr_recon_loss: 18487725.6000; val_masked_gp_l1_reg_loss: 143162.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88597.6953; val_chrom_access_recon_loss: 2461997.3167; val_global_loss: 21842328.8000; val_optim_loss: 21842328.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9633; val_auprc_score: 0.9470; val_best_acc_score: 0.9130; val_best_f1_score: 0.9165; train_kl_reg_loss: 68852.1472; train_edge_recon_loss: 585302.5759; train_gene_expr_recon_loss: 17899544.1145; train_masked_gp_l1_reg_loss: 143049.2309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88716.1313; train_chrom_access_recon_loss: 2339809.6088; train_global_loss: 21125273.8321; train_optim_loss: 21125273.8321; val_kl_reg_loss: 70049.9036; val_edge_recon_loss: 587675.3792; val_gene_expr_recon_loss: 18459870.8000; val_masked_gp_l1_reg_loss: 143234.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90139.0469; val_chrom_access_recon_loss: 2463421.9500; val_global_loss: 21814391.7333; val_optim_loss: 21814391.7333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9631; val_auprc_score: 0.9533; val_best_acc_score: 0.9082; val_best_f1_score: 0.9124; train_kl_reg_loss: 69994.1133; train_edge_recon_loss: 587160.8822; train_gene_expr_recon_loss: 17926519.7252; train_masked_gp_l1_reg_loss: 143923.4827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89653.0613; train_chrom_access_recon_loss: 2347646.4447; train_global_loss: 21164897.7710; train_optim_loss: 21164897.7710; val_kl_reg_loss: 69870.4120; val_edge_recon_loss: 592862.8958; val_gene_expr_recon_loss: 18474310.6667; val_masked_gp_l1_reg_loss: 142263.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90405.8516; val_chrom_access_recon_loss: 2472248.2500; val_global_loss: 21841962.1333; val_optim_loss: 21841962.1333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8740; val_auprc_score: 0.8782; val_best_acc_score: 0.7855; val_best_f1_score: 0.7895; train_kl_reg_loss: 301948.3781; train_edge_recon_loss: 700253.0711; train_gene_expr_recon_loss: 20850695.4962; train_masked_gp_l1_reg_loss: 255612.6019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116283.6338; train_chrom_access_recon_loss: 2836476.6851; train_global_loss: 25061269.9084; train_optim_loss: 25061269.9084; val_kl_reg_loss: 104695.1109; val_edge_recon_loss: 775364.9042; val_gene_expr_recon_loss: 20579531.0667; val_masked_gp_l1_reg_loss: 382824.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118510.9844; val_chrom_access_recon_loss: 2760892.2500; val_global_loss: 24721817.4667; val_optim_loss: 24721817.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9044; val_auprc_score: 0.8984; val_best_acc_score: 0.8246; val_best_f1_score: 0.8337; train_kl_reg_loss: 87181.2685; train_edge_recon_loss: 726981.1073; train_gene_expr_recon_loss: 20027520.6260; train_masked_gp_l1_reg_loss: 326331.7884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105569.3635; train_chrom_access_recon_loss: 2649649.3626; train_global_loss: 23923233.4198; train_optim_loss: 23923233.4198; val_kl_reg_loss: 74731.4604; val_edge_recon_loss: 713950.7250; val_gene_expr_recon_loss: 20039572.0000; val_masked_gp_l1_reg_loss: 291887.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97218.3125; val_chrom_access_recon_loss: 2641969.1500; val_global_loss: 23859329.3333; val_optim_loss: 23859329.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9070; val_auprc_score: 0.9040; val_best_acc_score: 0.8282; val_best_f1_score: 0.8349; train_kl_reg_loss: 71808.3705; train_edge_recon_loss: 694227.0549; train_gene_expr_recon_loss: 19692789.9695; train_masked_gp_l1_reg_loss: 284763.4735; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96009.1054; train_chrom_access_recon_loss: 2599793.3015; train_global_loss: 23439391.1450; train_optim_loss: 23439391.1450; val_kl_reg_loss: 56818.9229; val_edge_recon_loss: 676520.1542; val_gene_expr_recon_loss: 19896491.7333; val_masked_gp_l1_reg_loss: 273549.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93343.0547; val_chrom_access_recon_loss: 2606254.5000; val_global_loss: 23602979.0667; val_optim_loss: 23602979.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9159; val_auprc_score: 0.9094; val_best_acc_score: 0.8380; val_best_f1_score: 0.8437; train_kl_reg_loss: 54914.9292; train_edge_recon_loss: 662927.2796; train_gene_expr_recon_loss: 19437625.9695; train_masked_gp_l1_reg_loss: 268081.3879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72549.7070; train_chrom_access_recon_loss: 2509907.4218; train_global_loss: 23006006.6565; train_optim_loss: 23006006.6565; val_kl_reg_loss: 53412.2237; val_edge_recon_loss: 667982.3833; val_gene_expr_recon_loss: 19617324.5333; val_masked_gp_l1_reg_loss: 265558.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69425.1562; val_chrom_access_recon_loss: 2537869.2333; val_global_loss: 23211572.4000; val_optim_loss: 23211572.4000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9130; val_auprc_score: 0.9047; val_best_acc_score: 0.8331; val_best_f1_score: 0.8418; train_kl_reg_loss: 52299.8479; train_edge_recon_loss: 657655.6832; train_gene_expr_recon_loss: 19241142.7634; train_masked_gp_l1_reg_loss: 264351.2168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68791.3152; train_chrom_access_recon_loss: 2484524.2061; train_global_loss: 22768765.0229; train_optim_loss: 22768765.0229; val_kl_reg_loss: 52600.1195; val_edge_recon_loss: 665878.9792; val_gene_expr_recon_loss: 19505071.2000; val_masked_gp_l1_reg_loss: 263199.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68267.7812; val_chrom_access_recon_loss: 2534313.8500; val_global_loss: 23089332.0000; val_optim_loss: 23089332.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9210; val_auprc_score: 0.9061; val_best_acc_score: 0.8507; val_best_f1_score: 0.8598; train_kl_reg_loss: 51868.1551; train_edge_recon_loss: 655525.9351; train_gene_expr_recon_loss: 19057878.8550; train_masked_gp_l1_reg_loss: 261891.2321; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67942.9729; train_chrom_access_recon_loss: 2475648.5592; train_global_loss: 22570755.6183; train_optim_loss: 22570755.6183; val_kl_reg_loss: 52459.7195; val_edge_recon_loss: 662147.6625; val_gene_expr_recon_loss: 19264593.7333; val_masked_gp_l1_reg_loss: 260553.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67624.0234; val_chrom_access_recon_loss: 2527394.4000; val_global_loss: 22834773.6000; val_optim_loss: 22834773.6000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9282; val_auprc_score: 0.9170; val_best_acc_score: 0.8529; val_best_f1_score: 0.8621; train_kl_reg_loss: 52501.7670; train_edge_recon_loss: 652163.6770; train_gene_expr_recon_loss: 18943489.7405; train_masked_gp_l1_reg_loss: 259285.8771; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67382.0113; train_chrom_access_recon_loss: 2471383.0363; train_global_loss: 22446206.0916; train_optim_loss: 22446206.0916; val_kl_reg_loss: 53229.3578; val_edge_recon_loss: 654992.2667; val_gene_expr_recon_loss: 19264417.8667; val_masked_gp_l1_reg_loss: 258020.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67127.9453; val_chrom_access_recon_loss: 2534366.0500; val_global_loss: 22832153.3333; val_optim_loss: 22832153.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 29 min 47 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9602
val AUPRC score: 0.9443
val best accuracy score: 0.9086
val best F1 score: 0.9134
val target rna MSE score: 1.2570
val source rna MSE score: 0.4817
val target atac MSE score: 0.6223
val source atac MSE score: 0.1428
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
