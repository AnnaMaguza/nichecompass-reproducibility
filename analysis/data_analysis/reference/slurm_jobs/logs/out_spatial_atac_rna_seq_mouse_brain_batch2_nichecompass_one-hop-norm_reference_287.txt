[True]
Run timestamp: 07092023_064858_287.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.01', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '50', '--lambda_l1_addon', '1000.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_287']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2774.

Filtering genes...
Starting with 22914 genes.
Keeping 22914 genes after filtering genes with expression in 0 cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 112141 peaks after filtering  peaks with counts in less than 92 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 3427 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 7945, n_cat_covariates_embed_input: 0, n_hidden: 2439, n_latent: 2339, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 4518
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3427
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2339, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 3427

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7556; val_auprc_score: 0.7788; val_best_acc_score: 0.5198; val_best_f1_score: 0.6734; train_kl_reg_loss: 84932.4301; train_edge_recon_loss: 3582906.6107; train_gene_expr_recon_loss: 17197239.8015; train_masked_gp_l1_reg_loss: 46798.1913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5762327.9890; train_chrom_access_recon_loss: 15782198.2137; train_global_loss: 42456403.2824; train_optim_loss: 42456403.2824; val_kl_reg_loss: 110785.1198; val_edge_recon_loss: 4063796.8500; val_gene_expr_recon_loss: 15934479.6667; val_masked_gp_l1_reg_loss: 41717.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 499912.8125; val_chrom_access_recon_loss: 15266172.1333; val_global_loss: 35916863.4667; val_optim_loss: 35916863.4667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7848; val_auprc_score: 0.8058; val_best_acc_score: 0.6435; val_best_f1_score: 0.7174; train_kl_reg_loss: 114446.8181; train_edge_recon_loss: 3528633.6584; train_gene_expr_recon_loss: 15598880.6641; train_masked_gp_l1_reg_loss: 39873.0021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 299623.9243; train_chrom_access_recon_loss: 15064418.2214; train_global_loss: 34645876.3359; train_optim_loss: 34645876.3359; val_kl_reg_loss: 108568.4948; val_edge_recon_loss: 4051324.7833; val_gene_expr_recon_loss: 15602798.3333; val_masked_gp_l1_reg_loss: 39615.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209531.3125; val_chrom_access_recon_loss: 14972816.8000; val_global_loss: 34984656.8000; val_optim_loss: 34984656.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8706; val_auprc_score: 0.8614; val_best_acc_score: 0.7842; val_best_f1_score: 0.8081; train_kl_reg_loss: 93283.2581; train_edge_recon_loss: 3452818.6889; train_gene_expr_recon_loss: 15350443.4885; train_masked_gp_l1_reg_loss: 41553.8979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181339.6781; train_chrom_access_recon_loss: 14838396.0229; train_global_loss: 33957834.9771; train_optim_loss: 33957834.9771; val_kl_reg_loss: 89687.1094; val_edge_recon_loss: 3186473.5833; val_gene_expr_recon_loss: 15351556.6000; val_masked_gp_l1_reg_loss: 44620.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163568.4688; val_chrom_access_recon_loss: 14808936.0000; val_global_loss: 33644840.9333; val_optim_loss: 33644840.9333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8887; val_auprc_score: 0.8786; val_best_acc_score: 0.7882; val_best_f1_score: 0.8098; train_kl_reg_loss: 120587.0786; train_edge_recon_loss: 2996296.3111; train_gene_expr_recon_loss: 15176535.4580; train_masked_gp_l1_reg_loss: 46691.4297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154229.7628; train_chrom_access_recon_loss: 14664668.3511; train_global_loss: 33159008.4733; train_optim_loss: 33159008.4733; val_kl_reg_loss: 129017.3151; val_edge_recon_loss: 2942219.8333; val_gene_expr_recon_loss: 15270786.8000; val_masked_gp_l1_reg_loss: 48465.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 147652.2656; val_chrom_access_recon_loss: 14669001.6667; val_global_loss: 33207143.7333; val_optim_loss: 33207143.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8949; val_auprc_score: 0.8808; val_best_acc_score: 0.8022; val_best_f1_score: 0.8186; train_kl_reg_loss: 119198.4140; train_edge_recon_loss: 2943497.3282; train_gene_expr_recon_loss: 15024206.9695; train_masked_gp_l1_reg_loss: 50194.5932; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142028.8942; train_chrom_access_recon_loss: 14511629.6107; train_global_loss: 32790755.9084; train_optim_loss: 32790755.9084; val_kl_reg_loss: 114066.1682; val_edge_recon_loss: 2917147.2833; val_gene_expr_recon_loss: 15098337.8000; val_masked_gp_l1_reg_loss: 51910.8164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137899.3281; val_chrom_access_recon_loss: 14493250.4667; val_global_loss: 32812611.4667; val_optim_loss: 32812611.4667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9142; val_auprc_score: 0.9010; val_best_acc_score: 0.8370; val_best_f1_score: 0.8451; train_kl_reg_loss: 113061.5831; train_edge_recon_loss: 2917893.2156; train_gene_expr_recon_loss: 14890757.6641; train_masked_gp_l1_reg_loss: 53180.4343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135452.2282; train_chrom_access_recon_loss: 14381154.3435; train_global_loss: 32491499.5420; train_optim_loss: 32491499.5420; val_kl_reg_loss: 106702.6953; val_edge_recon_loss: 2889698.7167; val_gene_expr_recon_loss: 15020101.9333; val_masked_gp_l1_reg_loss: 54632.9883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134059.7188; val_chrom_access_recon_loss: 14404024.8667; val_global_loss: 32609220.5333; val_optim_loss: 32609220.5333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9325; val_auprc_score: 0.9171; val_best_acc_score: 0.8651; val_best_f1_score: 0.8722; train_kl_reg_loss: 110123.1463; train_edge_recon_loss: 2859569.4733; train_gene_expr_recon_loss: 14767136.5802; train_masked_gp_l1_reg_loss: 55677.8985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132101.1611; train_chrom_access_recon_loss: 14253727.8855; train_global_loss: 32178336.2137; train_optim_loss: 32178336.2137; val_kl_reg_loss: 110238.6484; val_edge_recon_loss: 2826425.1833; val_gene_expr_recon_loss: 14880371.6000; val_masked_gp_l1_reg_loss: 56810.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131446.9375; val_chrom_access_recon_loss: 14279059.4000; val_global_loss: 32284350.8000; val_optim_loss: 32284350.8000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9319; val_auprc_score: 0.9132; val_best_acc_score: 0.8717; val_best_f1_score: 0.8795; train_kl_reg_loss: 111860.1839; train_edge_recon_loss: 2827591.8206; train_gene_expr_recon_loss: 14670433.0076; train_masked_gp_l1_reg_loss: 57946.9279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130340.0023; train_chrom_access_recon_loss: 14150033.2137; train_global_loss: 31948205.1298; train_optim_loss: 31948205.1298; val_kl_reg_loss: 109777.0255; val_edge_recon_loss: 2832250.5667; val_gene_expr_recon_loss: 14789866.2000; val_masked_gp_l1_reg_loss: 58930.8711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130144.2422; val_chrom_access_recon_loss: 14171534.4000; val_global_loss: 32092502.5333; val_optim_loss: 32092502.5333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9450; val_auprc_score: 0.9319; val_best_acc_score: 0.8840; val_best_f1_score: 0.8904; train_kl_reg_loss: 112171.4751; train_edge_recon_loss: 2788834.3225; train_gene_expr_recon_loss: 14595302.2061; train_masked_gp_l1_reg_loss: 59805.9510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129320.5205; train_chrom_access_recon_loss: 14079383.0763; train_global_loss: 31764817.5115; train_optim_loss: 31764817.5115; val_kl_reg_loss: 112692.2312; val_edge_recon_loss: 2784248.3333; val_gene_expr_recon_loss: 14656099.4667; val_masked_gp_l1_reg_loss: 60706.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128980.5000; val_chrom_access_recon_loss: 14051318.7333; val_global_loss: 31794044.9333; val_optim_loss: 31794044.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9463; val_auprc_score: 0.9320; val_best_acc_score: 0.8855; val_best_f1_score: 0.8919; train_kl_reg_loss: 108474.7748; train_edge_recon_loss: 2785670.8969; train_gene_expr_recon_loss: 14503585.3053; train_masked_gp_l1_reg_loss: 61587.7037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128759.9649; train_chrom_access_recon_loss: 13984802.2290; train_global_loss: 31572880.9008; train_optim_loss: 31572880.9008; val_kl_reg_loss: 109981.6542; val_edge_recon_loss: 2787496.6000; val_gene_expr_recon_loss: 14593899.4000; val_masked_gp_l1_reg_loss: 62378.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128901.4766; val_chrom_access_recon_loss: 13969181.4667; val_global_loss: 31651839.3333; val_optim_loss: 31651839.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9535; val_auprc_score: 0.9418; val_best_acc_score: 0.8938; val_best_f1_score: 0.8979; train_kl_reg_loss: 107260.3170; train_edge_recon_loss: 2772177.7080; train_gene_expr_recon_loss: 14430556.4733; train_masked_gp_l1_reg_loss: 63188.3689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128589.2753; train_chrom_access_recon_loss: 13895544.3206; train_global_loss: 31397316.5038; train_optim_loss: 31397316.5038; val_kl_reg_loss: 104153.6443; val_edge_recon_loss: 2760551.5500; val_gene_expr_recon_loss: 14525487.1333; val_masked_gp_l1_reg_loss: 63794.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128244.9922; val_chrom_access_recon_loss: 13904235.0000; val_global_loss: 31486465.6000; val_optim_loss: 31486465.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9524; val_auprc_score: 0.9382; val_best_acc_score: 0.8957; val_best_f1_score: 0.9002; train_kl_reg_loss: 104019.3160; train_edge_recon_loss: 2761741.3435; train_gene_expr_recon_loss: 14363241.8702; train_masked_gp_l1_reg_loss: 64651.8553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128339.3844; train_chrom_access_recon_loss: 13824625.2748; train_global_loss: 31246619.1908; train_optim_loss: 31246619.1908; val_kl_reg_loss: 105031.0250; val_edge_recon_loss: 2764606.6000; val_gene_expr_recon_loss: 14461107.7333; val_masked_gp_l1_reg_loss: 65552.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128691.3750; val_chrom_access_recon_loss: 13879743.2000; val_global_loss: 31404732.5333; val_optim_loss: 31404732.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9574; val_auprc_score: 0.9431; val_best_acc_score: 0.9008; val_best_f1_score: 0.9053; train_kl_reg_loss: 103297.3279; train_edge_recon_loss: 2746682.2595; train_gene_expr_recon_loss: 14301279.0611; train_masked_gp_l1_reg_loss: 66038.2745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128326.8657; train_chrom_access_recon_loss: 13752281.0763; train_global_loss: 31097904.7481; train_optim_loss: 31097904.7481; val_kl_reg_loss: 101824.8599; val_edge_recon_loss: 2742553.8167; val_gene_expr_recon_loss: 14379687.6667; val_masked_gp_l1_reg_loss: 66709.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128856.9375; val_chrom_access_recon_loss: 13800692.8667; val_global_loss: 31220325.3333; val_optim_loss: 31220325.3333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9611; val_auprc_score: 0.9496; val_best_acc_score: 0.9058; val_best_f1_score: 0.9101; train_kl_reg_loss: 102222.9373; train_edge_recon_loss: 2739788.5229; train_gene_expr_recon_loss: 14240643.1450; train_masked_gp_l1_reg_loss: 67188.1016; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128422.5413; train_chrom_access_recon_loss: 13691896.1985; train_global_loss: 30970161.4962; train_optim_loss: 30970161.4962; val_kl_reg_loss: 101558.9198; val_edge_recon_loss: 2739726.9500; val_gene_expr_recon_loss: 14299551.1333; val_masked_gp_l1_reg_loss: 67819.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129084.8984; val_chrom_access_recon_loss: 13657894.6667; val_global_loss: 30995635.6000; val_optim_loss: 30995635.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9604; val_auprc_score: 0.9504; val_best_acc_score: 0.9049; val_best_f1_score: 0.9090; train_kl_reg_loss: 100109.2573; train_edge_recon_loss: 2732951.7061; train_gene_expr_recon_loss: 14200505.1985; train_masked_gp_l1_reg_loss: 68343.6888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128382.9980; train_chrom_access_recon_loss: 13635356.9160; train_global_loss: 30865649.7252; train_optim_loss: 30865649.7252; val_kl_reg_loss: 100650.9604; val_edge_recon_loss: 2752487.0167; val_gene_expr_recon_loss: 14329584.8667; val_masked_gp_l1_reg_loss: 68891.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128212.8281; val_chrom_access_recon_loss: 13712147.2667; val_global_loss: 31091974.2667; val_optim_loss: 31091974.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9570; val_auprc_score: 0.9459; val_best_acc_score: 0.9014; val_best_f1_score: 0.9052; train_kl_reg_loss: 99551.7197; train_edge_recon_loss: 2737266.0821; train_gene_expr_recon_loss: 14143472.3893; train_masked_gp_l1_reg_loss: 69340.3751; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128316.6129; train_chrom_access_recon_loss: 13581702.7099; train_global_loss: 30759649.9847; train_optim_loss: 30759649.9847; val_kl_reg_loss: 98850.3026; val_edge_recon_loss: 2760684.2667; val_gene_expr_recon_loss: 14294513.0667; val_masked_gp_l1_reg_loss: 70031.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128624.8750; val_chrom_access_recon_loss: 13668717.3333; val_global_loss: 31021420.9333; val_optim_loss: 31021420.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9651; val_auprc_score: 0.9546; val_best_acc_score: 0.9150; val_best_f1_score: 0.9181; train_kl_reg_loss: 97504.4715; train_edge_recon_loss: 2736471.7672; train_gene_expr_recon_loss: 14116928.5496; train_masked_gp_l1_reg_loss: 70376.4148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128395.3485; train_chrom_access_recon_loss: 13541729.3053; train_global_loss: 30691405.9237; train_optim_loss: 30691405.9237; val_kl_reg_loss: 99182.0594; val_edge_recon_loss: 2690222.6500; val_gene_expr_recon_loss: 14230611.2000; val_masked_gp_l1_reg_loss: 70887.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 128771.2891; val_chrom_access_recon_loss: 13586646.9333; val_global_loss: 30806322.4000; val_optim_loss: 30806322.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9662; val_auprc_score: 0.9553; val_best_acc_score: 0.9147; val_best_f1_score: 0.9191; train_kl_reg_loss: 96285.2237; train_edge_recon_loss: 2727504.8111; train_gene_expr_recon_loss: 14075064.8397; train_masked_gp_l1_reg_loss: 71236.5415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128667.8034; train_chrom_access_recon_loss: 13491114.6718; train_global_loss: 30589873.9237; train_optim_loss: 30589873.9237; val_kl_reg_loss: 95189.7443; val_edge_recon_loss: 2725023.8333; val_gene_expr_recon_loss: 14229359.9333; val_masked_gp_l1_reg_loss: 71683.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129368.0703; val_chrom_access_recon_loss: 13537891.9333; val_global_loss: 30788517.7333; val_optim_loss: 30788517.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9663; val_auprc_score: 0.9555; val_best_acc_score: 0.9140; val_best_f1_score: 0.9170; train_kl_reg_loss: 95534.2523; train_edge_recon_loss: 2725276.8683; train_gene_expr_recon_loss: 14034873.6412; train_masked_gp_l1_reg_loss: 72067.1619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129147.3586; train_chrom_access_recon_loss: 13454371.8092; train_global_loss: 30511271.0534; train_optim_loss: 30511271.0534; val_kl_reg_loss: 95312.7729; val_edge_recon_loss: 2724907.4167; val_gene_expr_recon_loss: 14141310.8000; val_masked_gp_l1_reg_loss: 72381.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129453.8906; val_chrom_access_recon_loss: 13524398.8000; val_global_loss: 30687765.6000; val_optim_loss: 30687765.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9670; val_auprc_score: 0.9562; val_best_acc_score: 0.9220; val_best_f1_score: 0.9251; train_kl_reg_loss: 94877.7405; train_edge_recon_loss: 2715507.1508; train_gene_expr_recon_loss: 14001254.4427; train_masked_gp_l1_reg_loss: 72768.6270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129507.1215; train_chrom_access_recon_loss: 13409391.3282; train_global_loss: 30423306.3969; train_optim_loss: 30423306.3969; val_kl_reg_loss: 95556.7974; val_edge_recon_loss: 2715271.4667; val_gene_expr_recon_loss: 14106215.0000; val_masked_gp_l1_reg_loss: 73211.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130037.2500; val_chrom_access_recon_loss: 13492136.0667; val_global_loss: 30612428.9333; val_optim_loss: 30612428.9333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9673; val_auprc_score: 0.9573; val_best_acc_score: 0.9178; val_best_f1_score: 0.9210; train_kl_reg_loss: 94213.7354; train_edge_recon_loss: 2717509.3779; train_gene_expr_recon_loss: 13976560.6260; train_masked_gp_l1_reg_loss: 73593.9303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130219.2187; train_chrom_access_recon_loss: 13367609.4504; train_global_loss: 30359706.1221; train_optim_loss: 30359706.1221; val_kl_reg_loss: 91826.0250; val_edge_recon_loss: 2744881.8333; val_gene_expr_recon_loss: 14059369.1333; val_masked_gp_l1_reg_loss: 73838.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130435.9453; val_chrom_access_recon_loss: 13341980.5333; val_global_loss: 30442332.0000; val_optim_loss: 30442332.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9694; val_auprc_score: 0.9609; val_best_acc_score: 0.9212; val_best_f1_score: 0.9243; train_kl_reg_loss: 92737.4544; train_edge_recon_loss: 2719722.8931; train_gene_expr_recon_loss: 13937976.3206; train_masked_gp_l1_reg_loss: 74201.7511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131039.5340; train_chrom_access_recon_loss: 13331914.6412; train_global_loss: 30287592.6107; train_optim_loss: 30287592.6107; val_kl_reg_loss: 94703.4005; val_edge_recon_loss: 2719045.2333; val_gene_expr_recon_loss: 14035623.8000; val_masked_gp_l1_reg_loss: 74510.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131638.7031; val_chrom_access_recon_loss: 13370693.0000; val_global_loss: 30426214.1333; val_optim_loss: 30426214.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9732; val_auprc_score: 0.9669; val_best_acc_score: 0.9235; val_best_f1_score: 0.9260; train_kl_reg_loss: 93452.9804; train_edge_recon_loss: 2713526.8244; train_gene_expr_recon_loss: 13910585.4504; train_masked_gp_l1_reg_loss: 74872.6164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131662.9350; train_chrom_access_recon_loss: 13296310.7405; train_global_loss: 30220411.5878; train_optim_loss: 30220411.5878; val_kl_reg_loss: 95382.0479; val_edge_recon_loss: 2725089.9333; val_gene_expr_recon_loss: 14058483.0000; val_masked_gp_l1_reg_loss: 75238.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131929.6250; val_chrom_access_recon_loss: 13405009.7333; val_global_loss: 30491132.8000; val_optim_loss: 30491132.8000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9743; val_auprc_score: 0.9671; val_best_acc_score: 0.9263; val_best_f1_score: 0.9287; train_kl_reg_loss: 92417.8992; train_edge_recon_loss: 2706991.4714; train_gene_expr_recon_loss: 13887663.0992; train_masked_gp_l1_reg_loss: 75435.3993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131972.4571; train_chrom_access_recon_loss: 13274555.5649; train_global_loss: 30169035.8779; train_optim_loss: 30169035.8779; val_kl_reg_loss: 93033.7917; val_edge_recon_loss: 2712292.8833; val_gene_expr_recon_loss: 14043567.2667; val_masked_gp_l1_reg_loss: 75674.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132524.0781; val_chrom_access_recon_loss: 13367005.0667; val_global_loss: 30424097.0667; val_optim_loss: 30424097.0667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9754; val_auprc_score: 0.9665; val_best_acc_score: 0.9318; val_best_f1_score: 0.9342; train_kl_reg_loss: 91114.1736; train_edge_recon_loss: 2705964.0439; train_gene_expr_recon_loss: 13857495.2443; train_masked_gp_l1_reg_loss: 76097.5150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132411.8949; train_chrom_access_recon_loss: 13234992.6718; train_global_loss: 30098075.4809; train_optim_loss: 30098075.4809; val_kl_reg_loss: 91802.4677; val_edge_recon_loss: 2696838.4833; val_gene_expr_recon_loss: 13980560.6000; val_masked_gp_l1_reg_loss: 76399.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 131979.3438; val_chrom_access_recon_loss: 13336707.2000; val_global_loss: 30314288.1333; val_optim_loss: 30314288.1333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9744; val_auprc_score: 0.9652; val_best_acc_score: 0.9320; val_best_f1_score: 0.9342; train_kl_reg_loss: 93190.6279; train_edge_recon_loss: 2718102.0763; train_gene_expr_recon_loss: 13680524.2595; train_masked_gp_l1_reg_loss: 74919.8612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125761.9567; train_chrom_access_recon_loss: 13169860.6947; train_global_loss: 29862359.5420; train_optim_loss: 29862359.5420; val_kl_reg_loss: 71004.2141; val_edge_recon_loss: 2722751.1000; val_gene_expr_recon_loss: 13815005.4000; val_masked_gp_l1_reg_loss: 74681.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125116.3750; val_chrom_access_recon_loss: 13206188.6667; val_global_loss: 30014746.4000; val_optim_loss: 30014746.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9775; val_auprc_score: 0.9708; val_best_acc_score: 0.9336; val_best_f1_score: 0.9358; train_kl_reg_loss: 93058.1782; train_edge_recon_loss: 2710174.0916; train_gene_expr_recon_loss: 13644738.9237; train_masked_gp_l1_reg_loss: 74729.5407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124814.5441; train_chrom_access_recon_loss: 13115470.8168; train_global_loss: 29762986.1832; train_optim_loss: 29762986.1832; val_kl_reg_loss: 74227.2016; val_edge_recon_loss: 2699780.0333; val_gene_expr_recon_loss: 13785580.6000; val_masked_gp_l1_reg_loss: 74782.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125137.5312; val_chrom_access_recon_loss: 13173134.9333; val_global_loss: 29932643.2000; val_optim_loss: 29932643.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9723; val_auprc_score: 0.9641; val_best_acc_score: 0.9266; val_best_f1_score: 0.9292; train_kl_reg_loss: 89515.9037; train_edge_recon_loss: 2706433.5076; train_gene_expr_recon_loss: 13632296.6412; train_masked_gp_l1_reg_loss: 74833.9414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124578.5546; train_chrom_access_recon_loss: 13095969.6260; train_global_loss: 29723628.0916; train_optim_loss: 29723628.0916; val_kl_reg_loss: 76702.0906; val_edge_recon_loss: 2726920.1500; val_gene_expr_recon_loss: 13703509.4000; val_masked_gp_l1_reg_loss: 74915.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123896.7656; val_chrom_access_recon_loss: 13125114.4000; val_global_loss: 29831057.8667; val_optim_loss: 29831057.8667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9787; val_auprc_score: 0.9724; val_best_acc_score: 0.9352; val_best_f1_score: 0.9369; train_kl_reg_loss: 88823.1427; train_edge_recon_loss: 2696417.1908; train_gene_expr_recon_loss: 13613092.3053; train_masked_gp_l1_reg_loss: 74961.9618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123959.7569; train_chrom_access_recon_loss: 13081709.5649; train_global_loss: 29678963.9084; train_optim_loss: 29678963.9084; val_kl_reg_loss: 79485.7099; val_edge_recon_loss: 2718440.7833; val_gene_expr_recon_loss: 13791506.3333; val_masked_gp_l1_reg_loss: 74995.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123843.8594; val_chrom_access_recon_loss: 13155129.0667; val_global_loss: 29943401.0667; val_optim_loss: 29943401.0667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9797; val_auprc_score: 0.9741; val_best_acc_score: 0.9361; val_best_f1_score: 0.9382; train_kl_reg_loss: 86965.0550; train_edge_recon_loss: 2698741.0897; train_gene_expr_recon_loss: 13603108.0992; train_masked_gp_l1_reg_loss: 75106.3658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123673.8988; train_chrom_access_recon_loss: 13065802.7710; train_global_loss: 29653397.2366; train_optim_loss: 29653397.2366; val_kl_reg_loss: 77634.0599; val_edge_recon_loss: 2710101.7167; val_gene_expr_recon_loss: 13732309.8000; val_masked_gp_l1_reg_loss: 75179.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123597.3125; val_chrom_access_recon_loss: 13072597.2667; val_global_loss: 29791420.5333; val_optim_loss: 29791420.5333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9799; val_auprc_score: 0.9745; val_best_acc_score: 0.9363; val_best_f1_score: 0.9383; train_kl_reg_loss: 85402.4371; train_edge_recon_loss: 2690836.1889; train_gene_expr_recon_loss: 13579467.3817; train_masked_gp_l1_reg_loss: 75314.5331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123355.9982; train_chrom_access_recon_loss: 13042779.8092; train_global_loss: 29597156.4275; train_optim_loss: 29597156.4275; val_kl_reg_loss: 78365.6927; val_edge_recon_loss: 2698405.5667; val_gene_expr_recon_loss: 13737467.2000; val_masked_gp_l1_reg_loss: 75466.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123342.1094; val_chrom_access_recon_loss: 13127763.7333; val_global_loss: 29840810.8000; val_optim_loss: 29840810.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9822; val_auprc_score: 0.9760; val_best_acc_score: 0.9430; val_best_f1_score: 0.9447; train_kl_reg_loss: 84993.3169; train_edge_recon_loss: 2689524.2214; train_gene_expr_recon_loss: 13556883.9924; train_masked_gp_l1_reg_loss: 75556.1517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123147.8451; train_chrom_access_recon_loss: 13008183.4885; train_global_loss: 29538288.8550; train_optim_loss: 29538288.8550; val_kl_reg_loss: 79196.1953; val_edge_recon_loss: 2687653.2000; val_gene_expr_recon_loss: 13682076.2000; val_masked_gp_l1_reg_loss: 75703.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122975.4609; val_chrom_access_recon_loss: 13044715.8000; val_global_loss: 29692319.8667; val_optim_loss: 29692319.8667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9822; val_auprc_score: 0.9759; val_best_acc_score: 0.9417; val_best_f1_score: 0.9434; train_kl_reg_loss: 84078.6170; train_edge_recon_loss: 2694724.5706; train_gene_expr_recon_loss: 13554516.4962; train_masked_gp_l1_reg_loss: 75737.5899; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122936.0271; train_chrom_access_recon_loss: 13003227.2595; train_global_loss: 29535220.5191; train_optim_loss: 29535220.5191; val_kl_reg_loss: 79042.5406; val_edge_recon_loss: 2692435.9167; val_gene_expr_recon_loss: 13780629.1333; val_masked_gp_l1_reg_loss: 75782.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122898.7188; val_chrom_access_recon_loss: 13136349.7333; val_global_loss: 29887138.9333; val_optim_loss: 29887138.9333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9795; val_auprc_score: 0.9726; val_best_acc_score: 0.9394; val_best_f1_score: 0.9415; train_kl_reg_loss: 82980.9551; train_edge_recon_loss: 2694721.8645; train_gene_expr_recon_loss: 13536534.6489; train_masked_gp_l1_reg_loss: 75876.7427; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122804.7136; train_chrom_access_recon_loss: 12971072.8626; train_global_loss: 29483991.7557; train_optim_loss: 29483991.7557; val_kl_reg_loss: 78352.4932; val_edge_recon_loss: 2693244.0167; val_gene_expr_recon_loss: 13688730.4000; val_masked_gp_l1_reg_loss: 75957.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122871.7188; val_chrom_access_recon_loss: 13069096.4000; val_global_loss: 29728252.4000; val_optim_loss: 29728252.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9834; val_auprc_score: 0.9785; val_best_acc_score: 0.9464; val_best_f1_score: 0.9477; train_kl_reg_loss: 83272.3262; train_edge_recon_loss: 2686816.4943; train_gene_expr_recon_loss: 13521941.6947; train_masked_gp_l1_reg_loss: 76067.6867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122569.0349; train_chrom_access_recon_loss: 12950107.8550; train_global_loss: 29440775.0840; train_optim_loss: 29440775.0840; val_kl_reg_loss: 79384.7885; val_edge_recon_loss: 2686012.6500; val_gene_expr_recon_loss: 13630290.5333; val_masked_gp_l1_reg_loss: 76086.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122141.6328; val_chrom_access_recon_loss: 13014521.8667; val_global_loss: 29608438.6667; val_optim_loss: 29608438.6667
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9814; val_auprc_score: 0.9765; val_best_acc_score: 0.9437; val_best_f1_score: 0.9447; train_kl_reg_loss: 83057.1539; train_edge_recon_loss: 2688835.2958; train_gene_expr_recon_loss: 13505377.8550; train_masked_gp_l1_reg_loss: 76177.8787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122296.5923; train_chrom_access_recon_loss: 12939242.1985; train_global_loss: 29414986.9466; train_optim_loss: 29414986.9466; val_kl_reg_loss: 81428.2292; val_edge_recon_loss: 2686043.1667; val_gene_expr_recon_loss: 13671605.9333; val_masked_gp_l1_reg_loss: 76230.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122284.3516; val_chrom_access_recon_loss: 13040526.4667; val_global_loss: 29678117.7333; val_optim_loss: 29678117.7333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9836; val_auprc_score: 0.9784; val_best_acc_score: 0.9454; val_best_f1_score: 0.9464; train_kl_reg_loss: 82358.0095; train_edge_recon_loss: 2687555.9141; train_gene_expr_recon_loss: 13501964.5191; train_masked_gp_l1_reg_loss: 76310.0389; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122185.7685; train_chrom_access_recon_loss: 12932728.1908; train_global_loss: 29403102.4122; train_optim_loss: 29403102.4122; val_kl_reg_loss: 78384.6979; val_edge_recon_loss: 2688483.0500; val_gene_expr_recon_loss: 13619947.2000; val_masked_gp_l1_reg_loss: 76450.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122524.1250; val_chrom_access_recon_loss: 12970390.4667; val_global_loss: 29556180.2667; val_optim_loss: 29556180.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9826; val_auprc_score: 0.9770; val_best_acc_score: 0.9413; val_best_f1_score: 0.9431; train_kl_reg_loss: 82210.8030; train_edge_recon_loss: 2686368.4351; train_gene_expr_recon_loss: 13484393.8244; train_masked_gp_l1_reg_loss: 76459.9698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122314.5293; train_chrom_access_recon_loss: 12924121.4962; train_global_loss: 29375869.0840; train_optim_loss: 29375869.0840; val_kl_reg_loss: 80599.9073; val_edge_recon_loss: 2706039.7667; val_gene_expr_recon_loss: 13650117.5333; val_masked_gp_l1_reg_loss: 76565.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121380.1797; val_chrom_access_recon_loss: 12995842.4667; val_global_loss: 29630544.9333; val_optim_loss: 29630544.9333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9855; val_auprc_score: 0.9793; val_best_acc_score: 0.9512; val_best_f1_score: 0.9517; train_kl_reg_loss: 82242.1871; train_edge_recon_loss: 2681223.4637; train_gene_expr_recon_loss: 13479091.6260; train_masked_gp_l1_reg_loss: 76598.0724; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121991.9909; train_chrom_access_recon_loss: 12912374.2519; train_global_loss: 29353521.6489; train_optim_loss: 29353521.6489; val_kl_reg_loss: 80804.5661; val_edge_recon_loss: 2689573.0167; val_gene_expr_recon_loss: 13647028.7333; val_masked_gp_l1_reg_loss: 76604.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122084.5938; val_chrom_access_recon_loss: 13005540.9333; val_global_loss: 29621636.2667; val_optim_loss: 29621636.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9843; val_auprc_score: 0.9807; val_best_acc_score: 0.9440; val_best_f1_score: 0.9455; train_kl_reg_loss: 82098.1022; train_edge_recon_loss: 2683789.4580; train_gene_expr_recon_loss: 13467737.1221; train_masked_gp_l1_reg_loss: 76634.0354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122112.9146; train_chrom_access_recon_loss: 12900645.5573; train_global_loss: 29333017.2061; train_optim_loss: 29333017.2061; val_kl_reg_loss: 77873.5750; val_edge_recon_loss: 2708145.2167; val_gene_expr_recon_loss: 13644602.5333; val_masked_gp_l1_reg_loss: 76684.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122227.0938; val_chrom_access_recon_loss: 13001250.6000; val_global_loss: 29630783.7333; val_optim_loss: 29630783.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9846; val_auprc_score: 0.9737; val_best_acc_score: 0.9501; val_best_f1_score: 0.9513; train_kl_reg_loss: 81614.0615; train_edge_recon_loss: 2681363.5611; train_gene_expr_recon_loss: 13449359.8931; train_masked_gp_l1_reg_loss: 76745.7116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122269.1078; train_chrom_access_recon_loss: 12886689.6870; train_global_loss: 29298042.0458; train_optim_loss: 29298042.0458; val_kl_reg_loss: 78807.2828; val_edge_recon_loss: 2680760.9833; val_gene_expr_recon_loss: 13576926.7333; val_masked_gp_l1_reg_loss: 76867.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121329.7266; val_chrom_access_recon_loss: 12948198.0000; val_global_loss: 29482890.9333; val_optim_loss: 29482890.9333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9858; val_auprc_score: 0.9817; val_best_acc_score: 0.9553; val_best_f1_score: 0.9562; train_kl_reg_loss: 81901.2201; train_edge_recon_loss: 2681463.0134; train_gene_expr_recon_loss: 13448671.5649; train_masked_gp_l1_reg_loss: 76882.0302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122099.1952; train_chrom_access_recon_loss: 12890279.5191; train_global_loss: 29301296.5954; train_optim_loss: 29301296.5954; val_kl_reg_loss: 77557.2432; val_edge_recon_loss: 2682332.3000; val_gene_expr_recon_loss: 13650458.0667; val_masked_gp_l1_reg_loss: 76902.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122602.7969; val_chrom_access_recon_loss: 13038992.0667; val_global_loss: 29648845.0667; val_optim_loss: 29648845.0667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9852; val_auprc_score: 0.9796; val_best_acc_score: 0.9549; val_best_f1_score: 0.9556; train_kl_reg_loss: 81357.7912; train_edge_recon_loss: 2681804.7214; train_gene_expr_recon_loss: 13441215.8244; train_masked_gp_l1_reg_loss: 76945.6558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122252.7877; train_chrom_access_recon_loss: 12885672.7939; train_global_loss: 29289249.4504; train_optim_loss: 29289249.4504; val_kl_reg_loss: 79739.8490; val_edge_recon_loss: 2676371.0667; val_gene_expr_recon_loss: 13604767.7333; val_masked_gp_l1_reg_loss: 76951.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122323.0938; val_chrom_access_recon_loss: 12947500.4667; val_global_loss: 29507653.4667; val_optim_loss: 29507653.4667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9847; val_auprc_score: 0.9802; val_best_acc_score: 0.9492; val_best_f1_score: 0.9504; train_kl_reg_loss: 81319.9983; train_edge_recon_loss: 2680194.8416; train_gene_expr_recon_loss: 13419772.5420; train_masked_gp_l1_reg_loss: 76990.8010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122185.4169; train_chrom_access_recon_loss: 12858311.5802; train_global_loss: 29238775.0992; train_optim_loss: 29238775.0992; val_kl_reg_loss: 79250.4714; val_edge_recon_loss: 2700337.7333; val_gene_expr_recon_loss: 13574401.1333; val_masked_gp_l1_reg_loss: 76961.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121345.9141; val_chrom_access_recon_loss: 12937883.2667; val_global_loss: 29490179.8667; val_optim_loss: 29490179.8667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9862; val_auprc_score: 0.9828; val_best_acc_score: 0.9514; val_best_f1_score: 0.9525; train_kl_reg_loss: 81639.8593; train_edge_recon_loss: 2674174.0019; train_gene_expr_recon_loss: 13425956.0992; train_masked_gp_l1_reg_loss: 76975.4826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121716.3359; train_chrom_access_recon_loss: 12858623.3053; train_global_loss: 29239085.0992; train_optim_loss: 29239085.0992; val_kl_reg_loss: 80155.1583; val_edge_recon_loss: 2685173.5500; val_gene_expr_recon_loss: 13598737.8000; val_masked_gp_l1_reg_loss: 76903.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122125.9297; val_chrom_access_recon_loss: 12949937.6000; val_global_loss: 29513033.4667; val_optim_loss: 29513033.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9856; val_auprc_score: 0.9817; val_best_acc_score: 0.9500; val_best_f1_score: 0.9513; train_kl_reg_loss: 82066.0247; train_edge_recon_loss: 2675353.3130; train_gene_expr_recon_loss: 13388343.4046; train_masked_gp_l1_reg_loss: 76190.5716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88576.4889; train_chrom_access_recon_loss: 12831953.0458; train_global_loss: 29142482.7176; train_optim_loss: 29142482.7176; val_kl_reg_loss: 80790.1365; val_edge_recon_loss: 2700708.9333; val_gene_expr_recon_loss: 13637350.9333; val_masked_gp_l1_reg_loss: 75886.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85276.0312; val_chrom_access_recon_loss: 13014818.5333; val_global_loss: 29594830.5333; val_optim_loss: 29594830.5333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9859; val_auprc_score: 0.9803; val_best_acc_score: 0.9520; val_best_f1_score: 0.9533; train_kl_reg_loss: 82932.5742; train_edge_recon_loss: 2678308.3779; train_gene_expr_recon_loss: 13393980.0305; train_masked_gp_l1_reg_loss: 75787.2493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84883.3340; train_chrom_access_recon_loss: 12832477.3130; train_global_loss: 29148368.7939; train_optim_loss: 29148368.7939; val_kl_reg_loss: 81892.3078; val_edge_recon_loss: 2688694.7333; val_gene_expr_recon_loss: 13587582.8667; val_masked_gp_l1_reg_loss: 75708.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84596.8203; val_chrom_access_recon_loss: 13001697.1333; val_global_loss: 29520172.6667; val_optim_loss: 29520172.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9843; val_auprc_score: 0.9777; val_best_acc_score: 0.9484; val_best_f1_score: 0.9498; train_kl_reg_loss: 83843.5391; train_edge_recon_loss: 2673939.7156; train_gene_expr_recon_loss: 13394642.1527; train_masked_gp_l1_reg_loss: 75663.8470; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84364.9423; train_chrom_access_recon_loss: 12838219.1832; train_global_loss: 29150673.3740; train_optim_loss: 29150673.3740; val_kl_reg_loss: 82266.2594; val_edge_recon_loss: 2700140.3333; val_gene_expr_recon_loss: 13584909.4667; val_masked_gp_l1_reg_loss: 75618.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84209.7422; val_chrom_access_recon_loss: 12973980.2000; val_global_loss: 29501124.2667; val_optim_loss: 29501124.2667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9875; val_auprc_score: 0.9830; val_best_acc_score: 0.9537; val_best_f1_score: 0.9542; train_kl_reg_loss: 83703.4075; train_edge_recon_loss: 2679741.5344; train_gene_expr_recon_loss: 13400433.1069; train_masked_gp_l1_reg_loss: 75597.8047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84037.8536; train_chrom_access_recon_loss: 12840342.9618; train_global_loss: 29163856.7023; train_optim_loss: 29163856.7023; val_kl_reg_loss: 81231.8995; val_edge_recon_loss: 2696426.8667; val_gene_expr_recon_loss: 13537338.2000; val_masked_gp_l1_reg_loss: 75578.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83762.9375; val_chrom_access_recon_loss: 12917352.6667; val_global_loss: 29391690.4000; val_optim_loss: 29391690.4000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9866; val_auprc_score: 0.9816; val_best_acc_score: 0.9510; val_best_f1_score: 0.9521; train_kl_reg_loss: 83605.1864; train_edge_recon_loss: 2671579.8492; train_gene_expr_recon_loss: 13391818.3053; train_masked_gp_l1_reg_loss: 75552.9929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83590.2369; train_chrom_access_recon_loss: 12838339.2977; train_global_loss: 29144485.7863; train_optim_loss: 29144485.7863; val_kl_reg_loss: 81802.3427; val_edge_recon_loss: 2701834.5833; val_gene_expr_recon_loss: 13552547.8000; val_masked_gp_l1_reg_loss: 75535.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83501.5234; val_chrom_access_recon_loss: 12934124.3333; val_global_loss: 29429346.2667; val_optim_loss: 29429346.2667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9876; val_auprc_score: 0.9849; val_best_acc_score: 0.9537; val_best_f1_score: 0.9542; train_kl_reg_loss: 83424.2616; train_edge_recon_loss: 2677193.0954; train_gene_expr_recon_loss: 13378687.8626; train_masked_gp_l1_reg_loss: 75522.1071; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83310.6078; train_chrom_access_recon_loss: 12823007.1908; train_global_loss: 29121145.0687; train_optim_loss: 29121145.0687; val_kl_reg_loss: 81800.4990; val_edge_recon_loss: 2674770.5667; val_gene_expr_recon_loss: 13516329.5333; val_masked_gp_l1_reg_loss: 75501.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83257.5156; val_chrom_access_recon_loss: 12881377.6667; val_global_loss: 29313037.7333; val_optim_loss: 29313037.7333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9853; val_auprc_score: 0.9810; val_best_acc_score: 0.9520; val_best_f1_score: 0.9532; train_kl_reg_loss: 83604.9017; train_edge_recon_loss: 2681853.6756; train_gene_expr_recon_loss: 13392337.2366; train_masked_gp_l1_reg_loss: 75498.9273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83075.3888; train_chrom_access_recon_loss: 12832087.6489; train_global_loss: 29148457.8168; train_optim_loss: 29148457.8168; val_kl_reg_loss: 82188.0323; val_edge_recon_loss: 2684128.8000; val_gene_expr_recon_loss: 13541936.6667; val_masked_gp_l1_reg_loss: 75491.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82989.5156; val_chrom_access_recon_loss: 12888095.8000; val_global_loss: 29354831.3333; val_optim_loss: 29354831.3333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9883; val_auprc_score: 0.9862; val_best_acc_score: 0.9555; val_best_f1_score: 0.9565; train_kl_reg_loss: 83772.8770; train_edge_recon_loss: 2678207.0802; train_gene_expr_recon_loss: 13390277.3053; train_masked_gp_l1_reg_loss: 75488.0805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82875.7556; train_chrom_access_recon_loss: 12835887.6565; train_global_loss: 29146508.9008; train_optim_loss: 29146508.9008; val_kl_reg_loss: 81990.4073; val_edge_recon_loss: 2690250.2167; val_gene_expr_recon_loss: 13500193.7333; val_masked_gp_l1_reg_loss: 75468.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82642.9922; val_chrom_access_recon_loss: 12888770.1333; val_global_loss: 29319316.2667; val_optim_loss: 29319316.2667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9886; val_auprc_score: 0.9822; val_best_acc_score: 0.9568; val_best_f1_score: 0.9572; train_kl_reg_loss: 83359.7130; train_edge_recon_loss: 2678746.4618; train_gene_expr_recon_loss: 13379564.4885; train_masked_gp_l1_reg_loss: 75463.6777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82643.6772; train_chrom_access_recon_loss: 12815330.7176; train_global_loss: 29115108.7634; train_optim_loss: 29115108.7634; val_kl_reg_loss: 82126.9380; val_edge_recon_loss: 2680366.8833; val_gene_expr_recon_loss: 13557681.7333; val_masked_gp_l1_reg_loss: 75464.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82444.4297; val_chrom_access_recon_loss: 12910555.6667; val_global_loss: 29388639.6000; val_optim_loss: 29388639.6000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9881; val_auprc_score: 0.9856; val_best_acc_score: 0.9535; val_best_f1_score: 0.9546; train_kl_reg_loss: 83535.5379; train_edge_recon_loss: 2677447.4008; train_gene_expr_recon_loss: 13380922.5573; train_masked_gp_l1_reg_loss: 75460.3656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82399.2204; train_chrom_access_recon_loss: 12823464.5573; train_global_loss: 29123229.5573; train_optim_loss: 29123229.5573; val_kl_reg_loss: 81635.1370; val_edge_recon_loss: 2681044.2833; val_gene_expr_recon_loss: 13564322.7333; val_masked_gp_l1_reg_loss: 75447.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82359.0547; val_chrom_access_recon_loss: 12872086.2667; val_global_loss: 29356895.4667; val_optim_loss: 29356895.4667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9875; val_auprc_score: 0.9805; val_best_acc_score: 0.9542; val_best_f1_score: 0.9547; train_kl_reg_loss: 83486.4905; train_edge_recon_loss: 2675239.8034; train_gene_expr_recon_loss: 13381477.7863; train_masked_gp_l1_reg_loss: 75372.2163; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78606.0366; train_chrom_access_recon_loss: 12819592.2901; train_global_loss: 29113774.6260; train_optim_loss: 29113774.6260; val_kl_reg_loss: 82259.1979; val_edge_recon_loss: 2683526.1167; val_gene_expr_recon_loss: 13536459.7333; val_masked_gp_l1_reg_loss: 75333.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78232.3828; val_chrom_access_recon_loss: 12932944.6667; val_global_loss: 29388754.9333; val_optim_loss: 29388754.9333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9877; val_auprc_score: 0.9826; val_best_acc_score: 0.9576; val_best_f1_score: 0.9580; train_kl_reg_loss: 83707.7979; train_edge_recon_loss: 2676559.0477; train_gene_expr_recon_loss: 13379123.3053; train_masked_gp_l1_reg_loss: 75318.0960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78197.5390; train_chrom_access_recon_loss: 12824069.7939; train_global_loss: 29116975.7099; train_optim_loss: 29116975.7099; val_kl_reg_loss: 82115.7172; val_edge_recon_loss: 2678216.2167; val_gene_expr_recon_loss: 13577396.8000; val_masked_gp_l1_reg_loss: 75303.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78160.0156; val_chrom_access_recon_loss: 12960813.4000; val_global_loss: 29452006.2667; val_optim_loss: 29452006.2667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9882; val_auprc_score: 0.9859; val_best_acc_score: 0.9542; val_best_f1_score: 0.9552; train_kl_reg_loss: 83730.3089; train_edge_recon_loss: 2674619.3702; train_gene_expr_recon_loss: 13378718.6107; train_masked_gp_l1_reg_loss: 75296.0122; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78140.2972; train_chrom_access_recon_loss: 12821843.6260; train_global_loss: 29112348.1832; train_optim_loss: 29112348.1832; val_kl_reg_loss: 82520.9740; val_edge_recon_loss: 2680495.2167; val_gene_expr_recon_loss: 13586244.6000; val_masked_gp_l1_reg_loss: 75286.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78115.4609; val_chrom_access_recon_loss: 12989683.5333; val_global_loss: 29492346.4000; val_optim_loss: 29492346.4000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9864; val_auprc_score: 0.9790; val_best_acc_score: 0.9549; val_best_f1_score: 0.9556; train_kl_reg_loss: 83723.3044; train_edge_recon_loss: 2674463.0878; train_gene_expr_recon_loss: 13365437.4275; train_masked_gp_l1_reg_loss: 75283.1778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78095.8303; train_chrom_access_recon_loss: 12805991.6718; train_global_loss: 29082994.6260; train_optim_loss: 29082994.6260; val_kl_reg_loss: 82160.1589; val_edge_recon_loss: 2686859.6000; val_gene_expr_recon_loss: 13596807.8667; val_masked_gp_l1_reg_loss: 75276.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78074.8281; val_chrom_access_recon_loss: 13001142.2667; val_global_loss: 29520321.6000; val_optim_loss: 29520321.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 110 min 19 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9879
val AUPRC score: 0.9853
val best accuracy score: 0.9559
val best F1 score: 0.9568
val target rna MSE score: 0.9511
val source rna MSE score: 0.2935
val target atac MSE score: 0.3425
val source atac MSE score: 0.0569
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
