[True]
Run timestamp: 10102023_123121_263.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_263']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6802; val_auprc_score: 0.6553; val_best_acc_score: 0.5231; val_best_f1_score: 0.6763; train_kl_reg_loss: 76404.7407; train_edge_recon_loss: 756753.4612; train_gene_expr_recon_loss: 22991139.6667; train_masked_gp_l1_reg_loss: 39188.3284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3988026.0985; train_chrom_access_recon_loss: 11493003.4394; train_global_loss: 39344515.3333; train_optim_loss: 39344515.3333; val_kl_reg_loss: 97400.4434; val_edge_recon_loss: 812819.8984; val_gene_expr_recon_loss: 21458909.2500; val_masked_gp_l1_reg_loss: 42238.0664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2640172.0000; val_chrom_access_recon_loss: 11207423.6250; val_global_loss: 36258963.0000; val_optim_loss: 36258963.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7014; val_auprc_score: 0.6935; val_best_acc_score: 0.5938; val_best_f1_score: 0.6990; train_kl_reg_loss: 100291.7129; train_edge_recon_loss: 754559.9337; train_gene_expr_recon_loss: 21232170.8788; train_masked_gp_l1_reg_loss: 42382.6949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1704364.5445; train_chrom_access_recon_loss: 11006303.2273; train_global_loss: 34840072.9091; train_optim_loss: 34840072.9091; val_kl_reg_loss: 97029.0713; val_edge_recon_loss: 812060.9297; val_gene_expr_recon_loss: 20951323.5000; val_masked_gp_l1_reg_loss: 42891.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1012820.5000; val_chrom_access_recon_loss: 11020659.3750; val_global_loss: 33936785.2500; val_optim_loss: 33936785.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8170; val_auprc_score: 0.7993; val_best_acc_score: 0.7383; val_best_f1_score: 0.7250; train_kl_reg_loss: 86623.1412; train_edge_recon_loss: 741069.2756; train_gene_expr_recon_loss: 21022971.7879; train_masked_gp_l1_reg_loss: 43495.6826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 703157.4953; train_chrom_access_recon_loss: 10920289.1818; train_global_loss: 33517606.4242; train_optim_loss: 33517606.4242; val_kl_reg_loss: 78367.8047; val_edge_recon_loss: 803819.8125; val_gene_expr_recon_loss: 21055442.2500; val_masked_gp_l1_reg_loss: 44205.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 482760.8750; val_chrom_access_recon_loss: 11042274.8750; val_global_loss: 33506871.0000; val_optim_loss: 33506871.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8657; val_auprc_score: 0.8398; val_best_acc_score: 0.7958; val_best_f1_score: 0.8044; train_kl_reg_loss: 76308.3584; train_edge_recon_loss: 729734.8826; train_gene_expr_recon_loss: 20875337.6061; train_masked_gp_l1_reg_loss: 45214.2222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 378976.5507; train_chrom_access_recon_loss: 10849066.3182; train_global_loss: 32954637.8788; train_optim_loss: 32954637.8788; val_kl_reg_loss: 73137.0928; val_edge_recon_loss: 776863.4844; val_gene_expr_recon_loss: 20916038.0000; val_masked_gp_l1_reg_loss: 46232.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 302754.0312; val_chrom_access_recon_loss: 10896102.8750; val_global_loss: 33011127.5000; val_optim_loss: 33011127.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8888; val_auprc_score: 0.8549; val_best_acc_score: 0.8127; val_best_f1_score: 0.8286; train_kl_reg_loss: 70894.5432; train_edge_recon_loss: 702637.7528; train_gene_expr_recon_loss: 20718498.7879; train_masked_gp_l1_reg_loss: 47309.9338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 263149.4058; train_chrom_access_recon_loss: 10767847.5303; train_global_loss: 32570338.2121; train_optim_loss: 32570338.2121; val_kl_reg_loss: 71857.6982; val_edge_recon_loss: 683438.6016; val_gene_expr_recon_loss: 20696332.5000; val_masked_gp_l1_reg_loss: 48261.5039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 231206.4844; val_chrom_access_recon_loss: 10876436.2500; val_global_loss: 32607533.0000; val_optim_loss: 32607533.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8952; val_auprc_score: 0.8688; val_best_acc_score: 0.8259; val_best_f1_score: 0.8402; train_kl_reg_loss: 80026.8961; train_edge_recon_loss: 646811.0871; train_gene_expr_recon_loss: 20586377.2727; train_masked_gp_l1_reg_loss: 49311.6394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 209905.7602; train_chrom_access_recon_loss: 10726742.8182; train_global_loss: 32299175.4242; train_optim_loss: 32299175.4242; val_kl_reg_loss: 80292.6533; val_edge_recon_loss: 639841.4453; val_gene_expr_recon_loss: 20596993.0000; val_masked_gp_l1_reg_loss: 50356.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190740.5312; val_chrom_access_recon_loss: 10846470.5000; val_global_loss: 32404693.5000; val_optim_loss: 32404693.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9068; val_auprc_score: 0.8789; val_best_acc_score: 0.8385; val_best_f1_score: 0.8504; train_kl_reg_loss: 81800.9183; train_edge_recon_loss: 628600.8049; train_gene_expr_recon_loss: 20483133.7879; train_masked_gp_l1_reg_loss: 51270.4062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 176278.2192; train_chrom_access_recon_loss: 10670083.7576; train_global_loss: 32091167.9091; train_optim_loss: 32091167.9091; val_kl_reg_loss: 79707.0791; val_edge_recon_loss: 632198.1328; val_gene_expr_recon_loss: 20540503.0000; val_masked_gp_l1_reg_loss: 52196.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 163898.5781; val_chrom_access_recon_loss: 10838455.7500; val_global_loss: 32306957.0000; val_optim_loss: 32306957.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9034; val_auprc_score: 0.8744; val_best_acc_score: 0.8412; val_best_f1_score: 0.8499; train_kl_reg_loss: 79798.7129; train_edge_recon_loss: 619242.0672; train_gene_expr_recon_loss: 20384217.8182; train_masked_gp_l1_reg_loss: 53025.8484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 154187.1776; train_chrom_access_recon_loss: 10634065.3636; train_global_loss: 31924537.0303; train_optim_loss: 31924537.0303; val_kl_reg_loss: 79458.8799; val_edge_recon_loss: 624253.9766; val_gene_expr_recon_loss: 20337008.5000; val_masked_gp_l1_reg_loss: 53833.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145744.4375; val_chrom_access_recon_loss: 10800462.6250; val_global_loss: 32040761.7500; val_optim_loss: 32040761.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9103; val_auprc_score: 0.8826; val_best_acc_score: 0.8426; val_best_f1_score: 0.8517; train_kl_reg_loss: 77795.1793; train_edge_recon_loss: 612745.1544; train_gene_expr_recon_loss: 20285468.0000; train_masked_gp_l1_reg_loss: 54459.4213; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139670.4860; train_chrom_access_recon_loss: 10592615.8182; train_global_loss: 31762754.0303; train_optim_loss: 31762754.0303; val_kl_reg_loss: 78958.4805; val_edge_recon_loss: 614147.7344; val_gene_expr_recon_loss: 20280596.2500; val_masked_gp_l1_reg_loss: 55156.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 134551.0781; val_chrom_access_recon_loss: 10602008.3750; val_global_loss: 31765419.2500; val_optim_loss: 31765419.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9172; val_auprc_score: 0.8914; val_best_acc_score: 0.8482; val_best_f1_score: 0.8593; train_kl_reg_loss: 75850.8941; train_edge_recon_loss: 609094.7491; train_gene_expr_recon_loss: 20222877.0606; train_masked_gp_l1_reg_loss: 55763.4737; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129812.6194; train_chrom_access_recon_loss: 10546676.1061; train_global_loss: 31640075.0303; train_optim_loss: 31640075.0303; val_kl_reg_loss: 73636.0049; val_edge_recon_loss: 611026.4062; val_gene_expr_recon_loss: 20193549.0000; val_masked_gp_l1_reg_loss: 56318.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125654.2422; val_chrom_access_recon_loss: 10630617.3750; val_global_loss: 31690801.0000; val_optim_loss: 31690801.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9256; val_auprc_score: 0.9072; val_best_acc_score: 0.8538; val_best_f1_score: 0.8640; train_kl_reg_loss: 73430.9129; train_edge_recon_loss: 606510.7841; train_gene_expr_recon_loss: 20139815.6061; train_masked_gp_l1_reg_loss: 56982.0802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121675.6371; train_chrom_access_recon_loss: 10504751.4394; train_global_loss: 31503166.4545; train_optim_loss: 31503166.4545; val_kl_reg_loss: 73707.7168; val_edge_recon_loss: 608825.2188; val_gene_expr_recon_loss: 20105740.7500; val_masked_gp_l1_reg_loss: 57566.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119381.2969; val_chrom_access_recon_loss: 10686300.7500; val_global_loss: 31651522.5000; val_optim_loss: 31651522.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9162; val_auprc_score: 0.8890; val_best_acc_score: 0.8469; val_best_f1_score: 0.8589; train_kl_reg_loss: 71393.1412; train_edge_recon_loss: 603433.5265; train_gene_expr_recon_loss: 20067853.4242; train_masked_gp_l1_reg_loss: 58150.1018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 115909.2956; train_chrom_access_recon_loss: 10468776.3333; train_global_loss: 31385515.4848; train_optim_loss: 31385515.4848; val_kl_reg_loss: 70423.7080; val_edge_recon_loss: 601740.3125; val_gene_expr_recon_loss: 20128655.0000; val_masked_gp_l1_reg_loss: 58577.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113088.7188; val_chrom_access_recon_loss: 10590861.7500; val_global_loss: 31563346.7500; val_optim_loss: 31563346.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9263; val_auprc_score: 0.9062; val_best_acc_score: 0.8530; val_best_f1_score: 0.8628; train_kl_reg_loss: 69893.5241; train_edge_recon_loss: 600142.1818; train_gene_expr_recon_loss: 19979929.5455; train_masked_gp_l1_reg_loss: 59087.1521; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110494.5466; train_chrom_access_recon_loss: 10401922.0455; train_global_loss: 31221469.0606; train_optim_loss: 31221469.0606; val_kl_reg_loss: 70659.5664; val_edge_recon_loss: 609263.0391; val_gene_expr_recon_loss: 20006894.2500; val_masked_gp_l1_reg_loss: 59652.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107954.0781; val_chrom_access_recon_loss: 10579584.3750; val_global_loss: 31434007.2500; val_optim_loss: 31434007.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9347; val_auprc_score: 0.9157; val_best_acc_score: 0.8718; val_best_f1_score: 0.8791; train_kl_reg_loss: 68484.1726; train_edge_recon_loss: 597419.3987; train_gene_expr_recon_loss: 19927598.0000; train_masked_gp_l1_reg_loss: 60162.2747; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105850.6869; train_chrom_access_recon_loss: 10371656.4545; train_global_loss: 31131170.9697; train_optim_loss: 31131170.9697; val_kl_reg_loss: 68211.0654; val_edge_recon_loss: 595487.5469; val_gene_expr_recon_loss: 19972785.5000; val_masked_gp_l1_reg_loss: 60775.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103880.5859; val_chrom_access_recon_loss: 10525823.8750; val_global_loss: 31326964.0000; val_optim_loss: 31326964.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9289; val_auprc_score: 0.9045; val_best_acc_score: 0.8587; val_best_f1_score: 0.8698; train_kl_reg_loss: 67351.4509; train_edge_recon_loss: 594319.7093; train_gene_expr_recon_loss: 19852606.9394; train_masked_gp_l1_reg_loss: 61194.4476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102071.6160; train_chrom_access_recon_loss: 10318612.8939; train_global_loss: 30996157.0303; train_optim_loss: 30996157.0303; val_kl_reg_loss: 66436.6914; val_edge_recon_loss: 603963.5781; val_gene_expr_recon_loss: 19883044.5000; val_masked_gp_l1_reg_loss: 61701.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100970.5469; val_chrom_access_recon_loss: 10426017.8750; val_global_loss: 31142134.5000; val_optim_loss: 31142134.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9342; val_auprc_score: 0.9100; val_best_acc_score: 0.8769; val_best_f1_score: 0.8833; train_kl_reg_loss: 66205.7370; train_edge_recon_loss: 591965.2670; train_gene_expr_recon_loss: 19792545.1212; train_masked_gp_l1_reg_loss: 62216.3499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99010.1570; train_chrom_access_recon_loss: 10288298.9091; train_global_loss: 30900241.3333; train_optim_loss: 30900241.3333; val_kl_reg_loss: 66015.8477; val_edge_recon_loss: 594278.1094; val_gene_expr_recon_loss: 19977276.2500; val_masked_gp_l1_reg_loss: 62768.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97248.3984; val_chrom_access_recon_loss: 10510096.5000; val_global_loss: 31307682.5000; val_optim_loss: 31307682.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9405; val_auprc_score: 0.9226; val_best_acc_score: 0.8786; val_best_f1_score: 0.8841; train_kl_reg_loss: 65045.8110; train_edge_recon_loss: 591044.1098; train_gene_expr_recon_loss: 19729603.2727; train_masked_gp_l1_reg_loss: 63218.9841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96254.5651; train_chrom_access_recon_loss: 10246882.1515; train_global_loss: 30792048.7273; train_optim_loss: 30792048.7273; val_kl_reg_loss: 65221.6802; val_edge_recon_loss: 596353.5234; val_gene_expr_recon_loss: 19762907.5000; val_masked_gp_l1_reg_loss: 63796.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95450.2109; val_chrom_access_recon_loss: 10413812.0000; val_global_loss: 30997541.0000; val_optim_loss: 30997541.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9420; val_auprc_score: 0.9198; val_best_acc_score: 0.8829; val_best_f1_score: 0.8894; train_kl_reg_loss: 63922.1520; train_edge_recon_loss: 590818.9176; train_gene_expr_recon_loss: 19685373.0909; train_masked_gp_l1_reg_loss: 64265.0574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94446.8660; train_chrom_access_recon_loss: 10190132.3939; train_global_loss: 30688958.4545; train_optim_loss: 30688958.4545; val_kl_reg_loss: 63591.0942; val_edge_recon_loss: 593499.1797; val_gene_expr_recon_loss: 19809478.2500; val_masked_gp_l1_reg_loss: 64778.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93549.3594; val_chrom_access_recon_loss: 10379767.1250; val_global_loss: 31004663.5000; val_optim_loss: 31004663.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9377; val_auprc_score: 0.9165; val_best_acc_score: 0.8769; val_best_f1_score: 0.8848; train_kl_reg_loss: 63256.0289; train_edge_recon_loss: 587679.1875; train_gene_expr_recon_loss: 19646772.9697; train_masked_gp_l1_reg_loss: 65273.5144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92662.5395; train_chrom_access_recon_loss: 10159799.6818; train_global_loss: 30615443.9091; train_optim_loss: 30615443.9091; val_kl_reg_loss: 64942.3149; val_edge_recon_loss: 598311.1562; val_gene_expr_recon_loss: 19846275.0000; val_masked_gp_l1_reg_loss: 65830.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92567.0469; val_chrom_access_recon_loss: 10476039.0000; val_global_loss: 31143965.5000; val_optim_loss: 31143965.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9510; val_auprc_score: 0.9361; val_best_acc_score: 0.8915; val_best_f1_score: 0.8986; train_kl_reg_loss: 62139.1033; train_edge_recon_loss: 587854.4896; train_gene_expr_recon_loss: 19567301.9091; train_masked_gp_l1_reg_loss: 66314.2396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91478.2844; train_chrom_access_recon_loss: 10094144.3030; train_global_loss: 30469232.1818; train_optim_loss: 30469232.1818; val_kl_reg_loss: 62323.6313; val_edge_recon_loss: 587897.4062; val_gene_expr_recon_loss: 19696447.2500; val_masked_gp_l1_reg_loss: 66886.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91245.4766; val_chrom_access_recon_loss: 10314923.0000; val_global_loss: 30819723.2500; val_optim_loss: 30819723.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9418; val_auprc_score: 0.9209; val_best_acc_score: 0.8839; val_best_f1_score: 0.8903; train_kl_reg_loss: 61674.5798; train_edge_recon_loss: 585511.2453; train_gene_expr_recon_loss: 19527411.6061; train_masked_gp_l1_reg_loss: 67519.8383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90531.1664; train_chrom_access_recon_loss: 10056992.1667; train_global_loss: 30389640.5455; train_optim_loss: 30389640.5455; val_kl_reg_loss: 61057.0786; val_edge_recon_loss: 593347.3594; val_gene_expr_recon_loss: 19605333.2500; val_masked_gp_l1_reg_loss: 68047.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90228.6641; val_chrom_access_recon_loss: 10291333.6250; val_global_loss: 30709347.7500; val_optim_loss: 30709347.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9427; val_auprc_score: 0.9218; val_best_acc_score: 0.8888; val_best_f1_score: 0.8957; train_kl_reg_loss: 60908.1283; train_edge_recon_loss: 585987.8078; train_gene_expr_recon_loss: 19462385.9697; train_masked_gp_l1_reg_loss: 68677.5870; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89554.8658; train_chrom_access_recon_loss: 10008749.7576; train_global_loss: 30276264.2121; train_optim_loss: 30276264.2121; val_kl_reg_loss: 61223.0371; val_edge_recon_loss: 591281.2891; val_gene_expr_recon_loss: 19432259.2500; val_masked_gp_l1_reg_loss: 69399.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89359.7266; val_chrom_access_recon_loss: 10200403.6250; val_global_loss: 30443927.0000; val_optim_loss: 30443927.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9475; val_auprc_score: 0.9327; val_best_acc_score: 0.8882; val_best_f1_score: 0.8933; train_kl_reg_loss: 60095.4825; train_edge_recon_loss: 585834.3902; train_gene_expr_recon_loss: 19421291.3636; train_masked_gp_l1_reg_loss: 69899.7643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88842.4966; train_chrom_access_recon_loss: 9965399.8636; train_global_loss: 30191363.3030; train_optim_loss: 30191363.3030; val_kl_reg_loss: 59499.4648; val_edge_recon_loss: 589616.1562; val_gene_expr_recon_loss: 19544389.5000; val_masked_gp_l1_reg_loss: 70528.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88832.2422; val_chrom_access_recon_loss: 10251355.8750; val_global_loss: 30604220.7500; val_optim_loss: 30604220.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9463; val_auprc_score: 0.9254; val_best_acc_score: 0.8920; val_best_f1_score: 0.8978; train_kl_reg_loss: 59879.1010; train_edge_recon_loss: 583527.9460; train_gene_expr_recon_loss: 19349137.0606; train_masked_gp_l1_reg_loss: 71201.1451; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88552.4285; train_chrom_access_recon_loss: 9903973.2121; train_global_loss: 30056270.8485; train_optim_loss: 30056270.8485; val_kl_reg_loss: 60353.6328; val_edge_recon_loss: 586512.0391; val_gene_expr_recon_loss: 19350232.7500; val_masked_gp_l1_reg_loss: 71779.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88100.4453; val_chrom_access_recon_loss: 10091187.8750; val_global_loss: 30248166.2500; val_optim_loss: 30248166.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9455; val_auprc_score: 0.9257; val_best_acc_score: 0.8882; val_best_f1_score: 0.8957; train_kl_reg_loss: 59665.3411; train_edge_recon_loss: 583070.5152; train_gene_expr_recon_loss: 19295621.9091; train_masked_gp_l1_reg_loss: 72391.4705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88014.8836; train_chrom_access_recon_loss: 9860866.7576; train_global_loss: 29959630.9091; train_optim_loss: 29959630.9091; val_kl_reg_loss: 61113.5059; val_edge_recon_loss: 588301.6406; val_gene_expr_recon_loss: 19539084.7500; val_masked_gp_l1_reg_loss: 73080.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88354.8359; val_chrom_access_recon_loss: 10207056.5000; val_global_loss: 30556990.7500; val_optim_loss: 30556990.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.7591; val_auprc_score: 0.7262; val_best_acc_score: 0.6368; val_best_f1_score: 0.7230; train_kl_reg_loss: 28279.1214; train_edge_recon_loss: 743815.5407; train_gene_expr_recon_loss: 18819744.9394; train_masked_gp_l1_reg_loss: 75317.1439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94120.5096; train_chrom_access_recon_loss: 9664476.5455; train_global_loss: 29425753.7576; train_optim_loss: 29425753.7576; val_kl_reg_loss: 17606.9587; val_edge_recon_loss: 803374.0312; val_gene_expr_recon_loss: 18547413.5000; val_masked_gp_l1_reg_loss: 77718.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111555.3750; val_chrom_access_recon_loss: 9606868.5000; val_global_loss: 29164536.7500; val_optim_loss: 29164536.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.7332; val_auprc_score: 0.7106; val_best_acc_score: 0.6370; val_best_f1_score: 0.6982; train_kl_reg_loss: 16016.5895; train_edge_recon_loss: 776872.7453; train_gene_expr_recon_loss: 18343138.7576; train_masked_gp_l1_reg_loss: 76610.7489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112097.4749; train_chrom_access_recon_loss: 9535228.5606; train_global_loss: 28859964.8485; train_optim_loss: 28859964.8485; val_kl_reg_loss: 11765.0496; val_edge_recon_loss: 805839.0547; val_gene_expr_recon_loss: 18427073.0000; val_masked_gp_l1_reg_loss: 75415.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109747.8906; val_chrom_access_recon_loss: 9659469.0000; val_global_loss: 29089310.5000; val_optim_loss: 29089310.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.7843; val_auprc_score: 0.7546; val_best_acc_score: 0.6779; val_best_f1_score: 0.7397; train_kl_reg_loss: 13544.3269; train_edge_recon_loss: 775090.7879; train_gene_expr_recon_loss: 18218163.5455; train_masked_gp_l1_reg_loss: 73954.2843; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105667.1894; train_chrom_access_recon_loss: 9498268.7121; train_global_loss: 28684688.9091; train_optim_loss: 28684688.9091; val_kl_reg_loss: 10363.3823; val_edge_recon_loss: 798969.3750; val_gene_expr_recon_loss: 18238060.2500; val_masked_gp_l1_reg_loss: 72191.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102772.5859; val_chrom_access_recon_loss: 9633894.3750; val_global_loss: 28856251.2500; val_optim_loss: 28856251.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.7831; val_auprc_score: 0.7444; val_best_acc_score: 0.7010; val_best_f1_score: 0.7525; train_kl_reg_loss: 13704.8695; train_edge_recon_loss: 767521.1591; train_gene_expr_recon_loss: 18144394.2424; train_masked_gp_l1_reg_loss: 71098.0708; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103440.1742; train_chrom_access_recon_loss: 9459966.2273; train_global_loss: 28560124.6364; train_optim_loss: 28560124.6364; val_kl_reg_loss: 10307.3309; val_edge_recon_loss: 795683.7266; val_gene_expr_recon_loss: 18338881.0000; val_masked_gp_l1_reg_loss: 69784.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102852.3359; val_chrom_access_recon_loss: 9623015.0000; val_global_loss: 28940523.0000; val_optim_loss: 28940523.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8085; val_auprc_score: 0.7789; val_best_acc_score: 0.7085; val_best_f1_score: 0.7590; train_kl_reg_loss: 17324.9740; train_edge_recon_loss: 751201.9006; train_gene_expr_recon_loss: 18147560.2424; train_masked_gp_l1_reg_loss: 68662.2113; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101469.9983; train_chrom_access_recon_loss: 9435396.7121; train_global_loss: 28521616.0606; train_optim_loss: 28521616.0606; val_kl_reg_loss: 13551.3298; val_edge_recon_loss: 793379.2734; val_gene_expr_recon_loss: 18089260.2500; val_masked_gp_l1_reg_loss: 67601.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99905.6562; val_chrom_access_recon_loss: 9523489.0000; val_global_loss: 28587187.7500; val_optim_loss: 28587187.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8129; val_auprc_score: 0.7626; val_best_acc_score: 0.7528; val_best_f1_score: 0.7815; train_kl_reg_loss: 16417.6791; train_edge_recon_loss: 762532.4545; train_gene_expr_recon_loss: 18091854.0000; train_masked_gp_l1_reg_loss: 66783.7125; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99601.1433; train_chrom_access_recon_loss: 9426589.3485; train_global_loss: 28463778.4545; train_optim_loss: 28463778.4545; val_kl_reg_loss: 13370.6462; val_edge_recon_loss: 785092.0703; val_gene_expr_recon_loss: 17979885.7500; val_masked_gp_l1_reg_loss: 66248.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100505.6328; val_chrom_access_recon_loss: 9516684.6250; val_global_loss: 28461787.0000; val_optim_loss: 28461787.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8386; val_auprc_score: 0.7994; val_best_acc_score: 0.7778; val_best_f1_score: 0.8004; train_kl_reg_loss: 19345.4309; train_edge_recon_loss: 763617.9725; train_gene_expr_recon_loss: 18018846.3939; train_masked_gp_l1_reg_loss: 65243.3383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98353.0732; train_chrom_access_recon_loss: 9404096.1970; train_global_loss: 28369502.5455; train_optim_loss: 28369502.5455; val_kl_reg_loss: 14747.6635; val_edge_recon_loss: 778069.3281; val_gene_expr_recon_loss: 17993917.5000; val_masked_gp_l1_reg_loss: 64205.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97078.0781; val_chrom_access_recon_loss: 9571714.2500; val_global_loss: 28519732.7500; val_optim_loss: 28519732.7500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8248; val_auprc_score: 0.7861; val_best_acc_score: 0.7606; val_best_f1_score: 0.7809; train_kl_reg_loss: 16118.1295; train_edge_recon_loss: 763735.1487; train_gene_expr_recon_loss: 18055506.0909; train_masked_gp_l1_reg_loss: 63789.6766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96870.1125; train_chrom_access_recon_loss: 9388371.8939; train_global_loss: 28384391.0000; train_optim_loss: 28384391.0000; val_kl_reg_loss: 16051.1638; val_edge_recon_loss: 773396.3047; val_gene_expr_recon_loss: 18034923.0000; val_masked_gp_l1_reg_loss: 63250.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96845.3594; val_chrom_access_recon_loss: 9536058.3750; val_global_loss: 28520524.7500; val_optim_loss: 28520524.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8063; val_auprc_score: 0.7592; val_best_acc_score: 0.7493; val_best_f1_score: 0.7729; train_kl_reg_loss: 16164.3837; train_edge_recon_loss: 765695.4460; train_gene_expr_recon_loss: 17954402.8182; train_masked_gp_l1_reg_loss: 62506.6065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97177.2721; train_chrom_access_recon_loss: 9366122.4697; train_global_loss: 28262068.9697; train_optim_loss: 28262068.9697; val_kl_reg_loss: 12641.5939; val_edge_recon_loss: 768998.6094; val_gene_expr_recon_loss: 18065720.2500; val_masked_gp_l1_reg_loss: 62122.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96575.2500; val_chrom_access_recon_loss: 9440235.5000; val_global_loss: 28446293.5000; val_optim_loss: 28446293.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8411; val_auprc_score: 0.7974; val_best_acc_score: 0.7716; val_best_f1_score: 0.7984; train_kl_reg_loss: 16051.6124; train_edge_recon_loss: 749073.7509; train_gene_expr_recon_loss: 17924634.9697; train_masked_gp_l1_reg_loss: 61841.1168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95373.8103; train_chrom_access_recon_loss: 9350972.4697; train_global_loss: 28197947.6364; train_optim_loss: 28197947.6364; val_kl_reg_loss: 14371.2615; val_edge_recon_loss: 751896.8750; val_gene_expr_recon_loss: 17938065.5000; val_masked_gp_l1_reg_loss: 61565.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94786.9453; val_chrom_access_recon_loss: 9536651.1250; val_global_loss: 28397336.5000; val_optim_loss: 28397336.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8388; val_auprc_score: 0.7882; val_best_acc_score: 0.7746; val_best_f1_score: 0.8000; train_kl_reg_loss: 18146.3609; train_edge_recon_loss: 729820.0625; train_gene_expr_recon_loss: 17880779.4848; train_masked_gp_l1_reg_loss: 61067.8312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93442.0991; train_chrom_access_recon_loss: 9317505.9545; train_global_loss: 28100761.6667; train_optim_loss: 28100761.6667; val_kl_reg_loss: 14594.8063; val_edge_recon_loss: 745738.4609; val_gene_expr_recon_loss: 17855436.2500; val_masked_gp_l1_reg_loss: 60298.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91457.3750; val_chrom_access_recon_loss: 9367061.0000; val_global_loss: 28134586.7500; val_optim_loss: 28134586.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8374; val_auprc_score: 0.7814; val_best_acc_score: 0.7856; val_best_f1_score: 0.8094; train_kl_reg_loss: 18101.1827; train_edge_recon_loss: 727804.8608; train_gene_expr_recon_loss: 17889614.4697; train_masked_gp_l1_reg_loss: 59910.8813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90630.8190; train_chrom_access_recon_loss: 9311439.5303; train_global_loss: 28097501.8182; train_optim_loss: 28097501.8182; val_kl_reg_loss: 14162.9541; val_edge_recon_loss: 751694.2891; val_gene_expr_recon_loss: 17972510.0000; val_masked_gp_l1_reg_loss: 59807.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91038.4531; val_chrom_access_recon_loss: 9456931.2500; val_global_loss: 28346144.7500; val_optim_loss: 28346144.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8505; val_auprc_score: 0.8067; val_best_acc_score: 0.7883; val_best_f1_score: 0.8126; train_kl_reg_loss: 16044.2534; train_edge_recon_loss: 723358.1733; train_gene_expr_recon_loss: 17840713.3333; train_masked_gp_l1_reg_loss: 59781.3394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90538.0621; train_chrom_access_recon_loss: 9295844.5909; train_global_loss: 28026279.8485; train_optim_loss: 28026279.8485; val_kl_reg_loss: 15124.7139; val_edge_recon_loss: 723910.4141; val_gene_expr_recon_loss: 17847358.7500; val_masked_gp_l1_reg_loss: 59727.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90173.0312; val_chrom_access_recon_loss: 9402793.6250; val_global_loss: 28139089.5000; val_optim_loss: 28139089.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8529; val_auprc_score: 0.8114; val_best_acc_score: 0.7902; val_best_f1_score: 0.8135; train_kl_reg_loss: 16546.3323; train_edge_recon_loss: 710014.1013; train_gene_expr_recon_loss: 17829964.3030; train_masked_gp_l1_reg_loss: 59515.8869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90204.6375; train_chrom_access_recon_loss: 9287227.4697; train_global_loss: 27993472.8485; train_optim_loss: 27993472.8485; val_kl_reg_loss: 14286.2625; val_edge_recon_loss: 716497.2891; val_gene_expr_recon_loss: 17854028.7500; val_masked_gp_l1_reg_loss: 59384.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90759.2734; val_chrom_access_recon_loss: 9440386.8750; val_global_loss: 28175343.2500; val_optim_loss: 28175343.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8519; val_auprc_score: 0.8017; val_best_acc_score: 0.7875; val_best_f1_score: 0.8093; train_kl_reg_loss: 18244.6462; train_edge_recon_loss: 695446.1866; train_gene_expr_recon_loss: 17768895.0303; train_masked_gp_l1_reg_loss: 59121.6907; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89868.8364; train_chrom_access_recon_loss: 9264177.1212; train_global_loss: 27895753.5455; train_optim_loss: 27895753.5455; val_kl_reg_loss: 16769.2915; val_edge_recon_loss: 698105.0000; val_gene_expr_recon_loss: 17702778.0000; val_masked_gp_l1_reg_loss: 58785.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88953.3750; val_chrom_access_recon_loss: 9376429.6250; val_global_loss: 27941822.0000; val_optim_loss: 27941822.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8625; val_auprc_score: 0.8245; val_best_acc_score: 0.7931; val_best_f1_score: 0.8148; train_kl_reg_loss: 20299.6924; train_edge_recon_loss: 676009.4148; train_gene_expr_recon_loss: 17752399.3636; train_masked_gp_l1_reg_loss: 58530.7227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87840.5272; train_chrom_access_recon_loss: 9269712.5455; train_global_loss: 27864792.4242; train_optim_loss: 27864792.4242; val_kl_reg_loss: 18265.0996; val_edge_recon_loss: 679401.2344; val_gene_expr_recon_loss: 17808097.7500; val_masked_gp_l1_reg_loss: 58264.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87123.0312; val_chrom_access_recon_loss: 9374056.6250; val_global_loss: 28025208.5000; val_optim_loss: 28025208.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8483; val_auprc_score: 0.7955; val_best_acc_score: 0.7926; val_best_f1_score: 0.8141; train_kl_reg_loss: 20954.4296; train_edge_recon_loss: 661404.7898; train_gene_expr_recon_loss: 17717678.9697; train_masked_gp_l1_reg_loss: 58105.4867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86472.4431; train_chrom_access_recon_loss: 9254023.3485; train_global_loss: 27798639.5758; train_optim_loss: 27798639.5758; val_kl_reg_loss: 19530.5037; val_edge_recon_loss: 663975.3438; val_gene_expr_recon_loss: 17845024.7500; val_masked_gp_l1_reg_loss: 57995.3398; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85888.7344; val_chrom_access_recon_loss: 9481283.6250; val_global_loss: 28153698.5000; val_optim_loss: 28153698.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8422; val_auprc_score: 0.7907; val_best_acc_score: 0.7810; val_best_f1_score: 0.8084; train_kl_reg_loss: 23045.5941; train_edge_recon_loss: 645494.5009; train_gene_expr_recon_loss: 17703527.4848; train_masked_gp_l1_reg_loss: 57815.6324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85179.4727; train_chrom_access_recon_loss: 9246505.0758; train_global_loss: 27761567.6061; train_optim_loss: 27761567.6061; val_kl_reg_loss: 22064.1428; val_edge_recon_loss: 642931.6875; val_gene_expr_recon_loss: 17700164.5000; val_masked_gp_l1_reg_loss: 57726.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84913.5781; val_chrom_access_recon_loss: 9416706.7500; val_global_loss: 27924507.0000; val_optim_loss: 27924507.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8620; val_auprc_score: 0.8217; val_best_acc_score: 0.7915; val_best_f1_score: 0.8132; train_kl_reg_loss: 25627.1311; train_edge_recon_loss: 628237.7159; train_gene_expr_recon_loss: 17678062.5758; train_masked_gp_l1_reg_loss: 57621.6970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84160.6406; train_chrom_access_recon_loss: 9234950.4545; train_global_loss: 27708660.2424; train_optim_loss: 27708660.2424; val_kl_reg_loss: 24683.0720; val_edge_recon_loss: 622418.2344; val_gene_expr_recon_loss: 17863809.2500; val_masked_gp_l1_reg_loss: 57554.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83571.0234; val_chrom_access_recon_loss: 9453733.1250; val_global_loss: 28105770.0000; val_optim_loss: 28105770.0000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8507; val_auprc_score: 0.8007; val_best_acc_score: 0.7789; val_best_f1_score: 0.8037; train_kl_reg_loss: 28195.8835; train_edge_recon_loss: 619456.8362; train_gene_expr_recon_loss: 17651115.0606; train_masked_gp_l1_reg_loss: 57495.3803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83135.9207; train_chrom_access_recon_loss: 9220280.3939; train_global_loss: 27659679.3636; train_optim_loss: 27659679.3636; val_kl_reg_loss: 26135.7263; val_edge_recon_loss: 620446.3750; val_gene_expr_recon_loss: 17548043.0000; val_masked_gp_l1_reg_loss: 57452.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82841.1016; val_chrom_access_recon_loss: 9301229.8750; val_global_loss: 27636149.0000; val_optim_loss: 27636149.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8474; val_auprc_score: 0.8062; val_best_acc_score: 0.7746; val_best_f1_score: 0.8005; train_kl_reg_loss: 30219.5766; train_edge_recon_loss: 611141.0218; train_gene_expr_recon_loss: 17635332.8485; train_masked_gp_l1_reg_loss: 57298.9439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82369.7386; train_chrom_access_recon_loss: 9211735.2727; train_global_loss: 27628097.2424; train_optim_loss: 27628097.2424; val_kl_reg_loss: 28096.9861; val_edge_recon_loss: 618721.8125; val_gene_expr_recon_loss: 17639256.5000; val_masked_gp_l1_reg_loss: 57211.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81818.6172; val_chrom_access_recon_loss: 9325555.2500; val_global_loss: 27750660.7500; val_optim_loss: 27750660.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8530; val_auprc_score: 0.8164; val_best_acc_score: 0.7808; val_best_f1_score: 0.8002; train_kl_reg_loss: 31316.2745; train_edge_recon_loss: 607878.5180; train_gene_expr_recon_loss: 17626827.1212; train_masked_gp_l1_reg_loss: 57154.3784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81553.8113; train_chrom_access_recon_loss: 9212609.6818; train_global_loss: 27617339.8788; train_optim_loss: 27617339.8788; val_kl_reg_loss: 29806.9331; val_edge_recon_loss: 610845.9219; val_gene_expr_recon_loss: 17555753.2500; val_masked_gp_l1_reg_loss: 57114.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81044.1250; val_chrom_access_recon_loss: 9317367.3750; val_global_loss: 27651931.5000; val_optim_loss: 27651931.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8445; val_auprc_score: 0.7976; val_best_acc_score: 0.7762; val_best_f1_score: 0.8013; train_kl_reg_loss: 31818.8060; train_edge_recon_loss: 606276.8731; train_gene_expr_recon_loss: 17612837.4848; train_masked_gp_l1_reg_loss: 57016.1883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80873.6540; train_chrom_access_recon_loss: 9204766.7121; train_global_loss: 27593590.0606; train_optim_loss: 27593590.0606; val_kl_reg_loss: 30759.8584; val_edge_recon_loss: 608591.3125; val_gene_expr_recon_loss: 17605699.2500; val_masked_gp_l1_reg_loss: 56940.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80438.7969; val_chrom_access_recon_loss: 9268276.6250; val_global_loss: 27650705.2500; val_optim_loss: 27650705.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8548; val_auprc_score: 0.8145; val_best_acc_score: 0.7802; val_best_f1_score: 0.8024; train_kl_reg_loss: 32923.3309; train_edge_recon_loss: 602719.8097; train_gene_expr_recon_loss: 17577207.8485; train_masked_gp_l1_reg_loss: 56851.0343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79982.9239; train_chrom_access_recon_loss: 9203223.0833; train_global_loss: 27552908.0606; train_optim_loss: 27552908.0606; val_kl_reg_loss: 30809.3574; val_edge_recon_loss: 612929.0625; val_gene_expr_recon_loss: 17588024.5000; val_masked_gp_l1_reg_loss: 56831.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79476.8672; val_chrom_access_recon_loss: 9244221.3750; val_global_loss: 27612292.0000; val_optim_loss: 27612292.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8684; val_auprc_score: 0.8330; val_best_acc_score: 0.7950; val_best_f1_score: 0.8134; train_kl_reg_loss: 33499.7836; train_edge_recon_loss: 599288.9669; train_gene_expr_recon_loss: 17569841.7273; train_masked_gp_l1_reg_loss: 56719.9452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79175.0324; train_chrom_access_recon_loss: 9187818.2121; train_global_loss: 27526343.7879; train_optim_loss: 27526343.7879; val_kl_reg_loss: 32480.2998; val_edge_recon_loss: 600262.1328; val_gene_expr_recon_loss: 17574496.2500; val_masked_gp_l1_reg_loss: 56664.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78512.4609; val_chrom_access_recon_loss: 9316548.7500; val_global_loss: 27658963.2500; val_optim_loss: 27658963.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8672; val_auprc_score: 0.8295; val_best_acc_score: 0.7982; val_best_f1_score: 0.8151; train_kl_reg_loss: 33552.8116; train_edge_recon_loss: 601711.2775; train_gene_expr_recon_loss: 17556027.3788; train_masked_gp_l1_reg_loss: 56536.3810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78243.7809; train_chrom_access_recon_loss: 9187787.5303; train_global_loss: 27513859.2424; train_optim_loss: 27513859.2424; val_kl_reg_loss: 32927.5325; val_edge_recon_loss: 594950.5859; val_gene_expr_recon_loss: 17568173.0000; val_masked_gp_l1_reg_loss: 56452.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77912.8750; val_chrom_access_recon_loss: 9259399.1250; val_global_loss: 27589814.5000; val_optim_loss: 27589814.5000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8638; val_auprc_score: 0.8325; val_best_acc_score: 0.7883; val_best_f1_score: 0.8120; train_kl_reg_loss: 34308.9371; train_edge_recon_loss: 596184.9394; train_gene_expr_recon_loss: 17541437.0606; train_masked_gp_l1_reg_loss: 56336.1436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77492.4460; train_chrom_access_recon_loss: 9168762.7121; train_global_loss: 27474522.2424; train_optim_loss: 27474522.2424; val_kl_reg_loss: 32842.7271; val_edge_recon_loss: 603537.1719; val_gene_expr_recon_loss: 17417945.2500; val_masked_gp_l1_reg_loss: 56285.3945; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77137.9219; val_chrom_access_recon_loss: 9260303.0000; val_global_loss: 27448052.2500; val_optim_loss: 27448052.2500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8826; val_auprc_score: 0.8541; val_best_acc_score: 0.8039; val_best_f1_score: 0.8249; train_kl_reg_loss: 34311.4313; train_edge_recon_loss: 593601.8201; train_gene_expr_recon_loss: 17532009.3788; train_masked_gp_l1_reg_loss: 56201.4740; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76467.4612; train_chrom_access_recon_loss: 9169408.1818; train_global_loss: 27461999.8485; train_optim_loss: 27461999.8485; val_kl_reg_loss: 33288.7793; val_edge_recon_loss: 591580.0547; val_gene_expr_recon_loss: 17534936.2500; val_masked_gp_l1_reg_loss: 56085.0898; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76225.8516; val_chrom_access_recon_loss: 9273829.7500; val_global_loss: 27565947.2500; val_optim_loss: 27565947.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8752; val_auprc_score: 0.8404; val_best_acc_score: 0.8023; val_best_f1_score: 0.8222; train_kl_reg_loss: 34353.9371; train_edge_recon_loss: 591607.0284; train_gene_expr_recon_loss: 17508695.8788; train_masked_gp_l1_reg_loss: 55991.3616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75722.1082; train_chrom_access_recon_loss: 9163808.6667; train_global_loss: 27430179.0000; train_optim_loss: 27430179.0000; val_kl_reg_loss: 34155.9214; val_edge_recon_loss: 596981.6562; val_gene_expr_recon_loss: 17511178.2500; val_masked_gp_l1_reg_loss: 55913.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75210.6406; val_chrom_access_recon_loss: 9251006.5000; val_global_loss: 27524447.0000; val_optim_loss: 27524447.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.8774; val_auprc_score: 0.8416; val_best_acc_score: 0.8087; val_best_f1_score: 0.8266; train_kl_reg_loss: 34753.8174; train_edge_recon_loss: 592236.6799; train_gene_expr_recon_loss: 17500705.7879; train_masked_gp_l1_reg_loss: 55807.9458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74654.1428; train_chrom_access_recon_loss: 9153922.6818; train_global_loss: 27412080.8485; train_optim_loss: 27412080.8485; val_kl_reg_loss: 33922.3159; val_edge_recon_loss: 595835.4922; val_gene_expr_recon_loss: 17637261.0000; val_masked_gp_l1_reg_loss: 55741.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74525.3203; val_chrom_access_recon_loss: 9334515.6250; val_global_loss: 27731802.0000; val_optim_loss: 27731802.0000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8838; val_auprc_score: 0.8532; val_best_acc_score: 0.8119; val_best_f1_score: 0.8313; train_kl_reg_loss: 34957.6428; train_edge_recon_loss: 592849.9991; train_gene_expr_recon_loss: 17488770.1515; train_masked_gp_l1_reg_loss: 55634.2597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73987.5118; train_chrom_access_recon_loss: 9152532.9394; train_global_loss: 27398732.7273; train_optim_loss: 27398732.7273; val_kl_reg_loss: 34739.9087; val_edge_recon_loss: 587992.0859; val_gene_expr_recon_loss: 17662732.2500; val_masked_gp_l1_reg_loss: 55590.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73672.6328; val_chrom_access_recon_loss: 9314592.5000; val_global_loss: 27729318.7500; val_optim_loss: 27729318.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8716; val_auprc_score: 0.8280; val_best_acc_score: 0.8071; val_best_f1_score: 0.8275; train_kl_reg_loss: 35655.9039; train_edge_recon_loss: 591646.9110; train_gene_expr_recon_loss: 17523000.8333; train_masked_gp_l1_reg_loss: 55222.3964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63221.0582; train_chrom_access_recon_loss: 9210426.6970; train_global_loss: 27479173.8485; train_optim_loss: 27479173.8485; val_kl_reg_loss: 35063.1245; val_edge_recon_loss: 590985.2500; val_gene_expr_recon_loss: 17554448.0000; val_masked_gp_l1_reg_loss: 55036.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60023.1875; val_chrom_access_recon_loss: 9351683.1250; val_global_loss: 27647239.0000; val_optim_loss: 27647239.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.8729; val_auprc_score: 0.8348; val_best_acc_score: 0.8041; val_best_f1_score: 0.8253; train_kl_reg_loss: 36073.5972; train_edge_recon_loss: 590293.6884; train_gene_expr_recon_loss: 17506345.3636; train_masked_gp_l1_reg_loss: 54961.2693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59446.5462; train_chrom_access_recon_loss: 9175748.7727; train_global_loss: 27422869.3333; train_optim_loss: 27422869.3333; val_kl_reg_loss: 36056.5220; val_edge_recon_loss: 598620.6953; val_gene_expr_recon_loss: 17528135.7500; val_masked_gp_l1_reg_loss: 54912.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59016.4453; val_chrom_access_recon_loss: 9418582.7500; val_global_loss: 27695323.5000; val_optim_loss: 27695323.5000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.8718; val_auprc_score: 0.8368; val_best_acc_score: 0.8071; val_best_f1_score: 0.8300; train_kl_reg_loss: 36422.1377; train_edge_recon_loss: 588543.8248; train_gene_expr_recon_loss: 17485081.0758; train_masked_gp_l1_reg_loss: 54878.7821; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58820.4120; train_chrom_access_recon_loss: 9158478.8939; train_global_loss: 27382225.3636; train_optim_loss: 27382225.3636; val_kl_reg_loss: 36050.3540; val_edge_recon_loss: 592403.7422; val_gene_expr_recon_loss: 17563533.2500; val_masked_gp_l1_reg_loss: 54846.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58628.8594; val_chrom_access_recon_loss: 9256898.5000; val_global_loss: 27562359.7500; val_optim_loss: 27562359.7500
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.8720; val_auprc_score: 0.8361; val_best_acc_score: 0.8004; val_best_f1_score: 0.8250; train_kl_reg_loss: 36474.3804; train_edge_recon_loss: 592289.2633; train_gene_expr_recon_loss: 17499453.8939; train_masked_gp_l1_reg_loss: 54811.6034; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58548.5133; train_chrom_access_recon_loss: 9158821.3182; train_global_loss: 27400398.8485; train_optim_loss: 27400398.8485; val_kl_reg_loss: 36043.0874; val_edge_recon_loss: 597114.5156; val_gene_expr_recon_loss: 17645300.0000; val_masked_gp_l1_reg_loss: 54797.1680; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58403.8047; val_chrom_access_recon_loss: 9356568.1250; val_global_loss: 27748228.0000; val_optim_loss: 27748228.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 27 min 50 sec.
Using best model state, which was in epoch 52.

--- MODEL EVALUATION ---
val AUROC score: 0.8678
val AUPRC score: 0.8315
val best accuracy score: 0.7942
val best F1 score: 0.8142
val target rna MSE score: 1.5606
val source rna MSE score: 0.9023
val target atac MSE score: 0.3408
val source atac MSE score: 0.1708
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
