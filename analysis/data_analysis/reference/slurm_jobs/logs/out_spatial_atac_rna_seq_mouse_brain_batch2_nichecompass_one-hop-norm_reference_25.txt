[True]
Run timestamp: 09102023_201810_25.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_25']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7747; val_auprc_score: 0.7945; val_best_acc_score: 0.6245; val_best_f1_score: 0.7131; train_kl_reg_loss: 63390.7591; train_edge_recon_loss: 3495581.0878; train_gene_expr_recon_loss: 13333152.1985; train_masked_gp_l1_reg_loss: 46255.3486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3323309.9365; train_chrom_access_recon_loss: 955685.0663; train_global_loss: 21217374.4885; train_optim_loss: 21217374.4885; val_kl_reg_loss: 70968.2495; val_edge_recon_loss: 4057283.4167; val_gene_expr_recon_loss: 12906226.3333; val_masked_gp_l1_reg_loss: 52295.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 462028.0000; val_chrom_access_recon_loss: 946102.6625; val_global_loss: 18494904.4000; val_optim_loss: 18494904.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8033; val_auprc_score: 0.8102; val_best_acc_score: 0.7032; val_best_f1_score: 0.7498; train_kl_reg_loss: 70653.4099; train_edge_recon_loss: 3326546.3912; train_gene_expr_recon_loss: 12600146.3130; train_masked_gp_l1_reg_loss: 56999.3842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 252093.3876; train_chrom_access_recon_loss: 922706.2357; train_global_loss: 17229145.1679; train_optim_loss: 17229145.1679; val_kl_reg_loss: 83514.7177; val_edge_recon_loss: 3140308.0500; val_gene_expr_recon_loss: 12669488.4000; val_masked_gp_l1_reg_loss: 62935.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 161969.7969; val_chrom_access_recon_loss: 925863.3833; val_global_loss: 17044080.4667; val_optim_loss: 17044080.4667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8343; val_auprc_score: 0.8374; val_best_acc_score: 0.7336; val_best_f1_score: 0.7659; train_kl_reg_loss: 84394.0950; train_edge_recon_loss: 3058303.8473; train_gene_expr_recon_loss: 12487676.5725; train_masked_gp_l1_reg_loss: 68088.8706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138614.1822; train_chrom_access_recon_loss: 913655.1570; train_global_loss: 16750732.6107; train_optim_loss: 16750732.6107; val_kl_reg_loss: 86902.1797; val_edge_recon_loss: 3041141.6833; val_gene_expr_recon_loss: 12534645.2000; val_masked_gp_l1_reg_loss: 71170.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117807.7031; val_chrom_access_recon_loss: 918597.2958; val_global_loss: 16770264.4667; val_optim_loss: 16770264.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8891; val_auprc_score: 0.8834; val_best_acc_score: 0.7979; val_best_f1_score: 0.8143; train_kl_reg_loss: 83813.6038; train_edge_recon_loss: 2967472.9122; train_gene_expr_recon_loss: 12324688.9084; train_masked_gp_l1_reg_loss: 72854.1555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108606.7709; train_chrom_access_recon_loss: 902008.2839; train_global_loss: 16459444.6870; train_optim_loss: 16459444.6870; val_kl_reg_loss: 75608.8573; val_edge_recon_loss: 2922095.7833; val_gene_expr_recon_loss: 12477994.6667; val_masked_gp_l1_reg_loss: 75101.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103474.0312; val_chrom_access_recon_loss: 909260.5417; val_global_loss: 16563534.8000; val_optim_loss: 16563534.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9225; val_auprc_score: 0.9095; val_best_acc_score: 0.8503; val_best_f1_score: 0.8573; train_kl_reg_loss: 83698.9612; train_edge_recon_loss: 2816982.1202; train_gene_expr_recon_loss: 12209874.7939; train_masked_gp_l1_reg_loss: 77399.9293; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107661.0862; train_chrom_access_recon_loss: 895024.3578; train_global_loss: 16190641.1374; train_optim_loss: 16190641.1374; val_kl_reg_loss: 88698.6510; val_edge_recon_loss: 2828145.1667; val_gene_expr_recon_loss: 12319379.6000; val_masked_gp_l1_reg_loss: 78852.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110676.4922; val_chrom_access_recon_loss: 901802.6458; val_global_loss: 16327554.1333; val_optim_loss: 16327554.1333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9221; val_auprc_score: 0.9051; val_best_acc_score: 0.8510; val_best_f1_score: 0.8603; train_kl_reg_loss: 88315.1293; train_edge_recon_loss: 2793605.3378; train_gene_expr_recon_loss: 12074168.7939; train_masked_gp_l1_reg_loss: 79885.5670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108831.5617; train_chrom_access_recon_loss: 889031.5095; train_global_loss: 16033837.9695; train_optim_loss: 16033837.9695; val_kl_reg_loss: 89054.8182; val_edge_recon_loss: 2832709.5667; val_gene_expr_recon_loss: 12197941.3333; val_masked_gp_l1_reg_loss: 80850.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106808.0859; val_chrom_access_recon_loss: 897194.5708; val_global_loss: 16204558.2000; val_optim_loss: 16204558.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9286; val_auprc_score: 0.9137; val_best_acc_score: 0.8610; val_best_f1_score: 0.8698; train_kl_reg_loss: 87050.1121; train_edge_recon_loss: 2773366.1164; train_gene_expr_recon_loss: 11988808.6183; train_masked_gp_l1_reg_loss: 81296.5358; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103613.0055; train_chrom_access_recon_loss: 881511.0577; train_global_loss: 15915645.5267; train_optim_loss: 15915645.5267; val_kl_reg_loss: 84620.6219; val_edge_recon_loss: 2816323.1833; val_gene_expr_recon_loss: 12167724.7333; val_masked_gp_l1_reg_loss: 82092.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102365.2031; val_chrom_access_recon_loss: 894722.3625; val_global_loss: 16147847.9333; val_optim_loss: 16147847.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9370; val_auprc_score: 0.9210; val_best_acc_score: 0.8738; val_best_f1_score: 0.8805; train_kl_reg_loss: 83036.1438; train_edge_recon_loss: 2778852.4771; train_gene_expr_recon_loss: 11900448.1450; train_masked_gp_l1_reg_loss: 82703.7672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99458.2895; train_chrom_access_recon_loss: 875597.6221; train_global_loss: 15820096.5038; train_optim_loss: 15820096.5038; val_kl_reg_loss: 86623.5161; val_edge_recon_loss: 2771001.8167; val_gene_expr_recon_loss: 12037989.2000; val_masked_gp_l1_reg_loss: 83167.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97455.2891; val_chrom_access_recon_loss: 884519.3208; val_global_loss: 15960756.6000; val_optim_loss: 15960756.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9449; val_auprc_score: 0.9353; val_best_acc_score: 0.8793; val_best_f1_score: 0.8844; train_kl_reg_loss: 81721.3526; train_edge_recon_loss: 2772223.4332; train_gene_expr_recon_loss: 11840260.1298; train_masked_gp_l1_reg_loss: 83774.6505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96245.5160; train_chrom_access_recon_loss: 871288.0520; train_global_loss: 15745513.1069; train_optim_loss: 15745513.1069; val_kl_reg_loss: 78460.1974; val_edge_recon_loss: 2795197.3000; val_gene_expr_recon_loss: 11924505.7333; val_masked_gp_l1_reg_loss: 84304.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95559.2500; val_chrom_access_recon_loss: 880495.7792; val_global_loss: 15858521.9333; val_optim_loss: 15858521.9333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9432; val_auprc_score: 0.9302; val_best_acc_score: 0.8805; val_best_f1_score: 0.8852; train_kl_reg_loss: 79569.8223; train_edge_recon_loss: 2750849.2424; train_gene_expr_recon_loss: 11789606.9695; train_masked_gp_l1_reg_loss: 84822.4500; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94727.8442; train_chrom_access_recon_loss: 867903.4051; train_global_loss: 15667479.6641; train_optim_loss: 15667479.6641; val_kl_reg_loss: 79079.1344; val_edge_recon_loss: 2772555.9667; val_gene_expr_recon_loss: 11905131.7333; val_masked_gp_l1_reg_loss: 85500.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95209.3359; val_chrom_access_recon_loss: 876396.3833; val_global_loss: 15813873.1333; val_optim_loss: 15813873.1333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9432; val_auprc_score: 0.9268; val_best_acc_score: 0.8818; val_best_f1_score: 0.8881; train_kl_reg_loss: 78351.0421; train_edge_recon_loss: 2743174.7462; train_gene_expr_recon_loss: 11730547.0611; train_masked_gp_l1_reg_loss: 85957.9695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94589.2478; train_chrom_access_recon_loss: 863539.7634; train_global_loss: 15596159.8397; train_optim_loss: 15596159.8397; val_kl_reg_loss: 79738.3245; val_edge_recon_loss: 2742900.6333; val_gene_expr_recon_loss: 11884267.4000; val_masked_gp_l1_reg_loss: 86466.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95058.7031; val_chrom_access_recon_loss: 878114.2708; val_global_loss: 15766545.6000; val_optim_loss: 15766545.6000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9443; val_auprc_score: 0.9303; val_best_acc_score: 0.8816; val_best_f1_score: 0.8863; train_kl_reg_loss: 80069.8699; train_edge_recon_loss: 2729913.8244; train_gene_expr_recon_loss: 11678602.4275; train_masked_gp_l1_reg_loss: 86476.8077; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94679.6849; train_chrom_access_recon_loss: 859982.9203; train_global_loss: 15529725.6031; train_optim_loss: 15529725.6031; val_kl_reg_loss: 78030.9974; val_edge_recon_loss: 2749347.8500; val_gene_expr_recon_loss: 11837393.0667; val_masked_gp_l1_reg_loss: 86539.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95409.5469; val_chrom_access_recon_loss: 872004.1750; val_global_loss: 15718726.1333; val_optim_loss: 15718726.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9488; val_auprc_score: 0.9354; val_best_acc_score: 0.8887; val_best_f1_score: 0.8934; train_kl_reg_loss: 78491.5953; train_edge_recon_loss: 2724619.4256; train_gene_expr_recon_loss: 11638153.6107; train_masked_gp_l1_reg_loss: 86629.9606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94786.6031; train_chrom_access_recon_loss: 855669.2662; train_global_loss: 15478350.5191; train_optim_loss: 15478350.5191; val_kl_reg_loss: 79454.1948; val_edge_recon_loss: 2750151.3000; val_gene_expr_recon_loss: 11784986.9333; val_masked_gp_l1_reg_loss: 86871.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95044.2578; val_chrom_access_recon_loss: 864841.2833; val_global_loss: 15661349.6667; val_optim_loss: 15661349.6667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9479; val_auprc_score: 0.9344; val_best_acc_score: 0.8870; val_best_f1_score: 0.8920; train_kl_reg_loss: 76930.1078; train_edge_recon_loss: 2718385.9046; train_gene_expr_recon_loss: 11600447.1221; train_masked_gp_l1_reg_loss: 86848.2350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94732.4136; train_chrom_access_recon_loss: 852769.3287; train_global_loss: 15430113.0916; train_optim_loss: 15430113.0916; val_kl_reg_loss: 77604.5964; val_edge_recon_loss: 2759173.4167; val_gene_expr_recon_loss: 11701572.8667; val_masked_gp_l1_reg_loss: 86842.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95019.5625; val_chrom_access_recon_loss: 863005.2958; val_global_loss: 15583218.2667; val_optim_loss: 15583218.2667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9562; val_auprc_score: 0.9471; val_best_acc_score: 0.8938; val_best_f1_score: 0.8989; train_kl_reg_loss: 76741.2254; train_edge_recon_loss: 2717581.4599; train_gene_expr_recon_loss: 11559974.9771; train_masked_gp_l1_reg_loss: 86874.2682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94041.3565; train_chrom_access_recon_loss: 849737.5105; train_global_loss: 15384950.8244; train_optim_loss: 15384950.8244; val_kl_reg_loss: 76539.3161; val_edge_recon_loss: 2727224.7833; val_gene_expr_recon_loss: 11646596.2000; val_masked_gp_l1_reg_loss: 86901.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94226.3203; val_chrom_access_recon_loss: 855154.1875; val_global_loss: 15486641.2667; val_optim_loss: 15486641.2667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9571; val_auprc_score: 0.9447; val_best_acc_score: 0.9004; val_best_f1_score: 0.9053; train_kl_reg_loss: 76905.7559; train_edge_recon_loss: 2714076.1622; train_gene_expr_recon_loss: 11530862.3893; train_masked_gp_l1_reg_loss: 87010.4488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93639.4464; train_chrom_access_recon_loss: 847686.0048; train_global_loss: 15350180.1221; train_optim_loss: 15350180.1221; val_kl_reg_loss: 77219.2286; val_edge_recon_loss: 2716598.8667; val_gene_expr_recon_loss: 11688958.7333; val_masked_gp_l1_reg_loss: 87115.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93162.2266; val_chrom_access_recon_loss: 856679.7875; val_global_loss: 15519733.6000; val_optim_loss: 15519733.6000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9602; val_auprc_score: 0.9484; val_best_acc_score: 0.9043; val_best_f1_score: 0.9079; train_kl_reg_loss: 76067.1117; train_edge_recon_loss: 2712450.0725; train_gene_expr_recon_loss: 11496966.8244; train_masked_gp_l1_reg_loss: 87117.7190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93011.0234; train_chrom_access_recon_loss: 845017.8077; train_global_loss: 15310630.6947; train_optim_loss: 15310630.6947; val_kl_reg_loss: 77132.8417; val_edge_recon_loss: 2714725.0833; val_gene_expr_recon_loss: 11631603.1333; val_masked_gp_l1_reg_loss: 87137.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93196.1328; val_chrom_access_recon_loss: 858758.0833; val_global_loss: 15462553.0667; val_optim_loss: 15462553.0667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9623; val_auprc_score: 0.9545; val_best_acc_score: 0.9051; val_best_f1_score: 0.9073; train_kl_reg_loss: 75416.1864; train_edge_recon_loss: 2703076.2576; train_gene_expr_recon_loss: 11470895.7099; train_masked_gp_l1_reg_loss: 87107.9805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92464.3507; train_chrom_access_recon_loss: 842577.1999; train_global_loss: 15271537.8015; train_optim_loss: 15271537.8015; val_kl_reg_loss: 74643.4120; val_edge_recon_loss: 2730853.4833; val_gene_expr_recon_loss: 11597007.6000; val_masked_gp_l1_reg_loss: 87351.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92547.6250; val_chrom_access_recon_loss: 851830.2250; val_global_loss: 15434234.6667; val_optim_loss: 15434234.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9657; val_auprc_score: 0.9519; val_best_acc_score: 0.9139; val_best_f1_score: 0.9171; train_kl_reg_loss: 74433.9060; train_edge_recon_loss: 2697532.0821; train_gene_expr_recon_loss: 11450441.4351; train_masked_gp_l1_reg_loss: 87430.6375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92431.7870; train_chrom_access_recon_loss: 841848.4967; train_global_loss: 15244118.3969; train_optim_loss: 15244118.3969; val_kl_reg_loss: 72747.7099; val_edge_recon_loss: 2697173.1000; val_gene_expr_recon_loss: 11563542.6000; val_masked_gp_l1_reg_loss: 87369.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92459.2266; val_chrom_access_recon_loss: 854546.2208; val_global_loss: 15367837.5333; val_optim_loss: 15367837.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9652; val_auprc_score: 0.9547; val_best_acc_score: 0.9104; val_best_f1_score: 0.9123; train_kl_reg_loss: 75325.3521; train_edge_recon_loss: 2691058.5534; train_gene_expr_recon_loss: 11422064.4504; train_masked_gp_l1_reg_loss: 87361.0505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92243.3580; train_chrom_access_recon_loss: 839067.9141; train_global_loss: 15207120.7786; train_optim_loss: 15207120.7786; val_kl_reg_loss: 74908.1740; val_edge_recon_loss: 2706738.8833; val_gene_expr_recon_loss: 11601848.4000; val_masked_gp_l1_reg_loss: 87289.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91847.1016; val_chrom_access_recon_loss: 848860.9208; val_global_loss: 15411492.2000; val_optim_loss: 15411492.2000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9673; val_auprc_score: 0.9598; val_best_acc_score: 0.9113; val_best_f1_score: 0.9129; train_kl_reg_loss: 74379.1058; train_edge_recon_loss: 2693828.1698; train_gene_expr_recon_loss: 11399028.3511; train_masked_gp_l1_reg_loss: 87218.4689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92245.6719; train_chrom_access_recon_loss: 838063.2710; train_global_loss: 15184763.0305; train_optim_loss: 15184763.0305; val_kl_reg_loss: 75659.7146; val_edge_recon_loss: 2713029.5833; val_gene_expr_recon_loss: 11535023.3333; val_masked_gp_l1_reg_loss: 87153.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92425.3516; val_chrom_access_recon_loss: 851608.8958; val_global_loss: 15354900.6667; val_optim_loss: 15354900.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9652; val_auprc_score: 0.9536; val_best_acc_score: 0.9142; val_best_f1_score: 0.9171; train_kl_reg_loss: 73967.2132; train_edge_recon_loss: 2682085.3874; train_gene_expr_recon_loss: 11382167.9847; train_masked_gp_l1_reg_loss: 87114.4270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92398.8705; train_chrom_access_recon_loss: 835992.9585; train_global_loss: 15153726.8855; train_optim_loss: 15153726.8855; val_kl_reg_loss: 75263.3531; val_edge_recon_loss: 2704037.2000; val_gene_expr_recon_loss: 11523257.2667; val_masked_gp_l1_reg_loss: 87006.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92255.6797; val_chrom_access_recon_loss: 848631.9500; val_global_loss: 15330452.7333; val_optim_loss: 15330452.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9678; val_auprc_score: 0.9584; val_best_acc_score: 0.9143; val_best_f1_score: 0.9170; train_kl_reg_loss: 73970.0258; train_edge_recon_loss: 2685018.9733; train_gene_expr_recon_loss: 11356403.5496; train_masked_gp_l1_reg_loss: 86891.8132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92172.3016; train_chrom_access_recon_loss: 834250.7829; train_global_loss: 15128707.4046; train_optim_loss: 15128707.4046; val_kl_reg_loss: 73337.3010; val_edge_recon_loss: 2703735.0000; val_gene_expr_recon_loss: 11561019.0667; val_masked_gp_l1_reg_loss: 86822.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92570.0000; val_chrom_access_recon_loss: 853560.5083; val_global_loss: 15371043.8000; val_optim_loss: 15371043.8000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9701; val_auprc_score: 0.9615; val_best_acc_score: 0.9173; val_best_f1_score: 0.9199; train_kl_reg_loss: 73067.6502; train_edge_recon_loss: 2688885.8969; train_gene_expr_recon_loss: 11356827.8473; train_masked_gp_l1_reg_loss: 86727.5686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92581.0703; train_chrom_access_recon_loss: 833588.8287; train_global_loss: 15131678.8855; train_optim_loss: 15131678.8855; val_kl_reg_loss: 72163.2854; val_edge_recon_loss: 2706693.2000; val_gene_expr_recon_loss: 11478090.1333; val_masked_gp_l1_reg_loss: 86562.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92496.2344; val_chrom_access_recon_loss: 843651.8500; val_global_loss: 15279656.4667; val_optim_loss: 15279656.4667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9689; val_auprc_score: 0.9596; val_best_acc_score: 0.9179; val_best_f1_score: 0.9203; train_kl_reg_loss: 72131.8504; train_edge_recon_loss: 2686642.9790; train_gene_expr_recon_loss: 11328662.2443; train_masked_gp_l1_reg_loss: 86579.9045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92552.2578; train_chrom_access_recon_loss: 831727.2915; train_global_loss: 15098296.4580; train_optim_loss: 15098296.4580; val_kl_reg_loss: 73740.3479; val_edge_recon_loss: 2697709.1500; val_gene_expr_recon_loss: 11508623.6667; val_masked_gp_l1_reg_loss: 86398.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92326.6094; val_chrom_access_recon_loss: 845615.9667; val_global_loss: 15304413.9333; val_optim_loss: 15304413.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9674; val_auprc_score: 0.9588; val_best_acc_score: 0.9140; val_best_f1_score: 0.9177; train_kl_reg_loss: 84463.6790; train_edge_recon_loss: 2732418.7271; train_gene_expr_recon_loss: 10358247.1679; train_masked_gp_l1_reg_loss: 85617.1159; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89750.0764; train_chrom_access_recon_loss: 761602.1589; train_global_loss: 14112098.9237; train_optim_loss: 14112098.9237; val_kl_reg_loss: 37322.0849; val_edge_recon_loss: 2718942.9167; val_gene_expr_recon_loss: 10454563.0667; val_masked_gp_l1_reg_loss: 84722.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91723.8984; val_chrom_access_recon_loss: 767839.9208; val_global_loss: 14155113.8667; val_optim_loss: 14155113.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9711; val_auprc_score: 0.9623; val_best_acc_score: 0.9202; val_best_f1_score: 0.9225; train_kl_reg_loss: 66625.7733; train_edge_recon_loss: 2694027.9065; train_gene_expr_recon_loss: 10311461.1374; train_masked_gp_l1_reg_loss: 82868.0815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92162.5457; train_chrom_access_recon_loss: 756409.3492; train_global_loss: 14003554.7939; train_optim_loss: 14003554.7939; val_kl_reg_loss: 43359.3299; val_edge_recon_loss: 2683081.9667; val_gene_expr_recon_loss: 10445988.6667; val_masked_gp_l1_reg_loss: 80801.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92378.0391; val_chrom_access_recon_loss: 769326.6542; val_global_loss: 14114936.8667; val_optim_loss: 14114936.8667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9707; val_auprc_score: 0.9631; val_best_acc_score: 0.9178; val_best_f1_score: 0.9202; train_kl_reg_loss: 60713.0705; train_edge_recon_loss: 2683773.4809; train_gene_expr_recon_loss: 10296213.5191; train_masked_gp_l1_reg_loss: 79024.3587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92410.0362; train_chrom_access_recon_loss: 755784.6045; train_global_loss: 13967919.0611; train_optim_loss: 13967919.0611; val_kl_reg_loss: 48048.0339; val_edge_recon_loss: 2701929.3667; val_gene_expr_recon_loss: 10398874.3333; val_masked_gp_l1_reg_loss: 77057.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92081.1328; val_chrom_access_recon_loss: 764459.5750; val_global_loss: 14082450.2667; val_optim_loss: 14082450.2667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9678; val_auprc_score: 0.9558; val_best_acc_score: 0.9169; val_best_f1_score: 0.9186; train_kl_reg_loss: 59572.3798; train_edge_recon_loss: 2684988.4771; train_gene_expr_recon_loss: 10265458.0382; train_masked_gp_l1_reg_loss: 75448.5424; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92182.4352; train_chrom_access_recon_loss: 753745.7543; train_global_loss: 13931395.6031; train_optim_loss: 13931395.6031; val_kl_reg_loss: 49019.1833; val_edge_recon_loss: 2714475.6833; val_gene_expr_recon_loss: 10352412.3333; val_masked_gp_l1_reg_loss: 74165.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92224.1172; val_chrom_access_recon_loss: 758762.4250; val_global_loss: 14041059.6000; val_optim_loss: 14041059.6000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9687; val_auprc_score: 0.9567; val_best_acc_score: 0.9200; val_best_f1_score: 0.9215; train_kl_reg_loss: 58378.1958; train_edge_recon_loss: 2677110.4580; train_gene_expr_recon_loss: 10234254.8473; train_masked_gp_l1_reg_loss: 72987.7818; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92130.2371; train_chrom_access_recon_loss: 749868.9552; train_global_loss: 13884730.4427; train_optim_loss: 13884730.4427; val_kl_reg_loss: 49419.0924; val_edge_recon_loss: 2700949.1500; val_gene_expr_recon_loss: 10325048.7333; val_masked_gp_l1_reg_loss: 71916.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92192.3672; val_chrom_access_recon_loss: 757738.3375; val_global_loss: 13997263.3333; val_optim_loss: 13997263.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9734; val_auprc_score: 0.9616; val_best_acc_score: 0.9272; val_best_f1_score: 0.9295; train_kl_reg_loss: 57099.7287; train_edge_recon_loss: 2678681.7729; train_gene_expr_recon_loss: 10224974.6565; train_masked_gp_l1_reg_loss: 71056.1664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92083.4143; train_chrom_access_recon_loss: 751018.9747; train_global_loss: 13874914.7557; train_optim_loss: 13874914.7557; val_kl_reg_loss: 51973.2779; val_edge_recon_loss: 2662792.6000; val_gene_expr_recon_loss: 10304311.2000; val_masked_gp_l1_reg_loss: 70290.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92191.1094; val_chrom_access_recon_loss: 756420.3125; val_global_loss: 13937979.4000; val_optim_loss: 13937979.4000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9705; val_auprc_score: 0.9599; val_best_acc_score: 0.9227; val_best_f1_score: 0.9248; train_kl_reg_loss: 57053.7362; train_edge_recon_loss: 2680245.1832; train_gene_expr_recon_loss: 10195278.3206; train_masked_gp_l1_reg_loss: 69559.8312; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91721.1385; train_chrom_access_recon_loss: 749421.4857; train_global_loss: 13843279.8168; train_optim_loss: 13843279.8168; val_kl_reg_loss: 52150.5359; val_edge_recon_loss: 2701076.2167; val_gene_expr_recon_loss: 10382968.5333; val_masked_gp_l1_reg_loss: 68996.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91970.5469; val_chrom_access_recon_loss: 766191.0625; val_global_loss: 14063354.4000; val_optim_loss: 14063354.4000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9724; val_auprc_score: 0.9629; val_best_acc_score: 0.9220; val_best_f1_score: 0.9256; train_kl_reg_loss: 56125.2752; train_edge_recon_loss: 2681404.5153; train_gene_expr_recon_loss: 10185176.1679; train_masked_gp_l1_reg_loss: 68590.6565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91819.5391; train_chrom_access_recon_loss: 749060.7581; train_global_loss: 13832176.8550; train_optim_loss: 13832176.8550; val_kl_reg_loss: 54493.8922; val_edge_recon_loss: 2680707.5167; val_gene_expr_recon_loss: 10331684.5333; val_masked_gp_l1_reg_loss: 68140.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91627.7109; val_chrom_access_recon_loss: 759987.3125; val_global_loss: 13986641.2000; val_optim_loss: 13986641.2000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9718; val_auprc_score: 0.9602; val_best_acc_score: 0.9241; val_best_f1_score: 0.9263; train_kl_reg_loss: 56635.9952; train_edge_recon_loss: 2673693.2576; train_gene_expr_recon_loss: 10182326.6260; train_masked_gp_l1_reg_loss: 67734.3801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91411.4723; train_chrom_access_recon_loss: 748433.0291; train_global_loss: 13820234.7710; train_optim_loss: 13820234.7710; val_kl_reg_loss: 52746.4638; val_edge_recon_loss: 2674092.7833; val_gene_expr_recon_loss: 10301111.6667; val_masked_gp_l1_reg_loss: 67421.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91440.8125; val_chrom_access_recon_loss: 757764.2250; val_global_loss: 13944577.0667; val_optim_loss: 13944577.0667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9710; val_auprc_score: 0.9565; val_best_acc_score: 0.9256; val_best_f1_score: 0.9279; train_kl_reg_loss: 56162.0124; train_edge_recon_loss: 2668553.1775; train_gene_expr_recon_loss: 10171060.7557; train_masked_gp_l1_reg_loss: 66956.8990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91522.4753; train_chrom_access_recon_loss: 747089.5229; train_global_loss: 13801344.8855; train_optim_loss: 13801344.8855; val_kl_reg_loss: 53482.6172; val_edge_recon_loss: 2680342.1667; val_gene_expr_recon_loss: 10319303.1333; val_masked_gp_l1_reg_loss: 66531.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91703.5547; val_chrom_access_recon_loss: 757393.4750; val_global_loss: 13968756.4000; val_optim_loss: 13968756.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9755; val_auprc_score: 0.9682; val_best_acc_score: 0.9287; val_best_f1_score: 0.9306; train_kl_reg_loss: 57845.0168; train_edge_recon_loss: 2668342.1298; train_gene_expr_recon_loss: 10149195.8244; train_masked_gp_l1_reg_loss: 65777.9792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73333.1842; train_chrom_access_recon_loss: 743619.1498; train_global_loss: 13758113.2901; train_optim_loss: 13758113.2901; val_kl_reg_loss: 55049.8393; val_edge_recon_loss: 2670222.4167; val_gene_expr_recon_loss: 10287556.0667; val_masked_gp_l1_reg_loss: 65548.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70536.8047; val_chrom_access_recon_loss: 751589.6417; val_global_loss: 13900503.8667; val_optim_loss: 13900503.8667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9720; val_auprc_score: 0.9616; val_best_acc_score: 0.9282; val_best_f1_score: 0.9307; train_kl_reg_loss: 59211.9170; train_edge_recon_loss: 2664376.0496; train_gene_expr_recon_loss: 10152853.8702; train_masked_gp_l1_reg_loss: 65461.9363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69938.7105; train_chrom_access_recon_loss: 744051.1469; train_global_loss: 13755893.6565; train_optim_loss: 13755893.6565; val_kl_reg_loss: 55440.8911; val_edge_recon_loss: 2677027.2833; val_gene_expr_recon_loss: 10274208.8667; val_masked_gp_l1_reg_loss: 65374.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69382.8906; val_chrom_access_recon_loss: 754846.8875; val_global_loss: 13896281.0667; val_optim_loss: 13896281.0667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9716; val_auprc_score: 0.9614; val_best_acc_score: 0.9241; val_best_f1_score: 0.9268; train_kl_reg_loss: 59174.0429; train_edge_recon_loss: 2666333.0935; train_gene_expr_recon_loss: 10127335.8550; train_masked_gp_l1_reg_loss: 65313.6418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69061.0714; train_chrom_access_recon_loss: 742053.8721; train_global_loss: 13729271.5649; train_optim_loss: 13729271.5649; val_kl_reg_loss: 55895.7253; val_edge_recon_loss: 2691115.2167; val_gene_expr_recon_loss: 10247101.3333; val_masked_gp_l1_reg_loss: 65244.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68703.4062; val_chrom_access_recon_loss: 751929.3417; val_global_loss: 13879988.5333; val_optim_loss: 13879988.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9728; val_auprc_score: 0.9629; val_best_acc_score: 0.9276; val_best_f1_score: 0.9298; train_kl_reg_loss: 59846.8172; train_edge_recon_loss: 2661845.0134; train_gene_expr_recon_loss: 10144470.7481; train_masked_gp_l1_reg_loss: 65202.3799; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68431.2780; train_chrom_access_recon_loss: 743499.9494; train_global_loss: 13743296.1221; train_optim_loss: 13743296.1221; val_kl_reg_loss: 55649.7273; val_edge_recon_loss: 2670508.8333; val_gene_expr_recon_loss: 10300242.6000; val_masked_gp_l1_reg_loss: 65136.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68306.0156; val_chrom_access_recon_loss: 753003.4375; val_global_loss: 13912847.7333; val_optim_loss: 13912847.7333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9728; val_auprc_score: 0.9649; val_best_acc_score: 0.9248; val_best_f1_score: 0.9270; train_kl_reg_loss: 59739.0467; train_edge_recon_loss: 2664503.4065; train_gene_expr_recon_loss: 10143191.1527; train_masked_gp_l1_reg_loss: 65090.9143; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68126.0745; train_chrom_access_recon_loss: 742479.3173; train_global_loss: 13743129.9313; train_optim_loss: 13743129.9313; val_kl_reg_loss: 54992.8672; val_edge_recon_loss: 2690963.6167; val_gene_expr_recon_loss: 10230940.4667; val_masked_gp_l1_reg_loss: 65042.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67889.4766; val_chrom_access_recon_loss: 750405.8167; val_global_loss: 13860234.0667; val_optim_loss: 13860234.0667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9728; val_auprc_score: 0.9623; val_best_acc_score: 0.9290; val_best_f1_score: 0.9308; train_kl_reg_loss: 59275.7684; train_edge_recon_loss: 2662859.8435; train_gene_expr_recon_loss: 10135432.0840; train_masked_gp_l1_reg_loss: 64988.1616; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67706.8845; train_chrom_access_recon_loss: 743033.4809; train_global_loss: 13733296.2061; train_optim_loss: 13733296.2061; val_kl_reg_loss: 55482.4812; val_edge_recon_loss: 2681751.4000; val_gene_expr_recon_loss: 10276844.6000; val_masked_gp_l1_reg_loss: 64965.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67597.0312; val_chrom_access_recon_loss: 752479.1208; val_global_loss: 13899119.4667; val_optim_loss: 13899119.4667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9739; val_auprc_score: 0.9642; val_best_acc_score: 0.9266; val_best_f1_score: 0.9290; train_kl_reg_loss: 59300.4111; train_edge_recon_loss: 2661087.8111; train_gene_expr_recon_loss: 10140483.0153; train_masked_gp_l1_reg_loss: 64909.9682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67393.8833; train_chrom_access_recon_loss: 743247.6980; train_global_loss: 13736422.7099; train_optim_loss: 13736422.7099; val_kl_reg_loss: 55054.7951; val_edge_recon_loss: 2687812.7167; val_gene_expr_recon_loss: 10260504.7333; val_masked_gp_l1_reg_loss: 64856.2148; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67190.8516; val_chrom_access_recon_loss: 754541.3500; val_global_loss: 13889960.4000; val_optim_loss: 13889960.4000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9778; val_auprc_score: 0.9705; val_best_acc_score: 0.9341; val_best_f1_score: 0.9354; train_kl_reg_loss: 59003.1127; train_edge_recon_loss: 2667045.8225; train_gene_expr_recon_loss: 10142446.6489; train_masked_gp_l1_reg_loss: 64815.5277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67137.9909; train_chrom_access_recon_loss: 743445.9871; train_global_loss: 13743894.9695; train_optim_loss: 13743894.9695; val_kl_reg_loss: 54657.8602; val_edge_recon_loss: 2649511.1167; val_gene_expr_recon_loss: 10233089.8000; val_masked_gp_l1_reg_loss: 64772.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66869.0625; val_chrom_access_recon_loss: 752226.2458; val_global_loss: 13821127.2667; val_optim_loss: 13821127.2667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9732; val_auprc_score: 0.9649; val_best_acc_score: 0.9271; val_best_f1_score: 0.9295; train_kl_reg_loss: 59390.7977; train_edge_recon_loss: 2663150.5630; train_gene_expr_recon_loss: 10133961.0534; train_masked_gp_l1_reg_loss: 64728.0936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66809.3347; train_chrom_access_recon_loss: 742213.7276; train_global_loss: 13730253.5115; train_optim_loss: 13730253.5115; val_kl_reg_loss: 55638.4755; val_edge_recon_loss: 2684594.9000; val_gene_expr_recon_loss: 10273267.2000; val_masked_gp_l1_reg_loss: 64685.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66569.6094; val_chrom_access_recon_loss: 754247.8750; val_global_loss: 13899004.4667; val_optim_loss: 13899004.4667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9724; val_auprc_score: 0.9618; val_best_acc_score: 0.9267; val_best_f1_score: 0.9286; train_kl_reg_loss: 59613.7026; train_edge_recon_loss: 2665008.0324; train_gene_expr_recon_loss: 10132344.3206; train_masked_gp_l1_reg_loss: 64632.6101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66471.4843; train_chrom_access_recon_loss: 742346.3740; train_global_loss: 13730416.4427; train_optim_loss: 13730416.4427; val_kl_reg_loss: 55783.4185; val_edge_recon_loss: 2683675.4333; val_gene_expr_recon_loss: 10246749.5333; val_masked_gp_l1_reg_loss: 64594.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66256.5078; val_chrom_access_recon_loss: 753665.6000; val_global_loss: 13870725.0667; val_optim_loss: 13870725.0667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9729; val_auprc_score: 0.9657; val_best_acc_score: 0.9255; val_best_f1_score: 0.9270; train_kl_reg_loss: 59305.4370; train_edge_recon_loss: 2663670.0573; train_gene_expr_recon_loss: 10131351.4504; train_masked_gp_l1_reg_loss: 64559.0086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66094.2032; train_chrom_access_recon_loss: 742892.5491; train_global_loss: 13727872.6947; train_optim_loss: 13727872.6947; val_kl_reg_loss: 56441.7674; val_edge_recon_loss: 2688288.3667; val_gene_expr_recon_loss: 10257327.4000; val_masked_gp_l1_reg_loss: 64511.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66035.0781; val_chrom_access_recon_loss: 751164.9958; val_global_loss: 13883768.4000; val_optim_loss: 13883768.4000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9746; val_auprc_score: 0.9660; val_best_acc_score: 0.9289; val_best_f1_score: 0.9306; train_kl_reg_loss: 59368.7804; train_edge_recon_loss: 2666224.1050; train_gene_expr_recon_loss: 10133866.0305; train_masked_gp_l1_reg_loss: 64460.9759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65901.9312; train_chrom_access_recon_loss: 742962.6431; train_global_loss: 13732784.5344; train_optim_loss: 13732784.5344; val_kl_reg_loss: 56112.1862; val_edge_recon_loss: 2680190.2000; val_gene_expr_recon_loss: 10293131.4000; val_masked_gp_l1_reg_loss: 64442.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65811.9141; val_chrom_access_recon_loss: 753175.0125; val_global_loss: 13912862.8000; val_optim_loss: 13912862.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9750; val_auprc_score: 0.9678; val_best_acc_score: 0.9286; val_best_f1_score: 0.9309; train_kl_reg_loss: 59372.7165; train_edge_recon_loss: 2665325.3569; train_gene_expr_recon_loss: 10126176.8092; train_masked_gp_l1_reg_loss: 64363.7313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63889.5313; train_chrom_access_recon_loss: 742063.2090; train_global_loss: 13721191.3511; train_optim_loss: 13721191.3511; val_kl_reg_loss: 56326.7812; val_edge_recon_loss: 2677685.1667; val_gene_expr_recon_loss: 10260070.7333; val_masked_gp_l1_reg_loss: 64334.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63604.6914; val_chrom_access_recon_loss: 750159.7583; val_global_loss: 13872182.2667; val_optim_loss: 13872182.2667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9751; val_auprc_score: 0.9663; val_best_acc_score: 0.9286; val_best_f1_score: 0.9315; train_kl_reg_loss: 59439.2691; train_edge_recon_loss: 2663622.7538; train_gene_expr_recon_loss: 10129823.2595; train_masked_gp_l1_reg_loss: 64321.6263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63513.7883; train_chrom_access_recon_loss: 742499.0673; train_global_loss: 13723219.7863; train_optim_loss: 13723219.7863; val_kl_reg_loss: 56873.8018; val_edge_recon_loss: 2678628.7167; val_gene_expr_recon_loss: 10255875.4667; val_masked_gp_l1_reg_loss: 64310.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63444.6016; val_chrom_access_recon_loss: 752753.5333; val_global_loss: 13871887.7333; val_optim_loss: 13871887.7333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9754; val_auprc_score: 0.9665; val_best_acc_score: 0.9274; val_best_f1_score: 0.9295; train_kl_reg_loss: 59533.2313; train_edge_recon_loss: 2666669.1870; train_gene_expr_recon_loss: 10124255.3588; train_masked_gp_l1_reg_loss: 64302.1320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63383.1408; train_chrom_access_recon_loss: 741785.0654; train_global_loss: 13719928.0458; train_optim_loss: 13719928.0458; val_kl_reg_loss: 56455.3641; val_edge_recon_loss: 2679134.3833; val_gene_expr_recon_loss: 10297211.6667; val_masked_gp_l1_reg_loss: 64294.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63330.8711; val_chrom_access_recon_loss: 754860.9875; val_global_loss: 13915288.4667; val_optim_loss: 13915288.4667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9721; val_auprc_score: 0.9646; val_best_acc_score: 0.9245; val_best_f1_score: 0.9267; train_kl_reg_loss: 59795.3633; train_edge_recon_loss: 2666477.3225; train_gene_expr_recon_loss: 10125752.2824; train_masked_gp_l1_reg_loss: 64288.8475; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63287.5639; train_chrom_access_recon_loss: 742793.2448; train_global_loss: 13722394.6718; train_optim_loss: 13722394.6718; val_kl_reg_loss: 56806.3753; val_edge_recon_loss: 2710087.6667; val_gene_expr_recon_loss: 10260976.2000; val_masked_gp_l1_reg_loss: 64281.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63248.7344; val_chrom_access_recon_loss: 752134.6667; val_global_loss: 13907535.0667; val_optim_loss: 13907535.0667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 13 sec.
Using best model state, which was in epoch 43.

--- MODEL EVALUATION ---
val AUROC score: 0.9758
val AUPRC score: 0.9689
val best accuracy score: 0.9301
val best F1 score: 0.9310
val target rna MSE score: 2.0449
val source rna MSE score: 0.6542
val target atac MSE score: 0.5264
val source atac MSE score: 0.1607
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
