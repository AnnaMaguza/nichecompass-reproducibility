[True]
Run timestamp: 10102023_072310_183.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_183']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7384; val_auprc_score: 0.7067; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 84175.5752; train_edge_recon_loss: 766740.0237; train_gene_expr_recon_loss: 23123743.9394; train_masked_gp_l1_reg_loss: 36176.4798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4128186.5871; train_chrom_access_recon_loss: 2309363.8258; train_global_loss: 30448386.0606; train_optim_loss: 30448386.0606; val_kl_reg_loss: 100488.4082; val_edge_recon_loss: 813129.7109; val_gene_expr_recon_loss: 21362268.7500; val_masked_gp_l1_reg_loss: 38315.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2895734.2500; val_chrom_access_recon_loss: 2211448.4375; val_global_loss: 27421385.2500; val_optim_loss: 27421385.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7494; val_auprc_score: 0.7341; val_best_acc_score: 0.6467; val_best_f1_score: 0.7153; train_kl_reg_loss: 97310.4505; train_edge_recon_loss: 753047.0578; train_gene_expr_recon_loss: 21233264.0909; train_masked_gp_l1_reg_loss: 38885.4621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1962330.0852; train_chrom_access_recon_loss: 2199681.4356; train_global_loss: 26284518.7273; train_optim_loss: 26284518.7273; val_kl_reg_loss: 91803.1768; val_edge_recon_loss: 810932.7656; val_gene_expr_recon_loss: 20908849.7500; val_masked_gp_l1_reg_loss: 39842.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1226192.8750; val_chrom_access_recon_loss: 2173522.3438; val_global_loss: 25251142.0000; val_optim_loss: 25251142.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8224; val_auprc_score: 0.7929; val_best_acc_score: 0.7112; val_best_f1_score: 0.7624; train_kl_reg_loss: 83498.0286; train_edge_recon_loss: 736946.0890; train_gene_expr_recon_loss: 21025582.4848; train_masked_gp_l1_reg_loss: 41038.2278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 858181.9223; train_chrom_access_recon_loss: 2184856.3182; train_global_loss: 24930103.0303; train_optim_loss: 24930103.0303; val_kl_reg_loss: 71168.1875; val_edge_recon_loss: 793748.7656; val_gene_expr_recon_loss: 20924483.2500; val_masked_gp_l1_reg_loss: 42450.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 588179.3125; val_chrom_access_recon_loss: 2169995.9688; val_global_loss: 24590026.2500; val_optim_loss: 24590026.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8737; val_auprc_score: 0.8422; val_best_acc_score: 0.8036; val_best_f1_score: 0.8191; train_kl_reg_loss: 73463.8274; train_edge_recon_loss: 720828.8485; train_gene_expr_recon_loss: 20872160.6364; train_masked_gp_l1_reg_loss: 43722.1668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 454935.7955; train_chrom_access_recon_loss: 2173283.4375; train_global_loss: 24338394.7879; train_optim_loss: 24338394.7879; val_kl_reg_loss: 72856.0488; val_edge_recon_loss: 743527.5469; val_gene_expr_recon_loss: 20666627.7500; val_masked_gp_l1_reg_loss: 45006.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 353447.9688; val_chrom_access_recon_loss: 2165896.6562; val_global_loss: 24047362.0000; val_optim_loss: 24047362.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9026; val_auprc_score: 0.8778; val_best_acc_score: 0.8243; val_best_f1_score: 0.8363; train_kl_reg_loss: 73795.6205; train_edge_recon_loss: 676403.0938; train_gene_expr_recon_loss: 20717425.8788; train_masked_gp_l1_reg_loss: 46203.3294; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 294375.7893; train_chrom_access_recon_loss: 2161097.8201; train_global_loss: 23969301.6667; train_optim_loss: 23969301.6667; val_kl_reg_loss: 77733.0723; val_edge_recon_loss: 651058.6562; val_gene_expr_recon_loss: 20624776.2500; val_masked_gp_l1_reg_loss: 47453.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 247462.3281; val_chrom_access_recon_loss: 2166059.4062; val_global_loss: 23814543.5000; val_optim_loss: 23814543.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8974; val_auprc_score: 0.8664; val_best_acc_score: 0.8318; val_best_f1_score: 0.8430; train_kl_reg_loss: 81610.8281; train_edge_recon_loss: 636040.5625; train_gene_expr_recon_loss: 20570972.0000; train_masked_gp_l1_reg_loss: 48563.1563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 215831.0779; train_chrom_access_recon_loss: 2146601.5152; train_global_loss: 23699618.9091; train_optim_loss: 23699618.9091; val_kl_reg_loss: 76480.6963; val_edge_recon_loss: 638257.8359; val_gene_expr_recon_loss: 20249113.0000; val_masked_gp_l1_reg_loss: 49802.5664; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 189364.5938; val_chrom_access_recon_loss: 2124016.1250; val_global_loss: 23327033.7500; val_optim_loss: 23327033.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9048; val_auprc_score: 0.8808; val_best_acc_score: 0.8348; val_best_f1_score: 0.8497; train_kl_reg_loss: 79108.1289; train_edge_recon_loss: 623383.1439; train_gene_expr_recon_loss: 20463010.5455; train_masked_gp_l1_reg_loss: 50880.7174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170384.7564; train_chrom_access_recon_loss: 2137189.6742; train_global_loss: 23523956.9394; train_optim_loss: 23523956.9394; val_kl_reg_loss: 78472.2812; val_edge_recon_loss: 624355.1250; val_gene_expr_recon_loss: 20349744.5000; val_masked_gp_l1_reg_loss: 52018.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 155476.1406; val_chrom_access_recon_loss: 2133001.9219; val_global_loss: 23393067.7500; val_optim_loss: 23393067.7500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9086; val_auprc_score: 0.8894; val_best_acc_score: 0.8375; val_best_f1_score: 0.8527; train_kl_reg_loss: 77134.6044; train_edge_recon_loss: 618659.5881; train_gene_expr_recon_loss: 20392293.2727; train_masked_gp_l1_reg_loss: 52776.4612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144034.1129; train_chrom_access_recon_loss: 2131130.5890; train_global_loss: 23416028.6364; train_optim_loss: 23416028.6364; val_kl_reg_loss: 73423.9668; val_edge_recon_loss: 617636.6328; val_gene_expr_recon_loss: 20157555.2500; val_masked_gp_l1_reg_loss: 53653.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135630.2656; val_chrom_access_recon_loss: 2110784.2031; val_global_loss: 23148684.5000; val_optim_loss: 23148684.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9112; val_auprc_score: 0.8849; val_best_acc_score: 0.8509; val_best_f1_score: 0.8595; train_kl_reg_loss: 75136.6596; train_edge_recon_loss: 607786.9631; train_gene_expr_recon_loss: 20287263.0303; train_masked_gp_l1_reg_loss: 54409.8597; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128406.8333; train_chrom_access_recon_loss: 2121181.6648; train_global_loss: 23274184.8788; train_optim_loss: 23274184.8788; val_kl_reg_loss: 71693.0225; val_edge_recon_loss: 617433.4219; val_gene_expr_recon_loss: 20237258.7500; val_masked_gp_l1_reg_loss: 55253.6133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121911.7656; val_chrom_access_recon_loss: 2121193.6875; val_global_loss: 23224745.0000; val_optim_loss: 23224745.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9201; val_auprc_score: 0.8931; val_best_acc_score: 0.8530; val_best_f1_score: 0.8614; train_kl_reg_loss: 72834.1209; train_edge_recon_loss: 608576.3116; train_gene_expr_recon_loss: 20198909.1818; train_masked_gp_l1_reg_loss: 55800.7363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117025.4978; train_chrom_access_recon_loss: 2113245.4830; train_global_loss: 23166391.5152; train_optim_loss: 23166391.5152; val_kl_reg_loss: 68187.4463; val_edge_recon_loss: 611716.0469; val_gene_expr_recon_loss: 20062843.5000; val_masked_gp_l1_reg_loss: 56568.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113136.7734; val_chrom_access_recon_loss: 2093475.8594; val_global_loss: 23005926.7500; val_optim_loss: 23005926.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9238; val_auprc_score: 0.9011; val_best_acc_score: 0.8546; val_best_f1_score: 0.8653; train_kl_reg_loss: 71240.1671; train_edge_recon_loss: 602222.7301; train_gene_expr_recon_loss: 20124887.0000; train_masked_gp_l1_reg_loss: 57195.5566; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108497.9491; train_chrom_access_recon_loss: 2106893.3333; train_global_loss: 23070936.7576; train_optim_loss: 23070936.7576; val_kl_reg_loss: 70874.2812; val_edge_recon_loss: 605030.8984; val_gene_expr_recon_loss: 20247623.0000; val_masked_gp_l1_reg_loss: 57965.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105503.6719; val_chrom_access_recon_loss: 2126246.1875; val_global_loss: 23213244.2500; val_optim_loss: 23213244.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9301; val_auprc_score: 0.9088; val_best_acc_score: 0.8600; val_best_f1_score: 0.8699; train_kl_reg_loss: 69717.2913; train_edge_recon_loss: 598561.9621; train_gene_expr_recon_loss: 20038957.3333; train_masked_gp_l1_reg_loss: 58543.5750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102108.5935; train_chrom_access_recon_loss: 2098096.7557; train_global_loss: 22965985.4242; train_optim_loss: 22965985.4242; val_kl_reg_loss: 68349.5693; val_edge_recon_loss: 602118.9844; val_gene_expr_recon_loss: 19932340.7500; val_masked_gp_l1_reg_loss: 59168.3164; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98732.3906; val_chrom_access_recon_loss: 2088001.1719; val_global_loss: 22848710.2500; val_optim_loss: 22848710.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9291; val_auprc_score: 0.9045; val_best_acc_score: 0.8649; val_best_f1_score: 0.8695; train_kl_reg_loss: 68126.0516; train_edge_recon_loss: 595185.1231; train_gene_expr_recon_loss: 19996294.3939; train_masked_gp_l1_reg_loss: 59663.7868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96667.1155; train_chrom_access_recon_loss: 2092911.3693; train_global_loss: 22908847.8485; train_optim_loss: 22908847.8485; val_kl_reg_loss: 68099.9102; val_edge_recon_loss: 593406.5625; val_gene_expr_recon_loss: 20249230.7500; val_masked_gp_l1_reg_loss: 60368.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95025.8750; val_chrom_access_recon_loss: 2125181.7656; val_global_loss: 23191313.2500; val_optim_loss: 23191313.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9366; val_auprc_score: 0.9142; val_best_acc_score: 0.8721; val_best_f1_score: 0.8792; train_kl_reg_loss: 66528.3598; train_edge_recon_loss: 595243.8627; train_gene_expr_recon_loss: 19927846.3030; train_masked_gp_l1_reg_loss: 60817.9083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93036.3434; train_chrom_access_recon_loss: 2087911.7367; train_global_loss: 22831384.5455; train_optim_loss: 22831384.5455; val_kl_reg_loss: 65053.5850; val_edge_recon_loss: 597135.8203; val_gene_expr_recon_loss: 19653109.2500; val_masked_gp_l1_reg_loss: 61350.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91602.7031; val_chrom_access_recon_loss: 2083545.2344; val_global_loss: 22551796.5000; val_optim_loss: 22551796.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9412; val_auprc_score: 0.9210; val_best_acc_score: 0.8791; val_best_f1_score: 0.8839; train_kl_reg_loss: 65778.3613; train_edge_recon_loss: 592215.0445; train_gene_expr_recon_loss: 19849258.3636; train_masked_gp_l1_reg_loss: 61857.9856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89908.1074; train_chrom_access_recon_loss: 2079383.3466; train_global_loss: 22738401.0909; train_optim_loss: 22738401.0909; val_kl_reg_loss: 65099.4717; val_edge_recon_loss: 593178.8125; val_gene_expr_recon_loss: 19647167.0000; val_masked_gp_l1_reg_loss: 62372.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88609.9453; val_chrom_access_recon_loss: 2050359.9375; val_global_loss: 22506787.2500; val_optim_loss: 22506787.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9479; val_auprc_score: 0.9352; val_best_acc_score: 0.8861; val_best_f1_score: 0.8905; train_kl_reg_loss: 64431.2512; train_edge_recon_loss: 590369.0133; train_gene_expr_recon_loss: 19801305.5758; train_masked_gp_l1_reg_loss: 62874.6158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87634.0900; train_chrom_access_recon_loss: 2074826.5019; train_global_loss: 22681441.2121; train_optim_loss: 22681441.2121; val_kl_reg_loss: 64012.0645; val_edge_recon_loss: 588190.7891; val_gene_expr_recon_loss: 19909362.2500; val_masked_gp_l1_reg_loss: 63256.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86420.8359; val_chrom_access_recon_loss: 2086311.9375; val_global_loss: 22797553.0000; val_optim_loss: 22797553.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9452; val_auprc_score: 0.9272; val_best_acc_score: 0.8831; val_best_f1_score: 0.8901; train_kl_reg_loss: 63848.8105; train_edge_recon_loss: 587454.4100; train_gene_expr_recon_loss: 19737918.2121; train_masked_gp_l1_reg_loss: 63735.3309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85651.8100; train_chrom_access_recon_loss: 2067809.3636; train_global_loss: 22606417.7273; train_optim_loss: 22606417.7273; val_kl_reg_loss: 63379.8247; val_edge_recon_loss: 596169.4375; val_gene_expr_recon_loss: 19818168.2500; val_masked_gp_l1_reg_loss: 64352.4727; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85298.9688; val_chrom_access_recon_loss: 2083974.4375; val_global_loss: 22711341.7500; val_optim_loss: 22711341.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9444; val_auprc_score: 0.9273; val_best_acc_score: 0.8834; val_best_f1_score: 0.8892; train_kl_reg_loss: 62882.4906; train_edge_recon_loss: 586680.5691; train_gene_expr_recon_loss: 19696160.5455; train_masked_gp_l1_reg_loss: 64736.4621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84429.8879; train_chrom_access_recon_loss: 2063620.2159; train_global_loss: 22558509.8788; train_optim_loss: 22558509.8788; val_kl_reg_loss: 61400.8394; val_edge_recon_loss: 595206.3516; val_gene_expr_recon_loss: 19646572.2500; val_masked_gp_l1_reg_loss: 65192.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84327.8672; val_chrom_access_recon_loss: 2072187.8281; val_global_loss: 22524887.5000; val_optim_loss: 22524887.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9454; val_auprc_score: 0.9208; val_best_acc_score: 0.8885; val_best_f1_score: 0.8948; train_kl_reg_loss: 61920.3971; train_edge_recon_loss: 586707.6117; train_gene_expr_recon_loss: 19658682.0909; train_masked_gp_l1_reg_loss: 65604.7073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83553.2591; train_chrom_access_recon_loss: 2060322.5455; train_global_loss: 22516790.7273; train_optim_loss: 22516790.7273; val_kl_reg_loss: 61925.5234; val_edge_recon_loss: 587403.4922; val_gene_expr_recon_loss: 19716191.7500; val_masked_gp_l1_reg_loss: 65998.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83562.6719; val_chrom_access_recon_loss: 2065317.6719; val_global_loss: 22580398.7500; val_optim_loss: 22580398.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9484; val_auprc_score: 0.9317; val_best_acc_score: 0.8837; val_best_f1_score: 0.8894; train_kl_reg_loss: 61706.7800; train_edge_recon_loss: 583521.9962; train_gene_expr_recon_loss: 19600101.3333; train_masked_gp_l1_reg_loss: 65423.9280; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65180.6499; train_chrom_access_recon_loss: 2054207.5682; train_global_loss: 22430142.2727; train_optim_loss: 22430142.2727; val_kl_reg_loss: 62376.1362; val_edge_recon_loss: 590049.1172; val_gene_expr_recon_loss: 19683661.0000; val_masked_gp_l1_reg_loss: 65105.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59223.1875; val_chrom_access_recon_loss: 2083804.1094; val_global_loss: 22544220.7500; val_optim_loss: 22544220.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9483; val_auprc_score: 0.9324; val_best_acc_score: 0.8893; val_best_f1_score: 0.8922; train_kl_reg_loss: 62321.0101; train_edge_recon_loss: 582454.2358; train_gene_expr_recon_loss: 19583235.0606; train_masked_gp_l1_reg_loss: 65064.1262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58463.4163; train_chrom_access_recon_loss: 2051117.0587; train_global_loss: 22402654.8485; train_optim_loss: 22402654.8485; val_kl_reg_loss: 62814.2617; val_edge_recon_loss: 588077.2578; val_gene_expr_recon_loss: 19687004.2500; val_masked_gp_l1_reg_loss: 65062.8789; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58083.6445; val_chrom_access_recon_loss: 2061689.2031; val_global_loss: 22522730.7500; val_optim_loss: 22522730.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9448; val_auprc_score: 0.9256; val_best_acc_score: 0.8864; val_best_f1_score: 0.8926; train_kl_reg_loss: 62472.8051; train_edge_recon_loss: 581124.7481; train_gene_expr_recon_loss: 19571747.9697; train_masked_gp_l1_reg_loss: 65089.2666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57768.0062; train_chrom_access_recon_loss: 2049422.5833; train_global_loss: 22387625.1818; train_optim_loss: 22387625.1818; val_kl_reg_loss: 63098.6206; val_edge_recon_loss: 587794.5781; val_gene_expr_recon_loss: 19563869.5000; val_masked_gp_l1_reg_loss: 65121.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57570.3555; val_chrom_access_recon_loss: 2052471.2969; val_global_loss: 22389925.7500; val_optim_loss: 22389925.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9510; val_auprc_score: 0.9355; val_best_acc_score: 0.8941; val_best_f1_score: 0.8992; train_kl_reg_loss: 62667.8439; train_edge_recon_loss: 582433.8646; train_gene_expr_recon_loss: 19588933.8788; train_masked_gp_l1_reg_loss: 65159.6787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57300.4526; train_chrom_access_recon_loss: 2052396.3352; train_global_loss: 22408892.0909; train_optim_loss: 22408892.0909; val_kl_reg_loss: 62151.9102; val_edge_recon_loss: 582963.0859; val_gene_expr_recon_loss: 19348580.7500; val_masked_gp_l1_reg_loss: 65196.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57123.6797; val_chrom_access_recon_loss: 2038429.6406; val_global_loss: 22154445.5000; val_optim_loss: 22154445.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9471; val_auprc_score: 0.9296; val_best_acc_score: 0.8861; val_best_f1_score: 0.8918; train_kl_reg_loss: 62498.0059; train_edge_recon_loss: 582996.2027; train_gene_expr_recon_loss: 19566776.8788; train_masked_gp_l1_reg_loss: 65256.3284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56955.7354; train_chrom_access_recon_loss: 2049738.8826; train_global_loss: 22384222.0303; train_optim_loss: 22384222.0303; val_kl_reg_loss: 62710.3965; val_edge_recon_loss: 590189.2422; val_gene_expr_recon_loss: 19470602.2500; val_masked_gp_l1_reg_loss: 65296.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56738.3711; val_chrom_access_recon_loss: 2031522.7344; val_global_loss: 22277058.7500; val_optim_loss: 22277058.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9526; val_auprc_score: 0.9368; val_best_acc_score: 0.8960; val_best_f1_score: 0.9015; train_kl_reg_loss: 62491.9997; train_edge_recon_loss: 583381.1155; train_gene_expr_recon_loss: 19559052.8485; train_masked_gp_l1_reg_loss: 65340.4352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56587.0521; train_chrom_access_recon_loss: 2050348.9508; train_global_loss: 22377202.4545; train_optim_loss: 22377202.4545; val_kl_reg_loss: 62749.7476; val_edge_recon_loss: 585276.7109; val_gene_expr_recon_loss: 19494633.7500; val_masked_gp_l1_reg_loss: 65388.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56517.2617; val_chrom_access_recon_loss: 2036538.5312; val_global_loss: 22301104.7500; val_optim_loss: 22301104.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9473; val_auprc_score: 0.9340; val_best_acc_score: 0.8807; val_best_f1_score: 0.8876; train_kl_reg_loss: 62282.7187; train_edge_recon_loss: 582233.3816; train_gene_expr_recon_loss: 19545244.0606; train_masked_gp_l1_reg_loss: 65447.0448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56338.2356; train_chrom_access_recon_loss: 2046807.8409; train_global_loss: 22358353.5455; train_optim_loss: 22358353.5455; val_kl_reg_loss: 62695.4087; val_edge_recon_loss: 589351.9375; val_gene_expr_recon_loss: 19546382.5000; val_masked_gp_l1_reg_loss: 65506.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56160.6680; val_chrom_access_recon_loss: 2049186.2500; val_global_loss: 22369282.2500; val_optim_loss: 22369282.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9541; val_auprc_score: 0.9440; val_best_acc_score: 0.8920; val_best_f1_score: 0.8959; train_kl_reg_loss: 62271.3981; train_edge_recon_loss: 582666.3343; train_gene_expr_recon_loss: 19551814.0909; train_masked_gp_l1_reg_loss: 65575.0748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56005.0481; train_chrom_access_recon_loss: 2048527.5189; train_global_loss: 22366859.2121; train_optim_loss: 22366859.2121; val_kl_reg_loss: 62725.5537; val_edge_recon_loss: 584299.2891; val_gene_expr_recon_loss: 19521859.2500; val_masked_gp_l1_reg_loss: 65637.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55903.7148; val_chrom_access_recon_loss: 2053976.5625; val_global_loss: 22344403.0000; val_optim_loss: 22344403.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9488; val_auprc_score: 0.9249; val_best_acc_score: 0.8920; val_best_f1_score: 0.8966; train_kl_reg_loss: 62339.5716; train_edge_recon_loss: 582977.1951; train_gene_expr_recon_loss: 19528118.8788; train_masked_gp_l1_reg_loss: 65568.4686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54106.0384; train_chrom_access_recon_loss: 2045171.0114; train_global_loss: 22338281.0000; train_optim_loss: 22338281.0000; val_kl_reg_loss: 62586.9131; val_edge_recon_loss: 586338.5000; val_gene_expr_recon_loss: 19622917.0000; val_masked_gp_l1_reg_loss: 65523.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53507.8594; val_chrom_access_recon_loss: 2057237.2812; val_global_loss: 22448111.7500; val_optim_loss: 22448111.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9497; val_auprc_score: 0.9342; val_best_acc_score: 0.8888; val_best_f1_score: 0.8944; train_kl_reg_loss: 62327.3261; train_edge_recon_loss: 580156.1364; train_gene_expr_recon_loss: 19540004.0000; train_masked_gp_l1_reg_loss: 65513.3746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53408.8119; train_chrom_access_recon_loss: 2046232.2689; train_global_loss: 22347642.0606; train_optim_loss: 22347642.0606; val_kl_reg_loss: 63024.1934; val_edge_recon_loss: 588976.4453; val_gene_expr_recon_loss: 19548559.2500; val_masked_gp_l1_reg_loss: 65504.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53330.7773; val_chrom_access_recon_loss: 2031129.1094; val_global_loss: 22350522.7500; val_optim_loss: 22350522.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9452; val_auprc_score: 0.9242; val_best_acc_score: 0.8847; val_best_f1_score: 0.8897; train_kl_reg_loss: 62323.2347; train_edge_recon_loss: 583244.7888; train_gene_expr_recon_loss: 19535157.1818; train_masked_gp_l1_reg_loss: 65504.6812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53284.6870; train_chrom_access_recon_loss: 2047266.0947; train_global_loss: 22346781.0000; train_optim_loss: 22346781.0000; val_kl_reg_loss: 62580.6958; val_edge_recon_loss: 588606.2344; val_gene_expr_recon_loss: 19468665.5000; val_masked_gp_l1_reg_loss: 65504.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53243.1367; val_chrom_access_recon_loss: 2046327.6094; val_global_loss: 22284928.0000; val_optim_loss: 22284928.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9539; val_auprc_score: 0.9410; val_best_acc_score: 0.8955; val_best_f1_score: 0.8990; train_kl_reg_loss: 62287.4121; train_edge_recon_loss: 580587.2737; train_gene_expr_recon_loss: 19544061.3333; train_masked_gp_l1_reg_loss: 65508.2532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53216.0460; train_chrom_access_recon_loss: 2047332.9186; train_global_loss: 22352993.4242; train_optim_loss: 22352993.4242; val_kl_reg_loss: 62790.9033; val_edge_recon_loss: 580751.8984; val_gene_expr_recon_loss: 19441947.2500; val_masked_gp_l1_reg_loss: 65511.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53183.0625; val_chrom_access_recon_loss: 2039062.1562; val_global_loss: 22243248.0000; val_optim_loss: 22243248.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 9 min 6 sec.
Using best model state, which was in epoch 23.

--- MODEL EVALUATION ---
val AUROC score: 0.9433
val AUPRC score: 0.9227
val best accuracy score: 0.8861
val best F1 score: 0.8905
val target rna MSE score: 1.1337
val source rna MSE score: 0.5775
val target atac MSE score: 0.3195
val source atac MSE score: 0.1317
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
