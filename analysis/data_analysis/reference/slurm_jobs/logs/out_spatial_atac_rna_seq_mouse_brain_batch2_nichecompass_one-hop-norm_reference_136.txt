[True]
Run timestamp: 10102023_040201_136.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_136']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6837; val_auprc_score: 0.6659; val_best_acc_score: 0.5024; val_best_f1_score: 0.6676; train_kl_reg_loss: 56386.2577; train_edge_recon_loss: 3528532.9962; train_gene_expr_recon_loss: 13948334.5758; train_masked_gp_l1_reg_loss: 91350.6024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2969123.0019; train_chrom_access_recon_loss: 11576150.5606; train_global_loss: 32169878.3333; train_optim_loss: 32169878.3333; val_kl_reg_loss: 125338.5723; val_edge_recon_loss: 4065221.2188; val_gene_expr_recon_loss: 13006380.6250; val_masked_gp_l1_reg_loss: 74533.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1652569.0000; val_chrom_access_recon_loss: 11129861.5000; val_global_loss: 30053905.0000; val_optim_loss: 30053905.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6942; val_auprc_score: 0.6805; val_best_acc_score: 0.5591; val_best_f1_score: 0.6894; train_kl_reg_loss: 104874.5883; train_edge_recon_loss: 3527310.9318; train_gene_expr_recon_loss: 12779035.4394; train_masked_gp_l1_reg_loss: 70430.0894; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 899090.1127; train_chrom_access_recon_loss: 10998902.4091; train_global_loss: 28379643.4848; train_optim_loss: 28379643.4848; val_kl_reg_loss: 93111.8574; val_edge_recon_loss: 4061622.7188; val_gene_expr_recon_loss: 12738996.8750; val_masked_gp_l1_reg_loss: 69248.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 435372.5000; val_chrom_access_recon_loss: 10883361.7500; val_global_loss: 28281714.0000; val_optim_loss: 28281714.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7649; val_auprc_score: 0.7517; val_best_acc_score: 0.6980; val_best_f1_score: 0.7184; train_kl_reg_loss: 96650.6895; train_edge_recon_loss: 3520890.3939; train_gene_expr_recon_loss: 12636444.9394; train_masked_gp_l1_reg_loss: 69634.4083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 294342.1572; train_chrom_access_recon_loss: 10900670.6818; train_global_loss: 27518633.4242; train_optim_loss: 27518633.4242; val_kl_reg_loss: 104131.0391; val_edge_recon_loss: 4030340.4062; val_gene_expr_recon_loss: 12540179.7500; val_masked_gp_l1_reg_loss: 70701.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202857.7500; val_chrom_access_recon_loss: 10843200.3750; val_global_loss: 27791411.2500; val_optim_loss: 27791411.2500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8310; val_auprc_score: 0.8085; val_best_acc_score: 0.7504; val_best_f1_score: 0.7686; train_kl_reg_loss: 81943.0342; train_edge_recon_loss: 3490493.5720; train_gene_expr_recon_loss: 12539997.0303; train_masked_gp_l1_reg_loss: 72607.2788; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163144.8454; train_chrom_access_recon_loss: 10820164.9697; train_global_loss: 27168350.7879; train_optim_loss: 27168350.7879; val_kl_reg_loss: 66386.6748; val_edge_recon_loss: 3716002.9688; val_gene_expr_recon_loss: 12517469.6250; val_masked_gp_l1_reg_loss: 75237.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133239.0000; val_chrom_access_recon_loss: 10728405.7500; val_global_loss: 27236742.0000; val_optim_loss: 27236742.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8415; val_auprc_score: 0.8149; val_best_acc_score: 0.7534; val_best_f1_score: 0.7903; train_kl_reg_loss: 80411.1541; train_edge_recon_loss: 3187406.2197; train_gene_expr_recon_loss: 12476559.0455; train_masked_gp_l1_reg_loss: 79405.7359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118640.2079; train_chrom_access_recon_loss: 10783150.0909; train_global_loss: 26725572.4545; train_optim_loss: 26725572.4545; val_kl_reg_loss: 99674.9521; val_edge_recon_loss: 2997871.9688; val_gene_expr_recon_loss: 12433053.2500; val_masked_gp_l1_reg_loss: 83071.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107111.8984; val_chrom_access_recon_loss: 10682103.3750; val_global_loss: 26402887.7500; val_optim_loss: 26402887.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8705; val_auprc_score: 0.8304; val_best_acc_score: 0.7837; val_best_f1_score: 0.8103; train_kl_reg_loss: 107779.0072; train_edge_recon_loss: 2961658.1742; train_gene_expr_recon_loss: 12386667.8788; train_masked_gp_l1_reg_loss: 84282.7109; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98685.9336; train_chrom_access_recon_loss: 10703979.0455; train_global_loss: 26343052.8485; train_optim_loss: 26343052.8485; val_kl_reg_loss: 106265.6660; val_edge_recon_loss: 2904028.4688; val_gene_expr_recon_loss: 12371772.8750; val_masked_gp_l1_reg_loss: 85779.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91340.2344; val_chrom_access_recon_loss: 10714421.0000; val_global_loss: 26273606.7500; val_optim_loss: 26273606.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8640; val_auprc_score: 0.8232; val_best_acc_score: 0.7907; val_best_f1_score: 0.8110; train_kl_reg_loss: 102866.5545; train_edge_recon_loss: 2946753.6212; train_gene_expr_recon_loss: 12331645.9848; train_masked_gp_l1_reg_loss: 86820.0391; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86362.9686; train_chrom_access_recon_loss: 10675342.0909; train_global_loss: 26229791.3636; train_optim_loss: 26229791.3636; val_kl_reg_loss: 97013.5244; val_edge_recon_loss: 2956620.2188; val_gene_expr_recon_loss: 12285480.3750; val_masked_gp_l1_reg_loss: 88199.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82338.1719; val_chrom_access_recon_loss: 10576281.1250; val_global_loss: 26085932.5000; val_optim_loss: 26085932.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8975; val_auprc_score: 0.8660; val_best_acc_score: 0.8286; val_best_f1_score: 0.8425; train_kl_reg_loss: 98592.3073; train_edge_recon_loss: 2888880.4129; train_gene_expr_recon_loss: 12277631.3485; train_masked_gp_l1_reg_loss: 89537.6642; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78891.0458; train_chrom_access_recon_loss: 10626289.8939; train_global_loss: 26059822.6364; train_optim_loss: 26059822.6364; val_kl_reg_loss: 93605.6035; val_edge_recon_loss: 2862827.4688; val_gene_expr_recon_loss: 12230163.1250; val_masked_gp_l1_reg_loss: 91032.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76708.5625; val_chrom_access_recon_loss: 10579989.8750; val_global_loss: 25934327.2500; val_optim_loss: 25934327.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8963; val_auprc_score: 0.8544; val_best_acc_score: 0.8396; val_best_f1_score: 0.8502; train_kl_reg_loss: 101788.2009; train_edge_recon_loss: 2850986.6856; train_gene_expr_recon_loss: 12208416.4242; train_masked_gp_l1_reg_loss: 92155.6824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74939.1429; train_chrom_access_recon_loss: 10570998.9848; train_global_loss: 25899285.1515; train_optim_loss: 25899285.1515; val_kl_reg_loss: 101738.2510; val_edge_recon_loss: 2814783.2188; val_gene_expr_recon_loss: 12152168.2500; val_masked_gp_l1_reg_loss: 93314.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73740.8906; val_chrom_access_recon_loss: 10476920.5000; val_global_loss: 25712666.0000; val_optim_loss: 25712666.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8970; val_auprc_score: 0.8634; val_best_acc_score: 0.8326; val_best_f1_score: 0.8489; train_kl_reg_loss: 103308.7943; train_edge_recon_loss: 2817437.5795; train_gene_expr_recon_loss: 12165866.0152; train_masked_gp_l1_reg_loss: 94358.5636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72538.5143; train_chrom_access_recon_loss: 10539509.4545; train_global_loss: 25793019.0303; train_optim_loss: 25793019.0303; val_kl_reg_loss: 102232.5303; val_edge_recon_loss: 2848063.0625; val_gene_expr_recon_loss: 12157616.3750; val_masked_gp_l1_reg_loss: 95425.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72124.4688; val_chrom_access_recon_loss: 10449223.8750; val_global_loss: 25724685.7500; val_optim_loss: 25724685.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9124; val_auprc_score: 0.8841; val_best_acc_score: 0.8420; val_best_f1_score: 0.8538; train_kl_reg_loss: 101801.8928; train_edge_recon_loss: 2811595.1098; train_gene_expr_recon_loss: 12132896.6212; train_masked_gp_l1_reg_loss: 96051.7246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70854.9792; train_chrom_access_recon_loss: 10516789.6364; train_global_loss: 25729990.0303; train_optim_loss: 25729990.0303; val_kl_reg_loss: 97958.9932; val_edge_recon_loss: 2816915.9375; val_gene_expr_recon_loss: 12097876.3750; val_masked_gp_l1_reg_loss: 96991.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69635.5938; val_chrom_access_recon_loss: 10540877.5000; val_global_loss: 25720256.2500; val_optim_loss: 25720256.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9172; val_auprc_score: 0.8880; val_best_acc_score: 0.8528; val_best_f1_score: 0.8627; train_kl_reg_loss: 98264.2188; train_edge_recon_loss: 2805903.3220; train_gene_expr_recon_loss: 12076222.3182; train_masked_gp_l1_reg_loss: 97589.3074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68715.3868; train_chrom_access_recon_loss: 10469931.7424; train_global_loss: 25616626.2121; train_optim_loss: 25616626.2121; val_kl_reg_loss: 95823.3486; val_edge_recon_loss: 2831071.8438; val_gene_expr_recon_loss: 12137417.5000; val_masked_gp_l1_reg_loss: 98496.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67960.7344; val_chrom_access_recon_loss: 10445656.6250; val_global_loss: 25676427.2500; val_optim_loss: 25676427.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9159; val_auprc_score: 0.8841; val_best_acc_score: 0.8608; val_best_f1_score: 0.8701; train_kl_reg_loss: 96936.6879; train_edge_recon_loss: 2787676.0038; train_gene_expr_recon_loss: 12036645.6515; train_masked_gp_l1_reg_loss: 99163.7611; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67087.9801; train_chrom_access_recon_loss: 10427500.1970; train_global_loss: 25515010.2424; train_optim_loss: 25515010.2424; val_kl_reg_loss: 98364.5537; val_edge_recon_loss: 2772547.6562; val_gene_expr_recon_loss: 12022650.0000; val_masked_gp_l1_reg_loss: 99815.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66314.6328; val_chrom_access_recon_loss: 10410144.2500; val_global_loss: 25469836.2500; val_optim_loss: 25469836.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9198; val_auprc_score: 0.8915; val_best_acc_score: 0.8630; val_best_f1_score: 0.8723; train_kl_reg_loss: 96150.3507; train_edge_recon_loss: 2790962.3258; train_gene_expr_recon_loss: 11997990.9545; train_masked_gp_l1_reg_loss: 100366.1201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65916.6075; train_chrom_access_recon_loss: 10403214.3030; train_global_loss: 25454600.6061; train_optim_loss: 25454600.6061; val_kl_reg_loss: 93350.5967; val_edge_recon_loss: 2793398.0625; val_gene_expr_recon_loss: 12003264.3750; val_masked_gp_l1_reg_loss: 100930.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65596.7344; val_chrom_access_recon_loss: 10395251.7500; val_global_loss: 25451792.7500; val_optim_loss: 25451792.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9187; val_auprc_score: 0.8893; val_best_acc_score: 0.8581; val_best_f1_score: 0.8685; train_kl_reg_loss: 97141.8881; train_edge_recon_loss: 2766179.1212; train_gene_expr_recon_loss: 11963826.2576; train_masked_gp_l1_reg_loss: 101270.0687; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64858.3953; train_chrom_access_recon_loss: 10365015.2424; train_global_loss: 25358290.8485; train_optim_loss: 25358290.8485; val_kl_reg_loss: 95987.5293; val_edge_recon_loss: 2798717.6875; val_gene_expr_recon_loss: 11982199.5000; val_masked_gp_l1_reg_loss: 101907.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64472.1406; val_chrom_access_recon_loss: 10406285.8750; val_global_loss: 25449569.5000; val_optim_loss: 25449569.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9255; val_auprc_score: 0.9001; val_best_acc_score: 0.8627; val_best_f1_score: 0.8738; train_kl_reg_loss: 96944.5921; train_edge_recon_loss: 2762248.0833; train_gene_expr_recon_loss: 11930879.9545; train_masked_gp_l1_reg_loss: 102385.3301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64241.4567; train_chrom_access_recon_loss: 10329022.6970; train_global_loss: 25285722.0000; train_optim_loss: 25285722.0000; val_kl_reg_loss: 92291.0645; val_edge_recon_loss: 2815018.6875; val_gene_expr_recon_loss: 11792990.8750; val_masked_gp_l1_reg_loss: 102781.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63644.4570; val_chrom_access_recon_loss: 10311817.0000; val_global_loss: 25178542.5000; val_optim_loss: 25178542.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9240; val_auprc_score: 0.8986; val_best_acc_score: 0.8651; val_best_f1_score: 0.8762; train_kl_reg_loss: 94562.6207; train_edge_recon_loss: 2761826.4470; train_gene_expr_recon_loss: 11889787.9697; train_masked_gp_l1_reg_loss: 103213.0024; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63511.7895; train_chrom_access_recon_loss: 10294160.6515; train_global_loss: 25207062.6061; train_optim_loss: 25207062.6061; val_kl_reg_loss: 87969.2041; val_edge_recon_loss: 2798573.4688; val_gene_expr_recon_loss: 11808221.2500; val_masked_gp_l1_reg_loss: 103843.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63789.4609; val_chrom_access_recon_loss: 10274541.2500; val_global_loss: 25136938.0000; val_optim_loss: 25136938.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9329; val_auprc_score: 0.9098; val_best_acc_score: 0.8721; val_best_f1_score: 0.8801; train_kl_reg_loss: 93639.9143; train_edge_recon_loss: 2754849.5568; train_gene_expr_recon_loss: 11866564.9545; train_masked_gp_l1_reg_loss: 104022.9042; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63437.9947; train_chrom_access_recon_loss: 10279607.1061; train_global_loss: 25162122.4848; train_optim_loss: 25162122.4848; val_kl_reg_loss: 92459.1758; val_edge_recon_loss: 2771617.4062; val_gene_expr_recon_loss: 11879366.1250; val_masked_gp_l1_reg_loss: 104512.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63553.7812; val_chrom_access_recon_loss: 10306536.7500; val_global_loss: 25218045.5000; val_optim_loss: 25218045.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9330; val_auprc_score: 0.9115; val_best_acc_score: 0.8780; val_best_f1_score: 0.8872; train_kl_reg_loss: 91818.7672; train_edge_recon_loss: 2746593.8333; train_gene_expr_recon_loss: 11834034.8333; train_masked_gp_l1_reg_loss: 104769.3142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63538.4013; train_chrom_access_recon_loss: 10243447.7727; train_global_loss: 25084202.8485; train_optim_loss: 25084202.8485; val_kl_reg_loss: 87605.2803; val_edge_recon_loss: 2756236.9688; val_gene_expr_recon_loss: 11936749.0000; val_masked_gp_l1_reg_loss: 105189.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63443.2148; val_chrom_access_recon_loss: 10360355.1250; val_global_loss: 25309578.2500; val_optim_loss: 25309578.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9477; val_auprc_score: 0.9271; val_best_acc_score: 0.8933; val_best_f1_score: 0.9003; train_kl_reg_loss: 92055.4393; train_edge_recon_loss: 2737249.3598; train_gene_expr_recon_loss: 11815665.8485; train_masked_gp_l1_reg_loss: 105460.6153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63360.0433; train_chrom_access_recon_loss: 10222085.3030; train_global_loss: 25035876.6667; train_optim_loss: 25035876.6667; val_kl_reg_loss: 92018.4932; val_edge_recon_loss: 2729420.9062; val_gene_expr_recon_loss: 11784294.1250; val_masked_gp_l1_reg_loss: 105810.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63499.8594; val_chrom_access_recon_loss: 10208190.2500; val_global_loss: 24983234.2500; val_optim_loss: 24983234.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9362; val_auprc_score: 0.9105; val_best_acc_score: 0.8799; val_best_f1_score: 0.8874; train_kl_reg_loss: 91423.7064; train_edge_recon_loss: 2748407.5795; train_gene_expr_recon_loss: 11776682.1667; train_masked_gp_l1_reg_loss: 106073.0768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63331.9049; train_chrom_access_recon_loss: 10189427.3939; train_global_loss: 24975345.8182; train_optim_loss: 24975345.8182; val_kl_reg_loss: 93897.5596; val_edge_recon_loss: 2759097.5938; val_gene_expr_recon_loss: 11760497.5000; val_masked_gp_l1_reg_loss: 106366.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63142.8594; val_chrom_access_recon_loss: 10244620.7500; val_global_loss: 25027623.2500; val_optim_loss: 25027623.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9398; val_auprc_score: 0.9127; val_best_acc_score: 0.8812; val_best_f1_score: 0.8884; train_kl_reg_loss: 91500.9869; train_edge_recon_loss: 2731798.4886; train_gene_expr_recon_loss: 11761534.9091; train_masked_gp_l1_reg_loss: 106427.6854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62885.7617; train_chrom_access_recon_loss: 10161763.9697; train_global_loss: 24915911.8788; train_optim_loss: 24915911.8788; val_kl_reg_loss: 92998.0312; val_edge_recon_loss: 2750863.0312; val_gene_expr_recon_loss: 11765450.0000; val_masked_gp_l1_reg_loss: 106781.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62606.6797; val_chrom_access_recon_loss: 10176838.1250; val_global_loss: 24955537.2500; val_optim_loss: 24955537.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9427; val_auprc_score: 0.9131; val_best_acc_score: 0.8898; val_best_f1_score: 0.8950; train_kl_reg_loss: 89885.9438; train_edge_recon_loss: 2740669.2879; train_gene_expr_recon_loss: 11733809.8788; train_masked_gp_l1_reg_loss: 107032.2037; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62571.2066; train_chrom_access_recon_loss: 10139113.5455; train_global_loss: 24873082.0909; train_optim_loss: 24873082.0909; val_kl_reg_loss: 89055.6895; val_edge_recon_loss: 2760684.5000; val_gene_expr_recon_loss: 11774930.7500; val_masked_gp_l1_reg_loss: 107290.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62350.1680; val_chrom_access_recon_loss: 10159877.2500; val_global_loss: 24954188.2500; val_optim_loss: 24954188.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9373; val_auprc_score: 0.9098; val_best_acc_score: 0.8831; val_best_f1_score: 0.8885; train_kl_reg_loss: 90716.3462; train_edge_recon_loss: 2717153.1212; train_gene_expr_recon_loss: 11718045.3485; train_masked_gp_l1_reg_loss: 107462.3511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62393.1999; train_chrom_access_recon_loss: 10106393.7121; train_global_loss: 24802163.9091; train_optim_loss: 24802163.9091; val_kl_reg_loss: 90356.4580; val_edge_recon_loss: 2796309.7500; val_gene_expr_recon_loss: 11759198.5000; val_masked_gp_l1_reg_loss: 107784.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62144.6445; val_chrom_access_recon_loss: 10132750.3750; val_global_loss: 24948545.2500; val_optim_loss: 24948545.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9468; val_auprc_score: 0.9204; val_best_acc_score: 0.8925; val_best_f1_score: 0.8980; train_kl_reg_loss: 88424.5791; train_edge_recon_loss: 2724856.4242; train_gene_expr_recon_loss: 11693685.8485; train_masked_gp_l1_reg_loss: 107812.6262; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62001.6523; train_chrom_access_recon_loss: 10079972.5303; train_global_loss: 24756753.7879; train_optim_loss: 24756753.7879; val_kl_reg_loss: 87127.5303; val_edge_recon_loss: 2732811.1562; val_gene_expr_recon_loss: 11617311.2500; val_masked_gp_l1_reg_loss: 108006.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61905.1562; val_chrom_access_recon_loss: 10064392.8750; val_global_loss: 24671554.7500; val_optim_loss: 24671554.7500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9414; val_auprc_score: 0.9143; val_best_acc_score: 0.8855; val_best_f1_score: 0.8916; train_kl_reg_loss: 87789.2970; train_edge_recon_loss: 2725564.5265; train_gene_expr_recon_loss: 11675892.1515; train_masked_gp_l1_reg_loss: 108116.9156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61728.1570; train_chrom_access_recon_loss: 10047104.8333; train_global_loss: 24706195.7879; train_optim_loss: 24706195.7879; val_kl_reg_loss: 88173.0615; val_edge_recon_loss: 2758539.9062; val_gene_expr_recon_loss: 11548890.2500; val_masked_gp_l1_reg_loss: 108319.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61852.3398; val_chrom_access_recon_loss: 10085226.5000; val_global_loss: 24651000.7500; val_optim_loss: 24651000.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9476; val_auprc_score: 0.9231; val_best_acc_score: 0.8968; val_best_f1_score: 0.9002; train_kl_reg_loss: 87364.4197; train_edge_recon_loss: 2728528.1780; train_gene_expr_recon_loss: 11660305.6818; train_masked_gp_l1_reg_loss: 108481.8917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61578.5788; train_chrom_access_recon_loss: 10021134.9848; train_global_loss: 24667393.7879; train_optim_loss: 24667393.7879; val_kl_reg_loss: 87573.4814; val_edge_recon_loss: 2754584.5625; val_gene_expr_recon_loss: 11579006.6250; val_masked_gp_l1_reg_loss: 108707.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61876.4219; val_chrom_access_recon_loss: 10054379.7500; val_global_loss: 24646128.5000; val_optim_loss: 24646128.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9472; val_auprc_score: 0.9219; val_best_acc_score: 0.8944; val_best_f1_score: 0.8996; train_kl_reg_loss: 87857.9407; train_edge_recon_loss: 2712834.6250; train_gene_expr_recon_loss: 11642780.8182; train_masked_gp_l1_reg_loss: 108791.7663; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61343.5801; train_chrom_access_recon_loss: 10005050.3182; train_global_loss: 24618659.0909; train_optim_loss: 24618659.0909; val_kl_reg_loss: 88026.6992; val_edge_recon_loss: 2748033.7812; val_gene_expr_recon_loss: 11640715.2500; val_masked_gp_l1_reg_loss: 109067.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61473.5586; val_chrom_access_recon_loss: 10015361.6250; val_global_loss: 24662679.0000; val_optim_loss: 24662679.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9453; val_auprc_score: 0.9186; val_best_acc_score: 0.8963; val_best_f1_score: 0.9015; train_kl_reg_loss: 87447.8069; train_edge_recon_loss: 2713773.0492; train_gene_expr_recon_loss: 11625988.6061; train_masked_gp_l1_reg_loss: 109146.7960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61382.5748; train_chrom_access_recon_loss: 9968739.6818; train_global_loss: 24566478.7879; train_optim_loss: 24566478.7879; val_kl_reg_loss: 88440.7021; val_edge_recon_loss: 2743854.6562; val_gene_expr_recon_loss: 11675588.1250; val_masked_gp_l1_reg_loss: 109119.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61002.0508; val_chrom_access_recon_loss: 10009867.0000; val_global_loss: 24687872.0000; val_optim_loss: 24687872.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9480; val_auprc_score: 0.9212; val_best_acc_score: 0.9009; val_best_f1_score: 0.9047; train_kl_reg_loss: 86841.1835; train_edge_recon_loss: 2715930.5227; train_gene_expr_recon_loss: 11604889.8788; train_masked_gp_l1_reg_loss: 109138.6438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61047.0267; train_chrom_access_recon_loss: 9943879.3030; train_global_loss: 24521726.4848; train_optim_loss: 24521726.4848; val_kl_reg_loss: 90086.5898; val_edge_recon_loss: 2730435.2188; val_gene_expr_recon_loss: 11670241.5000; val_masked_gp_l1_reg_loss: 109332.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60966.4492; val_chrom_access_recon_loss: 9954435.1250; val_global_loss: 24615497.5000; val_optim_loss: 24615497.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9595; val_auprc_score: 0.9411; val_best_acc_score: 0.9076; val_best_f1_score: 0.9113; train_kl_reg_loss: 85465.7221; train_edge_recon_loss: 2714562.0114; train_gene_expr_recon_loss: 11582372.8485; train_masked_gp_l1_reg_loss: 109380.1374; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60807.7498; train_chrom_access_recon_loss: 9907568.9697; train_global_loss: 24460157.2424; train_optim_loss: 24460157.2424; val_kl_reg_loss: 85586.1816; val_edge_recon_loss: 2702510.0625; val_gene_expr_recon_loss: 11612775.7500; val_masked_gp_l1_reg_loss: 109461.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61036.0547; val_chrom_access_recon_loss: 9961452.6250; val_global_loss: 24532821.7500; val_optim_loss: 24532821.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9543; val_auprc_score: 0.9328; val_best_acc_score: 0.9046; val_best_f1_score: 0.9094; train_kl_reg_loss: 86945.3975; train_edge_recon_loss: 2700841.8447; train_gene_expr_recon_loss: 11578036.8182; train_masked_gp_l1_reg_loss: 109610.8678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60665.9896; train_chrom_access_recon_loss: 9884826.6970; train_global_loss: 24420927.5758; train_optim_loss: 24420927.5758; val_kl_reg_loss: 89518.3076; val_edge_recon_loss: 2730468.5625; val_gene_expr_recon_loss: 11578456.0000; val_masked_gp_l1_reg_loss: 109716.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60540.1094; val_chrom_access_recon_loss: 10043840.6250; val_global_loss: 24612540.2500; val_optim_loss: 24612540.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9562; val_auprc_score: 0.9394; val_best_acc_score: 0.9052; val_best_f1_score: 0.9089; train_kl_reg_loss: 86133.3448; train_edge_recon_loss: 2707287.1364; train_gene_expr_recon_loss: 11561179.4545; train_masked_gp_l1_reg_loss: 109673.2237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60619.6191; train_chrom_access_recon_loss: 9865076.9697; train_global_loss: 24389969.6970; train_optim_loss: 24389969.6970; val_kl_reg_loss: 87134.4541; val_edge_recon_loss: 2726144.0312; val_gene_expr_recon_loss: 11647194.2500; val_masked_gp_l1_reg_loss: 109795.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60532.6406; val_chrom_access_recon_loss: 9921054.7500; val_global_loss: 24551856.7500; val_optim_loss: 24551856.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9558; val_auprc_score: 0.9386; val_best_acc_score: 0.9019; val_best_f1_score: 0.9078; train_kl_reg_loss: 84637.5101; train_edge_recon_loss: 2710044.9962; train_gene_expr_recon_loss: 11551011.7121; train_masked_gp_l1_reg_loss: 109802.6897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60631.1018; train_chrom_access_recon_loss: 9841565.2727; train_global_loss: 24357693.4242; train_optim_loss: 24357693.4242; val_kl_reg_loss: 84664.1768; val_edge_recon_loss: 2722262.6875; val_gene_expr_recon_loss: 11517368.2500; val_masked_gp_l1_reg_loss: 109925.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60742.7578; val_chrom_access_recon_loss: 9817964.2500; val_global_loss: 24312927.2500; val_optim_loss: 24312927.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9574; val_auprc_score: 0.9370; val_best_acc_score: 0.9049; val_best_f1_score: 0.9107; train_kl_reg_loss: 84454.8108; train_edge_recon_loss: 2702739.5795; train_gene_expr_recon_loss: 11535072.8333; train_masked_gp_l1_reg_loss: 109923.2351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60491.9284; train_chrom_access_recon_loss: 9813529.2727; train_global_loss: 24306211.6061; train_optim_loss: 24306211.6061; val_kl_reg_loss: 86312.5244; val_edge_recon_loss: 2748806.9688; val_gene_expr_recon_loss: 11597674.0000; val_masked_gp_l1_reg_loss: 110018.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60403.5039; val_chrom_access_recon_loss: 9997133.0000; val_global_loss: 24600348.7500; val_optim_loss: 24600348.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9571; val_auprc_score: 0.9409; val_best_acc_score: 0.9060; val_best_f1_score: 0.9095; train_kl_reg_loss: 85725.4735; train_edge_recon_loss: 2694164.5455; train_gene_expr_recon_loss: 11520420.6818; train_masked_gp_l1_reg_loss: 109957.1525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60426.1923; train_chrom_access_recon_loss: 9791027.0455; train_global_loss: 24261721.1515; train_optim_loss: 24261721.1515; val_kl_reg_loss: 86291.7803; val_edge_recon_loss: 2725724.3125; val_gene_expr_recon_loss: 11560193.0000; val_masked_gp_l1_reg_loss: 109939.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60749.5781; val_chrom_access_recon_loss: 9811532.2500; val_global_loss: 24354430.0000; val_optim_loss: 24354430.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9609; val_auprc_score: 0.9463; val_best_acc_score: 0.9111; val_best_f1_score: 0.9148; train_kl_reg_loss: 84360.9531; train_edge_recon_loss: 2703580.3750; train_gene_expr_recon_loss: 11518620.8788; train_masked_gp_l1_reg_loss: 109956.6952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60405.6219; train_chrom_access_recon_loss: 9765845.4697; train_global_loss: 24242769.9394; train_optim_loss: 24242769.9394; val_kl_reg_loss: 85778.7988; val_edge_recon_loss: 2747096.4688; val_gene_expr_recon_loss: 11493366.8750; val_masked_gp_l1_reg_loss: 110069.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60469.8594; val_chrom_access_recon_loss: 9821887.7500; val_global_loss: 24318669.2500; val_optim_loss: 24318669.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9564; val_auprc_score: 0.9371; val_best_acc_score: 0.9060; val_best_f1_score: 0.9090; train_kl_reg_loss: 83833.3181; train_edge_recon_loss: 2705370.2538; train_gene_expr_recon_loss: 11503440.2273; train_masked_gp_l1_reg_loss: 110043.7549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60331.3410; train_chrom_access_recon_loss: 9742042.7576; train_global_loss: 24205061.6364; train_optim_loss: 24205061.6364; val_kl_reg_loss: 84020.2637; val_edge_recon_loss: 2764534.9688; val_gene_expr_recon_loss: 11474334.0000; val_masked_gp_l1_reg_loss: 110173.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60641.0781; val_chrom_access_recon_loss: 9817209.3750; val_global_loss: 24310913.5000; val_optim_loss: 24310913.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9632; val_auprc_score: 0.9480; val_best_acc_score: 0.9167; val_best_f1_score: 0.9211; train_kl_reg_loss: 83315.6078; train_edge_recon_loss: 2697799.1477; train_gene_expr_recon_loss: 11499439.5303; train_masked_gp_l1_reg_loss: 110064.1267; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60424.6520; train_chrom_access_recon_loss: 9723933.9394; train_global_loss: 24174977.0303; train_optim_loss: 24174977.0303; val_kl_reg_loss: 84732.1660; val_edge_recon_loss: 2707365.6875; val_gene_expr_recon_loss: 11477850.1250; val_masked_gp_l1_reg_loss: 110240.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60494.6797; val_chrom_access_recon_loss: 9758524.8750; val_global_loss: 24199208.7500; val_optim_loss: 24199208.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9594; val_auprc_score: 0.9453; val_best_acc_score: 0.9089; val_best_f1_score: 0.9135; train_kl_reg_loss: 84829.5146; train_edge_recon_loss: 2707354.4470; train_gene_expr_recon_loss: 11483727.1515; train_masked_gp_l1_reg_loss: 110077.8706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60313.3503; train_chrom_access_recon_loss: 9695239.1364; train_global_loss: 24141541.4242; train_optim_loss: 24141541.4242; val_kl_reg_loss: 84896.0068; val_edge_recon_loss: 2736382.7812; val_gene_expr_recon_loss: 11536829.7500; val_masked_gp_l1_reg_loss: 109934.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60250.3008; val_chrom_access_recon_loss: 9840236.6250; val_global_loss: 24368529.0000; val_optim_loss: 24368529.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9541; val_auprc_score: 0.9337; val_best_acc_score: 0.9097; val_best_f1_score: 0.9144; train_kl_reg_loss: 84158.1100; train_edge_recon_loss: 2698720.2689; train_gene_expr_recon_loss: 11466316.6061; train_masked_gp_l1_reg_loss: 110001.7061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60302.5615; train_chrom_access_recon_loss: 9670259.9697; train_global_loss: 24089759.1818; train_optim_loss: 24089759.1818; val_kl_reg_loss: 84965.2949; val_edge_recon_loss: 2758001.7188; val_gene_expr_recon_loss: 11497486.0000; val_masked_gp_l1_reg_loss: 109975.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60308.2383; val_chrom_access_recon_loss: 9860899.2500; val_global_loss: 24371636.0000; val_optim_loss: 24371636.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9571; val_auprc_score: 0.9381; val_best_acc_score: 0.9092; val_best_f1_score: 0.9138; train_kl_reg_loss: 84139.2447; train_edge_recon_loss: 2694605.6553; train_gene_expr_recon_loss: 11467081.5000; train_masked_gp_l1_reg_loss: 109867.1415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60209.9743; train_chrom_access_recon_loss: 9661537.4091; train_global_loss: 24077441.0303; train_optim_loss: 24077441.0303; val_kl_reg_loss: 84929.4258; val_edge_recon_loss: 2728242.6562; val_gene_expr_recon_loss: 11455520.5000; val_masked_gp_l1_reg_loss: 109943.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60483.0312; val_chrom_access_recon_loss: 9814643.0000; val_global_loss: 24253762.2500; val_optim_loss: 24253762.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9614; val_auprc_score: 0.9429; val_best_acc_score: 0.9138; val_best_f1_score: 0.9174; train_kl_reg_loss: 83718.5636; train_edge_recon_loss: 2697702.3144; train_gene_expr_recon_loss: 11447639.6061; train_masked_gp_l1_reg_loss: 109819.3823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60375.0062; train_chrom_access_recon_loss: 9638100.9545; train_global_loss: 24037355.8485; train_optim_loss: 24037355.8485; val_kl_reg_loss: 87513.7178; val_edge_recon_loss: 2710469.6875; val_gene_expr_recon_loss: 11560642.1250; val_masked_gp_l1_reg_loss: 109950.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60417.4766; val_chrom_access_recon_loss: 9874396.2500; val_global_loss: 24403390.2500; val_optim_loss: 24403390.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9629; val_auprc_score: 0.9489; val_best_acc_score: 0.9148; val_best_f1_score: 0.9189; train_kl_reg_loss: 85181.2673; train_edge_recon_loss: 2686528.1780; train_gene_expr_recon_loss: 11438770.9545; train_masked_gp_l1_reg_loss: 106924.2048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49263.6204; train_chrom_access_recon_loss: 9605754.3030; train_global_loss: 23972422.2424; train_optim_loss: 23972422.2424; val_kl_reg_loss: 86023.0488; val_edge_recon_loss: 2724951.1562; val_gene_expr_recon_loss: 11379013.6250; val_masked_gp_l1_reg_loss: 105812.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46647.1719; val_chrom_access_recon_loss: 9745345.3750; val_global_loss: 24087792.7500; val_optim_loss: 24087792.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9597; val_auprc_score: 0.9424; val_best_acc_score: 0.9189; val_best_f1_score: 0.9224; train_kl_reg_loss: 85068.7629; train_edge_recon_loss: 2690920.7424; train_gene_expr_recon_loss: 11428292.3788; train_masked_gp_l1_reg_loss: 105630.9078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46397.6787; train_chrom_access_recon_loss: 9586431.8636; train_global_loss: 23942742.1818; train_optim_loss: 23942742.1818; val_kl_reg_loss: 86285.3350; val_edge_recon_loss: 2727162.8750; val_gene_expr_recon_loss: 11395433.0000; val_masked_gp_l1_reg_loss: 105540.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46215.1328; val_chrom_access_recon_loss: 9741792.7500; val_global_loss: 24102429.0000; val_optim_loss: 24102429.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9609; val_auprc_score: 0.9414; val_best_acc_score: 0.9156; val_best_f1_score: 0.9201; train_kl_reg_loss: 85299.2148; train_edge_recon_loss: 2690106.3068; train_gene_expr_recon_loss: 11437889.9697; train_masked_gp_l1_reg_loss: 105480.8549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46054.7932; train_chrom_access_recon_loss: 9594728.6818; train_global_loss: 23959559.7273; train_optim_loss: 23959559.7273; val_kl_reg_loss: 86182.7539; val_edge_recon_loss: 2696795.4062; val_gene_expr_recon_loss: 11430719.7500; val_masked_gp_l1_reg_loss: 105454.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45936.4648; val_chrom_access_recon_loss: 9812773.1250; val_global_loss: 24177862.5000; val_optim_loss: 24177862.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9651; val_auprc_score: 0.9475; val_best_acc_score: 0.9229; val_best_f1_score: 0.9265; train_kl_reg_loss: 85553.2428; train_edge_recon_loss: 2691546.5303; train_gene_expr_recon_loss: 11421102.6970; train_masked_gp_l1_reg_loss: 105411.7481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45831.9004; train_chrom_access_recon_loss: 9584198.9848; train_global_loss: 23933645.0606; train_optim_loss: 23933645.0606; val_kl_reg_loss: 86328.4805; val_edge_recon_loss: 2688448.3750; val_gene_expr_recon_loss: 11424635.1250; val_masked_gp_l1_reg_loss: 105412.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45745.7695; val_chrom_access_recon_loss: 9723321.7500; val_global_loss: 24073891.7500; val_optim_loss: 24073891.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9624; val_auprc_score: 0.9465; val_best_acc_score: 0.9186; val_best_f1_score: 0.9222; train_kl_reg_loss: 85208.6231; train_edge_recon_loss: 2692240.7614; train_gene_expr_recon_loss: 11429571.7273; train_masked_gp_l1_reg_loss: 105390.6010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45657.8216; train_chrom_access_recon_loss: 9582959.7879; train_global_loss: 23941029.2424; train_optim_loss: 23941029.2424; val_kl_reg_loss: 86592.0781; val_edge_recon_loss: 2728366.7188; val_gene_expr_recon_loss: 11562267.0000; val_masked_gp_l1_reg_loss: 105377.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45572.6484; val_chrom_access_recon_loss: 9927843.1250; val_global_loss: 24456019.7500; val_optim_loss: 24456019.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9646; val_auprc_score: 0.9523; val_best_acc_score: 0.9151; val_best_f1_score: 0.9196; train_kl_reg_loss: 85334.3188; train_edge_recon_loss: 2688903.9280; train_gene_expr_recon_loss: 11431557.0455; train_masked_gp_l1_reg_loss: 105379.3039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45491.9134; train_chrom_access_recon_loss: 9588066.4394; train_global_loss: 23944733.0000; train_optim_loss: 23944733.0000; val_kl_reg_loss: 86504.5508; val_edge_recon_loss: 2726699.7812; val_gene_expr_recon_loss: 11445342.0000; val_masked_gp_l1_reg_loss: 105374.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45405.8242; val_chrom_access_recon_loss: 9799180.1250; val_global_loss: 24208506.5000; val_optim_loss: 24208506.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9617; val_auprc_score: 0.9453; val_best_acc_score: 0.9170; val_best_f1_score: 0.9205; train_kl_reg_loss: 86016.3596; train_edge_recon_loss: 2683904.1326; train_gene_expr_recon_loss: 11420369.0455; train_masked_gp_l1_reg_loss: 105356.0099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45311.9057; train_chrom_access_recon_loss: 9578253.5758; train_global_loss: 23919211.1515; train_optim_loss: 23919211.1515; val_kl_reg_loss: 87274.7832; val_edge_recon_loss: 2720216.2500; val_gene_expr_recon_loss: 11523342.0000; val_masked_gp_l1_reg_loss: 105348.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45232.4648; val_chrom_access_recon_loss: 9822227.1250; val_global_loss: 24303641.2500; val_optim_loss: 24303641.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9636; val_auprc_score: 0.9509; val_best_acc_score: 0.9183; val_best_f1_score: 0.9223; train_kl_reg_loss: 85945.2731; train_edge_recon_loss: 2681666.6439; train_gene_expr_recon_loss: 11424345.8485; train_masked_gp_l1_reg_loss: 105324.3492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45132.6249; train_chrom_access_recon_loss: 9576438.7273; train_global_loss: 23918853.4545; train_optim_loss: 23918853.4545; val_kl_reg_loss: 87093.9209; val_edge_recon_loss: 2733441.7500; val_gene_expr_recon_loss: 11575214.2500; val_masked_gp_l1_reg_loss: 105340.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45099.7852; val_chrom_access_recon_loss: 9815758.6250; val_global_loss: 24361948.7500; val_optim_loss: 24361948.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9624; val_auprc_score: 0.9458; val_best_acc_score: 0.9164; val_best_f1_score: 0.9209; train_kl_reg_loss: 85497.5073; train_edge_recon_loss: 2693540.5720; train_gene_expr_recon_loss: 11411855.7879; train_masked_gp_l1_reg_loss: 105031.6931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43999.5604; train_chrom_access_recon_loss: 9566154.2121; train_global_loss: 23906079.4545; train_optim_loss: 23906079.4545; val_kl_reg_loss: 86633.3584; val_edge_recon_loss: 2733851.1875; val_gene_expr_recon_loss: 11571053.5000; val_masked_gp_l1_reg_loss: 104899.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43753.3398; val_chrom_access_recon_loss: 9850315.8750; val_global_loss: 24390506.0000; val_optim_loss: 24390506.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9628; val_auprc_score: 0.9463; val_best_acc_score: 0.9170; val_best_f1_score: 0.9214; train_kl_reg_loss: 85389.4434; train_edge_recon_loss: 2691026.6439; train_gene_expr_recon_loss: 11420235.0606; train_masked_gp_l1_reg_loss: 104870.1592; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43724.6754; train_chrom_access_recon_loss: 9572799.4545; train_global_loss: 23918045.5758; train_optim_loss: 23918045.5758; val_kl_reg_loss: 85994.2686; val_edge_recon_loss: 2726263.2188; val_gene_expr_recon_loss: 11384506.2500; val_masked_gp_l1_reg_loss: 104848.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43706.4648; val_chrom_access_recon_loss: 9772158.8750; val_global_loss: 24117477.2500; val_optim_loss: 24117477.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9660; val_auprc_score: 0.9535; val_best_acc_score: 0.9191; val_best_f1_score: 0.9221; train_kl_reg_loss: 85466.7687; train_edge_recon_loss: 2700588.4432; train_gene_expr_recon_loss: 11428796.7727; train_masked_gp_l1_reg_loss: 104838.0505; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43695.9255; train_chrom_access_recon_loss: 9583606.7121; train_global_loss: 23946992.5758; train_optim_loss: 23946992.5758; val_kl_reg_loss: 86330.3965; val_edge_recon_loss: 2705905.4688; val_gene_expr_recon_loss: 11471166.3750; val_masked_gp_l1_reg_loss: 104825.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43679.9102; val_chrom_access_recon_loss: 9791079.6250; val_global_loss: 24202986.5000; val_optim_loss: 24202986.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9596; val_auprc_score: 0.9433; val_best_acc_score: 0.9084; val_best_f1_score: 0.9129; train_kl_reg_loss: 85491.6890; train_edge_recon_loss: 2685606.6591; train_gene_expr_recon_loss: 11422702.7273; train_masked_gp_l1_reg_loss: 104819.2401; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43667.3992; train_chrom_access_recon_loss: 9579996.3788; train_global_loss: 23922284.0303; train_optim_loss: 23922284.0303; val_kl_reg_loss: 86860.7168; val_edge_recon_loss: 2732595.5625; val_gene_expr_recon_loss: 11435178.0000; val_masked_gp_l1_reg_loss: 104814.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43657.0352; val_chrom_access_recon_loss: 9739770.3750; val_global_loss: 24142875.5000; val_optim_loss: 24142875.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 1 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9659
val AUPRC score: 0.9540
val best accuracy score: 0.9210
val best F1 score: 0.9235
val target rna MSE score: 1.1887
val source rna MSE score: 0.7137
val target atac MSE score: 0.3206
val source atac MSE score: 0.1230
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
