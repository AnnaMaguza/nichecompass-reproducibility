[True]
Run timestamp: 02082024_002350_4.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_4']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2444.
Number of gene programs after filtering and combining: 2109.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1965, n_latent: 1865, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1865, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1865, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 109836
Number of validation edges: 12204
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8344; val_auprc_score: 0.9628; val_best_acc_score: 0.8686; val_best_f1_score: 0.9278; train_kl_reg_loss: 172351.1664; train_edge_recon_loss: 1105580.6983; train_gene_expr_recon_loss: 47839768.1302; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 49117699.9907; train_optim_loss: 49117699.9907; val_kl_reg_loss: 132339.2412; val_edge_recon_loss: 1152349.7995; val_gene_expr_recon_loss: 42538443.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43823131.8333; val_optim_loss: 43823131.8333
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8657; val_auprc_score: 0.9712; val_best_acc_score: 0.8802; val_best_f1_score: 0.9326; train_kl_reg_loss: 124291.5668; train_edge_recon_loss: 1036587.5375; train_gene_expr_recon_loss: 41018793.2930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 42179672.2977; train_optim_loss: 42179672.2977; val_kl_reg_loss: 117075.5680; val_edge_recon_loss: 1002813.5579; val_gene_expr_recon_loss: 39745688.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40865577.8333; val_optim_loss: 40865577.8333
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8791; val_auprc_score: 0.9734; val_best_acc_score: 0.8828; val_best_f1_score: 0.9338; train_kl_reg_loss: 113679.1319; train_edge_recon_loss: 976185.8148; train_gene_expr_recon_loss: 38623749.3860; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39713614.3256; train_optim_loss: 39713614.3256; val_kl_reg_loss: 105878.0291; val_edge_recon_loss: 987531.3242; val_gene_expr_recon_loss: 37620546.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 38713956.2500; val_optim_loss: 38713956.2500
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8952; val_auprc_score: 0.9769; val_best_acc_score: 0.8886; val_best_f1_score: 0.9365; train_kl_reg_loss: 102902.8111; train_edge_recon_loss: 948117.9804; train_gene_expr_recon_loss: 36833959.9349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 37884980.7256; train_optim_loss: 37884980.7256; val_kl_reg_loss: 101398.3276; val_edge_recon_loss: 958953.6497; val_gene_expr_recon_loss: 36119014.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37179366.0833; val_optim_loss: 37179366.0833
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9019; val_auprc_score: 0.9801; val_best_acc_score: 0.8955; val_best_f1_score: 0.9407; train_kl_reg_loss: 97294.0047; train_edge_recon_loss: 909542.6057; train_gene_expr_recon_loss: 35463890.7256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 36470727.3860; train_optim_loss: 36470727.3860; val_kl_reg_loss: 94624.4438; val_edge_recon_loss: 891513.1602; val_gene_expr_recon_loss: 34873472.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35859610.3333; val_optim_loss: 35859610.3333
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9065; val_auprc_score: 0.9809; val_best_acc_score: 0.8966; val_best_f1_score: 0.9402; train_kl_reg_loss: 90390.1094; train_edge_recon_loss: 883146.7095; train_gene_expr_recon_loss: 34345209.6465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35318746.4372; train_optim_loss: 35318746.4372; val_kl_reg_loss: 86919.1971; val_edge_recon_loss: 894304.2031; val_gene_expr_recon_loss: 33852049.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34833272.7500; val_optim_loss: 34833272.7500
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9181; val_auprc_score: 0.9830; val_best_acc_score: 0.9080; val_best_f1_score: 0.9466; train_kl_reg_loss: 83520.5784; train_edge_recon_loss: 876028.6326; train_gene_expr_recon_loss: 33420400.0326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34379949.2558; train_optim_loss: 34379949.2558; val_kl_reg_loss: 81517.6520; val_edge_recon_loss: 896265.2057; val_gene_expr_recon_loss: 33026270.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34004053.6667; val_optim_loss: 34004053.6667
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9135; val_auprc_score: 0.9811; val_best_acc_score: 0.9102; val_best_f1_score: 0.9479; train_kl_reg_loss: 78012.9631; train_edge_recon_loss: 865922.3846; train_gene_expr_recon_loss: 32662108.2419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 33606043.5488; train_optim_loss: 33606043.5488; val_kl_reg_loss: 75821.7676; val_edge_recon_loss: 877132.6979; val_gene_expr_recon_loss: 32351426.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33304380.7083; val_optim_loss: 33304380.7083
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9199; val_auprc_score: 0.9824; val_best_acc_score: 0.9132; val_best_f1_score: 0.9498; train_kl_reg_loss: 72589.8039; train_edge_recon_loss: 856632.3160; train_gene_expr_recon_loss: 32036608.7395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32965830.9116; train_optim_loss: 32965830.9116; val_kl_reg_loss: 69820.1512; val_edge_recon_loss: 872288.9180; val_gene_expr_recon_loss: 31796840.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32738949.1250; val_optim_loss: 32738949.1250
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9333; val_auprc_score: 0.9856; val_best_acc_score: 0.9231; val_best_f1_score: 0.9559; train_kl_reg_loss: 67254.0408; train_edge_recon_loss: 843066.6682; train_gene_expr_recon_loss: 31523463.7349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32433784.4698; train_optim_loss: 32433784.4698; val_kl_reg_loss: 65033.7760; val_edge_recon_loss: 844586.0352; val_gene_expr_recon_loss: 31308675.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32218295.7083; val_optim_loss: 32218295.7083
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9338; val_auprc_score: 0.9847; val_best_acc_score: 0.9239; val_best_f1_score: 0.9561; train_kl_reg_loss: 62427.5405; train_edge_recon_loss: 834389.9691; train_gene_expr_recon_loss: 31101132.1721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31997949.6233; train_optim_loss: 31997949.6233; val_kl_reg_loss: 60506.6791; val_edge_recon_loss: 854729.4753; val_gene_expr_recon_loss: 30923021.3750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31838257.5417; val_optim_loss: 31838257.5417
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9331; val_auprc_score: 0.9850; val_best_acc_score: 0.9222; val_best_f1_score: 0.9558; train_kl_reg_loss: 58313.5281; train_edge_recon_loss: 836220.3608; train_gene_expr_recon_loss: 30751701.7116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31646235.6140; train_optim_loss: 31646235.6140; val_kl_reg_loss: 55716.2981; val_edge_recon_loss: 817468.4518; val_gene_expr_recon_loss: 30632640.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31505824.9167; val_optim_loss: 31505824.9167
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9363; val_auprc_score: 0.9857; val_best_acc_score: 0.9264; val_best_f1_score: 0.9576; train_kl_reg_loss: 54274.7896; train_edge_recon_loss: 821874.3464; train_gene_expr_recon_loss: 30462660.1209; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31338809.2744; train_optim_loss: 31338809.2744; val_kl_reg_loss: 51937.7478; val_edge_recon_loss: 847214.1250; val_gene_expr_recon_loss: 30366442.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31265594.0833; val_optim_loss: 31265594.0833
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9369; val_auprc_score: 0.9863; val_best_acc_score: 0.9270; val_best_f1_score: 0.9579; train_kl_reg_loss: 50681.1913; train_edge_recon_loss: 819774.5124; train_gene_expr_recon_loss: 30227332.7535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31097788.4186; train_optim_loss: 31097788.4186; val_kl_reg_loss: 48873.5806; val_edge_recon_loss: 837751.4948; val_gene_expr_recon_loss: 30149825.7083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31036450.7917; val_optim_loss: 31036450.7917
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9445; val_auprc_score: 0.9879; val_best_acc_score: 0.9319; val_best_f1_score: 0.9606; train_kl_reg_loss: 47527.5502; train_edge_recon_loss: 821814.1911; train_gene_expr_recon_loss: 30030957.4419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30900299.1535; train_optim_loss: 30900299.1535; val_kl_reg_loss: 46151.7355; val_edge_recon_loss: 825090.4505; val_gene_expr_recon_loss: 29954474.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30825716.4583; val_optim_loss: 30825716.4583
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9452; val_auprc_score: 0.9873; val_best_acc_score: 0.9319; val_best_f1_score: 0.9606; train_kl_reg_loss: 44670.2345; train_edge_recon_loss: 809802.5025; train_gene_expr_recon_loss: 29874807.7674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30729280.4884; train_optim_loss: 30729280.4884; val_kl_reg_loss: 43342.7482; val_edge_recon_loss: 828692.9284; val_gene_expr_recon_loss: 29817063.5417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30689099.2500; val_optim_loss: 30689099.2500
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9424; val_auprc_score: 0.9861; val_best_acc_score: 0.9331; val_best_f1_score: 0.9613; train_kl_reg_loss: 42225.0157; train_edge_recon_loss: 800503.0980; train_gene_expr_recon_loss: 29748443.9023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30591172.0000; train_optim_loss: 30591172.0000; val_kl_reg_loss: 41071.9535; val_edge_recon_loss: 842943.5391; val_gene_expr_recon_loss: 29688526.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30572541.6667; val_optim_loss: 30572541.6667
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9415; val_auprc_score: 0.9858; val_best_acc_score: 0.9349; val_best_f1_score: 0.9624; train_kl_reg_loss: 40183.3658; train_edge_recon_loss: 810916.9907; train_gene_expr_recon_loss: 29643414.4977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30494514.8698; train_optim_loss: 30494514.8698; val_kl_reg_loss: 39297.4115; val_edge_recon_loss: 834574.8685; val_gene_expr_recon_loss: 29605543.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30479415.4167; val_optim_loss: 30479415.4167
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9495; val_auprc_score: 0.9890; val_best_acc_score: 0.9357; val_best_f1_score: 0.9627; train_kl_reg_loss: 38410.0785; train_edge_recon_loss: 801982.0541; train_gene_expr_recon_loss: 29553499.1535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30393891.1953; train_optim_loss: 30393891.1953; val_kl_reg_loss: 37964.2525; val_edge_recon_loss: 823874.0625; val_gene_expr_recon_loss: 29532983.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30394822.3333; val_optim_loss: 30394822.3333
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9487; val_auprc_score: 0.9877; val_best_acc_score: 0.9383; val_best_f1_score: 0.9639; train_kl_reg_loss: 36816.4051; train_edge_recon_loss: 801076.6275; train_gene_expr_recon_loss: 29489376.6233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30327269.6558; train_optim_loss: 30327269.6558; val_kl_reg_loss: 36171.7855; val_edge_recon_loss: 835241.6406; val_gene_expr_recon_loss: 29461586.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30333000.3333; val_optim_loss: 30333000.3333
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9528; val_auprc_score: 0.9899; val_best_acc_score: 0.9390; val_best_f1_score: 0.9648; train_kl_reg_loss: 35371.9555; train_edge_recon_loss: 796156.9698; train_gene_expr_recon_loss: 29428037.7256; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30259566.7209; train_optim_loss: 30259566.7209; val_kl_reg_loss: 34661.3875; val_edge_recon_loss: 803712.8034; val_gene_expr_recon_loss: 29400925.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30239299.4167; val_optim_loss: 30239299.4167
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9563; val_auprc_score: 0.9903; val_best_acc_score: 0.9423; val_best_f1_score: 0.9664; train_kl_reg_loss: 34090.9274; train_edge_recon_loss: 794396.0466; train_gene_expr_recon_loss: 29374476.2326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30202963.2140; train_optim_loss: 30202963.2140; val_kl_reg_loss: 33548.6237; val_edge_recon_loss: 805532.6849; val_gene_expr_recon_loss: 29369670.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30208751.5417; val_optim_loss: 30208751.5417
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9470; val_auprc_score: 0.9880; val_best_acc_score: 0.9389; val_best_f1_score: 0.9648; train_kl_reg_loss: 32960.0016; train_edge_recon_loss: 798655.9325; train_gene_expr_recon_loss: 29330375.4977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30161991.4884; train_optim_loss: 30161991.4884; val_kl_reg_loss: 32191.9788; val_edge_recon_loss: 802054.5716; val_gene_expr_recon_loss: 29366648.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30200895.0000; val_optim_loss: 30200895.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9562; val_auprc_score: 0.9909; val_best_acc_score: 0.9400; val_best_f1_score: 0.9655; train_kl_reg_loss: 32030.5317; train_edge_recon_loss: 803982.8807; train_gene_expr_recon_loss: 29306416.9581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30142430.3581; train_optim_loss: 30142430.3581; val_kl_reg_loss: 31484.2117; val_edge_recon_loss: 793411.2708; val_gene_expr_recon_loss: 29301334.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30126230.2500; val_optim_loss: 30126230.2500
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9434; val_auprc_score: 0.9867; val_best_acc_score: 0.9393; val_best_f1_score: 0.9648; train_kl_reg_loss: 30978.8803; train_edge_recon_loss: 791912.1157; train_gene_expr_recon_loss: 29277700.4698; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30100591.4977; train_optim_loss: 30100591.4977; val_kl_reg_loss: 31002.3636; val_edge_recon_loss: 798134.6055; val_gene_expr_recon_loss: 29275794.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30104931.7083; val_optim_loss: 30104931.7083
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9551; val_auprc_score: 0.9890; val_best_acc_score: 0.9436; val_best_f1_score: 0.9671; train_kl_reg_loss: 29009.9930; train_edge_recon_loss: 793281.6455; train_gene_expr_recon_loss: 29139719.5023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29962011.1674; train_optim_loss: 29962011.1674; val_kl_reg_loss: 25804.9952; val_edge_recon_loss: 821427.4180; val_gene_expr_recon_loss: 29169694.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30016927.1667; val_optim_loss: 30016927.1667
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9565; val_auprc_score: 0.9897; val_best_acc_score: 0.9438; val_best_f1_score: 0.9674; train_kl_reg_loss: 28313.6709; train_edge_recon_loss: 795693.3584; train_gene_expr_recon_loss: 29116954.0326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29940961.0419; train_optim_loss: 29940961.0419; val_kl_reg_loss: 25206.6906; val_edge_recon_loss: 827011.2669; val_gene_expr_recon_loss: 29127157.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29979375.1667; val_optim_loss: 29979375.1667
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9549; val_auprc_score: 0.9895; val_best_acc_score: 0.9430; val_best_f1_score: 0.9669; train_kl_reg_loss: 27551.6572; train_edge_recon_loss: 790091.7875; train_gene_expr_recon_loss: 29083498.2837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29901141.7302; train_optim_loss: 29901141.7302; val_kl_reg_loss: 25195.2638; val_edge_recon_loss: 809641.2122; val_gene_expr_recon_loss: 29074334.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29909170.5833; val_optim_loss: 29909170.5833
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9526; val_auprc_score: 0.9884; val_best_acc_score: 0.9440; val_best_f1_score: 0.9676; train_kl_reg_loss: 26790.0629; train_edge_recon_loss: 788399.9413; train_gene_expr_recon_loss: 29056114.7349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29871304.7628; train_optim_loss: 29871304.7628; val_kl_reg_loss: 24916.8463; val_edge_recon_loss: 787100.7656; val_gene_expr_recon_loss: 29058515.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29870533.4583; val_optim_loss: 29870533.4583
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9488; val_auprc_score: 0.9884; val_best_acc_score: 0.9422; val_best_f1_score: 0.9666; train_kl_reg_loss: 26055.8799; train_edge_recon_loss: 790181.0500; train_gene_expr_recon_loss: 29039100.6140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29855337.5767; train_optim_loss: 29855337.5767; val_kl_reg_loss: 24794.7728; val_edge_recon_loss: 798688.0013; val_gene_expr_recon_loss: 29059002.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29882485.1250; val_optim_loss: 29882485.1250
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9545; val_auprc_score: 0.9894; val_best_acc_score: 0.9441; val_best_f1_score: 0.9676; train_kl_reg_loss: 25293.1182; train_edge_recon_loss: 790830.0322; train_gene_expr_recon_loss: 29026594.0837; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29842717.2512; train_optim_loss: 29842717.2512; val_kl_reg_loss: 24099.9421; val_edge_recon_loss: 803117.9883; val_gene_expr_recon_loss: 29037173.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29864391.6667; val_optim_loss: 29864391.6667
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9575; val_auprc_score: 0.9903; val_best_acc_score: 0.9424; val_best_f1_score: 0.9666; train_kl_reg_loss: 24650.4219; train_edge_recon_loss: 789515.6487; train_gene_expr_recon_loss: 29013964.7070; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29828130.8186; train_optim_loss: 29828130.8186; val_kl_reg_loss: 23588.4449; val_edge_recon_loss: 807351.1159; val_gene_expr_recon_loss: 29040008.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29870948.2917; val_optim_loss: 29870948.2917
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9544; val_auprc_score: 0.9899; val_best_acc_score: 0.9401; val_best_f1_score: 0.9654; train_kl_reg_loss: 23936.9028; train_edge_recon_loss: 791152.0292; train_gene_expr_recon_loss: 29006036.5395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29821125.5209; train_optim_loss: 29821125.5209; val_kl_reg_loss: 22956.5052; val_edge_recon_loss: 810698.2370; val_gene_expr_recon_loss: 29035768.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29869422.7500; val_optim_loss: 29869422.7500
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9588; val_auprc_score: 0.9915; val_best_acc_score: 0.9459; val_best_f1_score: 0.9686; train_kl_reg_loss: 23418.1514; train_edge_recon_loss: 785873.0235; train_gene_expr_recon_loss: 28997283.8093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29806575.0000; train_optim_loss: 29806575.0000; val_kl_reg_loss: 22841.1160; val_edge_recon_loss: 798745.0964; val_gene_expr_recon_loss: 28993780.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29815366.9167; val_optim_loss: 29815366.9167
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9498; val_auprc_score: 0.9880; val_best_acc_score: 0.9429; val_best_f1_score: 0.9668; train_kl_reg_loss: 23031.1630; train_edge_recon_loss: 778268.0581; train_gene_expr_recon_loss: 28991735.2419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29793034.4605; train_optim_loss: 29793034.4605; val_kl_reg_loss: 22806.0524; val_edge_recon_loss: 803312.3294; val_gene_expr_recon_loss: 28994310.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29820428.3333; val_optim_loss: 29820428.3333
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9539; val_auprc_score: 0.9900; val_best_acc_score: 0.9428; val_best_f1_score: 0.9670; train_kl_reg_loss: 22564.9376; train_edge_recon_loss: 784759.0122; train_gene_expr_recon_loss: 28980570.3674; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29787894.2977; train_optim_loss: 29787894.2977; val_kl_reg_loss: 22288.5063; val_edge_recon_loss: 781641.2279; val_gene_expr_recon_loss: 28991257.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29795187.2917; val_optim_loss: 29795187.2917
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9587; val_auprc_score: 0.9905; val_best_acc_score: 0.9459; val_best_f1_score: 0.9686; train_kl_reg_loss: 22244.9138; train_edge_recon_loss: 780344.6324; train_gene_expr_recon_loss: 28974966.1628; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29777555.7349; train_optim_loss: 29777555.7349; val_kl_reg_loss: 21954.2699; val_edge_recon_loss: 798885.1133; val_gene_expr_recon_loss: 28988934.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29809773.6667; val_optim_loss: 29809773.6667
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9560; val_auprc_score: 0.9895; val_best_acc_score: 0.9488; val_best_f1_score: 0.9703; train_kl_reg_loss: 21814.1697; train_edge_recon_loss: 782303.8170; train_gene_expr_recon_loss: 28971995.7116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29776113.7070; train_optim_loss: 29776113.7070; val_kl_reg_loss: 21557.0656; val_edge_recon_loss: 792312.3581; val_gene_expr_recon_loss: 28991412.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29805281.5833; val_optim_loss: 29805281.5833
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9600; val_auprc_score: 0.9906; val_best_acc_score: 0.9469; val_best_f1_score: 0.9692; train_kl_reg_loss: 21484.2078; train_edge_recon_loss: 789586.1835; train_gene_expr_recon_loss: 28967986.8977; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29779057.3070; train_optim_loss: 29779057.3070; val_kl_reg_loss: 21177.2541; val_edge_recon_loss: 813266.6953; val_gene_expr_recon_loss: 28976103.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29810547.6667; val_optim_loss: 29810547.6667
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9587; val_auprc_score: 0.9910; val_best_acc_score: 0.9463; val_best_f1_score: 0.9689; train_kl_reg_loss: 21239.3341; train_edge_recon_loss: 779814.0281; train_gene_expr_recon_loss: 28960966.2419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29762019.5488; train_optim_loss: 29762019.5488; val_kl_reg_loss: 21033.4432; val_edge_recon_loss: 782784.5013; val_gene_expr_recon_loss: 28970457.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29774275.6250; val_optim_loss: 29774275.6250
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9543; val_auprc_score: 0.9894; val_best_acc_score: 0.9470; val_best_f1_score: 0.9694; train_kl_reg_loss: 20890.6926; train_edge_recon_loss: 782498.8985; train_gene_expr_recon_loss: 28958424.6186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29761814.1953; train_optim_loss: 29761814.1953; val_kl_reg_loss: 20484.1455; val_edge_recon_loss: 778432.5352; val_gene_expr_recon_loss: 28974977.9583; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29773894.8750; val_optim_loss: 29773894.8750
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9572; val_auprc_score: 0.9902; val_best_acc_score: 0.9475; val_best_f1_score: 0.9697; train_kl_reg_loss: 20594.4144; train_edge_recon_loss: 783476.8434; train_gene_expr_recon_loss: 28953991.9907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29758063.2419; train_optim_loss: 29758063.2419; val_kl_reg_loss: 20284.4427; val_edge_recon_loss: 794015.1302; val_gene_expr_recon_loss: 28976929.8750; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29791229.4167; val_optim_loss: 29791229.4167
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9581; val_auprc_score: 0.9905; val_best_acc_score: 0.9488; val_best_f1_score: 0.9705; train_kl_reg_loss: 20353.9234; train_edge_recon_loss: 779527.7172; train_gene_expr_recon_loss: 28952068.6512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29751950.2930; train_optim_loss: 29751950.2930; val_kl_reg_loss: 20317.5615; val_edge_recon_loss: 760220.5534; val_gene_expr_recon_loss: 28953465.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29734003.6250; val_optim_loss: 29734003.6250
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9559; val_auprc_score: 0.9903; val_best_acc_score: 0.9485; val_best_f1_score: 0.9702; train_kl_reg_loss: 20099.5381; train_edge_recon_loss: 780269.8223; train_gene_expr_recon_loss: 28949187.9767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29749557.3395; train_optim_loss: 29749557.3395; val_kl_reg_loss: 20193.1279; val_edge_recon_loss: 773465.4674; val_gene_expr_recon_loss: 28964147.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29757806.0833; val_optim_loss: 29757806.0833
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9587; val_auprc_score: 0.9903; val_best_acc_score: 0.9476; val_best_f1_score: 0.9697; train_kl_reg_loss: 19905.9845; train_edge_recon_loss: 776555.2066; train_gene_expr_recon_loss: 28946046.4651; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29742507.6140; train_optim_loss: 29742507.6140; val_kl_reg_loss: 19590.6519; val_edge_recon_loss: 790830.4440; val_gene_expr_recon_loss: 28982152.7917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29792573.8750; val_optim_loss: 29792573.8750
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9576; val_auprc_score: 0.9901; val_best_acc_score: 0.9492; val_best_f1_score: 0.9708; train_kl_reg_loss: 19630.1600; train_edge_recon_loss: 780917.4431; train_gene_expr_recon_loss: 28941936.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29742484.3721; train_optim_loss: 29742484.3721; val_kl_reg_loss: 19291.1868; val_edge_recon_loss: 767755.4245; val_gene_expr_recon_loss: 28971508.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29758554.6250; val_optim_loss: 29758554.6250
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9573; val_auprc_score: 0.9900; val_best_acc_score: 0.9485; val_best_f1_score: 0.9700; train_kl_reg_loss: 19372.4538; train_edge_recon_loss: 780893.8371; train_gene_expr_recon_loss: 28940785.0279; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29741051.2791; train_optim_loss: 29741051.2791; val_kl_reg_loss: 19203.9580; val_edge_recon_loss: 808312.4818; val_gene_expr_recon_loss: 28959110.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29786626.7083; val_optim_loss: 29786626.7083

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9612; val_auprc_score: 0.9913; val_best_acc_score: 0.9520; val_best_f1_score: 0.9723; train_kl_reg_loss: 19319.5829; train_edge_recon_loss: 771603.9992; train_gene_expr_recon_loss: 28906502.2791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29697425.8930; train_optim_loss: 29697425.8930; val_kl_reg_loss: 19155.0582; val_edge_recon_loss: 785351.2207; val_gene_expr_recon_loss: 28912556.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29717063.2500; val_optim_loss: 29717063.2500
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9608; val_auprc_score: 0.9907; val_best_acc_score: 0.9477; val_best_f1_score: 0.9697; train_kl_reg_loss: 19288.5421; train_edge_recon_loss: 776678.8890; train_gene_expr_recon_loss: 28902448.2465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29698415.6651; train_optim_loss: 29698415.6651; val_kl_reg_loss: 19210.7799; val_edge_recon_loss: 804938.9922; val_gene_expr_recon_loss: 28917042.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29741192.5000; val_optim_loss: 29741192.5000
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9593; val_auprc_score: 0.9911; val_best_acc_score: 0.9455; val_best_f1_score: 0.9687; train_kl_reg_loss: 19300.6136; train_edge_recon_loss: 775121.7077; train_gene_expr_recon_loss: 28903373.7721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29697796.1628; train_optim_loss: 29697796.1628; val_kl_reg_loss: 19209.4136; val_edge_recon_loss: 783000.3164; val_gene_expr_recon_loss: 28918810.0833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29721019.8750; val_optim_loss: 29721019.8750
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9614; val_auprc_score: 0.9912; val_best_acc_score: 0.9498; val_best_f1_score: 0.9709; train_kl_reg_loss: 19316.6968; train_edge_recon_loss: 785350.2358; train_gene_expr_recon_loss: 28900660.9442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29705327.8558; train_optim_loss: 29705327.8558; val_kl_reg_loss: 19212.9412; val_edge_recon_loss: 792806.5430; val_gene_expr_recon_loss: 28918393.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29730412.5417; val_optim_loss: 29730412.5417
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9603; val_auprc_score: 0.9906; val_best_acc_score: 0.9511; val_best_f1_score: 0.9717; train_kl_reg_loss: 19365.5475; train_edge_recon_loss: 776556.6660; train_gene_expr_recon_loss: 28904319.4372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29700241.6093; train_optim_loss: 29700241.6093; val_kl_reg_loss: 19294.3075; val_edge_recon_loss: 793610.3776; val_gene_expr_recon_loss: 28918388.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29731293.2917; val_optim_loss: 29731293.2917

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9607; val_auprc_score: 0.9903; val_best_acc_score: 0.9527; val_best_f1_score: 0.9726; train_kl_reg_loss: 19368.9328; train_edge_recon_loss: 772753.7681; train_gene_expr_recon_loss: 28894816.7767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29686939.5302; train_optim_loss: 29686939.5302; val_kl_reg_loss: 19317.4355; val_edge_recon_loss: 774273.0143; val_gene_expr_recon_loss: 28908592.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29702183.1667; val_optim_loss: 29702183.1667
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9577; val_auprc_score: 0.9895; val_best_acc_score: 0.9480; val_best_f1_score: 0.9700; train_kl_reg_loss: 19385.8738; train_edge_recon_loss: 781234.6097; train_gene_expr_recon_loss: 28895321.2093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29695941.6651; train_optim_loss: 29695941.6651; val_kl_reg_loss: 19294.7647; val_edge_recon_loss: 795684.7708; val_gene_expr_recon_loss: 28911301.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29726281.3750; val_optim_loss: 29726281.3750
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9591; val_auprc_score: 0.9908; val_best_acc_score: 0.9511; val_best_f1_score: 0.9717; train_kl_reg_loss: 19389.3610; train_edge_recon_loss: 775778.1668; train_gene_expr_recon_loss: 28897841.6884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29693009.1860; train_optim_loss: 29693009.1860; val_kl_reg_loss: 19248.4898; val_edge_recon_loss: 792730.3503; val_gene_expr_recon_loss: 28912428.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29724407.0833; val_optim_loss: 29724407.0833
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9607; val_auprc_score: 0.9911; val_best_acc_score: 0.9498; val_best_f1_score: 0.9710; train_kl_reg_loss: 19376.9062; train_edge_recon_loss: 775251.1211; train_gene_expr_recon_loss: 28895792.1395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29690420.1302; train_optim_loss: 29690420.1302; val_kl_reg_loss: 19291.1890; val_edge_recon_loss: 785106.2279; val_gene_expr_recon_loss: 28905271.1667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29709668.4583; val_optim_loss: 29709668.4583
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9572; val_auprc_score: 0.9891; val_best_acc_score: 0.9508; val_best_f1_score: 0.9715; train_kl_reg_loss: 19371.3340; train_edge_recon_loss: 778879.4153; train_gene_expr_recon_loss: 28896721.3814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29694972.1302; train_optim_loss: 29694972.1302; val_kl_reg_loss: 19297.1311; val_edge_recon_loss: 798047.2539; val_gene_expr_recon_loss: 28932146.6250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29749490.9583; val_optim_loss: 29749490.9583

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9622; val_auprc_score: 0.9915; val_best_acc_score: 0.9508; val_best_f1_score: 0.9716; train_kl_reg_loss: 19378.3895; train_edge_recon_loss: 774581.9560; train_gene_expr_recon_loss: 28897298.4605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29691258.7721; train_optim_loss: 29691258.7721; val_kl_reg_loss: 19260.2178; val_edge_recon_loss: 777809.1081; val_gene_expr_recon_loss: 28914290.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29711360.0833; val_optim_loss: 29711360.0833
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9548; val_auprc_score: 0.9894; val_best_acc_score: 0.9469; val_best_f1_score: 0.9693; train_kl_reg_loss: 19384.0045; train_edge_recon_loss: 777773.0001; train_gene_expr_recon_loss: 28894441.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29691598.6698; train_optim_loss: 29691598.6698; val_kl_reg_loss: 19284.7408; val_edge_recon_loss: 808473.2487; val_gene_expr_recon_loss: 28907849.0417; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29735607.0417; val_optim_loss: 29735607.0417
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9586; val_auprc_score: 0.9898; val_best_acc_score: 0.9508; val_best_f1_score: 0.9716; train_kl_reg_loss: 19382.4411; train_edge_recon_loss: 763272.9285; train_gene_expr_recon_loss: 28897746.6605; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29680402.0326; train_optim_loss: 29680402.0326; val_kl_reg_loss: 19285.5160; val_edge_recon_loss: 779622.4544; val_gene_expr_recon_loss: 28916001.1250; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29714909.0833; val_optim_loss: 29714909.0833
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9592; val_auprc_score: 0.9907; val_best_acc_score: 0.9475; val_best_f1_score: 0.9698; train_kl_reg_loss: 19380.1679; train_edge_recon_loss: 779894.2786; train_gene_expr_recon_loss: 28895130.6512; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29694405.1302; train_optim_loss: 29694405.1302; val_kl_reg_loss: 19305.4819; val_edge_recon_loss: 786349.5130; val_gene_expr_recon_loss: 28922782.8333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29728437.7500; val_optim_loss: 29728437.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 172 min 57 sec.
Using best model state, which was in epoch 53.

--- MODEL EVALUATION ---
val AUROC score: 0.9580
val AUPRC score: 0.9907
val best accuracy score: 0.9495
val best F1 score: 0.9708
val target rna MSE score: 1.0394
val source rna MSE score: 0.5257
Val cat covariate0 mean sim diff: -0.0049

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
