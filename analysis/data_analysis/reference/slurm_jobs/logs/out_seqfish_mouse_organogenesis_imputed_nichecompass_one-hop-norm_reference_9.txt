[True]
Run timestamp: 07082024_105223_9.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--no-include_omnipath_gps', '--include_nichenet_gps', '--no-include_mebocost_gps', '--no-include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--seed', '0', '--timestamp_suffix', '_9']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1287.
Number of gene programs after filtering and combining: 1287.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1286, n_latent: 1286, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1286, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1286, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8588; val_auprc_score: 0.9695; val_best_acc_score: 0.8718; val_best_f1_score: 0.9288; train_kl_reg_loss: 145250.0911; train_edge_recon_loss: 1154364.3578; train_gene_expr_recon_loss: 14961727.6906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 16261342.1147; train_optim_loss: 16261342.1147; val_kl_reg_loss: 105933.2702; val_edge_recon_loss: 1089958.5309; val_gene_expr_recon_loss: 13076097.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 14271988.7634; val_optim_loss: 14271988.7634
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8810; val_auprc_score: 0.9753; val_best_acc_score: 0.8864; val_best_f1_score: 0.9364; train_kl_reg_loss: 105943.8805; train_edge_recon_loss: 998281.8707; train_gene_expr_recon_loss: 12471040.1864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 13575265.9594; train_optim_loss: 13575265.9594; val_kl_reg_loss: 96943.7233; val_edge_recon_loss: 941074.9059; val_gene_expr_recon_loss: 11969310.0108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 13007328.6237; val_optim_loss: 13007328.6237
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8875; val_auprc_score: 0.9754; val_best_acc_score: 0.8874; val_best_f1_score: 0.9366; train_kl_reg_loss: 90084.4345; train_edge_recon_loss: 925993.0475; train_gene_expr_recon_loss: 11595228.8710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12611306.3381; train_optim_loss: 12611306.3381; val_kl_reg_loss: 83967.6056; val_edge_recon_loss: 915871.8952; val_gene_expr_recon_loss: 11270424.2688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 12270263.7957; val_optim_loss: 12270263.7957
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8960; val_auprc_score: 0.9779; val_best_acc_score: 0.8962; val_best_f1_score: 0.9411; train_kl_reg_loss: 78268.8692; train_edge_recon_loss: 897997.5696; train_gene_expr_recon_loss: 11018614.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11994880.6941; train_optim_loss: 11994880.6941; val_kl_reg_loss: 74177.0532; val_edge_recon_loss: 904121.7030; val_gene_expr_recon_loss: 10795166.2151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11773465.0000; val_optim_loss: 11773465.0000
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9015; val_auprc_score: 0.9788; val_best_acc_score: 0.9013; val_best_f1_score: 0.9434; train_kl_reg_loss: 69337.1141; train_edge_recon_loss: 881673.5762; train_gene_expr_recon_loss: 10619155.4564; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11570166.1493; train_optim_loss: 11570166.1493; val_kl_reg_loss: 65362.6300; val_edge_recon_loss: 898577.3831; val_gene_expr_recon_loss: 10458490.6452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11422430.7097; val_optim_loss: 11422430.7097
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9125; val_auprc_score: 0.9813; val_best_acc_score: 0.9103; val_best_f1_score: 0.9491; train_kl_reg_loss: 62166.8855; train_edge_recon_loss: 866047.0932; train_gene_expr_recon_loss: 10334991.9140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11263205.9044; train_optim_loss: 11263205.9044; val_kl_reg_loss: 58575.7490; val_edge_recon_loss: 849518.5094; val_gene_expr_recon_loss: 10235685.0108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11143779.2903; val_optim_loss: 11143779.2903
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9188; val_auprc_score: 0.9828; val_best_acc_score: 0.9106; val_best_f1_score: 0.9489; train_kl_reg_loss: 56344.0440; train_edge_recon_loss: 856621.5299; train_gene_expr_recon_loss: 10130552.9403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11043518.5018; train_optim_loss: 11043518.5018; val_kl_reg_loss: 53132.0381; val_edge_recon_loss: 843025.7997; val_gene_expr_recon_loss: 10082450.7527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10978608.6129; val_optim_loss: 10978608.6129
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9281; val_auprc_score: 0.9848; val_best_acc_score: 0.9162; val_best_f1_score: 0.9518; train_kl_reg_loss: 50935.9267; train_edge_recon_loss: 839923.7688; train_gene_expr_recon_loss: 9987741.6272; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10878601.3297; train_optim_loss: 10878601.3297; val_kl_reg_loss: 47704.8910; val_edge_recon_loss: 845001.5296; val_gene_expr_recon_loss: 9946799.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10839505.7957; val_optim_loss: 10839505.7957
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9316; val_auprc_score: 0.9845; val_best_acc_score: 0.9197; val_best_f1_score: 0.9535; train_kl_reg_loss: 45970.5648; train_edge_recon_loss: 842755.2101; train_gene_expr_recon_loss: 9881711.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10770436.9857; train_optim_loss: 10770436.9857; val_kl_reg_loss: 43682.4264; val_edge_recon_loss: 834580.3676; val_gene_expr_recon_loss: 9836914.3441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10715177.1613; val_optim_loss: 10715177.1613
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9311; val_auprc_score: 0.9845; val_best_acc_score: 0.9207; val_best_f1_score: 0.9544; train_kl_reg_loss: 41829.6238; train_edge_recon_loss: 824796.2188; train_gene_expr_recon_loss: 9808012.6930; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10674638.5293; train_optim_loss: 10674638.5293; val_kl_reg_loss: 39867.8112; val_edge_recon_loss: 837229.2883; val_gene_expr_recon_loss: 9777643.0968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10654740.2043; val_optim_loss: 10654740.2043
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9381; val_auprc_score: 0.9856; val_best_acc_score: 0.9265; val_best_f1_score: 0.9574; train_kl_reg_loss: 38489.3975; train_edge_recon_loss: 814250.8584; train_gene_expr_recon_loss: 9752400.4755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10605140.7264; train_optim_loss: 10605140.7264; val_kl_reg_loss: 36646.8027; val_edge_recon_loss: 842916.1788; val_gene_expr_recon_loss: 9729012.8602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10608575.8495; val_optim_loss: 10608575.8495
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9430; val_auprc_score: 0.9875; val_best_acc_score: 0.9288; val_best_f1_score: 0.9589; train_kl_reg_loss: 35435.1119; train_edge_recon_loss: 813703.1457; train_gene_expr_recon_loss: 9714673.3955; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10563811.6535; train_optim_loss: 10563811.6535; val_kl_reg_loss: 34694.8734; val_edge_recon_loss: 813298.0195; val_gene_expr_recon_loss: 9717712.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10565705.3118; val_optim_loss: 10565705.3118
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9434; val_auprc_score: 0.9878; val_best_acc_score: 0.9299; val_best_f1_score: 0.9597; train_kl_reg_loss: 32743.7745; train_edge_recon_loss: 818345.3512; train_gene_expr_recon_loss: 9684539.8495; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10535628.9761; train_optim_loss: 10535628.9761; val_kl_reg_loss: 31638.2277; val_edge_recon_loss: 821082.8703; val_gene_expr_recon_loss: 9693521.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10546243.0108; val_optim_loss: 10546243.0108
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9506; val_auprc_score: 0.9888; val_best_acc_score: 0.9403; val_best_f1_score: 0.9657; train_kl_reg_loss: 30310.4310; train_edge_recon_loss: 812484.8241; train_gene_expr_recon_loss: 9662637.2210; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10505432.4683; train_optim_loss: 10505432.4683; val_kl_reg_loss: 29255.0105; val_edge_recon_loss: 800152.2809; val_gene_expr_recon_loss: 9656414.1075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10485821.4301; val_optim_loss: 10485821.4301
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9506; val_auprc_score: 0.9892; val_best_acc_score: 0.9331; val_best_f1_score: 0.9614; train_kl_reg_loss: 28107.9789; train_edge_recon_loss: 800797.9329; train_gene_expr_recon_loss: 9722878.4313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10551784.3417; train_optim_loss: 10551784.3417; val_kl_reg_loss: 27384.5664; val_edge_recon_loss: 820785.0867; val_gene_expr_recon_loss: 9709850.8065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10558020.4086; val_optim_loss: 10558020.4086
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9503; val_auprc_score: 0.9888; val_best_acc_score: 0.9427; val_best_f1_score: 0.9669; train_kl_reg_loss: 26852.3099; train_edge_recon_loss: 799785.8706; train_gene_expr_recon_loss: 9672112.3763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10498750.5663; train_optim_loss: 10498750.5663; val_kl_reg_loss: 26553.7536; val_edge_recon_loss: 799516.7641; val_gene_expr_recon_loss: 9666998.8817; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10493069.3763; val_optim_loss: 10493069.3763
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9526; val_auprc_score: 0.9892; val_best_acc_score: 0.9443; val_best_f1_score: 0.9678; train_kl_reg_loss: 25575.3273; train_edge_recon_loss: 798976.6817; train_gene_expr_recon_loss: 9648851.1338; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10473403.1422; train_optim_loss: 10473403.1422; val_kl_reg_loss: 24849.1310; val_edge_recon_loss: 810917.5000; val_gene_expr_recon_loss: 9637266.6882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10473033.3441; val_optim_loss: 10473033.3441
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9576; val_auprc_score: 0.9905; val_best_acc_score: 0.9465; val_best_f1_score: 0.9691; train_kl_reg_loss: 24264.8677; train_edge_recon_loss: 794614.5635; train_gene_expr_recon_loss: 9636618.5293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10455497.9713; train_optim_loss: 10455497.9713; val_kl_reg_loss: 24185.1007; val_edge_recon_loss: 803842.5847; val_gene_expr_recon_loss: 9663336.0968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10491363.7527; val_optim_loss: 10491363.7527
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9576; val_auprc_score: 0.9907; val_best_acc_score: 0.9462; val_best_f1_score: 0.9689; train_kl_reg_loss: 23029.9921; train_edge_recon_loss: 797946.4616; train_gene_expr_recon_loss: 9628201.4062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10449177.8566; train_optim_loss: 10449177.8566; val_kl_reg_loss: 22868.6200; val_edge_recon_loss: 802102.8945; val_gene_expr_recon_loss: 9631925.3011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10456896.7957; val_optim_loss: 10456896.7957
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9561; val_auprc_score: 0.9894; val_best_acc_score: 0.9463; val_best_f1_score: 0.9689; train_kl_reg_loss: 22035.5872; train_edge_recon_loss: 788200.5423; train_gene_expr_recon_loss: 9619695.4875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10429931.6296; train_optim_loss: 10429931.6296; val_kl_reg_loss: 21651.3136; val_edge_recon_loss: 810082.3380; val_gene_expr_recon_loss: 9619593.5699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10451327.2151; val_optim_loss: 10451327.2151
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9596; val_auprc_score: 0.9911; val_best_acc_score: 0.9481; val_best_f1_score: 0.9701; train_kl_reg_loss: 21010.7033; train_edge_recon_loss: 787819.2258; train_gene_expr_recon_loss: 9616293.1422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10425123.0729; train_optim_loss: 10425123.0729; val_kl_reg_loss: 20481.0756; val_edge_recon_loss: 778183.0161; val_gene_expr_recon_loss: 9611657.8495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10410321.9247; val_optim_loss: 10410321.9247
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9554; val_auprc_score: 0.9892; val_best_acc_score: 0.9449; val_best_f1_score: 0.9681; train_kl_reg_loss: 20178.8386; train_edge_recon_loss: 789320.3604; train_gene_expr_recon_loss: 9608515.2031; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10418014.4026; train_optim_loss: 10418014.4026; val_kl_reg_loss: 19618.3572; val_edge_recon_loss: 812458.0161; val_gene_expr_recon_loss: 9610480.5699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10442557.0000; val_optim_loss: 10442557.0000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9627; val_auprc_score: 0.9919; val_best_acc_score: 0.9490; val_best_f1_score: 0.9705; train_kl_reg_loss: 19439.9218; train_edge_recon_loss: 782588.4068; train_gene_expr_recon_loss: 9603643.5233; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10405671.8447; train_optim_loss: 10405671.8447; val_kl_reg_loss: 19132.2468; val_edge_recon_loss: 793757.0833; val_gene_expr_recon_loss: 9600329.0215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10413218.3978; val_optim_loss: 10413218.3978
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9576; val_auprc_score: 0.9898; val_best_acc_score: 0.9457; val_best_f1_score: 0.9687; train_kl_reg_loss: 18829.9383; train_edge_recon_loss: 785686.6599; train_gene_expr_recon_loss: 9600448.8100; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10404965.4217; train_optim_loss: 10404965.4217; val_kl_reg_loss: 18681.0260; val_edge_recon_loss: 791772.3488; val_gene_expr_recon_loss: 9614037.4946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10424490.8387; val_optim_loss: 10424490.8387
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9584; val_auprc_score: 0.9910; val_best_acc_score: 0.9468; val_best_f1_score: 0.9693; train_kl_reg_loss: 18280.5292; train_edge_recon_loss: 782707.9846; train_gene_expr_recon_loss: 9597966.0908; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10398954.6093; train_optim_loss: 10398954.6093; val_kl_reg_loss: 17967.7809; val_edge_recon_loss: 776975.5013; val_gene_expr_recon_loss: 9601056.8925; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10396000.1613; val_optim_loss: 10396000.1613
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.8569; val_auprc_score: 0.9698; val_best_acc_score: 0.8765; val_best_f1_score: 0.9312; train_kl_reg_loss: 11413.4663; train_edge_recon_loss: 914542.9787; train_gene_expr_recon_loss: 11344555.4397; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 12270511.8925; train_optim_loss: 12270511.8925; val_kl_reg_loss: 12005.3375; val_edge_recon_loss: 913833.2359; val_gene_expr_recon_loss: 10570373.2258; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11496211.8387; val_optim_loss: 11496211.8387
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.8655; val_auprc_score: 0.9719; val_best_acc_score: 0.8799; val_best_f1_score: 0.9334; train_kl_reg_loss: 14166.9456; train_edge_recon_loss: 873239.0473; train_gene_expr_recon_loss: 10379939.4086; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11267345.3943; train_optim_loss: 11267345.3943; val_kl_reg_loss: 15649.5497; val_edge_recon_loss: 864864.9026; val_gene_expr_recon_loss: 10266695.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11147209.8710; val_optim_loss: 11147209.8710
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.8644; val_auprc_score: 0.9707; val_best_acc_score: 0.8754; val_best_f1_score: 0.9303; train_kl_reg_loss: 16270.2658; train_edge_recon_loss: 858287.2401; train_gene_expr_recon_loss: 10191096.8184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 11065654.3297; train_optim_loss: 11065654.3297; val_kl_reg_loss: 16420.7857; val_edge_recon_loss: 874556.3038; val_gene_expr_recon_loss: 10143912.8172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 11034889.9032; val_optim_loss: 11034889.9032
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.8656; val_auprc_score: 0.9708; val_best_acc_score: 0.8806; val_best_f1_score: 0.9326; train_kl_reg_loss: 16528.4162; train_edge_recon_loss: 845655.6282; train_gene_expr_recon_loss: 10086807.0299; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10948991.0896; train_optim_loss: 10948991.0896; val_kl_reg_loss: 16360.4608; val_edge_recon_loss: 852723.3501; val_gene_expr_recon_loss: 10041467.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10910551.7634; val_optim_loss: 10910551.7634

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.8696; val_auprc_score: 0.9712; val_best_acc_score: 0.8793; val_best_f1_score: 0.9318; train_kl_reg_loss: 16381.0639; train_edge_recon_loss: 844596.4153; train_gene_expr_recon_loss: 10021534.8877; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10882512.3608; train_optim_loss: 10882512.3608; val_kl_reg_loss: 16384.3539; val_edge_recon_loss: 861222.9200; val_gene_expr_recon_loss: 10015323.7957; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10892931.0538; val_optim_loss: 10892931.0538
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.8625; val_auprc_score: 0.9700; val_best_acc_score: 0.8813; val_best_f1_score: 0.9332; train_kl_reg_loss: 16447.5214; train_edge_recon_loss: 839618.3362; train_gene_expr_recon_loss: 10010589.5185; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10866655.3668; train_optim_loss: 10866655.3668; val_kl_reg_loss: 16487.0465; val_edge_recon_loss: 847238.8982; val_gene_expr_recon_loss: 10006356.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10870082.9247; val_optim_loss: 10870082.9247
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.8691; val_auprc_score: 0.9708; val_best_acc_score: 0.8840; val_best_f1_score: 0.9343; train_kl_reg_loss: 16552.3444; train_edge_recon_loss: 844622.4592; train_gene_expr_recon_loss: 9999358.2162; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10860533.0263; train_optim_loss: 10860533.0263; val_kl_reg_loss: 16355.9406; val_edge_recon_loss: 845995.9879; val_gene_expr_recon_loss: 9991294.6774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10853646.5699; val_optim_loss: 10853646.5699
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.8698; val_auprc_score: 0.9718; val_best_acc_score: 0.8828; val_best_f1_score: 0.9340; train_kl_reg_loss: 16581.1883; train_edge_recon_loss: 842887.5821; train_gene_expr_recon_loss: 9985612.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10845081.5998; train_optim_loss: 10845081.5998; val_kl_reg_loss: 16601.3015; val_edge_recon_loss: 846921.1065; val_gene_expr_recon_loss: 9978157.9785; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 10841680.3763; val_optim_loss: 10841680.3763

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 70 min 21 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9602
val AUPRC score: 0.9909
val best accuracy score: 0.9480
val best F1 score: 0.9700
val target rna MSE score: 1.2285
val source rna MSE score: 2.1715
Val cat covariate0 mean sim diff: -0.0008

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
