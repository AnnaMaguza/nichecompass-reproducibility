[True]
Run timestamp: 09102023_184234_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7582; val_auprc_score: 0.7839; val_best_acc_score: 0.5458; val_best_f1_score: 0.6849; train_kl_reg_loss: 46117.0902; train_edge_recon_loss: 3502009.2176; train_gene_expr_recon_loss: 13494970.9160; train_masked_gp_l1_reg_loss: 92523.7473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1903805.4909; train_chrom_access_recon_loss: 965086.6288; train_global_loss: 20004513.2214; train_optim_loss: 20004513.2214; val_kl_reg_loss: 77981.2771; val_edge_recon_loss: 4062500.3167; val_gene_expr_recon_loss: 12811513.5333; val_masked_gp_l1_reg_loss: 86376.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 427031.2812; val_chrom_access_recon_loss: 933717.0375; val_global_loss: 18399120.1333; val_optim_loss: 18399120.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8315; val_auprc_score: 0.8467; val_best_acc_score: 0.7300; val_best_f1_score: 0.7418; train_kl_reg_loss: 67635.7764; train_edge_recon_loss: 3492086.3263; train_gene_expr_recon_loss: 12593626.0305; train_masked_gp_l1_reg_loss: 83002.9156; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 226403.6384; train_chrom_access_recon_loss: 917836.7080; train_global_loss: 17380591.3969; train_optim_loss: 17380591.3969; val_kl_reg_loss: 58994.4555; val_edge_recon_loss: 3914149.4333; val_gene_expr_recon_loss: 12474105.8000; val_masked_gp_l1_reg_loss: 82897.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132276.9844; val_chrom_access_recon_loss: 912689.5833; val_global_loss: 17575113.2000; val_optim_loss: 17575113.2000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8778; val_auprc_score: 0.8681; val_best_acc_score: 0.7777; val_best_f1_score: 0.7997; train_kl_reg_loss: 63832.1690; train_edge_recon_loss: 3128554.6641; train_gene_expr_recon_loss: 12462699.3435; train_masked_gp_l1_reg_loss: 94773.1901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111066.4548; train_chrom_access_recon_loss: 909657.5911; train_global_loss: 16770583.4733; train_optim_loss: 16770583.4733; val_kl_reg_loss: 77410.6620; val_edge_recon_loss: 2994835.8833; val_gene_expr_recon_loss: 12393620.1333; val_masked_gp_l1_reg_loss: 101912.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99039.9141; val_chrom_access_recon_loss: 903706.3042; val_global_loss: 16570525.6667; val_optim_loss: 16570525.6667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8820; val_auprc_score: 0.8768; val_best_acc_score: 0.7843; val_best_f1_score: 0.8033; train_kl_reg_loss: 85077.9267; train_edge_recon_loss: 2919633.7328; train_gene_expr_recon_loss: 12303462.1527; train_masked_gp_l1_reg_loss: 100213.4571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88192.6368; train_chrom_access_recon_loss: 900618.8721; train_global_loss: 16397198.8397; train_optim_loss: 16397198.8397; val_kl_reg_loss: 87975.0521; val_edge_recon_loss: 2900127.6500; val_gene_expr_recon_loss: 12250918.0000; val_masked_gp_l1_reg_loss: 100112.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80598.4766; val_chrom_access_recon_loss: 894885.4292; val_global_loss: 16314616.0000; val_optim_loss: 16314616.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9071; val_auprc_score: 0.8916; val_best_acc_score: 0.8252; val_best_f1_score: 0.8409; train_kl_reg_loss: 82224.7027; train_edge_recon_loss: 2862550.0725; train_gene_expr_recon_loss: 12166425.8931; train_masked_gp_l1_reg_loss: 100535.3619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76566.6530; train_chrom_access_recon_loss: 891401.8788; train_global_loss: 16179704.6260; train_optim_loss: 16179704.6260; val_kl_reg_loss: 82421.5984; val_edge_recon_loss: 2839422.1833; val_gene_expr_recon_loss: 12143907.6667; val_masked_gp_l1_reg_loss: 101870.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74740.4766; val_chrom_access_recon_loss: 888710.4458; val_global_loss: 16131072.0667; val_optim_loss: 16131072.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9132; val_auprc_score: 0.9008; val_best_acc_score: 0.8385; val_best_f1_score: 0.8502; train_kl_reg_loss: 84041.7179; train_edge_recon_loss: 2816095.0992; train_gene_expr_recon_loss: 12075344.6031; train_masked_gp_l1_reg_loss: 102135.3748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72904.3420; train_chrom_access_recon_loss: 885816.2972; train_global_loss: 16036337.3969; train_optim_loss: 16036337.3969; val_kl_reg_loss: 82386.9953; val_edge_recon_loss: 2849786.4000; val_gene_expr_recon_loss: 12089613.7333; val_masked_gp_l1_reg_loss: 102875.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71994.3125; val_chrom_access_recon_loss: 887394.5583; val_global_loss: 16084050.7333; val_optim_loss: 16084050.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9275; val_auprc_score: 0.9151; val_best_acc_score: 0.8526; val_best_f1_score: 0.8634; train_kl_reg_loss: 81174.4270; train_edge_recon_loss: 2791939.4141; train_gene_expr_recon_loss: 11980725.7252; train_masked_gp_l1_reg_loss: 103642.3603; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69719.0825; train_chrom_access_recon_loss: 879437.7533; train_global_loss: 15906638.7328; train_optim_loss: 15906638.7328; val_kl_reg_loss: 76370.3625; val_edge_recon_loss: 2820289.8667; val_gene_expr_recon_loss: 11951500.4667; val_masked_gp_l1_reg_loss: 104331.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68649.6250; val_chrom_access_recon_loss: 875880.2917; val_global_loss: 15897022.0667; val_optim_loss: 15897022.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9361; val_auprc_score: 0.9188; val_best_acc_score: 0.8725; val_best_f1_score: 0.8802; train_kl_reg_loss: 78399.9754; train_edge_recon_loss: 2778474.7996; train_gene_expr_recon_loss: 11912019.2519; train_masked_gp_l1_reg_loss: 104928.5368; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67131.9663; train_chrom_access_recon_loss: 875212.9943; train_global_loss: 15816167.4809; train_optim_loss: 15816167.4809; val_kl_reg_loss: 81262.8151; val_edge_recon_loss: 2774595.5500; val_gene_expr_recon_loss: 11931566.2000; val_masked_gp_l1_reg_loss: 105538.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66479.9766; val_chrom_access_recon_loss: 879641.3208; val_global_loss: 15839085.0667; val_optim_loss: 15839085.0667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9365; val_auprc_score: 0.9225; val_best_acc_score: 0.8738; val_best_f1_score: 0.8815; train_kl_reg_loss: 80263.2491; train_edge_recon_loss: 2762285.5019; train_gene_expr_recon_loss: 11826484.0687; train_masked_gp_l1_reg_loss: 106042.4948; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66552.9119; train_chrom_access_recon_loss: 868705.3144; train_global_loss: 15710333.5496; train_optim_loss: 15710333.5496; val_kl_reg_loss: 79329.3729; val_edge_recon_loss: 2782131.4167; val_gene_expr_recon_loss: 11844845.6667; val_masked_gp_l1_reg_loss: 106366.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65915.5469; val_chrom_access_recon_loss: 868558.7250; val_global_loss: 15747147.4000; val_optim_loss: 15747147.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9423; val_auprc_score: 0.9312; val_best_acc_score: 0.8773; val_best_f1_score: 0.8845; train_kl_reg_loss: 79481.9878; train_edge_recon_loss: 2747278.0611; train_gene_expr_recon_loss: 11765759.2366; train_masked_gp_l1_reg_loss: 106549.3953; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65949.7396; train_chrom_access_recon_loss: 865514.1336; train_global_loss: 15630532.6412; train_optim_loss: 15630532.6412; val_kl_reg_loss: 79428.4594; val_edge_recon_loss: 2747354.5000; val_gene_expr_recon_loss: 11747335.4000; val_masked_gp_l1_reg_loss: 107119.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66422.1484; val_chrom_access_recon_loss: 866797.6083; val_global_loss: 15614456.9333; val_optim_loss: 15614456.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9540; val_auprc_score: 0.9435; val_best_acc_score: 0.8875; val_best_f1_score: 0.8930; train_kl_reg_loss: 79799.5356; train_edge_recon_loss: 2744382.8492; train_gene_expr_recon_loss: 11714865.8702; train_masked_gp_l1_reg_loss: 107061.1511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65141.9015; train_chrom_access_recon_loss: 861542.5988; train_global_loss: 15572793.9237; train_optim_loss: 15572793.9237; val_kl_reg_loss: 79742.4557; val_edge_recon_loss: 2742036.0000; val_gene_expr_recon_loss: 11731642.6667; val_masked_gp_l1_reg_loss: 107324.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65077.7930; val_chrom_access_recon_loss: 861316.3458; val_global_loss: 15587139.4667; val_optim_loss: 15587139.4667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9490; val_auprc_score: 0.9324; val_best_acc_score: 0.8903; val_best_f1_score: 0.8958; train_kl_reg_loss: 77627.2790; train_edge_recon_loss: 2741346.0401; train_gene_expr_recon_loss: 11667029.5115; train_masked_gp_l1_reg_loss: 107515.4798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64373.9047; train_chrom_access_recon_loss: 858096.4494; train_global_loss: 15515988.6565; train_optim_loss: 15515988.6565; val_kl_reg_loss: 79769.5094; val_edge_recon_loss: 2742305.6000; val_gene_expr_recon_loss: 11677885.7333; val_masked_gp_l1_reg_loss: 107708.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64035.2031; val_chrom_access_recon_loss: 859721.7458; val_global_loss: 15531426.6667; val_optim_loss: 15531426.6667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9486; val_auprc_score: 0.9381; val_best_acc_score: 0.8829; val_best_f1_score: 0.8891; train_kl_reg_loss: 77532.7731; train_edge_recon_loss: 2729496.5019; train_gene_expr_recon_loss: 11614351.9237; train_masked_gp_l1_reg_loss: 107645.1522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63867.5411; train_chrom_access_recon_loss: 853957.0763; train_global_loss: 15446850.9313; train_optim_loss: 15446850.9313; val_kl_reg_loss: 77899.2698; val_edge_recon_loss: 2748818.4167; val_gene_expr_recon_loss: 11590355.9333; val_masked_gp_l1_reg_loss: 107766.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63497.6445; val_chrom_access_recon_loss: 853553.4125; val_global_loss: 15441892.0667; val_optim_loss: 15441892.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9548; val_auprc_score: 0.9440; val_best_acc_score: 0.8967; val_best_f1_score: 0.9002; train_kl_reg_loss: 76126.0964; train_edge_recon_loss: 2722372.8206; train_gene_expr_recon_loss: 11581116.5878; train_masked_gp_l1_reg_loss: 108038.5732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63261.6081; train_chrom_access_recon_loss: 851588.0038; train_global_loss: 15402503.7481; train_optim_loss: 15402503.7481; val_kl_reg_loss: 78020.0531; val_edge_recon_loss: 2747548.6833; val_gene_expr_recon_loss: 11576931.0667; val_masked_gp_l1_reg_loss: 108257.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62715.0273; val_chrom_access_recon_loss: 848288.4167; val_global_loss: 15421761.1333; val_optim_loss: 15421761.1333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9622; val_auprc_score: 0.9526; val_best_acc_score: 0.9062; val_best_f1_score: 0.9090; train_kl_reg_loss: 75220.4201; train_edge_recon_loss: 2719736.2939; train_gene_expr_recon_loss: 11546401.3817; train_masked_gp_l1_reg_loss: 108354.6393; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62673.0139; train_chrom_access_recon_loss: 849073.4637; train_global_loss: 15361459.2443; train_optim_loss: 15361459.2443; val_kl_reg_loss: 77195.5641; val_edge_recon_loss: 2714157.8333; val_gene_expr_recon_loss: 11558623.8000; val_masked_gp_l1_reg_loss: 108652.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62413.1523; val_chrom_access_recon_loss: 847097.6083; val_global_loss: 15368139.8000; val_optim_loss: 15368139.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9599; val_auprc_score: 0.9477; val_best_acc_score: 0.9069; val_best_f1_score: 0.9106; train_kl_reg_loss: 75543.0581; train_edge_recon_loss: 2708481.0897; train_gene_expr_recon_loss: 11516991.0687; train_masked_gp_l1_reg_loss: 108630.1981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61952.9867; train_chrom_access_recon_loss: 846494.7247; train_global_loss: 15318093.1985; train_optim_loss: 15318093.1985; val_kl_reg_loss: 74748.3708; val_edge_recon_loss: 2732758.2333; val_gene_expr_recon_loss: 11532182.2667; val_masked_gp_l1_reg_loss: 108613.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61412.7148; val_chrom_access_recon_loss: 845274.9833; val_global_loss: 15354990.6667; val_optim_loss: 15354990.6667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9609; val_auprc_score: 0.9491; val_best_acc_score: 0.9074; val_best_f1_score: 0.9112; train_kl_reg_loss: 74780.8369; train_edge_recon_loss: 2705311.7424; train_gene_expr_recon_loss: 11476533.8397; train_masked_gp_l1_reg_loss: 108742.7418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61326.0001; train_chrom_access_recon_loss: 842701.3865; train_global_loss: 15269396.4504; train_optim_loss: 15269396.4504; val_kl_reg_loss: 73899.7573; val_edge_recon_loss: 2726618.8667; val_gene_expr_recon_loss: 11500732.0667; val_masked_gp_l1_reg_loss: 108906.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61390.2500; val_chrom_access_recon_loss: 841922.1333; val_global_loss: 15313468.7333; val_optim_loss: 15313468.7333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9647; val_auprc_score: 0.9561; val_best_acc_score: 0.9100; val_best_f1_score: 0.9131; train_kl_reg_loss: 74734.3210; train_edge_recon_loss: 2706960.5115; train_gene_expr_recon_loss: 11458911.2290; train_masked_gp_l1_reg_loss: 108722.8457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60673.9615; train_chrom_access_recon_loss: 841146.4232; train_global_loss: 15251149.2443; train_optim_loss: 15251149.2443; val_kl_reg_loss: 73925.6443; val_edge_recon_loss: 2714181.9000; val_gene_expr_recon_loss: 11457965.5333; val_masked_gp_l1_reg_loss: 108829.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60450.1602; val_chrom_access_recon_loss: 838324.5125; val_global_loss: 15253677.6000; val_optim_loss: 15253677.6000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9684; val_auprc_score: 0.9610; val_best_acc_score: 0.9153; val_best_f1_score: 0.9167; train_kl_reg_loss: 74868.8224; train_edge_recon_loss: 2701142.1107; train_gene_expr_recon_loss: 11439547.2443; train_masked_gp_l1_reg_loss: 108891.7808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60283.7442; train_chrom_access_recon_loss: 840710.8564; train_global_loss: 15225444.5115; train_optim_loss: 15225444.5115; val_kl_reg_loss: 75813.4443; val_edge_recon_loss: 2704501.3167; val_gene_expr_recon_loss: 11451022.6667; val_masked_gp_l1_reg_loss: 109054.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60219.6211; val_chrom_access_recon_loss: 843086.2875; val_global_loss: 15243697.6667; val_optim_loss: 15243697.6667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9647; val_auprc_score: 0.9562; val_best_acc_score: 0.9080; val_best_f1_score: 0.9115; train_kl_reg_loss: 73619.9698; train_edge_recon_loss: 2705322.7939; train_gene_expr_recon_loss: 11412433.4351; train_masked_gp_l1_reg_loss: 108860.0463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59973.1001; train_chrom_access_recon_loss: 838124.6131; train_global_loss: 15198333.9084; train_optim_loss: 15198333.9084; val_kl_reg_loss: 74160.0573; val_edge_recon_loss: 2702329.1667; val_gene_expr_recon_loss: 11403654.2000; val_masked_gp_l1_reg_loss: 108524.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60288.3359; val_chrom_access_recon_loss: 836704.0250; val_global_loss: 15185659.4000; val_optim_loss: 15185659.4000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9685; val_auprc_score: 0.9590; val_best_acc_score: 0.9173; val_best_f1_score: 0.9204; train_kl_reg_loss: 72180.8921; train_edge_recon_loss: 2696065.9752; train_gene_expr_recon_loss: 11391765.7710; train_masked_gp_l1_reg_loss: 108679.9893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59890.9032; train_chrom_access_recon_loss: 836877.0172; train_global_loss: 15165460.4504; train_optim_loss: 15165460.4504; val_kl_reg_loss: 72649.7464; val_edge_recon_loss: 2705126.0667; val_gene_expr_recon_loss: 11437139.8667; val_masked_gp_l1_reg_loss: 108498.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59246.6641; val_chrom_access_recon_loss: 839081.3583; val_global_loss: 15221741.9333; val_optim_loss: 15221741.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9687; val_auprc_score: 0.9599; val_best_acc_score: 0.9184; val_best_f1_score: 0.9207; train_kl_reg_loss: 73815.6266; train_edge_recon_loss: 2695271.8359; train_gene_expr_recon_loss: 11368548.3053; train_masked_gp_l1_reg_loss: 108433.9836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59806.8599; train_chrom_access_recon_loss: 834715.7405; train_global_loss: 15140592.3664; train_optim_loss: 15140592.3664; val_kl_reg_loss: 72851.3281; val_edge_recon_loss: 2702470.7167; val_gene_expr_recon_loss: 11413006.1333; val_masked_gp_l1_reg_loss: 108364.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59876.7695; val_chrom_access_recon_loss: 838708.2000; val_global_loss: 15195278.4667; val_optim_loss: 15195278.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9701; val_auprc_score: 0.9611; val_best_acc_score: 0.9182; val_best_f1_score: 0.9197; train_kl_reg_loss: 73653.4258; train_edge_recon_loss: 2690835.2710; train_gene_expr_recon_loss: 11349561.2214; train_masked_gp_l1_reg_loss: 108093.4994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59927.8782; train_chrom_access_recon_loss: 832632.8182; train_global_loss: 15114704.0153; train_optim_loss: 15114704.0153; val_kl_reg_loss: 70974.8302; val_edge_recon_loss: 2696474.8667; val_gene_expr_recon_loss: 11369513.4667; val_masked_gp_l1_reg_loss: 107779.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60326.9180; val_chrom_access_recon_loss: 837289.7292; val_global_loss: 15142359.9333; val_optim_loss: 15142359.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9738; val_auprc_score: 0.9675; val_best_acc_score: 0.9229; val_best_f1_score: 0.9250; train_kl_reg_loss: 72467.3467; train_edge_recon_loss: 2695231.8760; train_gene_expr_recon_loss: 11329571.7405; train_masked_gp_l1_reg_loss: 107754.2904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59965.9029; train_chrom_access_recon_loss: 832381.7605; train_global_loss: 15097372.9847; train_optim_loss: 15097372.9847; val_kl_reg_loss: 72943.4391; val_edge_recon_loss: 2696939.0667; val_gene_expr_recon_loss: 11412622.9333; val_masked_gp_l1_reg_loss: 107662.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59685.8398; val_chrom_access_recon_loss: 834766.9875; val_global_loss: 15184620.3333; val_optim_loss: 15184620.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9722; val_auprc_score: 0.9635; val_best_acc_score: 0.9259; val_best_f1_score: 0.9275; train_kl_reg_loss: 72624.9252; train_edge_recon_loss: 2685460.5134; train_gene_expr_recon_loss: 11321435.7786; train_masked_gp_l1_reg_loss: 107733.4605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59829.7747; train_chrom_access_recon_loss: 831323.8507; train_global_loss: 15078408.3740; train_optim_loss: 15078408.3740; val_kl_reg_loss: 71995.9979; val_edge_recon_loss: 2707905.1833; val_gene_expr_recon_loss: 11329304.0667; val_masked_gp_l1_reg_loss: 107999.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59765.4219; val_chrom_access_recon_loss: 830230.6167; val_global_loss: 15107200.0667; val_optim_loss: 15107200.0667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9694; val_auprc_score: 0.9596; val_best_acc_score: 0.9155; val_best_f1_score: 0.9173; train_kl_reg_loss: 90558.3761; train_edge_recon_loss: 2746871.2099; train_gene_expr_recon_loss: 10373292.9160; train_masked_gp_l1_reg_loss: 105803.2558; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56627.0871; train_chrom_access_recon_loss: 764906.2448; train_global_loss: 14138059.0458; train_optim_loss: 14138059.0458; val_kl_reg_loss: 33986.6021; val_edge_recon_loss: 2720276.3000; val_gene_expr_recon_loss: 10341796.9333; val_masked_gp_l1_reg_loss: 104773.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57274.1992; val_chrom_access_recon_loss: 758834.3417; val_global_loss: 14016941.2667; val_optim_loss: 14016941.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9695; val_auprc_score: 0.9606; val_best_acc_score: 0.9204; val_best_f1_score: 0.9225; train_kl_reg_loss: 68649.9116; train_edge_recon_loss: 2704763.1756; train_gene_expr_recon_loss: 10319028.5115; train_masked_gp_l1_reg_loss: 103753.6351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58142.4885; train_chrom_access_recon_loss: 759575.8955; train_global_loss: 14013913.6031; train_optim_loss: 14013913.6031; val_kl_reg_loss: 37898.4867; val_edge_recon_loss: 2720018.8667; val_gene_expr_recon_loss: 10340282.2667; val_masked_gp_l1_reg_loss: 102657.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58487.1914; val_chrom_access_recon_loss: 758448.7292; val_global_loss: 14017793.4000; val_optim_loss: 14017793.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9687; val_auprc_score: 0.9571; val_best_acc_score: 0.9181; val_best_f1_score: 0.9208; train_kl_reg_loss: 62167.8691; train_edge_recon_loss: 2695632.3760; train_gene_expr_recon_loss: 10276727.2672; train_masked_gp_l1_reg_loss: 101460.4102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58828.3037; train_chrom_access_recon_loss: 758138.6245; train_global_loss: 13952954.8550; train_optim_loss: 13952954.8550; val_kl_reg_loss: 41581.9227; val_edge_recon_loss: 2706668.7833; val_gene_expr_recon_loss: 10313915.0667; val_masked_gp_l1_reg_loss: 100219.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58842.5625; val_chrom_access_recon_loss: 756286.2417; val_global_loss: 13977514.1333; val_optim_loss: 13977514.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9680; val_auprc_score: 0.9577; val_best_acc_score: 0.9193; val_best_f1_score: 0.9227; train_kl_reg_loss: 60468.5106; train_edge_recon_loss: 2693683.1908; train_gene_expr_recon_loss: 10275465.9160; train_masked_gp_l1_reg_loss: 98995.6302; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59067.3463; train_chrom_access_recon_loss: 756538.4151; train_global_loss: 13944219.0229; train_optim_loss: 13944219.0229; val_kl_reg_loss: 44728.6466; val_edge_recon_loss: 2708011.8667; val_gene_expr_recon_loss: 10276992.1333; val_masked_gp_l1_reg_loss: 97925.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59363.6250; val_chrom_access_recon_loss: 758460.2000; val_global_loss: 13945481.8667; val_optim_loss: 13945481.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9716; val_auprc_score: 0.9648; val_best_acc_score: 0.9243; val_best_f1_score: 0.9272; train_kl_reg_loss: 58713.0824; train_edge_recon_loss: 2685615.8836; train_gene_expr_recon_loss: 10244398.8626; train_masked_gp_l1_reg_loss: 96672.6307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59182.8442; train_chrom_access_recon_loss: 754787.6307; train_global_loss: 13899370.9542; train_optim_loss: 13899370.9542; val_kl_reg_loss: 47054.8422; val_edge_recon_loss: 2686708.0500; val_gene_expr_recon_loss: 10258902.4000; val_masked_gp_l1_reg_loss: 95562.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58938.8477; val_chrom_access_recon_loss: 757232.9042; val_global_loss: 13904400.2667; val_optim_loss: 13904400.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9725; val_auprc_score: 0.9632; val_best_acc_score: 0.9260; val_best_f1_score: 0.9284; train_kl_reg_loss: 58847.9057; train_edge_recon_loss: 2682538.8187; train_gene_expr_recon_loss: 10244566.1145; train_masked_gp_l1_reg_loss: 94399.7347; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59018.9384; train_chrom_access_recon_loss: 754464.3531; train_global_loss: 13893835.9466; train_optim_loss: 13893835.9466; val_kl_reg_loss: 45547.5667; val_edge_recon_loss: 2695382.2167; val_gene_expr_recon_loss: 10238851.8000; val_masked_gp_l1_reg_loss: 93527.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59346.5898; val_chrom_access_recon_loss: 755339.3208; val_global_loss: 13887995.8000; val_optim_loss: 13887995.8000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9722; val_auprc_score: 0.9630; val_best_acc_score: 0.9274; val_best_f1_score: 0.9297; train_kl_reg_loss: 57106.5583; train_edge_recon_loss: 2680515.6240; train_gene_expr_recon_loss: 10225021.3435; train_masked_gp_l1_reg_loss: 92645.8043; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59092.4421; train_chrom_access_recon_loss: 752404.1551; train_global_loss: 13866785.9695; train_optim_loss: 13866785.9695; val_kl_reg_loss: 48740.8156; val_edge_recon_loss: 2689579.6667; val_gene_expr_recon_loss: 10290391.5333; val_masked_gp_l1_reg_loss: 91562.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58681.6328; val_chrom_access_recon_loss: 758639.2417; val_global_loss: 13937595.3333; val_optim_loss: 13937595.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9714; val_auprc_score: 0.9631; val_best_acc_score: 0.9232; val_best_f1_score: 0.9251; train_kl_reg_loss: 56447.9549; train_edge_recon_loss: 2680939.2042; train_gene_expr_recon_loss: 10224257.2443; train_masked_gp_l1_reg_loss: 90916.1406; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58784.1822; train_chrom_access_recon_loss: 752186.4151; train_global_loss: 13863531.1527; train_optim_loss: 13863531.1527; val_kl_reg_loss: 49871.4206; val_edge_recon_loss: 2694436.9833; val_gene_expr_recon_loss: 10264619.6667; val_masked_gp_l1_reg_loss: 90381.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58895.5430; val_chrom_access_recon_loss: 751186.8083; val_global_loss: 13909391.8667; val_optim_loss: 13909391.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9755; val_auprc_score: 0.9682; val_best_acc_score: 0.9258; val_best_f1_score: 0.9280; train_kl_reg_loss: 56290.0655; train_edge_recon_loss: 2675994.8435; train_gene_expr_recon_loss: 10209161.5878; train_masked_gp_l1_reg_loss: 89740.7789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58798.4416; train_chrom_access_recon_loss: 751851.2385; train_global_loss: 13841836.9771; train_optim_loss: 13841836.9771; val_kl_reg_loss: 49433.8109; val_edge_recon_loss: 2664511.7667; val_gene_expr_recon_loss: 10231410.8667; val_masked_gp_l1_reg_loss: 89138.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58605.0430; val_chrom_access_recon_loss: 754410.9875; val_global_loss: 13847511.4667; val_optim_loss: 13847511.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9732; val_auprc_score: 0.9654; val_best_acc_score: 0.9247; val_best_f1_score: 0.9263; train_kl_reg_loss: 56204.8218; train_edge_recon_loss: 2676779.9866; train_gene_expr_recon_loss: 10197343.9771; train_masked_gp_l1_reg_loss: 88707.4867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58848.4105; train_chrom_access_recon_loss: 750724.6250; train_global_loss: 13828609.3053; train_optim_loss: 13828609.3053; val_kl_reg_loss: 49658.4964; val_edge_recon_loss: 2687097.4833; val_gene_expr_recon_loss: 10240754.3333; val_masked_gp_l1_reg_loss: 88269.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58785.6602; val_chrom_access_recon_loss: 752118.6083; val_global_loss: 13876683.9333; val_optim_loss: 13876683.9333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9733; val_auprc_score: 0.9637; val_best_acc_score: 0.9264; val_best_f1_score: 0.9286; train_kl_reg_loss: 56769.9628; train_edge_recon_loss: 2669611.5229; train_gene_expr_recon_loss: 10189210.4809; train_masked_gp_l1_reg_loss: 87841.7099; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58780.4941; train_chrom_access_recon_loss: 750150.2529; train_global_loss: 13812364.3817; train_optim_loss: 13812364.3817; val_kl_reg_loss: 48485.5807; val_edge_recon_loss: 2682733.2000; val_gene_expr_recon_loss: 10209562.2000; val_masked_gp_l1_reg_loss: 87383.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59209.0742; val_chrom_access_recon_loss: 751376.2875; val_global_loss: 13838750.3333; val_optim_loss: 13838750.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9706; val_auprc_score: 0.9626; val_best_acc_score: 0.9186; val_best_f1_score: 0.9211; train_kl_reg_loss: 56067.9198; train_edge_recon_loss: 2675559.5916; train_gene_expr_recon_loss: 10176261.0458; train_masked_gp_l1_reg_loss: 87127.3713; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59005.9829; train_chrom_access_recon_loss: 749464.9418; train_global_loss: 13803486.8244; train_optim_loss: 13803486.8244; val_kl_reg_loss: 49091.3870; val_edge_recon_loss: 2686438.9500; val_gene_expr_recon_loss: 10184022.4667; val_masked_gp_l1_reg_loss: 86916.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59205.4336; val_chrom_access_recon_loss: 747238.6417; val_global_loss: 13812913.4000; val_optim_loss: 13812913.4000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9760; val_auprc_score: 0.9676; val_best_acc_score: 0.9324; val_best_f1_score: 0.9347; train_kl_reg_loss: 55776.8881; train_edge_recon_loss: 2673653.9885; train_gene_expr_recon_loss: 10159834.5954; train_masked_gp_l1_reg_loss: 86522.2514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59017.7533; train_chrom_access_recon_loss: 749032.1970; train_global_loss: 13783837.6718; train_optim_loss: 13783837.6718; val_kl_reg_loss: 50027.2065; val_edge_recon_loss: 2663836.7000; val_gene_expr_recon_loss: 10158863.2000; val_masked_gp_l1_reg_loss: 86298.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58981.5547; val_chrom_access_recon_loss: 750440.5167; val_global_loss: 13768447.5333; val_optim_loss: 13768447.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9702; val_auprc_score: 0.9583; val_best_acc_score: 0.9239; val_best_f1_score: 0.9265; train_kl_reg_loss: 55381.7853; train_edge_recon_loss: 2665861.9389; train_gene_expr_recon_loss: 10147448.2748; train_masked_gp_l1_reg_loss: 85906.1141; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59043.9457; train_chrom_access_recon_loss: 749218.3683; train_global_loss: 13762860.4198; train_optim_loss: 13762860.4198; val_kl_reg_loss: 49582.9956; val_edge_recon_loss: 2675221.2500; val_gene_expr_recon_loss: 10128639.4667; val_masked_gp_l1_reg_loss: 85618.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59022.6055; val_chrom_access_recon_loss: 746250.7875; val_global_loss: 13744336.2667; val_optim_loss: 13744336.2667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9751; val_auprc_score: 0.9678; val_best_acc_score: 0.9295; val_best_f1_score: 0.9319; train_kl_reg_loss: 55220.5380; train_edge_recon_loss: 2668318.8168; train_gene_expr_recon_loss: 10133531.8244; train_masked_gp_l1_reg_loss: 85123.3158; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59091.6898; train_chrom_access_recon_loss: 749746.2137; train_global_loss: 13751032.3969; train_optim_loss: 13751032.3969; val_kl_reg_loss: 50539.7932; val_edge_recon_loss: 2670390.8833; val_gene_expr_recon_loss: 10134246.0000; val_masked_gp_l1_reg_loss: 84803.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59004.8750; val_chrom_access_recon_loss: 748734.2083; val_global_loss: 13747719.8000; val_optim_loss: 13747719.8000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9765; val_auprc_score: 0.9690; val_best_acc_score: 0.9317; val_best_f1_score: 0.9332; train_kl_reg_loss: 54412.6458; train_edge_recon_loss: 2668164.5286; train_gene_expr_recon_loss: 10112548.5496; train_masked_gp_l1_reg_loss: 84386.6058; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59040.6067; train_chrom_access_recon_loss: 747949.8764; train_global_loss: 13726502.7710; train_optim_loss: 13726502.7710; val_kl_reg_loss: 51656.1831; val_edge_recon_loss: 2660393.5500; val_gene_expr_recon_loss: 10177092.4667; val_masked_gp_l1_reg_loss: 84143.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59209.1250; val_chrom_access_recon_loss: 751048.0083; val_global_loss: 13783543.3333; val_optim_loss: 13783543.3333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9742; val_auprc_score: 0.9651; val_best_acc_score: 0.9303; val_best_f1_score: 0.9328; train_kl_reg_loss: 54417.2553; train_edge_recon_loss: 2673996.4389; train_gene_expr_recon_loss: 10115601.0000; train_masked_gp_l1_reg_loss: 83704.1586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59119.2564; train_chrom_access_recon_loss: 747771.9404; train_global_loss: 13734610.0153; train_optim_loss: 13734610.0153; val_kl_reg_loss: 49685.4372; val_edge_recon_loss: 2698410.1000; val_gene_expr_recon_loss: 10159621.3333; val_masked_gp_l1_reg_loss: 83405.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58975.1211; val_chrom_access_recon_loss: 751179.5042; val_global_loss: 13801277.3333; val_optim_loss: 13801277.3333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9749; val_auprc_score: 0.9662; val_best_acc_score: 0.9305; val_best_f1_score: 0.9330; train_kl_reg_loss: 53996.2277; train_edge_recon_loss: 2661460.0267; train_gene_expr_recon_loss: 10108179.3282; train_masked_gp_l1_reg_loss: 83149.8162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59026.8893; train_chrom_access_recon_loss: 748043.6455; train_global_loss: 13713855.9389; train_optim_loss: 13713855.9389; val_kl_reg_loss: 50774.3250; val_edge_recon_loss: 2686522.2833; val_gene_expr_recon_loss: 10155182.3333; val_masked_gp_l1_reg_loss: 82948.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59060.9336; val_chrom_access_recon_loss: 753330.2542; val_global_loss: 13787818.2000; val_optim_loss: 13787818.2000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9705; val_auprc_score: 0.9574; val_best_acc_score: 0.9286; val_best_f1_score: 0.9307; train_kl_reg_loss: 54205.4636; train_edge_recon_loss: 2666860.4294; train_gene_expr_recon_loss: 10098592.8626; train_masked_gp_l1_reg_loss: 81071.8000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49787.9395; train_chrom_access_recon_loss: 747111.6641; train_global_loss: 13697630.1756; train_optim_loss: 13697630.1756; val_kl_reg_loss: 51715.8495; val_edge_recon_loss: 2678611.4500; val_gene_expr_recon_loss: 10114618.4000; val_masked_gp_l1_reg_loss: 80623.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 48234.3516; val_chrom_access_recon_loss: 750739.6875; val_global_loss: 13724543.5333; val_optim_loss: 13724543.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9738; val_auprc_score: 0.9645; val_best_acc_score: 0.9309; val_best_f1_score: 0.9327; train_kl_reg_loss: 55267.1793; train_edge_recon_loss: 2671043.4618; train_gene_expr_recon_loss: 10087741.5420; train_masked_gp_l1_reg_loss: 80534.7456; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47885.5296; train_chrom_access_recon_loss: 746164.7977; train_global_loss: 13688637.2290; train_optim_loss: 13688637.2290; val_kl_reg_loss: 52371.2260; val_edge_recon_loss: 2675793.9333; val_gene_expr_recon_loss: 10076291.2667; val_masked_gp_l1_reg_loss: 80447.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47520.1758; val_chrom_access_recon_loss: 746834.6833; val_global_loss: 13679259.2000; val_optim_loss: 13679259.2000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9779; val_auprc_score: 0.9678; val_best_acc_score: 0.9375; val_best_f1_score: 0.9391; train_kl_reg_loss: 56079.1058; train_edge_recon_loss: 2666728.5802; train_gene_expr_recon_loss: 10088557.6947; train_masked_gp_l1_reg_loss: 80379.7806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47304.0631; train_chrom_access_recon_loss: 746423.9146; train_global_loss: 13685473.1145; train_optim_loss: 13685473.1145; val_kl_reg_loss: 52483.8482; val_edge_recon_loss: 2647991.0000; val_gene_expr_recon_loss: 10131318.1333; val_masked_gp_l1_reg_loss: 80324.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 47083.1211; val_chrom_access_recon_loss: 746604.0417; val_global_loss: 13705805.0667; val_optim_loss: 13705805.0667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9764; val_auprc_score: 0.9682; val_best_acc_score: 0.9355; val_best_f1_score: 0.9378; train_kl_reg_loss: 56534.2853; train_edge_recon_loss: 2658946.8187; train_gene_expr_recon_loss: 10091918.3053; train_masked_gp_l1_reg_loss: 80272.4260; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46917.8710; train_chrom_access_recon_loss: 745883.8984; train_global_loss: 13680473.6794; train_optim_loss: 13680473.6794; val_kl_reg_loss: 53201.5870; val_edge_recon_loss: 2676588.5000; val_gene_expr_recon_loss: 10106728.1333; val_masked_gp_l1_reg_loss: 80227.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46737.9414; val_chrom_access_recon_loss: 747582.1208; val_global_loss: 13711065.3333; val_optim_loss: 13711065.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9773; val_auprc_score: 0.9690; val_best_acc_score: 0.9353; val_best_f1_score: 0.9371; train_kl_reg_loss: 57452.7336; train_edge_recon_loss: 2662920.0382; train_gene_expr_recon_loss: 10091395.4046; train_masked_gp_l1_reg_loss: 80169.3745; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46621.0017; train_chrom_access_recon_loss: 746261.0906; train_global_loss: 13684819.7023; train_optim_loss: 13684819.7023; val_kl_reg_loss: 53449.7516; val_edge_recon_loss: 2673909.1167; val_gene_expr_recon_loss: 10144656.0000; val_masked_gp_l1_reg_loss: 80114.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46410.1680; val_chrom_access_recon_loss: 748902.0708; val_global_loss: 13747442.0000; val_optim_loss: 13747442.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9762; val_auprc_score: 0.9673; val_best_acc_score: 0.9333; val_best_f1_score: 0.9350; train_kl_reg_loss: 57055.2289; train_edge_recon_loss: 2664185.2996; train_gene_expr_recon_loss: 10086777.7634; train_masked_gp_l1_reg_loss: 80064.2183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 46295.9383; train_chrom_access_recon_loss: 746534.8130; train_global_loss: 13680913.2443; train_optim_loss: 13680913.2443; val_kl_reg_loss: 53572.0797; val_edge_recon_loss: 2669884.5500; val_gene_expr_recon_loss: 10110690.6000; val_masked_gp_l1_reg_loss: 80012.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46203.6289; val_chrom_access_recon_loss: 748188.3250; val_global_loss: 13708552.6000; val_optim_loss: 13708552.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9762; val_auprc_score: 0.9689; val_best_acc_score: 0.9312; val_best_f1_score: 0.9336; train_kl_reg_loss: 56692.5249; train_edge_recon_loss: 2667682.5191; train_gene_expr_recon_loss: 10095546.1069; train_masked_gp_l1_reg_loss: 79820.5621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45272.0741; train_chrom_access_recon_loss: 746728.2352; train_global_loss: 13691742.0916; train_optim_loss: 13691742.0916; val_kl_reg_loss: 52964.8792; val_edge_recon_loss: 2678629.8333; val_gene_expr_recon_loss: 10143962.1333; val_masked_gp_l1_reg_loss: 79769.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45122.7852; val_chrom_access_recon_loss: 749728.0750; val_global_loss: 13750177.0667; val_optim_loss: 13750177.0667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9739; val_auprc_score: 0.9636; val_best_acc_score: 0.9312; val_best_f1_score: 0.9329; train_kl_reg_loss: 56809.6124; train_edge_recon_loss: 2658003.6698; train_gene_expr_recon_loss: 10083429.0534; train_masked_gp_l1_reg_loss: 79753.4168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45074.2713; train_chrom_access_recon_loss: 746673.6574; train_global_loss: 13669743.6718; train_optim_loss: 13669743.6718; val_kl_reg_loss: 52542.9797; val_edge_recon_loss: 2679529.7833; val_gene_expr_recon_loss: 10094347.4667; val_masked_gp_l1_reg_loss: 79737.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45024.6602; val_chrom_access_recon_loss: 748574.1250; val_global_loss: 13699756.5333; val_optim_loss: 13699756.5333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9773; val_auprc_score: 0.9703; val_best_acc_score: 0.9348; val_best_f1_score: 0.9369; train_kl_reg_loss: 56765.0545; train_edge_recon_loss: 2665126.4008; train_gene_expr_recon_loss: 10084496.8092; train_masked_gp_l1_reg_loss: 79728.0168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44993.9476; train_chrom_access_recon_loss: 747026.4356; train_global_loss: 13678136.6718; train_optim_loss: 13678136.6718; val_kl_reg_loss: 52763.0951; val_edge_recon_loss: 2678908.9000; val_gene_expr_recon_loss: 10108756.9333; val_masked_gp_l1_reg_loss: 79716.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44956.4922; val_chrom_access_recon_loss: 747352.5083; val_global_loss: 13712454.7333; val_optim_loss: 13712454.7333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9769; val_auprc_score: 0.9696; val_best_acc_score: 0.9351; val_best_f1_score: 0.9371; train_kl_reg_loss: 56956.0436; train_edge_recon_loss: 2659732.2176; train_gene_expr_recon_loss: 10084008.5649; train_masked_gp_l1_reg_loss: 79708.1720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44929.7692; train_chrom_access_recon_loss: 746391.8130; train_global_loss: 13671726.5649; train_optim_loss: 13671726.5649; val_kl_reg_loss: 52855.6245; val_edge_recon_loss: 2654668.3333; val_gene_expr_recon_loss: 10152511.0667; val_masked_gp_l1_reg_loss: 79702.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44902.1211; val_chrom_access_recon_loss: 755851.4333; val_global_loss: 13740490.3333; val_optim_loss: 13740490.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 14 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9750
val AUPRC score: 0.9648
val best accuracy score: 0.9299
val best F1 score: 0.9316
val target rna MSE score: 1.8206
val source rna MSE score: 0.5231
val target atac MSE score: 0.4973
val source atac MSE score: 0.1530
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
