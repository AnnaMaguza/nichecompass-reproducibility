[True]
Run timestamp: 10102023_101611_229.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_229']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7808; val_auprc_score: 0.8015; val_best_acc_score: 0.5494; val_best_f1_score: 0.6865; train_kl_reg_loss: 85401.1854; train_edge_recon_loss: 754602.6927; train_gene_expr_recon_loss: 22124669.0076; train_masked_gp_l1_reg_loss: 39585.8074; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2938815.0525; train_chrom_access_recon_loss: 6733940.9046; train_global_loss: 32677014.7328; train_optim_loss: 32677014.7328; val_kl_reg_loss: 72548.7839; val_edge_recon_loss: 812476.0417; val_gene_expr_recon_loss: 21040658.0000; val_masked_gp_l1_reg_loss: 42805.9023; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1125650.3750; val_chrom_access_recon_loss: 6586280.3000; val_global_loss: 29680418.8000; val_optim_loss: 29680418.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8875; val_auprc_score: 0.8847; val_best_acc_score: 0.7829; val_best_f1_score: 0.7919; train_kl_reg_loss: 75318.3814; train_edge_recon_loss: 734906.4523; train_gene_expr_recon_loss: 20903548.4275; train_masked_gp_l1_reg_loss: 44216.2856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 606176.1749; train_chrom_access_recon_loss: 6485361.2939; train_global_loss: 28849526.7328; train_optim_loss: 28849526.7328; val_kl_reg_loss: 71907.4354; val_edge_recon_loss: 790193.2792; val_gene_expr_recon_loss: 20782722.0000; val_masked_gp_l1_reg_loss: 46082.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 336369.5312; val_chrom_access_recon_loss: 6479246.4667; val_global_loss: 28506521.3333; val_optim_loss: 28506521.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9110; val_auprc_score: 0.9007; val_best_acc_score: 0.8250; val_best_f1_score: 0.8376; train_kl_reg_loss: 69853.2644; train_edge_recon_loss: 681784.2591; train_gene_expr_recon_loss: 20592852.1985; train_masked_gp_l1_reg_loss: 48353.5644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 257162.1704; train_chrom_access_recon_loss: 6407833.6298; train_global_loss: 28057839.2061; train_optim_loss: 28057839.2061; val_kl_reg_loss: 74516.3896; val_edge_recon_loss: 640542.6417; val_gene_expr_recon_loss: 20515220.6667; val_masked_gp_l1_reg_loss: 50510.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 201822.7344; val_chrom_access_recon_loss: 6412586.2000; val_global_loss: 27895198.0000; val_optim_loss: 27895198.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9290; val_auprc_score: 0.9160; val_best_acc_score: 0.8548; val_best_f1_score: 0.8603; train_kl_reg_loss: 75531.9672; train_edge_recon_loss: 627263.9060; train_gene_expr_recon_loss: 20344953.3435; train_masked_gp_l1_reg_loss: 52362.2748; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 170760.3241; train_chrom_access_recon_loss: 6338465.2176; train_global_loss: 27609336.9618; train_optim_loss: 27609336.9618; val_kl_reg_loss: 71472.4661; val_edge_recon_loss: 617261.2292; val_gene_expr_recon_loss: 20253185.7333; val_masked_gp_l1_reg_loss: 53911.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145947.6250; val_chrom_access_recon_loss: 6323961.9667; val_global_loss: 27465741.3333; val_optim_loss: 27465741.3333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9336; val_auprc_score: 0.9219; val_best_acc_score: 0.8597; val_best_f1_score: 0.8677; train_kl_reg_loss: 71064.9252; train_edge_recon_loss: 613699.1880; train_gene_expr_recon_loss: 20162958.3359; train_masked_gp_l1_reg_loss: 55333.7810; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 131174.9621; train_chrom_access_recon_loss: 6285190.9962; train_global_loss: 27319422.2901; train_optim_loss: 27319422.2901; val_kl_reg_loss: 69750.1141; val_edge_recon_loss: 607621.5042; val_gene_expr_recon_loss: 20144048.2667; val_masked_gp_l1_reg_loss: 56606.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120961.4688; val_chrom_access_recon_loss: 6304859.4000; val_global_loss: 27303846.8000; val_optim_loss: 27303846.8000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9425; val_auprc_score: 0.9314; val_best_acc_score: 0.8748; val_best_f1_score: 0.8817; train_kl_reg_loss: 68541.9720; train_edge_recon_loss: 603504.9552; train_gene_expr_recon_loss: 19997148.1985; train_masked_gp_l1_reg_loss: 57617.3996; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112760.8639; train_chrom_access_recon_loss: 6234537.5344; train_global_loss: 27074110.9618; train_optim_loss: 27074110.9618; val_kl_reg_loss: 67600.7581; val_edge_recon_loss: 597159.3292; val_gene_expr_recon_loss: 19928197.0667; val_masked_gp_l1_reg_loss: 58711.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107399.3203; val_chrom_access_recon_loss: 6250840.1333; val_global_loss: 27009909.0667; val_optim_loss: 27009909.0667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9445; val_auprc_score: 0.9333; val_best_acc_score: 0.8802; val_best_f1_score: 0.8873; train_kl_reg_loss: 66380.5321; train_edge_recon_loss: 596794.6947; train_gene_expr_recon_loss: 19879786.1374; train_masked_gp_l1_reg_loss: 59591.0536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103855.7341; train_chrom_access_recon_loss: 6205671.5878; train_global_loss: 26912079.9847; train_optim_loss: 26912079.9847; val_kl_reg_loss: 65773.1414; val_edge_recon_loss: 595821.8542; val_gene_expr_recon_loss: 19778110.9333; val_masked_gp_l1_reg_loss: 60301.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101029.8594; val_chrom_access_recon_loss: 6196850.9000; val_global_loss: 26797888.9333; val_optim_loss: 26797888.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9518; val_auprc_score: 0.9438; val_best_acc_score: 0.8868; val_best_f1_score: 0.8915; train_kl_reg_loss: 63704.8420; train_edge_recon_loss: 594445.7109; train_gene_expr_recon_loss: 19733516.9008; train_masked_gp_l1_reg_loss: 61085.7151; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99728.3732; train_chrom_access_recon_loss: 6150550.5305; train_global_loss: 26703032.0153; train_optim_loss: 26703032.0153; val_kl_reg_loss: 63486.7310; val_edge_recon_loss: 594889.5958; val_gene_expr_recon_loss: 19684791.8667; val_masked_gp_l1_reg_loss: 62032.4648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99760.3672; val_chrom_access_recon_loss: 6188931.6333; val_global_loss: 26693891.8667; val_optim_loss: 26693891.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9532; val_auprc_score: 0.9439; val_best_acc_score: 0.8913; val_best_f1_score: 0.8966; train_kl_reg_loss: 62257.8213; train_edge_recon_loss: 589420.4666; train_gene_expr_recon_loss: 19635651.8321; train_masked_gp_l1_reg_loss: 62566.2868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98042.8423; train_chrom_access_recon_loss: 6124149.4809; train_global_loss: 26572088.9313; train_optim_loss: 26572088.9313; val_kl_reg_loss: 61072.9086; val_edge_recon_loss: 593614.3208; val_gene_expr_recon_loss: 19523629.2000; val_masked_gp_l1_reg_loss: 63196.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97773.4531; val_chrom_access_recon_loss: 6124562.6333; val_global_loss: 26463849.2000; val_optim_loss: 26463849.2000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9598; val_auprc_score: 0.9527; val_best_acc_score: 0.9019; val_best_f1_score: 0.9050; train_kl_reg_loss: 61170.8987; train_edge_recon_loss: 587319.6446; train_gene_expr_recon_loss: 19533917.2977; train_masked_gp_l1_reg_loss: 63688.7688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95578.2825; train_chrom_access_recon_loss: 6092344.9198; train_global_loss: 26434019.8015; train_optim_loss: 26434019.8015; val_kl_reg_loss: 59822.1974; val_edge_recon_loss: 587946.0208; val_gene_expr_recon_loss: 19522824.8000; val_masked_gp_l1_reg_loss: 64348.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94115.4766; val_chrom_access_recon_loss: 6116339.5667; val_global_loss: 26445396.4000; val_optim_loss: 26445396.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9662; val_auprc_score: 0.9605; val_best_acc_score: 0.9082; val_best_f1_score: 0.9104; train_kl_reg_loss: 59640.1956; train_edge_recon_loss: 585222.1827; train_gene_expr_recon_loss: 19420212.6565; train_masked_gp_l1_reg_loss: 64806.9429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92962.4480; train_chrom_access_recon_loss: 6046878.1374; train_global_loss: 26269722.5802; train_optim_loss: 26269722.5802; val_kl_reg_loss: 60159.7906; val_edge_recon_loss: 583021.0250; val_gene_expr_recon_loss: 19351928.4000; val_masked_gp_l1_reg_loss: 65219.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91654.0625; val_chrom_access_recon_loss: 6057347.4333; val_global_loss: 26209330.6667; val_optim_loss: 26209330.6667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9660; val_auprc_score: 0.9593; val_best_acc_score: 0.9117; val_best_f1_score: 0.9142; train_kl_reg_loss: 58681.3155; train_edge_recon_loss: 582845.0100; train_gene_expr_recon_loss: 19349555.7252; train_masked_gp_l1_reg_loss: 65732.5136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90942.7308; train_chrom_access_recon_loss: 6019536.7519; train_global_loss: 26167294.1374; train_optim_loss: 26167294.1374; val_kl_reg_loss: 59190.0534; val_edge_recon_loss: 582723.0750; val_gene_expr_recon_loss: 19275890.5333; val_masked_gp_l1_reg_loss: 66274.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89802.2500; val_chrom_access_recon_loss: 6045228.0333; val_global_loss: 26119107.6000; val_optim_loss: 26119107.6000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9694; val_auprc_score: 0.9640; val_best_acc_score: 0.9166; val_best_f1_score: 0.9192; train_kl_reg_loss: 58006.1605; train_edge_recon_loss: 578659.6407; train_gene_expr_recon_loss: 19262352.5496; train_masked_gp_l1_reg_loss: 66841.1124; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89121.6643; train_chrom_access_recon_loss: 5992402.6756; train_global_loss: 26047383.7863; train_optim_loss: 26047383.7863; val_kl_reg_loss: 57670.2302; val_edge_recon_loss: 579592.3750; val_gene_expr_recon_loss: 19215667.8667; val_masked_gp_l1_reg_loss: 67339.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89119.6641; val_chrom_access_recon_loss: 6004102.0667; val_global_loss: 26013492.4000; val_optim_loss: 26013492.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9693; val_auprc_score: 0.9630; val_best_acc_score: 0.9174; val_best_f1_score: 0.9210; train_kl_reg_loss: 57171.2699; train_edge_recon_loss: 576875.4361; train_gene_expr_recon_loss: 19176388.7023; train_masked_gp_l1_reg_loss: 67890.8399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88386.5620; train_chrom_access_recon_loss: 5959931.5802; train_global_loss: 25926644.4275; train_optim_loss: 25926644.4275; val_kl_reg_loss: 57033.1159; val_edge_recon_loss: 579406.5167; val_gene_expr_recon_loss: 19074352.6667; val_masked_gp_l1_reg_loss: 68364.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87359.0000; val_chrom_access_recon_loss: 5982493.8333; val_global_loss: 25849008.9333; val_optim_loss: 25849008.9333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9734; val_auprc_score: 0.9679; val_best_acc_score: 0.9209; val_best_f1_score: 0.9239; train_kl_reg_loss: 56085.0115; train_edge_recon_loss: 576280.0095; train_gene_expr_recon_loss: 19118417.1756; train_masked_gp_l1_reg_loss: 69068.4893; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87266.7434; train_chrom_access_recon_loss: 5931572.2557; train_global_loss: 25838689.8321; train_optim_loss: 25838689.8321; val_kl_reg_loss: 55643.5073; val_edge_recon_loss: 575766.6750; val_gene_expr_recon_loss: 19115994.8000; val_masked_gp_l1_reg_loss: 69756.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87026.7344; val_chrom_access_recon_loss: 5989636.7667; val_global_loss: 25893823.8667; val_optim_loss: 25893823.8667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9728; val_auprc_score: 0.9678; val_best_acc_score: 0.9252; val_best_f1_score: 0.9273; train_kl_reg_loss: 55279.0767; train_edge_recon_loss: 574010.9733; train_gene_expr_recon_loss: 19045197.8779; train_masked_gp_l1_reg_loss: 70424.9673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86698.7086; train_chrom_access_recon_loss: 5906597.6450; train_global_loss: 25738209.2061; train_optim_loss: 25738209.2061; val_kl_reg_loss: 54545.8958; val_edge_recon_loss: 573274.7000; val_gene_expr_recon_loss: 19080754.9333; val_masked_gp_l1_reg_loss: 71126.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86672.9375; val_chrom_access_recon_loss: 5950542.0333; val_global_loss: 25816915.3333; val_optim_loss: 25816915.3333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9661; val_auprc_score: 0.9565; val_best_acc_score: 0.9120; val_best_f1_score: 0.9149; train_kl_reg_loss: 54305.0272; train_edge_recon_loss: 575742.0811; train_gene_expr_recon_loss: 18992557.2977; train_masked_gp_l1_reg_loss: 71804.6534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86178.7379; train_chrom_access_recon_loss: 5882860.5725; train_global_loss: 25663448.3053; train_optim_loss: 25663448.3053; val_kl_reg_loss: 54760.9682; val_edge_recon_loss: 582698.7625; val_gene_expr_recon_loss: 19023273.4667; val_masked_gp_l1_reg_loss: 72475.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87262.8750; val_chrom_access_recon_loss: 5942199.2333; val_global_loss: 25762670.5333; val_optim_loss: 25762670.5333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9707; val_auprc_score: 0.9635; val_best_acc_score: 0.9192; val_best_f1_score: 0.9222; train_kl_reg_loss: 53977.0976; train_edge_recon_loss: 575605.5344; train_gene_expr_recon_loss: 18913243.2366; train_masked_gp_l1_reg_loss: 73290.5791; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86499.9289; train_chrom_access_recon_loss: 5857303.0038; train_global_loss: 25559919.2672; train_optim_loss: 25559919.2672; val_kl_reg_loss: 53077.9836; val_edge_recon_loss: 581086.5083; val_gene_expr_recon_loss: 18910536.6667; val_masked_gp_l1_reg_loss: 74081.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86822.7188; val_chrom_access_recon_loss: 5887806.0667; val_global_loss: 25593411.3333; val_optim_loss: 25593411.3333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9655; val_auprc_score: 0.9553; val_best_acc_score: 0.9138; val_best_f1_score: 0.9172; train_kl_reg_loss: 53441.6393; train_edge_recon_loss: 575301.5873; train_gene_expr_recon_loss: 18844360.9618; train_masked_gp_l1_reg_loss: 74820.8392; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86570.9272; train_chrom_access_recon_loss: 5830009.1221; train_global_loss: 25464505.0840; train_optim_loss: 25464505.0840; val_kl_reg_loss: 52145.9570; val_edge_recon_loss: 579725.7667; val_gene_expr_recon_loss: 18802616.5333; val_masked_gp_l1_reg_loss: 75534.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86495.7422; val_chrom_access_recon_loss: 5862841.8000; val_global_loss: 25459360.0000; val_optim_loss: 25459360.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9686; val_auprc_score: 0.9604; val_best_acc_score: 0.9186; val_best_f1_score: 0.9223; train_kl_reg_loss: 53767.4249; train_edge_recon_loss: 574473.0429; train_gene_expr_recon_loss: 18775004.4580; train_masked_gp_l1_reg_loss: 76367.8216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86603.8284; train_chrom_access_recon_loss: 5812183.4313; train_global_loss: 25378400.0000; train_optim_loss: 25378400.0000; val_kl_reg_loss: 52541.5031; val_edge_recon_loss: 576207.5792; val_gene_expr_recon_loss: 18900409.2000; val_masked_gp_l1_reg_loss: 77080.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87468.3750; val_chrom_access_recon_loss: 5884084.7333; val_global_loss: 25577790.5333; val_optim_loss: 25577790.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9709; val_auprc_score: 0.9622; val_best_acc_score: 0.9196; val_best_f1_score: 0.9221; train_kl_reg_loss: 53707.8362; train_edge_recon_loss: 574393.9008; train_gene_expr_recon_loss: 18693734.6870; train_masked_gp_l1_reg_loss: 77950.0553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86743.0976; train_chrom_access_recon_loss: 5784197.6794; train_global_loss: 25270727.0992; train_optim_loss: 25270727.0992; val_kl_reg_loss: 54045.8378; val_edge_recon_loss: 574528.7458; val_gene_expr_recon_loss: 18734493.6000; val_masked_gp_l1_reg_loss: 78736.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87350.9375; val_chrom_access_recon_loss: 5848140.5333; val_global_loss: 25377294.6667; val_optim_loss: 25377294.6667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9671; val_auprc_score: 0.9589; val_best_acc_score: 0.9162; val_best_f1_score: 0.9189; train_kl_reg_loss: 53528.8587; train_edge_recon_loss: 575221.3306; train_gene_expr_recon_loss: 18622132.4275; train_masked_gp_l1_reg_loss: 79455.7258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87051.4481; train_chrom_access_recon_loss: 5763655.7137; train_global_loss: 25181045.4046; train_optim_loss: 25181045.4046; val_kl_reg_loss: 54017.8357; val_edge_recon_loss: 583064.2292; val_gene_expr_recon_loss: 18760866.0000; val_masked_gp_l1_reg_loss: 80300.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87167.5469; val_chrom_access_recon_loss: 5877291.5667; val_global_loss: 25442707.7333; val_optim_loss: 25442707.7333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9697; val_auprc_score: 0.9632; val_best_acc_score: 0.9166; val_best_f1_score: 0.9195; train_kl_reg_loss: 53910.5795; train_edge_recon_loss: 574348.0806; train_gene_expr_recon_loss: 18550610.1832; train_masked_gp_l1_reg_loss: 80957.8010; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87287.2773; train_chrom_access_recon_loss: 5742389.3168; train_global_loss: 25089503.1298; train_optim_loss: 25089503.1298; val_kl_reg_loss: 53883.6594; val_edge_recon_loss: 576426.2500; val_gene_expr_recon_loss: 18632441.6000; val_masked_gp_l1_reg_loss: 81515.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87352.0078; val_chrom_access_recon_loss: 5840076.7000; val_global_loss: 25271696.2667; val_optim_loss: 25271696.2667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9679; val_auprc_score: 0.9588; val_best_acc_score: 0.9155; val_best_f1_score: 0.9183; train_kl_reg_loss: 53903.6155; train_edge_recon_loss: 574285.1269; train_gene_expr_recon_loss: 18475813.6794; train_masked_gp_l1_reg_loss: 82293.8980; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87477.4402; train_chrom_access_recon_loss: 5721243.1985; train_global_loss: 24995017.1298; train_optim_loss: 24995017.1298; val_kl_reg_loss: 53370.4031; val_edge_recon_loss: 581505.3750; val_gene_expr_recon_loss: 18549164.0000; val_masked_gp_l1_reg_loss: 82920.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87729.3516; val_chrom_access_recon_loss: 5787366.0000; val_global_loss: 25142055.7333; val_optim_loss: 25142055.7333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9672; val_auprc_score: 0.9589; val_best_acc_score: 0.9109; val_best_f1_score: 0.9149; train_kl_reg_loss: 54511.4200; train_edge_recon_loss: 573543.6460; train_gene_expr_recon_loss: 18440792.7176; train_masked_gp_l1_reg_loss: 83688.7671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87933.9455; train_chrom_access_recon_loss: 5716138.3206; train_global_loss: 24956608.6107; train_optim_loss: 24956608.6107; val_kl_reg_loss: 54112.1130; val_edge_recon_loss: 580803.0833; val_gene_expr_recon_loss: 18569027.3333; val_masked_gp_l1_reg_loss: 84161.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88575.3828; val_chrom_access_recon_loss: 5805089.7333; val_global_loss: 25181770.4000; val_optim_loss: 25181770.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9671; val_auprc_score: 0.9579; val_best_acc_score: 0.9163; val_best_f1_score: 0.9196; train_kl_reg_loss: 54715.6145; train_edge_recon_loss: 575263.2099; train_gene_expr_recon_loss: 18373076.7634; train_masked_gp_l1_reg_loss: 84742.0068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87955.2034; train_chrom_access_recon_loss: 5695496.6832; train_global_loss: 24871249.4351; train_optim_loss: 24871249.4351; val_kl_reg_loss: 54570.3042; val_edge_recon_loss: 581784.2542; val_gene_expr_recon_loss: 18577643.6000; val_masked_gp_l1_reg_loss: 85228.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88802.1328; val_chrom_access_recon_loss: 5789257.2000; val_global_loss: 25177285.8667; val_optim_loss: 25177285.8667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9668; val_auprc_score: 0.9567; val_best_acc_score: 0.9146; val_best_f1_score: 0.9171; train_kl_reg_loss: 55187.8121; train_edge_recon_loss: 576215.9656; train_gene_expr_recon_loss: 18332824.7023; train_masked_gp_l1_reg_loss: 85692.4878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88492.4721; train_chrom_access_recon_loss: 5688439.5725; train_global_loss: 24826852.9008; train_optim_loss: 24826852.9008; val_kl_reg_loss: 55128.5138; val_edge_recon_loss: 579228.2750; val_gene_expr_recon_loss: 18471497.0667; val_masked_gp_l1_reg_loss: 86024.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89144.3906; val_chrom_access_recon_loss: 5762353.1333; val_global_loss: 25043375.0667; val_optim_loss: 25043375.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9656; val_auprc_score: 0.9560; val_best_acc_score: 0.9131; val_best_f1_score: 0.9157; train_kl_reg_loss: 55842.9081; train_edge_recon_loss: 574594.1918; train_gene_expr_recon_loss: 18254052.5649; train_masked_gp_l1_reg_loss: 86448.3990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88431.6192; train_chrom_access_recon_loss: 5665251.7939; train_global_loss: 24724621.6489; train_optim_loss: 24724621.6489; val_kl_reg_loss: 55998.1326; val_edge_recon_loss: 580039.2542; val_gene_expr_recon_loss: 18493926.0000; val_masked_gp_l1_reg_loss: 86754.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89971.6172; val_chrom_access_recon_loss: 5792451.4333; val_global_loss: 25099140.8000; val_optim_loss: 25099140.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9658; val_auprc_score: 0.9570; val_best_acc_score: 0.9126; val_best_f1_score: 0.9163; train_kl_reg_loss: 56114.6765; train_edge_recon_loss: 575958.6756; train_gene_expr_recon_loss: 18217059.8779; train_masked_gp_l1_reg_loss: 87167.7150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89051.1646; train_chrom_access_recon_loss: 5653275.3130; train_global_loss: 24678627.4504; train_optim_loss: 24678627.4504; val_kl_reg_loss: 56930.0898; val_edge_recon_loss: 580250.0000; val_gene_expr_recon_loss: 18376884.0000; val_masked_gp_l1_reg_loss: 87442.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89928.2422; val_chrom_access_recon_loss: 5730494.3333; val_global_loss: 24921928.6667; val_optim_loss: 24921928.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9655; val_auprc_score: 0.9564; val_best_acc_score: 0.9089; val_best_f1_score: 0.9123; train_kl_reg_loss: 57087.7364; train_edge_recon_loss: 576869.1660; train_gene_expr_recon_loss: 18202082.9008; train_masked_gp_l1_reg_loss: 87752.5116; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89355.1551; train_chrom_access_recon_loss: 5652322.6832; train_global_loss: 24665470.1832; train_optim_loss: 24665470.1832; val_kl_reg_loss: 56971.7995; val_edge_recon_loss: 582028.5542; val_gene_expr_recon_loss: 18392177.6000; val_masked_gp_l1_reg_loss: 88012.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89902.0938; val_chrom_access_recon_loss: 5753970.9000; val_global_loss: 24963062.4000; val_optim_loss: 24963062.4000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9690; val_auprc_score: 0.9618; val_best_acc_score: 0.9158; val_best_f1_score: 0.9194; train_kl_reg_loss: 57528.4226; train_edge_recon_loss: 576709.6889; train_gene_expr_recon_loss: 18140737.2901; train_masked_gp_l1_reg_loss: 88352.5853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89806.1809; train_chrom_access_recon_loss: 5640558.4084; train_global_loss: 24593692.7481; train_optim_loss: 24593692.7481; val_kl_reg_loss: 57982.4956; val_edge_recon_loss: 577343.2375; val_gene_expr_recon_loss: 18377250.6667; val_masked_gp_l1_reg_loss: 88504.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89556.0312; val_chrom_access_recon_loss: 5775873.2000; val_global_loss: 24966509.7333; val_optim_loss: 24966509.7333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9645; val_auprc_score: 0.9555; val_best_acc_score: 0.9115; val_best_f1_score: 0.9153; train_kl_reg_loss: 58191.1116; train_edge_recon_loss: 576999.1174; train_gene_expr_recon_loss: 18087946.7481; train_masked_gp_l1_reg_loss: 88711.5641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89937.9114; train_chrom_access_recon_loss: 5627002.2634; train_global_loss: 24528788.7481; train_optim_loss: 24528788.7481; val_kl_reg_loss: 57419.9865; val_edge_recon_loss: 583506.2458; val_gene_expr_recon_loss: 18343604.1333; val_masked_gp_l1_reg_loss: 88868.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90719.9531; val_chrom_access_recon_loss: 5745162.3333; val_global_loss: 24909280.5333; val_optim_loss: 24909280.5333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9254; val_auprc_score: 0.9168; val_best_acc_score: 0.8525; val_best_f1_score: 0.8580; train_kl_reg_loss: 77318829.7385; train_edge_recon_loss: 592482.5792; train_gene_expr_recon_loss: 18444898.8244; train_masked_gp_l1_reg_loss: 89151.7802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98565.4962; train_chrom_access_recon_loss: 5809085.2137; train_global_loss: 102353001.3282; train_optim_loss: 102353001.3282; val_kl_reg_loss: 313677.0687; val_edge_recon_loss: 716381.9500; val_gene_expr_recon_loss: 20061944.0000; val_masked_gp_l1_reg_loss: 89847.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 211567.4375; val_chrom_access_recon_loss: 6338384.1000; val_global_loss: 27731803.0667; val_optim_loss: 27731803.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8830; val_auprc_score: 0.8857; val_best_acc_score: 0.7968; val_best_f1_score: 0.8081; train_kl_reg_loss: 5660576.2323; train_edge_recon_loss: 782612.0816; train_gene_expr_recon_loss: 21117012.9771; train_masked_gp_l1_reg_loss: 95517.3641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184055.2433; train_chrom_access_recon_loss: 6347612.0229; train_global_loss: 34187385.6183; train_optim_loss: 34187385.6183; val_kl_reg_loss: 255134.1437; val_edge_recon_loss: 767944.2667; val_gene_expr_recon_loss: 19324284.0000; val_masked_gp_l1_reg_loss: 86186.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126645.0000; val_chrom_access_recon_loss: 5984195.5333; val_global_loss: 26544388.9333; val_optim_loss: 26544388.9333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8781; val_auprc_score: 0.8827; val_best_acc_score: 0.7978; val_best_f1_score: 0.8001; train_kl_reg_loss: 6033553.7495; train_edge_recon_loss: 769339.9618; train_gene_expr_recon_loss: 19800658.1069; train_masked_gp_l1_reg_loss: 80673.4915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118821.6703; train_chrom_access_recon_loss: 5962236.2366; train_global_loss: 32765283.5267; train_optim_loss: 32765283.5267; val_kl_reg_loss: 228957.0417; val_edge_recon_loss: 757423.0417; val_gene_expr_recon_loss: 19091842.1333; val_masked_gp_l1_reg_loss: 75665.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111718.2891; val_chrom_access_recon_loss: 5944882.7333; val_global_loss: 26210488.8000; val_optim_loss: 26210488.8000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8222; val_auprc_score: 0.8415; val_best_acc_score: 0.7273; val_best_f1_score: 0.7515; train_kl_reg_loss: 10436411383893.0957; train_edge_recon_loss: 771625.9676; train_gene_expr_recon_loss: 19944213.9237; train_masked_gp_l1_reg_loss: 73174.6874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 138854.9627; train_chrom_access_recon_loss: 6112825.0992; train_global_loss: 10436438225942.5195; train_optim_loss: 10436438225942.5195; val_kl_reg_loss: 43551480.4292; val_edge_recon_loss: 795854.4000; val_gene_expr_recon_loss: 19595146.6667; val_masked_gp_l1_reg_loss: 71705.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 179036.2031; val_chrom_access_recon_loss: 6065338.8333; val_global_loss: 70258558.6667; val_optim_loss: 70258558.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8292; val_auprc_score: 0.8474; val_best_acc_score: 0.7392; val_best_f1_score: 0.7534; train_kl_reg_loss: 27676052.5596; train_edge_recon_loss: 789924.0253; train_gene_expr_recon_loss: 19406008.2748; train_masked_gp_l1_reg_loss: 70695.6661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117134.2366; train_chrom_access_recon_loss: 5964409.1145; train_global_loss: 54024225.4962; train_optim_loss: 54024225.4962; val_kl_reg_loss: 364485.5229; val_edge_recon_loss: 785610.0208; val_gene_expr_recon_loss: 19188652.6667; val_masked_gp_l1_reg_loss: 70067.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95015.2969; val_chrom_access_recon_loss: 5900312.0667; val_global_loss: 26404144.2667; val_optim_loss: 26404144.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8327; val_auprc_score: 0.8513; val_best_acc_score: 0.7472; val_best_f1_score: 0.7541; train_kl_reg_loss: 305507.8997; train_edge_recon_loss: 777257.0639; train_gene_expr_recon_loss: 19258802.5038; train_masked_gp_l1_reg_loss: 69797.4033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91220.1826; train_chrom_access_recon_loss: 5899022.6260; train_global_loss: 26401607.4198; train_optim_loss: 26401607.4198; val_kl_reg_loss: 260870.7271; val_edge_recon_loss: 772285.3125; val_gene_expr_recon_loss: 19122261.4667; val_masked_gp_l1_reg_loss: 69518.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88580.6016; val_chrom_access_recon_loss: 5907566.3000; val_global_loss: 26221081.6000; val_optim_loss: 26221081.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8505; val_auprc_score: 0.8628; val_best_acc_score: 0.7586; val_best_f1_score: 0.7685; train_kl_reg_loss: 231743.6325; train_edge_recon_loss: 763324.1279; train_gene_expr_recon_loss: 19174727.6641; train_masked_gp_l1_reg_loss: 69388.9568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87267.5465; train_chrom_access_recon_loss: 5859598.0115; train_global_loss: 26186049.8779; train_optim_loss: 26186049.8779; val_kl_reg_loss: 206627.5708; val_edge_recon_loss: 758744.1500; val_gene_expr_recon_loss: 19177796.1333; val_masked_gp_l1_reg_loss: 69250.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85990.0469; val_chrom_access_recon_loss: 5918245.7333; val_global_loss: 26216653.6000; val_optim_loss: 26216653.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8636; val_auprc_score: 0.8715; val_best_acc_score: 0.7774; val_best_f1_score: 0.7838; train_kl_reg_loss: 186559.1125; train_edge_recon_loss: 747175.0115; train_gene_expr_recon_loss: 19122015.2977; train_masked_gp_l1_reg_loss: 69199.8069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85001.5545; train_chrom_access_recon_loss: 5829777.5534; train_global_loss: 26039728.1985; train_optim_loss: 26039728.1985; val_kl_reg_loss: 168978.7250; val_edge_recon_loss: 743303.9958; val_gene_expr_recon_loss: 19114000.8000; val_masked_gp_l1_reg_loss: 69169.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84156.0703; val_chrom_access_recon_loss: 5877175.1667; val_global_loss: 26056784.2667; val_optim_loss: 26056784.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 32 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9644
val AUPRC score: 0.9522
val best accuracy score: 0.9134
val best F1 score: 0.9162
val target rna MSE score: 1.2695
val source rna MSE score: 0.4655
val target atac MSE score: 0.3548
val source atac MSE score: 0.0997
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
