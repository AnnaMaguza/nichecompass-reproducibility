[True]
Run timestamp: 10102023_052402_156.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_156']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6381; val_auprc_score: 0.6246; val_best_acc_score: 0.5000; val_best_f1_score: 0.6667; train_kl_reg_loss: 35069.0346; train_edge_recon_loss: 726194.2027; train_gene_expr_recon_loss: 23527899.0606; train_masked_gp_l1_reg_loss: 145597.4203; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4992342.3182; train_chrom_access_recon_loss: 1003140.7623; train_global_loss: 30430242.8788; train_optim_loss: 30430242.8788; val_kl_reg_loss: 79663.6045; val_edge_recon_loss: 813172.7891; val_gene_expr_recon_loss: 21906112.7500; val_masked_gp_l1_reg_loss: 118408.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2820855.0000; val_chrom_access_recon_loss: 975375.6484; val_global_loss: 26713587.5000; val_optim_loss: 26713587.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7136; val_auprc_score: 0.6921; val_best_acc_score: 0.5618; val_best_f1_score: 0.6914; train_kl_reg_loss: 77240.6005; train_edge_recon_loss: 739715.5275; train_gene_expr_recon_loss: 21381266.1515; train_masked_gp_l1_reg_loss: 110039.8229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1556067.1051; train_chrom_access_recon_loss: 950394.6487; train_global_loss: 24814723.6970; train_optim_loss: 24814723.6970; val_kl_reg_loss: 80191.4619; val_edge_recon_loss: 812439.9766; val_gene_expr_recon_loss: 21288753.0000; val_masked_gp_l1_reg_loss: 106162.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 757169.3125; val_chrom_access_recon_loss: 955473.4531; val_global_loss: 24000190.2500; val_optim_loss: 24000190.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7399; val_auprc_score: 0.7263; val_best_acc_score: 0.6451; val_best_f1_score: 0.7177; train_kl_reg_loss: 75597.2994; train_edge_recon_loss: 734932.0795; train_gene_expr_recon_loss: 21124788.6364; train_masked_gp_l1_reg_loss: 104421.2444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 500084.5095; train_chrom_access_recon_loss: 942156.2216; train_global_loss: 23481979.9697; train_optim_loss: 23481979.9697; val_kl_reg_loss: 75801.9668; val_edge_recon_loss: 810699.5781; val_gene_expr_recon_loss: 21141519.0000; val_masked_gp_l1_reg_loss: 103964.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 333366.4688; val_chrom_access_recon_loss: 947800.8281; val_global_loss: 23413151.5000; val_optim_loss: 23413151.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7740; val_auprc_score: 0.7495; val_best_acc_score: 0.7010; val_best_f1_score: 0.7173; train_kl_reg_loss: 70165.1818; train_edge_recon_loss: 730690.2055; train_gene_expr_recon_loss: 20993360.6364; train_masked_gp_l1_reg_loss: 104462.2522; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 261279.4955; train_chrom_access_recon_loss: 937443.0199; train_global_loss: 23097400.7879; train_optim_loss: 23097400.7879; val_kl_reg_loss: 71211.6191; val_edge_recon_loss: 805481.8047; val_gene_expr_recon_loss: 20664004.0000; val_masked_gp_l1_reg_loss: 105014.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 207211.6250; val_chrom_access_recon_loss: 928966.4531; val_global_loss: 22781889.7500; val_optim_loss: 22781889.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8118; val_auprc_score: 0.7906; val_best_acc_score: 0.7147; val_best_f1_score: 0.7392; train_kl_reg_loss: 66448.4442; train_edge_recon_loss: 725736.2633; train_gene_expr_recon_loss: 20868266.3030; train_masked_gp_l1_reg_loss: 105833.4353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 177667.1754; train_chrom_access_recon_loss: 931751.7841; train_global_loss: 22875703.1212; train_optim_loss: 22875703.1212; val_kl_reg_loss: 63787.1890; val_edge_recon_loss: 794161.6016; val_gene_expr_recon_loss: 20788468.0000; val_masked_gp_l1_reg_loss: 106249.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154104.9531; val_chrom_access_recon_loss: 934050.0391; val_global_loss: 22840821.2500; val_optim_loss: 22840821.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8417; val_auprc_score: 0.8211; val_best_acc_score: 0.7700; val_best_f1_score: 0.7833; train_kl_reg_loss: 63292.7192; train_edge_recon_loss: 718494.5047; train_gene_expr_recon_loss: 20741649.1515; train_masked_gp_l1_reg_loss: 107175.1551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141754.6918; train_chrom_access_recon_loss: 927313.0616; train_global_loss: 22699679.3939; train_optim_loss: 22699679.3939; val_kl_reg_loss: 61995.8066; val_edge_recon_loss: 768689.8047; val_gene_expr_recon_loss: 20565630.5000; val_masked_gp_l1_reg_loss: 108654.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 133838.3750; val_chrom_access_recon_loss: 922428.2422; val_global_loss: 22561236.0000; val_optim_loss: 22561236.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8707; val_auprc_score: 0.8312; val_best_acc_score: 0.8082; val_best_f1_score: 0.8234; train_kl_reg_loss: 61883.3280; train_edge_recon_loss: 697665.2595; train_gene_expr_recon_loss: 20594769.0909; train_masked_gp_l1_reg_loss: 109427.7208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129817.5252; train_chrom_access_recon_loss: 922318.0597; train_global_loss: 22515881.2121; train_optim_loss: 22515881.2121; val_kl_reg_loss: 63950.7339; val_edge_recon_loss: 690968.1094; val_gene_expr_recon_loss: 20640146.2500; val_masked_gp_l1_reg_loss: 110115.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 126915.4375; val_chrom_access_recon_loss: 935668.9141; val_global_loss: 22567766.0000; val_optim_loss: 22567766.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8852; val_auprc_score: 0.8415; val_best_acc_score: 0.8264; val_best_f1_score: 0.8387; train_kl_reg_loss: 71287.5227; train_edge_recon_loss: 650534.1089; train_gene_expr_recon_loss: 20465768.5758; train_masked_gp_l1_reg_loss: 110879.3565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122715.8652; train_chrom_access_recon_loss: 918285.2812; train_global_loss: 22339470.5152; train_optim_loss: 22339470.5152; val_kl_reg_loss: 76240.2559; val_edge_recon_loss: 642273.9766; val_gene_expr_recon_loss: 20447585.7500; val_masked_gp_l1_reg_loss: 112264.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118812.9453; val_chrom_access_recon_loss: 933233.9609; val_global_loss: 22330410.0000; val_optim_loss: 22330410.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8872; val_auprc_score: 0.8531; val_best_acc_score: 0.8173; val_best_f1_score: 0.8320; train_kl_reg_loss: 76280.1283; train_edge_recon_loss: 630507.8182; train_gene_expr_recon_loss: 20372470.3636; train_masked_gp_l1_reg_loss: 112954.6508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114769.6317; train_chrom_access_recon_loss: 914114.0843; train_global_loss: 22221096.8182; train_optim_loss: 22221096.8182; val_kl_reg_loss: 74228.4717; val_edge_recon_loss: 632965.7344; val_gene_expr_recon_loss: 20377764.5000; val_masked_gp_l1_reg_loss: 114192.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111703.2891; val_chrom_access_recon_loss: 921395.2109; val_global_loss: 22232250.0000; val_optim_loss: 22232250.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9023; val_auprc_score: 0.8697; val_best_acc_score: 0.8337; val_best_f1_score: 0.8454; train_kl_reg_loss: 76432.6677; train_edge_recon_loss: 621545.0445; train_gene_expr_recon_loss: 20295392.1818; train_masked_gp_l1_reg_loss: 115172.0875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110255.1747; train_chrom_access_recon_loss: 911882.4943; train_global_loss: 22130679.6970; train_optim_loss: 22130679.6970; val_kl_reg_loss: 74093.2549; val_edge_recon_loss: 624457.7734; val_gene_expr_recon_loss: 20244032.2500; val_masked_gp_l1_reg_loss: 116160.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107654.5391; val_chrom_access_recon_loss: 914571.0469; val_global_loss: 22080968.2500; val_optim_loss: 22080968.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9026; val_auprc_score: 0.8642; val_best_acc_score: 0.8444; val_best_f1_score: 0.8546; train_kl_reg_loss: 76295.3679; train_edge_recon_loss: 615271.6837; train_gene_expr_recon_loss: 20205361.0303; train_masked_gp_l1_reg_loss: 116575.0463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105912.0317; train_chrom_access_recon_loss: 908625.5294; train_global_loss: 22028040.7273; train_optim_loss: 22028040.7273; val_kl_reg_loss: 77867.7744; val_edge_recon_loss: 613799.2344; val_gene_expr_recon_loss: 20167739.0000; val_masked_gp_l1_reg_loss: 117142.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104077.1250; val_chrom_access_recon_loss: 904856.3047; val_global_loss: 21985482.0000; val_optim_loss: 21985482.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9038; val_auprc_score: 0.8711; val_best_acc_score: 0.8369; val_best_f1_score: 0.8486; train_kl_reg_loss: 75780.9497; train_edge_recon_loss: 612843.3277; train_gene_expr_recon_loss: 20142805.3636; train_masked_gp_l1_reg_loss: 117878.1989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102381.9265; train_chrom_access_recon_loss: 905021.4905; train_global_loss: 21956711.1818; train_optim_loss: 21956711.1818; val_kl_reg_loss: 75184.9316; val_edge_recon_loss: 616016.5156; val_gene_expr_recon_loss: 20149435.5000; val_masked_gp_l1_reg_loss: 118317.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100520.1328; val_chrom_access_recon_loss: 912531.8516; val_global_loss: 21972006.7500; val_optim_loss: 21972006.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9092; val_auprc_score: 0.8721; val_best_acc_score: 0.8479; val_best_f1_score: 0.8583; train_kl_reg_loss: 75428.6078; train_edge_recon_loss: 608206.8201; train_gene_expr_recon_loss: 20061898.8182; train_masked_gp_l1_reg_loss: 118995.1635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98608.3964; train_chrom_access_recon_loss: 901446.1847; train_global_loss: 21864583.9091; train_optim_loss: 21864583.9091; val_kl_reg_loss: 75136.4014; val_edge_recon_loss: 620853.6250; val_gene_expr_recon_loss: 20002480.5000; val_masked_gp_l1_reg_loss: 119217.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97275.7500; val_chrom_access_recon_loss: 910808.9141; val_global_loss: 21825773.2500; val_optim_loss: 21825773.2500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9222; val_auprc_score: 0.8960; val_best_acc_score: 0.8584; val_best_f1_score: 0.8655; train_kl_reg_loss: 74155.1442; train_edge_recon_loss: 609991.0777; train_gene_expr_recon_loss: 20005580.1212; train_masked_gp_l1_reg_loss: 119656.3796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95996.1747; train_chrom_access_recon_loss: 900145.2216; train_global_loss: 21805524.0000; train_optim_loss: 21805524.0000; val_kl_reg_loss: 73672.7480; val_edge_recon_loss: 614443.9219; val_gene_expr_recon_loss: 19842295.5000; val_masked_gp_l1_reg_loss: 120155.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94918.6875; val_chrom_access_recon_loss: 900547.8125; val_global_loss: 21646034.2500; val_optim_loss: 21646034.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9219; val_auprc_score: 0.8971; val_best_acc_score: 0.8587; val_best_f1_score: 0.8676; train_kl_reg_loss: 74572.0500; train_edge_recon_loss: 602917.6979; train_gene_expr_recon_loss: 19930944.5758; train_masked_gp_l1_reg_loss: 120360.2351; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93517.5960; train_chrom_access_recon_loss: 896323.6496; train_global_loss: 21718635.6061; train_optim_loss: 21718635.6061; val_kl_reg_loss: 74528.9121; val_edge_recon_loss: 608835.4062; val_gene_expr_recon_loss: 19818307.0000; val_masked_gp_l1_reg_loss: 121091.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93311.5078; val_chrom_access_recon_loss: 897108.4922; val_global_loss: 21613183.7500; val_optim_loss: 21613183.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9309; val_auprc_score: 0.9104; val_best_acc_score: 0.8675; val_best_f1_score: 0.8758; train_kl_reg_loss: 73977.6670; train_edge_recon_loss: 602118.0521; train_gene_expr_recon_loss: 19881539.5455; train_masked_gp_l1_reg_loss: 121276.9014; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91777.9558; train_chrom_access_recon_loss: 894556.6591; train_global_loss: 21665247.0000; train_optim_loss: 21665247.0000; val_kl_reg_loss: 74120.8877; val_edge_recon_loss: 602783.1016; val_gene_expr_recon_loss: 19912292.5000; val_masked_gp_l1_reg_loss: 121951.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90776.0312; val_chrom_access_recon_loss: 894412.9453; val_global_loss: 21696337.5000; val_optim_loss: 21696337.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9306; val_auprc_score: 0.9048; val_best_acc_score: 0.8646; val_best_f1_score: 0.8711; train_kl_reg_loss: 73093.9942; train_edge_recon_loss: 601811.9820; train_gene_expr_recon_loss: 19811964.1818; train_masked_gp_l1_reg_loss: 122122.3673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90419.9506; train_chrom_access_recon_loss: 891299.8210; train_global_loss: 21590712.3030; train_optim_loss: 21590712.3030; val_kl_reg_loss: 73119.7031; val_edge_recon_loss: 606197.6641; val_gene_expr_recon_loss: 19821702.2500; val_masked_gp_l1_reg_loss: 122228.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89281.2188; val_chrom_access_recon_loss: 903650.9062; val_global_loss: 21616181.2500; val_optim_loss: 21616181.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9259; val_auprc_score: 0.9017; val_best_acc_score: 0.8638; val_best_f1_score: 0.8712; train_kl_reg_loss: 72549.6942; train_edge_recon_loss: 604133.5710; train_gene_expr_recon_loss: 19772740.8485; train_masked_gp_l1_reg_loss: 122524.2842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88658.2926; train_chrom_access_recon_loss: 889264.3400; train_global_loss: 21549870.9091; train_optim_loss: 21549870.9091; val_kl_reg_loss: 73837.1221; val_edge_recon_loss: 607208.3906; val_gene_expr_recon_loss: 19768493.0000; val_masked_gp_l1_reg_loss: 122746.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88322.2344; val_chrom_access_recon_loss: 895355.1406; val_global_loss: 21555961.7500; val_optim_loss: 21555961.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9333; val_auprc_score: 0.9103; val_best_acc_score: 0.8702; val_best_f1_score: 0.8765; train_kl_reg_loss: 71869.9332; train_edge_recon_loss: 601146.8769; train_gene_expr_recon_loss: 19714443.3636; train_masked_gp_l1_reg_loss: 122994.7610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87846.9240; train_chrom_access_recon_loss: 886335.7140; train_global_loss: 21484637.6667; train_optim_loss: 21484637.6667; val_kl_reg_loss: 72742.9463; val_edge_recon_loss: 606786.5859; val_gene_expr_recon_loss: 19695386.2500; val_masked_gp_l1_reg_loss: 123468.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88001.8281; val_chrom_access_recon_loss: 888262.7734; val_global_loss: 21474648.0000; val_optim_loss: 21474648.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9340; val_auprc_score: 0.9119; val_best_acc_score: 0.8729; val_best_f1_score: 0.8788; train_kl_reg_loss: 71716.7812; train_edge_recon_loss: 599885.3040; train_gene_expr_recon_loss: 19672656.2424; train_masked_gp_l1_reg_loss: 123502.8214; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86843.7262; train_chrom_access_recon_loss: 884404.3106; train_global_loss: 21439009.3939; train_optim_loss: 21439009.3939; val_kl_reg_loss: 72662.6660; val_edge_recon_loss: 604066.2891; val_gene_expr_recon_loss: 19739386.2500; val_masked_gp_l1_reg_loss: 123877.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86790.2031; val_chrom_access_recon_loss: 887123.1172; val_global_loss: 21513906.2500; val_optim_loss: 21513906.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9427; val_auprc_score: 0.9268; val_best_acc_score: 0.8837; val_best_f1_score: 0.8886; train_kl_reg_loss: 71377.1639; train_edge_recon_loss: 599619.7320; train_gene_expr_recon_loss: 19608585.7879; train_masked_gp_l1_reg_loss: 124066.0901; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86244.0851; train_chrom_access_recon_loss: 882345.8267; train_global_loss: 21372238.7576; train_optim_loss: 21372238.7576; val_kl_reg_loss: 71584.8594; val_edge_recon_loss: 599129.2422; val_gene_expr_recon_loss: 19433340.7500; val_masked_gp_l1_reg_loss: 124305.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85582.8984; val_chrom_access_recon_loss: 876550.9141; val_global_loss: 21190493.7500; val_optim_loss: 21190493.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9402; val_auprc_score: 0.9182; val_best_acc_score: 0.8769; val_best_f1_score: 0.8827; train_kl_reg_loss: 70986.8803; train_edge_recon_loss: 597102.5256; train_gene_expr_recon_loss: 19580995.5152; train_masked_gp_l1_reg_loss: 124532.8912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85487.5581; train_chrom_access_recon_loss: 880968.4470; train_global_loss: 21340074.0000; train_optim_loss: 21340074.0000; val_kl_reg_loss: 71990.0684; val_edge_recon_loss: 602198.8984; val_gene_expr_recon_loss: 19649984.2500; val_masked_gp_l1_reg_loss: 124709.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85331.9609; val_chrom_access_recon_loss: 885560.6562; val_global_loss: 21419776.0000; val_optim_loss: 21419776.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9407; val_auprc_score: 0.9230; val_best_acc_score: 0.8853; val_best_f1_score: 0.8882; train_kl_reg_loss: 70885.4482; train_edge_recon_loss: 596707.3807; train_gene_expr_recon_loss: 19536383.4848; train_masked_gp_l1_reg_loss: 125136.5379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85033.5481; train_chrom_access_recon_loss: 878339.1345; train_global_loss: 21292485.3636; train_optim_loss: 21292485.3636; val_kl_reg_loss: 69418.8105; val_edge_recon_loss: 599686.2344; val_gene_expr_recon_loss: 19621965.2500; val_masked_gp_l1_reg_loss: 125425.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84305.8047; val_chrom_access_recon_loss: 884651.7422; val_global_loss: 21385453.7500; val_optim_loss: 21385453.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9454; val_auprc_score: 0.9288; val_best_acc_score: 0.8853; val_best_f1_score: 0.8898; train_kl_reg_loss: 70312.5459; train_edge_recon_loss: 596700.5739; train_gene_expr_recon_loss: 19519976.1515; train_masked_gp_l1_reg_loss: 125713.0046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84191.3101; train_chrom_access_recon_loss: 878155.5625; train_global_loss: 21275049.2727; train_optim_loss: 21275049.2727; val_kl_reg_loss: 71329.7217; val_edge_recon_loss: 599166.7500; val_gene_expr_recon_loss: 19269604.5000; val_masked_gp_l1_reg_loss: 126163.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84754.6719; val_chrom_access_recon_loss: 877308.2656; val_global_loss: 21028327.2500; val_optim_loss: 21028327.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9455; val_auprc_score: 0.9234; val_best_acc_score: 0.8890; val_best_f1_score: 0.8927; train_kl_reg_loss: 69850.8033; train_edge_recon_loss: 597225.6506; train_gene_expr_recon_loss: 19439556.3939; train_masked_gp_l1_reg_loss: 126400.8641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84100.6797; train_chrom_access_recon_loss: 874836.3759; train_global_loss: 21191970.8485; train_optim_loss: 21191970.8485; val_kl_reg_loss: 69517.5273; val_edge_recon_loss: 590406.8828; val_gene_expr_recon_loss: 19388372.5000; val_masked_gp_l1_reg_loss: 126895.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83691.0469; val_chrom_access_recon_loss: 878541.7031; val_global_loss: 21137427.2500; val_optim_loss: 21137427.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8809; val_auprc_score: 0.8442; val_best_acc_score: 0.8025; val_best_f1_score: 0.8290; train_kl_reg_loss: 34958.6416; train_edge_recon_loss: 758163.9129; train_gene_expr_recon_loss: 18384599.1212; train_masked_gp_l1_reg_loss: 131697.2947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88607.8273; train_chrom_access_recon_loss: 835310.1742; train_global_loss: 20233337.0909; train_optim_loss: 20233337.0909; val_kl_reg_loss: 10239.7329; val_edge_recon_loss: 793318.3281; val_gene_expr_recon_loss: 17958556.2500; val_masked_gp_l1_reg_loss: 136071.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97952.8047; val_chrom_access_recon_loss: 812816.7109; val_global_loss: 19808955.2500; val_optim_loss: 19808955.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8559; val_auprc_score: 0.8076; val_best_acc_score: 0.7929; val_best_f1_score: 0.8215; train_kl_reg_loss: 17926.7947; train_edge_recon_loss: 781110.1951; train_gene_expr_recon_loss: 18029146.9697; train_masked_gp_l1_reg_loss: 132512.9841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99400.4502; train_chrom_access_recon_loss: 814829.9688; train_global_loss: 19874927.3333; train_optim_loss: 19874927.3333; val_kl_reg_loss: 17662.5884; val_edge_recon_loss: 793650.0547; val_gene_expr_recon_loss: 18046260.0000; val_masked_gp_l1_reg_loss: 128895.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99765.7500; val_chrom_access_recon_loss: 828428.0781; val_global_loss: 19914662.7500; val_optim_loss: 19914662.7500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9005; val_auprc_score: 0.8637; val_best_acc_score: 0.8356; val_best_f1_score: 0.8509; train_kl_reg_loss: 19151.4112; train_edge_recon_loss: 781782.6051; train_gene_expr_recon_loss: 17978586.6970; train_masked_gp_l1_reg_loss: 127057.6197; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100812.4281; train_chrom_access_recon_loss: 812430.8172; train_global_loss: 19819821.4848; train_optim_loss: 19819821.4848; val_kl_reg_loss: 12386.3529; val_edge_recon_loss: 787972.8203; val_gene_expr_recon_loss: 17763859.0000; val_masked_gp_l1_reg_loss: 124991.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102235.2109; val_chrom_access_recon_loss: 816413.1250; val_global_loss: 19607859.2500; val_optim_loss: 19607859.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8839; val_auprc_score: 0.8441; val_best_acc_score: 0.8262; val_best_f1_score: 0.8398; train_kl_reg_loss: 17759.8824; train_edge_recon_loss: 782066.2434; train_gene_expr_recon_loss: 17901472.0909; train_masked_gp_l1_reg_loss: 122031.6254; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101530.4518; train_chrom_access_recon_loss: 810587.5455; train_global_loss: 19735447.7576; train_optim_loss: 19735447.7576; val_kl_reg_loss: 13338.9183; val_edge_recon_loss: 781535.6406; val_gene_expr_recon_loss: 17754270.2500; val_masked_gp_l1_reg_loss: 118887.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99690.0547; val_chrom_access_recon_loss: 810987.1797; val_global_loss: 19578709.7500; val_optim_loss: 19578709.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8830; val_auprc_score: 0.8389; val_best_acc_score: 0.8221; val_best_f1_score: 0.8391; train_kl_reg_loss: 19336.8886; train_edge_recon_loss: 768255.4119; train_gene_expr_recon_loss: 17810391.5758; train_masked_gp_l1_reg_loss: 116343.8641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97303.8915; train_chrom_access_recon_loss: 808885.7633; train_global_loss: 19620517.5758; train_optim_loss: 19620517.5758; val_kl_reg_loss: 14016.0043; val_edge_recon_loss: 767665.0234; val_gene_expr_recon_loss: 17677323.5000; val_masked_gp_l1_reg_loss: 115189.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96459.1719; val_chrom_access_recon_loss: 816105.2266; val_global_loss: 19486759.7500; val_optim_loss: 19486759.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9004; val_auprc_score: 0.8687; val_best_acc_score: 0.8307; val_best_f1_score: 0.8463; train_kl_reg_loss: 21637.1723; train_edge_recon_loss: 752340.4574; train_gene_expr_recon_loss: 17785295.7879; train_masked_gp_l1_reg_loss: 113384.4361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94238.3866; train_chrom_access_recon_loss: 807743.3409; train_global_loss: 19574639.6061; train_optim_loss: 19574639.6061; val_kl_reg_loss: 15907.5270; val_edge_recon_loss: 752626.3750; val_gene_expr_recon_loss: 17769451.5000; val_masked_gp_l1_reg_loss: 111522.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92019.0312; val_chrom_access_recon_loss: 808464.4141; val_global_loss: 19549991.7500; val_optim_loss: 19549991.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9008; val_auprc_score: 0.8639; val_best_acc_score: 0.8283; val_best_f1_score: 0.8443; train_kl_reg_loss: 22702.0412; train_edge_recon_loss: 740129.6525; train_gene_expr_recon_loss: 17810614.5455; train_masked_gp_l1_reg_loss: 110959.4767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92179.3513; train_chrom_access_recon_loss: 806867.9479; train_global_loss: 19583453.0909; train_optim_loss: 19583453.0909; val_kl_reg_loss: 25341.9443; val_edge_recon_loss: 750532.3516; val_gene_expr_recon_loss: 17573813.0000; val_masked_gp_l1_reg_loss: 109839.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92192.9766; val_chrom_access_recon_loss: 803637.9766; val_global_loss: 19355357.0000; val_optim_loss: 19355357.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9049; val_auprc_score: 0.8761; val_best_acc_score: 0.8404; val_best_f1_score: 0.8508; train_kl_reg_loss: 22641.0618; train_edge_recon_loss: 741210.1392; train_gene_expr_recon_loss: 17748486.7576; train_masked_gp_l1_reg_loss: 108721.4586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90772.1780; train_chrom_access_recon_loss: 805253.2367; train_global_loss: 19517084.9091; train_optim_loss: 19517084.9091; val_kl_reg_loss: 17218.5491; val_edge_recon_loss: 738774.2109; val_gene_expr_recon_loss: 17643203.0000; val_masked_gp_l1_reg_loss: 107634.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89052.0156; val_chrom_access_recon_loss: 806986.6250; val_global_loss: 19402868.7500; val_optim_loss: 19402868.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8937; val_auprc_score: 0.8542; val_best_acc_score: 0.8270; val_best_f1_score: 0.8449; train_kl_reg_loss: 22812.5177; train_edge_recon_loss: 728967.4508; train_gene_expr_recon_loss: 17687679.9697; train_masked_gp_l1_reg_loss: 107352.7348; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88437.2616; train_chrom_access_recon_loss: 803695.7036; train_global_loss: 19438945.4848; train_optim_loss: 19438945.4848; val_kl_reg_loss: 15493.6183; val_edge_recon_loss: 738928.1562; val_gene_expr_recon_loss: 17757842.7500; val_masked_gp_l1_reg_loss: 107796.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90117.7031; val_chrom_access_recon_loss: 814673.3438; val_global_loss: 19524852.5000; val_optim_loss: 19524852.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8894; val_auprc_score: 0.8496; val_best_acc_score: 0.8238; val_best_f1_score: 0.8447; train_kl_reg_loss: 22768.8348; train_edge_recon_loss: 723045.0578; train_gene_expr_recon_loss: 17648761.5758; train_masked_gp_l1_reg_loss: 106746.6410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88110.2263; train_chrom_access_recon_loss: 802557.6733; train_global_loss: 19391989.7273; train_optim_loss: 19391989.7273; val_kl_reg_loss: 18194.5828; val_edge_recon_loss: 715167.2031; val_gene_expr_recon_loss: 17745705.5000; val_masked_gp_l1_reg_loss: 105456.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86189.1484; val_chrom_access_recon_loss: 818355.9609; val_global_loss: 19489069.0000; val_optim_loss: 19489069.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8995; val_auprc_score: 0.8654; val_best_acc_score: 0.8267; val_best_f1_score: 0.8469; train_kl_reg_loss: 25712.5483; train_edge_recon_loss: 700433.8778; train_gene_expr_recon_loss: 17637188.5152; train_masked_gp_l1_reg_loss: 104716.4479; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85124.7724; train_chrom_access_recon_loss: 802425.3239; train_global_loss: 19355601.4242; train_optim_loss: 19355601.4242; val_kl_reg_loss: 19871.3228; val_edge_recon_loss: 697943.1797; val_gene_expr_recon_loss: 17586266.5000; val_masked_gp_l1_reg_loss: 104169.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83975.8281; val_chrom_access_recon_loss: 804369.7422; val_global_loss: 19296596.5000; val_optim_loss: 19296596.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8933; val_auprc_score: 0.8514; val_best_acc_score: 0.8318; val_best_f1_score: 0.8504; train_kl_reg_loss: 27309.1745; train_edge_recon_loss: 683630.1581; train_gene_expr_recon_loss: 17614440.6364; train_masked_gp_l1_reg_loss: 103928.4455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83635.9994; train_chrom_access_recon_loss: 801684.7140; train_global_loss: 19314629.0303; train_optim_loss: 19314629.0303; val_kl_reg_loss: 21905.7576; val_edge_recon_loss: 682115.0625; val_gene_expr_recon_loss: 17636998.7500; val_masked_gp_l1_reg_loss: 103721.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83216.7031; val_chrom_access_recon_loss: 804555.1406; val_global_loss: 19332512.0000; val_optim_loss: 19332512.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8941; val_auprc_score: 0.8554; val_best_acc_score: 0.8286; val_best_f1_score: 0.8446; train_kl_reg_loss: 28894.7038; train_edge_recon_loss: 667860.8466; train_gene_expr_recon_loss: 17574320.6061; train_masked_gp_l1_reg_loss: 103208.8303; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82175.2288; train_chrom_access_recon_loss: 800171.8097; train_global_loss: 19256632.1212; train_optim_loss: 19256632.1212; val_kl_reg_loss: 23477.9839; val_edge_recon_loss: 665019.0156; val_gene_expr_recon_loss: 17616603.5000; val_masked_gp_l1_reg_loss: 102999.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81271.4531; val_chrom_access_recon_loss: 806616.9141; val_global_loss: 19295989.5000; val_optim_loss: 19295989.5000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8887; val_auprc_score: 0.8547; val_best_acc_score: 0.8232; val_best_f1_score: 0.8407; train_kl_reg_loss: 29556.1416; train_edge_recon_loss: 654789.3078; train_gene_expr_recon_loss: 17556603.3788; train_masked_gp_l1_reg_loss: 102632.2842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80657.9659; train_chrom_access_recon_loss: 799224.4261; train_global_loss: 19223463.6061; train_optim_loss: 19223463.6061; val_kl_reg_loss: 25071.9285; val_edge_recon_loss: 649690.5703; val_gene_expr_recon_loss: 17583670.0000; val_masked_gp_l1_reg_loss: 102444.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79616.0000; val_chrom_access_recon_loss: 798827.6250; val_global_loss: 19239320.2500; val_optim_loss: 19239320.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8966; val_auprc_score: 0.8614; val_best_acc_score: 0.8272; val_best_f1_score: 0.8473; train_kl_reg_loss: 30121.3300; train_edge_recon_loss: 644358.2642; train_gene_expr_recon_loss: 17528250.3030; train_masked_gp_l1_reg_loss: 102284.7230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79509.5600; train_chrom_access_recon_loss: 796910.9564; train_global_loss: 19181434.7273; train_optim_loss: 19181434.7273; val_kl_reg_loss: 26038.0796; val_edge_recon_loss: 637814.0312; val_gene_expr_recon_loss: 17578394.2500; val_masked_gp_l1_reg_loss: 102225.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79178.3672; val_chrom_access_recon_loss: 799978.3203; val_global_loss: 19223628.7500; val_optim_loss: 19223628.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8978; val_auprc_score: 0.8638; val_best_acc_score: 0.8337; val_best_f1_score: 0.8494; train_kl_reg_loss: 31691.3324; train_edge_recon_loss: 635296.4678; train_gene_expr_recon_loss: 17528455.6061; train_masked_gp_l1_reg_loss: 102033.8300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78520.5421; train_chrom_access_recon_loss: 797069.9773; train_global_loss: 19173067.9394; train_optim_loss: 19173067.9394; val_kl_reg_loss: 27802.1323; val_edge_recon_loss: 629438.8750; val_gene_expr_recon_loss: 17498291.7500; val_masked_gp_l1_reg_loss: 101795.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77785.5547; val_chrom_access_recon_loss: 797192.8438; val_global_loss: 19132307.7500; val_optim_loss: 19132307.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8935; val_auprc_score: 0.8624; val_best_acc_score: 0.8221; val_best_f1_score: 0.8388; train_kl_reg_loss: 32899.0225; train_edge_recon_loss: 628513.1089; train_gene_expr_recon_loss: 17505772.3939; train_masked_gp_l1_reg_loss: 101701.3129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77412.0365; train_chrom_access_recon_loss: 796069.3277; train_global_loss: 19142367.2121; train_optim_loss: 19142367.2121; val_kl_reg_loss: 28692.6685; val_edge_recon_loss: 628883.7656; val_gene_expr_recon_loss: 17569944.2500; val_masked_gp_l1_reg_loss: 101569.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76830.0781; val_chrom_access_recon_loss: 801901.8828; val_global_loss: 19207822.0000; val_optim_loss: 19207822.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8935; val_auprc_score: 0.8483; val_best_acc_score: 0.8313; val_best_f1_score: 0.8482; train_kl_reg_loss: 33743.2387; train_edge_recon_loss: 619522.0701; train_gene_expr_recon_loss: 17494611.1212; train_masked_gp_l1_reg_loss: 101366.5445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76383.8461; train_chrom_access_recon_loss: 796116.3542; train_global_loss: 19121742.9697; train_optim_loss: 19121742.9697; val_kl_reg_loss: 30705.7207; val_edge_recon_loss: 618073.8516; val_gene_expr_recon_loss: 17517607.0000; val_masked_gp_l1_reg_loss: 101311.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75969.5234; val_chrom_access_recon_loss: 798330.0312; val_global_loss: 19141998.0000; val_optim_loss: 19141998.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8919; val_auprc_score: 0.8575; val_best_acc_score: 0.8243; val_best_f1_score: 0.8408; train_kl_reg_loss: 35734.0089; train_edge_recon_loss: 616313.5777; train_gene_expr_recon_loss: 17464924.1667; train_masked_gp_l1_reg_loss: 100969.3874; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75518.0059; train_chrom_access_recon_loss: 795081.3665; train_global_loss: 19088540.4848; train_optim_loss: 19088540.4848; val_kl_reg_loss: 34161.8032; val_edge_recon_loss: 615896.4766; val_gene_expr_recon_loss: 17339939.7500; val_masked_gp_l1_reg_loss: 100607.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75029.3984; val_chrom_access_recon_loss: 792878.0469; val_global_loss: 18958514.5000; val_optim_loss: 18958514.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9003; val_auprc_score: 0.8669; val_best_acc_score: 0.8329; val_best_f1_score: 0.8486; train_kl_reg_loss: 38267.9122; train_edge_recon_loss: 609119.2727; train_gene_expr_recon_loss: 17451845.1212; train_masked_gp_l1_reg_loss: 100315.1950; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74698.0298; train_chrom_access_recon_loss: 793448.7689; train_global_loss: 19067694.3030; train_optim_loss: 19067694.3030; val_kl_reg_loss: 36501.7241; val_edge_recon_loss: 608744.7969; val_gene_expr_recon_loss: 17568761.0000; val_masked_gp_l1_reg_loss: 100199.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74436.7266; val_chrom_access_recon_loss: 807625.4219; val_global_loss: 19196269.2500; val_optim_loss: 19196269.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8966; val_auprc_score: 0.8613; val_best_acc_score: 0.8299; val_best_f1_score: 0.8441; train_kl_reg_loss: 40095.6399; train_edge_recon_loss: 604378.2557; train_gene_expr_recon_loss: 17439578.3636; train_masked_gp_l1_reg_loss: 99708.2021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74139.3126; train_chrom_access_recon_loss: 792955.6534; train_global_loss: 19050855.4545; train_optim_loss: 19050855.4545; val_kl_reg_loss: 38264.9995; val_edge_recon_loss: 601829.4531; val_gene_expr_recon_loss: 17421623.7500; val_masked_gp_l1_reg_loss: 99480.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73941.5625; val_chrom_access_recon_loss: 802631.4219; val_global_loss: 19037771.0000; val_optim_loss: 19037771.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8949; val_auprc_score: 0.8658; val_best_acc_score: 0.8283; val_best_f1_score: 0.8424; train_kl_reg_loss: 41517.5249; train_edge_recon_loss: 603202.6089; train_gene_expr_recon_loss: 17435081.3182; train_masked_gp_l1_reg_loss: 99157.4098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73476.1980; train_chrom_access_recon_loss: 792892.7055; train_global_loss: 19045327.7879; train_optim_loss: 19045327.7879; val_kl_reg_loss: 39362.1069; val_edge_recon_loss: 609802.0078; val_gene_expr_recon_loss: 17387794.0000; val_masked_gp_l1_reg_loss: 98948.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73239.0156; val_chrom_access_recon_loss: 788128.8047; val_global_loss: 18997274.7500; val_optim_loss: 18997274.7500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8996; val_auprc_score: 0.8720; val_best_acc_score: 0.8289; val_best_f1_score: 0.8472; train_kl_reg_loss: 42479.0763; train_edge_recon_loss: 600271.1080; train_gene_expr_recon_loss: 17414560.2727; train_masked_gp_l1_reg_loss: 98579.2796; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72967.7766; train_chrom_access_recon_loss: 792181.9441; train_global_loss: 19021039.5758; train_optim_loss: 19021039.5758; val_kl_reg_loss: 42125.9126; val_edge_recon_loss: 603179.4453; val_gene_expr_recon_loss: 17526646.7500; val_masked_gp_l1_reg_loss: 98347.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72735.6797; val_chrom_access_recon_loss: 801200.5703; val_global_loss: 19144236.7500; val_optim_loss: 19144236.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9110; val_auprc_score: 0.8879; val_best_acc_score: 0.8391; val_best_f1_score: 0.8539; train_kl_reg_loss: 43344.7488; train_edge_recon_loss: 600362.4593; train_gene_expr_recon_loss: 17389585.9697; train_masked_gp_l1_reg_loss: 95625.1075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60029.3215; train_chrom_access_recon_loss: 791275.3949; train_global_loss: 18980222.7576; train_optim_loss: 18980222.7576; val_kl_reg_loss: 41392.7354; val_edge_recon_loss: 594938.8516; val_gene_expr_recon_loss: 17406731.5000; val_masked_gp_l1_reg_loss: 94798.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57392.2812; val_chrom_access_recon_loss: 795508.0078; val_global_loss: 18990761.0000; val_optim_loss: 18990761.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9026; val_auprc_score: 0.8772; val_best_acc_score: 0.8307; val_best_f1_score: 0.8467; train_kl_reg_loss: 43625.3237; train_edge_recon_loss: 600963.8627; train_gene_expr_recon_loss: 17386163.4545; train_masked_gp_l1_reg_loss: 94621.4051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57096.7222; train_chrom_access_recon_loss: 790592.1259; train_global_loss: 18973062.6364; train_optim_loss: 18973062.6364; val_kl_reg_loss: 41894.6201; val_edge_recon_loss: 595577.6172; val_gene_expr_recon_loss: 17336122.5000; val_masked_gp_l1_reg_loss: 94495.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56871.5742; val_chrom_access_recon_loss: 791643.2891; val_global_loss: 18916606.2500; val_optim_loss: 18916606.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8958; val_auprc_score: 0.8634; val_best_acc_score: 0.8278; val_best_f1_score: 0.8421; train_kl_reg_loss: 43900.8166; train_edge_recon_loss: 600458.3258; train_gene_expr_recon_loss: 17397939.1061; train_masked_gp_l1_reg_loss: 94392.7045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56711.4569; train_chrom_access_recon_loss: 791199.2765; train_global_loss: 18984601.9091; train_optim_loss: 18984601.9091; val_kl_reg_loss: 42297.9141; val_edge_recon_loss: 604474.0000; val_gene_expr_recon_loss: 17397963.7500; val_masked_gp_l1_reg_loss: 94328.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56506.0977; val_chrom_access_recon_loss: 798663.2188; val_global_loss: 18994232.7500; val_optim_loss: 18994232.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9017; val_auprc_score: 0.8737; val_best_acc_score: 0.8307; val_best_f1_score: 0.8471; train_kl_reg_loss: 44231.8902; train_edge_recon_loss: 596650.8949; train_gene_expr_recon_loss: 17386122.5758; train_masked_gp_l1_reg_loss: 94260.5019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56365.0774; train_chrom_access_recon_loss: 791173.9413; train_global_loss: 18968804.7879; train_optim_loss: 18968804.7879; val_kl_reg_loss: 42074.2676; val_edge_recon_loss: 600828.6484; val_gene_expr_recon_loss: 17431127.0000; val_masked_gp_l1_reg_loss: 94235.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56213.7148; val_chrom_access_recon_loss: 796752.3359; val_global_loss: 19021232.5000; val_optim_loss: 19021232.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9015; val_auprc_score: 0.8595; val_best_acc_score: 0.8340; val_best_f1_score: 0.8499; train_kl_reg_loss: 44147.7313; train_edge_recon_loss: 603060.9290; train_gene_expr_recon_loss: 17373788.1212; train_masked_gp_l1_reg_loss: 94167.7309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56098.4449; train_chrom_access_recon_loss: 790319.5085; train_global_loss: 18961582.5152; train_optim_loss: 18961582.5152; val_kl_reg_loss: 42645.9404; val_edge_recon_loss: 594363.4922; val_gene_expr_recon_loss: 17428364.7500; val_masked_gp_l1_reg_loss: 94133.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56007.5078; val_chrom_access_recon_loss: 793348.6328; val_global_loss: 19008865.0000; val_optim_loss: 19008865.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8870; val_auprc_score: 0.8553; val_best_acc_score: 0.8189; val_best_f1_score: 0.8332; train_kl_reg_loss: 44485.3182; train_edge_recon_loss: 601491.2718; train_gene_expr_recon_loss: 17387236.4242; train_masked_gp_l1_reg_loss: 94062.0318; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55870.6483; train_chrom_access_recon_loss: 790970.0568; train_global_loss: 18974116.1818; train_optim_loss: 18974116.1818; val_kl_reg_loss: 42793.3999; val_edge_recon_loss: 617083.1484; val_gene_expr_recon_loss: 17173400.3750; val_masked_gp_l1_reg_loss: 94008.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55743.2695; val_chrom_access_recon_loss: 787480.5000; val_global_loss: 18770509.5000; val_optim_loss: 18770509.5000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9025; val_auprc_score: 0.8754; val_best_acc_score: 0.8334; val_best_f1_score: 0.8481; train_kl_reg_loss: 44607.0147; train_edge_recon_loss: 600214.3693; train_gene_expr_recon_loss: 17389807.4848; train_masked_gp_l1_reg_loss: 93970.1982; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55665.0671; train_chrom_access_recon_loss: 790872.4422; train_global_loss: 18975136.7273; train_optim_loss: 18975136.7273; val_kl_reg_loss: 42937.7500; val_edge_recon_loss: 595757.5000; val_gene_expr_recon_loss: 17556435.3750; val_masked_gp_l1_reg_loss: 93941.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55531.3984; val_chrom_access_recon_loss: 810412.0859; val_global_loss: 19155016.7500; val_optim_loss: 19155016.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.8848; val_auprc_score: 0.8519; val_best_acc_score: 0.8157; val_best_f1_score: 0.8362; train_kl_reg_loss: 44762.4712; train_edge_recon_loss: 599412.1335; train_gene_expr_recon_loss: 17374877.7727; train_masked_gp_l1_reg_loss: 93865.2056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55435.2739; train_chrom_access_recon_loss: 789989.9422; train_global_loss: 18958343.0303; train_optim_loss: 18958343.0303; val_kl_reg_loss: 43444.4971; val_edge_recon_loss: 610146.0391; val_gene_expr_recon_loss: 17443117.5000; val_masked_gp_l1_reg_loss: 93806.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55309.8359; val_chrom_access_recon_loss: 793564.9297; val_global_loss: 19039389.0000; val_optim_loss: 19039389.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.8981; val_auprc_score: 0.8694; val_best_acc_score: 0.8307; val_best_f1_score: 0.8452; train_kl_reg_loss: 45028.1784; train_edge_recon_loss: 600727.8807; train_gene_expr_recon_loss: 17360377.2727; train_masked_gp_l1_reg_loss: 93764.5665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55246.3773; train_chrom_access_recon_loss: 789621.5398; train_global_loss: 18944765.8485; train_optim_loss: 18944765.8485; val_kl_reg_loss: 43527.1670; val_edge_recon_loss: 601897.6016; val_gene_expr_recon_loss: 17434570.2500; val_masked_gp_l1_reg_loss: 93696.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55156.9219; val_chrom_access_recon_loss: 804621.8906; val_global_loss: 19033469.0000; val_optim_loss: 19033469.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9014; val_auprc_score: 0.8744; val_best_acc_score: 0.8356; val_best_f1_score: 0.8515; train_kl_reg_loss: 45155.3178; train_edge_recon_loss: 599935.7784; train_gene_expr_recon_loss: 17350317.2424; train_masked_gp_l1_reg_loss: 93631.3613; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55071.3333; train_chrom_access_recon_loss: 788746.2718; train_global_loss: 18932857.1515; train_optim_loss: 18932857.1515; val_kl_reg_loss: 43359.8955; val_edge_recon_loss: 599089.9766; val_gene_expr_recon_loss: 17329155.7500; val_masked_gp_l1_reg_loss: 93609.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54943.1992; val_chrom_access_recon_loss: 799894.2344; val_global_loss: 18920054.0000; val_optim_loss: 18920054.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9015; val_auprc_score: 0.8778; val_best_acc_score: 0.8291; val_best_f1_score: 0.8423; train_kl_reg_loss: 45196.3627; train_edge_recon_loss: 598199.2595; train_gene_expr_recon_loss: 17375764.7576; train_masked_gp_l1_reg_loss: 93321.5940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53643.3080; train_chrom_access_recon_loss: 789647.4261; train_global_loss: 18955772.6667; train_optim_loss: 18955772.6667; val_kl_reg_loss: 43532.8013; val_edge_recon_loss: 603690.4375; val_gene_expr_recon_loss: 17336519.5000; val_masked_gp_l1_reg_loss: 93220.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53387.2383; val_chrom_access_recon_loss: 796098.2031; val_global_loss: 18926449.5000; val_optim_loss: 18926449.5000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9060; val_auprc_score: 0.8735; val_best_acc_score: 0.8356; val_best_f1_score: 0.8517; train_kl_reg_loss: 45182.9199; train_edge_recon_loss: 597999.6146; train_gene_expr_recon_loss: 17377255.6667; train_masked_gp_l1_reg_loss: 93189.2749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53358.9804; train_chrom_access_recon_loss: 789854.1373; train_global_loss: 18956840.3030; train_optim_loss: 18956840.3030; val_kl_reg_loss: 43649.7100; val_edge_recon_loss: 595522.8359; val_gene_expr_recon_loss: 17502166.2500; val_masked_gp_l1_reg_loss: 93158.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53333.3438; val_chrom_access_recon_loss: 801339.4844; val_global_loss: 19089170.0000; val_optim_loss: 19089170.0000
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9008; val_auprc_score: 0.8721; val_best_acc_score: 0.8321; val_best_f1_score: 0.8467; train_kl_reg_loss: 45355.7627; train_edge_recon_loss: 598370.4271; train_gene_expr_recon_loss: 17367642.4848; train_masked_gp_l1_reg_loss: 93140.7501; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53311.4491; train_chrom_access_recon_loss: 789025.5208; train_global_loss: 18946846.0303; train_optim_loss: 18946846.0303; val_kl_reg_loss: 43524.5942; val_edge_recon_loss: 602987.4609; val_gene_expr_recon_loss: 17432330.7500; val_masked_gp_l1_reg_loss: 93125.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53290.1289; val_chrom_access_recon_loss: 792733.7344; val_global_loss: 19017992.0000; val_optim_loss: 19017992.0000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.8960; val_auprc_score: 0.8659; val_best_acc_score: 0.8235; val_best_f1_score: 0.8415; train_kl_reg_loss: 45301.2007; train_edge_recon_loss: 598465.4536; train_gene_expr_recon_loss: 17373504.3333; train_masked_gp_l1_reg_loss: 93113.9003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53274.2228; train_chrom_access_recon_loss: 790088.3011; train_global_loss: 18953747.3939; train_optim_loss: 18953747.3939; val_kl_reg_loss: 43639.0723; val_edge_recon_loss: 604194.6875; val_gene_expr_recon_loss: 17363683.7500; val_masked_gp_l1_reg_loss: 93103.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53254.6680; val_chrom_access_recon_loss: 797869.4609; val_global_loss: 18955745.2500; val_optim_loss: 18955745.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 48 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9032
val AUPRC score: 0.8735
val best accuracy score: 0.8342
val best F1 score: 0.8476
val target rna MSE score: 1.7915
val source rna MSE score: 0.8272
val target atac MSE score: 0.4770
val source atac MSE score: 0.2004
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
