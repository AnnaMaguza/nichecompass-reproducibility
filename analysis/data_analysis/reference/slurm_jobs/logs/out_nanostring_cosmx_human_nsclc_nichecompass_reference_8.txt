[True, False, True]
Run timestamp: 05092023_121353_8.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch5', 'batch6', 'batch7', 'batch8', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.03', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '500000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_8']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch8...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 556628
Number of validation nodes: 61848
Number of training edges: 1316511
Number of validation edges: 146278
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9129; val_auprc_score: 0.9836; val_best_acc_score: 0.9221; val_best_f1_score: 0.9564; train_kl_reg_loss: 16435.0904; train_edge_recon_loss: 719882.9222; train_cat_covariates_contrastive_loss: 478376.0985; train_gene_expr_recon_loss: 2555949.8496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58705.3656; train_global_loss: 3829349.3266; train_optim_loss: 3829349.3266; val_kl_reg_loss: 16616.1252; val_edge_recon_loss: 715804.4358; val_cat_covariates_contrastive_loss: 479812.5627; val_gene_expr_recon_loss: 2213557.9615; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14793.0518; val_global_loss: 3440584.0935; val_optim_loss: 3440584.0935
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9154; val_auprc_score: 0.9831; val_best_acc_score: 0.9250; val_best_f1_score: 0.9579; train_kl_reg_loss: 18913.3170; train_edge_recon_loss: 693816.4727; train_cat_covariates_contrastive_loss: 478788.3259; train_gene_expr_recon_loss: 2081600.8091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14928.2104; train_global_loss: 3288047.1358; train_optim_loss: 3288047.1358; val_kl_reg_loss: 20520.0753; val_edge_recon_loss: 716630.7998; val_cat_covariates_contrastive_loss: 477504.5706; val_gene_expr_recon_loss: 2003004.3094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14890.3271; val_global_loss: 3232550.0079; val_optim_loss: 3232550.0079
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9187; val_auprc_score: 0.9840; val_best_acc_score: 0.9268; val_best_f1_score: 0.9590; train_kl_reg_loss: 20878.9418; train_edge_recon_loss: 691181.7277; train_cat_covariates_contrastive_loss: 478713.6029; train_gene_expr_recon_loss: 1965589.1404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15001.5506; train_global_loss: 3171364.9635; train_optim_loss: 3171364.9635; val_kl_reg_loss: 21951.1251; val_edge_recon_loss: 718760.9656; val_cat_covariates_contrastive_loss: 478020.9154; val_gene_expr_recon_loss: 1936925.9672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15033.0898; val_global_loss: 3170691.9738; val_optim_loss: 3170691.9738
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9212; val_auprc_score: 0.9844; val_best_acc_score: 0.9288; val_best_f1_score: 0.9600; train_kl_reg_loss: 21735.6518; train_edge_recon_loss: 691386.2990; train_cat_covariates_contrastive_loss: 478807.2922; train_gene_expr_recon_loss: 1921282.4611; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15342.2765; train_global_loss: 3128553.9816; train_optim_loss: 3128553.9816; val_kl_reg_loss: 22273.0219; val_edge_recon_loss: 712252.8898; val_cat_covariates_contrastive_loss: 477978.0106; val_gene_expr_recon_loss: 1906414.1809; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15492.8916; val_global_loss: 3134411.1075; val_optim_loss: 3134411.1075
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9267; val_auprc_score: 0.9855; val_best_acc_score: 0.9315; val_best_f1_score: 0.9615; train_kl_reg_loss: 22431.2088; train_edge_recon_loss: 691052.7718; train_cat_covariates_contrastive_loss: 479044.7969; train_gene_expr_recon_loss: 1896898.4567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15587.1649; train_global_loss: 3105014.3993; train_optim_loss: 3105014.3993; val_kl_reg_loss: 22895.7635; val_edge_recon_loss: 711465.9342; val_cat_covariates_contrastive_loss: 479086.2128; val_gene_expr_recon_loss: 1887450.3580; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15735.6475; val_global_loss: 3116634.0192; val_optim_loss: 3116634.0192
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9279; val_auprc_score: 0.9859; val_best_acc_score: 0.9312; val_best_f1_score: 0.9613; train_kl_reg_loss: 22915.9783; train_edge_recon_loss: 688409.4705; train_cat_covariates_contrastive_loss: 478968.7708; train_gene_expr_recon_loss: 1880183.5800; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15749.3646; train_global_loss: 3086227.1646; train_optim_loss: 3086227.1646; val_kl_reg_loss: 23037.5815; val_edge_recon_loss: 710100.6402; val_cat_covariates_contrastive_loss: 479450.2602; val_gene_expr_recon_loss: 1871156.5140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15806.3057; val_global_loss: 3099551.2561; val_optim_loss: 3099551.2561
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9303; val_auprc_score: 0.9861; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 23359.5754; train_edge_recon_loss: 688572.0682; train_cat_covariates_contrastive_loss: 479120.6262; train_gene_expr_recon_loss: 1865369.0767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15888.8182; train_global_loss: 3072310.1637; train_optim_loss: 3072310.1637; val_kl_reg_loss: 24263.5888; val_edge_recon_loss: 715272.0988; val_cat_covariates_contrastive_loss: 478998.4299; val_gene_expr_recon_loss: 1859690.5634; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15840.8770; val_global_loss: 3094065.6757; val_optim_loss: 3094065.6757
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9297; val_auprc_score: 0.9861; val_best_acc_score: 0.9324; val_best_f1_score: 0.9620; train_kl_reg_loss: 24024.5117; train_edge_recon_loss: 691825.2371; train_cat_covariates_contrastive_loss: 479278.5511; train_gene_expr_recon_loss: 1856638.8965; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15954.2441; train_global_loss: 3067721.4403; train_optim_loss: 3067721.4403; val_kl_reg_loss: 24260.8788; val_edge_recon_loss: 711326.2587; val_cat_covariates_contrastive_loss: 479331.0175; val_gene_expr_recon_loss: 1852928.4095; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16157.6846; val_global_loss: 3084004.3086; val_optim_loss: 3084004.3086
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9296; val_auprc_score: 0.9857; val_best_acc_score: 0.9333; val_best_f1_score: 0.9624; train_kl_reg_loss: 24774.9490; train_edge_recon_loss: 691042.4656; train_cat_covariates_contrastive_loss: 479435.3772; train_gene_expr_recon_loss: 1847267.0023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16054.0387; train_global_loss: 3058573.8301; train_optim_loss: 3058573.8301; val_kl_reg_loss: 25409.8060; val_edge_recon_loss: 714871.5988; val_cat_covariates_contrastive_loss: 478732.7215; val_gene_expr_recon_loss: 1845284.2653; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16099.9600; val_global_loss: 3080398.4047; val_optim_loss: 3080398.4047
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9337; val_auprc_score: 0.9870; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 121982307.8295; train_edge_recon_loss: 692020.8541; train_cat_covariates_contrastive_loss: 480366.8485; train_gene_expr_recon_loss: 1951870.3021; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16194.9081; train_global_loss: 125122760.9807; train_optim_loss: 125122760.9807; val_kl_reg_loss: 27215.5066; val_edge_recon_loss: 709851.0126; val_cat_covariates_contrastive_loss: 481161.1222; val_gene_expr_recon_loss: 1857941.6836; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16039.1270; val_global_loss: 3092208.5708; val_optim_loss: 3092208.5708
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9260; val_auprc_score: 0.9859; val_best_acc_score: 0.9295; val_best_f1_score: 0.9603; train_kl_reg_loss: 1259371844067540598784.0000; train_edge_recon_loss: 701192.2532; train_cat_covariates_contrastive_loss: 480838.1974; train_gene_expr_recon_loss: 2157890.4324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17235.1009; train_global_loss: 1259371844067544006656.0000; train_optim_loss: 1259371844067544006656.0000; val_kl_reg_loss: 259762.0738; val_edge_recon_loss: 714084.4289; val_cat_covariates_contrastive_loss: 481689.3990; val_gene_expr_recon_loss: 2138200.1438; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16901.2617; val_global_loss: 3610637.3164; val_optim_loss: 3610637.3164
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9315; val_auprc_score: 0.9864; val_best_acc_score: 0.9350; val_best_f1_score: 0.9633; train_kl_reg_loss: 65303.1273; train_edge_recon_loss: 688722.9147; train_cat_covariates_contrastive_loss: 481055.8842; train_gene_expr_recon_loss: 1985745.0922; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16490.4066; train_global_loss: 3237317.4285; train_optim_loss: 3237317.4285; val_kl_reg_loss: 29988.6358; val_edge_recon_loss: 714698.9465; val_cat_covariates_contrastive_loss: 480003.9432; val_gene_expr_recon_loss: 1912679.1058; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16425.0254; val_global_loss: 3153795.6381; val_optim_loss: 3153795.6381
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9342; val_auprc_score: 0.9873; val_best_acc_score: 0.9337; val_best_f1_score: 0.9626; train_kl_reg_loss: 29648.9646; train_edge_recon_loss: 688790.9253; train_cat_covariates_contrastive_loss: 481345.7940; train_gene_expr_recon_loss: 1899689.1747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16348.5035; train_global_loss: 3115823.3615; train_optim_loss: 3115823.3615; val_kl_reg_loss: 29022.9013; val_edge_recon_loss: 712772.8706; val_cat_covariates_contrastive_loss: 482666.6595; val_gene_expr_recon_loss: 1879468.2740; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16462.2227; val_global_loss: 3120392.9476; val_optim_loss: 3120392.9476

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9333; val_auprc_score: 0.9868; val_best_acc_score: 0.9354; val_best_f1_score: 0.9637; train_kl_reg_loss: 29502.1140; train_edge_recon_loss: 688163.4193; train_cat_covariates_contrastive_loss: 481380.9552; train_gene_expr_recon_loss: 1843980.4925; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7948.1491; train_global_loss: 3050975.1317; train_optim_loss: 3050975.1317; val_kl_reg_loss: 30046.6693; val_edge_recon_loss: 705281.6660; val_cat_covariates_contrastive_loss: 480833.6785; val_gene_expr_recon_loss: 1844806.4493; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7869.1177; val_global_loss: 3068837.4580; val_optim_loss: 3068837.4580
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9329; val_auprc_score: 0.9866; val_best_acc_score: 0.9363; val_best_f1_score: 0.9641; train_kl_reg_loss: 29605.1082; train_edge_recon_loss: 684686.5567; train_cat_covariates_contrastive_loss: 481234.7493; train_gene_expr_recon_loss: 1834318.7235; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7895.9332; train_global_loss: 3037741.0702; train_optim_loss: 3037741.0702; val_kl_reg_loss: 29777.1798; val_edge_recon_loss: 711885.4076; val_cat_covariates_contrastive_loss: 480565.0995; val_gene_expr_recon_loss: 1836543.7885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7882.4702; val_global_loss: 3066653.9747; val_optim_loss: 3066653.9747
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9337; val_auprc_score: 0.9867; val_best_acc_score: 0.9352; val_best_f1_score: 0.9635; train_kl_reg_loss: 29425.9852; train_edge_recon_loss: 688189.7862; train_cat_covariates_contrastive_loss: 481249.9614; train_gene_expr_recon_loss: 1828054.5404; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7911.3653; train_global_loss: 3034831.6346; train_optim_loss: 3034831.6346; val_kl_reg_loss: 29757.4231; val_edge_recon_loss: 716112.3499; val_cat_covariates_contrastive_loss: 480671.8748; val_gene_expr_recon_loss: 1832672.8483; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7891.7207; val_global_loss: 3067106.2483; val_optim_loss: 3067106.2483
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9341; val_auprc_score: 0.9869; val_best_acc_score: 0.9352; val_best_f1_score: 0.9634; train_kl_reg_loss: 29230.1398; train_edge_recon_loss: 689845.0518; train_cat_covariates_contrastive_loss: 481269.7800; train_gene_expr_recon_loss: 1822803.4066; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7917.4822; train_global_loss: 3031065.8573; train_optim_loss: 3031065.8573; val_kl_reg_loss: 29125.9435; val_edge_recon_loss: 708979.0287; val_cat_covariates_contrastive_loss: 481262.7416; val_gene_expr_recon_loss: 1825717.3138; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7906.3345; val_global_loss: 3052991.2762; val_optim_loss: 3052991.2762
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9345; val_auprc_score: 0.9869; val_best_acc_score: 0.9362; val_best_f1_score: 0.9640; train_kl_reg_loss: 28975.4414; train_edge_recon_loss: 687755.1497; train_cat_covariates_contrastive_loss: 481111.1416; train_gene_expr_recon_loss: 1818789.3267; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7933.3182; train_global_loss: 3024564.3766; train_optim_loss: 3024564.3766; val_kl_reg_loss: 28870.0984; val_edge_recon_loss: 708106.8356; val_cat_covariates_contrastive_loss: 481192.1861; val_gene_expr_recon_loss: 1823584.4751; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7915.5288; val_global_loss: 3049669.0795; val_optim_loss: 3049669.0795
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9352; val_auprc_score: 0.9871; val_best_acc_score: 0.9360; val_best_f1_score: 0.9638; train_kl_reg_loss: 28792.0954; train_edge_recon_loss: 687229.2603; train_cat_covariates_contrastive_loss: 481061.7501; train_gene_expr_recon_loss: 1815407.1052; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7934.2405; train_global_loss: 3020424.4491; train_optim_loss: 3020424.4491; val_kl_reg_loss: 28812.6701; val_edge_recon_loss: 707636.3577; val_cat_covariates_contrastive_loss: 481393.0552; val_gene_expr_recon_loss: 1818557.1171; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7962.3271; val_global_loss: 3044361.4537; val_optim_loss: 3044361.4537
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9343; val_auprc_score: 0.9868; val_best_acc_score: 0.9361; val_best_f1_score: 0.9639; train_kl_reg_loss: 28679.1090; train_edge_recon_loss: 686952.3362; train_cat_covariates_contrastive_loss: 481031.5639; train_gene_expr_recon_loss: 1812559.9878; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7946.9627; train_global_loss: 3017169.9637; train_optim_loss: 3017169.9637; val_kl_reg_loss: 28868.2111; val_edge_recon_loss: 709147.1671; val_cat_covariates_contrastive_loss: 480584.2304; val_gene_expr_recon_loss: 1815265.5406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7910.9087; val_global_loss: 3041776.1538; val_optim_loss: 3041776.1538
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9352; val_auprc_score: 0.9872; val_best_acc_score: 0.9364; val_best_f1_score: 0.9642; train_kl_reg_loss: 28502.2088; train_edge_recon_loss: 690227.9010; train_cat_covariates_contrastive_loss: 480971.8065; train_gene_expr_recon_loss: 1808813.0268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7958.5918; train_global_loss: 3016473.5344; train_optim_loss: 3016473.5344; val_kl_reg_loss: 28780.2470; val_edge_recon_loss: 703203.7556; val_cat_covariates_contrastive_loss: 480757.0696; val_gene_expr_recon_loss: 1813180.6622; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7964.7627; val_global_loss: 3033886.4860; val_optim_loss: 3033886.4860
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9351; val_auprc_score: 0.9868; val_best_acc_score: 0.9363; val_best_f1_score: 0.9641; train_kl_reg_loss: 28324.8668; train_edge_recon_loss: 685242.2619; train_cat_covariates_contrastive_loss: 480893.3004; train_gene_expr_recon_loss: 1806512.2733; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7989.7652; train_global_loss: 3008962.4670; train_optim_loss: 3008962.4670; val_kl_reg_loss: 28308.9902; val_edge_recon_loss: 714680.8796; val_cat_covariates_contrastive_loss: 481319.3080; val_gene_expr_recon_loss: 1810963.3601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8000.0010; val_global_loss: 3043272.5358; val_optim_loss: 3043272.5358
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9335; val_auprc_score: 0.9866; val_best_acc_score: 0.9363; val_best_f1_score: 0.9641; train_kl_reg_loss: 28222.7728; train_edge_recon_loss: 689127.9819; train_cat_covariates_contrastive_loss: 480796.1922; train_gene_expr_recon_loss: 1804662.8802; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8003.4615; train_global_loss: 3010813.2857; train_optim_loss: 3010813.2857; val_kl_reg_loss: 28428.0413; val_edge_recon_loss: 710223.3608; val_cat_covariates_contrastive_loss: 480177.0438; val_gene_expr_recon_loss: 1809550.4974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7996.0791; val_global_loss: 3036374.9441; val_optim_loss: 3036374.9441
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9356; val_auprc_score: 0.9871; val_best_acc_score: 0.9372; val_best_f1_score: 0.9646; train_kl_reg_loss: 28115.2253; train_edge_recon_loss: 687060.4342; train_cat_covariates_contrastive_loss: 480828.1304; train_gene_expr_recon_loss: 1803058.5046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8025.9411; train_global_loss: 3007088.2356; train_optim_loss: 3007088.2356; val_kl_reg_loss: 28270.3968; val_edge_recon_loss: 707228.3075; val_cat_covariates_contrastive_loss: 480384.7248; val_gene_expr_recon_loss: 1807983.2273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8035.6455; val_global_loss: 3031902.4135; val_optim_loss: 3031902.4135
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9356; val_auprc_score: 0.9871; val_best_acc_score: 0.9369; val_best_f1_score: 0.9644; train_kl_reg_loss: 28093.1551; train_edge_recon_loss: 685780.4668; train_cat_covariates_contrastive_loss: 480791.1608; train_gene_expr_recon_loss: 1801006.4671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8041.7775; train_global_loss: 3003713.0270; train_optim_loss: 3003713.0270; val_kl_reg_loss: 28006.5375; val_edge_recon_loss: 714135.4089; val_cat_covariates_contrastive_loss: 480981.9987; val_gene_expr_recon_loss: 1807545.8527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8083.8071; val_global_loss: 3038753.5376; val_optim_loss: 3038753.5376
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9243; val_auprc_score: 0.9850; val_best_acc_score: 0.9296; val_best_f1_score: 0.9604; train_kl_reg_loss: 26981.6649; train_edge_recon_loss: 695838.0266; train_cat_covariates_contrastive_loss: 481642.4260; train_gene_expr_recon_loss: 1683798.2353; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6772.4280; train_global_loss: 2895032.7824; train_optim_loss: 2895032.7824; val_kl_reg_loss: 20945.2820; val_edge_recon_loss: 717641.8317; val_cat_covariates_contrastive_loss: 480661.6957; val_gene_expr_recon_loss: 1682379.9292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6341.3472; val_global_loss: 2907969.9851; val_optim_loss: 2907969.9851
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9263; val_auprc_score: 0.9852; val_best_acc_score: 0.9299; val_best_f1_score: 0.9605; train_kl_reg_loss: 25598.7818; train_edge_recon_loss: 693412.6130; train_cat_covariates_contrastive_loss: 480672.3513; train_gene_expr_recon_loss: 1674638.6059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6295.2750; train_global_loss: 2880617.6298; train_optim_loss: 2880617.6298; val_kl_reg_loss: 21788.5362; val_edge_recon_loss: 713037.2708; val_cat_covariates_contrastive_loss: 480101.9855; val_gene_expr_recon_loss: 1678681.1477; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6278.6685; val_global_loss: 2899887.6836; val_optim_loss: 2899887.6836
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9278; val_auprc_score: 0.9856; val_best_acc_score: 0.9301; val_best_f1_score: 0.9607; train_kl_reg_loss: 24583.9765; train_edge_recon_loss: 690121.3428; train_cat_covariates_contrastive_loss: 480336.4756; train_gene_expr_recon_loss: 1669440.7886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6280.6692; train_global_loss: 2870763.2530; train_optim_loss: 2870763.2530; val_kl_reg_loss: 21901.6331; val_edge_recon_loss: 719196.3394; val_cat_covariates_contrastive_loss: 480858.1726; val_gene_expr_recon_loss: 1673476.3824; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6290.7251; val_global_loss: 2901723.2815; val_optim_loss: 2901723.2815
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9288; val_auprc_score: 0.9856; val_best_acc_score: 0.9320; val_best_f1_score: 0.9617; train_kl_reg_loss: 23961.4585; train_edge_recon_loss: 689950.7364; train_cat_covariates_contrastive_loss: 479921.2967; train_gene_expr_recon_loss: 1665005.2442; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6277.0776; train_global_loss: 2865115.8136; train_optim_loss: 2865115.8136; val_kl_reg_loss: 22291.0855; val_edge_recon_loss: 718860.8374; val_cat_covariates_contrastive_loss: 479895.5518; val_gene_expr_recon_loss: 1666279.2649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6291.1553; val_global_loss: 2893617.9878; val_optim_loss: 2893617.9878
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9282; val_auprc_score: 0.9856; val_best_acc_score: 0.9309; val_best_f1_score: 0.9611; train_kl_reg_loss: 23709.4949; train_edge_recon_loss: 691091.9993; train_cat_covariates_contrastive_loss: 479894.6431; train_gene_expr_recon_loss: 1661243.1186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6284.4895; train_global_loss: 2862223.7462; train_optim_loss: 2862223.7462; val_kl_reg_loss: 22759.0850; val_edge_recon_loss: 718064.7300; val_cat_covariates_contrastive_loss: 479860.8530; val_gene_expr_recon_loss: 1665065.4978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6265.7944; val_global_loss: 2892015.9047; val_optim_loss: 2892015.9047
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9297; val_auprc_score: 0.9860; val_best_acc_score: 0.9325; val_best_f1_score: 0.9621; train_kl_reg_loss: 30886.1497; train_edge_recon_loss: 688874.6678; train_cat_covariates_contrastive_loss: 479769.4503; train_gene_expr_recon_loss: 1659310.9377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6286.9500; train_global_loss: 2865128.1540; train_optim_loss: 2865128.1540; val_kl_reg_loss: 22741.9946; val_edge_recon_loss: 711956.1462; val_cat_covariates_contrastive_loss: 479288.2703; val_gene_expr_recon_loss: 1662192.1351; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6272.9639; val_global_loss: 2882451.5507; val_optim_loss: 2882451.5507
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9287; val_auprc_score: 0.9854; val_best_acc_score: 0.9313; val_best_f1_score: 0.9613; train_kl_reg_loss: 23438.7930; train_edge_recon_loss: 690777.3016; train_cat_covariates_contrastive_loss: 479706.1794; train_gene_expr_recon_loss: 1657200.0882; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6298.0893; train_global_loss: 2857420.4487; train_optim_loss: 2857420.4487; val_kl_reg_loss: 23156.2148; val_edge_recon_loss: 723033.7018; val_cat_covariates_contrastive_loss: 479268.7239; val_gene_expr_recon_loss: 1662501.0983; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6296.5850; val_global_loss: 2894256.2439; val_optim_loss: 2894256.2439
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9301; val_auprc_score: 0.9861; val_best_acc_score: 0.9330; val_best_f1_score: 0.9621; train_kl_reg_loss: 23393.5633; train_edge_recon_loss: 687390.4182; train_cat_covariates_contrastive_loss: 479642.1333; train_gene_expr_recon_loss: 1654347.9496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6308.3384; train_global_loss: 2851082.4062; train_optim_loss: 2851082.4062; val_kl_reg_loss: 22945.2107; val_edge_recon_loss: 715777.7855; val_cat_covariates_contrastive_loss: 479651.6542; val_gene_expr_recon_loss: 1659582.7635; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6311.5317; val_global_loss: 2884268.9082; val_optim_loss: 2884268.9082
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9282; val_auprc_score: 0.9856; val_best_acc_score: 0.9321; val_best_f1_score: 0.9617; train_kl_reg_loss: 23283.6810; train_edge_recon_loss: 687420.0280; train_cat_covariates_contrastive_loss: 479643.2092; train_gene_expr_recon_loss: 1651276.2295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6318.2839; train_global_loss: 2847941.4345; train_optim_loss: 2847941.4345; val_kl_reg_loss: 23282.7576; val_edge_recon_loss: 713884.3857; val_cat_covariates_contrastive_loss: 478681.2379; val_gene_expr_recon_loss: 1655937.2876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6318.0884; val_global_loss: 2878103.6643; val_optim_loss: 2878103.6643
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9326; val_auprc_score: 0.9867; val_best_acc_score: 0.9330; val_best_f1_score: 0.9623; train_kl_reg_loss: 23252.4557; train_edge_recon_loss: 686294.9719; train_cat_covariates_contrastive_loss: 479634.3348; train_gene_expr_recon_loss: 1649772.0320; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6329.3975; train_global_loss: 2845283.1935; train_optim_loss: 2845283.1935; val_kl_reg_loss: 22864.0469; val_edge_recon_loss: 705357.4851; val_cat_covariates_contrastive_loss: 479971.1589; val_gene_expr_recon_loss: 1654192.0765; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6360.8135; val_global_loss: 2868745.5219; val_optim_loss: 2868745.5219
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9308; val_auprc_score: 0.9862; val_best_acc_score: 0.9324; val_best_f1_score: 0.9619; train_kl_reg_loss: 23182.9662; train_edge_recon_loss: 690476.8380; train_cat_covariates_contrastive_loss: 479532.6775; train_gene_expr_recon_loss: 1646502.3885; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6348.5013; train_global_loss: 2846043.3701; train_optim_loss: 2846043.3701; val_kl_reg_loss: 22747.4562; val_edge_recon_loss: 715814.5169; val_cat_covariates_contrastive_loss: 479903.7962; val_gene_expr_recon_loss: 1652415.7876; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6359.7354; val_global_loss: 2877241.3068; val_optim_loss: 2877241.3068
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9321; val_auprc_score: 0.9865; val_best_acc_score: 0.9338; val_best_f1_score: 0.9628; train_kl_reg_loss: 23189.2359; train_edge_recon_loss: 685580.6381; train_cat_covariates_contrastive_loss: 479503.1753; train_gene_expr_recon_loss: 1645133.5870; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6364.0691; train_global_loss: 2839770.7052; train_optim_loss: 2839770.7052; val_kl_reg_loss: 22515.5236; val_edge_recon_loss: 711485.2016; val_cat_covariates_contrastive_loss: 479530.5009; val_gene_expr_recon_loss: 1651368.3300; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6352.6226; val_global_loss: 2871252.0603; val_optim_loss: 2871252.0603
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9291; val_auprc_score: 0.9857; val_best_acc_score: 0.9327; val_best_f1_score: 0.9621; train_kl_reg_loss: 23132.9298; train_edge_recon_loss: 689006.0374; train_cat_covariates_contrastive_loss: 479489.6659; train_gene_expr_recon_loss: 1642887.7708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6369.5241; train_global_loss: 2840885.9302; train_optim_loss: 2840885.9302; val_kl_reg_loss: 22661.9728; val_edge_recon_loss: 711408.8311; val_cat_covariates_contrastive_loss: 479098.3962; val_gene_expr_recon_loss: 1648033.8147; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6397.1875; val_global_loss: 2867600.2666; val_optim_loss: 2867600.2666
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9306; val_auprc_score: 0.9862; val_best_acc_score: 0.9336; val_best_f1_score: 0.9626; train_kl_reg_loss: 23033.6318; train_edge_recon_loss: 688384.5304; train_cat_covariates_contrastive_loss: 479382.3673; train_gene_expr_recon_loss: 1641063.8372; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6381.2909; train_global_loss: 2838245.6599; train_optim_loss: 2838245.6599; val_kl_reg_loss: 22668.3299; val_edge_recon_loss: 710923.7315; val_cat_covariates_contrastive_loss: 479329.0935; val_gene_expr_recon_loss: 1647676.3903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6384.1982; val_global_loss: 2866981.7885; val_optim_loss: 2866981.7885
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9318; val_auprc_score: 0.9864; val_best_acc_score: 0.9347; val_best_f1_score: 0.9632; train_kl_reg_loss: 22957.9818; train_edge_recon_loss: 686561.4946; train_cat_covariates_contrastive_loss: 479442.8304; train_gene_expr_recon_loss: 1638769.7309; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6385.0169; train_global_loss: 2834117.0522; train_optim_loss: 2834117.0522; val_kl_reg_loss: 22275.2866; val_edge_recon_loss: 708028.1831; val_cat_covariates_contrastive_loss: 479537.2847; val_gene_expr_recon_loss: 1643780.4760; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6378.6040; val_global_loss: 2859999.7334; val_optim_loss: 2859999.7334
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9323; val_auprc_score: 0.9867; val_best_acc_score: 0.9338; val_best_f1_score: 0.9627; train_kl_reg_loss: 22891.4996; train_edge_recon_loss: 688321.9820; train_cat_covariates_contrastive_loss: 479373.9876; train_gene_expr_recon_loss: 1636595.5762; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6378.4048; train_global_loss: 2833561.4481; train_optim_loss: 2833561.4481; val_kl_reg_loss: 22500.3536; val_edge_recon_loss: 706369.6514; val_cat_covariates_contrastive_loss: 479115.6068; val_gene_expr_recon_loss: 1642359.5385; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6377.0474; val_global_loss: 2856722.1451; val_optim_loss: 2856722.1451
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9332; val_auprc_score: 0.9867; val_best_acc_score: 0.9331; val_best_f1_score: 0.9623; train_kl_reg_loss: 22832.3407; train_edge_recon_loss: 687381.9572; train_cat_covariates_contrastive_loss: 479331.3661; train_gene_expr_recon_loss: 1632647.0813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6388.9550; train_global_loss: 2828581.7007; train_optim_loss: 2828581.7007; val_kl_reg_loss: 22084.7139; val_edge_recon_loss: 713183.1062; val_cat_covariates_contrastive_loss: 480346.6146; val_gene_expr_recon_loss: 1635153.3269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6397.2910; val_global_loss: 2857165.0122; val_optim_loss: 2857165.0122
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9297; val_auprc_score: 0.9860; val_best_acc_score: 0.9329; val_best_f1_score: 0.9623; train_kl_reg_loss: 23736.9240; train_edge_recon_loss: 687947.8223; train_cat_covariates_contrastive_loss: 479264.6628; train_gene_expr_recon_loss: 1629906.7569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6401.2567; train_global_loss: 2827257.4219; train_optim_loss: 2827257.4219; val_kl_reg_loss: 22851.2797; val_edge_recon_loss: 703793.4524; val_cat_covariates_contrastive_loss: 478454.6973; val_gene_expr_recon_loss: 1635196.6888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6391.9990; val_global_loss: 2846688.1171; val_optim_loss: 2846688.1171
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9310; val_auprc_score: 0.9860; val_best_acc_score: 0.9335; val_best_f1_score: 0.9625; train_kl_reg_loss: 22667.1960; train_edge_recon_loss: 687281.4604; train_cat_covariates_contrastive_loss: 479106.7724; train_gene_expr_recon_loss: 1629379.5148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6406.4024; train_global_loss: 2824841.3489; train_optim_loss: 2824841.3489; val_kl_reg_loss: 22359.1224; val_edge_recon_loss: 713300.7260; val_cat_covariates_contrastive_loss: 478835.8708; val_gene_expr_recon_loss: 1633894.4755; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6419.6650; val_global_loss: 2854809.9423; val_optim_loss: 2854809.9423
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9304; val_auprc_score: 0.9860; val_best_acc_score: 0.9344; val_best_f1_score: 0.9630; train_kl_reg_loss: 22596.1059; train_edge_recon_loss: 688307.8453; train_cat_covariates_contrastive_loss: 479093.2512; train_gene_expr_recon_loss: 1628021.7723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6411.7029; train_global_loss: 2824430.6808; train_optim_loss: 2824430.6808; val_kl_reg_loss: 22669.3062; val_edge_recon_loss: 705373.5328; val_cat_covariates_contrastive_loss: 478365.9413; val_gene_expr_recon_loss: 1633566.3553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6374.2080; val_global_loss: 2846349.3899; val_optim_loss: 2846349.3899
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9314; val_auprc_score: 0.9861; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 22568.3430; train_edge_recon_loss: 685661.6418; train_cat_covariates_contrastive_loss: 479049.8867; train_gene_expr_recon_loss: 1627104.8006; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6419.1466; train_global_loss: 2820803.8154; train_optim_loss: 2820803.8154; val_kl_reg_loss: 22446.0566; val_edge_recon_loss: 710872.9222; val_cat_covariates_contrastive_loss: 479056.8170; val_gene_expr_recon_loss: 1632289.7522; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6467.4121; val_global_loss: 2851133.0385; val_optim_loss: 2851133.0385
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9306; val_auprc_score: 0.9859; val_best_acc_score: 0.9326; val_best_f1_score: 0.9621; train_kl_reg_loss: 24115.4912; train_edge_recon_loss: 687076.6323; train_cat_covariates_contrastive_loss: 479034.8967; train_gene_expr_recon_loss: 1626179.7041; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6437.8401; train_global_loss: 2822844.5671; train_optim_loss: 2822844.5671; val_kl_reg_loss: 23476.5458; val_edge_recon_loss: 714440.7240; val_cat_covariates_contrastive_loss: 478710.5491; val_gene_expr_recon_loss: 1632647.3562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6427.4561; val_global_loss: 2855702.6766; val_optim_loss: 2855702.6766
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9344; val_auprc_score: 0.9867; val_best_acc_score: 0.9349; val_best_f1_score: 0.9633; train_kl_reg_loss: 22575.0513; train_edge_recon_loss: 689713.8609; train_cat_covariates_contrastive_loss: 479007.6202; train_gene_expr_recon_loss: 1625432.3073; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6442.7614; train_global_loss: 2823171.6017; train_optim_loss: 2823171.6017; val_kl_reg_loss: 22461.8096; val_edge_recon_loss: 712682.3408; val_cat_covariates_contrastive_loss: 479163.8145; val_gene_expr_recon_loss: 1631118.5079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6408.5122; val_global_loss: 2851834.9685; val_optim_loss: 2851834.9685
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9335; val_auprc_score: 0.9865; val_best_acc_score: 0.9351; val_best_f1_score: 0.9634; train_kl_reg_loss: 22499.7053; train_edge_recon_loss: 686492.1101; train_cat_covariates_contrastive_loss: 478941.3148; train_gene_expr_recon_loss: 1623667.0150; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6436.6070; train_global_loss: 2818036.7488; train_optim_loss: 2818036.7488; val_kl_reg_loss: 22748.2151; val_edge_recon_loss: 713032.4455; val_cat_covariates_contrastive_loss: 478166.8549; val_gene_expr_recon_loss: 1630091.8986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 6469.8652; val_global_loss: 2850509.1678; val_optim_loss: 2850509.1678

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9323; val_auprc_score: 0.9865; val_best_acc_score: 0.9343; val_best_f1_score: 0.9629; train_kl_reg_loss: 22369.5767; train_edge_recon_loss: 685008.4328; train_cat_covariates_contrastive_loss: 478831.1008; train_gene_expr_recon_loss: 1619258.5658; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5687.6450; train_global_loss: 2811155.3173; train_optim_loss: 2811155.3173; val_kl_reg_loss: 22181.7995; val_edge_recon_loss: 708168.0488; val_cat_covariates_contrastive_loss: 479587.6619; val_gene_expr_recon_loss: 1625268.8330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5683.5479; val_global_loss: 2840889.8383; val_optim_loss: 2840889.8383
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9333; val_auprc_score: 0.9866; val_best_acc_score: 0.9344; val_best_f1_score: 0.9630; train_kl_reg_loss: 22344.8523; train_edge_recon_loss: 686394.4210; train_cat_covariates_contrastive_loss: 478913.7292; train_gene_expr_recon_loss: 1619210.5140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5678.2480; train_global_loss: 2812541.7647; train_optim_loss: 2812541.7647; val_kl_reg_loss: 22147.2051; val_edge_recon_loss: 710786.4255; val_cat_covariates_contrastive_loss: 478637.5217; val_gene_expr_recon_loss: 1626202.4672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5683.3369; val_global_loss: 2843456.8654; val_optim_loss: 2843456.8654
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9331; val_auprc_score: 0.9863; val_best_acc_score: 0.9343; val_best_f1_score: 0.9630; train_kl_reg_loss: 22329.3845; train_edge_recon_loss: 686096.9035; train_cat_covariates_contrastive_loss: 478806.7426; train_gene_expr_recon_loss: 1619275.6868; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5680.1692; train_global_loss: 2812188.8844; train_optim_loss: 2812188.8844; val_kl_reg_loss: 22293.8679; val_edge_recon_loss: 712303.3326; val_cat_covariates_contrastive_loss: 479004.9642; val_gene_expr_recon_loss: 1627706.8383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5681.5264; val_global_loss: 2846990.5000; val_optim_loss: 2846990.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9333; val_auprc_score: 0.9865; val_best_acc_score: 0.9341; val_best_f1_score: 0.9628; train_kl_reg_loss: 22329.2959; train_edge_recon_loss: 686113.1979; train_cat_covariates_contrastive_loss: 478865.7633; train_gene_expr_recon_loss: 1619335.6803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5677.8544; train_global_loss: 2812321.7909; train_optim_loss: 2812321.7909; val_kl_reg_loss: 22146.0734; val_edge_recon_loss: 715978.5081; val_cat_covariates_contrastive_loss: 478717.6100; val_gene_expr_recon_loss: 1625055.3383; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5679.5356; val_global_loss: 2847577.0297; val_optim_loss: 2847577.0297
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9317; val_auprc_score: 0.9863; val_best_acc_score: 0.9347; val_best_f1_score: 0.9632; train_kl_reg_loss: 22309.4544; train_edge_recon_loss: 685530.5623; train_cat_covariates_contrastive_loss: 478859.4261; train_gene_expr_recon_loss: 1619364.1263; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5677.1642; train_global_loss: 2811740.7348; train_optim_loss: 2811740.7348; val_kl_reg_loss: 22223.9508; val_edge_recon_loss: 709439.7887; val_cat_covariates_contrastive_loss: 478645.9096; val_gene_expr_recon_loss: 1625265.8457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5686.2856; val_global_loss: 2841261.7465; val_optim_loss: 2841261.7465

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9346; val_auprc_score: 0.9870; val_best_acc_score: 0.9342; val_best_f1_score: 0.9629; train_kl_reg_loss: 22324.2047; train_edge_recon_loss: 687830.3730; train_cat_covariates_contrastive_loss: 478862.1462; train_gene_expr_recon_loss: 1618867.6116; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5598.0751; train_global_loss: 2813482.4045; train_optim_loss: 2813482.4045; val_kl_reg_loss: 22230.4701; val_edge_recon_loss: 712127.4729; val_cat_covariates_contrastive_loss: 478632.6455; val_gene_expr_recon_loss: 1625791.7072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5593.6050; val_global_loss: 2844375.7990; val_optim_loss: 2844375.7990
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9331; val_auprc_score: 0.9865; val_best_acc_score: 0.9344; val_best_f1_score: 0.9630; train_kl_reg_loss: 22300.2070; train_edge_recon_loss: 686890.8541; train_cat_covariates_contrastive_loss: 478801.8967; train_gene_expr_recon_loss: 1618560.4265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5592.1135; train_global_loss: 2812145.4943; train_optim_loss: 2812145.4943; val_kl_reg_loss: 22209.2579; val_edge_recon_loss: 713397.4985; val_cat_covariates_contrastive_loss: 479022.6746; val_gene_expr_recon_loss: 1625983.6110; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5591.7886; val_global_loss: 2846204.7876; val_optim_loss: 2846204.7876
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9334; val_auprc_score: 0.9868; val_best_acc_score: 0.9341; val_best_f1_score: 0.9629; train_kl_reg_loss: 22285.8535; train_edge_recon_loss: 686577.4460; train_cat_covariates_contrastive_loss: 478830.5147; train_gene_expr_recon_loss: 1618353.8237; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5591.9289; train_global_loss: 2811639.5665; train_optim_loss: 2811639.5665; val_kl_reg_loss: 22217.5615; val_edge_recon_loss: 707402.4604; val_cat_covariates_contrastive_loss: 479001.6768; val_gene_expr_recon_loss: 1626133.7662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5588.9668; val_global_loss: 2840344.4624; val_optim_loss: 2840344.4624
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9322; val_auprc_score: 0.9865; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 22306.6427; train_edge_recon_loss: 685686.1620; train_cat_covariates_contrastive_loss: 478679.3358; train_gene_expr_recon_loss: 1618512.7077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5590.1965; train_global_loss: 2810775.0474; train_optim_loss: 2810775.0474; val_kl_reg_loss: 22219.8945; val_edge_recon_loss: 708923.7343; val_cat_covariates_contrastive_loss: 479303.2787; val_gene_expr_recon_loss: 1625561.3278; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5589.6245; val_global_loss: 2841597.7343; val_optim_loss: 2841597.7343
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9335; val_auprc_score: 0.9868; val_best_acc_score: 0.9347; val_best_f1_score: 0.9632; train_kl_reg_loss: 22300.6137; train_edge_recon_loss: 687505.8087; train_cat_covariates_contrastive_loss: 478836.3253; train_gene_expr_recon_loss: 1618535.2091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5590.9187; train_global_loss: 2812768.8733; train_optim_loss: 2812768.8733; val_kl_reg_loss: 22219.7200; val_edge_recon_loss: 707663.0945; val_cat_covariates_contrastive_loss: 478997.7548; val_gene_expr_recon_loss: 1626709.8881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5592.3325; val_global_loss: 2841182.7019; val_optim_loss: 2841182.7019
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9322; val_auprc_score: 0.9864; val_best_acc_score: 0.9337; val_best_f1_score: 0.9627; train_kl_reg_loss: 22302.0518; train_edge_recon_loss: 685770.9239; train_cat_covariates_contrastive_loss: 478793.2647; train_gene_expr_recon_loss: 1618558.0191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5592.1769; train_global_loss: 2811016.4380; train_optim_loss: 2811016.4380; val_kl_reg_loss: 22207.2997; val_edge_recon_loss: 712708.6652; val_cat_covariates_contrastive_loss: 478807.5186; val_gene_expr_recon_loss: 1625992.3912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5592.5566; val_global_loss: 2845308.3794; val_optim_loss: 2845308.3794
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9342; val_auprc_score: 0.9869; val_best_acc_score: 0.9336; val_best_f1_score: 0.9626; train_kl_reg_loss: 22276.7514; train_edge_recon_loss: 685053.0288; train_cat_covariates_contrastive_loss: 478918.5942; train_gene_expr_recon_loss: 1618282.0927; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5593.5718; train_global_loss: 2810124.0345; train_optim_loss: 2810124.0345; val_kl_reg_loss: 22180.1392; val_edge_recon_loss: 713263.9181; val_cat_covariates_contrastive_loss: 478634.7880; val_gene_expr_recon_loss: 1625478.4449; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5594.4741; val_global_loss: 2845151.7963; val_optim_loss: 2845151.7963

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9325; val_auprc_score: 0.9866; val_best_acc_score: 0.9344; val_best_f1_score: 0.9631; train_kl_reg_loss: 22275.6440; train_edge_recon_loss: 686834.0299; train_cat_covariates_contrastive_loss: 478786.4399; train_gene_expr_recon_loss: 1617942.9478; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5585.9866; train_global_loss: 2811425.0510; train_optim_loss: 2811425.0510; val_kl_reg_loss: 22193.7919; val_edge_recon_loss: 707026.0699; val_cat_covariates_contrastive_loss: 478673.2426; val_gene_expr_recon_loss: 1624138.8453; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5585.6562; val_global_loss: 2837617.7098; val_optim_loss: 2837617.7098
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9330; val_auprc_score: 0.9866; val_best_acc_score: 0.9341; val_best_f1_score: 0.9629; train_kl_reg_loss: 22273.1853; train_edge_recon_loss: 687692.8437; train_cat_covariates_contrastive_loss: 478836.4477; train_gene_expr_recon_loss: 1617970.5005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5585.4789; train_global_loss: 2812358.4399; train_optim_loss: 2812358.4399; val_kl_reg_loss: 22191.1403; val_edge_recon_loss: 713448.2056; val_cat_covariates_contrastive_loss: 479510.7348; val_gene_expr_recon_loss: 1626239.3763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5585.3213; val_global_loss: 2846974.7203; val_optim_loss: 2846974.7203
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9327; val_auprc_score: 0.9864; val_best_acc_score: 0.9345; val_best_f1_score: 0.9631; train_kl_reg_loss: 22279.6913; train_edge_recon_loss: 684314.4343; train_cat_covariates_contrastive_loss: 478659.6949; train_gene_expr_recon_loss: 1618308.4381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5585.2174; train_global_loss: 2809147.4806; train_optim_loss: 2809147.4806; val_kl_reg_loss: 22192.2170; val_edge_recon_loss: 707037.2456; val_cat_covariates_contrastive_loss: 478818.0738; val_gene_expr_recon_loss: 1624131.4362; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5584.9805; val_global_loss: 2837763.9703; val_optim_loss: 2837763.9703
Epoch 65/400 |███-----------------| 16.2% val_auroc_score: 0.9329; val_auprc_score: 0.9865; val_best_acc_score: 0.9343; val_best_f1_score: 0.9630; train_kl_reg_loss: 22270.7981; train_edge_recon_loss: 686404.6743; train_cat_covariates_contrastive_loss: 478934.5978; train_gene_expr_recon_loss: 1617871.3637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5585.0178; train_global_loss: 2811066.4304; train_optim_loss: 2811066.4304; val_kl_reg_loss: 22193.5527; val_edge_recon_loss: 709983.5875; val_cat_covariates_contrastive_loss: 479029.8071; val_gene_expr_recon_loss: 1625545.3759; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5584.8110; val_global_loss: 2842337.0717; val_optim_loss: 2842337.0717
Epoch 66/400 |███-----------------| 16.5% val_auroc_score: 0.9343; val_auprc_score: 0.9869; val_best_acc_score: 0.9349; val_best_f1_score: 0.9634; train_kl_reg_loss: 22274.4175; train_edge_recon_loss: 686977.2580; train_cat_covariates_contrastive_loss: 478753.1980; train_gene_expr_recon_loss: 1617591.4285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5584.8352; train_global_loss: 2811181.1199; train_optim_loss: 2811181.1199; val_kl_reg_loss: 22171.2351; val_edge_recon_loss: 704314.9880; val_cat_covariates_contrastive_loss: 479280.9940; val_gene_expr_recon_loss: 1626376.8330; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5584.8691; val_global_loss: 2837728.7893; val_optim_loss: 2837728.7893

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000004e-08.

Epoch 67/400 |███-----------------| 16.8% val_auroc_score: 0.9321; val_auprc_score: 0.9865; val_best_acc_score: 0.9342; val_best_f1_score: 0.9629; train_kl_reg_loss: 22276.8530; train_edge_recon_loss: 689057.8742; train_cat_covariates_contrastive_loss: 478798.8524; train_gene_expr_recon_loss: 1618367.3007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5584.0130; train_global_loss: 2814084.8870; train_optim_loss: 2814084.8870; val_kl_reg_loss: 22194.0014; val_edge_recon_loss: 712318.1414; val_cat_covariates_contrastive_loss: 478931.9528; val_gene_expr_recon_loss: 1624433.9100; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9731; val_global_loss: 2843462.0009; val_optim_loss: 2843462.0009
Epoch 68/400 |███-----------------| 17.0% val_auroc_score: 0.9318; val_auprc_score: 0.9863; val_best_acc_score: 0.9344; val_best_f1_score: 0.9631; train_kl_reg_loss: 22270.7242; train_edge_recon_loss: 686795.1593; train_cat_covariates_contrastive_loss: 478841.5082; train_gene_expr_recon_loss: 1618359.7992; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9784; train_global_loss: 2811851.1912; train_optim_loss: 2811851.1912; val_kl_reg_loss: 22187.5792; val_edge_recon_loss: 705969.6971; val_cat_covariates_contrastive_loss: 478804.5129; val_gene_expr_recon_loss: 1624051.8309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9600; val_global_loss: 2836597.6198; val_optim_loss: 2836597.6198
Epoch 69/400 |███-----------------| 17.2% val_auroc_score: 0.9329; val_auprc_score: 0.9865; val_best_acc_score: 0.9349; val_best_f1_score: 0.9633; train_kl_reg_loss: 22277.0891; train_edge_recon_loss: 687453.3177; train_cat_covariates_contrastive_loss: 478787.5286; train_gene_expr_recon_loss: 1617920.4395; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9644; train_global_loss: 2812022.3747; train_optim_loss: 2812022.3747; val_kl_reg_loss: 22214.9266; val_edge_recon_loss: 710793.2408; val_cat_covariates_contrastive_loss: 478851.1794; val_gene_expr_recon_loss: 1625832.5616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9741; val_global_loss: 2843275.9082; val_optim_loss: 2843275.9082
Epoch 70/400 |███-----------------| 17.5% val_auroc_score: 0.9330; val_auprc_score: 0.9867; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 22277.2597; train_edge_recon_loss: 684837.0316; train_cat_covariates_contrastive_loss: 478843.8995; train_gene_expr_recon_loss: 1618271.4875; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9849; train_global_loss: 2809813.6798; train_optim_loss: 2809813.6798; val_kl_reg_loss: 22193.1482; val_edge_recon_loss: 708165.5010; val_cat_covariates_contrastive_loss: 479313.6051; val_gene_expr_recon_loss: 1625464.7325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9741; val_global_loss: 2840720.9816; val_optim_loss: 2840720.9816
Epoch 71/400 |███-----------------| 17.8% val_auroc_score: 0.9310; val_auprc_score: 0.9859; val_best_acc_score: 0.9339; val_best_f1_score: 0.9627; train_kl_reg_loss: 22277.0313; train_edge_recon_loss: 688552.7091; train_cat_covariates_contrastive_loss: 478711.0371; train_gene_expr_recon_loss: 1618243.7506; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9722; train_global_loss: 2813368.5272; train_optim_loss: 2813368.5272; val_kl_reg_loss: 22192.5918; val_edge_recon_loss: 716793.2154; val_cat_covariates_contrastive_loss: 478779.3276; val_gene_expr_recon_loss: 1625250.9991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9893; val_global_loss: 2848600.1311; val_optim_loss: 2848600.1311
Epoch 72/400 |███-----------------| 18.0% val_auroc_score: 0.9333; val_auprc_score: 0.9867; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 22278.5812; train_edge_recon_loss: 685587.2076; train_cat_covariates_contrastive_loss: 478774.7163; train_gene_expr_recon_loss: 1618169.4225; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9972; train_global_loss: 2810393.9262; train_optim_loss: 2810393.9262; val_kl_reg_loss: 22199.9905; val_edge_recon_loss: 709725.0105; val_cat_covariates_contrastive_loss: 478604.4871; val_gene_expr_recon_loss: 1625969.2885; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9937; val_global_loss: 2842082.7797; val_optim_loss: 2842082.7797

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000005e-09.

Epoch 73/400 |███-----------------| 18.2% val_auroc_score: 0.9312; val_auprc_score: 0.9862; val_best_acc_score: 0.9343; val_best_f1_score: 0.9630; train_kl_reg_loss: 22281.8596; train_edge_recon_loss: 686559.4503; train_cat_covariates_contrastive_loss: 478925.4341; train_gene_expr_recon_loss: 1617921.0946; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9063; train_global_loss: 2811271.8373; train_optim_loss: 2811271.8373; val_kl_reg_loss: 22189.4554; val_edge_recon_loss: 707249.2758; val_cat_covariates_contrastive_loss: 478954.6550; val_gene_expr_recon_loss: 1624806.0577; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9062; val_global_loss: 2838783.4379; val_optim_loss: 2838783.4379
Epoch 74/400 |███-----------------| 18.5% val_auroc_score: 0.9332; val_auprc_score: 0.9865; val_best_acc_score: 0.9342; val_best_f1_score: 0.9629; train_kl_reg_loss: 22276.1212; train_edge_recon_loss: 688528.6777; train_cat_covariates_contrastive_loss: 478758.9289; train_gene_expr_recon_loss: 1617976.4468; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9049; train_global_loss: 2813124.1719; train_optim_loss: 2813124.1719; val_kl_reg_loss: 22213.6340; val_edge_recon_loss: 715314.5876; val_cat_covariates_contrastive_loss: 478854.8613; val_gene_expr_recon_loss: 1626948.8816; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9028; val_global_loss: 2848915.9642; val_optim_loss: 2848915.9642
Epoch 75/400 |███-----------------| 18.8% val_auroc_score: 0.9341; val_auprc_score: 0.9869; val_best_acc_score: 0.9355; val_best_f1_score: 0.9637; train_kl_reg_loss: 22281.0092; train_edge_recon_loss: 685207.9060; train_cat_covariates_contrastive_loss: 478837.4375; train_gene_expr_recon_loss: 1618111.5728; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9033; train_global_loss: 2810021.9307; train_optim_loss: 2810021.9307; val_kl_reg_loss: 22211.6692; val_edge_recon_loss: 700284.8224; val_cat_covariates_contrastive_loss: 478802.4920; val_gene_expr_recon_loss: 1625508.2596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9043; val_global_loss: 2832391.2413; val_optim_loss: 2832391.2413
Epoch 76/400 |███-----------------| 19.0% val_auroc_score: 0.9338; val_auprc_score: 0.9868; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 22265.3611; train_edge_recon_loss: 686405.7978; train_cat_covariates_contrastive_loss: 478958.2626; train_gene_expr_recon_loss: 1617701.9670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9030; train_global_loss: 2810915.3891; train_optim_loss: 2810915.3891; val_kl_reg_loss: 22177.2356; val_edge_recon_loss: 710774.9366; val_cat_covariates_contrastive_loss: 479249.4261; val_gene_expr_recon_loss: 1625087.1412; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9028; val_global_loss: 2842872.7456; val_optim_loss: 2842872.7456
Epoch 77/400 |███-----------------| 19.2% val_auroc_score: 0.9329; val_auprc_score: 0.9865; val_best_acc_score: 0.9346; val_best_f1_score: 0.9631; train_kl_reg_loss: 22275.6360; train_edge_recon_loss: 686603.1853; train_cat_covariates_contrastive_loss: 478792.0784; train_gene_expr_recon_loss: 1618166.1088; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9041; train_global_loss: 2811421.0093; train_optim_loss: 2811421.0093; val_kl_reg_loss: 22192.5180; val_edge_recon_loss: 706568.5402; val_cat_covariates_contrastive_loss: 478848.5295; val_gene_expr_recon_loss: 1627307.3247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9033; val_global_loss: 2840500.9248; val_optim_loss: 2840500.9248
Epoch 78/400 |███-----------------| 19.5% val_auroc_score: 0.9330; val_auprc_score: 0.9865; val_best_acc_score: 0.9342; val_best_f1_score: 0.9629; train_kl_reg_loss: 22282.3632; train_edge_recon_loss: 687040.1052; train_cat_covariates_contrastive_loss: 478921.5739; train_gene_expr_recon_loss: 1618280.0738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9035; train_global_loss: 2812108.1191; train_optim_loss: 2812108.1191; val_kl_reg_loss: 22190.5644; val_edge_recon_loss: 711770.8680; val_cat_covariates_contrastive_loss: 478876.0986; val_gene_expr_recon_loss: 1624902.0726; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9023; val_global_loss: 2843323.6110; val_optim_loss: 2843323.6110
Epoch 79/400 |███-----------------| 19.8% val_auroc_score: 0.9325; val_auprc_score: 0.9866; val_best_acc_score: 0.9340; val_best_f1_score: 0.9628; train_kl_reg_loss: 22283.9193; train_edge_recon_loss: 686445.5974; train_cat_covariates_contrastive_loss: 478785.8520; train_gene_expr_recon_loss: 1618156.2419; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.9026; train_global_loss: 2811255.6108; train_optim_loss: 2811255.6108; val_kl_reg_loss: 22188.4162; val_edge_recon_loss: 707572.1152; val_cat_covariates_contrastive_loss: 478799.5535; val_gene_expr_recon_loss: 1624504.7837; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.9028; val_global_loss: 2838648.8671; val_optim_loss: 2838648.8671

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000006e-10.

Epoch 80/400 |████----------------| 20.0% val_auroc_score: 0.9330; val_auprc_score: 0.9866; val_best_acc_score: 0.9339; val_best_f1_score: 0.9627; train_kl_reg_loss: 22280.1222; train_edge_recon_loss: 685990.5681; train_cat_covariates_contrastive_loss: 478867.8938; train_gene_expr_recon_loss: 1617819.2630; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.8946; train_global_loss: 2810541.8472; train_optim_loss: 2810541.8472; val_kl_reg_loss: 22186.7448; val_edge_recon_loss: 716827.8147; val_cat_covariates_contrastive_loss: 478746.0117; val_gene_expr_recon_loss: 1623192.5970; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.8940; val_global_loss: 2846537.1617; val_optim_loss: 2846537.1617
Epoch 81/400 |████----------------| 20.2% val_auroc_score: 0.9346; val_auprc_score: 0.9872; val_best_acc_score: 0.9350; val_best_f1_score: 0.9634; train_kl_reg_loss: 22277.9898; train_edge_recon_loss: 687441.3404; train_cat_covariates_contrastive_loss: 478801.3671; train_gene_expr_recon_loss: 1617759.1583; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.8942; train_global_loss: 2811863.8583; train_optim_loss: 2811863.8583; val_kl_reg_loss: 22183.9398; val_edge_recon_loss: 702762.7793; val_cat_covariates_contrastive_loss: 479191.3471; val_gene_expr_recon_loss: 1626048.5835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.8940; val_global_loss: 2835770.6469; val_optim_loss: 2835770.6469
Epoch 82/400 |████----------------| 20.5% val_auroc_score: 0.9308; val_auprc_score: 0.9860; val_best_acc_score: 0.9341; val_best_f1_score: 0.9629; train_kl_reg_loss: 22280.8269; train_edge_recon_loss: 687951.8039; train_cat_covariates_contrastive_loss: 478820.3650; train_gene_expr_recon_loss: 1618515.0258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.8942; train_global_loss: 2813152.0212; train_optim_loss: 2813152.0212; val_kl_reg_loss: 22195.1327; val_edge_recon_loss: 710160.0691; val_cat_covariates_contrastive_loss: 478686.9654; val_gene_expr_recon_loss: 1626423.7251; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.8940; val_global_loss: 2843049.8907; val_optim_loss: 2843049.8907
Epoch 83/400 |████----------------| 20.8% val_auroc_score: 0.9323; val_auprc_score: 0.9864; val_best_acc_score: 0.9344; val_best_f1_score: 0.9631; train_kl_reg_loss: 22269.4075; train_edge_recon_loss: 687510.0568; train_cat_covariates_contrastive_loss: 478736.4566; train_gene_expr_recon_loss: 1618347.2308; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5583.8943; train_global_loss: 2812447.1529; train_optim_loss: 2812447.1529; val_kl_reg_loss: 22190.1282; val_edge_recon_loss: 710601.3230; val_cat_covariates_contrastive_loss: 479010.7902; val_gene_expr_recon_loss: 1625456.9371; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 5583.8940; val_global_loss: 2842843.1652; val_optim_loss: 2842843.1652

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 1617 min 28 sec.
Using best model state, which was in epoch 75.

--- MODEL EVALUATION ---
val AUROC score: 0.9185
val AUPRC score: 0.9798
val best accuracy score: 0.9314
val best F1 score: 0.9613
val target rna MSE score: 0.4562
val source rna MSE score: 0.1475
Val cat covariate0 mean sim diff: -0.0008
Val cat covariate1 mean sim diff: -0.0541
Val cat covariate2 mean sim diff: -0.0002

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
