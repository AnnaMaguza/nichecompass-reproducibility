[True]
Run timestamp: 10102023_024247_115.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_115']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6776; val_auprc_score: 0.6539; val_best_acc_score: 0.5013; val_best_f1_score: 0.6671; train_kl_reg_loss: 51441.9718; train_edge_recon_loss: 3505688.7386; train_gene_expr_recon_loss: 13864593.2121; train_masked_gp_l1_reg_loss: 31479.7462; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3591091.7481; train_chrom_access_recon_loss: 4952942.2652; train_global_loss: 25997237.7273; train_optim_loss: 25997237.7273; val_kl_reg_loss: 130524.3467; val_edge_recon_loss: 4065005.9062; val_gene_expr_recon_loss: 12940981.0000; val_masked_gp_l1_reg_loss: 37553.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1963035.6250; val_chrom_access_recon_loss: 4703735.6875; val_global_loss: 23840837.2500; val_optim_loss: 23840837.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6868; val_auprc_score: 0.6708; val_best_acc_score: 0.5865; val_best_f1_score: 0.6928; train_kl_reg_loss: 94314.1172; train_edge_recon_loss: 3518967.3674; train_gene_expr_recon_loss: 12823058.6364; train_masked_gp_l1_reg_loss: 39327.6403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1057290.4223; train_chrom_access_recon_loss: 4723262.2803; train_global_loss: 22256220.3636; train_optim_loss: 22256220.3636; val_kl_reg_loss: 106201.0781; val_edge_recon_loss: 4060068.5625; val_gene_expr_recon_loss: 12622456.6250; val_masked_gp_l1_reg_loss: 40982.0977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 504601.8750; val_chrom_access_recon_loss: 4677032.3125; val_global_loss: 22011342.2500; val_optim_loss: 22011342.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7669; val_auprc_score: 0.7527; val_best_acc_score: 0.6711; val_best_f1_score: 0.7235; train_kl_reg_loss: 84955.4321; train_edge_recon_loss: 3508023.6515; train_gene_expr_recon_loss: 12691438.1818; train_masked_gp_l1_reg_loss: 42119.5671; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 337065.9676; train_chrom_access_recon_loss: 4693866.9470; train_global_loss: 21357469.6364; train_optim_loss: 21357469.6364; val_kl_reg_loss: 95067.7910; val_edge_recon_loss: 3997944.4688; val_gene_expr_recon_loss: 12651907.2500; val_masked_gp_l1_reg_loss: 43460.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230100.5469; val_chrom_access_recon_loss: 4657186.6875; val_global_loss: 21675666.5000; val_optim_loss: 21675666.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8098; val_auprc_score: 0.8039; val_best_acc_score: 0.7319; val_best_f1_score: 0.7424; train_kl_reg_loss: 64296.0279; train_edge_recon_loss: 3385759.2841; train_gene_expr_recon_loss: 12630302.3939; train_masked_gp_l1_reg_loss: 45337.5624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 184042.6768; train_chrom_access_recon_loss: 4670417.8106; train_global_loss: 20980155.6667; train_optim_loss: 20980155.6667; val_kl_reg_loss: 71260.6123; val_edge_recon_loss: 3202090.4375; val_gene_expr_recon_loss: 12601841.8750; val_masked_gp_l1_reg_loss: 47950.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149329.7188; val_chrom_access_recon_loss: 4586825.6875; val_global_loss: 20659298.5000; val_optim_loss: 20659298.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8821; val_auprc_score: 0.8578; val_best_acc_score: 0.8106; val_best_f1_score: 0.8250; train_kl_reg_loss: 85607.1364; train_edge_recon_loss: 2992160.9924; train_gene_expr_recon_loss: 12569370.4848; train_masked_gp_l1_reg_loss: 50292.6617; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 130567.3226; train_chrom_access_recon_loss: 4644010.3333; train_global_loss: 20472008.8485; train_optim_loss: 20472008.8485; val_kl_reg_loss: 98425.6270; val_edge_recon_loss: 2912208.7188; val_gene_expr_recon_loss: 12418186.3750; val_masked_gp_l1_reg_loss: 52611.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117818.8828; val_chrom_access_recon_loss: 4585969.0000; val_global_loss: 20185219.2500; val_optim_loss: 20185219.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8974; val_auprc_score: 0.8709; val_best_acc_score: 0.8313; val_best_f1_score: 0.8429; train_kl_reg_loss: 107597.3705; train_edge_recon_loss: 2849583.4924; train_gene_expr_recon_loss: 12465597.3636; train_masked_gp_l1_reg_loss: 53938.1868; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111568.4777; train_chrom_access_recon_loss: 4616426.5606; train_global_loss: 20204711.4545; train_optim_loss: 20204711.4545; val_kl_reg_loss: 102861.0771; val_edge_recon_loss: 2846468.8438; val_gene_expr_recon_loss: 12398363.5000; val_masked_gp_l1_reg_loss: 55366.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106340.4219; val_chrom_access_recon_loss: 4560696.5000; val_global_loss: 20070095.7500; val_optim_loss: 20070095.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8953; val_auprc_score: 0.8674; val_best_acc_score: 0.8275; val_best_f1_score: 0.8390; train_kl_reg_loss: 100034.7900; train_edge_recon_loss: 2833435.6136; train_gene_expr_recon_loss: 12387355.9242; train_masked_gp_l1_reg_loss: 56567.2504; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101040.4317; train_chrom_access_recon_loss: 4591550.5000; train_global_loss: 20069984.5152; train_optim_loss: 20069984.5152; val_kl_reg_loss: 100108.8857; val_edge_recon_loss: 2868058.2500; val_gene_expr_recon_loss: 12342318.0000; val_masked_gp_l1_reg_loss: 57756.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96008.6094; val_chrom_access_recon_loss: 4492309.8438; val_global_loss: 19956561.0000; val_optim_loss: 19956561.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8894; val_auprc_score: 0.8569; val_best_acc_score: 0.8305; val_best_f1_score: 0.8438; train_kl_reg_loss: 99792.6815; train_edge_recon_loss: 2823528.3788; train_gene_expr_recon_loss: 12331475.7273; train_masked_gp_l1_reg_loss: 58645.4876; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93169.0924; train_chrom_access_recon_loss: 4574766.6970; train_global_loss: 19981378.2121; train_optim_loss: 19981378.2121; val_kl_reg_loss: 100559.5020; val_edge_recon_loss: 2887585.0312; val_gene_expr_recon_loss: 12313945.1250; val_masked_gp_l1_reg_loss: 59697.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91338.8828; val_chrom_access_recon_loss: 4565585.6250; val_global_loss: 20018711.5000; val_optim_loss: 20018711.5000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8963; val_auprc_score: 0.8601; val_best_acc_score: 0.8388; val_best_f1_score: 0.8519; train_kl_reg_loss: 99812.3651; train_edge_recon_loss: 2809182.0189; train_gene_expr_recon_loss: 12265344.2576; train_masked_gp_l1_reg_loss: 60414.0604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89364.3768; train_chrom_access_recon_loss: 4551409.9091; train_global_loss: 19875527.0606; train_optim_loss: 19875527.0606; val_kl_reg_loss: 98724.0205; val_edge_recon_loss: 2833570.9688; val_gene_expr_recon_loss: 12277841.1250; val_masked_gp_l1_reg_loss: 61123.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88064.2422; val_chrom_access_recon_loss: 4474379.8750; val_global_loss: 19833703.0000; val_optim_loss: 19833703.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9076; val_auprc_score: 0.8851; val_best_acc_score: 0.8450; val_best_f1_score: 0.8560; train_kl_reg_loss: 96296.8857; train_edge_recon_loss: 2791496.3561; train_gene_expr_recon_loss: 12207954.9545; train_masked_gp_l1_reg_loss: 62012.3926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86993.1630; train_chrom_access_recon_loss: 4534279.1667; train_global_loss: 19779032.8182; train_optim_loss: 19779032.8182; val_kl_reg_loss: 91276.5039; val_edge_recon_loss: 2824229.3438; val_gene_expr_recon_loss: 12202035.2500; val_masked_gp_l1_reg_loss: 62776.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86117.0234; val_chrom_access_recon_loss: 4494457.0000; val_global_loss: 19760891.7500; val_optim_loss: 19760891.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9177; val_auprc_score: 0.8928; val_best_acc_score: 0.8592; val_best_f1_score: 0.8667; train_kl_reg_loss: 91999.6271; train_edge_recon_loss: 2793227.7992; train_gene_expr_recon_loss: 12160333.2727; train_masked_gp_l1_reg_loss: 63489.4371; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84280.7144; train_chrom_access_recon_loss: 4517796.5606; train_global_loss: 19711127.4848; train_optim_loss: 19711127.4848; val_kl_reg_loss: 93614.0078; val_edge_recon_loss: 2773667.3125; val_gene_expr_recon_loss: 12054230.1250; val_masked_gp_l1_reg_loss: 64224.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82619.3672; val_chrom_access_recon_loss: 4437817.0000; val_global_loss: 19506171.7500; val_optim_loss: 19506171.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9156; val_auprc_score: 0.8912; val_best_acc_score: 0.8589; val_best_f1_score: 0.8685; train_kl_reg_loss: 90654.1020; train_edge_recon_loss: 2800401.9886; train_gene_expr_recon_loss: 12106485.1970; train_masked_gp_l1_reg_loss: 64796.8988; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81134.0320; train_chrom_access_recon_loss: 4499080.4394; train_global_loss: 19642552.7879; train_optim_loss: 19642552.7879; val_kl_reg_loss: 87650.0820; val_edge_recon_loss: 2817852.3438; val_gene_expr_recon_loss: 12092613.3750; val_masked_gp_l1_reg_loss: 65395.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80069.9531; val_chrom_access_recon_loss: 4417263.4375; val_global_loss: 19560845.0000; val_optim_loss: 19560845.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9106; val_auprc_score: 0.8761; val_best_acc_score: 0.8555; val_best_f1_score: 0.8664; train_kl_reg_loss: 89210.7472; train_edge_recon_loss: 2780063.9773; train_gene_expr_recon_loss: 12075444.5455; train_masked_gp_l1_reg_loss: 65957.1683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78997.8190; train_chrom_access_recon_loss: 4490887.0000; train_global_loss: 19580561.3333; train_optim_loss: 19580561.3333; val_kl_reg_loss: 89270.6895; val_edge_recon_loss: 2800755.9375; val_gene_expr_recon_loss: 11994115.5000; val_masked_gp_l1_reg_loss: 66533.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77900.5000; val_chrom_access_recon_loss: 4398645.6250; val_global_loss: 19427222.5000; val_optim_loss: 19427222.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9123; val_auprc_score: 0.8791; val_best_acc_score: 0.8616; val_best_f1_score: 0.8691; train_kl_reg_loss: 86768.5936; train_edge_recon_loss: 2778641.5568; train_gene_expr_recon_loss: 12037723.9242; train_masked_gp_l1_reg_loss: 67131.6295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76804.6740; train_chrom_access_recon_loss: 4477692.8371; train_global_loss: 19524763.2121; train_optim_loss: 19524763.2121; val_kl_reg_loss: 91851.5195; val_edge_recon_loss: 2816876.3750; val_gene_expr_recon_loss: 11956106.8750; val_masked_gp_l1_reg_loss: 67710.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76089.7969; val_chrom_access_recon_loss: 4403594.3125; val_global_loss: 19412230.0000; val_optim_loss: 19412230.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9203; val_auprc_score: 0.8931; val_best_acc_score: 0.8662; val_best_f1_score: 0.8743; train_kl_reg_loss: 86378.2893; train_edge_recon_loss: 2776823.9659; train_gene_expr_recon_loss: 11995832.3636; train_masked_gp_l1_reg_loss: 68095.6508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75397.6706; train_chrom_access_recon_loss: 4459688.0833; train_global_loss: 19462215.8485; train_optim_loss: 19462215.8485; val_kl_reg_loss: 84416.2822; val_edge_recon_loss: 2758931.4688; val_gene_expr_recon_loss: 12094178.3750; val_masked_gp_l1_reg_loss: 68595.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74969.8984; val_chrom_access_recon_loss: 4482251.1875; val_global_loss: 19563343.2500; val_optim_loss: 19563343.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9213; val_auprc_score: 0.8935; val_best_acc_score: 0.8635; val_best_f1_score: 0.8738; train_kl_reg_loss: 85348.5589; train_edge_recon_loss: 2748857.9773; train_gene_expr_recon_loss: 11961759.1667; train_masked_gp_l1_reg_loss: 69062.4319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74297.4696; train_chrom_access_recon_loss: 4447729.6439; train_global_loss: 19387055.1818; train_optim_loss: 19387055.1818; val_kl_reg_loss: 82437.7559; val_edge_recon_loss: 2765969.5312; val_gene_expr_recon_loss: 11947145.3750; val_masked_gp_l1_reg_loss: 69565.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73877.0312; val_chrom_access_recon_loss: 4394441.8750; val_global_loss: 19333437.0000; val_optim_loss: 19333437.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9220; val_auprc_score: 0.8966; val_best_acc_score: 0.8649; val_best_f1_score: 0.8736; train_kl_reg_loss: 84581.6873; train_edge_recon_loss: 2749715.7311; train_gene_expr_recon_loss: 11927550.2121; train_masked_gp_l1_reg_loss: 69979.3738; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73068.9731; train_chrom_access_recon_loss: 4428642.9242; train_global_loss: 19333538.7879; train_optim_loss: 19333538.7879; val_kl_reg_loss: 83708.9678; val_edge_recon_loss: 2762340.7188; val_gene_expr_recon_loss: 11908926.6250; val_masked_gp_l1_reg_loss: 70369.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73067.8125; val_chrom_access_recon_loss: 4370941.0000; val_global_loss: 19269354.2500; val_optim_loss: 19269354.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9233; val_auprc_score: 0.8928; val_best_acc_score: 0.8686; val_best_f1_score: 0.8769; train_kl_reg_loss: 85730.6481; train_edge_recon_loss: 2736765.1061; train_gene_expr_recon_loss: 11906875.8182; train_masked_gp_l1_reg_loss: 70748.3430; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72464.3801; train_chrom_access_recon_loss: 4424164.5758; train_global_loss: 19296748.9091; train_optim_loss: 19296748.9091; val_kl_reg_loss: 83858.8213; val_edge_recon_loss: 2781430.9688; val_gene_expr_recon_loss: 11880806.7500; val_masked_gp_l1_reg_loss: 71127.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72092.7578; val_chrom_access_recon_loss: 4371056.3125; val_global_loss: 19260374.0000; val_optim_loss: 19260374.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9303; val_auprc_score: 0.9023; val_best_acc_score: 0.8756; val_best_f1_score: 0.8798; train_kl_reg_loss: 82737.7170; train_edge_recon_loss: 2725818.6818; train_gene_expr_recon_loss: 11866522.5455; train_masked_gp_l1_reg_loss: 71418.0694; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71985.9860; train_chrom_access_recon_loss: 4409596.1174; train_global_loss: 19228079.2424; train_optim_loss: 19228079.2424; val_kl_reg_loss: 82488.8955; val_edge_recon_loss: 2766705.2500; val_gene_expr_recon_loss: 11857324.6250; val_masked_gp_l1_reg_loss: 71879.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72092.0078; val_chrom_access_recon_loss: 4372276.0312; val_global_loss: 19222766.5000; val_optim_loss: 19222766.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9177; val_auprc_score: 0.8877; val_best_acc_score: 0.8600; val_best_f1_score: 0.8691; train_kl_reg_loss: 80844.6378; train_edge_recon_loss: 2745474.7879; train_gene_expr_recon_loss: 11836768.8333; train_masked_gp_l1_reg_loss: 72168.2990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71977.8114; train_chrom_access_recon_loss: 4393940.5227; train_global_loss: 19201175.0909; train_optim_loss: 19201175.0909; val_kl_reg_loss: 79710.6982; val_edge_recon_loss: 2824483.4062; val_gene_expr_recon_loss: 11706359.6250; val_masked_gp_l1_reg_loss: 72521.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72197.4141; val_chrom_access_recon_loss: 4311015.8125; val_global_loss: 19066288.2500; val_optim_loss: 19066288.2500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9349; val_auprc_score: 0.9151; val_best_acc_score: 0.8740; val_best_f1_score: 0.8809; train_kl_reg_loss: 82306.2469; train_edge_recon_loss: 2724735.7121; train_gene_expr_recon_loss: 11828569.8485; train_masked_gp_l1_reg_loss: 72782.8887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71810.0189; train_chrom_access_recon_loss: 4390406.0227; train_global_loss: 19170610.5455; train_optim_loss: 19170610.5455; val_kl_reg_loss: 80264.0225; val_edge_recon_loss: 2767463.6250; val_gene_expr_recon_loss: 11737212.5000; val_masked_gp_l1_reg_loss: 73118.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71854.4375; val_chrom_access_recon_loss: 4318579.1875; val_global_loss: 19048492.2500; val_optim_loss: 19048492.2500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9293; val_auprc_score: 0.9028; val_best_acc_score: 0.8678; val_best_f1_score: 0.8769; train_kl_reg_loss: 80267.9189; train_edge_recon_loss: 2731800.2538; train_gene_expr_recon_loss: 11778969.1364; train_masked_gp_l1_reg_loss: 73417.7746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71579.0674; train_chrom_access_recon_loss: 4373136.6061; train_global_loss: 19109170.7273; train_optim_loss: 19109170.7273; val_kl_reg_loss: 79230.0859; val_edge_recon_loss: 2775959.7500; val_gene_expr_recon_loss: 11802033.6250; val_masked_gp_l1_reg_loss: 73667.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71316.1250; val_chrom_access_recon_loss: 4351382.6875; val_global_loss: 19153589.0000; val_optim_loss: 19153589.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9326; val_auprc_score: 0.9103; val_best_acc_score: 0.8778; val_best_f1_score: 0.8848; train_kl_reg_loss: 80322.2872; train_edge_recon_loss: 2720070.7235; train_gene_expr_recon_loss: 11766022.1212; train_masked_gp_l1_reg_loss: 73958.1019; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71294.9188; train_chrom_access_recon_loss: 4361058.8561; train_global_loss: 19072727.0303; train_optim_loss: 19072727.0303; val_kl_reg_loss: 82376.5605; val_edge_recon_loss: 2757759.8125; val_gene_expr_recon_loss: 11680779.3750; val_masked_gp_l1_reg_loss: 74206.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70971.3906; val_chrom_access_recon_loss: 4296382.3125; val_global_loss: 18962475.0000; val_optim_loss: 18962475.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9326; val_auprc_score: 0.9055; val_best_acc_score: 0.8796; val_best_f1_score: 0.8838; train_kl_reg_loss: 79712.8427; train_edge_recon_loss: 2725469.1477; train_gene_expr_recon_loss: 11742736.4242; train_masked_gp_l1_reg_loss: 74364.7867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70858.2119; train_chrom_access_recon_loss: 4349658.4545; train_global_loss: 19042799.8182; train_optim_loss: 19042799.8182; val_kl_reg_loss: 75794.7188; val_edge_recon_loss: 2765110.6875; val_gene_expr_recon_loss: 11736045.1250; val_masked_gp_l1_reg_loss: 74609.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70997.0469; val_chrom_access_recon_loss: 4316721.6562; val_global_loss: 19039277.7500; val_optim_loss: 19039277.7500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9340; val_auprc_score: 0.9088; val_best_acc_score: 0.8748; val_best_f1_score: 0.8810; train_kl_reg_loss: 78244.6518; train_edge_recon_loss: 2716544.8485; train_gene_expr_recon_loss: 11728060.1515; train_masked_gp_l1_reg_loss: 74936.9986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70766.2397; train_chrom_access_recon_loss: 4340276.7462; train_global_loss: 19008829.6364; train_optim_loss: 19008829.6364; val_kl_reg_loss: 76490.9775; val_edge_recon_loss: 2774944.0312; val_gene_expr_recon_loss: 11733244.3750; val_masked_gp_l1_reg_loss: 75312.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70876.8516; val_chrom_access_recon_loss: 4297441.5938; val_global_loss: 19028310.0000; val_optim_loss: 19028310.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9370; val_auprc_score: 0.9116; val_best_acc_score: 0.8837; val_best_f1_score: 0.8889; train_kl_reg_loss: 95104.4749; train_edge_recon_loss: 2796833.2652; train_gene_expr_recon_loss: 10851169.8333; train_masked_gp_l1_reg_loss: 75275.6161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68955.4689; train_chrom_access_recon_loss: 4099315.7803; train_global_loss: 17986654.4545; train_optim_loss: 17986654.4545; val_kl_reg_loss: 35545.6001; val_edge_recon_loss: 2762002.2500; val_gene_expr_recon_loss: 10906757.0000; val_masked_gp_l1_reg_loss: 74932.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69293.6719; val_chrom_access_recon_loss: 4132118.5312; val_global_loss: 17980650.2500; val_optim_loss: 17980650.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9466; val_auprc_score: 0.9246; val_best_acc_score: 0.8939; val_best_f1_score: 0.8975; train_kl_reg_loss: 83288.5043; train_edge_recon_loss: 2738388.0947; train_gene_expr_recon_loss: 10806672.5000; train_masked_gp_l1_reg_loss: 74573.7701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69266.3530; train_chrom_access_recon_loss: 4049703.7576; train_global_loss: 17821892.9697; train_optim_loss: 17821892.9697; val_kl_reg_loss: 43917.5845; val_edge_recon_loss: 2709291.4688; val_gene_expr_recon_loss: 10812674.7500; val_masked_gp_l1_reg_loss: 74184.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69396.4297; val_chrom_access_recon_loss: 4005665.2500; val_global_loss: 17715129.2500; val_optim_loss: 17715129.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9372; val_auprc_score: 0.9154; val_best_acc_score: 0.8821; val_best_f1_score: 0.8884; train_kl_reg_loss: 72804.7841; train_edge_recon_loss: 2719220.0606; train_gene_expr_recon_loss: 10789413.4697; train_masked_gp_l1_reg_loss: 73755.1338; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69293.7913; train_chrom_access_recon_loss: 4049640.6477; train_global_loss: 17774128.0000; train_optim_loss: 17774128.0000; val_kl_reg_loss: 47209.3140; val_edge_recon_loss: 2758097.1875; val_gene_expr_recon_loss: 10822252.5000; val_masked_gp_l1_reg_loss: 73314.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68942.4844; val_chrom_access_recon_loss: 4034403.9375; val_global_loss: 17804218.7500; val_optim_loss: 17804218.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9402; val_auprc_score: 0.9148; val_best_acc_score: 0.8907; val_best_f1_score: 0.8953; train_kl_reg_loss: 68096.8766; train_edge_recon_loss: 2707781.2083; train_gene_expr_recon_loss: 10760495.1818; train_masked_gp_l1_reg_loss: 72935.0561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68722.2096; train_chrom_access_recon_loss: 4044449.0341; train_global_loss: 17722479.5455; train_optim_loss: 17722479.5455; val_kl_reg_loss: 48792.2031; val_edge_recon_loss: 2731095.7812; val_gene_expr_recon_loss: 10737227.0000; val_masked_gp_l1_reg_loss: 72495.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68746.4141; val_chrom_access_recon_loss: 4002416.1250; val_global_loss: 17660771.7500; val_optim_loss: 17660771.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9399; val_auprc_score: 0.9193; val_best_acc_score: 0.8837; val_best_f1_score: 0.8888; train_kl_reg_loss: 63857.0708; train_edge_recon_loss: 2692323.6780; train_gene_expr_recon_loss: 10731481.9545; train_masked_gp_l1_reg_loss: 72202.6587; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68400.4962; train_chrom_access_recon_loss: 4031346.7197; train_global_loss: 17659612.4545; train_optim_loss: 17659612.4545; val_kl_reg_loss: 51556.3232; val_edge_recon_loss: 2745699.7500; val_gene_expr_recon_loss: 10652234.7500; val_masked_gp_l1_reg_loss: 71857.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68314.8125; val_chrom_access_recon_loss: 3986375.1250; val_global_loss: 17576038.0000; val_optim_loss: 17576038.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9442; val_auprc_score: 0.9243; val_best_acc_score: 0.8901; val_best_f1_score: 0.8940; train_kl_reg_loss: 63036.4086; train_edge_recon_loss: 2694102.1023; train_gene_expr_recon_loss: 10703922.6970; train_masked_gp_l1_reg_loss: 71517.6710; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67951.4541; train_chrom_access_recon_loss: 4025093.1780; train_global_loss: 17625623.4242; train_optim_loss: 17625623.4242; val_kl_reg_loss: 52679.4575; val_edge_recon_loss: 2746865.8750; val_gene_expr_recon_loss: 10803713.6250; val_masked_gp_l1_reg_loss: 71219.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67716.6406; val_chrom_access_recon_loss: 3977668.2812; val_global_loss: 17719864.0000; val_optim_loss: 17719864.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9484; val_auprc_score: 0.9288; val_best_acc_score: 0.8987; val_best_f1_score: 0.9028; train_kl_reg_loss: 61107.6376; train_edge_recon_loss: 2701128.5758; train_gene_expr_recon_loss: 10695442.9394; train_masked_gp_l1_reg_loss: 70904.6802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67466.1460; train_chrom_access_recon_loss: 4023155.7121; train_global_loss: 17619205.8030; train_optim_loss: 17619205.8030; val_kl_reg_loss: 53532.4370; val_edge_recon_loss: 2707940.0938; val_gene_expr_recon_loss: 10732611.1250; val_masked_gp_l1_reg_loss: 70556.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67497.2656; val_chrom_access_recon_loss: 3999790.8125; val_global_loss: 17631927.5000; val_optim_loss: 17631927.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9473; val_auprc_score: 0.9237; val_best_acc_score: 0.8939; val_best_f1_score: 0.8990; train_kl_reg_loss: 60430.1964; train_edge_recon_loss: 2687164.6591; train_gene_expr_recon_loss: 10683586.6667; train_masked_gp_l1_reg_loss: 70335.3169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67172.3099; train_chrom_access_recon_loss: 4013998.1477; train_global_loss: 17582687.2727; train_optim_loss: 17582687.2727; val_kl_reg_loss: 54383.2134; val_edge_recon_loss: 2722351.9062; val_gene_expr_recon_loss: 10781509.0000; val_masked_gp_l1_reg_loss: 70105.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67082.2734; val_chrom_access_recon_loss: 4032536.2500; val_global_loss: 17727967.5000; val_optim_loss: 17727967.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9507; val_auprc_score: 0.9252; val_best_acc_score: 0.9046; val_best_f1_score: 0.9071; train_kl_reg_loss: 60171.6299; train_edge_recon_loss: 2698550.3182; train_gene_expr_recon_loss: 10656329.9242; train_masked_gp_l1_reg_loss: 69863.9076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66977.6212; train_chrom_access_recon_loss: 4004998.9811; train_global_loss: 17556892.3939; train_optim_loss: 17556892.3939; val_kl_reg_loss: 53175.8467; val_edge_recon_loss: 2722683.5312; val_gene_expr_recon_loss: 10614049.8750; val_masked_gp_l1_reg_loss: 69587.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66416.3125; val_chrom_access_recon_loss: 3945369.2812; val_global_loss: 17471282.5000; val_optim_loss: 17471282.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9487; val_auprc_score: 0.9294; val_best_acc_score: 0.8933; val_best_f1_score: 0.8970; train_kl_reg_loss: 60040.1331; train_edge_recon_loss: 2684423.9280; train_gene_expr_recon_loss: 10656633.0152; train_masked_gp_l1_reg_loss: 69287.2802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66452.0560; train_chrom_access_recon_loss: 4008662.4053; train_global_loss: 17545498.8182; train_optim_loss: 17545498.8182; val_kl_reg_loss: 53922.7148; val_edge_recon_loss: 2735027.9062; val_gene_expr_recon_loss: 10735934.6250; val_masked_gp_l1_reg_loss: 69010.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66439.5469; val_chrom_access_recon_loss: 3992383.2812; val_global_loss: 17652718.2500; val_optim_loss: 17652718.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9530; val_auprc_score: 0.9286; val_best_acc_score: 0.9011; val_best_f1_score: 0.9052; train_kl_reg_loss: 60115.2061; train_edge_recon_loss: 2693032.4091; train_gene_expr_recon_loss: 10632196.1364; train_masked_gp_l1_reg_loss: 68813.1089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66395.6842; train_chrom_access_recon_loss: 3996644.2273; train_global_loss: 17517196.7576; train_optim_loss: 17517196.7576; val_kl_reg_loss: 55183.3354; val_edge_recon_loss: 2723209.5000; val_gene_expr_recon_loss: 10650957.2500; val_masked_gp_l1_reg_loss: 68619.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65970.9219; val_chrom_access_recon_loss: 3940337.9688; val_global_loss: 17504279.2500; val_optim_loss: 17504279.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9452; val_auprc_score: 0.9226; val_best_acc_score: 0.8936; val_best_f1_score: 0.8978; train_kl_reg_loss: 59897.3497; train_edge_recon_loss: 2675239.6250; train_gene_expr_recon_loss: 10632371.4697; train_masked_gp_l1_reg_loss: 68388.7878; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66146.1469; train_chrom_access_recon_loss: 3997606.0758; train_global_loss: 17499649.4848; train_optim_loss: 17499649.4848; val_kl_reg_loss: 52349.8276; val_edge_recon_loss: 2724666.6562; val_gene_expr_recon_loss: 10628247.7500; val_masked_gp_l1_reg_loss: 68273.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66244.8047; val_chrom_access_recon_loss: 3947662.0312; val_global_loss: 17487444.2500; val_optim_loss: 17487444.2500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9570; val_auprc_score: 0.9406; val_best_acc_score: 0.9044; val_best_f1_score: 0.9083; train_kl_reg_loss: 58706.6080; train_edge_recon_loss: 2685188.7121; train_gene_expr_recon_loss: 10603264.6061; train_masked_gp_l1_reg_loss: 68150.1188; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66149.8118; train_chrom_access_recon_loss: 3984838.9697; train_global_loss: 17466298.7576; train_optim_loss: 17466298.7576; val_kl_reg_loss: 53889.6880; val_edge_recon_loss: 2722859.2188; val_gene_expr_recon_loss: 10659224.3750; val_masked_gp_l1_reg_loss: 68027.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66231.0469; val_chrom_access_recon_loss: 3952311.4062; val_global_loss: 17522542.5000; val_optim_loss: 17522542.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9547; val_auprc_score: 0.9311; val_best_acc_score: 0.9046; val_best_f1_score: 0.9091; train_kl_reg_loss: 58700.6570; train_edge_recon_loss: 2680081.4053; train_gene_expr_recon_loss: 10603002.2121; train_masked_gp_l1_reg_loss: 67717.5930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56834.4051; train_chrom_access_recon_loss: 3982306.2235; train_global_loss: 17448642.4242; train_optim_loss: 17448642.4242; val_kl_reg_loss: 55440.5552; val_edge_recon_loss: 2695288.1250; val_gene_expr_recon_loss: 10534185.1250; val_masked_gp_l1_reg_loss: 67581.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54608.0273; val_chrom_access_recon_loss: 3918733.2812; val_global_loss: 17325836.7500; val_optim_loss: 17325836.7500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9524; val_auprc_score: 0.9380; val_best_acc_score: 0.8992; val_best_f1_score: 0.9050; train_kl_reg_loss: 59960.7111; train_edge_recon_loss: 2685656.6591; train_gene_expr_recon_loss: 10582301.7576; train_masked_gp_l1_reg_loss: 67543.8105; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54233.3890; train_chrom_access_recon_loss: 3974302.1250; train_global_loss: 17423998.2727; train_optim_loss: 17423998.2727; val_kl_reg_loss: 55742.1948; val_edge_recon_loss: 2710975.4688; val_gene_expr_recon_loss: 10558346.0000; val_masked_gp_l1_reg_loss: 67509.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53901.3242; val_chrom_access_recon_loss: 3910715.2188; val_global_loss: 17357189.8750; val_optim_loss: 17357189.8750
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9512; val_auprc_score: 0.9306; val_best_acc_score: 0.8963; val_best_f1_score: 0.9011; train_kl_reg_loss: 60822.6539; train_edge_recon_loss: 2674941.0795; train_gene_expr_recon_loss: 10586740.5000; train_masked_gp_l1_reg_loss: 67487.8716; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53666.9489; train_chrom_access_recon_loss: 3975773.2159; train_global_loss: 17419432.2424; train_optim_loss: 17419432.2424; val_kl_reg_loss: 56536.0356; val_edge_recon_loss: 2720913.6250; val_gene_expr_recon_loss: 10561295.6250; val_masked_gp_l1_reg_loss: 67466.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53525.8164; val_chrom_access_recon_loss: 3919450.7500; val_global_loss: 17379188.5000; val_optim_loss: 17379188.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9546; val_auprc_score: 0.9362; val_best_acc_score: 0.9062; val_best_f1_score: 0.9097; train_kl_reg_loss: 61078.8100; train_edge_recon_loss: 2683854.8220; train_gene_expr_recon_loss: 10583679.0000; train_masked_gp_l1_reg_loss: 67439.4714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53406.6297; train_chrom_access_recon_loss: 3976064.3864; train_global_loss: 17425523.2727; train_optim_loss: 17425523.2727; val_kl_reg_loss: 56150.2104; val_edge_recon_loss: 2709984.4375; val_gene_expr_recon_loss: 10504086.1250; val_masked_gp_l1_reg_loss: 67420.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53261.5117; val_chrom_access_recon_loss: 3923864.8438; val_global_loss: 17314767.6250; val_optim_loss: 17314767.6250
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9574; val_auprc_score: 0.9391; val_best_acc_score: 0.9097; val_best_f1_score: 0.9140; train_kl_reg_loss: 60829.1475; train_edge_recon_loss: 2680807.9091; train_gene_expr_recon_loss: 10585434.4242; train_masked_gp_l1_reg_loss: 67400.9882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53167.1964; train_chrom_access_recon_loss: 3978729.4924; train_global_loss: 17426369.2273; train_optim_loss: 17426369.2273; val_kl_reg_loss: 56259.0698; val_edge_recon_loss: 2680748.6875; val_gene_expr_recon_loss: 10605441.1250; val_masked_gp_l1_reg_loss: 67381.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53088.9766; val_chrom_access_recon_loss: 3941659.2500; val_global_loss: 17404578.5000; val_optim_loss: 17404578.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9566; val_auprc_score: 0.9381; val_best_acc_score: 0.9087; val_best_f1_score: 0.9112; train_kl_reg_loss: 60881.3115; train_edge_recon_loss: 2678336.9583; train_gene_expr_recon_loss: 10583658.7879; train_masked_gp_l1_reg_loss: 67365.0295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53017.5033; train_chrom_access_recon_loss: 3974303.0720; train_global_loss: 17417562.8333; train_optim_loss: 17417562.8333; val_kl_reg_loss: 56710.3188; val_edge_recon_loss: 2685403.7500; val_gene_expr_recon_loss: 10658709.1250; val_masked_gp_l1_reg_loss: 67354.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52860.2344; val_chrom_access_recon_loss: 3945628.4688; val_global_loss: 17466666.6250; val_optim_loss: 17466666.6250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9545; val_auprc_score: 0.9339; val_best_acc_score: 0.9027; val_best_f1_score: 0.9065; train_kl_reg_loss: 60897.8672; train_edge_recon_loss: 2673036.8295; train_gene_expr_recon_loss: 10584877.2879; train_masked_gp_l1_reg_loss: 67335.1001; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52796.6812; train_chrom_access_recon_loss: 3975717.9621; train_global_loss: 17414661.6970; train_optim_loss: 17414661.6970; val_kl_reg_loss: 56321.4434; val_edge_recon_loss: 2716364.7188; val_gene_expr_recon_loss: 10586177.6250; val_masked_gp_l1_reg_loss: 67323.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52748.7070; val_chrom_access_recon_loss: 3921701.7500; val_global_loss: 17400638.7500; val_optim_loss: 17400638.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9595; val_auprc_score: 0.9473; val_best_acc_score: 0.9095; val_best_f1_score: 0.9115; train_kl_reg_loss: 60810.5307; train_edge_recon_loss: 2677774.0758; train_gene_expr_recon_loss: 10582138.9848; train_masked_gp_l1_reg_loss: 67310.7636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52708.9856; train_chrom_access_recon_loss: 3974993.0038; train_global_loss: 17415736.1818; train_optim_loss: 17415736.1818; val_kl_reg_loss: 56986.5913; val_edge_recon_loss: 2707627.3438; val_gene_expr_recon_loss: 10714363.2500; val_masked_gp_l1_reg_loss: 67296.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52579.5977; val_chrom_access_recon_loss: 3983714.0000; val_global_loss: 17582567.2500; val_optim_loss: 17582567.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9496; val_auprc_score: 0.9286; val_best_acc_score: 0.9025; val_best_f1_score: 0.9069; train_kl_reg_loss: 61065.4739; train_edge_recon_loss: 2679755.6780; train_gene_expr_recon_loss: 10579919.2121; train_masked_gp_l1_reg_loss: 67263.5369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51606.2299; train_chrom_access_recon_loss: 4009551.0720; train_global_loss: 17449161.1818; train_optim_loss: 17449161.1818; val_kl_reg_loss: 55939.0786; val_edge_recon_loss: 2718642.7500; val_gene_expr_recon_loss: 10597953.1250; val_masked_gp_l1_reg_loss: 67246.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51390.0039; val_chrom_access_recon_loss: 4073168.5625; val_global_loss: 17564340.5000; val_optim_loss: 17564340.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9537; val_auprc_score: 0.9290; val_best_acc_score: 0.9044; val_best_f1_score: 0.9081; train_kl_reg_loss: 59446.7101; train_edge_recon_loss: 2693055.4356; train_gene_expr_recon_loss: 10618703.6970; train_masked_gp_l1_reg_loss: 67237.6928; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51352.9714; train_chrom_access_recon_loss: 4101499.9356; train_global_loss: 17591296.5000; train_optim_loss: 17591296.5000; val_kl_reg_loss: 53821.0659; val_edge_recon_loss: 2709586.3438; val_gene_expr_recon_loss: 10671515.8750; val_masked_gp_l1_reg_loss: 67231.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51321.8086; val_chrom_access_recon_loss: 4023417.8438; val_global_loss: 17576894.0000; val_optim_loss: 17576894.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9523; val_auprc_score: 0.9346; val_best_acc_score: 0.9017; val_best_f1_score: 0.9066; train_kl_reg_loss: 56932.4108; train_edge_recon_loss: 2684604.9659; train_gene_expr_recon_loss: 10602610.9242; train_masked_gp_l1_reg_loss: 67227.4635; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51311.1475; train_chrom_access_recon_loss: 4057333.9356; train_global_loss: 17520020.8788; train_optim_loss: 17520020.8788; val_kl_reg_loss: 51742.4844; val_edge_recon_loss: 2711614.5625; val_gene_expr_recon_loss: 10596891.7500; val_masked_gp_l1_reg_loss: 67223.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51303.0430; val_chrom_access_recon_loss: 3968477.6875; val_global_loss: 17447253.5000; val_optim_loss: 17447253.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9490; val_auprc_score: 0.9219; val_best_acc_score: 0.8987; val_best_f1_score: 0.9031; train_kl_reg_loss: 55395.6789; train_edge_recon_loss: 2688825.2348; train_gene_expr_recon_loss: 10601954.4848; train_masked_gp_l1_reg_loss: 67221.7399; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51301.6170; train_chrom_access_recon_loss: 4040829.5303; train_global_loss: 17505528.2727; train_optim_loss: 17505528.2727; val_kl_reg_loss: 51481.6851; val_edge_recon_loss: 2712350.0000; val_gene_expr_recon_loss: 10727569.2500; val_masked_gp_l1_reg_loss: 67220.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51301.5547; val_chrom_access_recon_loss: 4015645.1250; val_global_loss: 17625568.7500; val_optim_loss: 17625568.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 43 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.9581
val AUPRC score: 0.9410
val best accuracy score: 0.9097
val best F1 score: 0.9128
val target rna MSE score: 1.9731
val source rna MSE score: 0.9463
val target atac MSE score: 0.5248
val source atac MSE score: 0.3244
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
