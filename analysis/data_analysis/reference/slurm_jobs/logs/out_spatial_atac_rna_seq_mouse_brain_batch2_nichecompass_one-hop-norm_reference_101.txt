[True]
Run timestamp: 10102023_012941_101.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_101']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7594; val_auprc_score: 0.7794; val_best_acc_score: 0.5279; val_best_f1_score: 0.6778; train_kl_reg_loss: 60287.5006; train_edge_recon_loss: 3517081.6279; train_gene_expr_recon_loss: 13471137.9084; train_masked_gp_l1_reg_loss: 37297.4875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2303423.2490; train_chrom_access_recon_loss: 11231123.6336; train_global_loss: 30620351.3282; train_optim_loss: 30620351.3282; val_kl_reg_loss: 59648.7055; val_edge_recon_loss: 4063175.5333; val_gene_expr_recon_loss: 12900856.8000; val_masked_gp_l1_reg_loss: 47014.0039; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 532994.0625; val_chrom_access_recon_loss: 10889890.9333; val_global_loss: 28493580.0000; val_optim_loss: 28493580.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7939; val_auprc_score: 0.8131; val_best_acc_score: 0.6425; val_best_f1_score: 0.7211; train_kl_reg_loss: 69902.3489; train_edge_recon_loss: 3498202.7004; train_gene_expr_recon_loss: 12681129.0534; train_masked_gp_l1_reg_loss: 48575.8413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 300540.7687; train_chrom_access_recon_loss: 10829273.0992; train_global_loss: 27427623.6794; train_optim_loss: 27427623.6794; val_kl_reg_loss: 61242.7836; val_edge_recon_loss: 4056076.9667; val_gene_expr_recon_loss: 12651297.4667; val_masked_gp_l1_reg_loss: 49956.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 192934.8281; val_chrom_access_recon_loss: 10757514.2667; val_global_loss: 27769022.2667; val_optim_loss: 27769022.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8596; val_auprc_score: 0.8550; val_best_acc_score: 0.7627; val_best_f1_score: 0.7891; train_kl_reg_loss: 62329.2954; train_edge_recon_loss: 3386454.3435; train_gene_expr_recon_loss: 12471886.2061; train_masked_gp_l1_reg_loss: 51683.7718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 150350.8780; train_chrom_access_recon_loss: 10683468.1298; train_global_loss: 26806172.6260; train_optim_loss: 26806172.6260; val_kl_reg_loss: 80851.8292; val_edge_recon_loss: 2983838.0500; val_gene_expr_recon_loss: 12525218.2667; val_masked_gp_l1_reg_loss: 55298.5195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 125043.6094; val_chrom_access_recon_loss: 10695242.4000; val_global_loss: 26465493.4667; val_optim_loss: 26465493.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8788; val_auprc_score: 0.8721; val_best_acc_score: 0.7813; val_best_f1_score: 0.7925; train_kl_reg_loss: 90340.6372; train_edge_recon_loss: 2948224.6469; train_gene_expr_recon_loss: 12310472.0534; train_masked_gp_l1_reg_loss: 57564.1922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113249.7513; train_chrom_access_recon_loss: 10564715.0458; train_global_loss: 26084566.3664; train_optim_loss: 26084566.3664; val_kl_reg_loss: 85874.4047; val_edge_recon_loss: 2949043.8833; val_gene_expr_recon_loss: 12340906.0667; val_masked_gp_l1_reg_loss: 59244.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104209.8984; val_chrom_access_recon_loss: 10557828.3333; val_global_loss: 26097106.6667; val_optim_loss: 26097106.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9025; val_auprc_score: 0.8914; val_best_acc_score: 0.8157; val_best_f1_score: 0.8270; train_kl_reg_loss: 82789.6334; train_edge_recon_loss: 2919696.1698; train_gene_expr_recon_loss: 12184963.9924; train_masked_gp_l1_reg_loss: 60760.6943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98643.2846; train_chrom_access_recon_loss: 10471206.1450; train_global_loss: 25818060.0305; train_optim_loss: 25818060.0305; val_kl_reg_loss: 78959.8365; val_edge_recon_loss: 2890880.0333; val_gene_expr_recon_loss: 12215191.3333; val_masked_gp_l1_reg_loss: 62268.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93809.3359; val_chrom_access_recon_loss: 10395372.0667; val_global_loss: 25736480.6667; val_optim_loss: 25736480.6667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9122; val_auprc_score: 0.8973; val_best_acc_score: 0.8378; val_best_f1_score: 0.8489; train_kl_reg_loss: 80457.8254; train_edge_recon_loss: 2853185.2290; train_gene_expr_recon_loss: 12075663.9389; train_masked_gp_l1_reg_loss: 63379.4039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91322.3698; train_chrom_access_recon_loss: 10384852.4275; train_global_loss: 25548861.2672; train_optim_loss: 25548861.2672; val_kl_reg_loss: 87919.7818; val_edge_recon_loss: 2829782.5167; val_gene_expr_recon_loss: 12118053.7333; val_masked_gp_l1_reg_loss: 64551.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89346.0469; val_chrom_access_recon_loss: 10372484.5333; val_global_loss: 25562138.2667; val_optim_loss: 25562138.2667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9206; val_auprc_score: 0.9049; val_best_acc_score: 0.8459; val_best_f1_score: 0.8572; train_kl_reg_loss: 85111.8201; train_edge_recon_loss: 2803861.3034; train_gene_expr_recon_loss: 11987525.2443; train_masked_gp_l1_reg_loss: 65595.0947; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87395.9391; train_chrom_access_recon_loss: 10309234.5725; train_global_loss: 25338723.8779; train_optim_loss: 25338723.8779; val_kl_reg_loss: 85128.4958; val_edge_recon_loss: 2809191.6500; val_gene_expr_recon_loss: 12049091.0000; val_masked_gp_l1_reg_loss: 66622.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86378.5312; val_chrom_access_recon_loss: 10318543.0000; val_global_loss: 25414956.0000; val_optim_loss: 25414956.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9336; val_auprc_score: 0.9208; val_best_acc_score: 0.8663; val_best_f1_score: 0.8740; train_kl_reg_loss: 83013.9143; train_edge_recon_loss: 2790850.6947; train_gene_expr_recon_loss: 11918425.3511; train_masked_gp_l1_reg_loss: 67430.2287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84691.1922; train_chrom_access_recon_loss: 10255399.5115; train_global_loss: 25199810.8092; train_optim_loss: 25199810.8092; val_kl_reg_loss: 82954.2479; val_edge_recon_loss: 2800866.7500; val_gene_expr_recon_loss: 11965401.2667; val_masked_gp_l1_reg_loss: 68264.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83479.5234; val_chrom_access_recon_loss: 10251860.7333; val_global_loss: 25252827.8667; val_optim_loss: 25252827.8667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9355; val_auprc_score: 0.9225; val_best_acc_score: 0.8635; val_best_f1_score: 0.8728; train_kl_reg_loss: 82938.8581; train_edge_recon_loss: 2768342.4466; train_gene_expr_recon_loss: 11849023.0458; train_masked_gp_l1_reg_loss: 68926.7681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81984.5231; train_chrom_access_recon_loss: 10204317.2366; train_global_loss: 25055532.9618; train_optim_loss: 25055532.9618; val_kl_reg_loss: 80228.7771; val_edge_recon_loss: 2795180.4667; val_gene_expr_recon_loss: 11910290.8000; val_masked_gp_l1_reg_loss: 69708.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81311.5703; val_chrom_access_recon_loss: 10224490.8667; val_global_loss: 25161211.0667; val_optim_loss: 25161211.0667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9378; val_auprc_score: 0.9223; val_best_acc_score: 0.8712; val_best_f1_score: 0.8788; train_kl_reg_loss: 79542.1294; train_edge_recon_loss: 2750552.7099; train_gene_expr_recon_loss: 11783927.0840; train_masked_gp_l1_reg_loss: 70305.7517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80275.6900; train_chrom_access_recon_loss: 10147954.4962; train_global_loss: 24912557.8626; train_optim_loss: 24912557.8626; val_kl_reg_loss: 78228.1458; val_edge_recon_loss: 2780344.8833; val_gene_expr_recon_loss: 11863420.8000; val_masked_gp_l1_reg_loss: 70883.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78995.7812; val_chrom_access_recon_loss: 10156313.1333; val_global_loss: 25028187.0667; val_optim_loss: 25028187.0667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9435; val_auprc_score: 0.9266; val_best_acc_score: 0.8843; val_best_f1_score: 0.8911; train_kl_reg_loss: 79322.6828; train_edge_recon_loss: 2747041.3836; train_gene_expr_recon_loss: 11726964.8168; train_masked_gp_l1_reg_loss: 71425.2073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78702.5440; train_chrom_access_recon_loss: 10082777.9542; train_global_loss: 24786234.5496; train_optim_loss: 24786234.5496; val_kl_reg_loss: 80186.9854; val_edge_recon_loss: 2758260.6833; val_gene_expr_recon_loss: 11746088.4000; val_masked_gp_l1_reg_loss: 71900.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78045.0312; val_chrom_access_recon_loss: 10095904.7333; val_global_loss: 24830386.8000; val_optim_loss: 24830386.8000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9406; val_auprc_score: 0.9236; val_best_acc_score: 0.8782; val_best_f1_score: 0.8838; train_kl_reg_loss: 77039.3399; train_edge_recon_loss: 2732589.0687; train_gene_expr_recon_loss: 11666552.7099; train_masked_gp_l1_reg_loss: 72239.4760; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77603.2227; train_chrom_access_recon_loss: 10036605.6718; train_global_loss: 24662629.5573; train_optim_loss: 24662629.5573; val_kl_reg_loss: 81208.1594; val_edge_recon_loss: 2742941.6167; val_gene_expr_recon_loss: 11743580.9333; val_masked_gp_l1_reg_loss: 72676.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77073.7422; val_chrom_access_recon_loss: 10045693.0000; val_global_loss: 24763174.8000; val_optim_loss: 24763174.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9436; val_auprc_score: 0.9275; val_best_acc_score: 0.8804; val_best_f1_score: 0.8878; train_kl_reg_loss: 77466.5386; train_edge_recon_loss: 2731182.6279; train_gene_expr_recon_loss: 11629128.8015; train_masked_gp_l1_reg_loss: 72846.0373; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76953.8846; train_chrom_access_recon_loss: 10003071.3740; train_global_loss: 24590649.2366; train_optim_loss: 24590649.2366; val_kl_reg_loss: 77082.2458; val_edge_recon_loss: 2769381.7500; val_gene_expr_recon_loss: 11728423.5333; val_masked_gp_l1_reg_loss: 72993.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76886.8281; val_chrom_access_recon_loss: 10024335.6000; val_global_loss: 24749104.1333; val_optim_loss: 24749104.1333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9468; val_auprc_score: 0.9309; val_best_acc_score: 0.8856; val_best_f1_score: 0.8918; train_kl_reg_loss: 75476.3222; train_edge_recon_loss: 2727853.2137; train_gene_expr_recon_loss: 11587080.7405; train_masked_gp_l1_reg_loss: 73308.4416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76652.3874; train_chrom_access_recon_loss: 9948783.8397; train_global_loss: 24489154.9618; train_optim_loss: 24489154.9618; val_kl_reg_loss: 75076.9755; val_edge_recon_loss: 2744119.8500; val_gene_expr_recon_loss: 11646085.1333; val_masked_gp_l1_reg_loss: 73568.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76341.7422; val_chrom_access_recon_loss: 9994288.7333; val_global_loss: 24609480.9333; val_optim_loss: 24609480.9333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9452; val_auprc_score: 0.9300; val_best_acc_score: 0.8806; val_best_f1_score: 0.8871; train_kl_reg_loss: 75193.3875; train_edge_recon_loss: 2714443.3092; train_gene_expr_recon_loss: 11562453.3664; train_masked_gp_l1_reg_loss: 73719.1132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76301.1932; train_chrom_access_recon_loss: 9933195.7176; train_global_loss: 24435306.1374; train_optim_loss: 24435306.1374; val_kl_reg_loss: 76527.3255; val_edge_recon_loss: 2734037.6833; val_gene_expr_recon_loss: 11632745.2667; val_masked_gp_l1_reg_loss: 73924.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75948.1953; val_chrom_access_recon_loss: 9952256.1333; val_global_loss: 24545438.4000; val_optim_loss: 24545438.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9499; val_auprc_score: 0.9359; val_best_acc_score: 0.8882; val_best_f1_score: 0.8940; train_kl_reg_loss: 73509.4292; train_edge_recon_loss: 2717998.2080; train_gene_expr_recon_loss: 11513859.0916; train_masked_gp_l1_reg_loss: 74142.6153; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75918.3903; train_chrom_access_recon_loss: 9889768.6031; train_global_loss: 24345196.3359; train_optim_loss: 24345196.3359; val_kl_reg_loss: 74031.7422; val_edge_recon_loss: 2737487.1000; val_gene_expr_recon_loss: 11566909.1333; val_masked_gp_l1_reg_loss: 74267.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75343.0625; val_chrom_access_recon_loss: 9903396.0667; val_global_loss: 24431435.0667; val_optim_loss: 24431435.0667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9499; val_auprc_score: 0.9352; val_best_acc_score: 0.8859; val_best_f1_score: 0.8910; train_kl_reg_loss: 72963.4040; train_edge_recon_loss: 2706853.0191; train_gene_expr_recon_loss: 11490966.0229; train_masked_gp_l1_reg_loss: 74443.3699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75284.1269; train_chrom_access_recon_loss: 9863519.7710; train_global_loss: 24284029.7710; train_optim_loss: 24284029.7710; val_kl_reg_loss: 72844.6281; val_edge_recon_loss: 2736862.6833; val_gene_expr_recon_loss: 11559358.8667; val_masked_gp_l1_reg_loss: 74648.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75003.0391; val_chrom_access_recon_loss: 9872655.5333; val_global_loss: 24391373.6000; val_optim_loss: 24391373.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9582; val_auprc_score: 0.9469; val_best_acc_score: 0.9016; val_best_f1_score: 0.9054; train_kl_reg_loss: 72097.8562; train_edge_recon_loss: 2700963.6450; train_gene_expr_recon_loss: 11466725.6870; train_masked_gp_l1_reg_loss: 74791.7134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74992.9249; train_chrom_access_recon_loss: 9835335.4962; train_global_loss: 24224907.4046; train_optim_loss: 24224907.4046; val_kl_reg_loss: 74665.6609; val_edge_recon_loss: 2701906.1667; val_gene_expr_recon_loss: 11568683.8000; val_masked_gp_l1_reg_loss: 74811.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74549.7891; val_chrom_access_recon_loss: 9885479.0667; val_global_loss: 24380096.8000; val_optim_loss: 24380096.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9573; val_auprc_score: 0.9456; val_best_acc_score: 0.8975; val_best_f1_score: 0.9029; train_kl_reg_loss: 71535.7552; train_edge_recon_loss: 2703686.0496; train_gene_expr_recon_loss: 11433442.0916; train_masked_gp_l1_reg_loss: 74995.0409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74385.3301; train_chrom_access_recon_loss: 9800667.9237; train_global_loss: 24158712.2595; train_optim_loss: 24158712.2595; val_kl_reg_loss: 72301.8813; val_edge_recon_loss: 2730561.5667; val_gene_expr_recon_loss: 11527854.7333; val_masked_gp_l1_reg_loss: 74987.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73970.5781; val_chrom_access_recon_loss: 9871930.2000; val_global_loss: 24351607.0667; val_optim_loss: 24351607.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9615; val_auprc_score: 0.9478; val_best_acc_score: 0.9051; val_best_f1_score: 0.9086; train_kl_reg_loss: 69398.1980; train_edge_recon_loss: 2703415.5725; train_gene_expr_recon_loss: 11409269.1450; train_masked_gp_l1_reg_loss: 75054.0298; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73965.0778; train_chrom_access_recon_loss: 9774453.3664; train_global_loss: 24105555.5267; train_optim_loss: 24105555.5267; val_kl_reg_loss: 70223.6375; val_edge_recon_loss: 2726561.2833; val_gene_expr_recon_loss: 11517219.5333; val_masked_gp_l1_reg_loss: 75223.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74209.0547; val_chrom_access_recon_loss: 9836736.6667; val_global_loss: 24300174.2667; val_optim_loss: 24300174.2667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9663; val_auprc_score: 0.9566; val_best_acc_score: 0.9116; val_best_f1_score: 0.9145; train_kl_reg_loss: 70395.6240; train_edge_recon_loss: 2697880.6851; train_gene_expr_recon_loss: 11391440.0076; train_masked_gp_l1_reg_loss: 75311.9216; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73600.8312; train_chrom_access_recon_loss: 9737885.3435; train_global_loss: 24046514.3511; train_optim_loss: 24046514.3511; val_kl_reg_loss: 72047.1458; val_edge_recon_loss: 2679996.3500; val_gene_expr_recon_loss: 11477374.8000; val_masked_gp_l1_reg_loss: 75276.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73444.4219; val_chrom_access_recon_loss: 9772687.2667; val_global_loss: 24150826.4000; val_optim_loss: 24150826.4000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9635; val_auprc_score: 0.9539; val_best_acc_score: 0.9068; val_best_f1_score: 0.9105; train_kl_reg_loss: 69258.3429; train_edge_recon_loss: 2695658.8779; train_gene_expr_recon_loss: 11378853.8626; train_masked_gp_l1_reg_loss: 75264.8930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73273.3273; train_chrom_access_recon_loss: 9732527.5649; train_global_loss: 24024836.7481; train_optim_loss: 24024836.7481; val_kl_reg_loss: 68237.1844; val_edge_recon_loss: 2729342.2833; val_gene_expr_recon_loss: 11447282.4000; val_masked_gp_l1_reg_loss: 75407.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73659.2891; val_chrom_access_recon_loss: 9742154.0667; val_global_loss: 24136082.8000; val_optim_loss: 24136082.8000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9648; val_auprc_score: 0.9553; val_best_acc_score: 0.9074; val_best_f1_score: 0.9114; train_kl_reg_loss: 69405.0490; train_edge_recon_loss: 2693326.8760; train_gene_expr_recon_loss: 11352751.8550; train_masked_gp_l1_reg_loss: 75379.0295; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73205.7156; train_chrom_access_recon_loss: 9700252.2901; train_global_loss: 23964320.7939; train_optim_loss: 23964320.7939; val_kl_reg_loss: 70585.4948; val_edge_recon_loss: 2701970.1833; val_gene_expr_recon_loss: 11455843.3333; val_masked_gp_l1_reg_loss: 75361.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73034.6641; val_chrom_access_recon_loss: 9739056.8667; val_global_loss: 24115853.0667; val_optim_loss: 24115853.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9672; val_auprc_score: 0.9592; val_best_acc_score: 0.9124; val_best_f1_score: 0.9158; train_kl_reg_loss: 69407.2675; train_edge_recon_loss: 2693032.7271; train_gene_expr_recon_loss: 11339123.3282; train_masked_gp_l1_reg_loss: 75325.7414; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73068.4468; train_chrom_access_recon_loss: 9681353.8855; train_global_loss: 23931311.4962; train_optim_loss: 23931311.4962; val_kl_reg_loss: 71509.0766; val_edge_recon_loss: 2692763.2833; val_gene_expr_recon_loss: 11389798.5333; val_masked_gp_l1_reg_loss: 75177.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73032.4922; val_chrom_access_recon_loss: 9658195.7333; val_global_loss: 23960475.6000; val_optim_loss: 23960475.6000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9677; val_auprc_score: 0.9571; val_best_acc_score: 0.9181; val_best_f1_score: 0.9217; train_kl_reg_loss: 68403.9139; train_edge_recon_loss: 2688979.4408; train_gene_expr_recon_loss: 11319840.9771; train_masked_gp_l1_reg_loss: 75138.4419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72919.1063; train_chrom_access_recon_loss: 9657286.9466; train_global_loss: 23882568.8092; train_optim_loss: 23882568.8092; val_kl_reg_loss: 69212.8120; val_edge_recon_loss: 2691569.6000; val_gene_expr_recon_loss: 11411580.8667; val_masked_gp_l1_reg_loss: 75151.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72679.9609; val_chrom_access_recon_loss: 9685922.0667; val_global_loss: 24006116.6667; val_optim_loss: 24006116.6667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9601; val_auprc_score: 0.9498; val_best_acc_score: 0.9003; val_best_f1_score: 0.9034; train_kl_reg_loss: 89652.3148; train_edge_recon_loss: 2796116.6355; train_gene_expr_recon_loss: 10141781.9237; train_masked_gp_l1_reg_loss: 74438.1528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69743.9565; train_chrom_access_recon_loss: 8774751.7023; train_global_loss: 21946484.7481; train_optim_loss: 21946484.7481; val_kl_reg_loss: 22356.6487; val_edge_recon_loss: 2761911.8500; val_gene_expr_recon_loss: 10163283.8000; val_masked_gp_l1_reg_loss: 73095.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71054.9141; val_chrom_access_recon_loss: 8729810.7000; val_global_loss: 21821513.7333; val_optim_loss: 21821513.7333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9630; val_auprc_score: 0.9515; val_best_acc_score: 0.9086; val_best_f1_score: 0.9111; train_kl_reg_loss: 64221.2895; train_edge_recon_loss: 2723256.9084; train_gene_expr_recon_loss: 10107208.4580; train_masked_gp_l1_reg_loss: 71783.1036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71297.1045; train_chrom_access_recon_loss: 8743440.1718; train_global_loss: 21781207.0840; train_optim_loss: 21781207.0840; val_kl_reg_loss: 26332.8702; val_edge_recon_loss: 2743388.2333; val_gene_expr_recon_loss: 10199951.5333; val_masked_gp_l1_reg_loss: 70528.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71873.2188; val_chrom_access_recon_loss: 8784030.3000; val_global_loss: 21896104.8000; val_optim_loss: 21896104.8000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9646; val_auprc_score: 0.9561; val_best_acc_score: 0.9077; val_best_f1_score: 0.9115; train_kl_reg_loss: 53757.5215; train_edge_recon_loss: 2703687.9752; train_gene_expr_recon_loss: 10077637.0534; train_masked_gp_l1_reg_loss: 69315.7385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71659.8080; train_chrom_access_recon_loss: 8716146.4809; train_global_loss: 21692204.5038; train_optim_loss: 21692204.5038; val_kl_reg_loss: 31298.1943; val_edge_recon_loss: 2708169.1667; val_gene_expr_recon_loss: 10155678.8000; val_masked_gp_l1_reg_loss: 68120.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71782.1562; val_chrom_access_recon_loss: 8741669.2000; val_global_loss: 21776718.1333; val_optim_loss: 21776718.1333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9632; val_auprc_score: 0.9529; val_best_acc_score: 0.9095; val_best_f1_score: 0.9134; train_kl_reg_loss: 51835.3573; train_edge_recon_loss: 2690628.2634; train_gene_expr_recon_loss: 10057575.7557; train_masked_gp_l1_reg_loss: 66995.8918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71832.2240; train_chrom_access_recon_loss: 8701767.1260; train_global_loss: 21640634.5954; train_optim_loss: 21640634.5954; val_kl_reg_loss: 34243.7247; val_edge_recon_loss: 2692956.5833; val_gene_expr_recon_loss: 10147709.1333; val_masked_gp_l1_reg_loss: 65793.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72080.4531; val_chrom_access_recon_loss: 8728965.9000; val_global_loss: 21741748.9333; val_optim_loss: 21741748.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9656; val_auprc_score: 0.9545; val_best_acc_score: 0.9147; val_best_f1_score: 0.9181; train_kl_reg_loss: 50189.0727; train_edge_recon_loss: 2690202.7634; train_gene_expr_recon_loss: 10033421.3053; train_masked_gp_l1_reg_loss: 64784.7168; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71671.3344; train_chrom_access_recon_loss: 8681158.4046; train_global_loss: 21591427.6336; train_optim_loss: 21591427.6336; val_kl_reg_loss: 35689.0104; val_edge_recon_loss: 2672021.5167; val_gene_expr_recon_loss: 10097336.6000; val_masked_gp_l1_reg_loss: 63841.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71903.3672; val_chrom_access_recon_loss: 8717159.5333; val_global_loss: 21657951.6000; val_optim_loss: 21657951.6000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9673; val_auprc_score: 0.9565; val_best_acc_score: 0.9184; val_best_f1_score: 0.9211; train_kl_reg_loss: 48131.1470; train_edge_recon_loss: 2685090.7710; train_gene_expr_recon_loss: 10023428.1450; train_masked_gp_l1_reg_loss: 63033.2306; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71638.8383; train_chrom_access_recon_loss: 8680731.5840; train_global_loss: 21572053.7405; train_optim_loss: 21572053.7405; val_kl_reg_loss: 35884.3823; val_edge_recon_loss: 2691991.7500; val_gene_expr_recon_loss: 10128853.2000; val_masked_gp_l1_reg_loss: 62280.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71669.7578; val_chrom_access_recon_loss: 8716791.3000; val_global_loss: 21707471.8667; val_optim_loss: 21707471.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9670; val_auprc_score: 0.9525; val_best_acc_score: 0.9181; val_best_f1_score: 0.9211; train_kl_reg_loss: 48641.5013; train_edge_recon_loss: 2682081.0496; train_gene_expr_recon_loss: 10002705.7634; train_masked_gp_l1_reg_loss: 61560.7230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71694.6214; train_chrom_access_recon_loss: 8661507.9962; train_global_loss: 21528191.5573; train_optim_loss: 21528191.5573; val_kl_reg_loss: 35640.3164; val_edge_recon_loss: 2693250.1333; val_gene_expr_recon_loss: 10096117.4000; val_masked_gp_l1_reg_loss: 60962.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71538.0000; val_chrom_access_recon_loss: 8682206.4000; val_global_loss: 21639715.3333; val_optim_loss: 21639715.3333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9652; val_auprc_score: 0.9558; val_best_acc_score: 0.9135; val_best_f1_score: 0.9159; train_kl_reg_loss: 48125.7574; train_edge_recon_loss: 2677727.8531; train_gene_expr_recon_loss: 10003598.4962; train_masked_gp_l1_reg_loss: 60399.9104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71519.1168; train_chrom_access_recon_loss: 8668190.7519; train_global_loss: 21529562.0611; train_optim_loss: 21529562.0611; val_kl_reg_loss: 39212.1057; val_edge_recon_loss: 2711876.6000; val_gene_expr_recon_loss: 10098396.8000; val_masked_gp_l1_reg_loss: 59894.8867; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71394.1328; val_chrom_access_recon_loss: 8712101.0000; val_global_loss: 21692875.3333; val_optim_loss: 21692875.3333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9679; val_auprc_score: 0.9565; val_best_acc_score: 0.9213; val_best_f1_score: 0.9235; train_kl_reg_loss: 48845.7214; train_edge_recon_loss: 2675662.0267; train_gene_expr_recon_loss: 9992653.9313; train_masked_gp_l1_reg_loss: 59258.5973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71733.3627; train_chrom_access_recon_loss: 8647401.7901; train_global_loss: 21495555.4962; train_optim_loss: 21495555.4962; val_kl_reg_loss: 38209.7969; val_edge_recon_loss: 2670124.0000; val_gene_expr_recon_loss: 10114061.1333; val_masked_gp_l1_reg_loss: 58749.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71710.1406; val_chrom_access_recon_loss: 8718738.6333; val_global_loss: 21671593.7333; val_optim_loss: 21671593.7333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9681; val_auprc_score: 0.9563; val_best_acc_score: 0.9202; val_best_f1_score: 0.9230; train_kl_reg_loss: 48003.3712; train_edge_recon_loss: 2672880.3473; train_gene_expr_recon_loss: 9979912.9008; train_masked_gp_l1_reg_loss: 58197.8041; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71640.3094; train_chrom_access_recon_loss: 8635097.7672; train_global_loss: 21465732.5191; train_optim_loss: 21465732.5191; val_kl_reg_loss: 39307.1411; val_edge_recon_loss: 2677000.9500; val_gene_expr_recon_loss: 10044740.5333; val_masked_gp_l1_reg_loss: 57662.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71401.6406; val_chrom_access_recon_loss: 8648331.5333; val_global_loss: 21538445.2000; val_optim_loss: 21538445.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9673; val_auprc_score: 0.9555; val_best_acc_score: 0.9208; val_best_f1_score: 0.9239; train_kl_reg_loss: 47273.2158; train_edge_recon_loss: 2663564.9885; train_gene_expr_recon_loss: 9969304.2977; train_masked_gp_l1_reg_loss: 57248.4857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71484.1754; train_chrom_access_recon_loss: 8620060.1679; train_global_loss: 21428935.1908; train_optim_loss: 21428935.1908; val_kl_reg_loss: 39273.9497; val_edge_recon_loss: 2692330.8833; val_gene_expr_recon_loss: 10056594.0000; val_masked_gp_l1_reg_loss: 56829.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71519.9531; val_chrom_access_recon_loss: 8653499.7333; val_global_loss: 21570047.4667; val_optim_loss: 21570047.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9680; val_auprc_score: 0.9573; val_best_acc_score: 0.9162; val_best_f1_score: 0.9195; train_kl_reg_loss: 46926.6691; train_edge_recon_loss: 2667000.5744; train_gene_expr_recon_loss: 9967571.5802; train_masked_gp_l1_reg_loss: 56384.1586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71439.7641; train_chrom_access_recon_loss: 8621036.7366; train_global_loss: 21430359.5420; train_optim_loss: 21430359.5420; val_kl_reg_loss: 39638.6122; val_edge_recon_loss: 2692967.7833; val_gene_expr_recon_loss: 10051258.2000; val_masked_gp_l1_reg_loss: 56053.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71341.8516; val_chrom_access_recon_loss: 8674358.2333; val_global_loss: 21585618.8000; val_optim_loss: 21585618.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9721; val_auprc_score: 0.9654; val_best_acc_score: 0.9201; val_best_f1_score: 0.9231; train_kl_reg_loss: 46145.3283; train_edge_recon_loss: 2659304.1050; train_gene_expr_recon_loss: 9944013.5573; train_masked_gp_l1_reg_loss: 55719.1305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71419.7342; train_chrom_access_recon_loss: 8598910.1947; train_global_loss: 21375512.0611; train_optim_loss: 21375512.0611; val_kl_reg_loss: 37962.2440; val_edge_recon_loss: 2688565.9500; val_gene_expr_recon_loss: 10036203.8667; val_masked_gp_l1_reg_loss: 55357.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71061.6641; val_chrom_access_recon_loss: 8637858.7667; val_global_loss: 21527011.0667; val_optim_loss: 21527011.0667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9701; val_auprc_score: 0.9579; val_best_acc_score: 0.9227; val_best_f1_score: 0.9255; train_kl_reg_loss: 47024.4626; train_edge_recon_loss: 2667445.4141; train_gene_expr_recon_loss: 9931856.6412; train_masked_gp_l1_reg_loss: 55039.2974; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71218.5159; train_chrom_access_recon_loss: 8591485.5458; train_global_loss: 21364069.9237; train_optim_loss: 21364069.9237; val_kl_reg_loss: 40305.6703; val_edge_recon_loss: 2669063.2667; val_gene_expr_recon_loss: 10021044.6667; val_masked_gp_l1_reg_loss: 54791.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71185.7734; val_chrom_access_recon_loss: 8576808.1333; val_global_loss: 21433198.6667; val_optim_loss: 21433198.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9705; val_auprc_score: 0.9592; val_best_acc_score: 0.9225; val_best_f1_score: 0.9255; train_kl_reg_loss: 46024.1202; train_edge_recon_loss: 2662195.0439; train_gene_expr_recon_loss: 9926792.2214; train_masked_gp_l1_reg_loss: 54473.8895; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71341.3174; train_chrom_access_recon_loss: 8574836.3626; train_global_loss: 21335662.8855; train_optim_loss: 21335662.8855; val_kl_reg_loss: 40113.6128; val_edge_recon_loss: 2665544.1000; val_gene_expr_recon_loss: 9975711.0000; val_masked_gp_l1_reg_loss: 54170.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71822.4219; val_chrom_access_recon_loss: 8574240.1333; val_global_loss: 21381601.7333; val_optim_loss: 21381601.7333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9715; val_auprc_score: 0.9614; val_best_acc_score: 0.9254; val_best_f1_score: 0.9282; train_kl_reg_loss: 46088.0216; train_edge_recon_loss: 2665668.6565; train_gene_expr_recon_loss: 9910154.1908; train_masked_gp_l1_reg_loss: 53863.7869; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71374.6987; train_chrom_access_recon_loss: 8555733.1336; train_global_loss: 21302882.4885; train_optim_loss: 21302882.4885; val_kl_reg_loss: 40754.7307; val_edge_recon_loss: 2672099.2833; val_gene_expr_recon_loss: 9994503.1333; val_masked_gp_l1_reg_loss: 53609.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71143.7266; val_chrom_access_recon_loss: 8583143.6333; val_global_loss: 21415254.9333; val_optim_loss: 21415254.9333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9723; val_auprc_score: 0.9643; val_best_acc_score: 0.9251; val_best_f1_score: 0.9272; train_kl_reg_loss: 45422.9076; train_edge_recon_loss: 2655094.8168; train_gene_expr_recon_loss: 9904158.7405; train_masked_gp_l1_reg_loss: 53337.7734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71179.0106; train_chrom_access_recon_loss: 8551850.6450; train_global_loss: 21281043.8779; train_optim_loss: 21281043.8779; val_kl_reg_loss: 40553.3313; val_edge_recon_loss: 2674984.3833; val_gene_expr_recon_loss: 10014167.2000; val_masked_gp_l1_reg_loss: 53137.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71637.3125; val_chrom_access_recon_loss: 8597110.9000; val_global_loss: 21451590.6667; val_optim_loss: 21451590.6667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9740; val_auprc_score: 0.9677; val_best_acc_score: 0.9232; val_best_f1_score: 0.9252; train_kl_reg_loss: 45001.7891; train_edge_recon_loss: 2656284.7824; train_gene_expr_recon_loss: 9885763.7405; train_masked_gp_l1_reg_loss: 52871.3567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71180.1925; train_chrom_access_recon_loss: 8549378.0076; train_global_loss: 21260479.9542; train_optim_loss: 21260479.9542; val_kl_reg_loss: 42080.9945; val_edge_recon_loss: 2677438.3333; val_gene_expr_recon_loss: 10007390.0667; val_masked_gp_l1_reg_loss: 52660.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71191.0156; val_chrom_access_recon_loss: 8613100.3667; val_global_loss: 21463860.8000; val_optim_loss: 21463860.8000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9730; val_auprc_score: 0.9625; val_best_acc_score: 0.9279; val_best_f1_score: 0.9302; train_kl_reg_loss: 43948.4732; train_edge_recon_loss: 2661186.5573; train_gene_expr_recon_loss: 9879342.7023; train_masked_gp_l1_reg_loss: 52352.4385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71177.6032; train_chrom_access_recon_loss: 8535142.3588; train_global_loss: 21243150.3053; train_optim_loss: 21243150.3053; val_kl_reg_loss: 40618.6404; val_edge_recon_loss: 2664168.8333; val_gene_expr_recon_loss: 9974490.7333; val_masked_gp_l1_reg_loss: 52163.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71038.3203; val_chrom_access_recon_loss: 8591543.1667; val_global_loss: 21394022.0000; val_optim_loss: 21394022.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9729; val_auprc_score: 0.9618; val_best_acc_score: 0.9236; val_best_f1_score: 0.9266; train_kl_reg_loss: 44520.5052; train_edge_recon_loss: 2652269.3454; train_gene_expr_recon_loss: 9852666.5802; train_masked_gp_l1_reg_loss: 51778.3445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60543.6311; train_chrom_access_recon_loss: 8512474.7519; train_global_loss: 21174253.1145; train_optim_loss: 21174253.1145; val_kl_reg_loss: 41193.4115; val_edge_recon_loss: 2659277.3833; val_gene_expr_recon_loss: 9918571.2000; val_masked_gp_l1_reg_loss: 51645.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59092.0742; val_chrom_access_recon_loss: 8533524.2333; val_global_loss: 21263303.3333; val_optim_loss: 21263303.3333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9733; val_auprc_score: 0.9653; val_best_acc_score: 0.9243; val_best_f1_score: 0.9270; train_kl_reg_loss: 45287.8382; train_edge_recon_loss: 2663137.7233; train_gene_expr_recon_loss: 9843949.2595; train_masked_gp_l1_reg_loss: 51583.7349; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58717.5521; train_chrom_access_recon_loss: 8504925.5496; train_global_loss: 21167601.5878; train_optim_loss: 21167601.5878; val_kl_reg_loss: 42202.7951; val_edge_recon_loss: 2658908.2667; val_gene_expr_recon_loss: 9979466.6000; val_masked_gp_l1_reg_loss: 51540.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58382.2891; val_chrom_access_recon_loss: 8602803.3333; val_global_loss: 21393303.8667; val_optim_loss: 21393303.8667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9762; val_auprc_score: 0.9673; val_best_acc_score: 0.9314; val_best_f1_score: 0.9331; train_kl_reg_loss: 45968.4733; train_edge_recon_loss: 2651688.2996; train_gene_expr_recon_loss: 9853387.3359; train_masked_gp_l1_reg_loss: 51486.6940; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58094.2878; train_chrom_access_recon_loss: 8506763.8321; train_global_loss: 21167389.0840; train_optim_loss: 21167389.0840; val_kl_reg_loss: 42749.9784; val_edge_recon_loss: 2630810.9333; val_gene_expr_recon_loss: 9918901.5333; val_masked_gp_l1_reg_loss: 51449.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57899.6602; val_chrom_access_recon_loss: 8537702.8000; val_global_loss: 21239515.2000; val_optim_loss: 21239515.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9749; val_auprc_score: 0.9687; val_best_acc_score: 0.9256; val_best_f1_score: 0.9281; train_kl_reg_loss: 46220.1461; train_edge_recon_loss: 2657234.7156; train_gene_expr_recon_loss: 9841261.7481; train_masked_gp_l1_reg_loss: 51409.7131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57754.4437; train_chrom_access_recon_loss: 8499288.4504; train_global_loss: 21153169.1603; train_optim_loss: 21153169.1603; val_kl_reg_loss: 42931.6096; val_edge_recon_loss: 2665811.6500; val_gene_expr_recon_loss: 9925797.6667; val_masked_gp_l1_reg_loss: 51360.6523; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57564.3008; val_chrom_access_recon_loss: 8514749.2667; val_global_loss: 21258215.3333; val_optim_loss: 21258215.3333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9732; val_auprc_score: 0.9654; val_best_acc_score: 0.9248; val_best_f1_score: 0.9267; train_kl_reg_loss: 46312.5878; train_edge_recon_loss: 2649135.6546; train_gene_expr_recon_loss: 9833058.2977; train_masked_gp_l1_reg_loss: 51317.2852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57428.8187; train_chrom_access_recon_loss: 8498231.0458; train_global_loss: 21135483.6489; train_optim_loss: 21135483.6489; val_kl_reg_loss: 42829.1789; val_edge_recon_loss: 2669961.1167; val_gene_expr_recon_loss: 9928881.5333; val_masked_gp_l1_reg_loss: 51287.9336; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57218.6914; val_chrom_access_recon_loss: 8527149.9000; val_global_loss: 21277329.2000; val_optim_loss: 21277329.2000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9726; val_auprc_score: 0.9632; val_best_acc_score: 0.9267; val_best_f1_score: 0.9291; train_kl_reg_loss: 46379.0627; train_edge_recon_loss: 2653406.5573; train_gene_expr_recon_loss: 9840765.4046; train_masked_gp_l1_reg_loss: 51250.2962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57086.2784; train_chrom_access_recon_loss: 8497050.9656; train_global_loss: 21145938.4885; train_optim_loss: 21145938.4885; val_kl_reg_loss: 42943.0396; val_edge_recon_loss: 2673581.7167; val_gene_expr_recon_loss: 9992163.9333; val_masked_gp_l1_reg_loss: 51214.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56984.5977; val_chrom_access_recon_loss: 8603454.7000; val_global_loss: 21420342.6667; val_optim_loss: 21420342.6667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9718; val_auprc_score: 0.9621; val_best_acc_score: 0.9239; val_best_f1_score: 0.9267; train_kl_reg_loss: 46401.5931; train_edge_recon_loss: 2654540.1794; train_gene_expr_recon_loss: 9840429.6565; train_masked_gp_l1_reg_loss: 51186.5649; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56820.7101; train_chrom_access_recon_loss: 8502926.3969; train_global_loss: 21152305.1450; train_optim_loss: 21152305.1450; val_kl_reg_loss: 43776.4565; val_edge_recon_loss: 2663521.7000; val_gene_expr_recon_loss: 10001862.0667; val_masked_gp_l1_reg_loss: 51146.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56657.8672; val_chrom_access_recon_loss: 8602477.3667; val_global_loss: 21419442.5333; val_optim_loss: 21419442.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9741; val_auprc_score: 0.9661; val_best_acc_score: 0.9267; val_best_f1_score: 0.9286; train_kl_reg_loss: 46730.9999; train_edge_recon_loss: 2653567.9008; train_gene_expr_recon_loss: 9833773.2672; train_masked_gp_l1_reg_loss: 51102.7806; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55562.4828; train_chrom_access_recon_loss: 8490056.3321; train_global_loss: 21130793.7710; train_optim_loss: 21130793.7710; val_kl_reg_loss: 43615.1383; val_edge_recon_loss: 2667046.2667; val_gene_expr_recon_loss: 9966556.9333; val_masked_gp_l1_reg_loss: 51086.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55413.2617; val_chrom_access_recon_loss: 8569428.3667; val_global_loss: 21353145.6000; val_optim_loss: 21353145.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9731; val_auprc_score: 0.9652; val_best_acc_score: 0.9254; val_best_f1_score: 0.9277; train_kl_reg_loss: 46589.7341; train_edge_recon_loss: 2659833.2615; train_gene_expr_recon_loss: 9844979.9466; train_masked_gp_l1_reg_loss: 51078.1161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55369.8684; train_chrom_access_recon_loss: 8499837.8435; train_global_loss: 21157688.7939; train_optim_loss: 21157688.7939; val_kl_reg_loss: 43632.3719; val_edge_recon_loss: 2663489.4167; val_gene_expr_recon_loss: 9956129.6667; val_masked_gp_l1_reg_loss: 51071.3555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55331.0664; val_chrom_access_recon_loss: 8563309.5333; val_global_loss: 21332962.9333; val_optim_loss: 21332962.9333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9729; val_auprc_score: 0.9644; val_best_acc_score: 0.9270; val_best_f1_score: 0.9297; train_kl_reg_loss: 46852.3190; train_edge_recon_loss: 2656487.0458; train_gene_expr_recon_loss: 9841853.2061; train_masked_gp_l1_reg_loss: 51066.2029; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55302.0405; train_chrom_access_recon_loss: 8496790.6183; train_global_loss: 21148351.4504; train_optim_loss: 21148351.4504; val_kl_reg_loss: 43794.8099; val_edge_recon_loss: 2663229.8333; val_gene_expr_recon_loss: 9943786.3333; val_masked_gp_l1_reg_loss: 51060.0586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55271.2070; val_chrom_access_recon_loss: 8534038.9333; val_global_loss: 21291181.0667; val_optim_loss: 21291181.0667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9750; val_auprc_score: 0.9660; val_best_acc_score: 0.9279; val_best_f1_score: 0.9303; train_kl_reg_loss: 46652.6886; train_edge_recon_loss: 2653052.7214; train_gene_expr_recon_loss: 9843271.7405; train_masked_gp_l1_reg_loss: 51054.8725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55249.3929; train_chrom_access_recon_loss: 8504524.3359; train_global_loss: 21153805.8779; train_optim_loss: 21153805.8779; val_kl_reg_loss: 43627.9521; val_edge_recon_loss: 2661677.6333; val_gene_expr_recon_loss: 9925585.7333; val_masked_gp_l1_reg_loss: 51049.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55221.3945; val_chrom_access_recon_loss: 8521066.3000; val_global_loss: 21258228.6667; val_optim_loss: 21258228.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 35 min 44 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9725
val AUPRC score: 0.9649
val best accuracy score: 0.9219
val best F1 score: 0.9247
val target rna MSE score: 1.9300
val source rna MSE score: 0.6101
val target atac MSE score: 0.3418
val source atac MSE score: 0.1047
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
