[True]
Run timestamp: 10102023_024247_117.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_117']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7744; val_auprc_score: 0.7955; val_best_acc_score: 0.5280; val_best_f1_score: 0.6770; train_kl_reg_loss: 56218.3723; train_edge_recon_loss: 3511502.5477; train_gene_expr_recon_loss: 13390535.0611; train_masked_gp_l1_reg_loss: 38319.2270; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2279607.4139; train_chrom_access_recon_loss: 11187043.1527; train_global_loss: 30463225.8473; train_optim_loss: 30463225.8473; val_kl_reg_loss: 96363.9630; val_edge_recon_loss: 4063271.4500; val_gene_expr_recon_loss: 12629195.6667; val_masked_gp_l1_reg_loss: 45811.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 489183.3125; val_chrom_access_recon_loss: 10764099.1333; val_global_loss: 28087926.4000; val_optim_loss: 28087926.4000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7889; val_auprc_score: 0.8093; val_best_acc_score: 0.6772; val_best_f1_score: 0.7280; train_kl_reg_loss: 77854.0731; train_edge_recon_loss: 3501575.3798; train_gene_expr_recon_loss: 12600450.1679; train_masked_gp_l1_reg_loss: 47374.8395; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 272636.8687; train_chrom_access_recon_loss: 10802694.0382; train_global_loss: 27302585.4656; train_optim_loss: 27302585.4656; val_kl_reg_loss: 68711.8677; val_edge_recon_loss: 4051531.4667; val_gene_expr_recon_loss: 12376032.8000; val_masked_gp_l1_reg_loss: 49094.5508; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 172550.2969; val_chrom_access_recon_loss: 10623918.0000; val_global_loss: 27341839.0667; val_optim_loss: 27341839.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8550; val_auprc_score: 0.8589; val_best_acc_score: 0.7769; val_best_f1_score: 0.7860; train_kl_reg_loss: 65354.8606; train_edge_recon_loss: 3475299.4580; train_gene_expr_recon_loss: 12419629.4122; train_masked_gp_l1_reg_loss: 50710.6726; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 143148.4721; train_chrom_access_recon_loss: 10667052.9008; train_global_loss: 26821195.8321; train_optim_loss: 26821195.8321; val_kl_reg_loss: 47627.0753; val_edge_recon_loss: 3482904.0000; val_gene_expr_recon_loss: 12308069.8667; val_masked_gp_l1_reg_loss: 52761.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124467.9297; val_chrom_access_recon_loss: 10565909.5333; val_global_loss: 26581740.2667; val_optim_loss: 26581740.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9073; val_auprc_score: 0.8959; val_best_acc_score: 0.8252; val_best_f1_score: 0.8372; train_kl_reg_loss: 76372.0645; train_edge_recon_loss: 2983458.7557; train_gene_expr_recon_loss: 12295164.2137; train_masked_gp_l1_reg_loss: 57915.0792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116453.9222; train_chrom_access_recon_loss: 10563022.2366; train_global_loss: 26092386.3511; train_optim_loss: 26092386.3511; val_kl_reg_loss: 87913.3510; val_edge_recon_loss: 2879474.0667; val_gene_expr_recon_loss: 12128264.4000; val_masked_gp_l1_reg_loss: 61175.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108419.4375; val_chrom_access_recon_loss: 10442504.2000; val_global_loss: 25707750.1333; val_optim_loss: 25707750.1333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9201; val_auprc_score: 0.9063; val_best_acc_score: 0.8475; val_best_f1_score: 0.8554; train_kl_reg_loss: 91296.5276; train_edge_recon_loss: 2838810.2786; train_gene_expr_recon_loss: 12172938.8321; train_masked_gp_l1_reg_loss: 62221.5035; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102305.5164; train_chrom_access_recon_loss: 10475828.3206; train_global_loss: 25743401.0840; train_optim_loss: 25743401.0840; val_kl_reg_loss: 90296.9651; val_edge_recon_loss: 2815474.9167; val_gene_expr_recon_loss: 12025793.1333; val_masked_gp_l1_reg_loss: 63520.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98274.3594; val_chrom_access_recon_loss: 10345880.0667; val_global_loss: 25439240.2667; val_optim_loss: 25439240.2667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9290; val_auprc_score: 0.9161; val_best_acc_score: 0.8596; val_best_f1_score: 0.8691; train_kl_reg_loss: 89982.2944; train_edge_recon_loss: 2805593.1279; train_gene_expr_recon_loss: 12050078.9771; train_masked_gp_l1_reg_loss: 64364.6028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94769.5847; train_chrom_access_recon_loss: 10377093.5267; train_global_loss: 25481882.2595; train_optim_loss: 25481882.2595; val_kl_reg_loss: 82509.5839; val_edge_recon_loss: 2805998.9833; val_gene_expr_recon_loss: 11910980.2000; val_masked_gp_l1_reg_loss: 65183.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92187.9062; val_chrom_access_recon_loss: 10259253.4667; val_global_loss: 25216113.2000; val_optim_loss: 25216113.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9328; val_auprc_score: 0.9155; val_best_acc_score: 0.8639; val_best_f1_score: 0.8721; train_kl_reg_loss: 86623.6428; train_edge_recon_loss: 2792238.4618; train_gene_expr_recon_loss: 11968613.6489; train_masked_gp_l1_reg_loss: 66213.2207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90013.8148; train_chrom_access_recon_loss: 10315242.0534; train_global_loss: 25318944.8092; train_optim_loss: 25318944.8092; val_kl_reg_loss: 82910.2161; val_edge_recon_loss: 2815817.7833; val_gene_expr_recon_loss: 11896218.2000; val_masked_gp_l1_reg_loss: 67169.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88689.0938; val_chrom_access_recon_loss: 10214629.6000; val_global_loss: 25165433.6000; val_optim_loss: 25165433.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9425; val_auprc_score: 0.9282; val_best_acc_score: 0.8763; val_best_f1_score: 0.8820; train_kl_reg_loss: 83229.7573; train_edge_recon_loss: 2782574.8302; train_gene_expr_recon_loss: 11895877.1908; train_masked_gp_l1_reg_loss: 67977.8633; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86415.4323; train_chrom_access_recon_loss: 10247543.5115; train_global_loss: 25163618.5802; train_optim_loss: 25163618.5802; val_kl_reg_loss: 83308.7125; val_edge_recon_loss: 2777167.1833; val_gene_expr_recon_loss: 11777146.0000; val_masked_gp_l1_reg_loss: 68718.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85158.6562; val_chrom_access_recon_loss: 10147268.3333; val_global_loss: 24938767.4667; val_optim_loss: 24938767.4667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9470; val_auprc_score: 0.9361; val_best_acc_score: 0.8783; val_best_f1_score: 0.8851; train_kl_reg_loss: 82755.7937; train_edge_recon_loss: 2756525.2271; train_gene_expr_recon_loss: 11824901.0000; train_masked_gp_l1_reg_loss: 69357.7301; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82991.5807; train_chrom_access_recon_loss: 10185455.4122; train_global_loss: 25001986.7023; train_optim_loss: 25001986.7023; val_kl_reg_loss: 82309.5750; val_edge_recon_loss: 2760206.9667; val_gene_expr_recon_loss: 11706324.5333; val_masked_gp_l1_reg_loss: 70098.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81862.3203; val_chrom_access_recon_loss: 10119209.2000; val_global_loss: 24820011.2000; val_optim_loss: 24820011.2000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9489; val_auprc_score: 0.9353; val_best_acc_score: 0.8870; val_best_f1_score: 0.8938; train_kl_reg_loss: 81756.8206; train_edge_recon_loss: 2750576.6565; train_gene_expr_recon_loss: 11770996.0229; train_masked_gp_l1_reg_loss: 70567.4850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80430.2175; train_chrom_access_recon_loss: 10137996.9466; train_global_loss: 24892324.1832; train_optim_loss: 24892324.1832; val_kl_reg_loss: 78080.4344; val_edge_recon_loss: 2765380.5000; val_gene_expr_recon_loss: 11681067.3333; val_masked_gp_l1_reg_loss: 71166.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79406.4844; val_chrom_access_recon_loss: 10064153.7333; val_global_loss: 24739255.3333; val_optim_loss: 24739255.3333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9550; val_auprc_score: 0.9449; val_best_acc_score: 0.8899; val_best_f1_score: 0.8959; train_kl_reg_loss: 80190.8807; train_edge_recon_loss: 2740355.6107; train_gene_expr_recon_loss: 11728969.1145; train_masked_gp_l1_reg_loss: 71502.8511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78309.9968; train_chrom_access_recon_loss: 10101326.6260; train_global_loss: 24800655.0534; train_optim_loss: 24800655.0534; val_kl_reg_loss: 77900.7552; val_edge_recon_loss: 2737590.1167; val_gene_expr_recon_loss: 11605624.2667; val_masked_gp_l1_reg_loss: 72053.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77946.3594; val_chrom_access_recon_loss: 9981853.9333; val_global_loss: 24552968.0000; val_optim_loss: 24552968.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9560; val_auprc_score: 0.9462; val_best_acc_score: 0.8941; val_best_f1_score: 0.8975; train_kl_reg_loss: 79526.2124; train_edge_recon_loss: 2722226.0897; train_gene_expr_recon_loss: 11676550.8702; train_masked_gp_l1_reg_loss: 72371.7575; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76861.7782; train_chrom_access_recon_loss: 10053495.3664; train_global_loss: 24681032.0305; train_optim_loss: 24681032.0305; val_kl_reg_loss: 78906.9271; val_edge_recon_loss: 2750127.4667; val_gene_expr_recon_loss: 11581860.8667; val_masked_gp_l1_reg_loss: 72823.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76444.5547; val_chrom_access_recon_loss: 9920234.0667; val_global_loss: 24480398.2667; val_optim_loss: 24480398.2667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9599; val_auprc_score: 0.9504; val_best_acc_score: 0.9037; val_best_f1_score: 0.9068; train_kl_reg_loss: 77813.6967; train_edge_recon_loss: 2721769.7481; train_gene_expr_recon_loss: 11627805.6870; train_masked_gp_l1_reg_loss: 73077.0555; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75692.4189; train_chrom_access_recon_loss: 9992839.1450; train_global_loss: 24568997.6947; train_optim_loss: 24568997.6947; val_kl_reg_loss: 77122.9677; val_edge_recon_loss: 2726597.3000; val_gene_expr_recon_loss: 11561494.1333; val_masked_gp_l1_reg_loss: 73458.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75154.4688; val_chrom_access_recon_loss: 9930272.0667; val_global_loss: 24444098.4000; val_optim_loss: 24444098.4000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9549; val_auprc_score: 0.9443; val_best_acc_score: 0.8923; val_best_f1_score: 0.8979; train_kl_reg_loss: 76146.2625; train_edge_recon_loss: 2725309.0744; train_gene_expr_recon_loss: 11586229.8321; train_masked_gp_l1_reg_loss: 73719.0251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75011.2309; train_chrom_access_recon_loss: 9947721.2519; train_global_loss: 24484136.5954; train_optim_loss: 24484136.5954; val_kl_reg_loss: 77091.1755; val_edge_recon_loss: 2756508.4500; val_gene_expr_recon_loss: 11530488.9333; val_masked_gp_l1_reg_loss: 73984.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74753.7812; val_chrom_access_recon_loss: 9912626.1333; val_global_loss: 24425453.7333; val_optim_loss: 24425453.7333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9614; val_auprc_score: 0.9513; val_best_acc_score: 0.9054; val_best_f1_score: 0.9098; train_kl_reg_loss: 75825.1513; train_edge_recon_loss: 2716635.7290; train_gene_expr_recon_loss: 11552283.9924; train_masked_gp_l1_reg_loss: 74147.7696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74370.2641; train_chrom_access_recon_loss: 9917890.6260; train_global_loss: 24411153.6489; train_optim_loss: 24411153.6489; val_kl_reg_loss: 76136.7828; val_edge_recon_loss: 2717789.5000; val_gene_expr_recon_loss: 11473954.6000; val_masked_gp_l1_reg_loss: 74334.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74570.4766; val_chrom_access_recon_loss: 9845594.0000; val_global_loss: 24262379.4667; val_optim_loss: 24262379.4667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9626; val_auprc_score: 0.9531; val_best_acc_score: 0.9039; val_best_f1_score: 0.9077; train_kl_reg_loss: 74004.1732; train_edge_recon_loss: 2708862.1603; train_gene_expr_recon_loss: 11531832.9313; train_masked_gp_l1_reg_loss: 74521.0618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74320.5392; train_chrom_access_recon_loss: 9894238.2595; train_global_loss: 24357779.1603; train_optim_loss: 24357779.1603; val_kl_reg_loss: 72698.8089; val_edge_recon_loss: 2735981.0167; val_gene_expr_recon_loss: 11476310.0667; val_masked_gp_l1_reg_loss: 74727.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75278.1016; val_chrom_access_recon_loss: 9814448.0667; val_global_loss: 24249444.0000; val_optim_loss: 24249444.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9645; val_auprc_score: 0.9540; val_best_acc_score: 0.9108; val_best_f1_score: 0.9148; train_kl_reg_loss: 73393.5683; train_edge_recon_loss: 2706535.3721; train_gene_expr_recon_loss: 11489641.9008; train_masked_gp_l1_reg_loss: 74800.6764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74975.1295; train_chrom_access_recon_loss: 9844247.1832; train_global_loss: 24263593.8015; train_optim_loss: 24263593.8015; val_kl_reg_loss: 72270.2276; val_edge_recon_loss: 2710390.1833; val_gene_expr_recon_loss: 11380651.2000; val_masked_gp_l1_reg_loss: 75011.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75265.8125; val_chrom_access_recon_loss: 9772659.2000; val_global_loss: 24086248.8000; val_optim_loss: 24086248.8000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9627; val_auprc_score: 0.9539; val_best_acc_score: 0.9081; val_best_f1_score: 0.9109; train_kl_reg_loss: 72247.5576; train_edge_recon_loss: 2700121.3263; train_gene_expr_recon_loss: 11468325.7557; train_masked_gp_l1_reg_loss: 75109.0221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74920.4135; train_chrom_access_recon_loss: 9813310.0076; train_global_loss: 24204034.0611; train_optim_loss: 24204034.0611; val_kl_reg_loss: 71103.1307; val_edge_recon_loss: 2738905.3333; val_gene_expr_recon_loss: 11373627.8667; val_masked_gp_l1_reg_loss: 75304.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75826.7422; val_chrom_access_recon_loss: 9768458.2667; val_global_loss: 24103226.8000; val_optim_loss: 24103226.8000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9676; val_auprc_score: 0.9560; val_best_acc_score: 0.9153; val_best_f1_score: 0.9179; train_kl_reg_loss: 72355.1055; train_edge_recon_loss: 2699390.3015; train_gene_expr_recon_loss: 11446650.0687; train_masked_gp_l1_reg_loss: 75393.5210; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75354.9852; train_chrom_access_recon_loss: 9787944.6412; train_global_loss: 24157088.6412; train_optim_loss: 24157088.6412; val_kl_reg_loss: 72925.6620; val_edge_recon_loss: 2701686.8667; val_gene_expr_recon_loss: 11337615.0667; val_masked_gp_l1_reg_loss: 75416.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75653.5469; val_chrom_access_recon_loss: 9700204.0000; val_global_loss: 23963501.7333; val_optim_loss: 23963501.7333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9708; val_auprc_score: 0.9629; val_best_acc_score: 0.9205; val_best_f1_score: 0.9229; train_kl_reg_loss: 72210.8064; train_edge_recon_loss: 2692233.7099; train_gene_expr_recon_loss: 11410663.8702; train_masked_gp_l1_reg_loss: 75438.7130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75347.3258; train_chrom_access_recon_loss: 9748721.8702; train_global_loss: 24074616.2901; train_optim_loss: 24074616.2901; val_kl_reg_loss: 72669.6474; val_edge_recon_loss: 2707934.5167; val_gene_expr_recon_loss: 11267802.7333; val_masked_gp_l1_reg_loss: 75559.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75707.5625; val_chrom_access_recon_loss: 9636789.9333; val_global_loss: 23836463.7333; val_optim_loss: 23836463.7333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9698; val_auprc_score: 0.9605; val_best_acc_score: 0.9205; val_best_f1_score: 0.9231; train_kl_reg_loss: 71742.5977; train_edge_recon_loss: 2688943.3989; train_gene_expr_recon_loss: 11395611.4046; train_masked_gp_l1_reg_loss: 75514.9608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75263.0202; train_chrom_access_recon_loss: 9727100.0916; train_global_loss: 24034175.4198; train_optim_loss: 24034175.4198; val_kl_reg_loss: 71250.3411; val_edge_recon_loss: 2698245.0333; val_gene_expr_recon_loss: 11370514.9333; val_masked_gp_l1_reg_loss: 75385.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75162.5312; val_chrom_access_recon_loss: 9721952.2667; val_global_loss: 24012511.6000; val_optim_loss: 24012511.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9705; val_auprc_score: 0.9626; val_best_acc_score: 0.9181; val_best_f1_score: 0.9198; train_kl_reg_loss: 71050.7348; train_edge_recon_loss: 2685945.2805; train_gene_expr_recon_loss: 11384921.0229; train_masked_gp_l1_reg_loss: 75455.5853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75101.6153; train_chrom_access_recon_loss: 9703850.3511; train_global_loss: 23996324.6260; train_optim_loss: 23996324.6260; val_kl_reg_loss: 71778.6698; val_edge_recon_loss: 2699317.6500; val_gene_expr_recon_loss: 11307704.0000; val_masked_gp_l1_reg_loss: 75395.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74872.5391; val_chrom_access_recon_loss: 9620376.9333; val_global_loss: 23849445.2000; val_optim_loss: 23849445.2000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9718; val_auprc_score: 0.9631; val_best_acc_score: 0.9225; val_best_f1_score: 0.9248; train_kl_reg_loss: 71258.3909; train_edge_recon_loss: 2687188.7099; train_gene_expr_recon_loss: 11363463.4198; train_masked_gp_l1_reg_loss: 75359.8673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75129.7130; train_chrom_access_recon_loss: 9671608.7481; train_global_loss: 23944008.8397; train_optim_loss: 23944008.8397; val_kl_reg_loss: 70648.3536; val_edge_recon_loss: 2698106.5667; val_gene_expr_recon_loss: 11263951.1333; val_masked_gp_l1_reg_loss: 75345.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75349.3359; val_chrom_access_recon_loss: 9573621.8667; val_global_loss: 23757021.8667; val_optim_loss: 23757021.8667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9724; val_auprc_score: 0.9624; val_best_acc_score: 0.9262; val_best_f1_score: 0.9284; train_kl_reg_loss: 70784.4716; train_edge_recon_loss: 2683713.8302; train_gene_expr_recon_loss: 11346418.4046; train_masked_gp_l1_reg_loss: 75192.4272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75054.5059; train_chrom_access_recon_loss: 9639904.9160; train_global_loss: 23891068.6565; train_optim_loss: 23891068.6565; val_kl_reg_loss: 70456.5010; val_edge_recon_loss: 2684517.3667; val_gene_expr_recon_loss: 11251622.9333; val_masked_gp_l1_reg_loss: 75174.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74862.9062; val_chrom_access_recon_loss: 9554320.6000; val_global_loss: 23710955.3333; val_optim_loss: 23710955.3333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9721; val_auprc_score: 0.9644; val_best_acc_score: 0.9248; val_best_f1_score: 0.9274; train_kl_reg_loss: 69816.3176; train_edge_recon_loss: 2679791.3817; train_gene_expr_recon_loss: 11331503.2366; train_masked_gp_l1_reg_loss: 75243.4921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75111.8353; train_chrom_access_recon_loss: 9615062.5420; train_global_loss: 23846528.9771; train_optim_loss: 23846528.9771; val_kl_reg_loss: 70070.7792; val_edge_recon_loss: 2703966.2833; val_gene_expr_recon_loss: 11281061.0000; val_masked_gp_l1_reg_loss: 75179.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75009.5703; val_chrom_access_recon_loss: 9556131.3333; val_global_loss: 23761419.3333; val_optim_loss: 23761419.3333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9712; val_auprc_score: 0.9649; val_best_acc_score: 0.9204; val_best_f1_score: 0.9233; train_kl_reg_loss: 81765.0536; train_edge_recon_loss: 2734435.1126; train_gene_expr_recon_loss: 10455494.7099; train_masked_gp_l1_reg_loss: 74555.5588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71500.4842; train_chrom_access_recon_loss: 9028426.8511; train_global_loss: 22446177.7252; train_optim_loss: 22446177.7252; val_kl_reg_loss: 34893.7302; val_edge_recon_loss: 2714813.7833; val_gene_expr_recon_loss: 10362859.3333; val_masked_gp_l1_reg_loss: 73785.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72273.9688; val_chrom_access_recon_loss: 8911944.2667; val_global_loss: 22170570.4000; val_optim_loss: 22170570.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9720; val_auprc_score: 0.9639; val_best_acc_score: 0.9217; val_best_f1_score: 0.9250; train_kl_reg_loss: 68399.1053; train_edge_recon_loss: 2695389.8225; train_gene_expr_recon_loss: 10423788.8473; train_masked_gp_l1_reg_loss: 73019.5630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72354.3169; train_chrom_access_recon_loss: 9004475.2519; train_global_loss: 22337426.7634; train_optim_loss: 22337426.7634; val_kl_reg_loss: 38931.0497; val_edge_recon_loss: 2710662.9333; val_gene_expr_recon_loss: 10302289.0667; val_masked_gp_l1_reg_loss: 72223.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72137.0938; val_chrom_access_recon_loss: 8890313.5000; val_global_loss: 22086556.5333; val_optim_loss: 22086556.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9710; val_auprc_score: 0.9597; val_best_acc_score: 0.9267; val_best_f1_score: 0.9292; train_kl_reg_loss: 60983.4405; train_edge_recon_loss: 2680943.5134; train_gene_expr_recon_loss: 10398230.9160; train_masked_gp_l1_reg_loss: 71258.6271; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72477.4833; train_chrom_access_recon_loss: 8978835.8321; train_global_loss: 22262729.8779; train_optim_loss: 22262729.8779; val_kl_reg_loss: 43591.2995; val_edge_recon_loss: 2690335.3500; val_gene_expr_recon_loss: 10370211.1333; val_masked_gp_l1_reg_loss: 70256.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72387.1328; val_chrom_access_recon_loss: 8916099.2667; val_global_loss: 22162880.9333; val_optim_loss: 22162880.9333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9726; val_auprc_score: 0.9653; val_best_acc_score: 0.9258; val_best_f1_score: 0.9284; train_kl_reg_loss: 56617.5676; train_edge_recon_loss: 2683296.9408; train_gene_expr_recon_loss: 10378104.4809; train_masked_gp_l1_reg_loss: 69390.1546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72502.5887; train_chrom_access_recon_loss: 8964798.2519; train_global_loss: 22224709.8931; train_optim_loss: 22224709.8931; val_kl_reg_loss: 45125.1096; val_edge_recon_loss: 2698188.8167; val_gene_expr_recon_loss: 10285841.1333; val_masked_gp_l1_reg_loss: 68559.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73052.2031; val_chrom_access_recon_loss: 8868292.6000; val_global_loss: 22039059.4667; val_optim_loss: 22039059.4667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9741; val_auprc_score: 0.9670; val_best_acc_score: 0.9275; val_best_f1_score: 0.9301; train_kl_reg_loss: 56265.8201; train_edge_recon_loss: 2670304.7901; train_gene_expr_recon_loss: 10373169.3206; train_masked_gp_l1_reg_loss: 67644.1589; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72657.1203; train_chrom_access_recon_loss: 8961143.3053; train_global_loss: 22201184.5344; train_optim_loss: 22201184.5344; val_kl_reg_loss: 45664.3677; val_edge_recon_loss: 2681210.2833; val_gene_expr_recon_loss: 10328643.6667; val_masked_gp_l1_reg_loss: 66900.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72499.7656; val_chrom_access_recon_loss: 8879269.0333; val_global_loss: 22074188.1333; val_optim_loss: 22074188.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9720; val_auprc_score: 0.9603; val_best_acc_score: 0.9256; val_best_f1_score: 0.9287; train_kl_reg_loss: 54969.0398; train_edge_recon_loss: 2668257.4618; train_gene_expr_recon_loss: 10350345.4885; train_masked_gp_l1_reg_loss: 66142.6106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72280.7044; train_chrom_access_recon_loss: 8927372.6527; train_global_loss: 22139367.8473; train_optim_loss: 22139367.8473; val_kl_reg_loss: 46900.6841; val_edge_recon_loss: 2689603.1833; val_gene_expr_recon_loss: 10251320.0667; val_masked_gp_l1_reg_loss: 65511.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72274.8750; val_chrom_access_recon_loss: 8824898.1333; val_global_loss: 21950508.2667; val_optim_loss: 21950508.2667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9758; val_auprc_score: 0.9700; val_best_acc_score: 0.9305; val_best_f1_score: 0.9326; train_kl_reg_loss: 54512.5601; train_edge_recon_loss: 2669426.0038; train_gene_expr_recon_loss: 10331410.9084; train_masked_gp_l1_reg_loss: 64826.0330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72083.1302; train_chrom_access_recon_loss: 8891084.1908; train_global_loss: 22083342.8550; train_optim_loss: 22083342.8550; val_kl_reg_loss: 48513.8914; val_edge_recon_loss: 2678891.5667; val_gene_expr_recon_loss: 10249168.9333; val_masked_gp_l1_reg_loss: 64232.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72300.5000; val_chrom_access_recon_loss: 8802615.0667; val_global_loss: 21915721.4667; val_optim_loss: 21915721.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9725; val_auprc_score: 0.9614; val_best_acc_score: 0.9278; val_best_f1_score: 0.9304; train_kl_reg_loss: 53296.4277; train_edge_recon_loss: 2666394.2729; train_gene_expr_recon_loss: 10313623.7863; train_masked_gp_l1_reg_loss: 63742.3859; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71968.8023; train_chrom_access_recon_loss: 8884432.3893; train_global_loss: 22053457.9542; train_optim_loss: 22053457.9542; val_kl_reg_loss: 48937.8698; val_edge_recon_loss: 2676046.0333; val_gene_expr_recon_loss: 10261657.3333; val_masked_gp_l1_reg_loss: 63217.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71903.7109; val_chrom_access_recon_loss: 8804173.6667; val_global_loss: 21925936.2667; val_optim_loss: 21925936.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9755; val_auprc_score: 0.9659; val_best_acc_score: 0.9281; val_best_f1_score: 0.9310; train_kl_reg_loss: 53438.8378; train_edge_recon_loss: 2661041.1412; train_gene_expr_recon_loss: 10317575.2595; train_masked_gp_l1_reg_loss: 62815.4768; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71967.9705; train_chrom_access_recon_loss: 8877240.7405; train_global_loss: 22044079.4656; train_optim_loss: 22044079.4656; val_kl_reg_loss: 49924.6117; val_edge_recon_loss: 2666159.2500; val_gene_expr_recon_loss: 10243507.8667; val_masked_gp_l1_reg_loss: 62331.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71970.9375; val_chrom_access_recon_loss: 8771088.8333; val_global_loss: 21864982.4000; val_optim_loss: 21864982.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9756; val_auprc_score: 0.9664; val_best_acc_score: 0.9322; val_best_f1_score: 0.9339; train_kl_reg_loss: 52949.2132; train_edge_recon_loss: 2663424.3225; train_gene_expr_recon_loss: 10293263.3435; train_masked_gp_l1_reg_loss: 61920.0816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71844.9942; train_chrom_access_recon_loss: 8852473.2328; train_global_loss: 21995875.1756; train_optim_loss: 21995875.1756; val_kl_reg_loss: 48833.7794; val_edge_recon_loss: 2683066.1167; val_gene_expr_recon_loss: 10213669.0667; val_masked_gp_l1_reg_loss: 61526.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71937.4531; val_chrom_access_recon_loss: 8736519.4000; val_global_loss: 21815551.6000; val_optim_loss: 21815551.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9756; val_auprc_score: 0.9673; val_best_acc_score: 0.9301; val_best_f1_score: 0.9328; train_kl_reg_loss: 51866.7419; train_edge_recon_loss: 2662670.0706; train_gene_expr_recon_loss: 10288048.3817; train_masked_gp_l1_reg_loss: 61214.3614; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71944.6843; train_chrom_access_recon_loss: 8839449.7405; train_global_loss: 21975194.0000; train_optim_loss: 21975194.0000; val_kl_reg_loss: 47405.9716; val_edge_recon_loss: 2676393.7000; val_gene_expr_recon_loss: 10215410.8667; val_masked_gp_l1_reg_loss: 60902.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71835.0312; val_chrom_access_recon_loss: 8760950.0000; val_global_loss: 21832897.3333; val_optim_loss: 21832897.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9767; val_auprc_score: 0.9694; val_best_acc_score: 0.9309; val_best_f1_score: 0.9331; train_kl_reg_loss: 51293.8109; train_edge_recon_loss: 2661915.8244; train_gene_expr_recon_loss: 10286496.6107; train_masked_gp_l1_reg_loss: 60642.0886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71709.9921; train_chrom_access_recon_loss: 8836607.7557; train_global_loss: 21968666.0458; train_optim_loss: 21968666.0458; val_kl_reg_loss: 47648.9495; val_edge_recon_loss: 2665777.3667; val_gene_expr_recon_loss: 10182455.2667; val_masked_gp_l1_reg_loss: 60408.4180; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72047.4453; val_chrom_access_recon_loss: 8713575.9667; val_global_loss: 21741912.5333; val_optim_loss: 21741912.5333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9793; val_auprc_score: 0.9744; val_best_acc_score: 0.9326; val_best_f1_score: 0.9341; train_kl_reg_loss: 52257.3887; train_edge_recon_loss: 2656334.2882; train_gene_expr_recon_loss: 10251316.4580; train_masked_gp_l1_reg_loss: 60093.0526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71628.2874; train_chrom_access_recon_loss: 8811266.7328; train_global_loss: 21902896.1985; train_optim_loss: 21902896.1985; val_kl_reg_loss: 49709.7039; val_edge_recon_loss: 2666609.3167; val_gene_expr_recon_loss: 10177363.8667; val_masked_gp_l1_reg_loss: 59838.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71754.1562; val_chrom_access_recon_loss: 8695255.7667; val_global_loss: 21720530.4000; val_optim_loss: 21720530.4000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9778; val_auprc_score: 0.9709; val_best_acc_score: 0.9330; val_best_f1_score: 0.9356; train_kl_reg_loss: 50707.3043; train_edge_recon_loss: 2658121.3435; train_gene_expr_recon_loss: 10243658.7939; train_masked_gp_l1_reg_loss: 59596.0242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71546.6044; train_chrom_access_recon_loss: 8801756.2137; train_global_loss: 21885386.1832; train_optim_loss: 21885386.1832; val_kl_reg_loss: 47014.7383; val_edge_recon_loss: 2673110.2000; val_gene_expr_recon_loss: 10176589.3333; val_masked_gp_l1_reg_loss: 59442.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71775.0625; val_chrom_access_recon_loss: 8743219.1333; val_global_loss: 21771151.4667; val_optim_loss: 21771151.4667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9777; val_auprc_score: 0.9721; val_best_acc_score: 0.9353; val_best_f1_score: 0.9373; train_kl_reg_loss: 50504.5570; train_edge_recon_loss: 2657216.4160; train_gene_expr_recon_loss: 10255522.4351; train_masked_gp_l1_reg_loss: 59202.9961; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71716.8853; train_chrom_access_recon_loss: 8822076.3053; train_global_loss: 21916239.6031; train_optim_loss: 21916239.6031; val_kl_reg_loss: 48455.0156; val_edge_recon_loss: 2668729.0000; val_gene_expr_recon_loss: 10167020.6667; val_masked_gp_l1_reg_loss: 58988.2773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71419.6016; val_chrom_access_recon_loss: 8736281.6000; val_global_loss: 21750894.0000; val_optim_loss: 21750894.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9787; val_auprc_score: 0.9736; val_best_acc_score: 0.9344; val_best_f1_score: 0.9372; train_kl_reg_loss: 50613.1216; train_edge_recon_loss: 2658568.9924; train_gene_expr_recon_loss: 10236772.3282; train_masked_gp_l1_reg_loss: 58739.4865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71533.5344; train_chrom_access_recon_loss: 8799627.5802; train_global_loss: 21875854.9924; train_optim_loss: 21875854.9924; val_kl_reg_loss: 48349.8109; val_edge_recon_loss: 2680918.0667; val_gene_expr_recon_loss: 10158858.8667; val_masked_gp_l1_reg_loss: 58618.7383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71625.5703; val_chrom_access_recon_loss: 8716255.1333; val_global_loss: 21734626.9333; val_optim_loss: 21734626.9333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9787; val_auprc_score: 0.9675; val_best_acc_score: 0.9392; val_best_f1_score: 0.9411; train_kl_reg_loss: 50822.8364; train_edge_recon_loss: 2658484.8855; train_gene_expr_recon_loss: 10235658.5191; train_masked_gp_l1_reg_loss: 58416.0297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71450.2570; train_chrom_access_recon_loss: 8789729.1450; train_global_loss: 21864561.7252; train_optim_loss: 21864561.7252; val_kl_reg_loss: 48431.3286; val_edge_recon_loss: 2659321.2167; val_gene_expr_recon_loss: 10153364.2667; val_masked_gp_l1_reg_loss: 58175.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71665.2109; val_chrom_access_recon_loss: 8701582.5667; val_global_loss: 21692540.5333; val_optim_loss: 21692540.5333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9829; val_auprc_score: 0.9787; val_best_acc_score: 0.9409; val_best_f1_score: 0.9426; train_kl_reg_loss: 50193.4881; train_edge_recon_loss: 2657134.0000; train_gene_expr_recon_loss: 10227810.7863; train_masked_gp_l1_reg_loss: 58045.1540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71611.7439; train_chrom_access_recon_loss: 8775850.9847; train_global_loss: 21840646.1221; train_optim_loss: 21840646.1221; val_kl_reg_loss: 46439.0005; val_edge_recon_loss: 2651306.0500; val_gene_expr_recon_loss: 10163210.7333; val_masked_gp_l1_reg_loss: 57933.5820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71496.3281; val_chrom_access_recon_loss: 8690338.7333; val_global_loss: 21680724.4000; val_optim_loss: 21680724.4000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9813; val_auprc_score: 0.9744; val_best_acc_score: 0.9415; val_best_f1_score: 0.9427; train_kl_reg_loss: 49288.3753; train_edge_recon_loss: 2657571.9389; train_gene_expr_recon_loss: 10209061.3740; train_masked_gp_l1_reg_loss: 57763.8313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71490.9317; train_chrom_access_recon_loss: 8767357.8282; train_global_loss: 21812534.1527; train_optim_loss: 21812534.1527; val_kl_reg_loss: 47560.7974; val_edge_recon_loss: 2668399.7667; val_gene_expr_recon_loss: 10122655.7333; val_masked_gp_l1_reg_loss: 57705.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71327.2578; val_chrom_access_recon_loss: 8668748.6333; val_global_loss: 21636397.0667; val_optim_loss: 21636397.0667
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9785; val_auprc_score: 0.9704; val_best_acc_score: 0.9400; val_best_f1_score: 0.9413; train_kl_reg_loss: 49253.1929; train_edge_recon_loss: 2656513.4599; train_gene_expr_recon_loss: 10200427.4427; train_masked_gp_l1_reg_loss: 57457.6015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71517.4948; train_chrom_access_recon_loss: 8763862.8740; train_global_loss: 21799032.0611; train_optim_loss: 21799032.0611; val_kl_reg_loss: 49260.6927; val_edge_recon_loss: 2664130.5333; val_gene_expr_recon_loss: 10131063.4000; val_masked_gp_l1_reg_loss: 57376.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71725.7500; val_chrom_access_recon_loss: 8706291.5000; val_global_loss: 21679848.1333; val_optim_loss: 21679848.1333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9790; val_auprc_score: 0.9726; val_best_acc_score: 0.9387; val_best_f1_score: 0.9401; train_kl_reg_loss: 49599.8696; train_edge_recon_loss: 2656469.5248; train_gene_expr_recon_loss: 10191436.2595; train_masked_gp_l1_reg_loss: 57197.8316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71515.7725; train_chrom_access_recon_loss: 8760870.1908; train_global_loss: 21787089.5115; train_optim_loss: 21787089.5115; val_kl_reg_loss: 48944.6562; val_edge_recon_loss: 2664420.4167; val_gene_expr_recon_loss: 10141604.8667; val_masked_gp_l1_reg_loss: 57035.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71514.1250; val_chrom_access_recon_loss: 8685366.7333; val_global_loss: 21668886.6667; val_optim_loss: 21668886.6667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9814; val_auprc_score: 0.9736; val_best_acc_score: 0.9413; val_best_f1_score: 0.9430; train_kl_reg_loss: 49770.6500; train_edge_recon_loss: 2654077.2347; train_gene_expr_recon_loss: 10186456.4198; train_masked_gp_l1_reg_loss: 56908.0080; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71435.9916; train_chrom_access_recon_loss: 8750754.6107; train_global_loss: 21769402.9618; train_optim_loss: 21769402.9618; val_kl_reg_loss: 49308.0458; val_edge_recon_loss: 2654114.3167; val_gene_expr_recon_loss: 10098270.2000; val_masked_gp_l1_reg_loss: 56757.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70918.8906; val_chrom_access_recon_loss: 8676699.6000; val_global_loss: 21606068.2667; val_optim_loss: 21606068.2667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9773; val_auprc_score: 0.9654; val_best_acc_score: 0.9402; val_best_f1_score: 0.9416; train_kl_reg_loss: 49028.2587; train_edge_recon_loss: 2655883.1546; train_gene_expr_recon_loss: 10179494.7252; train_masked_gp_l1_reg_loss: 56643.8579; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71405.4571; train_chrom_access_recon_loss: 8743398.6107; train_global_loss: 21755854.0153; train_optim_loss: 21755854.0153; val_kl_reg_loss: 46789.9148; val_edge_recon_loss: 2663541.0667; val_gene_expr_recon_loss: 10133875.5333; val_masked_gp_l1_reg_loss: 56487.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71771.3984; val_chrom_access_recon_loss: 8707606.0667; val_global_loss: 21680071.6000; val_optim_loss: 21680071.6000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9816; val_auprc_score: 0.9762; val_best_acc_score: 0.9422; val_best_f1_score: 0.9435; train_kl_reg_loss: 49185.2242; train_edge_recon_loss: 2656742.4275; train_gene_expr_recon_loss: 10182947.1145; train_masked_gp_l1_reg_loss: 56451.7697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71543.8753; train_chrom_access_recon_loss: 8753115.0038; train_global_loss: 21769985.2977; train_optim_loss: 21769985.2977; val_kl_reg_loss: 46171.7932; val_edge_recon_loss: 2677402.7667; val_gene_expr_recon_loss: 10124763.0667; val_masked_gp_l1_reg_loss: 56335.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71426.1406; val_chrom_access_recon_loss: 8662810.3667; val_global_loss: 21638909.3333; val_optim_loss: 21638909.3333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9846; val_auprc_score: 0.9803; val_best_acc_score: 0.9454; val_best_f1_score: 0.9466; train_kl_reg_loss: 47874.0788; train_edge_recon_loss: 2657112.7042; train_gene_expr_recon_loss: 10183529.1908; train_masked_gp_l1_reg_loss: 56311.6201; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71605.9442; train_chrom_access_recon_loss: 8738610.4924; train_global_loss: 21755043.9542; train_optim_loss: 21755043.9542; val_kl_reg_loss: 46431.1971; val_edge_recon_loss: 2643039.2667; val_gene_expr_recon_loss: 10117705.9333; val_masked_gp_l1_reg_loss: 56198.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71251.9219; val_chrom_access_recon_loss: 8674071.4667; val_global_loss: 21608697.7333; val_optim_loss: 21608697.7333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9828; val_auprc_score: 0.9781; val_best_acc_score: 0.9456; val_best_f1_score: 0.9470; train_kl_reg_loss: 48746.9375; train_edge_recon_loss: 2649014.5916; train_gene_expr_recon_loss: 10166178.3740; train_masked_gp_l1_reg_loss: 56040.9309; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71498.6047; train_chrom_access_recon_loss: 8731964.0763; train_global_loss: 21723443.4962; train_optim_loss: 21723443.4962; val_kl_reg_loss: 45972.2219; val_edge_recon_loss: 2660216.5333; val_gene_expr_recon_loss: 10151536.6000; val_masked_gp_l1_reg_loss: 55934.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71306.8516; val_chrom_access_recon_loss: 8693025.9000; val_global_loss: 21677992.5333; val_optim_loss: 21677992.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9848; val_auprc_score: 0.9804; val_best_acc_score: 0.9496; val_best_f1_score: 0.9508; train_kl_reg_loss: 49343.3952; train_edge_recon_loss: 2649628.2061; train_gene_expr_recon_loss: 10171804.5802; train_masked_gp_l1_reg_loss: 55463.1647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60152.4893; train_chrom_access_recon_loss: 8729234.5115; train_global_loss: 21715626.3359; train_optim_loss: 21715626.3359; val_kl_reg_loss: 49022.9234; val_edge_recon_loss: 2647976.7833; val_gene_expr_recon_loss: 10070980.8667; val_masked_gp_l1_reg_loss: 55291.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58431.1445; val_chrom_access_recon_loss: 8641568.1667; val_global_loss: 21523271.8667; val_optim_loss: 21523271.8667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9827; val_auprc_score: 0.9758; val_best_acc_score: 0.9464; val_best_f1_score: 0.9472; train_kl_reg_loss: 51122.2116; train_edge_recon_loss: 2646274.9504; train_gene_expr_recon_loss: 10156921.0382; train_masked_gp_l1_reg_loss: 55239.0628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58054.6141; train_chrom_access_recon_loss: 8718559.1527; train_global_loss: 21686171.0229; train_optim_loss: 21686171.0229; val_kl_reg_loss: 49515.6167; val_edge_recon_loss: 2652169.4167; val_gene_expr_recon_loss: 10052764.2667; val_masked_gp_l1_reg_loss: 55187.4883; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57618.7695; val_chrom_access_recon_loss: 8623094.3333; val_global_loss: 21490349.8667; val_optim_loss: 21490349.8667
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9807; val_auprc_score: 0.9736; val_best_acc_score: 0.9435; val_best_f1_score: 0.9447; train_kl_reg_loss: 51264.2409; train_edge_recon_loss: 2647969.3969; train_gene_expr_recon_loss: 10161834.3511; train_masked_gp_l1_reg_loss: 55158.2657; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57470.1556; train_chrom_access_recon_loss: 8717309.4237; train_global_loss: 21691005.9237; train_optim_loss: 21691005.9237; val_kl_reg_loss: 49012.0393; val_edge_recon_loss: 2656630.8833; val_gene_expr_recon_loss: 10060526.6000; val_masked_gp_l1_reg_loss: 55113.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57255.9531; val_chrom_access_recon_loss: 8592493.6333; val_global_loss: 21471032.4000; val_optim_loss: 21471032.4000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9843; val_auprc_score: 0.9789; val_best_acc_score: 0.9475; val_best_f1_score: 0.9485; train_kl_reg_loss: 51132.2989; train_edge_recon_loss: 2654519.3111; train_gene_expr_recon_loss: 10166367.7786; train_masked_gp_l1_reg_loss: 55091.0397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57115.8126; train_chrom_access_recon_loss: 8730311.7214; train_global_loss: 21714537.9084; train_optim_loss: 21714537.9084; val_kl_reg_loss: 49509.6135; val_edge_recon_loss: 2655215.8333; val_gene_expr_recon_loss: 10111597.4000; val_masked_gp_l1_reg_loss: 55072.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56956.0820; val_chrom_access_recon_loss: 8678398.7667; val_global_loss: 21606749.7333; val_optim_loss: 21606749.7333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9836; val_auprc_score: 0.9798; val_best_acc_score: 0.9423; val_best_f1_score: 0.9440; train_kl_reg_loss: 51765.5869; train_edge_recon_loss: 2641302.4828; train_gene_expr_recon_loss: 10156003.2214; train_masked_gp_l1_reg_loss: 55054.5993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56834.1029; train_chrom_access_recon_loss: 8725600.5305; train_global_loss: 21686560.5191; train_optim_loss: 21686560.5191; val_kl_reg_loss: 50357.7664; val_edge_recon_loss: 2651887.7833; val_gene_expr_recon_loss: 10074422.2667; val_masked_gp_l1_reg_loss: 55023.5586; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56670.0312; val_chrom_access_recon_loss: 8635475.0667; val_global_loss: 21523836.6667; val_optim_loss: 21523836.6667
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9828; val_auprc_score: 0.9777; val_best_acc_score: 0.9446; val_best_f1_score: 0.9462; train_kl_reg_loss: 51903.7126; train_edge_recon_loss: 2643478.8034; train_gene_expr_recon_loss: 10161888.0076; train_masked_gp_l1_reg_loss: 54989.5571; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56521.3826; train_chrom_access_recon_loss: 8719673.2557; train_global_loss: 21688454.7786; train_optim_loss: 21688454.7786; val_kl_reg_loss: 50722.9331; val_edge_recon_loss: 2663232.5167; val_gene_expr_recon_loss: 10097130.7333; val_masked_gp_l1_reg_loss: 54970.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56420.3555; val_chrom_access_recon_loss: 8652101.6333; val_global_loss: 21574577.6000; val_optim_loss: 21574577.6000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9825; val_auprc_score: 0.9747; val_best_acc_score: 0.9485; val_best_f1_score: 0.9493; train_kl_reg_loss: 51507.7930; train_edge_recon_loss: 2648190.9847; train_gene_expr_recon_loss: 10158234.9542; train_masked_gp_l1_reg_loss: 54947.7383; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56301.5835; train_chrom_access_recon_loss: 8724279.9237; train_global_loss: 21693462.8855; train_optim_loss: 21693462.8855; val_kl_reg_loss: 49398.3784; val_edge_recon_loss: 2659377.9667; val_gene_expr_recon_loss: 10096467.7333; val_masked_gp_l1_reg_loss: 54931.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56196.2852; val_chrom_access_recon_loss: 8625526.8333; val_global_loss: 21541898.0000; val_optim_loss: 21541898.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9831; val_auprc_score: 0.9747; val_best_acc_score: 0.9465; val_best_f1_score: 0.9475; train_kl_reg_loss: 51129.6321; train_edge_recon_loss: 2646364.0992; train_gene_expr_recon_loss: 10160033.0763; train_masked_gp_l1_reg_loss: 54883.1000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55054.9424; train_chrom_access_recon_loss: 8719038.8282; train_global_loss: 21686503.7252; train_optim_loss: 21686503.7252; val_kl_reg_loss: 49860.4690; val_edge_recon_loss: 2647012.2000; val_gene_expr_recon_loss: 10117861.0667; val_masked_gp_l1_reg_loss: 54863.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54866.3945; val_chrom_access_recon_loss: 8641487.1667; val_global_loss: 21565950.8000; val_optim_loss: 21565950.8000
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9846; val_auprc_score: 0.9802; val_best_acc_score: 0.9501; val_best_f1_score: 0.9510; train_kl_reg_loss: 51240.2685; train_edge_recon_loss: 2646168.8092; train_gene_expr_recon_loss: 10165351.0534; train_masked_gp_l1_reg_loss: 54856.7445; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54805.6847; train_chrom_access_recon_loss: 8732498.6298; train_global_loss: 21704921.1603; train_optim_loss: 21704921.1603; val_kl_reg_loss: 49936.9911; val_edge_recon_loss: 2657436.4167; val_gene_expr_recon_loss: 10110606.5333; val_masked_gp_l1_reg_loss: 54849.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54752.6562; val_chrom_access_recon_loss: 8660967.5333; val_global_loss: 21588550.5333; val_optim_loss: 21588550.5333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9827; val_auprc_score: 0.9763; val_best_acc_score: 0.9454; val_best_f1_score: 0.9465; train_kl_reg_loss: 51388.5326; train_edge_recon_loss: 2646264.2767; train_gene_expr_recon_loss: 10153058.4198; train_masked_gp_l1_reg_loss: 54844.8061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54713.7262; train_chrom_access_recon_loss: 8719863.0191; train_global_loss: 21680132.8244; train_optim_loss: 21680132.8244; val_kl_reg_loss: 49914.7862; val_edge_recon_loss: 2655839.2333; val_gene_expr_recon_loss: 10104934.9333; val_masked_gp_l1_reg_loss: 54841.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54675.6836; val_chrom_access_recon_loss: 8680970.7667; val_global_loss: 21601176.5333; val_optim_loss: 21601176.5333
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9835; val_auprc_score: 0.9767; val_best_acc_score: 0.9466; val_best_f1_score: 0.9470; train_kl_reg_loss: 51329.9325; train_edge_recon_loss: 2645413.0019; train_gene_expr_recon_loss: 10154088.4275; train_masked_gp_l1_reg_loss: 54838.7131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54647.9148; train_chrom_access_recon_loss: 8711013.8550; train_global_loss: 21671331.8931; train_optim_loss: 21671331.8931; val_kl_reg_loss: 49782.2677; val_edge_recon_loss: 2667432.4500; val_gene_expr_recon_loss: 10057334.4000; val_masked_gp_l1_reg_loss: 54834.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54620.6328; val_chrom_access_recon_loss: 8615119.3667; val_global_loss: 21499123.6000; val_optim_loss: 21499123.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 43 min 37 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9824
val AUPRC score: 0.9776
val best accuracy score: 0.9442
val best F1 score: 0.9452
val target rna MSE score: 1.6411
val source rna MSE score: 0.5042
val target atac MSE score: 0.3344
val source atac MSE score: 0.1032
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
