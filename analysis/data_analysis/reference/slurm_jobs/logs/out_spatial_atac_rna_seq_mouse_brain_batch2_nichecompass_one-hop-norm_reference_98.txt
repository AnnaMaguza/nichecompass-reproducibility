[True]
Run timestamp: 10102023_011237_98.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_98']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7610; val_auprc_score: 0.7866; val_best_acc_score: 0.5415; val_best_f1_score: 0.6823; train_kl_reg_loss: 53037.7135; train_edge_recon_loss: 3503182.7844; train_gene_expr_recon_loss: 13467672.6641; train_masked_gp_l1_reg_loss: 91658.1766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1922181.8354; train_chrom_access_recon_loss: 4794637.0229; train_global_loss: 23832370.3206; train_optim_loss: 23832370.3206; val_kl_reg_loss: 92751.2917; val_edge_recon_loss: 4062879.4333; val_gene_expr_recon_loss: 12607320.9333; val_masked_gp_l1_reg_loss: 84733.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 441711.9375; val_chrom_access_recon_loss: 4585219.0667; val_global_loss: 21874615.6000; val_optim_loss: 21874615.6000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8038; val_auprc_score: 0.8214; val_best_acc_score: 0.6933; val_best_f1_score: 0.7353; train_kl_reg_loss: 73380.7559; train_edge_recon_loss: 3498206.4523; train_gene_expr_recon_loss: 12566987.0611; train_masked_gp_l1_reg_loss: 82232.4102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 240828.1862; train_chrom_access_recon_loss: 4585379.5172; train_global_loss: 21047014.4427; train_optim_loss: 21047014.4427; val_kl_reg_loss: 68327.6219; val_edge_recon_loss: 4043296.0500; val_gene_expr_recon_loss: 12393795.8667; val_masked_gp_l1_reg_loss: 81836.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 148035.3906; val_chrom_access_recon_loss: 4513898.9333; val_global_loss: 21249190.2667; val_optim_loss: 21249190.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8630; val_auprc_score: 0.8541; val_best_acc_score: 0.7784; val_best_f1_score: 0.7959; train_kl_reg_loss: 57730.2200; train_edge_recon_loss: 3396599.8073; train_gene_expr_recon_loss: 12421109.8092; train_masked_gp_l1_reg_loss: 85809.1861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116800.6685; train_chrom_access_recon_loss: 4539069.9771; train_global_loss: 20617119.6641; train_optim_loss: 20617119.6641; val_kl_reg_loss: 46315.1047; val_edge_recon_loss: 3273881.0000; val_gene_expr_recon_loss: 12274102.2667; val_masked_gp_l1_reg_loss: 99655.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100856.4453; val_chrom_access_recon_loss: 4469080.2500; val_global_loss: 20263889.4667; val_optim_loss: 20263889.4667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8908; val_auprc_score: 0.8743; val_best_acc_score: 0.8103; val_best_f1_score: 0.8264; train_kl_reg_loss: 73142.7652; train_edge_recon_loss: 2968713.8569; train_gene_expr_recon_loss: 12312883.2366; train_masked_gp_l1_reg_loss: 100754.7354; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91856.6953; train_chrom_access_recon_loss: 4497290.0038; train_global_loss: 20044641.2366; train_optim_loss: 20044641.2366; val_kl_reg_loss: 76138.7047; val_edge_recon_loss: 2889153.3500; val_gene_expr_recon_loss: 12119771.7333; val_masked_gp_l1_reg_loss: 100655.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86839.0859; val_chrom_access_recon_loss: 4430954.1000; val_global_loss: 19703512.0000; val_optim_loss: 19703512.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9090; val_auprc_score: 0.8925; val_best_acc_score: 0.8370; val_best_f1_score: 0.8482; train_kl_reg_loss: 86290.9688; train_edge_recon_loss: 2852515.3817; train_gene_expr_recon_loss: 12160176.8168; train_masked_gp_l1_reg_loss: 100888.9284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80851.9943; train_chrom_access_recon_loss: 4451370.7271; train_global_loss: 19732094.8244; train_optim_loss: 19732094.8244; val_kl_reg_loss: 86418.5005; val_edge_recon_loss: 2844042.2333; val_gene_expr_recon_loss: 12024343.2667; val_masked_gp_l1_reg_loss: 101486.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76959.2344; val_chrom_access_recon_loss: 4417038.6833; val_global_loss: 19550287.7333; val_optim_loss: 19550287.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9149; val_auprc_score: 0.8995; val_best_acc_score: 0.8424; val_best_f1_score: 0.8555; train_kl_reg_loss: 88530.4914; train_edge_recon_loss: 2819159.1527; train_gene_expr_recon_loss: 12056688.7176; train_masked_gp_l1_reg_loss: 102462.6241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75489.0697; train_chrom_access_recon_loss: 4420171.5248; train_global_loss: 19562501.6031; train_optim_loss: 19562501.6031; val_kl_reg_loss: 83177.0490; val_edge_recon_loss: 2822230.2167; val_gene_expr_recon_loss: 11929848.4000; val_masked_gp_l1_reg_loss: 103207.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74866.1250; val_chrom_access_recon_loss: 4391276.1333; val_global_loss: 19404604.8000; val_optim_loss: 19404604.8000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9222; val_auprc_score: 0.9059; val_best_acc_score: 0.8469; val_best_f1_score: 0.8565; train_kl_reg_loss: 83239.8155; train_edge_recon_loss: 2805491.3225; train_gene_expr_recon_loss: 11964430.4504; train_masked_gp_l1_reg_loss: 104003.9565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73873.2051; train_chrom_access_recon_loss: 4392112.7118; train_global_loss: 19423151.4198; train_optim_loss: 19423151.4198; val_kl_reg_loss: 84963.7094; val_edge_recon_loss: 2799015.3167; val_gene_expr_recon_loss: 11842520.8000; val_masked_gp_l1_reg_loss: 104690.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72462.1641; val_chrom_access_recon_loss: 4350533.6000; val_global_loss: 19254186.6667; val_optim_loss: 19254186.6667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9199; val_auprc_score: 0.9065; val_best_acc_score: 0.8517; val_best_f1_score: 0.8614; train_kl_reg_loss: 83490.2198; train_edge_recon_loss: 2793906.7023; train_gene_expr_recon_loss: 11891282.2443; train_masked_gp_l1_reg_loss: 105205.4840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71753.1148; train_chrom_access_recon_loss: 4366542.3225; train_global_loss: 19312180.0763; train_optim_loss: 19312180.0763; val_kl_reg_loss: 82597.1854; val_edge_recon_loss: 2816740.0000; val_gene_expr_recon_loss: 11748746.6000; val_masked_gp_l1_reg_loss: 105595.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70058.4609; val_chrom_access_recon_loss: 4318168.5500; val_global_loss: 19141906.4000; val_optim_loss: 19141906.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9252; val_auprc_score: 0.9125; val_best_acc_score: 0.8549; val_best_f1_score: 0.8633; train_kl_reg_loss: 81209.7664; train_edge_recon_loss: 2776190.4962; train_gene_expr_recon_loss: 11830936.2290; train_masked_gp_l1_reg_loss: 105956.2741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69948.4747; train_chrom_access_recon_loss: 4346252.2405; train_global_loss: 19210493.4656; train_optim_loss: 19210493.4656; val_kl_reg_loss: 82550.2953; val_edge_recon_loss: 2834175.6833; val_gene_expr_recon_loss: 11738755.4667; val_masked_gp_l1_reg_loss: 106351.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69177.4688; val_chrom_access_recon_loss: 4320528.1333; val_global_loss: 19151538.8000; val_optim_loss: 19151538.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9276; val_auprc_score: 0.9131; val_best_acc_score: 0.8534; val_best_f1_score: 0.8619; train_kl_reg_loss: 81100.8426; train_edge_recon_loss: 2778052.8511; train_gene_expr_recon_loss: 11761513.7328; train_masked_gp_l1_reg_loss: 106821.6352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68439.5075; train_chrom_access_recon_loss: 4321174.8359; train_global_loss: 19117103.4504; train_optim_loss: 19117103.4504; val_kl_reg_loss: 80830.4958; val_edge_recon_loss: 2808290.0500; val_gene_expr_recon_loss: 11672777.7333; val_masked_gp_l1_reg_loss: 106958.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67575.3906; val_chrom_access_recon_loss: 4289021.7167; val_global_loss: 19025453.8667; val_optim_loss: 19025453.8667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9388; val_auprc_score: 0.9244; val_best_acc_score: 0.8731; val_best_f1_score: 0.8785; train_kl_reg_loss: 77733.3555; train_edge_recon_loss: 2771109.1756; train_gene_expr_recon_loss: 11720515.7710; train_masked_gp_l1_reg_loss: 107362.6588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66933.3375; train_chrom_access_recon_loss: 4304218.7462; train_global_loss: 19047872.9924; train_optim_loss: 19047872.9924; val_kl_reg_loss: 76210.4630; val_edge_recon_loss: 2768596.8167; val_gene_expr_recon_loss: 11589668.6667; val_masked_gp_l1_reg_loss: 107923.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66619.6875; val_chrom_access_recon_loss: 4257808.0500; val_global_loss: 18866827.8667; val_optim_loss: 18866827.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9402; val_auprc_score: 0.9265; val_best_acc_score: 0.8763; val_best_f1_score: 0.8829; train_kl_reg_loss: 77996.1365; train_edge_recon_loss: 2753851.3206; train_gene_expr_recon_loss: 11675674.8855; train_masked_gp_l1_reg_loss: 108082.3789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65245.3486; train_chrom_access_recon_loss: 4285879.1202; train_global_loss: 18966729.2824; train_optim_loss: 18966729.2824; val_kl_reg_loss: 75752.5068; val_edge_recon_loss: 2786038.5833; val_gene_expr_recon_loss: 11568954.5333; val_masked_gp_l1_reg_loss: 108521.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65589.0703; val_chrom_access_recon_loss: 4241090.9667; val_global_loss: 18845946.5333; val_optim_loss: 18845946.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9434; val_auprc_score: 0.9321; val_best_acc_score: 0.8752; val_best_f1_score: 0.8837; train_kl_reg_loss: 77173.5559; train_edge_recon_loss: 2743117.8340; train_gene_expr_recon_loss: 11623253.0763; train_masked_gp_l1_reg_loss: 108576.7549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64101.1291; train_chrom_access_recon_loss: 4264459.1317; train_global_loss: 18880681.4656; train_optim_loss: 18880681.4656; val_kl_reg_loss: 75215.5505; val_edge_recon_loss: 2764369.2667; val_gene_expr_recon_loss: 11525333.0000; val_masked_gp_l1_reg_loss: 109086.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63712.9727; val_chrom_access_recon_loss: 4215287.7833; val_global_loss: 18753004.8000; val_optim_loss: 18753004.8000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9510; val_auprc_score: 0.9371; val_best_acc_score: 0.8887; val_best_f1_score: 0.8937; train_kl_reg_loss: 78319.1560; train_edge_recon_loss: 2733065.5057; train_gene_expr_recon_loss: 11577754.1374; train_masked_gp_l1_reg_loss: 108790.7660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62634.2851; train_chrom_access_recon_loss: 4245535.6336; train_global_loss: 18806099.6031; train_optim_loss: 18806099.6031; val_kl_reg_loss: 75274.5906; val_edge_recon_loss: 2749741.6833; val_gene_expr_recon_loss: 11490589.8000; val_masked_gp_l1_reg_loss: 109086.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62546.8516; val_chrom_access_recon_loss: 4221941.8167; val_global_loss: 18709180.9333; val_optim_loss: 18709180.9333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9577; val_auprc_score: 0.9478; val_best_acc_score: 0.9007; val_best_f1_score: 0.9051; train_kl_reg_loss: 77017.6403; train_edge_recon_loss: 2725301.9313; train_gene_expr_recon_loss: 11542640.1450; train_masked_gp_l1_reg_loss: 108881.8328; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61699.9941; train_chrom_access_recon_loss: 4235808.7290; train_global_loss: 18751350.3664; train_optim_loss: 18751350.3664; val_kl_reg_loss: 74845.5667; val_edge_recon_loss: 2716021.2667; val_gene_expr_recon_loss: 11479665.2667; val_masked_gp_l1_reg_loss: 108894.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61277.3867; val_chrom_access_recon_loss: 4197079.5167; val_global_loss: 18637782.6667; val_optim_loss: 18637782.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9554; val_auprc_score: 0.9444; val_best_acc_score: 0.8953; val_best_f1_score: 0.9006; train_kl_reg_loss: 75590.6486; train_edge_recon_loss: 2728860.7615; train_gene_expr_recon_loss: 11516287.0305; train_masked_gp_l1_reg_loss: 108940.0936; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60585.9601; train_chrom_access_recon_loss: 4222187.4408; train_global_loss: 18712451.8931; train_optim_loss: 18712451.8931; val_kl_reg_loss: 72183.4802; val_edge_recon_loss: 2740620.7833; val_gene_expr_recon_loss: 11407140.0000; val_masked_gp_l1_reg_loss: 108906.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59898.7891; val_chrom_access_recon_loss: 4168540.8500; val_global_loss: 18557291.2000; val_optim_loss: 18557291.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9608; val_auprc_score: 0.9521; val_best_acc_score: 0.9042; val_best_f1_score: 0.9083; train_kl_reg_loss: 75103.9193; train_edge_recon_loss: 2709736.3034; train_gene_expr_recon_loss: 11492262.7176; train_masked_gp_l1_reg_loss: 108883.1846; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59727.8670; train_chrom_access_recon_loss: 4210732.5706; train_global_loss: 18656446.6260; train_optim_loss: 18656446.6260; val_kl_reg_loss: 75146.6135; val_edge_recon_loss: 2712434.5167; val_gene_expr_recon_loss: 11469327.0667; val_masked_gp_l1_reg_loss: 109035.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59704.4492; val_chrom_access_recon_loss: 4198426.2000; val_global_loss: 18624073.2000; val_optim_loss: 18624073.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9583; val_auprc_score: 0.9484; val_best_acc_score: 0.8980; val_best_f1_score: 0.9018; train_kl_reg_loss: 75162.8389; train_edge_recon_loss: 2707918.3282; train_gene_expr_recon_loss: 11467800.1603; train_masked_gp_l1_reg_loss: 108697.1199; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59145.8305; train_chrom_access_recon_loss: 4200313.0897; train_global_loss: 18619037.3588; train_optim_loss: 18619037.3588; val_kl_reg_loss: 73515.6255; val_edge_recon_loss: 2737271.8000; val_gene_expr_recon_loss: 11353503.7333; val_masked_gp_l1_reg_loss: 108851.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58909.8711; val_chrom_access_recon_loss: 4145814.1833; val_global_loss: 18477867.4667; val_optim_loss: 18477867.4667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9626; val_auprc_score: 0.9510; val_best_acc_score: 0.9100; val_best_f1_score: 0.9148; train_kl_reg_loss: 74723.9501; train_edge_recon_loss: 2705157.0191; train_gene_expr_recon_loss: 11432276.3664; train_masked_gp_l1_reg_loss: 108581.3971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58438.5602; train_chrom_access_recon_loss: 4184623.5592; train_global_loss: 18563800.9771; train_optim_loss: 18563800.9771; val_kl_reg_loss: 73942.6505; val_edge_recon_loss: 2718634.7833; val_gene_expr_recon_loss: 11326243.0000; val_masked_gp_l1_reg_loss: 108912.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59033.4883; val_chrom_access_recon_loss: 4171914.1167; val_global_loss: 18458680.5333; val_optim_loss: 18458680.5333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9619; val_auprc_score: 0.9494; val_best_acc_score: 0.9081; val_best_f1_score: 0.9106; train_kl_reg_loss: 75044.1337; train_edge_recon_loss: 2706451.8912; train_gene_expr_recon_loss: 11406954.9924; train_masked_gp_l1_reg_loss: 108449.6761; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58142.5819; train_chrom_access_recon_loss: 4174053.9427; train_global_loss: 18529097.2519; train_optim_loss: 18529097.2519; val_kl_reg_loss: 74638.7146; val_edge_recon_loss: 2713374.2833; val_gene_expr_recon_loss: 11292320.4667; val_masked_gp_l1_reg_loss: 108395.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58067.6406; val_chrom_access_recon_loss: 4124597.1667; val_global_loss: 18371394.6667; val_optim_loss: 18371394.6667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9672; val_auprc_score: 0.9588; val_best_acc_score: 0.9157; val_best_f1_score: 0.9180; train_kl_reg_loss: 74108.5190; train_edge_recon_loss: 2703092.3893; train_gene_expr_recon_loss: 11384594.5725; train_masked_gp_l1_reg_loss: 108251.7915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57851.9553; train_chrom_access_recon_loss: 4170240.9370; train_global_loss: 18498140.2137; train_optim_loss: 18498140.2137; val_kl_reg_loss: 72735.1557; val_edge_recon_loss: 2711014.5167; val_gene_expr_recon_loss: 11290893.0000; val_masked_gp_l1_reg_loss: 108332.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57731.4414; val_chrom_access_recon_loss: 4150043.9333; val_global_loss: 18390750.9333; val_optim_loss: 18390750.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9665; val_auprc_score: 0.9547; val_best_acc_score: 0.9134; val_best_f1_score: 0.9170; train_kl_reg_loss: 72265.7728; train_edge_recon_loss: 2704979.4122; train_gene_expr_recon_loss: 11374073.2061; train_masked_gp_l1_reg_loss: 108232.6703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57635.9537; train_chrom_access_recon_loss: 4154672.7977; train_global_loss: 18471859.8321; train_optim_loss: 18471859.8321; val_kl_reg_loss: 69832.7651; val_edge_recon_loss: 2716517.0000; val_gene_expr_recon_loss: 11367866.3333; val_masked_gp_l1_reg_loss: 108424.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57432.6367; val_chrom_access_recon_loss: 4144021.1833; val_global_loss: 18464095.0667; val_optim_loss: 18464095.0667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9685; val_auprc_score: 0.9620; val_best_acc_score: 0.9134; val_best_f1_score: 0.9160; train_kl_reg_loss: 73976.9868; train_edge_recon_loss: 2700147.6584; train_gene_expr_recon_loss: 11369255.2366; train_masked_gp_l1_reg_loss: 108193.8120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57399.0317; train_chrom_access_recon_loss: 4151148.5573; train_global_loss: 18460121.2519; train_optim_loss: 18460121.2519; val_kl_reg_loss: 73475.3250; val_edge_recon_loss: 2711388.6167; val_gene_expr_recon_loss: 11319049.9333; val_masked_gp_l1_reg_loss: 107815.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57812.6953; val_chrom_access_recon_loss: 4138885.2000; val_global_loss: 18408427.0667; val_optim_loss: 18408427.0667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9671; val_auprc_score: 0.9570; val_best_acc_score: 0.9166; val_best_f1_score: 0.9197; train_kl_reg_loss: 73910.9584; train_edge_recon_loss: 2692318.2462; train_gene_expr_recon_loss: 11343217.1221; train_masked_gp_l1_reg_loss: 107860.4525; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57457.7303; train_chrom_access_recon_loss: 4139602.1584; train_global_loss: 18414366.7176; train_optim_loss: 18414366.7176; val_kl_reg_loss: 74960.2854; val_edge_recon_loss: 2707833.6333; val_gene_expr_recon_loss: 11293300.9333; val_masked_gp_l1_reg_loss: 107902.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57500.3281; val_chrom_access_recon_loss: 4126287.1833; val_global_loss: 18367784.9333; val_optim_loss: 18367784.9333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9653; val_auprc_score: 0.9530; val_best_acc_score: 0.9154; val_best_f1_score: 0.9175; train_kl_reg_loss: 73318.5428; train_edge_recon_loss: 2694741.3950; train_gene_expr_recon_loss: 11335104.8931; train_masked_gp_l1_reg_loss: 107804.0903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57419.8636; train_chrom_access_recon_loss: 4133597.5496; train_global_loss: 18401986.4122; train_optim_loss: 18401986.4122; val_kl_reg_loss: 75293.4125; val_edge_recon_loss: 2708026.1333; val_gene_expr_recon_loss: 11288727.4667; val_masked_gp_l1_reg_loss: 107492.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57483.6836; val_chrom_access_recon_loss: 4113550.0000; val_global_loss: 18350574.0000; val_optim_loss: 18350574.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9631; val_auprc_score: 0.9537; val_best_acc_score: 0.9072; val_best_f1_score: 0.9107; train_kl_reg_loss: 98462.8011; train_edge_recon_loss: 2770740.2156; train_gene_expr_recon_loss: 10390117.3664; train_masked_gp_l1_reg_loss: 106292.6877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54121.4793; train_chrom_access_recon_loss: 3856409.4160; train_global_loss: 17276144.0840; train_optim_loss: 17276144.0840; val_kl_reg_loss: 30459.9115; val_edge_recon_loss: 2756169.3167; val_gene_expr_recon_loss: 10287559.1333; val_masked_gp_l1_reg_loss: 105642.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55091.5547; val_chrom_access_recon_loss: 3803649.0833; val_global_loss: 17038572.4667; val_optim_loss: 17038572.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9702; val_auprc_score: 0.9644; val_best_acc_score: 0.9177; val_best_f1_score: 0.9203; train_kl_reg_loss: 78825.1411; train_edge_recon_loss: 2721107.8626; train_gene_expr_recon_loss: 10357604.4885; train_masked_gp_l1_reg_loss: 105022.4003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55272.1274; train_chrom_access_recon_loss: 3839126.7252; train_global_loss: 17156958.6794; train_optim_loss: 17156958.6794; val_kl_reg_loss: 35087.0352; val_edge_recon_loss: 2735841.8167; val_gene_expr_recon_loss: 10276852.8667; val_masked_gp_l1_reg_loss: 104207.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55774.8828; val_chrom_access_recon_loss: 3826807.6833; val_global_loss: 17034571.2000; val_optim_loss: 17034571.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9698; val_auprc_score: 0.9620; val_best_acc_score: 0.9208; val_best_f1_score: 0.9239; train_kl_reg_loss: 67924.8742; train_edge_recon_loss: 2700778.5534; train_gene_expr_recon_loss: 10332827.0840; train_masked_gp_l1_reg_loss: 103284.8433; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55851.2115; train_chrom_access_recon_loss: 3828628.3740; train_global_loss: 17089294.9695; train_optim_loss: 17089294.9695; val_kl_reg_loss: 37893.8607; val_edge_recon_loss: 2713946.3500; val_gene_expr_recon_loss: 10271392.6667; val_masked_gp_l1_reg_loss: 102221.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56117.6328; val_chrom_access_recon_loss: 3797218.7333; val_global_loss: 16978791.6000; val_optim_loss: 16978791.6000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9674; val_auprc_score: 0.9553; val_best_acc_score: 0.9163; val_best_f1_score: 0.9189; train_kl_reg_loss: 64738.2971; train_edge_recon_loss: 2699818.0076; train_gene_expr_recon_loss: 10327425.2977; train_masked_gp_l1_reg_loss: 100950.4854; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56050.7096; train_chrom_access_recon_loss: 3826589.1908; train_global_loss: 17075572.0153; train_optim_loss: 17075572.0153; val_kl_reg_loss: 41319.8932; val_edge_recon_loss: 2711199.5833; val_gene_expr_recon_loss: 10238675.0000; val_masked_gp_l1_reg_loss: 99630.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56172.9180; val_chrom_access_recon_loss: 3802216.2833; val_global_loss: 16949214.2000; val_optim_loss: 16949214.2000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9730; val_auprc_score: 0.9648; val_best_acc_score: 0.9266; val_best_f1_score: 0.9288; train_kl_reg_loss: 60982.6603; train_edge_recon_loss: 2690555.3454; train_gene_expr_recon_loss: 10312941.4046; train_masked_gp_l1_reg_loss: 98464.4883; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56127.4277; train_chrom_access_recon_loss: 3811571.1718; train_global_loss: 17030642.4122; train_optim_loss: 17030642.4122; val_kl_reg_loss: 42735.7388; val_edge_recon_loss: 2688998.2500; val_gene_expr_recon_loss: 10284363.0667; val_masked_gp_l1_reg_loss: 97446.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56218.1094; val_chrom_access_recon_loss: 3797347.9333; val_global_loss: 16967108.8667; val_optim_loss: 16967108.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9704; val_auprc_score: 0.9595; val_best_acc_score: 0.9236; val_best_f1_score: 0.9262; train_kl_reg_loss: 58993.6497; train_edge_recon_loss: 2690018.9790; train_gene_expr_recon_loss: 10301509.5344; train_masked_gp_l1_reg_loss: 96337.7548; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55990.0504; train_chrom_access_recon_loss: 3810780.7863; train_global_loss: 17013630.7481; train_optim_loss: 17013630.7481; val_kl_reg_loss: 44199.4727; val_edge_recon_loss: 2700523.8000; val_gene_expr_recon_loss: 10251744.1333; val_masked_gp_l1_reg_loss: 95437.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56150.6328; val_chrom_access_recon_loss: 3784911.3000; val_global_loss: 16932966.6000; val_optim_loss: 16932966.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9716; val_auprc_score: 0.9581; val_best_acc_score: 0.9278; val_best_f1_score: 0.9298; train_kl_reg_loss: 57934.7567; train_edge_recon_loss: 2681811.2615; train_gene_expr_recon_loss: 10286478.4122; train_masked_gp_l1_reg_loss: 94441.7493; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56012.5465; train_chrom_access_recon_loss: 3798786.3798; train_global_loss: 16975465.1069; train_optim_loss: 16975465.1069; val_kl_reg_loss: 47367.5010; val_edge_recon_loss: 2691085.2000; val_gene_expr_recon_loss: 10187659.8667; val_masked_gp_l1_reg_loss: 93670.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56008.5703; val_chrom_access_recon_loss: 3772857.1500; val_global_loss: 16848649.6667; val_optim_loss: 16848649.6667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9724; val_auprc_score: 0.9648; val_best_acc_score: 0.9217; val_best_f1_score: 0.9255; train_kl_reg_loss: 57643.0424; train_edge_recon_loss: 2683180.5115; train_gene_expr_recon_loss: 10267883.2290; train_masked_gp_l1_reg_loss: 92736.7121; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55918.5538; train_chrom_access_recon_loss: 3796690.2137; train_global_loss: 16954052.2443; train_optim_loss: 16954052.2443; val_kl_reg_loss: 46346.0385; val_edge_recon_loss: 2698960.9000; val_gene_expr_recon_loss: 10187058.1333; val_masked_gp_l1_reg_loss: 92066.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56174.4766; val_chrom_access_recon_loss: 3758180.2500; val_global_loss: 16838786.0667; val_optim_loss: 16838786.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9724; val_auprc_score: 0.9636; val_best_acc_score: 0.9267; val_best_f1_score: 0.9286; train_kl_reg_loss: 57072.7267; train_edge_recon_loss: 2679993.7481; train_gene_expr_recon_loss: 10250955.7023; train_masked_gp_l1_reg_loss: 91434.0952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55892.4449; train_chrom_access_recon_loss: 3787025.4008; train_global_loss: 16922374.0611; train_optim_loss: 16922374.0611; val_kl_reg_loss: 48292.7982; val_edge_recon_loss: 2672440.8667; val_gene_expr_recon_loss: 10125777.5333; val_masked_gp_l1_reg_loss: 90829.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55960.1289; val_chrom_access_recon_loss: 3731090.3667; val_global_loss: 16724390.4667; val_optim_loss: 16724390.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9720; val_auprc_score: 0.9603; val_best_acc_score: 0.9214; val_best_f1_score: 0.9235; train_kl_reg_loss: 57793.2523; train_edge_recon_loss: 2675769.2710; train_gene_expr_recon_loss: 10238506.9771; train_masked_gp_l1_reg_loss: 90213.6265; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55962.7540; train_chrom_access_recon_loss: 3786468.3683; train_global_loss: 16904714.2519; train_optim_loss: 16904714.2519; val_kl_reg_loss: 48784.8966; val_edge_recon_loss: 2696251.9833; val_gene_expr_recon_loss: 10143711.8667; val_masked_gp_l1_reg_loss: 89658.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55717.3359; val_chrom_access_recon_loss: 3745089.6333; val_global_loss: 16779214.2000; val_optim_loss: 16779214.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9718; val_auprc_score: 0.9630; val_best_acc_score: 0.9263; val_best_f1_score: 0.9283; train_kl_reg_loss: 56345.0473; train_edge_recon_loss: 2677582.8531; train_gene_expr_recon_loss: 10239585.0611; train_masked_gp_l1_reg_loss: 89068.6621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55744.2304; train_chrom_access_recon_loss: 3787459.7595; train_global_loss: 16905785.6412; train_optim_loss: 16905785.6412; val_kl_reg_loss: 48474.9273; val_edge_recon_loss: 2683697.2500; val_gene_expr_recon_loss: 10190485.0667; val_masked_gp_l1_reg_loss: 88597.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55993.5898; val_chrom_access_recon_loss: 3772207.3667; val_global_loss: 16839456.4667; val_optim_loss: 16839456.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9750; val_auprc_score: 0.9642; val_best_acc_score: 0.9303; val_best_f1_score: 0.9324; train_kl_reg_loss: 55406.9389; train_edge_recon_loss: 2674612.7939; train_gene_expr_recon_loss: 10224091.9160; train_masked_gp_l1_reg_loss: 88228.3775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55843.6392; train_chrom_access_recon_loss: 3779161.3760; train_global_loss: 16877345.0229; train_optim_loss: 16877345.0229; val_kl_reg_loss: 50310.3633; val_edge_recon_loss: 2687556.5167; val_gene_expr_recon_loss: 10206663.3333; val_masked_gp_l1_reg_loss: 87926.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55712.7812; val_chrom_access_recon_loss: 3765079.9500; val_global_loss: 16853250.2000; val_optim_loss: 16853250.2000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9742; val_auprc_score: 0.9657; val_best_acc_score: 0.9286; val_best_f1_score: 0.9308; train_kl_reg_loss: 55779.4575; train_edge_recon_loss: 2674251.9218; train_gene_expr_recon_loss: 10211479.6794; train_masked_gp_l1_reg_loss: 87547.9346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55709.7120; train_chrom_access_recon_loss: 3770361.0401; train_global_loss: 16855129.7939; train_optim_loss: 16855129.7939; val_kl_reg_loss: 50828.9417; val_edge_recon_loss: 2699634.8000; val_gene_expr_recon_loss: 10153472.4667; val_masked_gp_l1_reg_loss: 87212.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55836.3828; val_chrom_access_recon_loss: 3758835.5500; val_global_loss: 16805820.7333; val_optim_loss: 16805820.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9729; val_auprc_score: 0.9644; val_best_acc_score: 0.9271; val_best_f1_score: 0.9294; train_kl_reg_loss: 57241.5308; train_edge_recon_loss: 2679706.6164; train_gene_expr_recon_loss: 10193950.1908; train_masked_gp_l1_reg_loss: 85362.1183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 47318.2100; train_chrom_access_recon_loss: 3771514.7672; train_global_loss: 16835093.3664; train_optim_loss: 16835093.3664; val_kl_reg_loss: 51218.9047; val_edge_recon_loss: 2692237.4667; val_gene_expr_recon_loss: 10131141.2000; val_masked_gp_l1_reg_loss: 84954.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 46170.0352; val_chrom_access_recon_loss: 3750115.9833; val_global_loss: 16755837.2000; val_optim_loss: 16755837.2000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9746; val_auprc_score: 0.9659; val_best_acc_score: 0.9299; val_best_f1_score: 0.9317; train_kl_reg_loss: 57173.3123; train_edge_recon_loss: 2659552.6469; train_gene_expr_recon_loss: 10207058.3817; train_masked_gp_l1_reg_loss: 84847.4811; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45894.6436; train_chrom_access_recon_loss: 3772111.5935; train_global_loss: 16826638.1069; train_optim_loss: 16826638.1069; val_kl_reg_loss: 51173.0596; val_edge_recon_loss: 2674928.9667; val_gene_expr_recon_loss: 10161330.5333; val_masked_gp_l1_reg_loss: 84790.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45625.5352; val_chrom_access_recon_loss: 3743212.8833; val_global_loss: 16761061.4667; val_optim_loss: 16761061.4667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9744; val_auprc_score: 0.9635; val_best_acc_score: 0.9332; val_best_f1_score: 0.9353; train_kl_reg_loss: 57702.9934; train_edge_recon_loss: 2672720.6546; train_gene_expr_recon_loss: 10195166.8550; train_masked_gp_l1_reg_loss: 84720.8902; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45435.8687; train_chrom_access_recon_loss: 3769682.5439; train_global_loss: 16825429.8321; train_optim_loss: 16825429.8321; val_kl_reg_loss: 51607.4219; val_edge_recon_loss: 2659239.0500; val_gene_expr_recon_loss: 10182368.8000; val_masked_gp_l1_reg_loss: 84663.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 45228.0664; val_chrom_access_recon_loss: 3767534.2500; val_global_loss: 16790641.2667; val_optim_loss: 16790641.2667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9744; val_auprc_score: 0.9632; val_best_acc_score: 0.9306; val_best_f1_score: 0.9329; train_kl_reg_loss: 57580.4785; train_edge_recon_loss: 2670848.2176; train_gene_expr_recon_loss: 10194856.3740; train_masked_gp_l1_reg_loss: 84609.8237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 45125.2064; train_chrom_access_recon_loss: 3769952.0878; train_global_loss: 16822972.1679; train_optim_loss: 16822972.1679; val_kl_reg_loss: 52603.7404; val_edge_recon_loss: 2673930.5000; val_gene_expr_recon_loss: 10126664.8667; val_masked_gp_l1_reg_loss: 84558.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44938.3906; val_chrom_access_recon_loss: 3740169.0500; val_global_loss: 16722865.2000; val_optim_loss: 16722865.2000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9753; val_auprc_score: 0.9656; val_best_acc_score: 0.9326; val_best_f1_score: 0.9342; train_kl_reg_loss: 57911.8742; train_edge_recon_loss: 2667552.3378; train_gene_expr_recon_loss: 10189011.1450; train_masked_gp_l1_reg_loss: 84507.9896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44819.6791; train_chrom_access_recon_loss: 3765368.9790; train_global_loss: 16809171.9084; train_optim_loss: 16809171.9084; val_kl_reg_loss: 52080.8719; val_edge_recon_loss: 2687403.6000; val_gene_expr_recon_loss: 10155209.8000; val_masked_gp_l1_reg_loss: 84449.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44684.2422; val_chrom_access_recon_loss: 3751739.8667; val_global_loss: 16775568.2000; val_optim_loss: 16775568.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9767; val_auprc_score: 0.9669; val_best_acc_score: 0.9333; val_best_f1_score: 0.9348; train_kl_reg_loss: 57983.0606; train_edge_recon_loss: 2664922.2519; train_gene_expr_recon_loss: 10180585.2824; train_masked_gp_l1_reg_loss: 84410.1429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44586.5939; train_chrom_access_recon_loss: 3766545.6660; train_global_loss: 16799033.0687; train_optim_loss: 16799033.0687; val_kl_reg_loss: 52357.1419; val_edge_recon_loss: 2666561.3833; val_gene_expr_recon_loss: 10112419.0000; val_masked_gp_l1_reg_loss: 84360.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44484.5547; val_chrom_access_recon_loss: 3738235.6667; val_global_loss: 16698418.1333; val_optim_loss: 16698418.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9760; val_auprc_score: 0.9678; val_best_acc_score: 0.9298; val_best_f1_score: 0.9320; train_kl_reg_loss: 57735.0482; train_edge_recon_loss: 2672752.6355; train_gene_expr_recon_loss: 10188792.5649; train_masked_gp_l1_reg_loss: 84297.5485; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44366.3424; train_chrom_access_recon_loss: 3760601.3740; train_global_loss: 16808545.5573; train_optim_loss: 16808545.5573; val_kl_reg_loss: 51416.4807; val_edge_recon_loss: 2677442.2333; val_gene_expr_recon_loss: 10148222.3333; val_masked_gp_l1_reg_loss: 84253.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44233.8242; val_chrom_access_recon_loss: 3741084.1333; val_global_loss: 16746652.3333; val_optim_loss: 16746652.3333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9770; val_auprc_score: 0.9683; val_best_acc_score: 0.9334; val_best_f1_score: 0.9357; train_kl_reg_loss: 57553.9413; train_edge_recon_loss: 2671197.9084; train_gene_expr_recon_loss: 10195920.8702; train_masked_gp_l1_reg_loss: 84216.7202; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 44184.4676; train_chrom_access_recon_loss: 3769859.6908; train_global_loss: 16822933.5115; train_optim_loss: 16822933.5115; val_kl_reg_loss: 52797.5948; val_edge_recon_loss: 2671171.7000; val_gene_expr_recon_loss: 10134372.3333; val_masked_gp_l1_reg_loss: 84169.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 44005.1055; val_chrom_access_recon_loss: 3751781.7833; val_global_loss: 16738297.2000; val_optim_loss: 16738297.2000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9759; val_auprc_score: 0.9661; val_best_acc_score: 0.9303; val_best_f1_score: 0.9330; train_kl_reg_loss: 58191.5448; train_edge_recon_loss: 2665267.7405; train_gene_expr_recon_loss: 10182464.7023; train_masked_gp_l1_reg_loss: 84117.9560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43953.5083; train_chrom_access_recon_loss: 3765033.4427; train_global_loss: 16799028.9618; train_optim_loss: 16799028.9618; val_kl_reg_loss: 53381.9578; val_edge_recon_loss: 2663015.5667; val_gene_expr_recon_loss: 10162116.6667; val_masked_gp_l1_reg_loss: 84069.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43833.7188; val_chrom_access_recon_loss: 3759860.1000; val_global_loss: 16766278.2667; val_optim_loss: 16766278.2667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9767; val_auprc_score: 0.9679; val_best_acc_score: 0.9337; val_best_f1_score: 0.9351; train_kl_reg_loss: 57816.1650; train_edge_recon_loss: 2674684.0477; train_gene_expr_recon_loss: 10185265.0076; train_masked_gp_l1_reg_loss: 84007.6308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43770.6592; train_chrom_access_recon_loss: 3764453.9790; train_global_loss: 16809997.3969; train_optim_loss: 16809997.3969; val_kl_reg_loss: 52841.2013; val_edge_recon_loss: 2678237.3833; val_gene_expr_recon_loss: 10106387.8667; val_masked_gp_l1_reg_loss: 83957.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43688.4492; val_chrom_access_recon_loss: 3721195.2833; val_global_loss: 16686306.7333; val_optim_loss: 16686306.7333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9742; val_auprc_score: 0.9632; val_best_acc_score: 0.9317; val_best_f1_score: 0.9340; train_kl_reg_loss: 58199.3372; train_edge_recon_loss: 2660419.7271; train_gene_expr_recon_loss: 10183494.2748; train_masked_gp_l1_reg_loss: 83914.2212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43600.2473; train_chrom_access_recon_loss: 3762499.4618; train_global_loss: 16792127.2595; train_optim_loss: 16792127.2595; val_kl_reg_loss: 53054.5594; val_edge_recon_loss: 2674481.6000; val_gene_expr_recon_loss: 10123107.2000; val_masked_gp_l1_reg_loss: 83834.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43488.7305; val_chrom_access_recon_loss: 3752940.6167; val_global_loss: 16730908.1333; val_optim_loss: 16730908.1333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9762; val_auprc_score: 0.9684; val_best_acc_score: 0.9286; val_best_f1_score: 0.9309; train_kl_reg_loss: 57657.2840; train_edge_recon_loss: 2666229.2481; train_gene_expr_recon_loss: 10185346.1603; train_masked_gp_l1_reg_loss: 83784.7463; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43418.6533; train_chrom_access_recon_loss: 3764118.7137; train_global_loss: 16800554.7481; train_optim_loss: 16800554.7481; val_kl_reg_loss: 53071.9195; val_edge_recon_loss: 2672606.0167; val_gene_expr_recon_loss: 10135832.2667; val_masked_gp_l1_reg_loss: 83748.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43377.3359; val_chrom_access_recon_loss: 3734399.8667; val_global_loss: 16723034.9333; val_optim_loss: 16723034.9333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9747; val_auprc_score: 0.9649; val_best_acc_score: 0.9290; val_best_f1_score: 0.9315; train_kl_reg_loss: 57968.0683; train_edge_recon_loss: 2668664.6221; train_gene_expr_recon_loss: 10184277.5420; train_masked_gp_l1_reg_loss: 83697.8910; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43263.1600; train_chrom_access_recon_loss: 3763962.2252; train_global_loss: 16801833.5649; train_optim_loss: 16801833.5649; val_kl_reg_loss: 53719.7643; val_edge_recon_loss: 2693312.1333; val_gene_expr_recon_loss: 10140793.6667; val_masked_gp_l1_reg_loss: 83647.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43141.7539; val_chrom_access_recon_loss: 3736100.6500; val_global_loss: 16750716.1333; val_optim_loss: 16750716.1333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9731; val_auprc_score: 0.9666; val_best_acc_score: 0.9227; val_best_f1_score: 0.9260; train_kl_reg_loss: 57990.9275; train_edge_recon_loss: 2670219.0038; train_gene_expr_recon_loss: 10174232.4351; train_masked_gp_l1_reg_loss: 83565.1979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 43010.9576; train_chrom_access_recon_loss: 3759363.9427; train_global_loss: 16788382.4885; train_optim_loss: 16788382.4885; val_kl_reg_loss: 53100.3630; val_edge_recon_loss: 2697260.7000; val_gene_expr_recon_loss: 10126638.4667; val_masked_gp_l1_reg_loss: 83512.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 43004.7773; val_chrom_access_recon_loss: 3737951.8333; val_global_loss: 16741468.3333; val_optim_loss: 16741468.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9747; val_auprc_score: 0.9653; val_best_acc_score: 0.9289; val_best_f1_score: 0.9309; train_kl_reg_loss: 57753.4257; train_edge_recon_loss: 2668774.5859; train_gene_expr_recon_loss: 10168968.5420; train_masked_gp_l1_reg_loss: 83305.0898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42107.7488; train_chrom_access_recon_loss: 3760400.1412; train_global_loss: 16781309.6183; train_optim_loss: 16781309.6183; val_kl_reg_loss: 53152.6076; val_edge_recon_loss: 2684089.1333; val_gene_expr_recon_loss: 10128537.2000; val_masked_gp_l1_reg_loss: 83250.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41997.8203; val_chrom_access_recon_loss: 3746236.0333; val_global_loss: 16737263.0000; val_optim_loss: 16737263.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9744; val_auprc_score: 0.9658; val_best_acc_score: 0.9278; val_best_f1_score: 0.9291; train_kl_reg_loss: 57689.0004; train_edge_recon_loss: 2675627.9714; train_gene_expr_recon_loss: 10177634.4656; train_masked_gp_l1_reg_loss: 83228.8508; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41967.5570; train_chrom_access_recon_loss: 3758028.8664; train_global_loss: 16794176.7099; train_optim_loss: 16794176.7099; val_kl_reg_loss: 52955.3779; val_edge_recon_loss: 2687120.5000; val_gene_expr_recon_loss: 10115481.8667; val_masked_gp_l1_reg_loss: 83212.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41934.9180; val_chrom_access_recon_loss: 3736722.5500; val_global_loss: 16717428.6000; val_optim_loss: 16717428.6000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9757; val_auprc_score: 0.9675; val_best_acc_score: 0.9302; val_best_f1_score: 0.9325; train_kl_reg_loss: 57660.9231; train_edge_recon_loss: 2665762.1050; train_gene_expr_recon_loss: 10178853.1298; train_masked_gp_l1_reg_loss: 83200.4469; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41909.4028; train_chrom_access_recon_loss: 3763090.1317; train_global_loss: 16790476.1908; train_optim_loss: 16790476.1908; val_kl_reg_loss: 53360.1935; val_edge_recon_loss: 2689255.2167; val_gene_expr_recon_loss: 10168504.8000; val_masked_gp_l1_reg_loss: 83189.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41887.2148; val_chrom_access_recon_loss: 3742026.9667; val_global_loss: 16778224.3333; val_optim_loss: 16778224.3333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9762; val_auprc_score: 0.9678; val_best_acc_score: 0.9349; val_best_f1_score: 0.9371; train_kl_reg_loss: 57666.8320; train_edge_recon_loss: 2661469.0076; train_gene_expr_recon_loss: 10168550.0305; train_masked_gp_l1_reg_loss: 83182.1311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 41868.0115; train_chrom_access_recon_loss: 3759341.0344; train_global_loss: 16772076.9542; train_optim_loss: 16772076.9542; val_kl_reg_loss: 53203.7297; val_edge_recon_loss: 2667923.8000; val_gene_expr_recon_loss: 10133269.7333; val_masked_gp_l1_reg_loss: 83173.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41846.6875; val_chrom_access_recon_loss: 3739204.2667; val_global_loss: 16718622.5333; val_optim_loss: 16718622.5333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 50 min 34 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9764
val AUPRC score: 0.9674
val best accuracy score: 0.9289
val best F1 score: 0.9315
val target rna MSE score: 1.6170
val source rna MSE score: 0.5642
val target atac MSE score: 0.4786
val source atac MSE score: 0.1438
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
