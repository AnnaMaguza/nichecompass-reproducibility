[True]
Run timestamp: 10102023_073807_191.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_191']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7147; val_auprc_score: 0.6902; val_best_acc_score: 0.5013; val_best_f1_score: 0.6673; train_kl_reg_loss: 83525.8973; train_edge_recon_loss: 757474.5492; train_gene_expr_recon_loss: 22878932.7576; train_masked_gp_l1_reg_loss: 54529.7257; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6186108.3750; train_chrom_access_recon_loss: 2306297.0606; train_global_loss: 32266868.4242; train_optim_loss: 32266868.4242; val_kl_reg_loss: 95185.8350; val_edge_recon_loss: 813095.7891; val_gene_expr_recon_loss: 21576785.7500; val_masked_gp_l1_reg_loss: 60025.1914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3576853.5000; val_chrom_access_recon_loss: 2206328.3438; val_global_loss: 28328276.7500; val_optim_loss: 28328276.7500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7207; val_auprc_score: 0.6945; val_best_acc_score: 0.6067; val_best_f1_score: 0.7026; train_kl_reg_loss: 94387.6024; train_edge_recon_loss: 751656.6383; train_gene_expr_recon_loss: 21209898.0303; train_masked_gp_l1_reg_loss: 60262.7762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2024785.0455; train_chrom_access_recon_loss: 2204829.2462; train_global_loss: 26345819.5455; train_optim_loss: 26345819.5455; val_kl_reg_loss: 95691.3643; val_edge_recon_loss: 811649.6328; val_gene_expr_recon_loss: 21022223.7500; val_masked_gp_l1_reg_loss: 60484.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1013438.1250; val_chrom_access_recon_loss: 2180418.5625; val_global_loss: 25183905.0000; val_optim_loss: 25183905.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8014; val_auprc_score: 0.7835; val_best_acc_score: 0.7187; val_best_f1_score: 0.7208; train_kl_reg_loss: 85185.1766; train_edge_recon_loss: 739680.6193; train_gene_expr_recon_loss: 21001620.0303; train_masked_gp_l1_reg_loss: 61090.5682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 664096.7315; train_chrom_access_recon_loss: 2189506.8087; train_global_loss: 24741179.8788; train_optim_loss: 24741179.8788; val_kl_reg_loss: 81362.1885; val_edge_recon_loss: 803222.1719; val_gene_expr_recon_loss: 21292633.0000; val_masked_gp_l1_reg_loss: 61876.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 435248.7188; val_chrom_access_recon_loss: 2186571.6719; val_global_loss: 24860913.0000; val_optim_loss: 24860913.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8558; val_auprc_score: 0.8419; val_best_acc_score: 0.7773; val_best_f1_score: 0.7956; train_kl_reg_loss: 76139.6268; train_edge_recon_loss: 727479.7917; train_gene_expr_recon_loss: 20861443.8182; train_masked_gp_l1_reg_loss: 63089.6851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 337168.4541; train_chrom_access_recon_loss: 2173996.4375; train_global_loss: 24239317.9697; train_optim_loss: 24239317.9697; val_kl_reg_loss: 80860.5723; val_edge_recon_loss: 769843.1094; val_gene_expr_recon_loss: 20834714.5000; val_masked_gp_l1_reg_loss: 64230.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 266527.7188; val_chrom_access_recon_loss: 2158494.6875; val_global_loss: 24174671.2500; val_optim_loss: 24174671.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8841; val_auprc_score: 0.8634; val_best_acc_score: 0.8117; val_best_f1_score: 0.8273; train_kl_reg_loss: 73124.7331; train_edge_recon_loss: 697311.5568; train_gene_expr_recon_loss: 20714756.8788; train_masked_gp_l1_reg_loss: 65868.1220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 233857.5130; train_chrom_access_recon_loss: 2161815.2576; train_global_loss: 23946734.2121; train_optim_loss: 23946734.2121; val_kl_reg_loss: 76386.7305; val_edge_recon_loss: 679534.3125; val_gene_expr_recon_loss: 20706511.0000; val_masked_gp_l1_reg_loss: 67412.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 209483.0000; val_chrom_access_recon_loss: 2129414.3281; val_global_loss: 23868740.5000; val_optim_loss: 23868740.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8953; val_auprc_score: 0.8668; val_best_acc_score: 0.8332; val_best_f1_score: 0.8420; train_kl_reg_loss: 84629.7427; train_edge_recon_loss: 643175.2159; train_gene_expr_recon_loss: 20568135.1212; train_masked_gp_l1_reg_loss: 69096.4736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 192243.8364; train_chrom_access_recon_loss: 2150828.8864; train_global_loss: 23708109.0000; train_optim_loss: 23708109.0000; val_kl_reg_loss: 87072.0254; val_edge_recon_loss: 638815.5703; val_gene_expr_recon_loss: 20618312.5000; val_masked_gp_l1_reg_loss: 70723.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 175440.7812; val_chrom_access_recon_loss: 2155847.9062; val_global_loss: 23746212.2500; val_optim_loss: 23746212.2500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9098; val_auprc_score: 0.8866; val_best_acc_score: 0.8444; val_best_f1_score: 0.8559; train_kl_reg_loss: 86712.3641; train_edge_recon_loss: 626308.9309; train_gene_expr_recon_loss: 20439766.9394; train_masked_gp_l1_reg_loss: 71992.1889; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163141.0597; train_chrom_access_recon_loss: 2138662.8920; train_global_loss: 23526584.5152; train_optim_loss: 23526584.5152; val_kl_reg_loss: 83075.8535; val_edge_recon_loss: 625077.9219; val_gene_expr_recon_loss: 20554057.7500; val_masked_gp_l1_reg_loss: 73162.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 152081.8125; val_chrom_access_recon_loss: 2124335.3125; val_global_loss: 23611790.5000; val_optim_loss: 23611790.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9033; val_auprc_score: 0.8727; val_best_acc_score: 0.8420; val_best_f1_score: 0.8511; train_kl_reg_loss: 83777.5089; train_edge_recon_loss: 620126.9545; train_gene_expr_recon_loss: 20369454.3030; train_masked_gp_l1_reg_loss: 74216.0612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 144030.9571; train_chrom_access_recon_loss: 2132852.2330; train_global_loss: 23424457.8788; train_optim_loss: 23424457.8788; val_kl_reg_loss: 85039.7627; val_edge_recon_loss: 624354.9531; val_gene_expr_recon_loss: 20618548.0000; val_masked_gp_l1_reg_loss: 75108.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137008.7656; val_chrom_access_recon_loss: 2131967.2500; val_global_loss: 23672026.0000; val_optim_loss: 23672026.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9041; val_auprc_score: 0.8717; val_best_acc_score: 0.8401; val_best_f1_score: 0.8536; train_kl_reg_loss: 81654.1140; train_edge_recon_loss: 613644.7992; train_gene_expr_recon_loss: 20259140.9091; train_masked_gp_l1_reg_loss: 76034.4175; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132166.8705; train_chrom_access_recon_loss: 2123280.1723; train_global_loss: 23285921.2121; train_optim_loss: 23285921.2121; val_kl_reg_loss: 81078.5078; val_edge_recon_loss: 622423.5625; val_gene_expr_recon_loss: 20378701.5000; val_masked_gp_l1_reg_loss: 76951.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 127841.5078; val_chrom_access_recon_loss: 2127575.3594; val_global_loss: 23414572.5000; val_optim_loss: 23414572.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9079; val_auprc_score: 0.8857; val_best_acc_score: 0.8404; val_best_f1_score: 0.8526; train_kl_reg_loss: 79749.3552; train_edge_recon_loss: 611214.8163; train_gene_expr_recon_loss: 20193413.3636; train_masked_gp_l1_reg_loss: 77495.5933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 125213.6555; train_chrom_access_recon_loss: 2116257.9053; train_global_loss: 23203344.5152; train_optim_loss: 23203344.5152; val_kl_reg_loss: 75879.7695; val_edge_recon_loss: 619521.2188; val_gene_expr_recon_loss: 20364812.7500; val_masked_gp_l1_reg_loss: 78189.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123148.4688; val_chrom_access_recon_loss: 2108452.9688; val_global_loss: 23370004.7500; val_optim_loss: 23370004.7500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9232; val_auprc_score: 0.9042; val_best_acc_score: 0.8557; val_best_f1_score: 0.8647; train_kl_reg_loss: 77042.4550; train_edge_recon_loss: 610704.2216; train_gene_expr_recon_loss: 20102232.6970; train_masked_gp_l1_reg_loss: 78793.4875; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120702.9482; train_chrom_access_recon_loss: 2106979.8049; train_global_loss: 23096455.7879; train_optim_loss: 23096455.7879; val_kl_reg_loss: 76326.9014; val_edge_recon_loss: 617267.8828; val_gene_expr_recon_loss: 20207917.7500; val_masked_gp_l1_reg_loss: 79321.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117776.5469; val_chrom_access_recon_loss: 2087857.6719; val_global_loss: 23186468.0000; val_optim_loss: 23186468.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9182; val_auprc_score: 0.8983; val_best_acc_score: 0.8474; val_best_f1_score: 0.8593; train_kl_reg_loss: 76175.0246; train_edge_recon_loss: 604890.3381; train_gene_expr_recon_loss: 20033420.5758; train_masked_gp_l1_reg_loss: 79820.0752; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116098.4659; train_chrom_access_recon_loss: 2099429.5909; train_global_loss: 23009833.9697; train_optim_loss: 23009833.9697; val_kl_reg_loss: 76191.6230; val_edge_recon_loss: 611739.4844; val_gene_expr_recon_loss: 20141600.2500; val_masked_gp_l1_reg_loss: 80621.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114657.6094; val_chrom_access_recon_loss: 2070952.2969; val_global_loss: 23095763.5000; val_optim_loss: 23095763.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9292; val_auprc_score: 0.9069; val_best_acc_score: 0.8611; val_best_f1_score: 0.8703; train_kl_reg_loss: 74741.4048; train_edge_recon_loss: 601346.0805; train_gene_expr_recon_loss: 19971811.0909; train_masked_gp_l1_reg_loss: 80956.1416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112890.8543; train_chrom_access_recon_loss: 2096617.8674; train_global_loss: 22938363.3030; train_optim_loss: 22938363.3030; val_kl_reg_loss: 74393.2051; val_edge_recon_loss: 607959.0391; val_gene_expr_recon_loss: 20147158.5000; val_masked_gp_l1_reg_loss: 81431.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112045.6797; val_chrom_access_recon_loss: 2089966.7188; val_global_loss: 23112955.7500; val_optim_loss: 23112955.7500
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9356; val_auprc_score: 0.9193; val_best_acc_score: 0.8718; val_best_f1_score: 0.8784; train_kl_reg_loss: 73525.0749; train_edge_recon_loss: 601233.1420; train_gene_expr_recon_loss: 19892707.7879; train_masked_gp_l1_reg_loss: 81915.3620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110269.3907; train_chrom_access_recon_loss: 2086623.1212; train_global_loss: 22846273.6970; train_optim_loss: 22846273.6970; val_kl_reg_loss: 73272.4072; val_edge_recon_loss: 603525.6406; val_gene_expr_recon_loss: 20143295.2500; val_masked_gp_l1_reg_loss: 82419.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109625.8594; val_chrom_access_recon_loss: 2087751.8750; val_global_loss: 23099890.7500; val_optim_loss: 23099890.7500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9423; val_auprc_score: 0.9280; val_best_acc_score: 0.8775; val_best_f1_score: 0.8851; train_kl_reg_loss: 72433.3845; train_edge_recon_loss: 598010.3617; train_gene_expr_recon_loss: 19840202.3333; train_masked_gp_l1_reg_loss: 82879.3865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107931.9498; train_chrom_access_recon_loss: 2080591.9545; train_global_loss: 22782049.4545; train_optim_loss: 22782049.4545; val_kl_reg_loss: 73906.5537; val_edge_recon_loss: 598544.4766; val_gene_expr_recon_loss: 20122064.0000; val_masked_gp_l1_reg_loss: 83380.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106896.9766; val_chrom_access_recon_loss: 2071935.8125; val_global_loss: 23056726.7500; val_optim_loss: 23056726.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9420; val_auprc_score: 0.9279; val_best_acc_score: 0.8812; val_best_f1_score: 0.8869; train_kl_reg_loss: 71605.7778; train_edge_recon_loss: 596566.0445; train_gene_expr_recon_loss: 19790299.3030; train_masked_gp_l1_reg_loss: 83821.0297; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105761.6669; train_chrom_access_recon_loss: 2076453.3655; train_global_loss: 22724507.1818; train_optim_loss: 22724507.1818; val_kl_reg_loss: 72573.0176; val_edge_recon_loss: 597825.4375; val_gene_expr_recon_loss: 20050813.2500; val_masked_gp_l1_reg_loss: 84340.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104850.8203; val_chrom_access_recon_loss: 2083535.4688; val_global_loss: 22993937.5000; val_optim_loss: 22993937.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9447; val_auprc_score: 0.9292; val_best_acc_score: 0.8842; val_best_f1_score: 0.8901; train_kl_reg_loss: 71023.5034; train_edge_recon_loss: 594636.4830; train_gene_expr_recon_loss: 19717959.0303; train_masked_gp_l1_reg_loss: 84864.6828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104072.9877; train_chrom_access_recon_loss: 2068578.7121; train_global_loss: 22641135.3030; train_optim_loss: 22641135.3030; val_kl_reg_loss: 72225.0029; val_edge_recon_loss: 600155.2188; val_gene_expr_recon_loss: 19725254.2500; val_masked_gp_l1_reg_loss: 85337.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 103043.6406; val_chrom_access_recon_loss: 2073155.4844; val_global_loss: 22659171.7500; val_optim_loss: 22659171.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9492; val_auprc_score: 0.9339; val_best_acc_score: 0.8925; val_best_f1_score: 0.8983; train_kl_reg_loss: 70016.0487; train_edge_recon_loss: 592777.2973; train_gene_expr_recon_loss: 19682643.4848; train_masked_gp_l1_reg_loss: 85725.8009; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102655.7930; train_chrom_access_recon_loss: 2065358.1742; train_global_loss: 22599176.4545; train_optim_loss: 22599176.4545; val_kl_reg_loss: 69648.7783; val_edge_recon_loss: 594668.1250; val_gene_expr_recon_loss: 19926180.7500; val_masked_gp_l1_reg_loss: 86330.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102260.0469; val_chrom_access_recon_loss: 2061891.8906; val_global_loss: 22840979.7500; val_optim_loss: 22840979.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9480; val_auprc_score: 0.9335; val_best_acc_score: 0.8888; val_best_f1_score: 0.8930; train_kl_reg_loss: 69385.5938; train_edge_recon_loss: 592434.9678; train_gene_expr_recon_loss: 19617189.5152; train_masked_gp_l1_reg_loss: 86645.4789; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101867.2944; train_chrom_access_recon_loss: 2059898.4924; train_global_loss: 22527421.2424; train_optim_loss: 22527421.2424; val_kl_reg_loss: 68713.9375; val_edge_recon_loss: 596014.3750; val_gene_expr_recon_loss: 19700933.2500; val_masked_gp_l1_reg_loss: 86998.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101374.7109; val_chrom_access_recon_loss: 2040461.1094; val_global_loss: 22594494.5000; val_optim_loss: 22594494.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9438; val_auprc_score: 0.9227; val_best_acc_score: 0.8880; val_best_f1_score: 0.8947; train_kl_reg_loss: 68766.4244; train_edge_recon_loss: 590050.3030; train_gene_expr_recon_loss: 19569094.3939; train_masked_gp_l1_reg_loss: 87559.4097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 101211.7489; train_chrom_access_recon_loss: 2053723.5644; train_global_loss: 22470405.8182; train_optim_loss: 22470405.8182; val_kl_reg_loss: 70789.7246; val_edge_recon_loss: 592889.1094; val_gene_expr_recon_loss: 19787745.7500; val_masked_gp_l1_reg_loss: 87918.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101266.8750; val_chrom_access_recon_loss: 2042055.7812; val_global_loss: 22682664.0000; val_optim_loss: 22682664.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9500; val_auprc_score: 0.9398; val_best_acc_score: 0.8909; val_best_f1_score: 0.8942; train_kl_reg_loss: 68076.0352; train_edge_recon_loss: 588464.4905; train_gene_expr_recon_loss: 19508640.6667; train_masked_gp_l1_reg_loss: 88375.1212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100924.6494; train_chrom_access_recon_loss: 2047966.9356; train_global_loss: 22402447.7576; train_optim_loss: 22402447.7576; val_kl_reg_loss: 67320.4941; val_edge_recon_loss: 597208.3906; val_gene_expr_recon_loss: 19872696.5000; val_masked_gp_l1_reg_loss: 88894.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100612.8828; val_chrom_access_recon_loss: 2084501.0469; val_global_loss: 22811232.5000; val_optim_loss: 22811232.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9524; val_auprc_score: 0.9376; val_best_acc_score: 0.8992; val_best_f1_score: 0.9028; train_kl_reg_loss: 67232.0817; train_edge_recon_loss: 590080.2377; train_gene_expr_recon_loss: 19474129.6364; train_masked_gp_l1_reg_loss: 89329.6316; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100773.6491; train_chrom_access_recon_loss: 2043860.2292; train_global_loss: 22365405.6364; train_optim_loss: 22365405.6364; val_kl_reg_loss: 66188.7075; val_edge_recon_loss: 593603.7578; val_gene_expr_recon_loss: 19480081.0000; val_masked_gp_l1_reg_loss: 89814.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100649.6641; val_chrom_access_recon_loss: 2024079.4375; val_global_loss: 22354416.7500; val_optim_loss: 22354416.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9481; val_auprc_score: 0.9289; val_best_acc_score: 0.8936; val_best_f1_score: 0.8976; train_kl_reg_loss: 66902.4508; train_edge_recon_loss: 588635.6809; train_gene_expr_recon_loss: 19414771.0000; train_masked_gp_l1_reg_loss: 90191.5897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100587.0121; train_chrom_access_recon_loss: 2040236.8466; train_global_loss: 22301324.7879; train_optim_loss: 22301324.7879; val_kl_reg_loss: 66423.9365; val_edge_recon_loss: 595851.4453; val_gene_expr_recon_loss: 19592320.2500; val_masked_gp_l1_reg_loss: 90727.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101109.6797; val_chrom_access_recon_loss: 2031689.7031; val_global_loss: 22478123.2500; val_optim_loss: 22478123.2500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9483; val_auprc_score: 0.9280; val_best_acc_score: 0.8898; val_best_f1_score: 0.8959; train_kl_reg_loss: 66491.3838; train_edge_recon_loss: 585985.0777; train_gene_expr_recon_loss: 19370252.3333; train_masked_gp_l1_reg_loss: 91166.1132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100525.6856; train_chrom_access_recon_loss: 2034992.6572; train_global_loss: 22249413.4545; train_optim_loss: 22249413.4545; val_kl_reg_loss: 67858.4150; val_edge_recon_loss: 593202.6641; val_gene_expr_recon_loss: 19514861.0000; val_masked_gp_l1_reg_loss: 91665.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100186.8281; val_chrom_access_recon_loss: 2024121.4844; val_global_loss: 22391895.2500; val_optim_loss: 22391895.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9538; val_auprc_score: 0.9390; val_best_acc_score: 0.8955; val_best_f1_score: 0.8989; train_kl_reg_loss: 65927.7770; train_edge_recon_loss: 585300.8295; train_gene_expr_recon_loss: 19318117.3030; train_masked_gp_l1_reg_loss: 92139.1261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100266.8706; train_chrom_access_recon_loss: 2030368.5587; train_global_loss: 22192120.8182; train_optim_loss: 22192120.8182; val_kl_reg_loss: 67785.8027; val_edge_recon_loss: 590623.4922; val_gene_expr_recon_loss: 19559645.0000; val_masked_gp_l1_reg_loss: 92742.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100431.3516; val_chrom_access_recon_loss: 2054939.5312; val_global_loss: 22466168.0000; val_optim_loss: 22466168.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9482; val_auprc_score: 0.9197; val_best_acc_score: 0.8960; val_best_f1_score: 0.8991; train_kl_reg_loss: 65083.0030; train_edge_recon_loss: 585398.9545; train_gene_expr_recon_loss: 19285823.1818; train_masked_gp_l1_reg_loss: 93240.9560; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99890.9157; train_chrom_access_recon_loss: 2026477.8087; train_global_loss: 22155914.9091; train_optim_loss: 22155914.9091; val_kl_reg_loss: 64556.8350; val_edge_recon_loss: 591152.1484; val_gene_expr_recon_loss: 19599633.0000; val_masked_gp_l1_reg_loss: 93789.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100315.4844; val_chrom_access_recon_loss: 2022049.9375; val_global_loss: 22471498.0000; val_optim_loss: 22471498.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9467; val_auprc_score: 0.9196; val_best_acc_score: 0.8966; val_best_f1_score: 0.9004; train_kl_reg_loss: 65018.7723; train_edge_recon_loss: 582932.4186; train_gene_expr_recon_loss: 19238278.0909; train_masked_gp_l1_reg_loss: 92820.5681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76210.9179; train_chrom_access_recon_loss: 2022284.7008; train_global_loss: 22077545.5455; train_optim_loss: 22077545.5455; val_kl_reg_loss: 66208.5127; val_edge_recon_loss: 589964.6875; val_gene_expr_recon_loss: 19553899.7500; val_masked_gp_l1_reg_loss: 92368.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69514.5547; val_chrom_access_recon_loss: 2045988.3594; val_global_loss: 22417943.0000; val_optim_loss: 22417943.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9531; val_auprc_score: 0.9394; val_best_acc_score: 0.9009; val_best_f1_score: 0.9042; train_kl_reg_loss: 65663.5176; train_edge_recon_loss: 583680.7197; train_gene_expr_recon_loss: 19217576.0000; train_masked_gp_l1_reg_loss: 92326.4006; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68514.5771; train_chrom_access_recon_loss: 2018712.1307; train_global_loss: 22046473.2424; train_optim_loss: 22046473.2424; val_kl_reg_loss: 66446.2256; val_edge_recon_loss: 589898.8750; val_gene_expr_recon_loss: 19287738.2500; val_masked_gp_l1_reg_loss: 92336.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67825.7188; val_chrom_access_recon_loss: 2004318.9062; val_global_loss: 22108563.7500; val_optim_loss: 22108563.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9558; val_auprc_score: 0.9434; val_best_acc_score: 0.8995; val_best_f1_score: 0.9022; train_kl_reg_loss: 66061.2341; train_edge_recon_loss: 582684.6089; train_gene_expr_recon_loss: 19220663.2424; train_masked_gp_l1_reg_loss: 92359.3459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67363.6797; train_chrom_access_recon_loss: 2017775.7235; train_global_loss: 22046907.9091; train_optim_loss: 22046907.9091; val_kl_reg_loss: 67061.0586; val_edge_recon_loss: 590382.7578; val_gene_expr_recon_loss: 19404497.5000; val_masked_gp_l1_reg_loss: 92400.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67007.2188; val_chrom_access_recon_loss: 2017301.6094; val_global_loss: 22238650.7500; val_optim_loss: 22238650.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9532; val_auprc_score: 0.9358; val_best_acc_score: 0.9027; val_best_f1_score: 0.9062; train_kl_reg_loss: 66114.3211; train_edge_recon_loss: 582128.5455; train_gene_expr_recon_loss: 19192466.3333; train_masked_gp_l1_reg_loss: 92438.6052; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66715.3723; train_chrom_access_recon_loss: 2016245.3693; train_global_loss: 22016108.3333; train_optim_loss: 22016108.3333; val_kl_reg_loss: 67485.3340; val_edge_recon_loss: 587975.1328; val_gene_expr_recon_loss: 19476681.7500; val_masked_gp_l1_reg_loss: 92481.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66406.1172; val_chrom_access_recon_loss: 2025612.9375; val_global_loss: 22316642.7500; val_optim_loss: 22316642.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9493; val_auprc_score: 0.9283; val_best_acc_score: 0.8920; val_best_f1_score: 0.8965; train_kl_reg_loss: 66256.8886; train_edge_recon_loss: 583017.8636; train_gene_expr_recon_loss: 19200724.3939; train_masked_gp_l1_reg_loss: 92546.8103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66256.9693; train_chrom_access_recon_loss: 2016680.1193; train_global_loss: 22025483.2424; train_optim_loss: 22025483.2424; val_kl_reg_loss: 67180.5566; val_edge_recon_loss: 591487.5859; val_gene_expr_recon_loss: 19419982.0000; val_masked_gp_l1_reg_loss: 92604.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65917.4219; val_chrom_access_recon_loss: 2015743.8438; val_global_loss: 22252915.7500; val_optim_loss: 22252915.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9491; val_auprc_score: 0.9263; val_best_acc_score: 0.8963; val_best_f1_score: 0.9003; train_kl_reg_loss: 66384.2257; train_edge_recon_loss: 582286.9801; train_gene_expr_recon_loss: 19205282.6364; train_masked_gp_l1_reg_loss: 92656.6114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65707.8447; train_chrom_access_recon_loss: 2016570.1098; train_global_loss: 22028888.4242; train_optim_loss: 22028888.4242; val_kl_reg_loss: 66998.1865; val_edge_recon_loss: 590785.7344; val_gene_expr_recon_loss: 19412354.0000; val_masked_gp_l1_reg_loss: 92726.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65602.5391; val_chrom_access_recon_loss: 2010724.9844; val_global_loss: 22239191.0000; val_optim_loss: 22239191.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9554; val_auprc_score: 0.9405; val_best_acc_score: 0.9009; val_best_f1_score: 0.9034; train_kl_reg_loss: 66084.9786; train_edge_recon_loss: 581769.3939; train_gene_expr_recon_loss: 19187687.8182; train_masked_gp_l1_reg_loss: 92629.1496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63300.1261; train_chrom_access_recon_loss: 2015763.8125; train_global_loss: 22007235.1818; train_optim_loss: 22007235.1818; val_kl_reg_loss: 67202.6699; val_edge_recon_loss: 590945.9844; val_gene_expr_recon_loss: 19434972.5000; val_masked_gp_l1_reg_loss: 92573.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62678.6680; val_chrom_access_recon_loss: 2010242.0625; val_global_loss: 22258614.7500; val_optim_loss: 22258614.7500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9536; val_auprc_score: 0.9364; val_best_acc_score: 0.8984; val_best_f1_score: 0.9010; train_kl_reg_loss: 66189.5036; train_edge_recon_loss: 583073.2017; train_gene_expr_recon_loss: 19175765.0303; train_masked_gp_l1_reg_loss: 92562.4413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62558.1947; train_chrom_access_recon_loss: 2012342.5814; train_global_loss: 21992490.8485; train_optim_loss: 21992490.8485; val_kl_reg_loss: 67180.7451; val_edge_recon_loss: 589949.4453; val_gene_expr_recon_loss: 19318839.5000; val_masked_gp_l1_reg_loss: 92556.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62452.8125; val_chrom_access_recon_loss: 2012008.8281; val_global_loss: 22142986.5000; val_optim_loss: 22142986.5000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9504; val_auprc_score: 0.9366; val_best_acc_score: 0.8941; val_best_f1_score: 0.8979; train_kl_reg_loss: 66185.3419; train_edge_recon_loss: 583250.4337; train_gene_expr_recon_loss: 19175772.2424; train_masked_gp_l1_reg_loss: 92555.3453; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62379.6585; train_chrom_access_recon_loss: 2014871.6818; train_global_loss: 21995014.6061; train_optim_loss: 21995014.6061; val_kl_reg_loss: 67222.7031; val_edge_recon_loss: 594239.2422; val_gene_expr_recon_loss: 19495542.7500; val_masked_gp_l1_reg_loss: 92556.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62310.5938; val_chrom_access_recon_loss: 2033305.2344; val_global_loss: 22345176.0000; val_optim_loss: 22345176.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9528; val_auprc_score: 0.9404; val_best_acc_score: 0.8968; val_best_f1_score: 0.9006; train_kl_reg_loss: 66275.1277; train_edge_recon_loss: 582231.2784; train_gene_expr_recon_loss: 19187553.6970; train_masked_gp_l1_reg_loss: 92559.3232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62258.8943; train_chrom_access_recon_loss: 2014836.3314; train_global_loss: 22005714.6667; train_optim_loss: 22005714.6667; val_kl_reg_loss: 67242.2764; val_edge_recon_loss: 594147.4453; val_gene_expr_recon_loss: 19506140.5000; val_masked_gp_l1_reg_loss: 92563.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62210.4805; val_chrom_access_recon_loss: 2021390.2188; val_global_loss: 22343694.2500; val_optim_loss: 22343694.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 14 min 43 sec.
Using best model state, which was in epoch 28.

--- MODEL EVALUATION ---
val AUROC score: 0.9485
val AUPRC score: 0.9310
val best accuracy score: 0.8920
val best F1 score: 0.8962
val target rna MSE score: 1.1454
val source rna MSE score: 0.5665
val target atac MSE score: 0.3226
val source atac MSE score: 0.1338
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
