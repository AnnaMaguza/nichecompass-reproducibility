[True]
Run timestamp: 07082024_105223_10.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--no-include_omnipath_gps', '--no-include_nichenet_gps', '--include_mebocost_gps', '--no-include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--seed', '0', '--timestamp_suffix', '_10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 115.
Number of gene programs after filtering and combining: 94.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 77, n_latent: 77, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 77, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 77, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8889; val_auprc_score: 0.9787; val_best_acc_score: 0.8545; val_best_f1_score: 0.9209; train_kl_reg_loss: 53264.6474; train_edge_recon_loss: 1078039.8479; train_gene_expr_recon_loss: 1924863.0400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 3056167.5361; train_optim_loss: 3056167.5361; val_kl_reg_loss: 65336.2715; val_edge_recon_loss: 1192584.7231; val_gene_expr_recon_loss: 1562371.8535; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2820292.8360; val_optim_loss: 2820292.8360
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8597; val_auprc_score: 0.9735; val_best_acc_score: 0.8705; val_best_f1_score: 0.9287; train_kl_reg_loss: 38251.1938; train_edge_recon_loss: 990650.0654; train_gene_expr_recon_loss: 1503290.4683; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2532191.7237; train_optim_loss: 2532191.7237; val_kl_reg_loss: 37510.7243; val_edge_recon_loss: 940370.6935; val_gene_expr_recon_loss: 1452072.2823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2429953.6801; val_optim_loss: 2429953.6801
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8739; val_auprc_score: 0.9741; val_best_acc_score: 0.8863; val_best_f1_score: 0.9370; train_kl_reg_loss: 33307.4142; train_edge_recon_loss: 911616.1977; train_gene_expr_recon_loss: 1405955.7121; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2350879.3253; train_optim_loss: 2350879.3253; val_kl_reg_loss: 29894.2072; val_edge_recon_loss: 904337.3219; val_gene_expr_recon_loss: 1366834.4489; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2301065.9919; val_optim_loss: 2301065.9919
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9008; val_auprc_score: 0.9785; val_best_acc_score: 0.9032; val_best_f1_score: 0.9443; train_kl_reg_loss: 27968.8332; train_edge_recon_loss: 858894.7711; train_gene_expr_recon_loss: 1336992.4931; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2223856.1027; train_optim_loss: 2223856.1027; val_kl_reg_loss: 28036.2979; val_edge_recon_loss: 850946.2762; val_gene_expr_recon_loss: 1309330.4126; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2188312.9946; val_optim_loss: 2188312.9946
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9185; val_auprc_score: 0.9826; val_best_acc_score: 0.9196; val_best_f1_score: 0.9538; train_kl_reg_loss: 24282.2863; train_edge_recon_loss: 827492.2244; train_gene_expr_recon_loss: 1285347.4025; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2137121.9064; train_optim_loss: 2137121.9064; val_kl_reg_loss: 20288.0305; val_edge_recon_loss: 845351.1035; val_gene_expr_recon_loss: 1265669.9677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2131309.0981; val_optim_loss: 2131309.0981
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9232; val_auprc_score: 0.9842; val_best_acc_score: 0.9218; val_best_f1_score: 0.9552; train_kl_reg_loss: 18334.7169; train_edge_recon_loss: 810678.6412; train_gene_expr_recon_loss: 1245333.7637; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2074347.1238; train_optim_loss: 2074347.1238; val_kl_reg_loss: 15854.8894; val_edge_recon_loss: 809414.6196; val_gene_expr_recon_loss: 1233473.5578; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2058743.0618; val_optim_loss: 2058743.0618
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9365; val_auprc_score: 0.9863; val_best_acc_score: 0.9328; val_best_f1_score: 0.9614; train_kl_reg_loss: 13226.5303; train_edge_recon_loss: 803364.2724; train_gene_expr_recon_loss: 1214094.7361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 2030685.5360; train_optim_loss: 2030685.5360; val_kl_reg_loss: 11018.5777; val_edge_recon_loss: 796738.6734; val_gene_expr_recon_loss: 1201783.6411; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 2009540.8911; val_optim_loss: 2009540.8911
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9453; val_auprc_score: 0.9879; val_best_acc_score: 0.9335; val_best_f1_score: 0.9617; train_kl_reg_loss: 9847.5352; train_edge_recon_loss: 789429.3612; train_gene_expr_recon_loss: 1191937.3093; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1991214.2103; train_optim_loss: 1991214.2103; val_kl_reg_loss: 7776.4561; val_edge_recon_loss: 797073.5208; val_gene_expr_recon_loss: 1183311.8118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1988161.7849; val_optim_loss: 1988161.7849
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9540; val_auprc_score: 0.9888; val_best_acc_score: 0.9425; val_best_f1_score: 0.9668; train_kl_reg_loss: 7273.2031; train_edge_recon_loss: 794627.3697; train_gene_expr_recon_loss: 1175716.7053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1977617.2770; train_optim_loss: 1977617.2770; val_kl_reg_loss: 6207.4638; val_edge_recon_loss: 788867.6626; val_gene_expr_recon_loss: 1169347.2917; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1964422.4073; val_optim_loss: 1964422.4073
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9511; val_auprc_score: 0.9887; val_best_acc_score: 0.9424; val_best_f1_score: 0.9668; train_kl_reg_loss: 5775.1673; train_edge_recon_loss: 778387.6514; train_gene_expr_recon_loss: 1163714.3884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1947877.2086; train_optim_loss: 1947877.2086; val_kl_reg_loss: 5346.2979; val_edge_recon_loss: 796695.2722; val_gene_expr_recon_loss: 1158473.4718; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1960515.0444; val_optim_loss: 1960515.0444
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9596; val_auprc_score: 0.9904; val_best_acc_score: 0.9498; val_best_f1_score: 0.9708; train_kl_reg_loss: 4762.3129; train_edge_recon_loss: 769983.6157; train_gene_expr_recon_loss: 1155158.2642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1929904.1935; train_optim_loss: 1929904.1935; val_kl_reg_loss: 3950.2543; val_edge_recon_loss: 802070.9415; val_gene_expr_recon_loss: 1155653.8118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1961675.0040; val_optim_loss: 1961675.0040
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9600; val_auprc_score: 0.9907; val_best_acc_score: 0.9476; val_best_f1_score: 0.9697; train_kl_reg_loss: 3969.0653; train_edge_recon_loss: 771614.6335; train_gene_expr_recon_loss: 1149323.1599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1924906.8575; train_optim_loss: 1924906.8575; val_kl_reg_loss: 3808.3188; val_edge_recon_loss: 781779.8138; val_gene_expr_recon_loss: 1150677.9677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1936266.0995; val_optim_loss: 1936266.0995
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9605; val_auprc_score: 0.9909; val_best_acc_score: 0.9490; val_best_f1_score: 0.9704; train_kl_reg_loss: 3445.5429; train_edge_recon_loss: 780715.4475; train_gene_expr_recon_loss: 1146224.7282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1930385.7194; train_optim_loss: 1930385.7194; val_kl_reg_loss: 3076.4480; val_edge_recon_loss: 782550.4987; val_gene_expr_recon_loss: 1146642.7890; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1932269.7245; val_optim_loss: 1932269.7245
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9657; val_auprc_score: 0.9916; val_best_acc_score: 0.9566; val_best_f1_score: 0.9749; train_kl_reg_loss: 3025.9968; train_edge_recon_loss: 777186.4282; train_gene_expr_recon_loss: 1143520.8850; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1923733.3112; train_optim_loss: 1923733.3112; val_kl_reg_loss: 3218.3635; val_edge_recon_loss: 767504.8616; val_gene_expr_recon_loss: 1142124.5672; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1912847.7930; val_optim_loss: 1912847.7930
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9683; val_auprc_score: 0.9928; val_best_acc_score: 0.9573; val_best_f1_score: 0.9751; train_kl_reg_loss: 2888.8370; train_edge_recon_loss: 763972.8556; train_gene_expr_recon_loss: 1140761.2027; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1907622.8940; train_optim_loss: 1907622.8940; val_kl_reg_loss: 2862.5584; val_edge_recon_loss: 786076.1815; val_gene_expr_recon_loss: 1141177.8696; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1930116.6022; val_optim_loss: 1930116.6022
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9665; val_auprc_score: 0.9923; val_best_acc_score: 0.9579; val_best_f1_score: 0.9756; train_kl_reg_loss: 2549.1389; train_edge_recon_loss: 767581.4540; train_gene_expr_recon_loss: 1139687.5087; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1909818.1038; train_optim_loss: 1909818.1038; val_kl_reg_loss: 2702.1729; val_edge_recon_loss: 771336.3945; val_gene_expr_recon_loss: 1137794.3495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1911832.9153; val_optim_loss: 1911832.9153
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9654; val_auprc_score: 0.9917; val_best_acc_score: 0.9567; val_best_f1_score: 0.9749; train_kl_reg_loss: 2557.6252; train_edge_recon_loss: 768753.9256; train_gene_expr_recon_loss: 1136389.8777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1907701.4285; train_optim_loss: 1907701.4285; val_kl_reg_loss: 2717.6276; val_edge_recon_loss: 783454.3132; val_gene_expr_recon_loss: 1135172.2823; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1921344.2164; val_optim_loss: 1921344.2164
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9666; val_auprc_score: 0.9923; val_best_acc_score: 0.9556; val_best_f1_score: 0.9742; train_kl_reg_loss: 2466.8140; train_edge_recon_loss: 765417.8552; train_gene_expr_recon_loss: 1134489.1714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1902373.8420; train_optim_loss: 1902373.8420; val_kl_reg_loss: 2541.9494; val_edge_recon_loss: 789220.7090; val_gene_expr_recon_loss: 1143144.2567; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1934906.9180; val_optim_loss: 1934906.9180
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9709; val_auprc_score: 0.9930; val_best_acc_score: 0.9600; val_best_f1_score: 0.9768; train_kl_reg_loss: 2410.6629; train_edge_recon_loss: 771681.9035; train_gene_expr_recon_loss: 1133794.7582; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1907887.3274; train_optim_loss: 1907887.3274; val_kl_reg_loss: 2687.0117; val_edge_recon_loss: 785492.0773; val_gene_expr_recon_loss: 1135896.9664; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1924076.0605; val_optim_loss: 1924076.0605
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9674; val_auprc_score: 0.9916; val_best_acc_score: 0.9587; val_best_f1_score: 0.9760; train_kl_reg_loss: 2475.6022; train_edge_recon_loss: 761682.4975; train_gene_expr_recon_loss: 1131848.4691; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1896006.5666; train_optim_loss: 1896006.5666; val_kl_reg_loss: 2389.4839; val_edge_recon_loss: 784876.3105; val_gene_expr_recon_loss: 1131114.0376; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1918379.8266; val_optim_loss: 1918379.8266

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9713; val_auprc_score: 0.9936; val_best_acc_score: 0.9612; val_best_f1_score: 0.9776; train_kl_reg_loss: 2308.0753; train_edge_recon_loss: 760970.2493; train_gene_expr_recon_loss: 1128834.8335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1892113.1571; train_optim_loss: 1892113.1571; val_kl_reg_loss: 2242.7864; val_edge_recon_loss: 756259.4970; val_gene_expr_recon_loss: 1129131.4019; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1887633.6841; val_optim_loss: 1887633.6841
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9698; val_auprc_score: 0.9920; val_best_acc_score: 0.9610; val_best_f1_score: 0.9773; train_kl_reg_loss: 2251.8928; train_edge_recon_loss: 762871.6594; train_gene_expr_recon_loss: 1128420.2306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1893543.7814; train_optim_loss: 1893543.7814; val_kl_reg_loss: 2172.3739; val_edge_recon_loss: 786842.0148; val_gene_expr_recon_loss: 1129697.1142; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1918711.5000; val_optim_loss: 1918711.5000
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9723; val_auprc_score: 0.9939; val_best_acc_score: 0.9611; val_best_f1_score: 0.9774; train_kl_reg_loss: 2232.3201; train_edge_recon_loss: 756995.4788; train_gene_expr_recon_loss: 1128046.4007; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1887274.2012; train_optim_loss: 1887274.2012; val_kl_reg_loss: 2159.4443; val_edge_recon_loss: 771458.6196; val_gene_expr_recon_loss: 1128872.7487; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1902490.8065; val_optim_loss: 1902490.8065
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9679; val_auprc_score: 0.9913; val_best_acc_score: 0.9610; val_best_f1_score: 0.9773; train_kl_reg_loss: 2197.0446; train_edge_recon_loss: 761411.5380; train_gene_expr_recon_loss: 1128039.9413; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1891648.5218; train_optim_loss: 1891648.5218; val_kl_reg_loss: 2221.0173; val_edge_recon_loss: 766832.1680; val_gene_expr_recon_loss: 1129113.6384; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1898166.8293; val_optim_loss: 1898166.8293
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9700; val_auprc_score: 0.9930; val_best_acc_score: 0.9624; val_best_f1_score: 0.9783; train_kl_reg_loss: 2208.6945; train_edge_recon_loss: 760937.5674; train_gene_expr_recon_loss: 1128181.9948; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1891328.2551; train_optim_loss: 1891328.2551; val_kl_reg_loss: 2239.6078; val_edge_recon_loss: 754025.5941; val_gene_expr_recon_loss: 1128057.3185; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1884322.5282; val_optim_loss: 1884322.5282
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9693; val_auprc_score: 0.9922; val_best_acc_score: 0.9617; val_best_f1_score: 0.9777; train_kl_reg_loss: 2199.9666; train_edge_recon_loss: 760063.4695; train_gene_expr_recon_loss: 1127837.9670; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1890101.4008; train_optim_loss: 1890101.4008; val_kl_reg_loss: 2019.2035; val_edge_recon_loss: 777125.1035; val_gene_expr_recon_loss: 1128863.3078; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1908007.6062; val_optim_loss: 1908007.6062
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9732; val_auprc_score: 0.9937; val_best_acc_score: 0.9628; val_best_f1_score: 0.9784; train_kl_reg_loss: 2190.8983; train_edge_recon_loss: 758466.8150; train_gene_expr_recon_loss: 1127726.8886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1888384.5998; train_optim_loss: 1888384.5998; val_kl_reg_loss: 1979.9902; val_edge_recon_loss: 756187.0575; val_gene_expr_recon_loss: 1129159.6210; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1887326.6586; val_optim_loss: 1887326.6586
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9707; val_auprc_score: 0.9930; val_best_acc_score: 0.9620; val_best_f1_score: 0.9779; train_kl_reg_loss: 2096.3952; train_edge_recon_loss: 763715.8028; train_gene_expr_recon_loss: 1127863.8324; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1893676.0324; train_optim_loss: 1893676.0324; val_kl_reg_loss: 1864.1142; val_edge_recon_loss: 781429.2245; val_gene_expr_recon_loss: 1127806.7500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1911100.0847; val_optim_loss: 1911100.0847
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9699; val_auprc_score: 0.9929; val_best_acc_score: 0.9625; val_best_f1_score: 0.9782; train_kl_reg_loss: 2063.3132; train_edge_recon_loss: 761907.3625; train_gene_expr_recon_loss: 1127795.8197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1891766.4936; train_optim_loss: 1891766.4936; val_kl_reg_loss: 1915.8944; val_edge_recon_loss: 768817.8612; val_gene_expr_recon_loss: 1128573.1855; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1899306.9382; val_optim_loss: 1899306.9382

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9699; val_auprc_score: 0.9928; val_best_acc_score: 0.9617; val_best_f1_score: 0.9777; train_kl_reg_loss: 2082.9802; train_edge_recon_loss: 764224.4800; train_gene_expr_recon_loss: 1127271.6010; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1893579.0593; train_optim_loss: 1893579.0593; val_kl_reg_loss: 1894.9617; val_edge_recon_loss: 783483.9382; val_gene_expr_recon_loss: 1127458.9543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1912837.8468; val_optim_loss: 1912837.8468
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9694; val_auprc_score: 0.9929; val_best_acc_score: 0.9625; val_best_f1_score: 0.9783; train_kl_reg_loss: 2069.0692; train_edge_recon_loss: 761186.4295; train_gene_expr_recon_loss: 1127415.8139; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1890671.3111; train_optim_loss: 1890671.3111; val_kl_reg_loss: 1892.1952; val_edge_recon_loss: 763560.9395; val_gene_expr_recon_loss: 1128315.5806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1893768.7137; val_optim_loss: 1893768.7137
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9730; val_auprc_score: 0.9934; val_best_acc_score: 0.9643; val_best_f1_score: 0.9792; train_kl_reg_loss: 2062.0390; train_edge_recon_loss: 764667.6391; train_gene_expr_recon_loss: 1127184.3616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1893914.0397; train_optim_loss: 1893914.0397; val_kl_reg_loss: 1886.8129; val_edge_recon_loss: 765795.5531; val_gene_expr_recon_loss: 1128188.7608; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1895871.1277; val_optim_loss: 1895871.1277
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9720; val_auprc_score: 0.9933; val_best_acc_score: 0.9625; val_best_f1_score: 0.9783; train_kl_reg_loss: 2050.9466; train_edge_recon_loss: 764798.7262; train_gene_expr_recon_loss: 1127333.4131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 1894183.0871; train_optim_loss: 1894183.0871; val_kl_reg_loss: 1869.3844; val_edge_recon_loss: 767536.0360; val_gene_expr_recon_loss: 1127648.6075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 1897054.0228; val_optim_loss: 1897054.0228

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 3 sec.
Using best model state, which was in epoch 25.

--- MODEL EVALUATION ---
val AUROC score: 0.9719
val AUPRC score: 0.9932
val best accuracy score: 0.9625
val best F1 score: 0.9782
val target rna MSE score: 0.1954
val source rna MSE score: 1.0871
Val cat covariate0 mean sim diff: -0.0006

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
