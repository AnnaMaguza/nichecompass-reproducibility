[True]
Run timestamp: 10102023_032757_126.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_126']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7625; val_auprc_score: 0.7866; val_best_acc_score: 0.5115; val_best_f1_score: 0.6713; train_kl_reg_loss: 61595.5380; train_edge_recon_loss: 3525387.0916; train_gene_expr_recon_loss: 13435329.2290; train_masked_gp_l1_reg_loss: 117610.9119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2714203.3325; train_chrom_access_recon_loss: 11192099.7557; train_global_loss: 31046226.0458; train_optim_loss: 31046226.0458; val_kl_reg_loss: 91098.3167; val_edge_recon_loss: 4064225.5333; val_gene_expr_recon_loss: 12810611.2000; val_masked_gp_l1_reg_loss: 104545.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 388662.4062; val_chrom_access_recon_loss: 10991146.8667; val_global_loss: 28450290.1333; val_optim_loss: 28450290.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8042; val_auprc_score: 0.8238; val_best_acc_score: 0.6808; val_best_f1_score: 0.7311; train_kl_reg_loss: 86365.9229; train_edge_recon_loss: 3504099.1469; train_gene_expr_recon_loss: 12598153.1145; train_masked_gp_l1_reg_loss: 101627.3978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217512.7512; train_chrom_access_recon_loss: 10782726.2137; train_global_loss: 27290484.6107; train_optim_loss: 27290484.6107; val_kl_reg_loss: 79594.1938; val_edge_recon_loss: 4038373.0167; val_gene_expr_recon_loss: 12625178.2000; val_masked_gp_l1_reg_loss: 101067.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142724.1562; val_chrom_access_recon_loss: 10904455.8667; val_global_loss: 27891393.0667; val_optim_loss: 27891393.0667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8592; val_auprc_score: 0.8574; val_best_acc_score: 0.7580; val_best_f1_score: 0.7836; train_kl_reg_loss: 76172.4080; train_edge_recon_loss: 3320357.8931; train_gene_expr_recon_loss: 12437875.1450; train_masked_gp_l1_reg_loss: 104856.8682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 122032.8977; train_chrom_access_recon_loss: 10638436.2519; train_global_loss: 26699731.5267; train_optim_loss: 26699731.5267; val_kl_reg_loss: 104406.7422; val_edge_recon_loss: 3022879.8167; val_gene_expr_recon_loss: 12469997.0667; val_masked_gp_l1_reg_loss: 113476.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109810.7109; val_chrom_access_recon_loss: 10764953.8667; val_global_loss: 26585524.5333; val_optim_loss: 26585524.5333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8794; val_auprc_score: 0.8733; val_best_acc_score: 0.7855; val_best_f1_score: 0.7948; train_kl_reg_loss: 101347.8898; train_edge_recon_loss: 2960361.1107; train_gene_expr_recon_loss: 12326508.8779; train_masked_gp_l1_reg_loss: 118671.3514; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104240.2272; train_chrom_access_recon_loss: 10521454.6565; train_global_loss: 26132584.1527; train_optim_loss: 26132584.1527; val_kl_reg_loss: 107424.8896; val_edge_recon_loss: 2942455.1667; val_gene_expr_recon_loss: 12368303.3333; val_masked_gp_l1_reg_loss: 120068.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98882.9531; val_chrom_access_recon_loss: 10619301.2667; val_global_loss: 26256435.6000; val_optim_loss: 26256435.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8934; val_auprc_score: 0.8823; val_best_acc_score: 0.7913; val_best_f1_score: 0.8129; train_kl_reg_loss: 98612.6740; train_edge_recon_loss: 2936812.9580; train_gene_expr_recon_loss: 12201360.7863; train_masked_gp_l1_reg_loss: 120142.6998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96090.2913; train_chrom_access_recon_loss: 10424800.8855; train_global_loss: 25877820.3206; train_optim_loss: 25877820.3206; val_kl_reg_loss: 89873.5177; val_edge_recon_loss: 2924974.0333; val_gene_expr_recon_loss: 12298237.8667; val_masked_gp_l1_reg_loss: 120515.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93879.3750; val_chrom_access_recon_loss: 10629736.3333; val_global_loss: 26157217.0667; val_optim_loss: 26157217.0667
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9097; val_auprc_score: 0.8964; val_best_acc_score: 0.8270; val_best_f1_score: 0.8423; train_kl_reg_loss: 93039.7527; train_edge_recon_loss: 2895882.1469; train_gene_expr_recon_loss: 12087237.5420; train_masked_gp_l1_reg_loss: 120842.5137; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92512.8100; train_chrom_access_recon_loss: 10351859.0076; train_global_loss: 25641373.7099; train_optim_loss: 25641373.7099; val_kl_reg_loss: 93371.2292; val_edge_recon_loss: 2873826.7833; val_gene_expr_recon_loss: 12192336.9333; val_masked_gp_l1_reg_loss: 121628.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91633.7578; val_chrom_access_recon_loss: 10535422.9333; val_global_loss: 25908219.6000; val_optim_loss: 25908219.6000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9301; val_auprc_score: 0.9147; val_best_acc_score: 0.8601; val_best_f1_score: 0.8665; train_kl_reg_loss: 97744.3770; train_edge_recon_loss: 2826093.2844; train_gene_expr_recon_loss: 11986794.5420; train_masked_gp_l1_reg_loss: 122632.2867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90314.9396; train_chrom_access_recon_loss: 10277770.6947; train_global_loss: 25401350.1832; train_optim_loss: 25401350.1832; val_kl_reg_loss: 99574.6984; val_edge_recon_loss: 2818751.1833; val_gene_expr_recon_loss: 12015031.7333; val_masked_gp_l1_reg_loss: 123554.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88887.1016; val_chrom_access_recon_loss: 10381603.0000; val_global_loss: 25527401.7333; val_optim_loss: 25527401.7333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9328; val_auprc_score: 0.9169; val_best_acc_score: 0.8635; val_best_f1_score: 0.8738; train_kl_reg_loss: 98812.0551; train_edge_recon_loss: 2791248.1947; train_gene_expr_recon_loss: 11914793.7099; train_masked_gp_l1_reg_loss: 124196.2770; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87555.2659; train_chrom_access_recon_loss: 10218145.5878; train_global_loss: 25234751.1908; train_optim_loss: 25234751.1908; val_kl_reg_loss: 97631.5948; val_edge_recon_loss: 2822106.7500; val_gene_expr_recon_loss: 11979249.2000; val_masked_gp_l1_reg_loss: 124807.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86009.3516; val_chrom_access_recon_loss: 10403767.8667; val_global_loss: 25513571.3333; val_optim_loss: 25513571.3333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9395; val_auprc_score: 0.9246; val_best_acc_score: 0.8787; val_best_f1_score: 0.8858; train_kl_reg_loss: 96702.9433; train_edge_recon_loss: 2788139.7958; train_gene_expr_recon_loss: 11858373.8397; train_masked_gp_l1_reg_loss: 125555.2452; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84965.3256; train_chrom_access_recon_loss: 10172503.2214; train_global_loss: 25126240.4122; train_optim_loss: 25126240.4122; val_kl_reg_loss: 96706.5536; val_edge_recon_loss: 2799180.8500; val_gene_expr_recon_loss: 11904846.7333; val_masked_gp_l1_reg_loss: 126240.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84014.3125; val_chrom_access_recon_loss: 10259599.4000; val_global_loss: 25270588.5333; val_optim_loss: 25270588.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9372; val_auprc_score: 0.9225; val_best_acc_score: 0.8688; val_best_f1_score: 0.8772; train_kl_reg_loss: 95914.5383; train_edge_recon_loss: 2772076.9408; train_gene_expr_recon_loss: 11795364.2366; train_masked_gp_l1_reg_loss: 126601.3249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82744.6871; train_chrom_access_recon_loss: 10120834.2901; train_global_loss: 24993535.8779; train_optim_loss: 24993535.8779; val_kl_reg_loss: 94629.0594; val_edge_recon_loss: 2802758.0000; val_gene_expr_recon_loss: 11842296.3333; val_masked_gp_l1_reg_loss: 127372.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82415.6875; val_chrom_access_recon_loss: 10224953.1333; val_global_loss: 25174424.4000; val_optim_loss: 25174424.4000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9467; val_auprc_score: 0.9338; val_best_acc_score: 0.8847; val_best_f1_score: 0.8911; train_kl_reg_loss: 94804.5599; train_edge_recon_loss: 2760632.3034; train_gene_expr_recon_loss: 11738356.0611; train_masked_gp_l1_reg_loss: 127533.9680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81046.7465; train_chrom_access_recon_loss: 10048235.5725; train_global_loss: 24850609.2061; train_optim_loss: 24850609.2061; val_kl_reg_loss: 91596.2870; val_edge_recon_loss: 2768995.4833; val_gene_expr_recon_loss: 11814117.2667; val_masked_gp_l1_reg_loss: 127700.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80226.1641; val_chrom_access_recon_loss: 10186120.5333; val_global_loss: 25068756.5333; val_optim_loss: 25068756.5333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9437; val_auprc_score: 0.9295; val_best_acc_score: 0.8810; val_best_f1_score: 0.8865; train_kl_reg_loss: 94048.4040; train_edge_recon_loss: 2747295.4141; train_gene_expr_recon_loss: 11696068.6641; train_masked_gp_l1_reg_loss: 127906.0856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79487.2434; train_chrom_access_recon_loss: 10018439.5115; train_global_loss: 24763245.3435; train_optim_loss: 24763245.3435; val_kl_reg_loss: 93428.0891; val_edge_recon_loss: 2754041.3333; val_gene_expr_recon_loss: 11741068.9333; val_masked_gp_l1_reg_loss: 128116.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78953.1953; val_chrom_access_recon_loss: 10120058.0667; val_global_loss: 24915666.5333; val_optim_loss: 24915666.5333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9486; val_auprc_score: 0.9325; val_best_acc_score: 0.8880; val_best_f1_score: 0.8934; train_kl_reg_loss: 92876.4405; train_edge_recon_loss: 2745203.2844; train_gene_expr_recon_loss: 11653272.6107; train_masked_gp_l1_reg_loss: 128260.1195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78287.7680; train_chrom_access_recon_loss: 9976040.0305; train_global_loss: 24673940.2901; train_optim_loss: 24673940.2901; val_kl_reg_loss: 94014.3208; val_edge_recon_loss: 2750694.3667; val_gene_expr_recon_loss: 11742143.4667; val_masked_gp_l1_reg_loss: 128551.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77360.7188; val_chrom_access_recon_loss: 10084627.2667; val_global_loss: 24877390.9333; val_optim_loss: 24877390.9333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9497; val_auprc_score: 0.9349; val_best_acc_score: 0.8914; val_best_f1_score: 0.8967; train_kl_reg_loss: 92377.6383; train_edge_recon_loss: 2739440.0382; train_gene_expr_recon_loss: 11612357.5802; train_masked_gp_l1_reg_loss: 128511.1416; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77234.9927; train_chrom_access_recon_loss: 9936928.9695; train_global_loss: 24586850.2748; train_optim_loss: 24586850.2748; val_kl_reg_loss: 90748.8313; val_edge_recon_loss: 2757810.0833; val_gene_expr_recon_loss: 11707869.6667; val_masked_gp_l1_reg_loss: 128488.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76833.1250; val_chrom_access_recon_loss: 10052783.9333; val_global_loss: 24814533.3333; val_optim_loss: 24814533.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9531; val_auprc_score: 0.9406; val_best_acc_score: 0.8941; val_best_f1_score: 0.8998; train_kl_reg_loss: 90313.4122; train_edge_recon_loss: 2738660.9676; train_gene_expr_recon_loss: 11573865.0992; train_masked_gp_l1_reg_loss: 128556.4443; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76695.8341; train_chrom_access_recon_loss: 9901349.5038; train_global_loss: 24509441.2061; train_optim_loss: 24509441.2061; val_kl_reg_loss: 90190.4427; val_edge_recon_loss: 2755359.1333; val_gene_expr_recon_loss: 11645606.2667; val_masked_gp_l1_reg_loss: 128805.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76812.1641; val_chrom_access_recon_loss: 9999635.3333; val_global_loss: 24696408.8000; val_optim_loss: 24696408.8000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9607; val_auprc_score: 0.9508; val_best_acc_score: 0.9027; val_best_f1_score: 0.9071; train_kl_reg_loss: 88782.7332; train_edge_recon_loss: 2733183.5000; train_gene_expr_recon_loss: 11547986.0611; train_masked_gp_l1_reg_loss: 128724.7236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76178.1110; train_chrom_access_recon_loss: 9866362.0534; train_global_loss: 24441217.1450; train_optim_loss: 24441217.1450; val_kl_reg_loss: 89568.1156; val_edge_recon_loss: 2725190.0167; val_gene_expr_recon_loss: 11672131.0667; val_masked_gp_l1_reg_loss: 128663.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75622.9219; val_chrom_access_recon_loss: 10067658.5333; val_global_loss: 24758834.8000; val_optim_loss: 24758834.8000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9574; val_auprc_score: 0.9461; val_best_acc_score: 0.9025; val_best_f1_score: 0.9061; train_kl_reg_loss: 88010.0583; train_edge_recon_loss: 2727305.4256; train_gene_expr_recon_loss: 11523318.8779; train_masked_gp_l1_reg_loss: 128527.6733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75716.2250; train_chrom_access_recon_loss: 9835449.2595; train_global_loss: 24378327.5420; train_optim_loss: 24378327.5420; val_kl_reg_loss: 91496.4146; val_edge_recon_loss: 2744112.5167; val_gene_expr_recon_loss: 11550644.4667; val_masked_gp_l1_reg_loss: 128645.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75858.0312; val_chrom_access_recon_loss: 9931723.2667; val_global_loss: 24522479.6000; val_optim_loss: 24522479.6000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9560; val_auprc_score: 0.9420; val_best_acc_score: 0.8963; val_best_f1_score: 0.9008; train_kl_reg_loss: 89117.2093; train_edge_recon_loss: 2727015.8893; train_gene_expr_recon_loss: 11485536.8779; train_masked_gp_l1_reg_loss: 128268.8133; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75348.1162; train_chrom_access_recon_loss: 9795770.4733; train_global_loss: 24301057.4504; train_optim_loss: 24301057.4504; val_kl_reg_loss: 87514.9193; val_edge_recon_loss: 2748667.1667; val_gene_expr_recon_loss: 11577632.6667; val_masked_gp_l1_reg_loss: 128126.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75434.3750; val_chrom_access_recon_loss: 9979926.3333; val_global_loss: 24597302.2667; val_optim_loss: 24597302.2667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9577; val_auprc_score: 0.9445; val_best_acc_score: 0.8998; val_best_f1_score: 0.9033; train_kl_reg_loss: 86682.2322; train_edge_recon_loss: 2720985.5286; train_gene_expr_recon_loss: 11464070.1908; train_masked_gp_l1_reg_loss: 127845.8661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75024.3508; train_chrom_access_recon_loss: 9767330.3511; train_global_loss: 24241938.4885; train_optim_loss: 24241938.4885; val_kl_reg_loss: 91671.6536; val_edge_recon_loss: 2757198.3000; val_gene_expr_recon_loss: 11518863.8667; val_masked_gp_l1_reg_loss: 127817.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75317.1562; val_chrom_access_recon_loss: 9896828.4667; val_global_loss: 24467697.6000; val_optim_loss: 24467697.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9629; val_auprc_score: 0.9537; val_best_acc_score: 0.9056; val_best_f1_score: 0.9098; train_kl_reg_loss: 87080.1601; train_edge_recon_loss: 2717277.5267; train_gene_expr_recon_loss: 11443688.9237; train_masked_gp_l1_reg_loss: 127652.4530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74962.9049; train_chrom_access_recon_loss: 9747995.1221; train_global_loss: 24198657.0229; train_optim_loss: 24198657.0229; val_kl_reg_loss: 85918.8161; val_edge_recon_loss: 2743626.0000; val_gene_expr_recon_loss: 11537346.8000; val_masked_gp_l1_reg_loss: 127484.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75332.6641; val_chrom_access_recon_loss: 9933130.2667; val_global_loss: 24502840.0000; val_optim_loss: 24502840.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9633; val_auprc_score: 0.9521; val_best_acc_score: 0.9099; val_best_f1_score: 0.9129; train_kl_reg_loss: 86363.5543; train_edge_recon_loss: 2711961.9885; train_gene_expr_recon_loss: 11426098.0687; train_masked_gp_l1_reg_loss: 127241.0828; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74932.5365; train_chrom_access_recon_loss: 9720291.8321; train_global_loss: 24146889.0076; train_optim_loss: 24146889.0076; val_kl_reg_loss: 87820.5943; val_edge_recon_loss: 2726180.7500; val_gene_expr_recon_loss: 11547979.4667; val_masked_gp_l1_reg_loss: 127147.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74924.3281; val_chrom_access_recon_loss: 9896739.5333; val_global_loss: 24460792.0000; val_optim_loss: 24460792.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9653; val_auprc_score: 0.9560; val_best_acc_score: 0.9142; val_best_f1_score: 0.9179; train_kl_reg_loss: 85990.9123; train_edge_recon_loss: 2707822.2462; train_gene_expr_recon_loss: 11409476.7405; train_masked_gp_l1_reg_loss: 126709.9486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74912.6098; train_chrom_access_recon_loss: 9704846.2824; train_global_loss: 24109758.7176; train_optim_loss: 24109758.7176; val_kl_reg_loss: 87536.1615; val_edge_recon_loss: 2715576.5500; val_gene_expr_recon_loss: 11502343.8000; val_masked_gp_l1_reg_loss: 126534.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75616.0703; val_chrom_access_recon_loss: 9879268.8667; val_global_loss: 24386875.4667; val_optim_loss: 24386875.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9662; val_auprc_score: 0.9575; val_best_acc_score: 0.9127; val_best_f1_score: 0.9161; train_kl_reg_loss: 86220.3430; train_edge_recon_loss: 2706644.8111; train_gene_expr_recon_loss: 11397454.0458; train_masked_gp_l1_reg_loss: 125897.1421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75358.9831; train_chrom_access_recon_loss: 9678005.1756; train_global_loss: 24069580.3969; train_optim_loss: 24069580.3969; val_kl_reg_loss: 85464.8635; val_edge_recon_loss: 2742240.1000; val_gene_expr_recon_loss: 11528125.2667; val_masked_gp_l1_reg_loss: 125479.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75394.3047; val_chrom_access_recon_loss: 9877955.4000; val_global_loss: 24434659.4667; val_optim_loss: 24434659.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9673; val_auprc_score: 0.9571; val_best_acc_score: 0.9146; val_best_f1_score: 0.9180; train_kl_reg_loss: 86129.0024; train_edge_recon_loss: 2706548.9905; train_gene_expr_recon_loss: 11379065.8168; train_masked_gp_l1_reg_loss: 125031.2998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75516.9229; train_chrom_access_recon_loss: 9648880.3664; train_global_loss: 24021172.3969; train_optim_loss: 24021172.3969; val_kl_reg_loss: 86346.2766; val_edge_recon_loss: 2715732.5667; val_gene_expr_recon_loss: 11423610.4667; val_masked_gp_l1_reg_loss: 124477.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75775.0938; val_chrom_access_recon_loss: 9771336.5000; val_global_loss: 24197278.6667; val_optim_loss: 24197278.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9685; val_auprc_score: 0.9609; val_best_acc_score: 0.9136; val_best_f1_score: 0.9172; train_kl_reg_loss: 85588.8021; train_edge_recon_loss: 2707538.1756; train_gene_expr_recon_loss: 11365662.4122; train_masked_gp_l1_reg_loss: 124293.8723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75847.0888; train_chrom_access_recon_loss: 9631330.2824; train_global_loss: 23990260.6260; train_optim_loss: 23990260.6260; val_kl_reg_loss: 85173.6906; val_edge_recon_loss: 2714884.1500; val_gene_expr_recon_loss: 11468164.0667; val_masked_gp_l1_reg_loss: 123838.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75717.6797; val_chrom_access_recon_loss: 9801647.7333; val_global_loss: 24269425.6000; val_optim_loss: 24269425.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9660; val_auprc_score: 0.9541; val_best_acc_score: 0.9107; val_best_f1_score: 0.9142; train_kl_reg_loss: 102579.1670; train_edge_recon_loss: 2776660.7061; train_gene_expr_recon_loss: 10643439.9924; train_masked_gp_l1_reg_loss: 123336.2963; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72776.0673; train_chrom_access_recon_loss: 9192281.4427; train_global_loss: 22911073.6336; train_optim_loss: 22911073.6336; val_kl_reg_loss: 44007.8940; val_edge_recon_loss: 2732671.9833; val_gene_expr_recon_loss: 10678644.4000; val_masked_gp_l1_reg_loss: 123119.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73063.1094; val_chrom_access_recon_loss: 9296076.5333; val_global_loss: 22947582.8000; val_optim_loss: 22947582.8000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9662; val_auprc_score: 0.9574; val_best_acc_score: 0.9175; val_best_f1_score: 0.9201; train_kl_reg_loss: 86624.9913; train_edge_recon_loss: 2734515.5324; train_gene_expr_recon_loss: 10617721.3130; train_masked_gp_l1_reg_loss: 121865.1978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73177.0491; train_chrom_access_recon_loss: 9155694.0916; train_global_loss: 22789598.1374; train_optim_loss: 22789598.1374; val_kl_reg_loss: 49791.1276; val_edge_recon_loss: 2736818.7667; val_gene_expr_recon_loss: 10644635.8000; val_masked_gp_l1_reg_loss: 120503.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73251.7188; val_chrom_access_recon_loss: 9250685.5333; val_global_loss: 22875686.2667; val_optim_loss: 22875686.2667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9681; val_auprc_score: 0.9605; val_best_acc_score: 0.9163; val_best_f1_score: 0.9196; train_kl_reg_loss: 79427.2536; train_edge_recon_loss: 2716388.1374; train_gene_expr_recon_loss: 10585060.5496; train_masked_gp_l1_reg_loss: 119262.1696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73486.4713; train_chrom_access_recon_loss: 9139567.6298; train_global_loss: 22713192.3969; train_optim_loss: 22713192.3969; val_kl_reg_loss: 53310.0875; val_edge_recon_loss: 2720401.0833; val_gene_expr_recon_loss: 10660784.9333; val_masked_gp_l1_reg_loss: 117861.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73083.6016; val_chrom_access_recon_loss: 9309380.2667; val_global_loss: 22934821.2000; val_optim_loss: 22934821.2000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9694; val_auprc_score: 0.9613; val_best_acc_score: 0.9179; val_best_f1_score: 0.9208; train_kl_reg_loss: 75153.7953; train_edge_recon_loss: 2697512.5286; train_gene_expr_recon_loss: 10543071.6641; train_masked_gp_l1_reg_loss: 116744.7852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73433.5977; train_chrom_access_recon_loss: 9099160.6489; train_global_loss: 22605076.8855; train_optim_loss: 22605076.8855; val_kl_reg_loss: 57531.5648; val_edge_recon_loss: 2704311.5833; val_gene_expr_recon_loss: 10589283.7333; val_masked_gp_l1_reg_loss: 115724.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73562.9375; val_chrom_access_recon_loss: 9207236.0667; val_global_loss: 22747650.9333; val_optim_loss: 22747650.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9672; val_auprc_score: 0.9586; val_best_acc_score: 0.9117; val_best_f1_score: 0.9155; train_kl_reg_loss: 72805.0451; train_edge_recon_loss: 2701413.1298; train_gene_expr_recon_loss: 10532828.9084; train_masked_gp_l1_reg_loss: 114662.5912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73232.1843; train_chrom_access_recon_loss: 9079711.5496; train_global_loss: 22574653.3130; train_optim_loss: 22574653.3130; val_kl_reg_loss: 59624.7362; val_edge_recon_loss: 2737609.2667; val_gene_expr_recon_loss: 10592370.4667; val_masked_gp_l1_reg_loss: 113712.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73354.9141; val_chrom_access_recon_loss: 9169045.8000; val_global_loss: 22745718.0000; val_optim_loss: 22745718.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9694; val_auprc_score: 0.9614; val_best_acc_score: 0.9178; val_best_f1_score: 0.9208; train_kl_reg_loss: 72271.4856; train_edge_recon_loss: 2693522.8855; train_gene_expr_recon_loss: 10512553.9542; train_masked_gp_l1_reg_loss: 112875.6308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73153.3836; train_chrom_access_recon_loss: 9067582.3588; train_global_loss: 22531959.6947; train_optim_loss: 22531959.6947; val_kl_reg_loss: 64440.1549; val_edge_recon_loss: 2703601.7500; val_gene_expr_recon_loss: 10615305.2000; val_masked_gp_l1_reg_loss: 112175.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73021.3750; val_chrom_access_recon_loss: 9201833.4000; val_global_loss: 22770377.4667; val_optim_loss: 22770377.4667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9727; val_auprc_score: 0.9678; val_best_acc_score: 0.9194; val_best_f1_score: 0.9231; train_kl_reg_loss: 71962.0658; train_edge_recon_loss: 2694179.9141; train_gene_expr_recon_loss: 10502591.1756; train_masked_gp_l1_reg_loss: 111406.6744; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72912.1549; train_chrom_access_recon_loss: 9044048.5534; train_global_loss: 22497100.5344; train_optim_loss: 22497100.5344; val_kl_reg_loss: 61191.3396; val_edge_recon_loss: 2697576.8833; val_gene_expr_recon_loss: 10601850.1333; val_masked_gp_l1_reg_loss: 110906.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73014.2422; val_chrom_access_recon_loss: 9132442.0667; val_global_loss: 22676980.1333; val_optim_loss: 22676980.1333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9695; val_auprc_score: 0.9610; val_best_acc_score: 0.9204; val_best_f1_score: 0.9239; train_kl_reg_loss: 69955.4173; train_edge_recon_loss: 2682293.8492; train_gene_expr_recon_loss: 10484425.2061; train_masked_gp_l1_reg_loss: 110263.8457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73017.3161; train_chrom_access_recon_loss: 9029410.7634; train_global_loss: 22449366.3664; train_optim_loss: 22449366.3664; val_kl_reg_loss: 61717.6031; val_edge_recon_loss: 2697044.4333; val_gene_expr_recon_loss: 10638531.0667; val_masked_gp_l1_reg_loss: 110026.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72976.6719; val_chrom_access_recon_loss: 9229661.1333; val_global_loss: 22809958.2667; val_optim_loss: 22809958.2667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9711; val_auprc_score: 0.9643; val_best_acc_score: 0.9175; val_best_f1_score: 0.9200; train_kl_reg_loss: 70504.3304; train_edge_recon_loss: 2686280.0897; train_gene_expr_recon_loss: 10480575.9771; train_masked_gp_l1_reg_loss: 109584.3046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72851.2737; train_chrom_access_recon_loss: 9023747.0000; train_global_loss: 22443543.1298; train_optim_loss: 22443543.1298; val_kl_reg_loss: 61545.7242; val_edge_recon_loss: 2706794.6500; val_gene_expr_recon_loss: 10550570.8000; val_masked_gp_l1_reg_loss: 109096.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73072.8125; val_chrom_access_recon_loss: 9158321.2000; val_global_loss: 22659402.1333; val_optim_loss: 22659402.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9690; val_auprc_score: 0.9604; val_best_acc_score: 0.9147; val_best_f1_score: 0.9178; train_kl_reg_loss: 69654.9304; train_edge_recon_loss: 2686284.1011; train_gene_expr_recon_loss: 10472796.5038; train_masked_gp_l1_reg_loss: 108716.0279; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72782.9141; train_chrom_access_recon_loss: 9014022.5076; train_global_loss: 22424256.9160; train_optim_loss: 22424256.9160; val_kl_reg_loss: 61298.7148; val_edge_recon_loss: 2704685.4833; val_gene_expr_recon_loss: 10621746.2000; val_masked_gp_l1_reg_loss: 108329.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72681.8594; val_chrom_access_recon_loss: 9235063.3333; val_global_loss: 22803805.2000; val_optim_loss: 22803805.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9714; val_auprc_score: 0.9607; val_best_acc_score: 0.9224; val_best_f1_score: 0.9244; train_kl_reg_loss: 68707.3384; train_edge_recon_loss: 2683893.4370; train_gene_expr_recon_loss: 10478229.0382; train_masked_gp_l1_reg_loss: 108121.0658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72777.2190; train_chrom_access_recon_loss: 9021834.3817; train_global_loss: 22433562.4427; train_optim_loss: 22433562.4427; val_kl_reg_loss: 64046.9130; val_edge_recon_loss: 2703078.7500; val_gene_expr_recon_loss: 10593795.1333; val_masked_gp_l1_reg_loss: 107959.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73211.6562; val_chrom_access_recon_loss: 9179274.6667; val_global_loss: 22721366.5333; val_optim_loss: 22721366.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9706; val_auprc_score: 0.9615; val_best_acc_score: 0.9205; val_best_f1_score: 0.9232; train_kl_reg_loss: 68762.8418; train_edge_recon_loss: 2677248.2500; train_gene_expr_recon_loss: 10457127.7939; train_masked_gp_l1_reg_loss: 107455.4721; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72818.2888; train_chrom_access_recon_loss: 9004944.4885; train_global_loss: 22388357.1145; train_optim_loss: 22388357.1145; val_kl_reg_loss: 63083.3716; val_edge_recon_loss: 2693243.6833; val_gene_expr_recon_loss: 10532166.0000; val_masked_gp_l1_reg_loss: 107037.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72859.7812; val_chrom_access_recon_loss: 9143349.0000; val_global_loss: 22611740.1333; val_optim_loss: 22611740.1333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9716; val_auprc_score: 0.9639; val_best_acc_score: 0.9231; val_best_f1_score: 0.9249; train_kl_reg_loss: 69278.7189; train_edge_recon_loss: 2680650.3473; train_gene_expr_recon_loss: 10443047.5267; train_masked_gp_l1_reg_loss: 106719.7540; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72783.2866; train_chrom_access_recon_loss: 8989492.9656; train_global_loss: 22361972.8092; train_optim_loss: 22361972.8092; val_kl_reg_loss: 63981.6706; val_edge_recon_loss: 2690320.9667; val_gene_expr_recon_loss: 10496998.0667; val_masked_gp_l1_reg_loss: 106247.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72601.5156; val_chrom_access_recon_loss: 9088873.2667; val_global_loss: 22519023.2000; val_optim_loss: 22519023.2000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9730; val_auprc_score: 0.9646; val_best_acc_score: 0.9213; val_best_f1_score: 0.9241; train_kl_reg_loss: 68242.8303; train_edge_recon_loss: 2690434.0363; train_gene_expr_recon_loss: 10438656.6031; train_masked_gp_l1_reg_loss: 105911.5320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72604.5321; train_chrom_access_recon_loss: 8988287.3473; train_global_loss: 22364136.9008; train_optim_loss: 22364136.9008; val_kl_reg_loss: 63421.8219; val_edge_recon_loss: 2711628.9500; val_gene_expr_recon_loss: 10546397.8000; val_masked_gp_l1_reg_loss: 105662.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72599.6719; val_chrom_access_recon_loss: 9135996.0667; val_global_loss: 22635706.4000; val_optim_loss: 22635706.4000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9755; val_auprc_score: 0.9678; val_best_acc_score: 0.9270; val_best_f1_score: 0.9300; train_kl_reg_loss: 67594.4250; train_edge_recon_loss: 2680124.7958; train_gene_expr_recon_loss: 10424159.1374; train_masked_gp_l1_reg_loss: 105325.5695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72629.9891; train_chrom_access_recon_loss: 8974470.6450; train_global_loss: 22324304.5191; train_optim_loss: 22324304.5191; val_kl_reg_loss: 62779.9635; val_edge_recon_loss: 2678681.0667; val_gene_expr_recon_loss: 10534809.6000; val_masked_gp_l1_reg_loss: 105388.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72685.8594; val_chrom_access_recon_loss: 9109866.6667; val_global_loss: 22564211.3333; val_optim_loss: 22564211.3333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9735; val_auprc_score: 0.9657; val_best_acc_score: 0.9260; val_best_f1_score: 0.9282; train_kl_reg_loss: 69190.9359; train_edge_recon_loss: 2682104.7576; train_gene_expr_recon_loss: 10410680.0534; train_masked_gp_l1_reg_loss: 104897.4865; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72598.5186; train_chrom_access_recon_loss: 8979627.5229; train_global_loss: 22319099.2366; train_optim_loss: 22319099.2366; val_kl_reg_loss: 64226.1240; val_edge_recon_loss: 2691372.3833; val_gene_expr_recon_loss: 10478817.4667; val_masked_gp_l1_reg_loss: 104607.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72653.3516; val_chrom_access_recon_loss: 9123253.4000; val_global_loss: 22534930.4000; val_optim_loss: 22534930.4000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9743; val_auprc_score: 0.9668; val_best_acc_score: 0.9303; val_best_f1_score: 0.9328; train_kl_reg_loss: 67489.8323; train_edge_recon_loss: 2683991.7519; train_gene_expr_recon_loss: 10414028.2443; train_masked_gp_l1_reg_loss: 104378.7669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72706.9312; train_chrom_access_recon_loss: 8979775.5420; train_global_loss: 22322371.1603; train_optim_loss: 22322371.1603; val_kl_reg_loss: 63774.9966; val_edge_recon_loss: 2682053.1167; val_gene_expr_recon_loss: 10514222.3333; val_masked_gp_l1_reg_loss: 104290.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72490.7891; val_chrom_access_recon_loss: 9125944.2000; val_global_loss: 22562775.7333; val_optim_loss: 22562775.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9724; val_auprc_score: 0.9618; val_best_acc_score: 0.9275; val_best_f1_score: 0.9295; train_kl_reg_loss: 68185.9008; train_edge_recon_loss: 2678239.0210; train_gene_expr_recon_loss: 10395506.0382; train_masked_gp_l1_reg_loss: 100750.5990; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58422.7207; train_chrom_access_recon_loss: 8958459.1031; train_global_loss: 22259563.4962; train_optim_loss: 22259563.4962; val_kl_reg_loss: 65184.8620; val_edge_recon_loss: 2686528.4500; val_gene_expr_recon_loss: 10491906.6667; val_masked_gp_l1_reg_loss: 100052.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56863.2422; val_chrom_access_recon_loss: 9091412.1000; val_global_loss: 22491948.0000; val_optim_loss: 22491948.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9746; val_auprc_score: 0.9661; val_best_acc_score: 0.9272; val_best_f1_score: 0.9306; train_kl_reg_loss: 69600.3157; train_edge_recon_loss: 2673999.6050; train_gene_expr_recon_loss: 10385367.8702; train_masked_gp_l1_reg_loss: 99936.5695; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56636.5161; train_chrom_access_recon_loss: 8956022.4084; train_global_loss: 22241563.3588; train_optim_loss: 22241563.3588; val_kl_reg_loss: 65323.6552; val_edge_recon_loss: 2691308.9500; val_gene_expr_recon_loss: 10491036.0000; val_masked_gp_l1_reg_loss: 99854.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56348.4453; val_chrom_access_recon_loss: 9080110.6667; val_global_loss: 22483982.5333; val_optim_loss: 22483982.5333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9781; val_auprc_score: 0.9728; val_best_acc_score: 0.9314; val_best_f1_score: 0.9334; train_kl_reg_loss: 70037.6848; train_edge_recon_loss: 2678212.3282; train_gene_expr_recon_loss: 10378025.8626; train_masked_gp_l1_reg_loss: 99771.2102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56135.6016; train_chrom_access_recon_loss: 8949155.8473; train_global_loss: 22231338.6107; train_optim_loss: 22231338.6107; val_kl_reg_loss: 65554.4185; val_edge_recon_loss: 2686948.9000; val_gene_expr_recon_loss: 10524787.7333; val_masked_gp_l1_reg_loss: 99707.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56022.2266; val_chrom_access_recon_loss: 9168614.5333; val_global_loss: 22601635.0667; val_optim_loss: 22601635.0667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9734; val_auprc_score: 0.9660; val_best_acc_score: 0.9301; val_best_f1_score: 0.9325; train_kl_reg_loss: 70536.6533; train_edge_recon_loss: 2676936.6679; train_gene_expr_recon_loss: 10379195.9466; train_masked_gp_l1_reg_loss: 99644.7359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55833.9017; train_chrom_access_recon_loss: 8956266.8511; train_global_loss: 22238414.6412; train_optim_loss: 22238414.6412; val_kl_reg_loss: 65809.8706; val_edge_recon_loss: 2690148.0333; val_gene_expr_recon_loss: 10454857.1333; val_masked_gp_l1_reg_loss: 99605.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55677.3984; val_chrom_access_recon_loss: 9084881.0667; val_global_loss: 22450978.9333; val_optim_loss: 22450978.9333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9744; val_auprc_score: 0.9668; val_best_acc_score: 0.9276; val_best_f1_score: 0.9292; train_kl_reg_loss: 70639.5618; train_edge_recon_loss: 2668276.4504; train_gene_expr_recon_loss: 10367731.7176; train_masked_gp_l1_reg_loss: 99556.0100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55597.3924; train_chrom_access_recon_loss: 8936221.1107; train_global_loss: 22198022.1527; train_optim_loss: 22198022.1527; val_kl_reg_loss: 65766.8982; val_edge_recon_loss: 2691478.2000; val_gene_expr_recon_loss: 10433380.9333; val_masked_gp_l1_reg_loss: 99486.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55390.9141; val_chrom_access_recon_loss: 9092657.4000; val_global_loss: 22438160.1333; val_optim_loss: 22438160.1333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9746; val_auprc_score: 0.9649; val_best_acc_score: 0.9326; val_best_f1_score: 0.9345; train_kl_reg_loss: 70747.2521; train_edge_recon_loss: 2675827.7844; train_gene_expr_recon_loss: 10376441.7176; train_masked_gp_l1_reg_loss: 99447.1246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55247.8154; train_chrom_access_recon_loss: 8947753.8359; train_global_loss: 22225465.4962; train_optim_loss: 22225465.4962; val_kl_reg_loss: 66416.1776; val_edge_recon_loss: 2663919.8833; val_gene_expr_recon_loss: 10495200.3333; val_masked_gp_l1_reg_loss: 99408.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55107.7266; val_chrom_access_recon_loss: 9102330.6000; val_global_loss: 22482383.8667; val_optim_loss: 22482383.8667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9759; val_auprc_score: 0.9654; val_best_acc_score: 0.9310; val_best_f1_score: 0.9329; train_kl_reg_loss: 71274.6753; train_edge_recon_loss: 2677092.7309; train_gene_expr_recon_loss: 10372336.8321; train_masked_gp_l1_reg_loss: 99376.5608; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54970.6714; train_chrom_access_recon_loss: 8949660.8855; train_global_loss: 22224712.4427; train_optim_loss: 22224712.4427; val_kl_reg_loss: 66697.7990; val_edge_recon_loss: 2672857.3500; val_gene_expr_recon_loss: 10479232.2667; val_masked_gp_l1_reg_loss: 99323.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54827.9961; val_chrom_access_recon_loss: 9101194.4667; val_global_loss: 22474132.9333; val_optim_loss: 22474132.9333
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9742; val_auprc_score: 0.9657; val_best_acc_score: 0.9278; val_best_f1_score: 0.9307; train_kl_reg_loss: 70937.5085; train_edge_recon_loss: 2668531.1584; train_gene_expr_recon_loss: 10369742.2977; train_masked_gp_l1_reg_loss: 99276.6536; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54680.8696; train_chrom_access_recon_loss: 8942103.8969; train_global_loss: 22205272.5038; train_optim_loss: 22205272.5038; val_kl_reg_loss: 67039.2435; val_edge_recon_loss: 2700646.2333; val_gene_expr_recon_loss: 10456347.2000; val_masked_gp_l1_reg_loss: 99229.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54587.9414; val_chrom_access_recon_loss: 9103286.4667; val_global_loss: 22481137.3333; val_optim_loss: 22481137.3333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9748; val_auprc_score: 0.9673; val_best_acc_score: 0.9297; val_best_f1_score: 0.9322; train_kl_reg_loss: 71061.3628; train_edge_recon_loss: 2676952.7500; train_gene_expr_recon_loss: 10385998.2214; train_masked_gp_l1_reg_loss: 99186.7972; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54547.6452; train_chrom_access_recon_loss: 8961311.1489; train_global_loss: 22249057.9389; train_optim_loss: 22249057.9389; val_kl_reg_loss: 66019.3432; val_edge_recon_loss: 2676041.1333; val_gene_expr_recon_loss: 10511800.4667; val_masked_gp_l1_reg_loss: 99149.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54358.7188; val_chrom_access_recon_loss: 9092753.1333; val_global_loss: 22500121.8667; val_optim_loss: 22500121.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9763; val_auprc_score: 0.9699; val_best_acc_score: 0.9298; val_best_f1_score: 0.9323; train_kl_reg_loss: 70053.1205; train_edge_recon_loss: 2673885.3836; train_gene_expr_recon_loss: 10376361.0229; train_masked_gp_l1_reg_loss: 98791.1073; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52889.3020; train_chrom_access_recon_loss: 8943487.0344; train_global_loss: 22215466.9771; train_optim_loss: 22215466.9771; val_kl_reg_loss: 66296.5724; val_edge_recon_loss: 2689127.1167; val_gene_expr_recon_loss: 10501118.1333; val_masked_gp_l1_reg_loss: 98710.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52718.5430; val_chrom_access_recon_loss: 9125888.0333; val_global_loss: 22533859.6000; val_optim_loss: 22533859.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9738; val_auprc_score: 0.9659; val_best_acc_score: 0.9298; val_best_f1_score: 0.9317; train_kl_reg_loss: 70293.7276; train_edge_recon_loss: 2682949.7710; train_gene_expr_recon_loss: 10367806.3664; train_masked_gp_l1_reg_loss: 98686.2232; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52677.3801; train_chrom_access_recon_loss: 8944935.0458; train_global_loss: 22217348.4885; train_optim_loss: 22217348.4885; val_kl_reg_loss: 65835.2544; val_edge_recon_loss: 2700815.4000; val_gene_expr_recon_loss: 10487029.4667; val_masked_gp_l1_reg_loss: 98669.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52652.6523; val_chrom_access_recon_loss: 9136446.8000; val_global_loss: 22541448.8000; val_optim_loss: 22541448.8000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9773; val_auprc_score: 0.9711; val_best_acc_score: 0.9338; val_best_f1_score: 0.9355; train_kl_reg_loss: 70615.4005; train_edge_recon_loss: 2677045.7844; train_gene_expr_recon_loss: 10379143.5420; train_masked_gp_l1_reg_loss: 98657.4658; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52631.6490; train_chrom_access_recon_loss: 8950096.8473; train_global_loss: 22228190.7176; train_optim_loss: 22228190.7176; val_kl_reg_loss: 65940.8073; val_edge_recon_loss: 2678912.6500; val_gene_expr_recon_loss: 10495278.3333; val_masked_gp_l1_reg_loss: 98647.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52606.2148; val_chrom_access_recon_loss: 9104985.6667; val_global_loss: 22496370.2667; val_optim_loss: 22496370.2667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9778; val_auprc_score: 0.9711; val_best_acc_score: 0.9344; val_best_f1_score: 0.9359; train_kl_reg_loss: 70871.6218; train_edge_recon_loss: 2671780.1603; train_gene_expr_recon_loss: 10356378.2748; train_masked_gp_l1_reg_loss: 98639.5683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52589.9289; train_chrom_access_recon_loss: 8924489.0267; train_global_loss: 22174748.6870; train_optim_loss: 22174748.6870; val_kl_reg_loss: 65987.7763; val_edge_recon_loss: 2681508.4833; val_gene_expr_recon_loss: 10469048.6667; val_masked_gp_l1_reg_loss: 98629.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52571.5195; val_chrom_access_recon_loss: 9078975.4000; val_global_loss: 22446722.4000; val_optim_loss: 22446722.4000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 51 min 46 sec.
Using best model state, which was in epoch 47.

--- MODEL EVALUATION ---
val AUROC score: 0.9766
val AUPRC score: 0.9689
val best accuracy score: 0.9314
val best F1 score: 0.9333
val target rna MSE score: 2.1065
val source rna MSE score: 0.7415
val target atac MSE score: 0.3466
val source atac MSE score: 0.1039
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
