[True]
Run timestamp: 10102023_001233_81.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_81']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7461; val_auprc_score: 0.7733; val_best_acc_score: 0.5094; val_best_f1_score: 0.6706; train_kl_reg_loss: 50971.7898; train_edge_recon_loss: 3496490.3569; train_gene_expr_recon_loss: 13381901.4504; train_masked_gp_l1_reg_loss: 36669.3251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2302448.9213; train_chrom_access_recon_loss: 2860961.2137; train_global_loss: 22129443.0840; train_optim_loss: 22129443.0840; val_kl_reg_loss: 59191.6357; val_edge_recon_loss: 4064146.6000; val_gene_expr_recon_loss: 12779868.5333; val_masked_gp_l1_reg_loss: 45252.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 518003.9062; val_chrom_access_recon_loss: 2807051.7833; val_global_loss: 20273514.2667; val_optim_loss: 20273514.2667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7550; val_auprc_score: 0.7801; val_best_acc_score: 0.6346; val_best_f1_score: 0.7074; train_kl_reg_loss: 65747.5837; train_edge_recon_loss: 3489440.2023; train_gene_expr_recon_loss: 12671313.5954; train_masked_gp_l1_reg_loss: 47499.4904; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 281931.6060; train_chrom_access_recon_loss: 2768762.2118; train_global_loss: 19324694.6107; train_optim_loss: 19324694.6107; val_kl_reg_loss: 54710.4034; val_edge_recon_loss: 4055972.2333; val_gene_expr_recon_loss: 12517755.6000; val_masked_gp_l1_reg_loss: 49053.6211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 167893.9375; val_chrom_access_recon_loss: 2769343.4833; val_global_loss: 19614729.6000; val_optim_loss: 19614729.6000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7944; val_auprc_score: 0.8017; val_best_acc_score: 0.7171; val_best_f1_score: 0.7368; train_kl_reg_loss: 60096.9554; train_edge_recon_loss: 3479454.6031; train_gene_expr_recon_loss: 12491338.0687; train_masked_gp_l1_reg_loss: 50176.8941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133666.5120; train_chrom_access_recon_loss: 2734838.6240; train_global_loss: 18949571.5420; train_optim_loss: 18949571.5420; val_kl_reg_loss: 47176.9174; val_edge_recon_loss: 3866391.4167; val_gene_expr_recon_loss: 12391771.8000; val_masked_gp_l1_reg_loss: 51150.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108510.0391; val_chrom_access_recon_loss: 2740185.7500; val_global_loss: 19205186.8000; val_optim_loss: 19205186.8000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8015; val_auprc_score: 0.8019; val_best_acc_score: 0.7145; val_best_f1_score: 0.7465; train_kl_reg_loss: 48476.6443; train_edge_recon_loss: 3240152.3550; train_gene_expr_recon_loss: 12365087.8626; train_masked_gp_l1_reg_loss: 54226.3702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96565.2145; train_chrom_access_recon_loss: 2708743.2901; train_global_loss: 18513251.6641; train_optim_loss: 18513251.6641; val_kl_reg_loss: 67236.9961; val_edge_recon_loss: 3183278.5667; val_gene_expr_recon_loss: 12257460.3333; val_masked_gp_l1_reg_loss: 57250.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86633.2422; val_chrom_access_recon_loss: 2714299.8000; val_global_loss: 18366159.4667; val_optim_loss: 18366159.4667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8435; val_auprc_score: 0.8324; val_best_acc_score: 0.7480; val_best_f1_score: 0.7864; train_kl_reg_loss: 72464.2578; train_edge_recon_loss: 3001485.5248; train_gene_expr_recon_loss: 12244173.8550; train_masked_gp_l1_reg_loss: 59336.8786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80782.8127; train_chrom_access_recon_loss: 2687457.9198; train_global_loss: 18145701.1908; train_optim_loss: 18145701.1908; val_kl_reg_loss: 76535.6250; val_edge_recon_loss: 2999755.2333; val_gene_expr_recon_loss: 12096362.3333; val_masked_gp_l1_reg_loss: 61588.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80818.2500; val_chrom_access_recon_loss: 2678666.7500; val_global_loss: 17993726.0000; val_optim_loss: 17993726.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9045; val_auprc_score: 0.8879; val_best_acc_score: 0.8324; val_best_f1_score: 0.8446; train_kl_reg_loss: 72425.4029; train_edge_recon_loss: 2898334.1431; train_gene_expr_recon_loss: 12111091.9924; train_masked_gp_l1_reg_loss: 63502.9020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86269.3327; train_chrom_access_recon_loss: 2665892.6508; train_global_loss: 17897516.4122; train_optim_loss: 17897516.4122; val_kl_reg_loss: 74010.9740; val_edge_recon_loss: 2872045.4167; val_gene_expr_recon_loss: 12028474.3333; val_masked_gp_l1_reg_loss: 65454.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88146.4609; val_chrom_access_recon_loss: 2690666.2667; val_global_loss: 17818797.2000; val_optim_loss: 17818797.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9219; val_auprc_score: 0.9070; val_best_acc_score: 0.8504; val_best_f1_score: 0.8605; train_kl_reg_loss: 76260.0156; train_edge_recon_loss: 2813150.1031; train_gene_expr_recon_loss: 11995683.3588; train_masked_gp_l1_reg_loss: 66905.8106; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85316.6530; train_chrom_access_recon_loss: 2644181.6431; train_global_loss: 17681497.5878; train_optim_loss: 17681497.5878; val_kl_reg_loss: 80478.7328; val_edge_recon_loss: 2803825.2833; val_gene_expr_recon_loss: 11890893.8667; val_masked_gp_l1_reg_loss: 68137.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82133.3984; val_chrom_access_recon_loss: 2657980.6333; val_global_loss: 17583449.6000; val_optim_loss: 17583449.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9286; val_auprc_score: 0.9109; val_best_acc_score: 0.8641; val_best_f1_score: 0.8718; train_kl_reg_loss: 76514.0834; train_edge_recon_loss: 2786811.1355; train_gene_expr_recon_loss: 11905534.6718; train_masked_gp_l1_reg_loss: 69028.2033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80423.0941; train_chrom_access_recon_loss: 2624614.8588; train_global_loss: 17542926.0458; train_optim_loss: 17542926.0458; val_kl_reg_loss: 74359.1943; val_edge_recon_loss: 2792165.9000; val_gene_expr_recon_loss: 11845648.6000; val_masked_gp_l1_reg_loss: 69861.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79443.5312; val_chrom_access_recon_loss: 2647631.2833; val_global_loss: 17509110.1333; val_optim_loss: 17509110.1333
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9324; val_auprc_score: 0.9179; val_best_acc_score: 0.8674; val_best_f1_score: 0.8757; train_kl_reg_loss: 76190.0882; train_edge_recon_loss: 2781209.1679; train_gene_expr_recon_loss: 11844000.3282; train_masked_gp_l1_reg_loss: 70501.2851; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77398.4202; train_chrom_access_recon_loss: 2609068.3111; train_global_loss: 17458367.6031; train_optim_loss: 17458367.6031; val_kl_reg_loss: 73656.7063; val_edge_recon_loss: 2782006.9333; val_gene_expr_recon_loss: 11761730.9333; val_masked_gp_l1_reg_loss: 71122.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76993.9922; val_chrom_access_recon_loss: 2639008.5000; val_global_loss: 17404520.2667; val_optim_loss: 17404520.2667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9396; val_auprc_score: 0.9286; val_best_acc_score: 0.8739; val_best_f1_score: 0.8804; train_kl_reg_loss: 71988.3234; train_edge_recon_loss: 2768097.8721; train_gene_expr_recon_loss: 11783166.5191; train_masked_gp_l1_reg_loss: 71730.4978; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75743.3006; train_chrom_access_recon_loss: 2599350.7481; train_global_loss: 17370077.2977; train_optim_loss: 17370077.2977; val_kl_reg_loss: 71272.0234; val_edge_recon_loss: 2771407.5167; val_gene_expr_recon_loss: 11640047.3333; val_masked_gp_l1_reg_loss: 72397.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75680.1016; val_chrom_access_recon_loss: 2606075.8000; val_global_loss: 17236880.8667; val_optim_loss: 17236880.8667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9450; val_auprc_score: 0.9358; val_best_acc_score: 0.8802; val_best_f1_score: 0.8844; train_kl_reg_loss: 71060.5690; train_edge_recon_loss: 2753247.2252; train_gene_expr_recon_loss: 11730521.3588; train_masked_gp_l1_reg_loss: 72989.4539; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75401.4753; train_chrom_access_recon_loss: 2584640.9275; train_global_loss: 17287861.0534; train_optim_loss: 17287861.0534; val_kl_reg_loss: 71497.8536; val_edge_recon_loss: 2756527.5500; val_gene_expr_recon_loss: 11612870.3333; val_masked_gp_l1_reg_loss: 73401.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75255.5938; val_chrom_access_recon_loss: 2604961.5167; val_global_loss: 17194515.3333; val_optim_loss: 17194515.3333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9443; val_auprc_score: 0.9323; val_best_acc_score: 0.8822; val_best_f1_score: 0.8884; train_kl_reg_loss: 71516.5380; train_edge_recon_loss: 2744783.2061; train_gene_expr_recon_loss: 11690136.5573; train_masked_gp_l1_reg_loss: 73802.2189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74780.0777; train_chrom_access_recon_loss: 2574796.6508; train_global_loss: 17229815.3282; train_optim_loss: 17229815.3282; val_kl_reg_loss: 70183.9708; val_edge_recon_loss: 2780390.2000; val_gene_expr_recon_loss: 11588688.9333; val_masked_gp_l1_reg_loss: 74215.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74491.1719; val_chrom_access_recon_loss: 2583838.6167; val_global_loss: 17171807.6000; val_optim_loss: 17171807.6000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9477; val_auprc_score: 0.9339; val_best_acc_score: 0.8875; val_best_f1_score: 0.8927; train_kl_reg_loss: 70835.2572; train_edge_recon_loss: 2734473.3244; train_gene_expr_recon_loss: 11632855.3969; train_masked_gp_l1_reg_loss: 74533.2742; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74236.5327; train_chrom_access_recon_loss: 2560028.7576; train_global_loss: 17146962.5954; train_optim_loss: 17146962.5954; val_kl_reg_loss: 71919.8818; val_edge_recon_loss: 2736620.6000; val_gene_expr_recon_loss: 11521238.5333; val_masked_gp_l1_reg_loss: 74866.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74555.0078; val_chrom_access_recon_loss: 2578854.5500; val_global_loss: 17058054.4667; val_optim_loss: 17058054.4667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9462; val_auprc_score: 0.9315; val_best_acc_score: 0.8863; val_best_f1_score: 0.8908; train_kl_reg_loss: 70963.1222; train_edge_recon_loss: 2716843.5763; train_gene_expr_recon_loss: 11599461.9237; train_masked_gp_l1_reg_loss: 75138.8103; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73425.6545; train_chrom_access_recon_loss: 2554178.8950; train_global_loss: 17090012.0000; train_optim_loss: 17090012.0000; val_kl_reg_loss: 68386.1979; val_edge_recon_loss: 2771354.5000; val_gene_expr_recon_loss: 11539265.4667; val_masked_gp_l1_reg_loss: 75358.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73258.8203; val_chrom_access_recon_loss: 2567735.9000; val_global_loss: 17095358.9333; val_optim_loss: 17095358.9333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9510; val_auprc_score: 0.9336; val_best_acc_score: 0.8942; val_best_f1_score: 0.8978; train_kl_reg_loss: 68866.9214; train_edge_recon_loss: 2716130.0668; train_gene_expr_recon_loss: 11560551.7023; train_masked_gp_l1_reg_loss: 75579.6762; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72852.8319; train_chrom_access_recon_loss: 2543932.1737; train_global_loss: 17037913.3435; train_optim_loss: 17037913.3435; val_kl_reg_loss: 69299.4242; val_edge_recon_loss: 2727261.7667; val_gene_expr_recon_loss: 11466552.1333; val_masked_gp_l1_reg_loss: 75826.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72475.1172; val_chrom_access_recon_loss: 2569480.1167; val_global_loss: 16980895.4000; val_optim_loss: 16980895.4000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9508; val_auprc_score: 0.9361; val_best_acc_score: 0.8936; val_best_f1_score: 0.8982; train_kl_reg_loss: 68111.2993; train_edge_recon_loss: 2726459.8244; train_gene_expr_recon_loss: 11538502.4351; train_masked_gp_l1_reg_loss: 75941.9515; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72173.5878; train_chrom_access_recon_loss: 2540811.6145; train_global_loss: 17022000.7328; train_optim_loss: 17022000.7328; val_kl_reg_loss: 68645.6206; val_edge_recon_loss: 2736083.5167; val_gene_expr_recon_loss: 11434192.8000; val_masked_gp_l1_reg_loss: 76086.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71657.9531; val_chrom_access_recon_loss: 2548311.0500; val_global_loss: 16934977.2000; val_optim_loss: 16934977.2000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9517; val_auprc_score: 0.9384; val_best_acc_score: 0.8946; val_best_f1_score: 0.8999; train_kl_reg_loss: 67987.1432; train_edge_recon_loss: 2709762.1260; train_gene_expr_recon_loss: 11482029.6870; train_masked_gp_l1_reg_loss: 76140.7436; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71612.8655; train_chrom_access_recon_loss: 2525800.8588; train_global_loss: 16933333.4733; train_optim_loss: 16933333.4733; val_kl_reg_loss: 67644.5826; val_edge_recon_loss: 2747942.3333; val_gene_expr_recon_loss: 11390393.1333; val_masked_gp_l1_reg_loss: 76189.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71573.7578; val_chrom_access_recon_loss: 2535073.3000; val_global_loss: 16888817.5333; val_optim_loss: 16888817.5333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9615; val_auprc_score: 0.9507; val_best_acc_score: 0.9011; val_best_f1_score: 0.9072; train_kl_reg_loss: 67550.8911; train_edge_recon_loss: 2703092.7290; train_gene_expr_recon_loss: 11472305.7863; train_masked_gp_l1_reg_loss: 76138.4228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71101.1465; train_chrom_access_recon_loss: 2521704.1775; train_global_loss: 16911893.1603; train_optim_loss: 16911893.1603; val_kl_reg_loss: 66736.7435; val_edge_recon_loss: 2708956.9833; val_gene_expr_recon_loss: 11419112.4667; val_masked_gp_l1_reg_loss: 76326.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71625.6875; val_chrom_access_recon_loss: 2546031.7500; val_global_loss: 16888790.1333; val_optim_loss: 16888790.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9571; val_auprc_score: 0.9448; val_best_acc_score: 0.8994; val_best_f1_score: 0.9044; train_kl_reg_loss: 67196.3898; train_edge_recon_loss: 2702583.8473; train_gene_expr_recon_loss: 11448070.2214; train_masked_gp_l1_reg_loss: 76221.3856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71000.2648; train_chrom_access_recon_loss: 2516853.7347; train_global_loss: 16881925.7710; train_optim_loss: 16881925.7710; val_kl_reg_loss: 68269.1667; val_edge_recon_loss: 2711883.4833; val_gene_expr_recon_loss: 11384209.8667; val_masked_gp_l1_reg_loss: 76309.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71245.4453; val_chrom_access_recon_loss: 2544662.1167; val_global_loss: 16856579.6000; val_optim_loss: 16856579.6000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9631; val_auprc_score: 0.9533; val_best_acc_score: 0.9082; val_best_f1_score: 0.9125; train_kl_reg_loss: 66491.2107; train_edge_recon_loss: 2700910.4389; train_gene_expr_recon_loss: 11418172.7252; train_masked_gp_l1_reg_loss: 76361.9490; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70913.1202; train_chrom_access_recon_loss: 2508911.5802; train_global_loss: 16841761.0992; train_optim_loss: 16841761.0992; val_kl_reg_loss: 67223.0284; val_edge_recon_loss: 2708048.1500; val_gene_expr_recon_loss: 11312424.8000; val_masked_gp_l1_reg_loss: 76344.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70965.6016; val_chrom_access_recon_loss: 2536886.3000; val_global_loss: 16771892.1333; val_optim_loss: 16771892.1333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9629; val_auprc_score: 0.9512; val_best_acc_score: 0.9103; val_best_f1_score: 0.9133; train_kl_reg_loss: 66223.0903; train_edge_recon_loss: 2694842.7729; train_gene_expr_recon_loss: 11412258.2595; train_masked_gp_l1_reg_loss: 76341.9840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70764.1703; train_chrom_access_recon_loss: 2508475.6450; train_global_loss: 16828905.8015; train_optim_loss: 16828905.8015; val_kl_reg_loss: 63563.1456; val_edge_recon_loss: 2711421.9833; val_gene_expr_recon_loss: 11333295.4667; val_masked_gp_l1_reg_loss: 76366.2422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71303.8203; val_chrom_access_recon_loss: 2525152.6500; val_global_loss: 16781103.3333; val_optim_loss: 16781103.3333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9637; val_auprc_score: 0.9555; val_best_acc_score: 0.9088; val_best_f1_score: 0.9124; train_kl_reg_loss: 65550.0371; train_edge_recon_loss: 2690661.2863; train_gene_expr_recon_loss: 11396682.3435; train_masked_gp_l1_reg_loss: 76319.3346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70761.3330; train_chrom_access_recon_loss: 2504990.9351; train_global_loss: 16804965.3053; train_optim_loss: 16804965.3053; val_kl_reg_loss: 65720.6003; val_edge_recon_loss: 2716543.8333; val_gene_expr_recon_loss: 11316690.7333; val_masked_gp_l1_reg_loss: 76265.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70682.4375; val_chrom_access_recon_loss: 2540126.4000; val_global_loss: 16786028.4667; val_optim_loss: 16786028.4667
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9685; val_auprc_score: 0.9584; val_best_acc_score: 0.9174; val_best_f1_score: 0.9207; train_kl_reg_loss: 64862.3628; train_edge_recon_loss: 2692873.4733; train_gene_expr_recon_loss: 11359267.2214; train_masked_gp_l1_reg_loss: 76193.7096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70692.0139; train_chrom_access_recon_loss: 2495782.5553; train_global_loss: 16759671.2672; train_optim_loss: 16759671.2672; val_kl_reg_loss: 66365.5482; val_edge_recon_loss: 2705202.7667; val_gene_expr_recon_loss: 11298369.0667; val_masked_gp_l1_reg_loss: 76112.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71112.8828; val_chrom_access_recon_loss: 2513218.8833; val_global_loss: 16730382.1333; val_optim_loss: 16730382.1333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9683; val_auprc_score: 0.9593; val_best_acc_score: 0.9179; val_best_f1_score: 0.9211; train_kl_reg_loss: 65700.2597; train_edge_recon_loss: 2689164.9580; train_gene_expr_recon_loss: 11345906.1679; train_masked_gp_l1_reg_loss: 75995.1012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70835.8935; train_chrom_access_recon_loss: 2490696.8282; train_global_loss: 16738299.3053; train_optim_loss: 16738299.3053; val_kl_reg_loss: 66099.4523; val_edge_recon_loss: 2691492.1500; val_gene_expr_recon_loss: 11320840.0000; val_masked_gp_l1_reg_loss: 75786.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70166.1562; val_chrom_access_recon_loss: 2524607.5667; val_global_loss: 16748992.0667; val_optim_loss: 16748992.0667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9641; val_auprc_score: 0.9547; val_best_acc_score: 0.9104; val_best_f1_score: 0.9140; train_kl_reg_loss: 65788.0670; train_edge_recon_loss: 2682930.7729; train_gene_expr_recon_loss: 11337812.8855; train_masked_gp_l1_reg_loss: 75690.1255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70516.4456; train_chrom_access_recon_loss: 2491395.4008; train_global_loss: 16724133.7252; train_optim_loss: 16724133.7252; val_kl_reg_loss: 65653.1734; val_edge_recon_loss: 2708880.9000; val_gene_expr_recon_loss: 11256543.8667; val_masked_gp_l1_reg_loss: 75576.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71242.3516; val_chrom_access_recon_loss: 2506683.0500; val_global_loss: 16684579.0000; val_optim_loss: 16684579.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9684; val_auprc_score: 0.9558; val_best_acc_score: 0.9198; val_best_f1_score: 0.9232; train_kl_reg_loss: 64954.5964; train_edge_recon_loss: 2680182.1393; train_gene_expr_recon_loss: 11313510.3435; train_masked_gp_l1_reg_loss: 75442.1057; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70781.1313; train_chrom_access_recon_loss: 2484554.9676; train_global_loss: 16689425.3282; train_optim_loss: 16689425.3282; val_kl_reg_loss: 62540.6198; val_edge_recon_loss: 2687684.3833; val_gene_expr_recon_loss: 11277272.7333; val_masked_gp_l1_reg_loss: 75434.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70914.6250; val_chrom_access_recon_loss: 2513102.5333; val_global_loss: 16686949.2667; val_optim_loss: 16686949.2667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9701; val_auprc_score: 0.9621; val_best_acc_score: 0.9221; val_best_f1_score: 0.9247; train_kl_reg_loss: 64628.3341; train_edge_recon_loss: 2680814.7996; train_gene_expr_recon_loss: 11309700.9924; train_masked_gp_l1_reg_loss: 75403.4361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70941.3333; train_chrom_access_recon_loss: 2483737.8340; train_global_loss: 16685226.7099; train_optim_loss: 16685226.7099; val_kl_reg_loss: 64508.8328; val_edge_recon_loss: 2691911.1167; val_gene_expr_recon_loss: 11209905.0667; val_masked_gp_l1_reg_loss: 75279.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70717.3906; val_chrom_access_recon_loss: 2498208.6167; val_global_loss: 16610529.6667; val_optim_loss: 16610529.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9690; val_auprc_score: 0.9568; val_best_acc_score: 0.9204; val_best_f1_score: 0.9225; train_kl_reg_loss: 64275.7887; train_edge_recon_loss: 2685716.3302; train_gene_expr_recon_loss: 11298788.1145; train_masked_gp_l1_reg_loss: 75179.0369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70807.2393; train_chrom_access_recon_loss: 2479392.6145; train_global_loss: 16674159.1069; train_optim_loss: 16674159.1069; val_kl_reg_loss: 63787.9104; val_edge_recon_loss: 2703042.9000; val_gene_expr_recon_loss: 11221662.9333; val_masked_gp_l1_reg_loss: 75210.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71306.5781; val_chrom_access_recon_loss: 2501551.9000; val_global_loss: 16636563.4000; val_optim_loss: 16636563.4000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9723; val_auprc_score: 0.9654; val_best_acc_score: 0.9220; val_best_f1_score: 0.9239; train_kl_reg_loss: 63960.4842; train_edge_recon_loss: 2673119.4695; train_gene_expr_recon_loss: 11283734.7099; train_masked_gp_l1_reg_loss: 75104.0731; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71032.5012; train_chrom_access_recon_loss: 2474163.3073; train_global_loss: 16641114.5649; train_optim_loss: 16641114.5649; val_kl_reg_loss: 62372.6203; val_edge_recon_loss: 2696064.8333; val_gene_expr_recon_loss: 11265445.8000; val_masked_gp_l1_reg_loss: 74941.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71381.6328; val_chrom_access_recon_loss: 2509236.5333; val_global_loss: 16679443.8667; val_optim_loss: 16679443.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9715; val_auprc_score: 0.9624; val_best_acc_score: 0.9268; val_best_f1_score: 0.9295; train_kl_reg_loss: 63169.6046; train_edge_recon_loss: 2683654.1221; train_gene_expr_recon_loss: 11279522.0840; train_masked_gp_l1_reg_loss: 74933.1775; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71066.2151; train_chrom_access_recon_loss: 2473429.5534; train_global_loss: 16645774.7099; train_optim_loss: 16645774.7099; val_kl_reg_loss: 63246.2568; val_edge_recon_loss: 2690947.7333; val_gene_expr_recon_loss: 11175111.2000; val_masked_gp_l1_reg_loss: 74894.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70720.8125; val_chrom_access_recon_loss: 2488392.4500; val_global_loss: 16563313.8667; val_optim_loss: 16563313.8667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9722; val_auprc_score: 0.9647; val_best_acc_score: 0.9247; val_best_f1_score: 0.9267; train_kl_reg_loss: 62331.7431; train_edge_recon_loss: 2679374.3454; train_gene_expr_recon_loss: 11257690.2443; train_masked_gp_l1_reg_loss: 74839.1335; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70960.2493; train_chrom_access_recon_loss: 2468250.7805; train_global_loss: 16613446.5191; train_optim_loss: 16613446.5191; val_kl_reg_loss: 61804.7161; val_edge_recon_loss: 2697815.6000; val_gene_expr_recon_loss: 11224744.0667; val_masked_gp_l1_reg_loss: 74789.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71280.7891; val_chrom_access_recon_loss: 2492438.9833; val_global_loss: 16622873.4667; val_optim_loss: 16622873.4667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9717; val_auprc_score: 0.9611; val_best_acc_score: 0.9267; val_best_f1_score: 0.9292; train_kl_reg_loss: 62313.4557; train_edge_recon_loss: 2678257.6813; train_gene_expr_recon_loss: 11256934.0840; train_masked_gp_l1_reg_loss: 74657.6511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71293.3287; train_chrom_access_recon_loss: 2464616.1603; train_global_loss: 16608072.3053; train_optim_loss: 16608072.3053; val_kl_reg_loss: 64605.4018; val_edge_recon_loss: 2681995.0167; val_gene_expr_recon_loss: 11206572.4000; val_masked_gp_l1_reg_loss: 74647.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71912.1094; val_chrom_access_recon_loss: 2505634.8333; val_global_loss: 16605367.7333; val_optim_loss: 16605367.7333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9740; val_auprc_score: 0.9669; val_best_acc_score: 0.9275; val_best_f1_score: 0.9300; train_kl_reg_loss: 62877.4923; train_edge_recon_loss: 2679913.2347; train_gene_expr_recon_loss: 11246143.4733; train_masked_gp_l1_reg_loss: 74477.2164; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71526.1035; train_chrom_access_recon_loss: 2464255.2195; train_global_loss: 16599192.7252; train_optim_loss: 16599192.7252; val_kl_reg_loss: 61566.9839; val_edge_recon_loss: 2683268.4167; val_gene_expr_recon_loss: 11175306.6667; val_masked_gp_l1_reg_loss: 74169.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71665.5391; val_chrom_access_recon_loss: 2481773.2167; val_global_loss: 16547750.0667; val_optim_loss: 16547750.0667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9740; val_auprc_score: 0.9655; val_best_acc_score: 0.9260; val_best_f1_score: 0.9288; train_kl_reg_loss: 62585.8636; train_edge_recon_loss: 2668962.9905; train_gene_expr_recon_loss: 11237924.0916; train_masked_gp_l1_reg_loss: 74124.8444; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71643.9464; train_chrom_access_recon_loss: 2463543.4294; train_global_loss: 16578785.1069; train_optim_loss: 16578785.1069; val_kl_reg_loss: 61216.0039; val_edge_recon_loss: 2672246.8667; val_gene_expr_recon_loss: 11182231.8667; val_masked_gp_l1_reg_loss: 73965.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72258.4844; val_chrom_access_recon_loss: 2481059.3167; val_global_loss: 16542978.1333; val_optim_loss: 16542978.1333
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9762; val_auprc_score: 0.9698; val_best_acc_score: 0.9306; val_best_f1_score: 0.9329; train_kl_reg_loss: 61892.2176; train_edge_recon_loss: 2666107.0286; train_gene_expr_recon_loss: 11229278.8244; train_masked_gp_l1_reg_loss: 73954.9065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72214.9665; train_chrom_access_recon_loss: 2457082.7538; train_global_loss: 16560530.7405; train_optim_loss: 16560530.7405; val_kl_reg_loss: 62171.4971; val_edge_recon_loss: 2679617.5500; val_gene_expr_recon_loss: 11193576.5333; val_masked_gp_l1_reg_loss: 73778.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72150.9453; val_chrom_access_recon_loss: 2485184.0667; val_global_loss: 16566478.7333; val_optim_loss: 16566478.7333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9748; val_auprc_score: 0.9660; val_best_acc_score: 0.9306; val_best_f1_score: 0.9322; train_kl_reg_loss: 62296.5490; train_edge_recon_loss: 2666124.9008; train_gene_expr_recon_loss: 11227701.2901; train_masked_gp_l1_reg_loss: 73633.6138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72259.3960; train_chrom_access_recon_loss: 2455534.1508; train_global_loss: 16557549.8931; train_optim_loss: 16557549.8931; val_kl_reg_loss: 62343.5833; val_edge_recon_loss: 2692065.8000; val_gene_expr_recon_loss: 11157331.0000; val_masked_gp_l1_reg_loss: 73490.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71737.7266; val_chrom_access_recon_loss: 2478825.6667; val_global_loss: 16535795.1333; val_optim_loss: 16535795.1333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9728; val_auprc_score: 0.9620; val_best_acc_score: 0.9306; val_best_f1_score: 0.9330; train_kl_reg_loss: 62435.6144; train_edge_recon_loss: 2673425.5802; train_gene_expr_recon_loss: 11229848.6718; train_masked_gp_l1_reg_loss: 73402.1484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72324.4368; train_chrom_access_recon_loss: 2455387.4218; train_global_loss: 16566823.9160; train_optim_loss: 16566823.9160; val_kl_reg_loss: 61029.7596; val_edge_recon_loss: 2681277.1000; val_gene_expr_recon_loss: 11158119.0667; val_masked_gp_l1_reg_loss: 73217.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72436.8984; val_chrom_access_recon_loss: 2491837.8833; val_global_loss: 16537918.8000; val_optim_loss: 16537918.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9771; val_auprc_score: 0.9704; val_best_acc_score: 0.9332; val_best_f1_score: 0.9346; train_kl_reg_loss: 61049.1495; train_edge_recon_loss: 2674254.0191; train_gene_expr_recon_loss: 11216376.1985; train_masked_gp_l1_reg_loss: 73173.2670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72709.6110; train_chrom_access_recon_loss: 2450566.8893; train_global_loss: 16548129.0611; train_optim_loss: 16548129.0611; val_kl_reg_loss: 61328.5805; val_edge_recon_loss: 2690157.9167; val_gene_expr_recon_loss: 11184674.8000; val_masked_gp_l1_reg_loss: 73041.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72895.3047; val_chrom_access_recon_loss: 2479646.6833; val_global_loss: 16561745.1333; val_optim_loss: 16561745.1333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9764; val_auprc_score: 0.9665; val_best_acc_score: 0.9332; val_best_f1_score: 0.9356; train_kl_reg_loss: 61287.2334; train_edge_recon_loss: 2668254.0000; train_gene_expr_recon_loss: 11216133.4275; train_masked_gp_l1_reg_loss: 72885.9091; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72692.1258; train_chrom_access_recon_loss: 2449644.5763; train_global_loss: 16540897.2519; train_optim_loss: 16540897.2519; val_kl_reg_loss: 60172.4865; val_edge_recon_loss: 2665530.3333; val_gene_expr_recon_loss: 11127532.2667; val_masked_gp_l1_reg_loss: 72877.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73079.5547; val_chrom_access_recon_loss: 2467729.8833; val_global_loss: 16466923.0667; val_optim_loss: 16466923.0667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9801; val_auprc_score: 0.9734; val_best_acc_score: 0.9406; val_best_f1_score: 0.9423; train_kl_reg_loss: 61479.0147; train_edge_recon_loss: 2660684.8187; train_gene_expr_recon_loss: 11199892.3206; train_masked_gp_l1_reg_loss: 72737.4246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72950.5368; train_chrom_access_recon_loss: 2445404.6374; train_global_loss: 16513148.7786; train_optim_loss: 16513148.7786; val_kl_reg_loss: 61868.5914; val_edge_recon_loss: 2682919.5333; val_gene_expr_recon_loss: 11113135.2000; val_masked_gp_l1_reg_loss: 72567.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73384.6406; val_chrom_access_recon_loss: 2471238.7333; val_global_loss: 16475115.2000; val_optim_loss: 16475115.2000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9788; val_auprc_score: 0.9733; val_best_acc_score: 0.9345; val_best_f1_score: 0.9370; train_kl_reg_loss: 61498.1673; train_edge_recon_loss: 2664387.8760; train_gene_expr_recon_loss: 11200920.2672; train_masked_gp_l1_reg_loss: 72489.3641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73003.2950; train_chrom_access_recon_loss: 2445210.6011; train_global_loss: 16517509.5420; train_optim_loss: 16517509.5420; val_kl_reg_loss: 62992.4362; val_edge_recon_loss: 2672686.2500; val_gene_expr_recon_loss: 11198380.2667; val_masked_gp_l1_reg_loss: 72336.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73954.6875; val_chrom_access_recon_loss: 2483440.7500; val_global_loss: 16563791.6667; val_optim_loss: 16563791.6667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9764; val_auprc_score: 0.9670; val_best_acc_score: 0.9330; val_best_f1_score: 0.9352; train_kl_reg_loss: 61084.9136; train_edge_recon_loss: 2666337.7443; train_gene_expr_recon_loss: 11186184.1679; train_masked_gp_l1_reg_loss: 72133.6686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73448.8597; train_chrom_access_recon_loss: 2439467.5000; train_global_loss: 16498656.8397; train_optim_loss: 16498656.8397; val_kl_reg_loss: 64611.1474; val_edge_recon_loss: 2675289.8167; val_gene_expr_recon_loss: 11122344.4667; val_masked_gp_l1_reg_loss: 72041.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73323.8984; val_chrom_access_recon_loss: 2471139.2667; val_global_loss: 16478750.9333; val_optim_loss: 16478750.9333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9771; val_auprc_score: 0.9676; val_best_acc_score: 0.9333; val_best_f1_score: 0.9354; train_kl_reg_loss: 60910.2180; train_edge_recon_loss: 2674358.3760; train_gene_expr_recon_loss: 11195434.5420; train_masked_gp_l1_reg_loss: 71799.2146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73435.6798; train_chrom_access_recon_loss: 2441075.6126; train_global_loss: 16517013.7176; train_optim_loss: 16517013.7176; val_kl_reg_loss: 58317.4018; val_edge_recon_loss: 2694192.9000; val_gene_expr_recon_loss: 11146666.1333; val_masked_gp_l1_reg_loss: 71689.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73898.4062; val_chrom_access_recon_loss: 2476959.2667; val_global_loss: 16521723.7333; val_optim_loss: 16521723.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9787; val_auprc_score: 0.9716; val_best_acc_score: 0.9359; val_best_f1_score: 0.9375; train_kl_reg_loss: 60002.7555; train_edge_recon_loss: 2668136.9771; train_gene_expr_recon_loss: 11179843.1374; train_masked_gp_l1_reg_loss: 70715.3511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59020.0519; train_chrom_access_recon_loss: 2432156.4847; train_global_loss: 16469874.6641; train_optim_loss: 16469874.6641; val_kl_reg_loss: 61113.6242; val_edge_recon_loss: 2666065.2500; val_gene_expr_recon_loss: 11148311.4667; val_masked_gp_l1_reg_loss: 70333.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56576.4219; val_chrom_access_recon_loss: 2467667.5667; val_global_loss: 16470067.7333; val_optim_loss: 16470067.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9815; val_auprc_score: 0.9750; val_best_acc_score: 0.9373; val_best_f1_score: 0.9395; train_kl_reg_loss: 62167.6250; train_edge_recon_loss: 2666360.6183; train_gene_expr_recon_loss: 11170669.9313; train_masked_gp_l1_reg_loss: 70264.2655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56044.7286; train_chrom_access_recon_loss: 2428987.3092; train_global_loss: 16454494.4733; train_optim_loss: 16454494.4733; val_kl_reg_loss: 63086.3148; val_edge_recon_loss: 2663123.6833; val_gene_expr_recon_loss: 11079785.5333; val_masked_gp_l1_reg_loss: 70205.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55596.6875; val_chrom_access_recon_loss: 2449173.6167; val_global_loss: 16380972.0000; val_optim_loss: 16380972.0000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9776; val_auprc_score: 0.9695; val_best_acc_score: 0.9386; val_best_f1_score: 0.9404; train_kl_reg_loss: 63192.9590; train_edge_recon_loss: 2658795.6279; train_gene_expr_recon_loss: 11174573.2061; train_masked_gp_l1_reg_loss: 70177.9278; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55278.1163; train_chrom_access_recon_loss: 2429035.2233; train_global_loss: 16451053.1756; train_optim_loss: 16451053.1756; val_kl_reg_loss: 63270.3997; val_edge_recon_loss: 2669482.6667; val_gene_expr_recon_loss: 11097014.9333; val_masked_gp_l1_reg_loss: 70126.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54988.8125; val_chrom_access_recon_loss: 2461753.5500; val_global_loss: 16416636.4667; val_optim_loss: 16416636.4667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9787; val_auprc_score: 0.9712; val_best_acc_score: 0.9384; val_best_f1_score: 0.9397; train_kl_reg_loss: 62991.8422; train_edge_recon_loss: 2654569.3626; train_gene_expr_recon_loss: 11171872.9924; train_masked_gp_l1_reg_loss: 70093.2629; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54763.5737; train_chrom_access_recon_loss: 2431096.7233; train_global_loss: 16445387.8321; train_optim_loss: 16445387.8321; val_kl_reg_loss: 62823.3388; val_edge_recon_loss: 2666145.0333; val_gene_expr_recon_loss: 11115755.9333; val_masked_gp_l1_reg_loss: 70069.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54594.2891; val_chrom_access_recon_loss: 2458837.0167; val_global_loss: 16428224.3333; val_optim_loss: 16428224.3333
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9782; val_auprc_score: 0.9714; val_best_acc_score: 0.9347; val_best_f1_score: 0.9360; train_kl_reg_loss: 62849.2307; train_edge_recon_loss: 2663250.5992; train_gene_expr_recon_loss: 11167816.6336; train_masked_gp_l1_reg_loss: 70044.4800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54441.8026; train_chrom_access_recon_loss: 2430552.6431; train_global_loss: 16448955.5191; train_optim_loss: 16448955.5191; val_kl_reg_loss: 63652.6961; val_edge_recon_loss: 2680983.1000; val_gene_expr_recon_loss: 11127917.4667; val_masked_gp_l1_reg_loss: 70010.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54337.3359; val_chrom_access_recon_loss: 2470750.8333; val_global_loss: 16467652.0000; val_optim_loss: 16467652.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9810; val_auprc_score: 0.9752; val_best_acc_score: 0.9388; val_best_f1_score: 0.9399; train_kl_reg_loss: 62806.1930; train_edge_recon_loss: 2664713.7729; train_gene_expr_recon_loss: 11169197.7481; train_masked_gp_l1_reg_loss: 69992.4743; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54160.4441; train_chrom_access_recon_loss: 2429721.5821; train_global_loss: 16450592.2137; train_optim_loss: 16450592.2137; val_kl_reg_loss: 63395.4570; val_edge_recon_loss: 2673073.1667; val_gene_expr_recon_loss: 11095983.4000; val_masked_gp_l1_reg_loss: 69953.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54036.3594; val_chrom_access_recon_loss: 2467134.2167; val_global_loss: 16423576.1333; val_optim_loss: 16423576.1333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9803; val_auprc_score: 0.9738; val_best_acc_score: 0.9376; val_best_f1_score: 0.9392; train_kl_reg_loss: 63029.5590; train_edge_recon_loss: 2659654.1031; train_gene_expr_recon_loss: 11164554.6183; train_masked_gp_l1_reg_loss: 69857.1511; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52592.9521; train_chrom_access_recon_loss: 2426405.2653; train_global_loss: 16436093.6718; train_optim_loss: 16436093.6718; val_kl_reg_loss: 63367.3982; val_edge_recon_loss: 2666319.3333; val_gene_expr_recon_loss: 11163313.2000; val_masked_gp_l1_reg_loss: 69811.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52349.4180; val_chrom_access_recon_loss: 2473444.9833; val_global_loss: 16488606.0000; val_optim_loss: 16488606.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9788; val_auprc_score: 0.9714; val_best_acc_score: 0.9380; val_best_f1_score: 0.9394; train_kl_reg_loss: 63386.1433; train_edge_recon_loss: 2660094.4198; train_gene_expr_recon_loss: 11164614.5573; train_masked_gp_l1_reg_loss: 69797.7637; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52271.7584; train_chrom_access_recon_loss: 2426315.3149; train_global_loss: 16436479.8626; train_optim_loss: 16436479.8626; val_kl_reg_loss: 63448.3464; val_edge_recon_loss: 2669347.8333; val_gene_expr_recon_loss: 11102430.6000; val_masked_gp_l1_reg_loss: 69787.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52217.7539; val_chrom_access_recon_loss: 2462859.4333; val_global_loss: 16420092.3333; val_optim_loss: 16420092.3333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9776; val_auprc_score: 0.9710; val_best_acc_score: 0.9333; val_best_f1_score: 0.9352; train_kl_reg_loss: 63336.0023; train_edge_recon_loss: 2661479.3187; train_gene_expr_recon_loss: 11169462.5878; train_masked_gp_l1_reg_loss: 69781.3178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52168.3987; train_chrom_access_recon_loss: 2427157.8015; train_global_loss: 16443385.4580; train_optim_loss: 16443385.4580; val_kl_reg_loss: 63806.4378; val_edge_recon_loss: 2688343.5500; val_gene_expr_recon_loss: 11122475.9333; val_masked_gp_l1_reg_loss: 69773.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52125.3281; val_chrom_access_recon_loss: 2458438.2000; val_global_loss: 16454962.0667; val_optim_loss: 16454962.0667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9806; val_auprc_score: 0.9769; val_best_acc_score: 0.9360; val_best_f1_score: 0.9377; train_kl_reg_loss: 63395.8832; train_edge_recon_loss: 2656612.6889; train_gene_expr_recon_loss: 11155736.9313; train_masked_gp_l1_reg_loss: 69767.3180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52091.6768; train_chrom_access_recon_loss: 2425898.7462; train_global_loss: 16423503.1603; train_optim_loss: 16423503.1603; val_kl_reg_loss: 63487.1346; val_edge_recon_loss: 2673146.8333; val_gene_expr_recon_loss: 11105252.0667; val_masked_gp_l1_reg_loss: 69763.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52056.4141; val_chrom_access_recon_loss: 2465050.0167; val_global_loss: 16428755.0000; val_optim_loss: 16428755.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 32 min 9 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9789
val AUPRC score: 0.9719
val best accuracy score: 0.9368
val best F1 score: 0.9382
val target rna MSE score: 1.1429
val source rna MSE score: 0.4162
val target atac MSE score: 0.5077
val source atac MSE score: 0.1483
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
