[True]
Run timestamp: 10102023_080409_196.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_196']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 824 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3572, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 824

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6754; val_auprc_score: 0.6528; val_best_acc_score: 0.5435; val_best_f1_score: 0.6827; train_kl_reg_loss: 53235.7748; train_edge_recon_loss: 731997.4394; train_gene_expr_recon_loss: 22856271.3939; train_masked_gp_l1_reg_loss: 101077.9415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3276994.0985; train_chrom_access_recon_loss: 2961627.1742; train_global_loss: 29981203.6364; train_optim_loss: 29981203.6364; val_kl_reg_loss: 98878.2354; val_edge_recon_loss: 812611.7891; val_gene_expr_recon_loss: 21386953.5000; val_masked_gp_l1_reg_loss: 76806.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2178073.7500; val_chrom_access_recon_loss: 2839692.1562; val_global_loss: 27393015.5000; val_optim_loss: 27393015.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7517; val_auprc_score: 0.7403; val_best_acc_score: 0.6462; val_best_f1_score: 0.7180; train_kl_reg_loss: 88810.8554; train_edge_recon_loss: 744491.6174; train_gene_expr_recon_loss: 21190081.5455; train_masked_gp_l1_reg_loss: 72153.0108; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1398910.2604; train_chrom_access_recon_loss: 2822243.7917; train_global_loss: 26316691.0909; train_optim_loss: 26316691.0909; val_kl_reg_loss: 81777.0127; val_edge_recon_loss: 810910.3672; val_gene_expr_recon_loss: 21043543.7500; val_masked_gp_l1_reg_loss: 70618.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 819470.9375; val_chrom_access_recon_loss: 2795745.2500; val_global_loss: 25622063.7500; val_optim_loss: 25622063.7500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8613; val_auprc_score: 0.8355; val_best_acc_score: 0.7571; val_best_f1_score: 0.7593; train_kl_reg_loss: 79132.2157; train_edge_recon_loss: 735290.8608; train_gene_expr_recon_loss: 21006638.9697; train_masked_gp_l1_reg_loss: 71525.7918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 564428.0923; train_chrom_access_recon_loss: 2807961.3106; train_global_loss: 25264977.3030; train_optim_loss: 25264977.3030; val_kl_reg_loss: 70732.9912; val_edge_recon_loss: 796892.8125; val_gene_expr_recon_loss: 20942899.5000; val_masked_gp_l1_reg_loss: 73355.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 386900.0312; val_chrom_access_recon_loss: 2801021.9375; val_global_loss: 25071802.7500; val_optim_loss: 25071802.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8772; val_auprc_score: 0.8424; val_best_acc_score: 0.8012; val_best_f1_score: 0.8181; train_kl_reg_loss: 70573.6098; train_edge_recon_loss: 721831.2633; train_gene_expr_recon_loss: 20834481.3939; train_masked_gp_l1_reg_loss: 74861.1798; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 303458.5552; train_chrom_access_recon_loss: 2792195.0606; train_global_loss: 24797401.2121; train_optim_loss: 24797401.2121; val_kl_reg_loss: 68926.9482; val_edge_recon_loss: 748624.7812; val_gene_expr_recon_loss: 20698657.2500; val_masked_gp_l1_reg_loss: 76253.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 239551.7969; val_chrom_access_recon_loss: 2780134.9062; val_global_loss: 24612149.7500; val_optim_loss: 24612149.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8736; val_auprc_score: 0.8398; val_best_acc_score: 0.8033; val_best_f1_score: 0.8228; train_kl_reg_loss: 69872.6974; train_edge_recon_loss: 680146.7822; train_gene_expr_recon_loss: 20675072.6667; train_masked_gp_l1_reg_loss: 77730.9650; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 203037.8454; train_chrom_access_recon_loss: 2774635.0379; train_global_loss: 24480496.1818; train_optim_loss: 24480496.1818; val_kl_reg_loss: 75000.2949; val_edge_recon_loss: 657797.3281; val_gene_expr_recon_loss: 20559080.5000; val_masked_gp_l1_reg_loss: 79040.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 173409.1250; val_chrom_access_recon_loss: 2735427.0312; val_global_loss: 24279755.2500; val_optim_loss: 24279755.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8937; val_auprc_score: 0.8655; val_best_acc_score: 0.8197; val_best_f1_score: 0.8384; train_kl_reg_loss: 78036.4716; train_edge_recon_loss: 639091.3466; train_gene_expr_recon_loss: 20551075.0909; train_masked_gp_l1_reg_loss: 80129.0664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 153979.3127; train_chrom_access_recon_loss: 2762325.1705; train_global_loss: 24264636.5758; train_optim_loss: 24264636.5758; val_kl_reg_loss: 78293.7949; val_edge_recon_loss: 631785.8906; val_gene_expr_recon_loss: 20460188.5000; val_masked_gp_l1_reg_loss: 81023.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137969.9531; val_chrom_access_recon_loss: 2745556.6562; val_global_loss: 24134818.5000; val_optim_loss: 24134818.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8958; val_auprc_score: 0.8692; val_best_acc_score: 0.8259; val_best_f1_score: 0.8375; train_kl_reg_loss: 78413.1225; train_edge_recon_loss: 624560.6297; train_gene_expr_recon_loss: 20474006.8182; train_masked_gp_l1_reg_loss: 82173.8246; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 127009.2010; train_chrom_access_recon_loss: 2750299.1136; train_global_loss: 24136462.5758; train_optim_loss: 24136462.5758; val_kl_reg_loss: 78758.7100; val_edge_recon_loss: 626351.5234; val_gene_expr_recon_loss: 20316881.7500; val_masked_gp_l1_reg_loss: 83236.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117868.7891; val_chrom_access_recon_loss: 2738247.5938; val_global_loss: 23961343.5000; val_optim_loss: 23961343.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9141; val_auprc_score: 0.8870; val_best_acc_score: 0.8452; val_best_f1_score: 0.8576; train_kl_reg_loss: 75889.6064; train_edge_recon_loss: 619922.3807; train_gene_expr_recon_loss: 20357679.5455; train_masked_gp_l1_reg_loss: 84129.5464; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110776.3086; train_chrom_access_recon_loss: 2736411.0947; train_global_loss: 23984808.6970; train_optim_loss: 23984808.6970; val_kl_reg_loss: 73269.8096; val_edge_recon_loss: 616479.9609; val_gene_expr_recon_loss: 20097311.2500; val_masked_gp_l1_reg_loss: 85090.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104705.3984; val_chrom_access_recon_loss: 2689159.5312; val_global_loss: 23666017.0000; val_optim_loss: 23666017.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9247; val_auprc_score: 0.9072; val_best_acc_score: 0.8546; val_best_f1_score: 0.8596; train_kl_reg_loss: 75129.5335; train_edge_recon_loss: 610847.0994; train_gene_expr_recon_loss: 20272156.1212; train_masked_gp_l1_reg_loss: 85762.5530; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99771.6045; train_chrom_access_recon_loss: 2728096.6780; train_global_loss: 23871763.4545; train_optim_loss: 23871763.4545; val_kl_reg_loss: 72579.4893; val_edge_recon_loss: 608363.9531; val_gene_expr_recon_loss: 20069587.0000; val_masked_gp_l1_reg_loss: 86763.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95012.0234; val_chrom_access_recon_loss: 2669321.6250; val_global_loss: 23601628.5000; val_optim_loss: 23601628.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9253; val_auprc_score: 0.9070; val_best_acc_score: 0.8560; val_best_f1_score: 0.8648; train_kl_reg_loss: 73898.0138; train_edge_recon_loss: 607467.9138; train_gene_expr_recon_loss: 20190668.0606; train_masked_gp_l1_reg_loss: 87267.7643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91642.8722; train_chrom_access_recon_loss: 2715896.1250; train_global_loss: 23766840.7576; train_optim_loss: 23766840.7576; val_kl_reg_loss: 72053.0498; val_edge_recon_loss: 608925.5234; val_gene_expr_recon_loss: 20051028.2500; val_masked_gp_l1_reg_loss: 87780.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88231.1641; val_chrom_access_recon_loss: 2674298.5938; val_global_loss: 23582318.0000; val_optim_loss: 23582318.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9294; val_auprc_score: 0.9113; val_best_acc_score: 0.8638; val_best_f1_score: 0.8710; train_kl_reg_loss: 72847.2290; train_edge_recon_loss: 602392.2964; train_gene_expr_recon_loss: 20118097.6667; train_masked_gp_l1_reg_loss: 88414.8446; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85518.2183; train_chrom_access_recon_loss: 2705974.2652; train_global_loss: 23673244.6970; train_optim_loss: 23673244.6970; val_kl_reg_loss: 71384.6729; val_edge_recon_loss: 605130.2734; val_gene_expr_recon_loss: 20077026.2500; val_masked_gp_l1_reg_loss: 89253.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83581.5156; val_chrom_access_recon_loss: 2704725.7500; val_global_loss: 23631102.5000; val_optim_loss: 23631102.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9312; val_auprc_score: 0.9046; val_best_acc_score: 0.8710; val_best_f1_score: 0.8748; train_kl_reg_loss: 71503.5870; train_edge_recon_loss: 600080.9650; train_gene_expr_recon_loss: 20038209.4848; train_masked_gp_l1_reg_loss: 89672.8778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81262.5793; train_chrom_access_recon_loss: 2693638.8258; train_global_loss: 23574368.4242; train_optim_loss: 23574368.4242; val_kl_reg_loss: 70714.8223; val_edge_recon_loss: 602405.7891; val_gene_expr_recon_loss: 20001613.7500; val_masked_gp_l1_reg_loss: 90313.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79511.3125; val_chrom_access_recon_loss: 2691446.8125; val_global_loss: 23536006.7500; val_optim_loss: 23536006.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9334; val_auprc_score: 0.9100; val_best_acc_score: 0.8732; val_best_f1_score: 0.8803; train_kl_reg_loss: 70081.7383; train_edge_recon_loss: 598417.6070; train_gene_expr_recon_loss: 19978573.0000; train_masked_gp_l1_reg_loss: 90988.4805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78101.9763; train_chrom_access_recon_loss: 2685249.9015; train_global_loss: 23501412.9091; train_optim_loss: 23501412.9091; val_kl_reg_loss: 70274.0283; val_edge_recon_loss: 599076.9375; val_gene_expr_recon_loss: 19954300.7500; val_masked_gp_l1_reg_loss: 91682.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76347.4531; val_chrom_access_recon_loss: 2676513.5938; val_global_loss: 23468195.5000; val_optim_loss: 23468195.5000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9372; val_auprc_score: 0.9193; val_best_acc_score: 0.8753; val_best_f1_score: 0.8795; train_kl_reg_loss: 69564.9764; train_edge_recon_loss: 595709.5142; train_gene_expr_recon_loss: 19909805.7879; train_masked_gp_l1_reg_loss: 92137.5678; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75384.6246; train_chrom_access_recon_loss: 2673922.7045; train_global_loss: 23416525.0000; train_optim_loss: 23416525.0000; val_kl_reg_loss: 67527.0986; val_edge_recon_loss: 602416.0234; val_gene_expr_recon_loss: 19974960.7500; val_masked_gp_l1_reg_loss: 92807.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75140.2188; val_chrom_access_recon_loss: 2677899.9375; val_global_loss: 23490752.0000; val_optim_loss: 23490752.0000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9396; val_auprc_score: 0.9158; val_best_acc_score: 0.8839; val_best_f1_score: 0.8887; train_kl_reg_loss: 68096.9445; train_edge_recon_loss: 595518.1051; train_gene_expr_recon_loss: 19826882.9394; train_masked_gp_l1_reg_loss: 93367.4255; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73686.7933; train_chrom_access_recon_loss: 2663236.7614; train_global_loss: 23320789.0303; train_optim_loss: 23320789.0303; val_kl_reg_loss: 67496.4297; val_edge_recon_loss: 595908.5938; val_gene_expr_recon_loss: 19863835.0000; val_masked_gp_l1_reg_loss: 94192.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73115.0000; val_chrom_access_recon_loss: 2655652.9688; val_global_loss: 23350200.0000; val_optim_loss: 23350200.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9331; val_auprc_score: 0.8993; val_best_acc_score: 0.8761; val_best_f1_score: 0.8824; train_kl_reg_loss: 67526.8661; train_edge_recon_loss: 592503.1525; train_gene_expr_recon_loss: 19777146.6970; train_masked_gp_l1_reg_loss: 94752.3285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72163.2730; train_chrom_access_recon_loss: 2655266.7311; train_global_loss: 23259359.0909; train_optim_loss: 23259359.0909; val_kl_reg_loss: 67841.7910; val_edge_recon_loss: 595862.0391; val_gene_expr_recon_loss: 19733481.5000; val_masked_gp_l1_reg_loss: 95574.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71676.9844; val_chrom_access_recon_loss: 2636182.9688; val_global_loss: 23200618.0000; val_optim_loss: 23200618.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9417; val_auprc_score: 0.9218; val_best_acc_score: 0.8826; val_best_f1_score: 0.8895; train_kl_reg_loss: 66676.5973; train_edge_recon_loss: 590632.8494; train_gene_expr_recon_loss: 19706855.5152; train_masked_gp_l1_reg_loss: 96163.9429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71133.4827; train_chrom_access_recon_loss: 2642713.4508; train_global_loss: 23174175.4242; train_optim_loss: 23174175.4242; val_kl_reg_loss: 67011.3428; val_edge_recon_loss: 593973.2969; val_gene_expr_recon_loss: 19754284.7500; val_masked_gp_l1_reg_loss: 97102.7344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70951.5078; val_chrom_access_recon_loss: 2619460.4375; val_global_loss: 23202783.7500; val_optim_loss: 23202783.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9438; val_auprc_score: 0.9297; val_best_acc_score: 0.8826; val_best_f1_score: 0.8895; train_kl_reg_loss: 65437.8140; train_edge_recon_loss: 588447.3191; train_gene_expr_recon_loss: 19636592.2121; train_masked_gp_l1_reg_loss: 97928.9273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70431.8511; train_chrom_access_recon_loss: 2631692.5568; train_global_loss: 23090530.6970; train_optim_loss: 23090530.6970; val_kl_reg_loss: 64227.6016; val_edge_recon_loss: 589273.6641; val_gene_expr_recon_loss: 19660304.7500; val_masked_gp_l1_reg_loss: 98669.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69926.3594; val_chrom_access_recon_loss: 2646000.2500; val_global_loss: 23128402.7500; val_optim_loss: 23128402.7500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9472; val_auprc_score: 0.9334; val_best_acc_score: 0.8923; val_best_f1_score: 0.8966; train_kl_reg_loss: 64231.2076; train_edge_recon_loss: 590540.6761; train_gene_expr_recon_loss: 19563572.3939; train_masked_gp_l1_reg_loss: 99598.0236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69765.6426; train_chrom_access_recon_loss: 2621464.7083; train_global_loss: 23009172.4848; train_optim_loss: 23009172.4848; val_kl_reg_loss: 63922.2832; val_edge_recon_loss: 591028.6406; val_gene_expr_recon_loss: 19656145.0000; val_masked_gp_l1_reg_loss: 100672.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69721.4609; val_chrom_access_recon_loss: 2615381.0000; val_global_loss: 23096870.7500; val_optim_loss: 23096870.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9466; val_auprc_score: 0.9260; val_best_acc_score: 0.8941; val_best_f1_score: 0.8981; train_kl_reg_loss: 63410.1938; train_edge_recon_loss: 588096.6373; train_gene_expr_recon_loss: 19493438.4848; train_masked_gp_l1_reg_loss: 101674.6541; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69351.4579; train_chrom_access_recon_loss: 2610451.7879; train_global_loss: 22926423.1515; train_optim_loss: 22926423.1515; val_kl_reg_loss: 63422.3403; val_edge_recon_loss: 592542.0703; val_gene_expr_recon_loss: 19511057.0000; val_masked_gp_l1_reg_loss: 102886.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69538.2734; val_chrom_access_recon_loss: 2591881.9375; val_global_loss: 22931327.5000; val_optim_loss: 22931327.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9377; val_auprc_score: 0.9163; val_best_acc_score: 0.8837; val_best_f1_score: 0.8885; train_kl_reg_loss: 62747.6223; train_edge_recon_loss: 587921.7131; train_gene_expr_recon_loss: 19418567.5455; train_masked_gp_l1_reg_loss: 103972.7054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68925.7013; train_chrom_access_recon_loss: 2596627.5720; train_global_loss: 22838762.8485; train_optim_loss: 22838762.8485; val_kl_reg_loss: 63058.1069; val_edge_recon_loss: 598221.9844; val_gene_expr_recon_loss: 19596392.0000; val_masked_gp_l1_reg_loss: 105540.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69343.5078; val_chrom_access_recon_loss: 2608897.0000; val_global_loss: 23041453.0000; val_optim_loss: 23041453.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9412; val_auprc_score: 0.9161; val_best_acc_score: 0.8893; val_best_f1_score: 0.8935; train_kl_reg_loss: 62104.8962; train_edge_recon_loss: 588328.3362; train_gene_expr_recon_loss: 19337826.7576; train_masked_gp_l1_reg_loss: 106520.9523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68653.5619; train_chrom_access_recon_loss: 2584221.2841; train_global_loss: 22747655.9697; train_optim_loss: 22747655.9697; val_kl_reg_loss: 62212.2861; val_edge_recon_loss: 594857.4766; val_gene_expr_recon_loss: 19480147.0000; val_masked_gp_l1_reg_loss: 107558.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68219.4688; val_chrom_access_recon_loss: 2580496.1875; val_global_loss: 22893491.0000; val_optim_loss: 22893491.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9465; val_auprc_score: 0.9279; val_best_acc_score: 0.8931; val_best_f1_score: 0.8976; train_kl_reg_loss: 61639.6746; train_edge_recon_loss: 587118.8920; train_gene_expr_recon_loss: 19282362.8485; train_masked_gp_l1_reg_loss: 108861.9683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68016.3345; train_chrom_access_recon_loss: 2574201.9697; train_global_loss: 22682201.3939; train_optim_loss: 22682201.3939; val_kl_reg_loss: 61669.1143; val_edge_recon_loss: 586411.6484; val_gene_expr_recon_loss: 19304735.5000; val_masked_gp_l1_reg_loss: 110126.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68528.8984; val_chrom_access_recon_loss: 2589857.7812; val_global_loss: 22721328.0000; val_optim_loss: 22721328.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9467; val_auprc_score: 0.9272; val_best_acc_score: 0.8923; val_best_f1_score: 0.8957; train_kl_reg_loss: 61188.9644; train_edge_recon_loss: 585992.2983; train_gene_expr_recon_loss: 19196544.7879; train_masked_gp_l1_reg_loss: 111393.0636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67952.9065; train_chrom_access_recon_loss: 2559868.5189; train_global_loss: 22582940.3939; train_optim_loss: 22582940.3939; val_kl_reg_loss: 60941.6040; val_edge_recon_loss: 593526.6719; val_gene_expr_recon_loss: 19221150.7500; val_masked_gp_l1_reg_loss: 112590.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67242.8203; val_chrom_access_recon_loss: 2569102.9375; val_global_loss: 22624554.0000; val_optim_loss: 22624554.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9393; val_auprc_score: 0.9139; val_best_acc_score: 0.8880; val_best_f1_score: 0.8940; train_kl_reg_loss: 61210.0241; train_edge_recon_loss: 585521.4877; train_gene_expr_recon_loss: 19115230.6364; train_masked_gp_l1_reg_loss: 113992.4238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67171.5460; train_chrom_access_recon_loss: 2546337.1326; train_global_loss: 22489463.2424; train_optim_loss: 22489463.2424; val_kl_reg_loss: 62533.8281; val_edge_recon_loss: 590863.9766; val_gene_expr_recon_loss: 19002021.7500; val_masked_gp_l1_reg_loss: 115262.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67305.7656; val_chrom_access_recon_loss: 2532224.3438; val_global_loss: 22370212.0000; val_optim_loss: 22370212.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9014; val_auprc_score: 0.8717; val_best_acc_score: 0.8280; val_best_f1_score: 0.8445; train_kl_reg_loss: 36725.8754; train_edge_recon_loss: 769054.7955; train_gene_expr_recon_loss: 18568388.4848; train_masked_gp_l1_reg_loss: 112547.5955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65769.9251; train_chrom_access_recon_loss: 2519944.6212; train_global_loss: 22072431.3636; train_optim_loss: 22072431.3636; val_kl_reg_loss: 13857.1542; val_edge_recon_loss: 785180.9062; val_gene_expr_recon_loss: 18145245.7500; val_masked_gp_l1_reg_loss: 108888.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71574.3828; val_chrom_access_recon_loss: 2468554.9062; val_global_loss: 21593301.2500; val_optim_loss: 21593301.2500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8895; val_auprc_score: 0.8589; val_best_acc_score: 0.8213; val_best_f1_score: 0.8358; train_kl_reg_loss: 19435.1722; train_edge_recon_loss: 775125.6856; train_gene_expr_recon_loss: 18130795.0606; train_masked_gp_l1_reg_loss: 107173.0938; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72929.6828; train_chrom_access_recon_loss: 2449736.8636; train_global_loss: 21555195.4242; train_optim_loss: 21555195.4242; val_kl_reg_loss: 17322.8425; val_edge_recon_loss: 783618.4375; val_gene_expr_recon_loss: 18029458.0000; val_masked_gp_l1_reg_loss: 105584.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73963.7578; val_chrom_access_recon_loss: 2452380.7500; val_global_loss: 21462328.2500; val_optim_loss: 21462328.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8777; val_auprc_score: 0.8436; val_best_acc_score: 0.8015; val_best_f1_score: 0.8228; train_kl_reg_loss: 16859.3970; train_edge_recon_loss: 766537.9773; train_gene_expr_recon_loss: 18014726.9091; train_masked_gp_l1_reg_loss: 104187.5230; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72825.8948; train_chrom_access_recon_loss: 2440654.9091; train_global_loss: 21415792.6667; train_optim_loss: 21415792.6667; val_kl_reg_loss: 8396.2512; val_edge_recon_loss: 765247.5000; val_gene_expr_recon_loss: 18187535.5000; val_masked_gp_l1_reg_loss: 103020.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72548.7656; val_chrom_access_recon_loss: 2469628.1562; val_global_loss: 21606375.2500; val_optim_loss: 21606375.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8715; val_auprc_score: 0.8444; val_best_acc_score: 0.8015; val_best_f1_score: 0.8175; train_kl_reg_loss: 16204.7613; train_edge_recon_loss: 758241.6487; train_gene_expr_recon_loss: 18022337.8788; train_masked_gp_l1_reg_loss: 103196.4242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76004.6874; train_chrom_access_recon_loss: 2438038.1402; train_global_loss: 21414023.5455; train_optim_loss: 21414023.5455; val_kl_reg_loss: 12020.6156; val_edge_recon_loss: 776144.1328; val_gene_expr_recon_loss: 17947149.0000; val_masked_gp_l1_reg_loss: 100430.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73429.6406; val_chrom_access_recon_loss: 2444535.4062; val_global_loss: 21353709.0000; val_optim_loss: 21353709.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8592; val_auprc_score: 0.8281; val_best_acc_score: 0.7934; val_best_f1_score: 0.8153; train_kl_reg_loss: 14797.1294; train_edge_recon_loss: 758136.5265; train_gene_expr_recon_loss: 17963714.2121; train_masked_gp_l1_reg_loss: 99526.4930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74502.3539; train_chrom_access_recon_loss: 2441501.0227; train_global_loss: 21352177.5758; train_optim_loss: 21352177.5758; val_kl_reg_loss: 12252.3522; val_edge_recon_loss: 751093.9219; val_gene_expr_recon_loss: 17750873.5000; val_masked_gp_l1_reg_loss: 98649.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75669.8516; val_chrom_access_recon_loss: 2397685.8438; val_global_loss: 21086225.5000; val_optim_loss: 21086225.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8592; val_auprc_score: 0.8311; val_best_acc_score: 0.7786; val_best_f1_score: 0.8007; train_kl_reg_loss: 16440.4559; train_edge_recon_loss: 736868.4186; train_gene_expr_recon_loss: 17903495.1818; train_masked_gp_l1_reg_loss: 97394.9794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75501.6449; train_chrom_access_recon_loss: 2431180.0265; train_global_loss: 21260880.8485; train_optim_loss: 21260880.8485; val_kl_reg_loss: 12051.3068; val_edge_recon_loss: 744969.8359; val_gene_expr_recon_loss: 17809233.2500; val_masked_gp_l1_reg_loss: 97044.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76261.4141; val_chrom_access_recon_loss: 2399683.4375; val_global_loss: 21139243.2500; val_optim_loss: 21139243.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8698; val_auprc_score: 0.8416; val_best_acc_score: 0.7937; val_best_f1_score: 0.8118; train_kl_reg_loss: 18301.7552; train_edge_recon_loss: 717282.0502; train_gene_expr_recon_loss: 17836047.4545; train_masked_gp_l1_reg_loss: 95842.5026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74835.0090; train_chrom_access_recon_loss: 2420128.3409; train_global_loss: 21162437.1818; train_optim_loss: 21162437.1818; val_kl_reg_loss: 14644.5876; val_edge_recon_loss: 716849.5312; val_gene_expr_recon_loss: 17871467.7500; val_masked_gp_l1_reg_loss: 94588.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73484.1250; val_chrom_access_recon_loss: 2405488.6562; val_global_loss: 21176523.2500; val_optim_loss: 21176523.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8617; val_auprc_score: 0.8334; val_best_acc_score: 0.7843; val_best_f1_score: 0.8107; train_kl_reg_loss: 19660.1010; train_edge_recon_loss: 699362.3627; train_gene_expr_recon_loss: 17814168.7576; train_masked_gp_l1_reg_loss: 93792.6400; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72850.0666; train_chrom_access_recon_loss: 2424068.2917; train_global_loss: 21123902.0303; train_optim_loss: 21123902.0303; val_kl_reg_loss: 18591.2900; val_edge_recon_loss: 696318.0156; val_gene_expr_recon_loss: 17788184.7500; val_masked_gp_l1_reg_loss: 92853.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72079.2422; val_chrom_access_recon_loss: 2420918.8750; val_global_loss: 21088946.5000; val_optim_loss: 21088946.5000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8697; val_auprc_score: 0.8498; val_best_acc_score: 0.7853; val_best_f1_score: 0.8052; train_kl_reg_loss: 21741.0072; train_edge_recon_loss: 679985.5085; train_gene_expr_recon_loss: 17788898.6970; train_masked_gp_l1_reg_loss: 91961.9098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70868.5314; train_chrom_access_recon_loss: 2417994.7311; train_global_loss: 21071450.3333; train_optim_loss: 21071450.3333; val_kl_reg_loss: 18471.2183; val_edge_recon_loss: 698490.1719; val_gene_expr_recon_loss: 17840632.7500; val_masked_gp_l1_reg_loss: 91203.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69662.7891; val_chrom_access_recon_loss: 2406054.5938; val_global_loss: 21124514.5000; val_optim_loss: 21124514.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8655; val_auprc_score: 0.8302; val_best_acc_score: 0.7907; val_best_f1_score: 0.8129; train_kl_reg_loss: 22304.1893; train_edge_recon_loss: 681972.1742; train_gene_expr_recon_loss: 17766488.2424; train_masked_gp_l1_reg_loss: 89675.6174; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62658.1308; train_chrom_access_recon_loss: 2418460.7424; train_global_loss: 21041558.9394; train_optim_loss: 21041558.9394; val_kl_reg_loss: 19675.3474; val_edge_recon_loss: 693805.4062; val_gene_expr_recon_loss: 17685767.5000; val_masked_gp_l1_reg_loss: 89010.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60824.8633; val_chrom_access_recon_loss: 2401970.0625; val_global_loss: 20951052.2500; val_optim_loss: 20951052.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8601; val_auprc_score: 0.8301; val_best_acc_score: 0.7837; val_best_f1_score: 0.8080; train_kl_reg_loss: 23088.4635; train_edge_recon_loss: 679519.3920; train_gene_expr_recon_loss: 17744940.8788; train_masked_gp_l1_reg_loss: 88742.3832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60106.8761; train_chrom_access_recon_loss: 2415198.5530; train_global_loss: 21011596.4545; train_optim_loss: 21011596.4545; val_kl_reg_loss: 19677.5872; val_edge_recon_loss: 685582.8047; val_gene_expr_recon_loss: 17656353.2500; val_masked_gp_l1_reg_loss: 88559.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59488.0234; val_chrom_access_recon_loss: 2406444.2812; val_global_loss: 20916105.5000; val_optim_loss: 20916105.5000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8581; val_auprc_score: 0.8231; val_best_acc_score: 0.7778; val_best_f1_score: 0.8047; train_kl_reg_loss: 23389.5362; train_edge_recon_loss: 676733.3390; train_gene_expr_recon_loss: 17742473.0606; train_masked_gp_l1_reg_loss: 88439.9381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59066.5961; train_chrom_access_recon_loss: 2415388.0379; train_global_loss: 21005490.2424; train_optim_loss: 21005490.2424; val_kl_reg_loss: 19914.5266; val_edge_recon_loss: 688641.9453; val_gene_expr_recon_loss: 17636575.7500; val_masked_gp_l1_reg_loss: 88304.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58713.4648; val_chrom_access_recon_loss: 2392291.8750; val_global_loss: 20884442.0000; val_optim_loss: 20884442.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8716; val_auprc_score: 0.8362; val_best_acc_score: 0.7988; val_best_f1_score: 0.8194; train_kl_reg_loss: 23338.2087; train_edge_recon_loss: 674957.0871; train_gene_expr_recon_loss: 17735610.6212; train_masked_gp_l1_reg_loss: 88209.9381; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58454.5885; train_chrom_access_recon_loss: 2415187.2879; train_global_loss: 20995757.7879; train_optim_loss: 20995757.7879; val_kl_reg_loss: 20175.3569; val_edge_recon_loss: 678279.4688; val_gene_expr_recon_loss: 17719939.7500; val_masked_gp_l1_reg_loss: 88130.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58168.2617; val_chrom_access_recon_loss: 2401798.8125; val_global_loss: 20966491.2500; val_optim_loss: 20966491.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8655; val_auprc_score: 0.8377; val_best_acc_score: 0.7851; val_best_f1_score: 0.8119; train_kl_reg_loss: 23072.1401; train_edge_recon_loss: 671759.1600; train_gene_expr_recon_loss: 17739509.1212; train_masked_gp_l1_reg_loss: 88032.4289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57949.7830; train_chrom_access_recon_loss: 2414765.0985; train_global_loss: 20995087.7879; train_optim_loss: 20995087.7879; val_kl_reg_loss: 19573.7034; val_edge_recon_loss: 673927.9297; val_gene_expr_recon_loss: 17650168.7500; val_masked_gp_l1_reg_loss: 87949.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57779.2930; val_chrom_access_recon_loss: 2394377.3750; val_global_loss: 20883777.5000; val_optim_loss: 20883777.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8730; val_auprc_score: 0.8369; val_best_acc_score: 0.8025; val_best_f1_score: 0.8215; train_kl_reg_loss: 23020.7347; train_edge_recon_loss: 672196.0294; train_gene_expr_recon_loss: 17732098.1818; train_masked_gp_l1_reg_loss: 87862.3140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57588.7528; train_chrom_access_recon_loss: 2412292.4811; train_global_loss: 20985058.5758; train_optim_loss: 20985058.5758; val_kl_reg_loss: 19632.0593; val_edge_recon_loss: 675317.7969; val_gene_expr_recon_loss: 17716066.0000; val_masked_gp_l1_reg_loss: 87785.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57417.7148; val_chrom_access_recon_loss: 2401679.8125; val_global_loss: 20957899.7500; val_optim_loss: 20957899.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8678; val_auprc_score: 0.8400; val_best_acc_score: 0.7864; val_best_f1_score: 0.8124; train_kl_reg_loss: 22807.4033; train_edge_recon_loss: 670952.8097; train_gene_expr_recon_loss: 17721355.5152; train_masked_gp_l1_reg_loss: 87709.6583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57262.8108; train_chrom_access_recon_loss: 2413676.0227; train_global_loss: 20973764.4848; train_optim_loss: 20973764.4848; val_kl_reg_loss: 19648.3950; val_edge_recon_loss: 675563.0625; val_gene_expr_recon_loss: 17803600.5000; val_masked_gp_l1_reg_loss: 87632.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57095.2930; val_chrom_access_recon_loss: 2412871.1250; val_global_loss: 21056410.7500; val_optim_loss: 21056410.7500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8733; val_auprc_score: 0.8364; val_best_acc_score: 0.7993; val_best_f1_score: 0.8219; train_kl_reg_loss: 22926.8137; train_edge_recon_loss: 670225.3873; train_gene_expr_recon_loss: 17719395.6970; train_masked_gp_l1_reg_loss: 87545.0979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56929.1686; train_chrom_access_recon_loss: 2412575.1439; train_global_loss: 20969597.1818; train_optim_loss: 20969597.1818; val_kl_reg_loss: 19901.8477; val_edge_recon_loss: 674525.5469; val_gene_expr_recon_loss: 17618620.0000; val_masked_gp_l1_reg_loss: 87472.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56764.1523; val_chrom_access_recon_loss: 2387730.2188; val_global_loss: 20845013.0000; val_optim_loss: 20845013.0000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8661; val_auprc_score: 0.8335; val_best_acc_score: 0.7902; val_best_f1_score: 0.8119; train_kl_reg_loss: 23246.5834; train_edge_recon_loss: 665299.7708; train_gene_expr_recon_loss: 17731692.6667; train_masked_gp_l1_reg_loss: 87396.0866; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56622.0777; train_chrom_access_recon_loss: 2413661.2689; train_global_loss: 20977918.3333; train_optim_loss: 20977918.3333; val_kl_reg_loss: 20259.4050; val_edge_recon_loss: 673716.6797; val_gene_expr_recon_loss: 17737598.2500; val_masked_gp_l1_reg_loss: 87313.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56489.8164; val_chrom_access_recon_loss: 2422313.7188; val_global_loss: 20997691.0000; val_optim_loss: 20997691.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8681; val_auprc_score: 0.8364; val_best_acc_score: 0.7934; val_best_f1_score: 0.8148; train_kl_reg_loss: 23187.5565; train_edge_recon_loss: 667456.2301; train_gene_expr_recon_loss: 17711701.3333; train_masked_gp_l1_reg_loss: 87250.0808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56370.4283; train_chrom_access_recon_loss: 2410270.4280; train_global_loss: 20956236.0606; train_optim_loss: 20956236.0606; val_kl_reg_loss: 20319.7371; val_edge_recon_loss: 670653.0547; val_gene_expr_recon_loss: 17694082.7500; val_masked_gp_l1_reg_loss: 87156.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56233.3203; val_chrom_access_recon_loss: 2409045.9375; val_global_loss: 20937491.5000; val_optim_loss: 20937491.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8643; val_auprc_score: 0.8304; val_best_acc_score: 0.7918; val_best_f1_score: 0.8171; train_kl_reg_loss: 23318.8585; train_edge_recon_loss: 663483.7443; train_gene_expr_recon_loss: 17718515.1061; train_masked_gp_l1_reg_loss: 87109.3732; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56132.1866; train_chrom_access_recon_loss: 2413821.9015; train_global_loss: 20962380.9091; train_optim_loss: 20962380.9091; val_kl_reg_loss: 21033.0327; val_edge_recon_loss: 667209.4141; val_gene_expr_recon_loss: 17873445.0000; val_masked_gp_l1_reg_loss: 87038.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55987.7656; val_chrom_access_recon_loss: 2444623.9062; val_global_loss: 21149337.7500; val_optim_loss: 21149337.7500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8652; val_auprc_score: 0.8382; val_best_acc_score: 0.7907; val_best_f1_score: 0.8109; train_kl_reg_loss: 23558.5843; train_edge_recon_loss: 661056.6506; train_gene_expr_recon_loss: 17720992.2121; train_masked_gp_l1_reg_loss: 86973.2836; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55901.6142; train_chrom_access_recon_loss: 2413697.8902; train_global_loss: 20962180.2727; train_optim_loss: 20962180.2727; val_kl_reg_loss: 20782.7200; val_edge_recon_loss: 665768.3594; val_gene_expr_recon_loss: 17650831.5000; val_masked_gp_l1_reg_loss: 86899.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55763.5664; val_chrom_access_recon_loss: 2408271.4688; val_global_loss: 20888317.5000; val_optim_loss: 20888317.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8634; val_auprc_score: 0.8296; val_best_acc_score: 0.7937; val_best_f1_score: 0.8179; train_kl_reg_loss: 23549.9361; train_edge_recon_loss: 662268.5900; train_gene_expr_recon_loss: 17702401.9091; train_masked_gp_l1_reg_loss: 86740.3941; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55018.5903; train_chrom_access_recon_loss: 2410441.4735; train_global_loss: 20940420.7273; train_optim_loss: 20940420.7273; val_kl_reg_loss: 20787.4680; val_edge_recon_loss: 667334.0391; val_gene_expr_recon_loss: 17766797.0000; val_masked_gp_l1_reg_loss: 86671.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54861.8125; val_chrom_access_recon_loss: 2403927.1562; val_global_loss: 21000379.2500; val_optim_loss: 21000379.2500
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8649; val_auprc_score: 0.8342; val_best_acc_score: 0.7899; val_best_f1_score: 0.8121; train_kl_reg_loss: 23561.4668; train_edge_recon_loss: 661472.0540; train_gene_expr_recon_loss: 17699805.1970; train_masked_gp_l1_reg_loss: 86646.1023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54833.9550; train_chrom_access_recon_loss: 2408092.3295; train_global_loss: 20934411.2121; train_optim_loss: 20934411.2121; val_kl_reg_loss: 20840.4924; val_edge_recon_loss: 668799.7266; val_gene_expr_recon_loss: 17861630.2500; val_masked_gp_l1_reg_loss: 86624.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54810.3594; val_chrom_access_recon_loss: 2430451.0312; val_global_loss: 21123155.0000; val_optim_loss: 21123155.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8747; val_auprc_score: 0.8421; val_best_acc_score: 0.7977; val_best_f1_score: 0.8206; train_kl_reg_loss: 23612.8957; train_edge_recon_loss: 662169.4735; train_gene_expr_recon_loss: 17702896.2879; train_masked_gp_l1_reg_loss: 86609.3826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54789.0292; train_chrom_access_recon_loss: 2411991.9735; train_global_loss: 20942068.8182; train_optim_loss: 20942068.8182; val_kl_reg_loss: 21075.3228; val_edge_recon_loss: 663799.4141; val_gene_expr_recon_loss: 17803326.5000; val_masked_gp_l1_reg_loss: 86594.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54766.2422; val_chrom_access_recon_loss: 2407704.5938; val_global_loss: 21037265.5000; val_optim_loss: 21037265.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8633; val_auprc_score: 0.8299; val_best_acc_score: 0.7872; val_best_f1_score: 0.8081; train_kl_reg_loss: 23706.5341; train_edge_recon_loss: 659567.6269; train_gene_expr_recon_loss: 17711199.7273; train_masked_gp_l1_reg_loss: 86581.1857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54750.1226; train_chrom_access_recon_loss: 2410805.3939; train_global_loss: 20946610.5152; train_optim_loss: 20946610.5152; val_kl_reg_loss: 20849.4868; val_edge_recon_loss: 670288.5078; val_gene_expr_recon_loss: 17720187.5000; val_masked_gp_l1_reg_loss: 86567.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54729.6602; val_chrom_access_recon_loss: 2423959.8438; val_global_loss: 20976583.0000; val_optim_loss: 20976583.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 21 min 45 sec.
Using best model state, which was in epoch 42.

--- MODEL EVALUATION ---
val AUROC score: 0.8761
val AUPRC score: 0.8488
val best accuracy score: 0.8039
val best F1 score: 0.8246
val target rna MSE score: 1.9943
val source rna MSE score: 1.4438
val target atac MSE score: 0.4753
val source atac MSE score: 0.2071
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
