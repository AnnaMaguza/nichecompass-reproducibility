[True]
Run timestamp: 09102023_215218_48.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_48']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6699; val_auprc_score: 0.6621; val_best_acc_score: 0.5118; val_best_f1_score: 0.6717; train_kl_reg_loss: 34719.2497; train_edge_recon_loss: 3503394.5682; train_gene_expr_recon_loss: 14344013.7727; train_masked_gp_l1_reg_loss: 134059.4322; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4628623.9432; train_chrom_access_recon_loss: 2345418.9962; train_global_loss: 24990229.9697; train_optim_loss: 24990229.9697; val_kl_reg_loss: 82206.8613; val_edge_recon_loss: 4064874.5312; val_gene_expr_recon_loss: 13267460.5000; val_masked_gp_l1_reg_loss: 112191.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2246855.7500; val_chrom_access_recon_loss: 2269370.4375; val_global_loss: 22042960.5000; val_optim_loss: 22042960.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7395; val_auprc_score: 0.7209; val_best_acc_score: 0.5465; val_best_f1_score: 0.6835; train_kl_reg_loss: 84820.0862; train_edge_recon_loss: 3514725.6023; train_gene_expr_recon_loss: 12848212.4091; train_masked_gp_l1_reg_loss: 105204.2054; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1075828.3513; train_chrom_access_recon_loss: 2219503.8636; train_global_loss: 19848294.6061; train_optim_loss: 19848294.6061; val_kl_reg_loss: 94452.7783; val_edge_recon_loss: 4062192.7812; val_gene_expr_recon_loss: 12747550.6250; val_masked_gp_l1_reg_loss: 101908.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 444255.5938; val_chrom_access_recon_loss: 2207992.0625; val_global_loss: 19658352.0000; val_optim_loss: 19658352.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7809; val_auprc_score: 0.7648; val_best_acc_score: 0.6797; val_best_f1_score: 0.7370; train_kl_reg_loss: 84581.2404; train_edge_recon_loss: 3512928.8864; train_gene_expr_recon_loss: 12667765.2879; train_masked_gp_l1_reg_loss: 101573.4136; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 293232.2881; train_chrom_access_recon_loss: 2196816.0777; train_global_loss: 18856897.1515; train_optim_loss: 18856897.1515; val_kl_reg_loss: 73109.7324; val_edge_recon_loss: 4052943.6250; val_gene_expr_recon_loss: 12798821.6250; val_masked_gp_l1_reg_loss: 101395.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 202182.7656; val_chrom_access_recon_loss: 2197030.5000; val_global_loss: 19425483.0000; val_optim_loss: 19425483.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8005; val_auprc_score: 0.7857; val_best_acc_score: 0.7217; val_best_f1_score: 0.7470; train_kl_reg_loss: 76030.2904; train_edge_recon_loss: 3501923.8409; train_gene_expr_recon_loss: 12571797.6515; train_masked_gp_l1_reg_loss: 102089.8299; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163850.7505; train_chrom_access_recon_loss: 2183895.8295; train_global_loss: 18599588.0909; train_optim_loss: 18599588.0909; val_kl_reg_loss: 67875.6406; val_edge_recon_loss: 3887702.2188; val_gene_expr_recon_loss: 12742060.6250; val_masked_gp_l1_reg_loss: 103075.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 135507.2344; val_chrom_access_recon_loss: 2186429.2031; val_global_loss: 19122651.2500; val_optim_loss: 19122651.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8311; val_auprc_score: 0.8104; val_best_acc_score: 0.7434; val_best_f1_score: 0.7693; train_kl_reg_loss: 54498.8692; train_edge_recon_loss: 3362625.3068; train_gene_expr_recon_loss: 12591787.9394; train_masked_gp_l1_reg_loss: 112122.2231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 123419.0993; train_chrom_access_recon_loss: 2172888.0057; train_global_loss: 18417341.4545; train_optim_loss: 18417341.4545; val_kl_reg_loss: 44882.5850; val_edge_recon_loss: 3333750.1562; val_gene_expr_recon_loss: 12661057.0000; val_masked_gp_l1_reg_loss: 124265.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 115906.9844; val_chrom_access_recon_loss: 2166817.3125; val_global_loss: 18446679.0000; val_optim_loss: 18446679.0000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8432; val_auprc_score: 0.8076; val_best_acc_score: 0.7603; val_best_f1_score: 0.7914; train_kl_reg_loss: 59770.6310; train_edge_recon_loss: 3113178.9621; train_gene_expr_recon_loss: 12485274.0455; train_masked_gp_l1_reg_loss: 127643.1499; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108284.1494; train_chrom_access_recon_loss: 2159007.1837; train_global_loss: 18053158.2121; train_optim_loss: 18053158.2121; val_kl_reg_loss: 71262.2432; val_edge_recon_loss: 3040635.8750; val_gene_expr_recon_loss: 12647241.3750; val_masked_gp_l1_reg_loss: 129994.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102469.3359; val_chrom_access_recon_loss: 2158301.6094; val_global_loss: 18149905.0000; val_optim_loss: 18149905.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8514; val_auprc_score: 0.8181; val_best_acc_score: 0.7620; val_best_f1_score: 0.7958; train_kl_reg_loss: 85832.3200; train_edge_recon_loss: 2956985.6364; train_gene_expr_recon_loss: 12395835.8788; train_masked_gp_l1_reg_loss: 130422.8651; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99905.6635; train_chrom_access_recon_loss: 2150214.5246; train_global_loss: 17819196.8485; train_optim_loss: 17819196.8485; val_kl_reg_loss: 89264.3096; val_edge_recon_loss: 2941328.4062; val_gene_expr_recon_loss: 12570574.8750; val_masked_gp_l1_reg_loss: 130254.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97538.5547; val_chrom_access_recon_loss: 2168315.0312; val_global_loss: 17997275.5000; val_optim_loss: 17997275.5000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8487; val_auprc_score: 0.8184; val_best_acc_score: 0.7652; val_best_f1_score: 0.8012; train_kl_reg_loss: 93326.4711; train_edge_recon_loss: 2918791.7348; train_gene_expr_recon_loss: 12317297.7879; train_masked_gp_l1_reg_loss: 130326.6055; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95016.2584; train_chrom_access_recon_loss: 2138787.2216; train_global_loss: 17693546.0303; train_optim_loss: 17693546.0303; val_kl_reg_loss: 93190.3838; val_edge_recon_loss: 2910370.4688; val_gene_expr_recon_loss: 12373918.5000; val_masked_gp_l1_reg_loss: 130534.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92719.0859; val_chrom_access_recon_loss: 2130988.3906; val_global_loss: 17731721.7500; val_optim_loss: 17731721.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8680; val_auprc_score: 0.8285; val_best_acc_score: 0.7931; val_best_f1_score: 0.8155; train_kl_reg_loss: 91930.0503; train_edge_recon_loss: 2917823.5000; train_gene_expr_recon_loss: 12258707.7576; train_masked_gp_l1_reg_loss: 130280.1123; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90861.6188; train_chrom_access_recon_loss: 2128247.5019; train_global_loss: 17617850.5455; train_optim_loss: 17617850.5455; val_kl_reg_loss: 94706.2148; val_edge_recon_loss: 2890837.5938; val_gene_expr_recon_loss: 12338682.7500; val_masked_gp_l1_reg_loss: 130475.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89576.1562; val_chrom_access_recon_loss: 2158985.3750; val_global_loss: 17703263.7500; val_optim_loss: 17703263.7500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8631; val_auprc_score: 0.8174; val_best_acc_score: 0.7993; val_best_f1_score: 0.8203; train_kl_reg_loss: 93236.8247; train_edge_recon_loss: 2878419.4811; train_gene_expr_recon_loss: 12199843.0152; train_masked_gp_l1_reg_loss: 130974.3195; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88234.5642; train_chrom_access_recon_loss: 2119913.3636; train_global_loss: 17510621.5455; train_optim_loss: 17510621.5455; val_kl_reg_loss: 91452.3359; val_edge_recon_loss: 2897878.1250; val_gene_expr_recon_loss: 12180242.1250; val_masked_gp_l1_reg_loss: 131543.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87242.8594; val_chrom_access_recon_loss: 2119915.4062; val_global_loss: 17508274.2500; val_optim_loss: 17508274.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8908; val_auprc_score: 0.8555; val_best_acc_score: 0.8243; val_best_f1_score: 0.8388; train_kl_reg_loss: 91932.9632; train_edge_recon_loss: 2845046.1364; train_gene_expr_recon_loss: 12155829.9242; train_masked_gp_l1_reg_loss: 131601.3364; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86265.6525; train_chrom_access_recon_loss: 2114378.4451; train_global_loss: 17425054.5758; train_optim_loss: 17425054.5758; val_kl_reg_loss: 93427.5654; val_edge_recon_loss: 2836883.9062; val_gene_expr_recon_loss: 12222764.2500; val_masked_gp_l1_reg_loss: 132256.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85501.3125; val_chrom_access_recon_loss: 2132747.3125; val_global_loss: 17503580.0000; val_optim_loss: 17503580.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8976; val_auprc_score: 0.8602; val_best_acc_score: 0.8366; val_best_f1_score: 0.8485; train_kl_reg_loss: 93511.4807; train_edge_recon_loss: 2837418.3485; train_gene_expr_recon_loss: 12123937.9848; train_masked_gp_l1_reg_loss: 132333.3800; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84634.2129; train_chrom_access_recon_loss: 2107608.2614; train_global_loss: 17379443.6667; train_optim_loss: 17379443.6667; val_kl_reg_loss: 96764.2949; val_edge_recon_loss: 2845678.8125; val_gene_expr_recon_loss: 12249997.0000; val_masked_gp_l1_reg_loss: 133051.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83766.7734; val_chrom_access_recon_loss: 2128023.7812; val_global_loss: 17537281.7500; val_optim_loss: 17537281.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9061; val_auprc_score: 0.8738; val_best_acc_score: 0.8461; val_best_f1_score: 0.8572; train_kl_reg_loss: 92572.0868; train_edge_recon_loss: 2813283.6591; train_gene_expr_recon_loss: 12069040.3333; train_masked_gp_l1_reg_loss: 133140.6236; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83095.3086; train_chrom_access_recon_loss: 2099232.7841; train_global_loss: 17290364.9091; train_optim_loss: 17290364.9091; val_kl_reg_loss: 93570.6240; val_edge_recon_loss: 2831817.5625; val_gene_expr_recon_loss: 12224132.0000; val_masked_gp_l1_reg_loss: 133305.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82736.2031; val_chrom_access_recon_loss: 2117452.8906; val_global_loss: 17483014.0000; val_optim_loss: 17483014.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9077; val_auprc_score: 0.8758; val_best_acc_score: 0.8455; val_best_f1_score: 0.8576; train_kl_reg_loss: 93301.0161; train_edge_recon_loss: 2801135.1818; train_gene_expr_recon_loss: 12036791.3182; train_masked_gp_l1_reg_loss: 133401.1269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81795.8633; train_chrom_access_recon_loss: 2095463.8390; train_global_loss: 17241888.4091; train_optim_loss: 17241888.4091; val_kl_reg_loss: 94774.8994; val_edge_recon_loss: 2826154.8125; val_gene_expr_recon_loss: 12138368.8750; val_masked_gp_l1_reg_loss: 133484.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81075.1016; val_chrom_access_recon_loss: 2105584.3750; val_global_loss: 17379442.2500; val_optim_loss: 17379442.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9165; val_auprc_score: 0.8851; val_best_acc_score: 0.8563; val_best_f1_score: 0.8671; train_kl_reg_loss: 90389.2209; train_edge_recon_loss: 2801647.2424; train_gene_expr_recon_loss: 12011518.5000; train_masked_gp_l1_reg_loss: 133961.7285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80689.4433; train_chrom_access_recon_loss: 2088259.8011; train_global_loss: 17206465.9091; train_optim_loss: 17206465.9091; val_kl_reg_loss: 96407.1475; val_edge_recon_loss: 2798018.1250; val_gene_expr_recon_loss: 12108272.7500; val_masked_gp_l1_reg_loss: 134356.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79646.7656; val_chrom_access_recon_loss: 2094381.6250; val_global_loss: 17311083.0000; val_optim_loss: 17311083.0000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9158; val_auprc_score: 0.8779; val_best_acc_score: 0.8571; val_best_f1_score: 0.8659; train_kl_reg_loss: 93199.7224; train_edge_recon_loss: 2787082.8864; train_gene_expr_recon_loss: 11965394.6212; train_masked_gp_l1_reg_loss: 134203.7917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79184.4260; train_chrom_access_recon_loss: 2081071.9830; train_global_loss: 17140137.4394; train_optim_loss: 17140137.4394; val_kl_reg_loss: 91258.1982; val_edge_recon_loss: 2809382.4688; val_gene_expr_recon_loss: 12087847.8750; val_masked_gp_l1_reg_loss: 134386.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78835.0234; val_chrom_access_recon_loss: 2082926.5625; val_global_loss: 17284635.7500; val_optim_loss: 17284635.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9237; val_auprc_score: 0.8929; val_best_acc_score: 0.8667; val_best_f1_score: 0.8748; train_kl_reg_loss: 93058.8023; train_edge_recon_loss: 2768151.4015; train_gene_expr_recon_loss: 11922800.1818; train_masked_gp_l1_reg_loss: 134335.3331; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78426.1193; train_chrom_access_recon_loss: 2072911.5436; train_global_loss: 17069683.4394; train_optim_loss: 17069683.4394; val_kl_reg_loss: 90211.1562; val_edge_recon_loss: 2766129.0000; val_gene_expr_recon_loss: 12147937.0000; val_masked_gp_l1_reg_loss: 134712.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78812.0156; val_chrom_access_recon_loss: 2091207.2969; val_global_loss: 17309009.5000; val_optim_loss: 17309009.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9281; val_auprc_score: 0.8935; val_best_acc_score: 0.8702; val_best_f1_score: 0.8754; train_kl_reg_loss: 91355.3150; train_edge_recon_loss: 2764813.0795; train_gene_expr_recon_loss: 11910594.9848; train_masked_gp_l1_reg_loss: 134541.9418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78072.2047; train_chrom_access_recon_loss: 2071591.9413; train_global_loss: 17050969.4091; train_optim_loss: 17050969.4091; val_kl_reg_loss: 92135.0186; val_edge_recon_loss: 2765697.1250; val_gene_expr_recon_loss: 11983305.6250; val_masked_gp_l1_reg_loss: 134392.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77359.6641; val_chrom_access_recon_loss: 2062453.2812; val_global_loss: 17115343.0000; val_optim_loss: 17115343.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9299; val_auprc_score: 0.9013; val_best_acc_score: 0.8705; val_best_f1_score: 0.8765; train_kl_reg_loss: 93101.1499; train_edge_recon_loss: 2749731.7159; train_gene_expr_recon_loss: 11883322.8182; train_masked_gp_l1_reg_loss: 134397.3551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77294.4528; train_chrom_access_recon_loss: 2068221.2822; train_global_loss: 17006068.8788; train_optim_loss: 17006068.8788; val_kl_reg_loss: 90825.1973; val_edge_recon_loss: 2799703.5000; val_gene_expr_recon_loss: 11965295.1250; val_masked_gp_l1_reg_loss: 134570.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77219.0391; val_chrom_access_recon_loss: 2067462.6719; val_global_loss: 17135075.3750; val_optim_loss: 17135075.3750
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9245; val_auprc_score: 0.8909; val_best_acc_score: 0.8624; val_best_f1_score: 0.8719; train_kl_reg_loss: 91374.8281; train_edge_recon_loss: 2758911.9394; train_gene_expr_recon_loss: 11856979.4242; train_masked_gp_l1_reg_loss: 134460.8646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76821.7116; train_chrom_access_recon_loss: 2061385.7140; train_global_loss: 16979934.4394; train_optim_loss: 16979934.4394; val_kl_reg_loss: 92404.8096; val_edge_recon_loss: 2817281.4688; val_gene_expr_recon_loss: 11982082.7500; val_masked_gp_l1_reg_loss: 134922.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76892.1172; val_chrom_access_recon_loss: 2075525.1406; val_global_loss: 17179108.1250; val_optim_loss: 17179108.1250
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9291; val_auprc_score: 0.8958; val_best_acc_score: 0.8708; val_best_f1_score: 0.8794; train_kl_reg_loss: 92721.1778; train_edge_recon_loss: 2734750.0682; train_gene_expr_recon_loss: 11832786.9697; train_masked_gp_l1_reg_loss: 134604.2183; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76357.7064; train_chrom_access_recon_loss: 2055830.3617; train_global_loss: 16927050.3788; train_optim_loss: 16927050.3788; val_kl_reg_loss: 93651.8428; val_edge_recon_loss: 2767189.8750; val_gene_expr_recon_loss: 11879874.0000; val_masked_gp_l1_reg_loss: 134540.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76169.2578; val_chrom_access_recon_loss: 2066941.8906; val_global_loss: 17018366.8750; val_optim_loss: 17018366.8750
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9377; val_auprc_score: 0.9110; val_best_acc_score: 0.8783; val_best_f1_score: 0.8854; train_kl_reg_loss: 91208.0709; train_edge_recon_loss: 2749628.1780; train_gene_expr_recon_loss: 11801760.2879; train_masked_gp_l1_reg_loss: 134243.8241; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76001.0817; train_chrom_access_recon_loss: 2051789.6742; train_global_loss: 16904631.1515; train_optim_loss: 16904631.1515; val_kl_reg_loss: 89755.8262; val_edge_recon_loss: 2780408.3125; val_gene_expr_recon_loss: 11918712.8750; val_masked_gp_l1_reg_loss: 134219.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75917.0391; val_chrom_access_recon_loss: 2060007.0312; val_global_loss: 17059019.8750; val_optim_loss: 17059019.8750
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9300; val_auprc_score: 0.9018; val_best_acc_score: 0.8735; val_best_f1_score: 0.8827; train_kl_reg_loss: 91122.3164; train_edge_recon_loss: 2743551.3674; train_gene_expr_recon_loss: 11790314.0758; train_masked_gp_l1_reg_loss: 134209.2628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75807.5836; train_chrom_access_recon_loss: 2048686.1231; train_global_loss: 16883690.6364; train_optim_loss: 16883690.6364; val_kl_reg_loss: 94395.9023; val_edge_recon_loss: 2777582.5938; val_gene_expr_recon_loss: 11975515.7500; val_masked_gp_l1_reg_loss: 134108.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75401.0078; val_chrom_access_recon_loss: 2064591.3438; val_global_loss: 17121594.7500; val_optim_loss: 17121594.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9446; val_auprc_score: 0.9250; val_best_acc_score: 0.8869; val_best_f1_score: 0.8940; train_kl_reg_loss: 89630.6309; train_edge_recon_loss: 2743429.7765; train_gene_expr_recon_loss: 11762123.5606; train_masked_gp_l1_reg_loss: 134116.7412; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75360.5044; train_chrom_access_recon_loss: 2042350.9053; train_global_loss: 16847012.0758; train_optim_loss: 16847012.0758; val_kl_reg_loss: 91514.5557; val_edge_recon_loss: 2743162.0625; val_gene_expr_recon_loss: 11901152.8750; val_masked_gp_l1_reg_loss: 134492.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75561.3672; val_chrom_access_recon_loss: 2056021.8906; val_global_loss: 17001904.3750; val_optim_loss: 17001904.3750
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9357; val_auprc_score: 0.9072; val_best_acc_score: 0.8759; val_best_f1_score: 0.8829; train_kl_reg_loss: 90602.2547; train_edge_recon_loss: 2731631.4205; train_gene_expr_recon_loss: 11742763.6212; train_masked_gp_l1_reg_loss: 134376.6929; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75397.2088; train_chrom_access_recon_loss: 2040589.7936; train_global_loss: 16815361.0455; train_optim_loss: 16815361.0455; val_kl_reg_loss: 93389.7178; val_edge_recon_loss: 2760090.3125; val_gene_expr_recon_loss: 11884275.8750; val_masked_gp_l1_reg_loss: 134302.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75259.0312; val_chrom_access_recon_loss: 2052030.9375; val_global_loss: 16999348.0000; val_optim_loss: 16999348.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9393; val_auprc_score: 0.9140; val_best_acc_score: 0.8818; val_best_f1_score: 0.8879; train_kl_reg_loss: 91566.5309; train_edge_recon_loss: 2732889.3485; train_gene_expr_recon_loss: 11715909.0909; train_masked_gp_l1_reg_loss: 134014.7644; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75097.4296; train_chrom_access_recon_loss: 2035694.6345; train_global_loss: 16785171.8636; train_optim_loss: 16785171.8636; val_kl_reg_loss: 88037.0869; val_edge_recon_loss: 2765874.5938; val_gene_expr_recon_loss: 11838720.6250; val_masked_gp_l1_reg_loss: 133852.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75548.2422; val_chrom_access_recon_loss: 2039335.5156; val_global_loss: 16941367.7500; val_optim_loss: 16941367.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9362; val_auprc_score: 0.9093; val_best_acc_score: 0.8778; val_best_f1_score: 0.8852; train_kl_reg_loss: 88782.7874; train_edge_recon_loss: 2734746.6174; train_gene_expr_recon_loss: 11706692.0758; train_masked_gp_l1_reg_loss: 133844.5746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75576.6714; train_chrom_access_recon_loss: 2033447.7273; train_global_loss: 16773090.5000; train_optim_loss: 16773090.5000; val_kl_reg_loss: 90830.5146; val_edge_recon_loss: 2761334.1562; val_gene_expr_recon_loss: 11746379.1250; val_masked_gp_l1_reg_loss: 134037.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76147.6406; val_chrom_access_recon_loss: 2016346.7188; val_global_loss: 16825075.5000; val_optim_loss: 16825075.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9420; val_auprc_score: 0.9195; val_best_acc_score: 0.8855; val_best_f1_score: 0.8892; train_kl_reg_loss: 89266.1416; train_edge_recon_loss: 2723623.2273; train_gene_expr_recon_loss: 11678870.8939; train_masked_gp_l1_reg_loss: 133880.6842; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76597.8556; train_chrom_access_recon_loss: 2028072.9223; train_global_loss: 16730311.7576; train_optim_loss: 16730311.7576; val_kl_reg_loss: 92406.7705; val_edge_recon_loss: 2779147.8438; val_gene_expr_recon_loss: 11795036.1250; val_masked_gp_l1_reg_loss: 134044.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77145.3359; val_chrom_access_recon_loss: 2052546.0469; val_global_loss: 16930326.8750; val_optim_loss: 16930326.8750
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9424; val_auprc_score: 0.9166; val_best_acc_score: 0.8864; val_best_f1_score: 0.8926; train_kl_reg_loss: 88679.3200; train_edge_recon_loss: 2723557.1364; train_gene_expr_recon_loss: 11661065.2576; train_masked_gp_l1_reg_loss: 133625.6906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77486.7552; train_chrom_access_recon_loss: 2024352.2045; train_global_loss: 16708766.3333; train_optim_loss: 16708766.3333; val_kl_reg_loss: 91925.9961; val_edge_recon_loss: 2776710.6562; val_gene_expr_recon_loss: 11744338.5000; val_masked_gp_l1_reg_loss: 133896.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78008.8047; val_chrom_access_recon_loss: 2038359.4062; val_global_loss: 16863239.2500; val_optim_loss: 16863239.2500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9399; val_auprc_score: 0.9156; val_best_acc_score: 0.8882; val_best_f1_score: 0.8935; train_kl_reg_loss: 89217.2102; train_edge_recon_loss: 2726011.0795; train_gene_expr_recon_loss: 11640026.9697; train_masked_gp_l1_reg_loss: 133711.9110; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78234.7341; train_chrom_access_recon_loss: 2020684.2386; train_global_loss: 16687886.3182; train_optim_loss: 16687886.3182; val_kl_reg_loss: 89141.7793; val_edge_recon_loss: 2762588.2188; val_gene_expr_recon_loss: 11670432.2500; val_masked_gp_l1_reg_loss: 133507.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78735.0625; val_chrom_access_recon_loss: 2019794.2031; val_global_loss: 16754199.7500; val_optim_loss: 16754199.7500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9442; val_auprc_score: 0.9172; val_best_acc_score: 0.8920; val_best_f1_score: 0.8980; train_kl_reg_loss: 87722.4680; train_edge_recon_loss: 2717736.8182; train_gene_expr_recon_loss: 11629320.9394; train_masked_gp_l1_reg_loss: 133581.2531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78799.6029; train_chrom_access_recon_loss: 2018493.8125; train_global_loss: 16665654.9545; train_optim_loss: 16665654.9545; val_kl_reg_loss: 89866.0830; val_edge_recon_loss: 2729788.2500; val_gene_expr_recon_loss: 11759486.7500; val_masked_gp_l1_reg_loss: 133739.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78982.5781; val_chrom_access_recon_loss: 2025483.0938; val_global_loss: 16817347.1250; val_optim_loss: 16817347.1250
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9397; val_auprc_score: 0.9152; val_best_acc_score: 0.8880; val_best_f1_score: 0.8941; train_kl_reg_loss: 90317.0819; train_edge_recon_loss: 2724189.1932; train_gene_expr_recon_loss: 11622585.8333; train_masked_gp_l1_reg_loss: 133494.7249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78929.8872; train_chrom_access_recon_loss: 2017400.1061; train_global_loss: 16666916.7121; train_optim_loss: 16666916.7121; val_kl_reg_loss: 91051.9785; val_edge_recon_loss: 2774065.4062; val_gene_expr_recon_loss: 11701398.0000; val_masked_gp_l1_reg_loss: 133211.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78714.0234; val_chrom_access_recon_loss: 2031609.1094; val_global_loss: 16810050.6250; val_optim_loss: 16810050.6250
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9385; val_auprc_score: 0.9080; val_best_acc_score: 0.8837; val_best_f1_score: 0.8915; train_kl_reg_loss: 89495.7872; train_edge_recon_loss: 2719999.1970; train_gene_expr_recon_loss: 11590643.0152; train_masked_gp_l1_reg_loss: 133197.1918; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78802.8496; train_chrom_access_recon_loss: 2011282.2083; train_global_loss: 16623420.1970; train_optim_loss: 16623420.1970; val_kl_reg_loss: 88954.5898; val_edge_recon_loss: 2778483.1875; val_gene_expr_recon_loss: 11825992.7500; val_masked_gp_l1_reg_loss: 133141.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79265.3047; val_chrom_access_recon_loss: 2025827.2031; val_global_loss: 16931664.3750; val_optim_loss: 16931664.3750
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9490; val_auprc_score: 0.9270; val_best_acc_score: 0.8933; val_best_f1_score: 0.8989; train_kl_reg_loss: 89215.5785; train_edge_recon_loss: 2712376.1629; train_gene_expr_recon_loss: 11594520.7727; train_masked_gp_l1_reg_loss: 133035.5916; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78868.9824; train_chrom_access_recon_loss: 2013562.6686; train_global_loss: 16621579.8333; train_optim_loss: 16621579.8333; val_kl_reg_loss: 90994.5107; val_edge_recon_loss: 2744093.3750; val_gene_expr_recon_loss: 11699887.0000; val_masked_gp_l1_reg_loss: 133097.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78969.9531; val_chrom_access_recon_loss: 2012777.4844; val_global_loss: 16759819.5000; val_optim_loss: 16759819.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9467; val_auprc_score: 0.9144; val_best_acc_score: 0.8960; val_best_f1_score: 0.9008; train_kl_reg_loss: 89412.1423; train_edge_recon_loss: 2709033.2462; train_gene_expr_recon_loss: 11570347.1364; train_masked_gp_l1_reg_loss: 128579.5900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62778.9892; train_chrom_access_recon_loss: 2006361.1667; train_global_loss: 16566512.3182; train_optim_loss: 16566512.3182; val_kl_reg_loss: 89838.3291; val_edge_recon_loss: 2736264.7188; val_gene_expr_recon_loss: 11678976.8750; val_masked_gp_l1_reg_loss: 126996.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59066.9727; val_chrom_access_recon_loss: 2023616.8750; val_global_loss: 16714760.7500; val_optim_loss: 16714760.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9533; val_auprc_score: 0.9348; val_best_acc_score: 0.9027; val_best_f1_score: 0.9071; train_kl_reg_loss: 89674.9573; train_edge_recon_loss: 2721392.3068; train_gene_expr_recon_loss: 11574299.5758; train_masked_gp_l1_reg_loss: 126826.0481; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58687.7128; train_chrom_access_recon_loss: 2008122.7898; train_global_loss: 16579003.3788; train_optim_loss: 16579003.3788; val_kl_reg_loss: 91463.9307; val_edge_recon_loss: 2734605.7188; val_gene_expr_recon_loss: 11628646.1250; val_masked_gp_l1_reg_loss: 126707.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58443.7578; val_chrom_access_recon_loss: 2030553.2031; val_global_loss: 16670421.1250; val_optim_loss: 16670421.1250
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9427; val_auprc_score: 0.9211; val_best_acc_score: 0.8890; val_best_f1_score: 0.8943; train_kl_reg_loss: 89799.4976; train_edge_recon_loss: 2716532.1629; train_gene_expr_recon_loss: 11573567.6061; train_masked_gp_l1_reg_loss: 126643.0269; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58342.8704; train_chrom_access_recon_loss: 2005536.7652; train_global_loss: 16570421.9848; train_optim_loss: 16570421.9848; val_kl_reg_loss: 90550.3457; val_edge_recon_loss: 2755840.0312; val_gene_expr_recon_loss: 11667883.0000; val_masked_gp_l1_reg_loss: 126597.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58245.1562; val_chrom_access_recon_loss: 2028430.2344; val_global_loss: 16727545.7500; val_optim_loss: 16727545.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9482; val_auprc_score: 0.9269; val_best_acc_score: 0.8933; val_best_f1_score: 0.9002; train_kl_reg_loss: 90594.3591; train_edge_recon_loss: 2711204.3220; train_gene_expr_recon_loss: 11564159.6818; train_masked_gp_l1_reg_loss: 126589.1683; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58117.0233; train_chrom_access_recon_loss: 2004728.0170; train_global_loss: 16555392.5152; train_optim_loss: 16555392.5152; val_kl_reg_loss: 90875.5498; val_edge_recon_loss: 2748520.3438; val_gene_expr_recon_loss: 11557169.3750; val_masked_gp_l1_reg_loss: 126593.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57986.4414; val_chrom_access_recon_loss: 2011088.9219; val_global_loss: 16592233.0000; val_optim_loss: 16592233.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9448; val_auprc_score: 0.9192; val_best_acc_score: 0.8939; val_best_f1_score: 0.8994; train_kl_reg_loss: 91062.0114; train_edge_recon_loss: 2709209.2159; train_gene_expr_recon_loss: 11559087.9545; train_masked_gp_l1_reg_loss: 126562.0434; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57895.6287; train_chrom_access_recon_loss: 2003237.3636; train_global_loss: 16547054.2273; train_optim_loss: 16547054.2273; val_kl_reg_loss: 92176.3799; val_edge_recon_loss: 2750007.4688; val_gene_expr_recon_loss: 11615355.5000; val_masked_gp_l1_reg_loss: 126544.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57831.1680; val_chrom_access_recon_loss: 2005881.5938; val_global_loss: 16647795.8750; val_optim_loss: 16647795.8750
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9475; val_auprc_score: 0.9200; val_best_acc_score: 0.8917; val_best_f1_score: 0.8971; train_kl_reg_loss: 90474.2236; train_edge_recon_loss: 2720585.8295; train_gene_expr_recon_loss: 11559903.8030; train_masked_gp_l1_reg_loss: 126491.7212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57757.1367; train_chrom_access_recon_loss: 2004039.8939; train_global_loss: 16559252.6515; train_optim_loss: 16559252.6515; val_kl_reg_loss: 90879.1006; val_edge_recon_loss: 2759881.5938; val_gene_expr_recon_loss: 11686307.0000; val_masked_gp_l1_reg_loss: 126496.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57670.9531; val_chrom_access_recon_loss: 2020173.7500; val_global_loss: 16741408.6250; val_optim_loss: 16741408.6250
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9497; val_auprc_score: 0.9249; val_best_acc_score: 0.8974; val_best_f1_score: 0.9021; train_kl_reg_loss: 90520.1251; train_edge_recon_loss: 2708435.3636; train_gene_expr_recon_loss: 11559795.2879; train_masked_gp_l1_reg_loss: 126495.2305; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57647.4435; train_chrom_access_recon_loss: 2003669.1913; train_global_loss: 16546562.6970; train_optim_loss: 16546562.6970; val_kl_reg_loss: 91364.3477; val_edge_recon_loss: 2712384.0938; val_gene_expr_recon_loss: 11693217.2500; val_masked_gp_l1_reg_loss: 126492.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57580.4961; val_chrom_access_recon_loss: 2011114.6875; val_global_loss: 16692153.6250; val_optim_loss: 16692153.6250
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9475; val_auprc_score: 0.9268; val_best_acc_score: 0.8896; val_best_f1_score: 0.8952; train_kl_reg_loss: 91413.4106; train_edge_recon_loss: 2712631.6667; train_gene_expr_recon_loss: 11565430.9091; train_masked_gp_l1_reg_loss: 126471.3719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57545.3039; train_chrom_access_recon_loss: 2005173.1686; train_global_loss: 16558665.8485; train_optim_loss: 16558665.8485; val_kl_reg_loss: 92049.2666; val_edge_recon_loss: 2771561.3438; val_gene_expr_recon_loss: 11671808.0000; val_masked_gp_l1_reg_loss: 126464.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57430.1836; val_chrom_access_recon_loss: 2002722.7656; val_global_loss: 16722035.5000; val_optim_loss: 16722035.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9483; val_auprc_score: 0.9201; val_best_acc_score: 0.8995; val_best_f1_score: 0.9042; train_kl_reg_loss: 91389.5889; train_edge_recon_loss: 2705715.7083; train_gene_expr_recon_loss: 11548239.9697; train_masked_gp_l1_reg_loss: 125972.8488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55875.2118; train_chrom_access_recon_loss: 2000476.7064; train_global_loss: 16527670.1515; train_optim_loss: 16527670.1515; val_kl_reg_loss: 92419.2021; val_edge_recon_loss: 2709183.2188; val_gene_expr_recon_loss: 11701319.2500; val_masked_gp_l1_reg_loss: 125770.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55530.9375; val_chrom_access_recon_loss: 2024698.5000; val_global_loss: 16708922.1250; val_optim_loss: 16708922.1250
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9480; val_auprc_score: 0.9309; val_best_acc_score: 0.8933; val_best_f1_score: 0.8991; train_kl_reg_loss: 91442.5181; train_edge_recon_loss: 2715072.6553; train_gene_expr_recon_loss: 11549119.1515; train_masked_gp_l1_reg_loss: 125726.4804; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55486.5776; train_chrom_access_recon_loss: 2000591.4564; train_global_loss: 16537438.8485; train_optim_loss: 16537438.8485; val_kl_reg_loss: 92979.9229; val_edge_recon_loss: 2728821.5312; val_gene_expr_recon_loss: 11748706.8750; val_masked_gp_l1_reg_loss: 125694.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55451.3789; val_chrom_access_recon_loss: 2034585.6406; val_global_loss: 16786240.1250; val_optim_loss: 16786240.1250
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9435; val_auprc_score: 0.9156; val_best_acc_score: 0.8888; val_best_f1_score: 0.8942; train_kl_reg_loss: 91490.2745; train_edge_recon_loss: 2698754.9242; train_gene_expr_recon_loss: 11565187.7273; train_masked_gp_l1_reg_loss: 125680.0943; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55426.4460; train_chrom_access_recon_loss: 2005404.3333; train_global_loss: 16541943.7273; train_optim_loss: 16541943.7273; val_kl_reg_loss: 93091.3057; val_edge_recon_loss: 2762170.5312; val_gene_expr_recon_loss: 11633857.6250; val_masked_gp_l1_reg_loss: 125669.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55403.9961; val_chrom_access_recon_loss: 2011463.5625; val_global_loss: 16681657.3750; val_optim_loss: 16681657.3750
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9454; val_auprc_score: 0.9182; val_best_acc_score: 0.8939; val_best_f1_score: 0.8995; train_kl_reg_loss: 91591.8060; train_edge_recon_loss: 2702350.4583; train_gene_expr_recon_loss: 11550570.6970; train_masked_gp_l1_reg_loss: 125661.1166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55385.1663; train_chrom_access_recon_loss: 2003322.1080; train_global_loss: 16528881.3485; train_optim_loss: 16528881.3485; val_kl_reg_loss: 92276.8750; val_edge_recon_loss: 2764015.0000; val_gene_expr_recon_loss: 11769886.6250; val_masked_gp_l1_reg_loss: 125652.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55366.3555; val_chrom_access_recon_loss: 2023845.2656; val_global_loss: 16831041.7500; val_optim_loss: 16831041.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 15 min 27 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9530
val AUPRC score: 0.9352
val best accuracy score: 0.9014
val best F1 score: 0.9058
val target rna MSE score: 1.2569
val source rna MSE score: 0.6980
val target atac MSE score: 0.3220
val source atac MSE score: 0.1315
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
