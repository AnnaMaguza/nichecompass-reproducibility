[True]
Run timestamp: 07082024_105225_11.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--no-include_omnipath_gps', '--no-include_nichenet_gps', '--no-include_mebocost_gps', '--include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '0', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--seed', '0', '--timestamp_suffix', '_11']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1072.
Number of gene programs after filtering and combining: 1003.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 895, n_latent: 895, n_addon_latent: 0, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 895, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 895, n_addon_gp_input: 0, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8563; val_auprc_score: 0.9714; val_best_acc_score: 0.8590; val_best_f1_score: 0.9233; train_kl_reg_loss: 120560.7361; train_edge_recon_loss: 1094549.7232; train_gene_expr_recon_loss: 9050097.4295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 10265207.8984; train_optim_loss: 10265207.8984; val_kl_reg_loss: 73228.5595; val_edge_recon_loss: 1182782.8071; val_gene_expr_recon_loss: 7956471.1720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 9212482.5376; val_optim_loss: 9212482.5376
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8451; val_auprc_score: 0.9673; val_best_acc_score: 0.8829; val_best_f1_score: 0.9345; train_kl_reg_loss: 61925.4328; train_edge_recon_loss: 1020196.0732; train_gene_expr_recon_loss: 7607898.2348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8690019.7354; train_optim_loss: 8690019.7354; val_kl_reg_loss: 64800.3209; val_edge_recon_loss: 958868.3125; val_gene_expr_recon_loss: 7297456.4892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 8321125.1129; val_optim_loss: 8321125.1129
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8577; val_auprc_score: 0.9683; val_best_acc_score: 0.8844; val_best_f1_score: 0.9355; train_kl_reg_loss: 61394.1464; train_edge_recon_loss: 935740.0553; train_gene_expr_recon_loss: 7051205.4331; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 8048339.6177; train_optim_loss: 8048339.6177; val_kl_reg_loss: 59593.9147; val_edge_recon_loss: 927016.3246; val_gene_expr_recon_loss: 6820273.0161; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7806883.2742; val_optim_loss: 7806883.2742
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.8878; val_auprc_score: 0.9757; val_best_acc_score: 0.8992; val_best_f1_score: 0.9431; train_kl_reg_loss: 53913.9163; train_edge_recon_loss: 899548.4288; train_gene_expr_recon_loss: 6634419.9307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7587882.2772; train_optim_loss: 7587882.2772; val_kl_reg_loss: 51370.3305; val_edge_recon_loss: 892332.8542; val_gene_expr_recon_loss: 6462433.2903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7406136.4839; val_optim_loss: 7406136.4839
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9045; val_auprc_score: 0.9789; val_best_acc_score: 0.9105; val_best_f1_score: 0.9489; train_kl_reg_loss: 48290.8515; train_edge_recon_loss: 863292.2984; train_gene_expr_recon_loss: 6330808.9200; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 7242392.0651; train_optim_loss: 7242392.0651; val_kl_reg_loss: 45931.9260; val_edge_recon_loss: 873571.7312; val_gene_expr_recon_loss: 6205390.8118; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 7124894.4624; val_optim_loss: 7124894.4624
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9160; val_auprc_score: 0.9818; val_best_acc_score: 0.9175; val_best_f1_score: 0.9532; train_kl_reg_loss: 42789.1573; train_edge_recon_loss: 839896.8933; train_gene_expr_recon_loss: 6112979.4277; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6995665.4815; train_optim_loss: 6995665.4815; val_kl_reg_loss: 39879.0818; val_edge_recon_loss: 828893.4819; val_gene_expr_recon_loss: 6032054.6774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6900827.2473; val_optim_loss: 6900827.2473
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9287; val_auprc_score: 0.9846; val_best_acc_score: 0.9233; val_best_f1_score: 0.9562; train_kl_reg_loss: 37450.6213; train_edge_recon_loss: 828864.5521; train_gene_expr_recon_loss: 5963309.4307; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6829624.6022; train_optim_loss: 6829624.6022; val_kl_reg_loss: 36018.6085; val_edge_recon_loss: 819396.7507; val_gene_expr_recon_loss: 5905855.9194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6761271.2957; val_optim_loss: 6761271.2957
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9392; val_auprc_score: 0.9871; val_best_acc_score: 0.9288; val_best_f1_score: 0.9591; train_kl_reg_loss: 33557.9788; train_edge_recon_loss: 812538.8616; train_gene_expr_recon_loss: 5865826.5974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6711923.4444; train_optim_loss: 6711923.4444; val_kl_reg_loss: 31415.2868; val_edge_recon_loss: 837685.8226; val_gene_expr_recon_loss: 5863869.7796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6732970.8978; val_optim_loss: 6732970.8978
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9441; val_auprc_score: 0.9866; val_best_acc_score: 0.9350; val_best_f1_score: 0.9626; train_kl_reg_loss: 30921.4334; train_edge_recon_loss: 818729.4863; train_gene_expr_recon_loss: 5801789.0818; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6651440.0030; train_optim_loss: 6651440.0030; val_kl_reg_loss: 29892.4927; val_edge_recon_loss: 812133.0860; val_gene_expr_recon_loss: 5773075.2419; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6615100.8387; val_optim_loss: 6615100.8387
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9422; val_auprc_score: 0.9864; val_best_acc_score: 0.9351; val_best_f1_score: 0.9625; train_kl_reg_loss: 28969.4084; train_edge_recon_loss: 802833.2673; train_gene_expr_recon_loss: 5758871.5932; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6590674.2742; train_optim_loss: 6590674.2742; val_kl_reg_loss: 28903.6019; val_edge_recon_loss: 817329.1882; val_gene_expr_recon_loss: 5737885.3172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6584118.1237; val_optim_loss: 6584118.1237
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9524; val_auprc_score: 0.9886; val_best_acc_score: 0.9429; val_best_f1_score: 0.9667; train_kl_reg_loss: 27385.5798; train_edge_recon_loss: 794089.5653; train_gene_expr_recon_loss: 5728925.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6550400.4845; train_optim_loss: 6550400.4845; val_kl_reg_loss: 26249.4167; val_edge_recon_loss: 821742.4019; val_gene_expr_recon_loss: 5709010.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6557002.6882; val_optim_loss: 6557002.6882
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9552; val_auprc_score: 0.9897; val_best_acc_score: 0.9438; val_best_f1_score: 0.9675; train_kl_reg_loss: 26044.4337; train_edge_recon_loss: 796326.3690; train_gene_expr_recon_loss: 5706487.0048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6528857.8088; train_optim_loss: 6528857.8088; val_kl_reg_loss: 26055.5725; val_edge_recon_loss: 796834.7399; val_gene_expr_recon_loss: 5725392.2581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6548282.5753; val_optim_loss: 6548282.5753
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9546; val_auprc_score: 0.9899; val_best_acc_score: 0.9431; val_best_f1_score: 0.9670; train_kl_reg_loss: 24723.9259; train_edge_recon_loss: 802756.9846; train_gene_expr_recon_loss: 5690750.2891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6518231.1971; train_optim_loss: 6518231.1971; val_kl_reg_loss: 23638.0941; val_edge_recon_loss: 805744.3044; val_gene_expr_recon_loss: 5692177.6129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6521560.0108; val_optim_loss: 6521560.0108
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9579; val_auprc_score: 0.9900; val_best_acc_score: 0.9504; val_best_f1_score: 0.9712; train_kl_reg_loss: 23490.3889; train_edge_recon_loss: 799820.7454; train_gene_expr_recon_loss: 5679242.2616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6502553.3949; train_optim_loss: 6502553.3949; val_kl_reg_loss: 24481.8750; val_edge_recon_loss: 789813.4677; val_gene_expr_recon_loss: 5676124.3495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6490419.6989; val_optim_loss: 6490419.6989
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9592; val_auprc_score: 0.9910; val_best_acc_score: 0.9465; val_best_f1_score: 0.9689; train_kl_reg_loss: 22694.4307; train_edge_recon_loss: 786529.5238; train_gene_expr_recon_loss: 5668377.2228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6477601.1720; train_optim_loss: 6477601.1720; val_kl_reg_loss: 22220.8694; val_edge_recon_loss: 810773.6001; val_gene_expr_recon_loss: 5687593.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6520587.8710; val_optim_loss: 6520587.8710
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9586; val_auprc_score: 0.9908; val_best_acc_score: 0.9505; val_best_f1_score: 0.9713; train_kl_reg_loss: 21853.1428; train_edge_recon_loss: 788085.6729; train_gene_expr_recon_loss: 5661544.3435; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6471483.1601; train_optim_loss: 6471483.1601; val_kl_reg_loss: 22860.2672; val_edge_recon_loss: 794563.4173; val_gene_expr_recon_loss: 5674402.1774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6491825.8817; val_optim_loss: 6491825.8817
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9594; val_auprc_score: 0.9903; val_best_acc_score: 0.9532; val_best_f1_score: 0.9728; train_kl_reg_loss: 21166.1900; train_edge_recon_loss: 789733.4291; train_gene_expr_recon_loss: 5654148.5962; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6465048.2121; train_optim_loss: 6465048.2121; val_kl_reg_loss: 20708.7916; val_edge_recon_loss: 800834.0020; val_gene_expr_recon_loss: 5645220.1882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6466762.9839; val_optim_loss: 6466762.9839
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9628; val_auprc_score: 0.9917; val_best_acc_score: 0.9511; val_best_f1_score: 0.9718; train_kl_reg_loss: 20456.9565; train_edge_recon_loss: 786354.0771; train_gene_expr_recon_loss: 5649191.8536; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6456002.8859; train_optim_loss: 6456002.8859; val_kl_reg_loss: 20605.7937; val_edge_recon_loss: 799037.5484; val_gene_expr_recon_loss: 5657341.5753; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6476984.9301; val_optim_loss: 6476984.9301
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9647; val_auprc_score: 0.9920; val_best_acc_score: 0.9530; val_best_f1_score: 0.9727; train_kl_reg_loss: 19825.7548; train_edge_recon_loss: 790465.1953; train_gene_expr_recon_loss: 5645857.4671; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6456148.4140; train_optim_loss: 6456148.4140; val_kl_reg_loss: 19888.2094; val_edge_recon_loss: 795667.4597; val_gene_expr_recon_loss: 5653302.0269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6468857.6935; val_optim_loss: 6468857.6935
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9625; val_auprc_score: 0.9910; val_best_acc_score: 0.9513; val_best_f1_score: 0.9717; train_kl_reg_loss: 19299.4297; train_edge_recon_loss: 781355.4466; train_gene_expr_recon_loss: 5640427.4910; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6441082.3740; train_optim_loss: 6441082.3740; val_kl_reg_loss: 19158.3069; val_edge_recon_loss: 802999.4086; val_gene_expr_recon_loss: 5636944.9086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6459102.5914; val_optim_loss: 6459102.5914
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9658; val_auprc_score: 0.9924; val_best_acc_score: 0.9554; val_best_f1_score: 0.9742; train_kl_reg_loss: 18886.6071; train_edge_recon_loss: 781136.5539; train_gene_expr_recon_loss: 5638168.2873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6438191.4456; train_optim_loss: 6438191.4456; val_kl_reg_loss: 18418.8189; val_edge_recon_loss: 772349.1747; val_gene_expr_recon_loss: 5647352.4032; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6438120.4140; val_optim_loss: 6438120.4140
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9629; val_auprc_score: 0.9909; val_best_acc_score: 0.9529; val_best_f1_score: 0.9725; train_kl_reg_loss: 18341.7394; train_edge_recon_loss: 784165.2615; train_gene_expr_recon_loss: 5635302.7348; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6437809.7354; train_optim_loss: 6437809.7354; val_kl_reg_loss: 17922.3438; val_edge_recon_loss: 805580.3367; val_gene_expr_recon_loss: 5639113.2204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6462615.9032; val_optim_loss: 6462615.9032
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9647; val_auprc_score: 0.9921; val_best_acc_score: 0.9534; val_best_f1_score: 0.9729; train_kl_reg_loss: 17925.6287; train_edge_recon_loss: 776963.9169; train_gene_expr_recon_loss: 5632290.6296; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6427180.1768; train_optim_loss: 6427180.1768; val_kl_reg_loss: 17700.8340; val_edge_recon_loss: 791926.1888; val_gene_expr_recon_loss: 5634361.0430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6443988.1022; val_optim_loss: 6443988.1022
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9627; val_auprc_score: 0.9907; val_best_acc_score: 0.9546; val_best_f1_score: 0.9737; train_kl_reg_loss: 17602.4305; train_edge_recon_loss: 780731.2895; train_gene_expr_recon_loss: 5630331.9636; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6428665.6655; train_optim_loss: 6428665.6655; val_kl_reg_loss: 17142.8993; val_edge_recon_loss: 788380.7083; val_gene_expr_recon_loss: 5635151.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6440675.0269; val_optim_loss: 6440675.0269
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9576; val_auprc_score: 0.9906; val_best_acc_score: 0.9445; val_best_f1_score: 0.9679; train_kl_reg_loss: 17314.4836; train_edge_recon_loss: 778719.1623; train_gene_expr_recon_loss: 5628282.8059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6424316.4438; train_optim_loss: 6424316.4438; val_kl_reg_loss: 19723.1799; val_edge_recon_loss: 823992.2863; val_gene_expr_recon_loss: 5800047.6828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6643763.1505; val_optim_loss: 6643763.1505

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9610; val_auprc_score: 0.9905; val_best_acc_score: 0.9541; val_best_f1_score: 0.9733; train_kl_reg_loss: 17235.4170; train_edge_recon_loss: 779517.8159; train_gene_expr_recon_loss: 5601632.3381; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6398385.5741; train_optim_loss: 6398385.5741; val_kl_reg_loss: 15424.8513; val_edge_recon_loss: 796231.8831; val_gene_expr_recon_loss: 5596799.3710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6408456.1183; val_optim_loss: 6408456.1183
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9658; val_auprc_score: 0.9923; val_best_acc_score: 0.9559; val_best_f1_score: 0.9744; train_kl_reg_loss: 17094.4740; train_edge_recon_loss: 777413.7047; train_gene_expr_recon_loss: 5598114.1714; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6392622.3501; train_optim_loss: 6392622.3501; val_kl_reg_loss: 15459.8313; val_edge_recon_loss: 775526.3145; val_gene_expr_recon_loss: 5597341.2903; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6388327.4247; val_optim_loss: 6388327.4247
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9659; val_auprc_score: 0.9923; val_best_acc_score: 0.9541; val_best_f1_score: 0.9734; train_kl_reg_loss: 17013.5979; train_edge_recon_loss: 782472.6431; train_gene_expr_recon_loss: 5597137.6906; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6396623.9325; train_optim_loss: 6396623.9325; val_kl_reg_loss: 15538.4931; val_edge_recon_loss: 798612.5222; val_gene_expr_recon_loss: 5598752.7581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6412903.8011; val_optim_loss: 6412903.8011
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9645; val_auprc_score: 0.9920; val_best_acc_score: 0.9549; val_best_f1_score: 0.9739; train_kl_reg_loss: 16913.7780; train_edge_recon_loss: 780721.4247; train_gene_expr_recon_loss: 5597109.1535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6394744.3566; train_optim_loss: 6394744.3566; val_kl_reg_loss: 15444.5895; val_edge_recon_loss: 785178.4741; val_gene_expr_recon_loss: 5596959.9839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6397583.0538; val_optim_loss: 6397583.0538
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9640; val_auprc_score: 0.9917; val_best_acc_score: 0.9543; val_best_f1_score: 0.9734; train_kl_reg_loss: 16802.9617; train_edge_recon_loss: 783603.8686; train_gene_expr_recon_loss: 5596141.2282; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6396548.0550; train_optim_loss: 6396548.0550; val_kl_reg_loss: 15488.1558; val_edge_recon_loss: 799240.2164; val_gene_expr_recon_loss: 5597449.7473; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6412178.1183; val_optim_loss: 6412178.1183
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9628; val_auprc_score: 0.9917; val_best_acc_score: 0.9556; val_best_f1_score: 0.9743; train_kl_reg_loss: 16703.8427; train_edge_recon_loss: 779882.9939; train_gene_expr_recon_loss: 5595999.3292; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6392586.1691; train_optim_loss: 6392586.1691; val_kl_reg_loss: 15616.8973; val_edge_recon_loss: 778698.5128; val_gene_expr_recon_loss: 5596727.5538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6391042.9946; val_optim_loss: 6391042.9946

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9666; val_auprc_score: 0.9920; val_best_acc_score: 0.9573; val_best_f1_score: 0.9752; train_kl_reg_loss: 16646.5212; train_edge_recon_loss: 784184.6165; train_gene_expr_recon_loss: 5593877.3172; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6394708.4570; train_optim_loss: 6394708.4570; val_kl_reg_loss: 15487.2207; val_edge_recon_loss: 782433.9745; val_gene_expr_recon_loss: 5593365.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6391286.8495; val_optim_loss: 6391286.8495
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9648; val_auprc_score: 0.9918; val_best_acc_score: 0.9557; val_best_f1_score: 0.9742; train_kl_reg_loss: 16625.1938; train_edge_recon_loss: 784266.4710; train_gene_expr_recon_loss: 5593722.6314; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6394614.2879; train_optim_loss: 6394614.2879; val_kl_reg_loss: 15518.4081; val_edge_recon_loss: 784929.5433; val_gene_expr_recon_loss: 5593095.7688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6393543.7097; val_optim_loss: 6393543.7097
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9634; val_auprc_score: 0.9911; val_best_acc_score: 0.9571; val_best_f1_score: 0.9751; train_kl_reg_loss: 16609.5329; train_edge_recon_loss: 783432.7114; train_gene_expr_recon_loss: 5594139.2664; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6394181.5143; train_optim_loss: 6394181.5143; val_kl_reg_loss: 15491.8311; val_edge_recon_loss: 791281.5087; val_gene_expr_recon_loss: 5593332.3441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6400105.6720; val_optim_loss: 6400105.6720
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9642; val_auprc_score: 0.9916; val_best_acc_score: 0.9562; val_best_f1_score: 0.9746; train_kl_reg_loss: 16581.0786; train_edge_recon_loss: 780265.5598; train_gene_expr_recon_loss: 5593849.9265; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 6390696.5651; train_optim_loss: 6390696.5651; val_kl_reg_loss: 15509.4135; val_edge_recon_loss: 788310.8894; val_gene_expr_recon_loss: 5593090.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 6396911.0269; val_optim_loss: 6396911.0269

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 85 min 49 sec.
Using best model state, which was in epoch 27.
