[True]
Run timestamp: 10102023_055403_162.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_162']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7673; val_auprc_score: 0.7890; val_best_acc_score: 0.5516; val_best_f1_score: 0.6875; train_kl_reg_loss: 58828.2516; train_edge_recon_loss: 737477.2409; train_gene_expr_recon_loss: 22012830.2748; train_masked_gp_l1_reg_loss: 98779.3568; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2351836.2910; train_chrom_access_recon_loss: 956524.0453; train_global_loss: 26216275.4809; train_optim_loss: 26216275.4809; val_kl_reg_loss: 67651.6469; val_edge_recon_loss: 812531.7708; val_gene_expr_recon_loss: 21093262.4000; val_masked_gp_l1_reg_loss: 81121.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 860139.8750; val_chrom_access_recon_loss: 911551.2000; val_global_loss: 23826258.9333; val_optim_loss: 23826258.9333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8673; val_auprc_score: 0.8705; val_best_acc_score: 0.7835; val_best_f1_score: 0.7679; train_kl_reg_loss: 65473.4732; train_edge_recon_loss: 728797.4647; train_gene_expr_recon_loss: 20886436.1985; train_masked_gp_l1_reg_loss: 79660.0140; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 460485.2069; train_chrom_access_recon_loss: 922669.3154; train_global_loss: 23143521.4962; train_optim_loss: 23143521.4962; val_kl_reg_loss: 56846.4388; val_edge_recon_loss: 792434.5792; val_gene_expr_recon_loss: 20699045.2000; val_masked_gp_l1_reg_loss: 81026.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 253911.0156; val_chrom_access_recon_loss: 899997.6500; val_global_loss: 22783262.0000; val_optim_loss: 22783262.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9134; val_auprc_score: 0.9034; val_best_acc_score: 0.8336; val_best_f1_score: 0.8416; train_kl_reg_loss: 59121.0764; train_edge_recon_loss: 693373.9160; train_gene_expr_recon_loss: 20591136.6870; train_masked_gp_l1_reg_loss: 83061.0385; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 194157.0166; train_chrom_access_recon_loss: 912190.8631; train_global_loss: 22533040.6107; train_optim_loss: 22533040.6107; val_kl_reg_loss: 63204.7591; val_edge_recon_loss: 653411.2708; val_gene_expr_recon_loss: 20471621.0667; val_masked_gp_l1_reg_loss: 84463.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 154749.2031; val_chrom_access_recon_loss: 891090.2917; val_global_loss: 22318541.7333; val_optim_loss: 22318541.7333
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9307; val_auprc_score: 0.9171; val_best_acc_score: 0.8588; val_best_f1_score: 0.8624; train_kl_reg_loss: 67425.8070; train_edge_recon_loss: 628376.2009; train_gene_expr_recon_loss: 20350869.7557; train_masked_gp_l1_reg_loss: 85553.9689; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133834.4069; train_chrom_access_recon_loss: 903111.6035; train_global_loss: 22169171.7710; train_optim_loss: 22169171.7710; val_kl_reg_loss: 64743.6013; val_edge_recon_loss: 618719.6500; val_gene_expr_recon_loss: 20236019.6000; val_masked_gp_l1_reg_loss: 87137.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118450.5625; val_chrom_access_recon_loss: 883137.4250; val_global_loss: 22008207.6000; val_optim_loss: 22008207.6000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9312; val_auprc_score: 0.9162; val_best_acc_score: 0.8624; val_best_f1_score: 0.8712; train_kl_reg_loss: 67637.7518; train_edge_recon_loss: 609462.0186; train_gene_expr_recon_loss: 20165616.3511; train_masked_gp_l1_reg_loss: 88288.4965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109697.1859; train_chrom_access_recon_loss: 895627.2085; train_global_loss: 21936328.9313; train_optim_loss: 21936328.9313; val_kl_reg_loss: 66890.2859; val_edge_recon_loss: 607432.6917; val_gene_expr_recon_loss: 20026454.8000; val_masked_gp_l1_reg_loss: 89844.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104718.5547; val_chrom_access_recon_loss: 876338.5583; val_global_loss: 21771678.4000; val_optim_loss: 21771678.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9431; val_auprc_score: 0.9310; val_best_acc_score: 0.8747; val_best_f1_score: 0.8814; train_kl_reg_loss: 66153.5513; train_edge_recon_loss: 603501.8020; train_gene_expr_recon_loss: 19999672.3053; train_masked_gp_l1_reg_loss: 90505.0632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99784.6782; train_chrom_access_recon_loss: 889393.0859; train_global_loss: 21749010.4733; train_optim_loss: 21749010.4733; val_kl_reg_loss: 64765.7112; val_edge_recon_loss: 600550.2417; val_gene_expr_recon_loss: 19916700.6667; val_masked_gp_l1_reg_loss: 91722.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96992.7266; val_chrom_access_recon_loss: 873001.0750; val_global_loss: 21643731.4667; val_optim_loss: 21643731.4667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9392; val_auprc_score: 0.9253; val_best_acc_score: 0.8747; val_best_f1_score: 0.8799; train_kl_reg_loss: 64068.8917; train_edge_recon_loss: 599604.2853; train_gene_expr_recon_loss: 19845813.7863; train_masked_gp_l1_reg_loss: 92154.8473; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93126.5233; train_chrom_access_recon_loss: 881855.4337; train_global_loss: 21576623.8168; train_optim_loss: 21576623.8168; val_kl_reg_loss: 62953.3414; val_edge_recon_loss: 599219.5542; val_gene_expr_recon_loss: 19815063.8667; val_masked_gp_l1_reg_loss: 92639.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90671.9453; val_chrom_access_recon_loss: 864412.8042; val_global_loss: 21524961.0667; val_optim_loss: 21524961.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9437; val_auprc_score: 0.9318; val_best_acc_score: 0.8797; val_best_f1_score: 0.8854; train_kl_reg_loss: 62871.7108; train_edge_recon_loss: 595843.0897; train_gene_expr_recon_loss: 19732884.3206; train_masked_gp_l1_reg_loss: 93294.1698; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88696.8484; train_chrom_access_recon_loss: 877164.2662; train_global_loss: 21450754.4733; train_optim_loss: 21450754.4733; val_kl_reg_loss: 63035.4818; val_edge_recon_loss: 596295.2208; val_gene_expr_recon_loss: 19570998.5333; val_masked_gp_l1_reg_loss: 93926.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86625.1406; val_chrom_access_recon_loss: 857257.9583; val_global_loss: 21268139.2000; val_optim_loss: 21268139.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9521; val_auprc_score: 0.9406; val_best_acc_score: 0.8902; val_best_f1_score: 0.8943; train_kl_reg_loss: 62139.9661; train_edge_recon_loss: 590268.0682; train_gene_expr_recon_loss: 19617518.7634; train_masked_gp_l1_reg_loss: 94392.3759; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85213.6591; train_chrom_access_recon_loss: 872217.5763; train_global_loss: 21321750.4275; train_optim_loss: 21321750.4275; val_kl_reg_loss: 60854.5419; val_edge_recon_loss: 591359.6042; val_gene_expr_recon_loss: 19547230.9333; val_masked_gp_l1_reg_loss: 94909.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83928.4609; val_chrom_access_recon_loss: 854331.7000; val_global_loss: 21232614.5333; val_optim_loss: 21232614.5333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9577; val_auprc_score: 0.9483; val_best_acc_score: 0.8980; val_best_f1_score: 0.9012; train_kl_reg_loss: 60782.6492; train_edge_recon_loss: 590358.7056; train_gene_expr_recon_loss: 19536568.9008; train_masked_gp_l1_reg_loss: 95444.0942; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83076.4122; train_chrom_access_recon_loss: 869290.0177; train_global_loss: 21235520.6870; train_optim_loss: 21235520.6870; val_kl_reg_loss: 58810.7063; val_edge_recon_loss: 591822.7792; val_gene_expr_recon_loss: 19468095.4667; val_masked_gp_l1_reg_loss: 95983.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82882.6562; val_chrom_access_recon_loss: 850046.0708; val_global_loss: 21147640.8000; val_optim_loss: 21147640.8000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9612; val_auprc_score: 0.9537; val_best_acc_score: 0.9031; val_best_f1_score: 0.9060; train_kl_reg_loss: 59870.7221; train_edge_recon_loss: 586703.0792; train_gene_expr_recon_loss: 19436204.9008; train_masked_gp_l1_reg_loss: 96329.1273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81536.3951; train_chrom_access_recon_loss: 863584.9690; train_global_loss: 21124229.0992; train_optim_loss: 21124229.0992; val_kl_reg_loss: 59862.0471; val_edge_recon_loss: 585825.8042; val_gene_expr_recon_loss: 19391039.2000; val_masked_gp_l1_reg_loss: 96830.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81212.4766; val_chrom_access_recon_loss: 847229.2042; val_global_loss: 21061998.0000; val_optim_loss: 21061998.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9556; val_auprc_score: 0.9440; val_best_acc_score: 0.8960; val_best_f1_score: 0.9004; train_kl_reg_loss: 59451.6603; train_edge_recon_loss: 584403.2591; train_gene_expr_recon_loss: 19340376.9008; train_masked_gp_l1_reg_loss: 97107.7626; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80402.3933; train_chrom_access_recon_loss: 859305.8010; train_global_loss: 21021047.7252; train_optim_loss: 21021047.7252; val_kl_reg_loss: 59226.5766; val_edge_recon_loss: 586483.8250; val_gene_expr_recon_loss: 19382732.4000; val_masked_gp_l1_reg_loss: 97715.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80934.1953; val_chrom_access_recon_loss: 847444.2208; val_global_loss: 21054536.9333; val_optim_loss: 21054536.9333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9633; val_auprc_score: 0.9553; val_best_acc_score: 0.9080; val_best_f1_score: 0.9114; train_kl_reg_loss: 58829.6618; train_edge_recon_loss: 583474.4141; train_gene_expr_recon_loss: 19255570.6870; train_masked_gp_l1_reg_loss: 98123.4489; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79813.9096; train_chrom_access_recon_loss: 856227.5887; train_global_loss: 20932039.7405; train_optim_loss: 20932039.7405; val_kl_reg_loss: 57973.9328; val_edge_recon_loss: 585450.5917; val_gene_expr_recon_loss: 19163007.0667; val_masked_gp_l1_reg_loss: 98438.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79152.3750; val_chrom_access_recon_loss: 839761.2125; val_global_loss: 20823783.0667; val_optim_loss: 20823783.0667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9611; val_auprc_score: 0.9481; val_best_acc_score: 0.9101; val_best_f1_score: 0.9140; train_kl_reg_loss: 58253.1782; train_edge_recon_loss: 581626.6894; train_gene_expr_recon_loss: 19184087.9084; train_masked_gp_l1_reg_loss: 99039.8492; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78645.3995; train_chrom_access_recon_loss: 853307.0534; train_global_loss: 20854959.9695; train_optim_loss: 20854959.9695; val_kl_reg_loss: 57658.0357; val_edge_recon_loss: 580001.8667; val_gene_expr_recon_loss: 19157958.1333; val_masked_gp_l1_reg_loss: 99938.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79226.1641; val_chrom_access_recon_loss: 841343.2125; val_global_loss: 20816125.4667; val_optim_loss: 20816125.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9632; val_auprc_score: 0.9534; val_best_acc_score: 0.9119; val_best_f1_score: 0.9153; train_kl_reg_loss: 57440.8122; train_edge_recon_loss: 580321.5138; train_gene_expr_recon_loss: 19131045.9542; train_masked_gp_l1_reg_loss: 100347.5931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77840.9249; train_chrom_access_recon_loss: 850746.2772; train_global_loss: 20797743.0534; train_optim_loss: 20797743.0534; val_kl_reg_loss: 57549.7172; val_edge_recon_loss: 581814.4542; val_gene_expr_recon_loss: 19048887.7333; val_masked_gp_l1_reg_loss: 101143.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78481.1641; val_chrom_access_recon_loss: 833967.4208; val_global_loss: 20701844.9333; val_optim_loss: 20701844.9333
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9632; val_auprc_score: 0.9489; val_best_acc_score: 0.9150; val_best_f1_score: 0.9180; train_kl_reg_loss: 56786.4898; train_edge_recon_loss: 581572.0262; train_gene_expr_recon_loss: 19035490.1985; train_masked_gp_l1_reg_loss: 101841.0448; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76896.8642; train_chrom_access_recon_loss: 847508.8946; train_global_loss: 20700095.4809; train_optim_loss: 20700095.4809; val_kl_reg_loss: 57332.2135; val_edge_recon_loss: 581396.6167; val_gene_expr_recon_loss: 19029599.3333; val_masked_gp_l1_reg_loss: 102406.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76186.9375; val_chrom_access_recon_loss: 827184.0750; val_global_loss: 20674104.0000; val_optim_loss: 20674104.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9626; val_auprc_score: 0.9492; val_best_acc_score: 0.9144; val_best_f1_score: 0.9172; train_kl_reg_loss: 56096.1786; train_edge_recon_loss: 580538.1011; train_gene_expr_recon_loss: 18948993.7557; train_masked_gp_l1_reg_loss: 103428.5072; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76014.0959; train_chrom_access_recon_loss: 844814.1097; train_global_loss: 20609884.7176; train_optim_loss: 20609884.7176; val_kl_reg_loss: 55334.3479; val_edge_recon_loss: 579835.7667; val_gene_expr_recon_loss: 18900535.8667; val_masked_gp_l1_reg_loss: 104718.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75889.9844; val_chrom_access_recon_loss: 827726.2625; val_global_loss: 20544040.1333; val_optim_loss: 20544040.1333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9655; val_auprc_score: 0.9518; val_best_acc_score: 0.9169; val_best_f1_score: 0.9199; train_kl_reg_loss: 55764.6501; train_edge_recon_loss: 578833.6155; train_gene_expr_recon_loss: 18893194.6718; train_masked_gp_l1_reg_loss: 105388.4410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75576.3809; train_chrom_access_recon_loss: 843495.7514; train_global_loss: 20552253.4656; train_optim_loss: 20552253.4656; val_kl_reg_loss: 55915.3805; val_edge_recon_loss: 575588.7292; val_gene_expr_recon_loss: 18930378.0000; val_masked_gp_l1_reg_loss: 106639.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76228.8750; val_chrom_access_recon_loss: 830239.2333; val_global_loss: 20574989.2000; val_optim_loss: 20574989.2000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9629; val_auprc_score: 0.9506; val_best_acc_score: 0.9115; val_best_f1_score: 0.9142; train_kl_reg_loss: 55182.5065; train_edge_recon_loss: 577798.4652; train_gene_expr_recon_loss: 18794729.4351; train_masked_gp_l1_reg_loss: 107675.5023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75495.2832; train_chrom_access_recon_loss: 840468.2214; train_global_loss: 20451349.2824; train_optim_loss: 20451349.2824; val_kl_reg_loss: 53409.1599; val_edge_recon_loss: 579121.9000; val_gene_expr_recon_loss: 18799329.8667; val_masked_gp_l1_reg_loss: 108654.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75356.6875; val_chrom_access_recon_loss: 825022.6542; val_global_loss: 20440893.8667; val_optim_loss: 20440893.8667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9635; val_auprc_score: 0.9498; val_best_acc_score: 0.9144; val_best_f1_score: 0.9170; train_kl_reg_loss: 54943.1816; train_edge_recon_loss: 575563.1703; train_gene_expr_recon_loss: 18733265.7557; train_masked_gp_l1_reg_loss: 109950.4486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75252.1294; train_chrom_access_recon_loss: 839324.3115; train_global_loss: 20388299.0687; train_optim_loss: 20388299.0687; val_kl_reg_loss: 53610.6091; val_edge_recon_loss: 579008.3375; val_gene_expr_recon_loss: 18754699.2000; val_masked_gp_l1_reg_loss: 111402.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76198.8984; val_chrom_access_recon_loss: 824061.1708; val_global_loss: 20398979.6000; val_optim_loss: 20398979.6000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9632; val_auprc_score: 0.9506; val_best_acc_score: 0.9159; val_best_f1_score: 0.9195; train_kl_reg_loss: 54563.4554; train_edge_recon_loss: 576932.1546; train_gene_expr_recon_loss: 18640809.6641; train_masked_gp_l1_reg_loss: 112311.6957; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75758.2834; train_chrom_access_recon_loss: 837569.3578; train_global_loss: 20297944.5038; train_optim_loss: 20297944.5038; val_kl_reg_loss: 54078.4081; val_edge_recon_loss: 580084.6208; val_gene_expr_recon_loss: 18720622.4000; val_masked_gp_l1_reg_loss: 113718.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76893.0234; val_chrom_access_recon_loss: 823015.5000; val_global_loss: 20368412.8000; val_optim_loss: 20368412.8000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9617; val_auprc_score: 0.9510; val_best_acc_score: 0.9116; val_best_f1_score: 0.9160; train_kl_reg_loss: 54326.1670; train_edge_recon_loss: 576560.2433; train_gene_expr_recon_loss: 18564421.2672; train_masked_gp_l1_reg_loss: 114506.4272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76609.8440; train_chrom_access_recon_loss: 836363.6155; train_global_loss: 20222787.5420; train_optim_loss: 20222787.5420; val_kl_reg_loss: 53219.1891; val_edge_recon_loss: 579000.2917; val_gene_expr_recon_loss: 18616627.8667; val_masked_gp_l1_reg_loss: 115665.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76510.0469; val_chrom_access_recon_loss: 823976.9292; val_global_loss: 20265000.4000; val_optim_loss: 20265000.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9665; val_auprc_score: 0.9558; val_best_acc_score: 0.9192; val_best_f1_score: 0.9218; train_kl_reg_loss: 54294.2687; train_edge_recon_loss: 575504.4318; train_gene_expr_recon_loss: 18495474.0305; train_masked_gp_l1_reg_loss: 116466.3333; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76575.5124; train_chrom_access_recon_loss: 834683.2490; train_global_loss: 20152997.9695; train_optim_loss: 20152997.9695; val_kl_reg_loss: 53559.8182; val_edge_recon_loss: 578548.2750; val_gene_expr_recon_loss: 18495846.2667; val_masked_gp_l1_reg_loss: 117159.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76939.7500; val_chrom_access_recon_loss: 817684.6125; val_global_loss: 20139738.8000; val_optim_loss: 20139738.8000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9626; val_auprc_score: 0.9516; val_best_acc_score: 0.9116; val_best_f1_score: 0.9147; train_kl_reg_loss: 54409.1566; train_edge_recon_loss: 575994.2500; train_gene_expr_recon_loss: 18423446.2595; train_masked_gp_l1_reg_loss: 118096.8702; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76809.0669; train_chrom_access_recon_loss: 833896.9843; train_global_loss: 20082652.3969; train_optim_loss: 20082652.3969; val_kl_reg_loss: 55313.1831; val_edge_recon_loss: 582181.4875; val_gene_expr_recon_loss: 18561167.7333; val_masked_gp_l1_reg_loss: 119105.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76923.0156; val_chrom_access_recon_loss: 821551.8250; val_global_loss: 20216244.2667; val_optim_loss: 20216244.2667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9665; val_auprc_score: 0.9577; val_best_acc_score: 0.9150; val_best_f1_score: 0.9178; train_kl_reg_loss: 54707.4056; train_edge_recon_loss: 575280.6073; train_gene_expr_recon_loss: 18358256.0611; train_masked_gp_l1_reg_loss: 119699.9076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76847.8738; train_chrom_access_recon_loss: 832750.7891; train_global_loss: 20017542.6718; train_optim_loss: 20017542.6718; val_kl_reg_loss: 54758.1049; val_edge_recon_loss: 579593.5750; val_gene_expr_recon_loss: 18466861.3333; val_masked_gp_l1_reg_loss: 120336.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77635.1797; val_chrom_access_recon_loss: 819362.0917; val_global_loss: 20118547.2000; val_optim_loss: 20118547.2000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9619; val_auprc_score: 0.9498; val_best_acc_score: 0.9085; val_best_f1_score: 0.9113; train_kl_reg_loss: 53432.1171; train_edge_recon_loss: 608315.2863; train_gene_expr_recon_loss: 17877582.8397; train_masked_gp_l1_reg_loss: 119719.9313; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67860.4180; train_chrom_access_recon_loss: 814519.6322; train_global_loss: 19541430.1832; train_optim_loss: 19541430.1832; val_kl_reg_loss: 37268.8766; val_edge_recon_loss: 596309.5417; val_gene_expr_recon_loss: 17961141.7333; val_masked_gp_l1_reg_loss: 119492.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66474.0156; val_chrom_access_recon_loss: 798312.3042; val_global_loss: 19578998.4000; val_optim_loss: 19578998.4000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9574; val_auprc_score: 0.9424; val_best_acc_score: 0.9045; val_best_f1_score: 0.9091; train_kl_reg_loss: 51893.4892; train_edge_recon_loss: 583228.2977; train_gene_expr_recon_loss: 17774392.7863; train_masked_gp_l1_reg_loss: 119074.3415; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66739.5740; train_chrom_access_recon_loss: 809463.2128; train_global_loss: 19404791.7405; train_optim_loss: 19404791.7405; val_kl_reg_loss: 42254.3888; val_edge_recon_loss: 589098.2083; val_gene_expr_recon_loss: 17970973.1333; val_masked_gp_l1_reg_loss: 118550.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66694.4922; val_chrom_access_recon_loss: 802943.7625; val_global_loss: 19590513.4667; val_optim_loss: 19590513.4667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9544; val_auprc_score: 0.9395; val_best_acc_score: 0.9002; val_best_f1_score: 0.9058; train_kl_reg_loss: 51155.0746; train_edge_recon_loss: 580095.1255; train_gene_expr_recon_loss: 17709476.9313; train_masked_gp_l1_reg_loss: 118252.7002; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66865.0477; train_chrom_access_recon_loss: 808362.5100; train_global_loss: 19334207.3435; train_optim_loss: 19334207.3435; val_kl_reg_loss: 44750.9365; val_edge_recon_loss: 581681.5458; val_gene_expr_recon_loss: 17771936.2667; val_masked_gp_l1_reg_loss: 117863.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66880.1094; val_chrom_access_recon_loss: 791672.8625; val_global_loss: 19374785.7333; val_optim_loss: 19374785.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9583; val_auprc_score: 0.9443; val_best_acc_score: 0.9085; val_best_f1_score: 0.9120; train_kl_reg_loss: 50832.2896; train_edge_recon_loss: 577666.7128; train_gene_expr_recon_loss: 17665087.6565; train_masked_gp_l1_reg_loss: 117622.2787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67039.5799; train_chrom_access_recon_loss: 807439.0310; train_global_loss: 19285687.5878; train_optim_loss: 19285687.5878; val_kl_reg_loss: 45636.1953; val_edge_recon_loss: 582159.8917; val_gene_expr_recon_loss: 17679774.1333; val_masked_gp_l1_reg_loss: 117096.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67145.2891; val_chrom_access_recon_loss: 789371.9958; val_global_loss: 19281184.5333; val_optim_loss: 19281184.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9588; val_auprc_score: 0.9444; val_best_acc_score: 0.9068; val_best_f1_score: 0.9103; train_kl_reg_loss: 50803.2930; train_edge_recon_loss: 575993.6460; train_gene_expr_recon_loss: 17628806.4046; train_masked_gp_l1_reg_loss: 116946.8784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67086.3103; train_chrom_access_recon_loss: 807547.0534; train_global_loss: 19247183.6183; train_optim_loss: 19247183.6183; val_kl_reg_loss: 46335.9156; val_edge_recon_loss: 580177.5375; val_gene_expr_recon_loss: 17740941.4667; val_masked_gp_l1_reg_loss: 116580.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66591.6016; val_chrom_access_recon_loss: 795939.2125; val_global_loss: 19346566.1333; val_optim_loss: 19346566.1333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9644; val_auprc_score: 0.9511; val_best_acc_score: 0.9167; val_best_f1_score: 0.9191; train_kl_reg_loss: 51149.6778; train_edge_recon_loss: 575700.9800; train_gene_expr_recon_loss: 17562425.7099; train_masked_gp_l1_reg_loss: 116252.2952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66966.8545; train_chrom_access_recon_loss: 805931.7519; train_global_loss: 19178427.1450; train_optim_loss: 19178427.1450; val_kl_reg_loss: 46726.4646; val_edge_recon_loss: 577925.7542; val_gene_expr_recon_loss: 17688765.2667; val_masked_gp_l1_reg_loss: 115846.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66535.3125; val_chrom_access_recon_loss: 789180.6875; val_global_loss: 19284980.1333; val_optim_loss: 19284980.1333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9613; val_auprc_score: 0.9480; val_best_acc_score: 0.9124; val_best_f1_score: 0.9164; train_kl_reg_loss: 51495.8896; train_edge_recon_loss: 576646.7505; train_gene_expr_recon_loss: 17514771.4962; train_masked_gp_l1_reg_loss: 115549.1067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66977.7391; train_chrom_access_recon_loss: 804803.6617; train_global_loss: 19130244.5802; train_optim_loss: 19130244.5802; val_kl_reg_loss: 46601.2794; val_edge_recon_loss: 580809.0500; val_gene_expr_recon_loss: 17612317.2667; val_masked_gp_l1_reg_loss: 115179.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67337.8906; val_chrom_access_recon_loss: 788532.9083; val_global_loss: 19210778.8000; val_optim_loss: 19210778.8000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9576; val_auprc_score: 0.9445; val_best_acc_score: 0.9074; val_best_f1_score: 0.9108; train_kl_reg_loss: 51433.9219; train_edge_recon_loss: 575039.6584; train_gene_expr_recon_loss: 17495268.7557; train_masked_gp_l1_reg_loss: 115040.5227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67288.3100; train_chrom_access_recon_loss: 804746.1093; train_global_loss: 19108817.2366; train_optim_loss: 19108817.2366; val_kl_reg_loss: 47891.8154; val_edge_recon_loss: 583196.1250; val_gene_expr_recon_loss: 17581755.0667; val_masked_gp_l1_reg_loss: 114817.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67139.2891; val_chrom_access_recon_loss: 790453.4417; val_global_loss: 19185254.8000; val_optim_loss: 19185254.8000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9615; val_auprc_score: 0.9468; val_best_acc_score: 0.9103; val_best_f1_score: 0.9138; train_kl_reg_loss: 51610.5680; train_edge_recon_loss: 575943.8760; train_gene_expr_recon_loss: 17463446.8397; train_masked_gp_l1_reg_loss: 114466.9107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67144.5369; train_chrom_access_recon_loss: 803906.3521; train_global_loss: 19076519.0840; train_optim_loss: 19076519.0840; val_kl_reg_loss: 48660.4378; val_edge_recon_loss: 577020.9500; val_gene_expr_recon_loss: 17600944.2667; val_masked_gp_l1_reg_loss: 114109.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67069.6094; val_chrom_access_recon_loss: 790096.0083; val_global_loss: 19197901.4667; val_optim_loss: 19197901.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9626; val_auprc_score: 0.9491; val_best_acc_score: 0.9143; val_best_f1_score: 0.9175; train_kl_reg_loss: 51890.6125; train_edge_recon_loss: 574811.5644; train_gene_expr_recon_loss: 17405185.9847; train_masked_gp_l1_reg_loss: 113853.1817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67172.8285; train_chrom_access_recon_loss: 802692.7901; train_global_loss: 19015606.8702; train_optim_loss: 19015606.8702; val_kl_reg_loss: 48987.3456; val_edge_recon_loss: 579038.4542; val_gene_expr_recon_loss: 17584518.4000; val_masked_gp_l1_reg_loss: 113321.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67133.2891; val_chrom_access_recon_loss: 791870.2250; val_global_loss: 19184870.4000; val_optim_loss: 19184870.4000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9628; val_auprc_score: 0.9468; val_best_acc_score: 0.9162; val_best_f1_score: 0.9193; train_kl_reg_loss: 51912.5841; train_edge_recon_loss: 575473.3096; train_gene_expr_recon_loss: 17380165.2290; train_masked_gp_l1_reg_loss: 113190.5272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67210.0596; train_chrom_access_recon_loss: 803045.6164; train_global_loss: 18990997.3282; train_optim_loss: 18990997.3282; val_kl_reg_loss: 48248.9885; val_edge_recon_loss: 577737.2167; val_gene_expr_recon_loss: 17562429.3333; val_masked_gp_l1_reg_loss: 113101.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67604.0234; val_chrom_access_recon_loss: 788586.6167; val_global_loss: 19157708.2667; val_optim_loss: 19157708.2667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9644; val_auprc_score: 0.9535; val_best_acc_score: 0.9100; val_best_f1_score: 0.9137; train_kl_reg_loss: 51918.7355; train_edge_recon_loss: 575374.3187; train_gene_expr_recon_loss: 17346520.0611; train_masked_gp_l1_reg_loss: 113074.3827; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67545.2514; train_chrom_access_recon_loss: 802018.5396; train_global_loss: 18956451.2977; train_optim_loss: 18956451.2977; val_kl_reg_loss: 50176.8992; val_edge_recon_loss: 578805.8375; val_gene_expr_recon_loss: 17476401.6000; val_masked_gp_l1_reg_loss: 112878.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67237.5391; val_chrom_access_recon_loss: 786043.7833; val_global_loss: 19071544.2667; val_optim_loss: 19071544.2667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9641; val_auprc_score: 0.9510; val_best_acc_score: 0.9150; val_best_f1_score: 0.9182; train_kl_reg_loss: 52916.9059; train_edge_recon_loss: 574872.8903; train_gene_expr_recon_loss: 17349953.4046; train_masked_gp_l1_reg_loss: 112576.7867; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67391.7235; train_chrom_access_recon_loss: 801865.8177; train_global_loss: 18959577.5115; train_optim_loss: 18959577.5115; val_kl_reg_loss: 51416.3562; val_edge_recon_loss: 577154.7458; val_gene_expr_recon_loss: 17423718.6667; val_masked_gp_l1_reg_loss: 111970.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67369.2500; val_chrom_access_recon_loss: 784900.1958; val_global_loss: 19016530.0000; val_optim_loss: 19016530.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9029; val_auprc_score: 0.8982; val_best_acc_score: 0.8201; val_best_f1_score: 0.8317; train_kl_reg_loss: 54873.8069; train_edge_recon_loss: 585831.2481; train_gene_expr_recon_loss: 17717923.9084; train_masked_gp_l1_reg_loss: 112375.7797; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67544.9634; train_chrom_access_recon_loss: 803037.0444; train_global_loss: 19341586.8397; train_optim_loss: 19341586.8397; val_kl_reg_loss: 53936.0805; val_edge_recon_loss: 718880.7333; val_gene_expr_recon_loss: 19359499.4667; val_masked_gp_l1_reg_loss: 118039.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71167.2422; val_chrom_access_recon_loss: 804952.0125; val_global_loss: 21126476.4000; val_optim_loss: 21126476.4000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8945; val_auprc_score: 0.8964; val_best_acc_score: 0.8057; val_best_f1_score: 0.8140; train_kl_reg_loss: 350381.4241; train_edge_recon_loss: 760704.2624; train_gene_expr_recon_loss: 20739177.4656; train_masked_gp_l1_reg_loss: 105480.1478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85022.3489; train_chrom_access_recon_loss: 831742.1555; train_global_loss: 22872507.8626; train_optim_loss: 22872507.8626; val_kl_reg_loss: 82060.1146; val_edge_recon_loss: 766242.9042; val_gene_expr_recon_loss: 17902807.7333; val_masked_gp_l1_reg_loss: 90413.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75954.5547; val_chrom_access_recon_loss: 769954.0542; val_global_loss: 19687432.6667; val_optim_loss: 19687432.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9124; val_auprc_score: 0.9100; val_best_acc_score: 0.8270; val_best_f1_score: 0.8354; train_kl_reg_loss: 177386.2029; train_edge_recon_loss: 748912.9323; train_gene_expr_recon_loss: 18153484.5191; train_masked_gp_l1_reg_loss: 84996.3723; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72314.1325; train_chrom_access_recon_loss: 783632.5864; train_global_loss: 20020726.7023; train_optim_loss: 20020726.7023; val_kl_reg_loss: 88680.2380; val_edge_recon_loss: 753826.7000; val_gene_expr_recon_loss: 17637653.6000; val_masked_gp_l1_reg_loss: 81430.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73227.1016; val_chrom_access_recon_loss: 763799.4083; val_global_loss: 19398618.0000; val_optim_loss: 19398618.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9206; val_auprc_score: 0.9101; val_best_acc_score: 0.8448; val_best_f1_score: 0.8518; train_kl_reg_loss: 94995.9866; train_edge_recon_loss: 728756.8278; train_gene_expr_recon_loss: 17684025.3588; train_masked_gp_l1_reg_loss: 79483.1577; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71416.4602; train_chrom_access_recon_loss: 777499.9895; train_global_loss: 19436177.9084; train_optim_loss: 19436177.9084; val_kl_reg_loss: 55164.8862; val_edge_recon_loss: 697922.7958; val_gene_expr_recon_loss: 17489760.2667; val_masked_gp_l1_reg_loss: 78755.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69794.7344; val_chrom_access_recon_loss: 760270.0375; val_global_loss: 19151667.8667; val_optim_loss: 19151667.8667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9274; val_auprc_score: 0.9187; val_best_acc_score: 0.8498; val_best_f1_score: 0.8554; train_kl_reg_loss: 61003.3543; train_edge_recon_loss: 686512.0592; train_gene_expr_recon_loss: 17516747.8931; train_masked_gp_l1_reg_loss: 77124.6746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59646.4504; train_chrom_access_recon_loss: 774963.8540; train_global_loss: 19175998.3511; train_optim_loss: 19175998.3511; val_kl_reg_loss: 47982.2234; val_edge_recon_loss: 684510.2417; val_gene_expr_recon_loss: 17382236.4000; val_masked_gp_l1_reg_loss: 76740.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57346.9648; val_chrom_access_recon_loss: 756072.1833; val_global_loss: 19004886.9333; val_optim_loss: 19004886.9333
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9237; val_auprc_score: 0.9153; val_best_acc_score: 0.8422; val_best_f1_score: 0.8510; train_kl_reg_loss: 56692.6903; train_edge_recon_loss: 674605.5677; train_gene_expr_recon_loss: 17450844.4275; train_masked_gp_l1_reg_loss: 76742.9624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56629.4146; train_chrom_access_recon_loss: 774043.9580; train_global_loss: 19089558.9618; train_optim_loss: 19089558.9618; val_kl_reg_loss: 45722.0305; val_edge_recon_loss: 674591.0375; val_gene_expr_recon_loss: 17452065.4000; val_masked_gp_l1_reg_loss: 76766.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56003.8281; val_chrom_access_recon_loss: 763593.4917; val_global_loss: 19068742.1333; val_optim_loss: 19068742.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9231; val_auprc_score: 0.9133; val_best_acc_score: 0.8420; val_best_f1_score: 0.8534; train_kl_reg_loss: 54355.0565; train_edge_recon_loss: 666971.1240; train_gene_expr_recon_loss: 17439331.9542; train_masked_gp_l1_reg_loss: 76812.2487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55590.1418; train_chrom_access_recon_loss: 773741.5344; train_global_loss: 19066802.1221; train_optim_loss: 19066802.1221; val_kl_reg_loss: 43646.8737; val_edge_recon_loss: 668036.4292; val_gene_expr_recon_loss: 17451548.8667; val_masked_gp_l1_reg_loss: 76910.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55190.4414; val_chrom_access_recon_loss: 760626.0292; val_global_loss: 19055958.4000; val_optim_loss: 19055958.4000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9212; val_auprc_score: 0.9132; val_best_acc_score: 0.8382; val_best_f1_score: 0.8470; train_kl_reg_loss: 52656.6892; train_edge_recon_loss: 658932.0606; train_gene_expr_recon_loss: 17431042.3740; train_masked_gp_l1_reg_loss: 76941.9754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54841.8771; train_chrom_access_recon_loss: 774556.0883; train_global_loss: 19048970.9924; train_optim_loss: 19048970.9924; val_kl_reg_loss: 41719.1104; val_edge_recon_loss: 661021.8500; val_gene_expr_recon_loss: 17444980.2000; val_masked_gp_l1_reg_loss: 77030.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54513.8398; val_chrom_access_recon_loss: 763027.2542; val_global_loss: 19042292.2667; val_optim_loss: 19042292.2667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9260; val_auprc_score: 0.9151; val_best_acc_score: 0.8498; val_best_f1_score: 0.8593; train_kl_reg_loss: 53877.3909; train_edge_recon_loss: 656525.6975; train_gene_expr_recon_loss: 17456878.2137; train_masked_gp_l1_reg_loss: 77006.1234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54207.0321; train_chrom_access_recon_loss: 774541.3378; train_global_loss: 19073036.1069; train_optim_loss: 19073036.1069; val_kl_reg_loss: 43526.4172; val_edge_recon_loss: 656297.3375; val_gene_expr_recon_loss: 17431752.5333; val_masked_gp_l1_reg_loss: 77004.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53923.8555; val_chrom_access_recon_loss: 761269.3208; val_global_loss: 19023773.7333; val_optim_loss: 19023773.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9263; val_auprc_score: 0.9157; val_best_acc_score: 0.8464; val_best_f1_score: 0.8557; train_kl_reg_loss: 53264.4419; train_edge_recon_loss: 653457.8507; train_gene_expr_recon_loss: 17426300.3282; train_masked_gp_l1_reg_loss: 76835.3435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52955.7346; train_chrom_access_recon_loss: 774895.1240; train_global_loss: 19037708.8550; train_optim_loss: 19037708.8550; val_kl_reg_loss: 42746.6786; val_edge_recon_loss: 657865.3917; val_gene_expr_recon_loss: 17384782.9333; val_masked_gp_l1_reg_loss: 76787.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52736.5547; val_chrom_access_recon_loss: 757922.7667; val_global_loss: 18972842.1333; val_optim_loss: 18972842.1333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9282; val_auprc_score: 0.9143; val_best_acc_score: 0.8519; val_best_f1_score: 0.8602; train_kl_reg_loss: 53061.3761; train_edge_recon_loss: 652300.4490; train_gene_expr_recon_loss: 17424982.4809; train_masked_gp_l1_reg_loss: 76771.9808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52655.3338; train_chrom_access_recon_loss: 773741.3139; train_global_loss: 19033513.0992; train_optim_loss: 19033513.0992; val_kl_reg_loss: 42403.9753; val_edge_recon_loss: 650494.0833; val_gene_expr_recon_loss: 17363584.6000; val_masked_gp_l1_reg_loss: 76754.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52576.0898; val_chrom_access_recon_loss: 757965.2583; val_global_loss: 18943777.8667; val_optim_loss: 18943777.8667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9268; val_auprc_score: 0.9175; val_best_acc_score: 0.8480; val_best_f1_score: 0.8582; train_kl_reg_loss: 52923.7355; train_edge_recon_loss: 652897.9375; train_gene_expr_recon_loss: 17429060.6412; train_masked_gp_l1_reg_loss: 76748.2646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52524.9243; train_chrom_access_recon_loss: 774749.2815; train_global_loss: 19038904.9160; train_optim_loss: 19038904.9160; val_kl_reg_loss: 42913.8023; val_edge_recon_loss: 654649.9167; val_gene_expr_recon_loss: 17417602.8000; val_masked_gp_l1_reg_loss: 76742.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52473.4844; val_chrom_access_recon_loss: 762372.0083; val_global_loss: 19006754.4000; val_optim_loss: 19006754.4000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9202; val_auprc_score: 0.9091; val_best_acc_score: 0.8459; val_best_f1_score: 0.8523; train_kl_reg_loss: 52744.1554; train_edge_recon_loss: 652680.4733; train_gene_expr_recon_loss: 17415996.1298; train_masked_gp_l1_reg_loss: 76739.3661; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52425.8256; train_chrom_access_recon_loss: 773552.6174; train_global_loss: 19024138.7176; train_optim_loss: 19024138.7176; val_kl_reg_loss: 42519.8120; val_edge_recon_loss: 656890.9375; val_gene_expr_recon_loss: 17402203.2667; val_masked_gp_l1_reg_loss: 76735.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52378.3672; val_chrom_access_recon_loss: 759429.9125; val_global_loss: 18990157.7333; val_optim_loss: 18990157.7333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9270; val_auprc_score: 0.9140; val_best_acc_score: 0.8487; val_best_f1_score: 0.8572; train_kl_reg_loss: 52572.1318; train_edge_recon_loss: 653011.1617; train_gene_expr_recon_loss: 17426808.7710; train_masked_gp_l1_reg_loss: 76733.7311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52344.2305; train_chrom_access_recon_loss: 774362.5735; train_global_loss: 19035832.4885; train_optim_loss: 19035832.4885; val_kl_reg_loss: 42269.4971; val_edge_recon_loss: 650887.6250; val_gene_expr_recon_loss: 17408178.2000; val_masked_gp_l1_reg_loss: 76733.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52299.8945; val_chrom_access_recon_loss: 758630.2708; val_global_loss: 18988999.6000; val_optim_loss: 18988999.6000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9235; val_auprc_score: 0.9118; val_best_acc_score: 0.8459; val_best_f1_score: 0.8506; train_kl_reg_loss: 52298.1152; train_edge_recon_loss: 651236.9475; train_gene_expr_recon_loss: 17395064.7481; train_masked_gp_l1_reg_loss: 76729.8418; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52260.0304; train_chrom_access_recon_loss: 772506.5525; train_global_loss: 19000096.2901; train_optim_loss: 19000096.2901; val_kl_reg_loss: 42368.0367; val_edge_recon_loss: 653417.2750; val_gene_expr_recon_loss: 17404791.6000; val_masked_gp_l1_reg_loss: 76725.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52221.8945; val_chrom_access_recon_loss: 759944.2875; val_global_loss: 18989469.3333; val_optim_loss: 18989469.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9249; val_auprc_score: 0.9142; val_best_acc_score: 0.8475; val_best_f1_score: 0.8565; train_kl_reg_loss: 52336.5157; train_edge_recon_loss: 650416.6799; train_gene_expr_recon_loss: 17404399.6260; train_masked_gp_l1_reg_loss: 76707.9949; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52123.9046; train_chrom_access_recon_loss: 774088.7071; train_global_loss: 19010073.5878; train_optim_loss: 19010073.5878; val_kl_reg_loss: 42158.8336; val_edge_recon_loss: 652550.4875; val_gene_expr_recon_loss: 17446267.2000; val_masked_gp_l1_reg_loss: 76702.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52102.7656; val_chrom_access_recon_loss: 762002.5292; val_global_loss: 19031783.3333; val_optim_loss: 19031783.3333
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9205; val_auprc_score: 0.9096; val_best_acc_score: 0.8421; val_best_f1_score: 0.8508; train_kl_reg_loss: 52363.9744; train_edge_recon_loss: 649655.1293; train_gene_expr_recon_loss: 17426837.7023; train_masked_gp_l1_reg_loss: 76700.7840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52093.9677; train_chrom_access_recon_loss: 774187.0105; train_global_loss: 19031838.7023; train_optim_loss: 19031838.7023; val_kl_reg_loss: 42022.0622; val_edge_recon_loss: 655440.8500; val_gene_expr_recon_loss: 17406278.0667; val_masked_gp_l1_reg_loss: 76698.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52086.0156; val_chrom_access_recon_loss: 762383.3167; val_global_loss: 18994908.5333; val_optim_loss: 18994908.5333
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9195; val_auprc_score: 0.9082; val_best_acc_score: 0.8374; val_best_f1_score: 0.8489; train_kl_reg_loss: 52390.6263; train_edge_recon_loss: 649887.9585; train_gene_expr_recon_loss: 17420413.6412; train_masked_gp_l1_reg_loss: 76697.3173; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52080.2910; train_chrom_access_recon_loss: 774649.0806; train_global_loss: 19026118.6412; train_optim_loss: 19026118.6412; val_kl_reg_loss: 41987.3492; val_edge_recon_loss: 655231.6292; val_gene_expr_recon_loss: 17402029.4000; val_masked_gp_l1_reg_loss: 76696.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52073.1016; val_chrom_access_recon_loss: 760975.5292; val_global_loss: 18988994.4000; val_optim_loss: 18988994.4000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9285; val_auprc_score: 0.9182; val_best_acc_score: 0.8526; val_best_f1_score: 0.8588; train_kl_reg_loss: 52288.1581; train_edge_recon_loss: 650680.9971; train_gene_expr_recon_loss: 17413527.9008; train_masked_gp_l1_reg_loss: 76695.1471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52067.7537; train_chrom_access_recon_loss: 774252.0778; train_global_loss: 19019512.1527; train_optim_loss: 19019512.1527; val_kl_reg_loss: 41967.6857; val_edge_recon_loss: 649675.1333; val_gene_expr_recon_loss: 17362835.0667; val_masked_gp_l1_reg_loss: 76693.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52062.5117; val_chrom_access_recon_loss: 761681.9958; val_global_loss: 18944916.0000; val_optim_loss: 18944916.0000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 38 min 49 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9248
val AUPRC score: 0.9140
val best accuracy score: 0.8457
val best F1 score: 0.8548
val target rna MSE score: 1.5063
val source rna MSE score: 0.7304
val target atac MSE score: 0.4720
val source atac MSE score: 0.1559
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
