[True]
Run timestamp: 10102023_043400_144.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_144']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6604; val_auprc_score: 0.6340; val_best_acc_score: 0.5298; val_best_f1_score: 0.6789; train_kl_reg_loss: 65978.4005; train_edge_recon_loss: 3523091.2386; train_gene_expr_recon_loss: 13983281.0455; train_masked_gp_l1_reg_loss: 124829.9981; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 4443715.4394; train_chrom_access_recon_loss: 11533862.3333; train_global_loss: 33674758.5455; train_optim_loss: 33674758.5455; val_kl_reg_loss: 93630.0381; val_edge_recon_loss: 4063776.5312; val_gene_expr_recon_loss: 12899125.1250; val_masked_gp_l1_reg_loss: 98193.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1956043.0000; val_chrom_access_recon_loss: 11090609.1250; val_global_loss: 30201377.5000; val_optim_loss: 30201377.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6599; val_auprc_score: 0.6405; val_best_acc_score: 0.5903; val_best_f1_score: 0.6940; train_kl_reg_loss: 111766.1817; train_edge_recon_loss: 3531259.2727; train_gene_expr_recon_loss: 12826637.1212; train_masked_gp_l1_reg_loss: 95234.5754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 869232.0218; train_chrom_access_recon_loss: 10950902.7273; train_global_loss: 28385031.7576; train_optim_loss: 28385031.7576; val_kl_reg_loss: 102575.1191; val_edge_recon_loss: 4059819.6562; val_gene_expr_recon_loss: 12678993.3750; val_masked_gp_l1_reg_loss: 95063.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 347389.7812; val_chrom_access_recon_loss: 11054339.7500; val_global_loss: 28338181.5000; val_optim_loss: 28338181.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7336; val_auprc_score: 0.7102; val_best_acc_score: 0.6717; val_best_f1_score: 0.7045; train_kl_reg_loss: 102396.7064; train_edge_recon_loss: 3524091.7917; train_gene_expr_recon_loss: 12680162.1212; train_masked_gp_l1_reg_loss: 95501.6098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 245431.8338; train_chrom_access_recon_loss: 10874933.5152; train_global_loss: 27522517.4848; train_optim_loss: 27522517.4848; val_kl_reg_loss: 89587.6758; val_edge_recon_loss: 4043288.1562; val_gene_expr_recon_loss: 12620343.3750; val_masked_gp_l1_reg_loss: 96581.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 185682.6094; val_chrom_access_recon_loss: 10919113.1250; val_global_loss: 27954595.7500; val_optim_loss: 27954595.7500
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8143; val_auprc_score: 0.7847; val_best_acc_score: 0.7429; val_best_f1_score: 0.7639; train_kl_reg_loss: 89192.8781; train_edge_recon_loss: 3505160.3561; train_gene_expr_recon_loss: 12601366.3939; train_masked_gp_l1_reg_loss: 98048.9891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 159628.1709; train_chrom_access_recon_loss: 10798388.6515; train_global_loss: 27251785.5152; train_optim_loss: 27251785.5152; val_kl_reg_loss: 77693.0859; val_edge_recon_loss: 3848073.1875; val_gene_expr_recon_loss: 12602025.5000; val_masked_gp_l1_reg_loss: 100016.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 140621.4219; val_chrom_access_recon_loss: 10888105.2500; val_global_loss: 27656534.7500; val_optim_loss: 27656534.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8440; val_auprc_score: 0.8210; val_best_acc_score: 0.7547; val_best_f1_score: 0.7852; train_kl_reg_loss: 79179.3432; train_edge_recon_loss: 3276781.8144; train_gene_expr_recon_loss: 12543786.4242; train_masked_gp_l1_reg_loss: 105017.2085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129512.9065; train_chrom_access_recon_loss: 10735647.5758; train_global_loss: 26869925.4242; train_optim_loss: 26869925.4242; val_kl_reg_loss: 107875.8701; val_edge_recon_loss: 3018585.1250; val_gene_expr_recon_loss: 12471891.2500; val_masked_gp_l1_reg_loss: 111074.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120823.0859; val_chrom_access_recon_loss: 10833639.0000; val_global_loss: 26663888.5000; val_optim_loss: 26663888.5000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8481; val_auprc_score: 0.8138; val_best_acc_score: 0.7641; val_best_f1_score: 0.7880; train_kl_reg_loss: 109680.2930; train_edge_recon_loss: 2985330.2045; train_gene_expr_recon_loss: 12460829.0000; train_masked_gp_l1_reg_loss: 112439.8046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114347.7353; train_chrom_access_recon_loss: 10677782.8182; train_global_loss: 26460409.8182; train_optim_loss: 26460409.8182; val_kl_reg_loss: 114430.5908; val_edge_recon_loss: 2992534.1875; val_gene_expr_recon_loss: 12327347.8750; val_masked_gp_l1_reg_loss: 113796.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109518.1562; val_chrom_access_recon_loss: 10773392.0000; val_global_loss: 26431019.5000; val_optim_loss: 26431019.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8725; val_auprc_score: 0.8407; val_best_acc_score: 0.7950; val_best_f1_score: 0.8122; train_kl_reg_loss: 109525.7045; train_edge_recon_loss: 2937047.1402; train_gene_expr_recon_loss: 12388975.8333; train_masked_gp_l1_reg_loss: 114690.8697; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105092.9580; train_chrom_access_recon_loss: 10615267.8030; train_global_loss: 26270600.3636; train_optim_loss: 26270600.3636; val_kl_reg_loss: 109962.2080; val_edge_recon_loss: 2901185.4062; val_gene_expr_recon_loss: 12431545.7500; val_masked_gp_l1_reg_loss: 115796.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101759.5703; val_chrom_access_recon_loss: 10820166.3750; val_global_loss: 26480416.2500; val_optim_loss: 26480416.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8722; val_auprc_score: 0.8303; val_best_acc_score: 0.8082; val_best_f1_score: 0.8251; train_kl_reg_loss: 107900.5210; train_edge_recon_loss: 2903962.0492; train_gene_expr_recon_loss: 12332962.2273; train_masked_gp_l1_reg_loss: 116869.0908; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99303.7554; train_chrom_access_recon_loss: 10587115.5152; train_global_loss: 26148113.0000; train_optim_loss: 26148113.0000; val_kl_reg_loss: 111626.6943; val_edge_recon_loss: 2931708.7188; val_gene_expr_recon_loss: 12306277.5000; val_masked_gp_l1_reg_loss: 118251.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96664.2188; val_chrom_access_recon_loss: 10696878.2500; val_global_loss: 26261406.2500; val_optim_loss: 26261406.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8956; val_auprc_score: 0.8652; val_best_acc_score: 0.8278; val_best_f1_score: 0.8403; train_kl_reg_loss: 107577.3910; train_edge_recon_loss: 2872019.9962; train_gene_expr_recon_loss: 12273871.6818; train_masked_gp_l1_reg_loss: 119287.0337; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94407.5272; train_chrom_access_recon_loss: 10553809.0000; train_global_loss: 26020972.5758; train_optim_loss: 26020972.5758; val_kl_reg_loss: 110239.7129; val_edge_recon_loss: 2883176.2188; val_gene_expr_recon_loss: 12250065.2500; val_masked_gp_l1_reg_loss: 120831.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92839.3047; val_chrom_access_recon_loss: 10783492.3750; val_global_loss: 26240645.0000; val_optim_loss: 26240645.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8935; val_auprc_score: 0.8538; val_best_acc_score: 0.8358; val_best_f1_score: 0.8492; train_kl_reg_loss: 109864.1849; train_edge_recon_loss: 2847004.1288; train_gene_expr_recon_loss: 12217764.5606; train_masked_gp_l1_reg_loss: 121787.0244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91720.9344; train_chrom_access_recon_loss: 10500435.7879; train_global_loss: 25888576.4848; train_optim_loss: 25888576.4848; val_kl_reg_loss: 109080.7002; val_edge_recon_loss: 2843194.7500; val_gene_expr_recon_loss: 12188848.5000; val_masked_gp_l1_reg_loss: 122719.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90527.6953; val_chrom_access_recon_loss: 10699225.3750; val_global_loss: 26053596.0000; val_optim_loss: 26053596.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8940; val_auprc_score: 0.8633; val_best_acc_score: 0.8326; val_best_f1_score: 0.8476; train_kl_reg_loss: 109155.5497; train_edge_recon_loss: 2820930.5076; train_gene_expr_recon_loss: 12167678.5758; train_masked_gp_l1_reg_loss: 123306.8020; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89645.5920; train_chrom_access_recon_loss: 10478718.1061; train_global_loss: 25789435.0303; train_optim_loss: 25789435.0303; val_kl_reg_loss: 110280.2549; val_edge_recon_loss: 2856569.7188; val_gene_expr_recon_loss: 12149858.7500; val_masked_gp_l1_reg_loss: 124362.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89237.1250; val_chrom_access_recon_loss: 10567459.0000; val_global_loss: 25897767.2500; val_optim_loss: 25897767.2500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9134; val_auprc_score: 0.8816; val_best_acc_score: 0.8592; val_best_f1_score: 0.8680; train_kl_reg_loss: 106139.7481; train_edge_recon_loss: 2802677.9811; train_gene_expr_recon_loss: 12120788.5152; train_masked_gp_l1_reg_loss: 124607.7596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88493.8368; train_chrom_access_recon_loss: 10435649.5455; train_global_loss: 25678357.3333; train_optim_loss: 25678357.3333; val_kl_reg_loss: 104834.6221; val_edge_recon_loss: 2795906.0938; val_gene_expr_recon_loss: 12174895.2500; val_masked_gp_l1_reg_loss: 125553.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87857.6250; val_chrom_access_recon_loss: 10677836.6250; val_global_loss: 25966884.2500; val_optim_loss: 25966884.2500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9068; val_auprc_score: 0.8720; val_best_acc_score: 0.8538; val_best_f1_score: 0.8647; train_kl_reg_loss: 104958.2823; train_edge_recon_loss: 2803408.2462; train_gene_expr_recon_loss: 12089364.8030; train_masked_gp_l1_reg_loss: 125848.4660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86881.4489; train_chrom_access_recon_loss: 10402101.6364; train_global_loss: 25612562.7273; train_optim_loss: 25612562.7273; val_kl_reg_loss: 106337.6084; val_edge_recon_loss: 2796930.4688; val_gene_expr_recon_loss: 11985679.5000; val_masked_gp_l1_reg_loss: 126420.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86091.4453; val_chrom_access_recon_loss: 10469598.6250; val_global_loss: 25571058.0000; val_optim_loss: 25571058.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9188; val_auprc_score: 0.8907; val_best_acc_score: 0.8576; val_best_f1_score: 0.8661; train_kl_reg_loss: 106981.7908; train_edge_recon_loss: 2789836.7121; train_gene_expr_recon_loss: 12041696.4848; train_masked_gp_l1_reg_loss: 126788.5756; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85131.4770; train_chrom_access_recon_loss: 10364944.4848; train_global_loss: 25515379.4848; train_optim_loss: 25515379.4848; val_kl_reg_loss: 109479.7100; val_edge_recon_loss: 2792922.3125; val_gene_expr_recon_loss: 12041260.6250; val_masked_gp_l1_reg_loss: 126853.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83848.4219; val_chrom_access_recon_loss: 10515233.2500; val_global_loss: 25669596.5000; val_optim_loss: 25669596.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9083; val_auprc_score: 0.8687; val_best_acc_score: 0.8549; val_best_f1_score: 0.8651; train_kl_reg_loss: 105469.2389; train_edge_recon_loss: 2776317.5909; train_gene_expr_recon_loss: 12005566.5909; train_masked_gp_l1_reg_loss: 127341.7036; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83337.0987; train_chrom_access_recon_loss: 10334305.0000; train_global_loss: 25432337.0909; train_optim_loss: 25432337.0909; val_kl_reg_loss: 104193.4961; val_edge_recon_loss: 2830959.5312; val_gene_expr_recon_loss: 12024138.8750; val_masked_gp_l1_reg_loss: 127670.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82757.4766; val_chrom_access_recon_loss: 10472344.1250; val_global_loss: 25642062.7500; val_optim_loss: 25642062.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9196; val_auprc_score: 0.8937; val_best_acc_score: 0.8587; val_best_f1_score: 0.8681; train_kl_reg_loss: 103396.4619; train_edge_recon_loss: 2780666.2879; train_gene_expr_recon_loss: 11975712.1515; train_masked_gp_l1_reg_loss: 128128.2891; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82167.0122; train_chrom_access_recon_loss: 10309386.0758; train_global_loss: 25379456.2424; train_optim_loss: 25379456.2424; val_kl_reg_loss: 106639.4238; val_edge_recon_loss: 2802204.9375; val_gene_expr_recon_loss: 11980014.6250; val_masked_gp_l1_reg_loss: 128537.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81183.1328; val_chrom_access_recon_loss: 10473429.1250; val_global_loss: 25572009.0000; val_optim_loss: 25572009.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9247; val_auprc_score: 0.8941; val_best_acc_score: 0.8708; val_best_f1_score: 0.8788; train_kl_reg_loss: 103479.2124; train_edge_recon_loss: 2761029.3712; train_gene_expr_recon_loss: 11949279.1515; train_masked_gp_l1_reg_loss: 128967.9711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80982.9626; train_chrom_access_recon_loss: 10280467.5909; train_global_loss: 25304206.2727; train_optim_loss: 25304206.2727; val_kl_reg_loss: 105571.4775; val_edge_recon_loss: 2766041.4688; val_gene_expr_recon_loss: 11967169.5000; val_masked_gp_l1_reg_loss: 129348.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80477.5859; val_chrom_access_recon_loss: 10435084.7500; val_global_loss: 25483693.2500; val_optim_loss: 25483693.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9243; val_auprc_score: 0.8951; val_best_acc_score: 0.8702; val_best_f1_score: 0.8782; train_kl_reg_loss: 103005.0695; train_edge_recon_loss: 2757240.5909; train_gene_expr_recon_loss: 11917741.8485; train_masked_gp_l1_reg_loss: 129483.7283; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79984.5735; train_chrom_access_recon_loss: 10245822.8788; train_global_loss: 25233278.5455; train_optim_loss: 25233278.5455; val_kl_reg_loss: 103122.0576; val_edge_recon_loss: 2759806.6250; val_gene_expr_recon_loss: 11944264.8750; val_masked_gp_l1_reg_loss: 129648.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79653.1406; val_chrom_access_recon_loss: 10484568.2500; val_global_loss: 25501063.2500; val_optim_loss: 25501063.2500
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9187; val_auprc_score: 0.8850; val_best_acc_score: 0.8608; val_best_f1_score: 0.8715; train_kl_reg_loss: 101992.8364; train_edge_recon_loss: 2759188.1250; train_gene_expr_recon_loss: 11892992.5303; train_masked_gp_l1_reg_loss: 129910.8474; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79053.4192; train_chrom_access_recon_loss: 10219225.1970; train_global_loss: 25182362.9091; train_optim_loss: 25182362.9091; val_kl_reg_loss: 102281.4561; val_edge_recon_loss: 2818143.0625; val_gene_expr_recon_loss: 11905580.3750; val_masked_gp_l1_reg_loss: 130261.5234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78739.0703; val_chrom_access_recon_loss: 10371887.8750; val_global_loss: 25406894.0000; val_optim_loss: 25406894.0000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9338; val_auprc_score: 0.9116; val_best_acc_score: 0.8753; val_best_f1_score: 0.8808; train_kl_reg_loss: 102948.8917; train_edge_recon_loss: 2750219.2955; train_gene_expr_recon_loss: 11863955.8333; train_masked_gp_l1_reg_loss: 130416.4535; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78274.2811; train_chrom_access_recon_loss: 10189695.5152; train_global_loss: 25115510.1515; train_optim_loss: 25115510.1515; val_kl_reg_loss: 104414.6572; val_edge_recon_loss: 2759345.6562; val_gene_expr_recon_loss: 12135690.0000; val_masked_gp_l1_reg_loss: 130687.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77638.3672; val_chrom_access_recon_loss: 10558115.5000; val_global_loss: 25765890.5000; val_optim_loss: 25765890.5000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9318; val_auprc_score: 0.9036; val_best_acc_score: 0.8737; val_best_f1_score: 0.8812; train_kl_reg_loss: 100848.1361; train_edge_recon_loss: 2755676.2576; train_gene_expr_recon_loss: 11836414.8333; train_masked_gp_l1_reg_loss: 130532.0780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77416.4999; train_chrom_access_recon_loss: 10157117.1818; train_global_loss: 25058005.0606; train_optim_loss: 25058005.0606; val_kl_reg_loss: 101483.3154; val_edge_recon_loss: 2774999.8125; val_gene_expr_recon_loss: 11881992.3750; val_masked_gp_l1_reg_loss: 130832.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77444.2656; val_chrom_access_recon_loss: 10374387.6250; val_global_loss: 25341139.0000; val_optim_loss: 25341139.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9360; val_auprc_score: 0.9148; val_best_acc_score: 0.8769; val_best_f1_score: 0.8827; train_kl_reg_loss: 101294.3775; train_edge_recon_loss: 2740599.4545; train_gene_expr_recon_loss: 11817479.9545; train_masked_gp_l1_reg_loss: 130904.2051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76941.6251; train_chrom_access_recon_loss: 10125390.5000; train_global_loss: 24992609.9394; train_optim_loss: 24992609.9394; val_kl_reg_loss: 100646.6514; val_edge_recon_loss: 2767019.6562; val_gene_expr_recon_loss: 11771763.6250; val_masked_gp_l1_reg_loss: 130751.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76513.0469; val_chrom_access_recon_loss: 10223173.6250; val_global_loss: 25069867.2500; val_optim_loss: 25069867.2500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9331; val_auprc_score: 0.9045; val_best_acc_score: 0.8737; val_best_f1_score: 0.8795; train_kl_reg_loss: 100243.2191; train_edge_recon_loss: 2745369.9242; train_gene_expr_recon_loss: 11788718.6212; train_masked_gp_l1_reg_loss: 131001.0032; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76371.5259; train_chrom_access_recon_loss: 10093279.8485; train_global_loss: 24934984.2727; train_optim_loss: 24934984.2727; val_kl_reg_loss: 101658.8857; val_edge_recon_loss: 2786616.1250; val_gene_expr_recon_loss: 11786871.0000; val_masked_gp_l1_reg_loss: 131074.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75979.5000; val_chrom_access_recon_loss: 10260474.1250; val_global_loss: 25142673.7500; val_optim_loss: 25142673.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9369; val_auprc_score: 0.9126; val_best_acc_score: 0.8783; val_best_f1_score: 0.8845; train_kl_reg_loss: 99445.5817; train_edge_recon_loss: 2745475.1591; train_gene_expr_recon_loss: 11760593.9697; train_masked_gp_l1_reg_loss: 131113.6792; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75965.3954; train_chrom_access_recon_loss: 10053224.8939; train_global_loss: 24865818.6667; train_optim_loss: 24865818.6667; val_kl_reg_loss: 100420.3867; val_edge_recon_loss: 2749229.4062; val_gene_expr_recon_loss: 11739761.1250; val_masked_gp_l1_reg_loss: 131113.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75852.7109; val_chrom_access_recon_loss: 10291267.0000; val_global_loss: 25087644.2500; val_optim_loss: 25087644.2500
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9294; val_auprc_score: 0.9034; val_best_acc_score: 0.8743; val_best_f1_score: 0.8838; train_kl_reg_loss: 99172.2820; train_edge_recon_loss: 2739122.3939; train_gene_expr_recon_loss: 11742687.5303; train_masked_gp_l1_reg_loss: 131030.2459; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75668.0460; train_chrom_access_recon_loss: 10027371.3485; train_global_loss: 24815051.8788; train_optim_loss: 24815051.8788; val_kl_reg_loss: 97422.6973; val_edge_recon_loss: 2779599.1562; val_gene_expr_recon_loss: 11762854.0000; val_masked_gp_l1_reg_loss: 131283.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75660.4375; val_chrom_access_recon_loss: 10244884.2500; val_global_loss: 25091703.0000; val_optim_loss: 25091703.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9354; val_auprc_score: 0.9132; val_best_acc_score: 0.8775; val_best_f1_score: 0.8846; train_kl_reg_loss: 97794.5832; train_edge_recon_loss: 2739138.9508; train_gene_expr_recon_loss: 11731999.5303; train_masked_gp_l1_reg_loss: 131334.2498; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75426.6540; train_chrom_access_recon_loss: 9998338.8182; train_global_loss: 24774032.6970; train_optim_loss: 24774032.6970; val_kl_reg_loss: 96312.4512; val_edge_recon_loss: 2777362.0312; val_gene_expr_recon_loss: 11753906.8750; val_masked_gp_l1_reg_loss: 131314.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75322.4844; val_chrom_access_recon_loss: 10128493.8750; val_global_loss: 24962710.7500; val_optim_loss: 24962710.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9347; val_auprc_score: 0.9083; val_best_acc_score: 0.8761; val_best_f1_score: 0.8836; train_kl_reg_loss: 97523.7688; train_edge_recon_loss: 2737706.8864; train_gene_expr_recon_loss: 11710565.3636; train_masked_gp_l1_reg_loss: 131348.7261; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75234.6850; train_chrom_access_recon_loss: 9978228.0000; train_global_loss: 24730607.3030; train_optim_loss: 24730607.3030; val_kl_reg_loss: 94757.4766; val_edge_recon_loss: 2781231.6250; val_gene_expr_recon_loss: 11692830.6250; val_masked_gp_l1_reg_loss: 131347.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75243.0391; val_chrom_access_recon_loss: 10118520.0000; val_global_loss: 24893930.5000; val_optim_loss: 24893930.5000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9384; val_auprc_score: 0.9129; val_best_acc_score: 0.8788; val_best_f1_score: 0.8855; train_kl_reg_loss: 96219.3188; train_edge_recon_loss: 2741613.8447; train_gene_expr_recon_loss: 11688988.4242; train_masked_gp_l1_reg_loss: 131292.7730; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75101.4425; train_chrom_access_recon_loss: 9948322.8333; train_global_loss: 24681538.5758; train_optim_loss: 24681538.5758; val_kl_reg_loss: 96708.7705; val_edge_recon_loss: 2783255.4688; val_gene_expr_recon_loss: 11738912.8750; val_masked_gp_l1_reg_loss: 131383.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74969.4219; val_chrom_access_recon_loss: 10264416.1250; val_global_loss: 25089645.0000; val_optim_loss: 25089645.0000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9502; val_auprc_score: 0.9304; val_best_acc_score: 0.8955; val_best_f1_score: 0.9004; train_kl_reg_loss: 95013.9755; train_edge_recon_loss: 2734101.3561; train_gene_expr_recon_loss: 11674697.7727; train_masked_gp_l1_reg_loss: 131422.1546; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75008.2251; train_chrom_access_recon_loss: 9913446.5909; train_global_loss: 24623690.1515; train_optim_loss: 24623690.1515; val_kl_reg_loss: 96797.9258; val_edge_recon_loss: 2732073.5938; val_gene_expr_recon_loss: 11753248.1250; val_masked_gp_l1_reg_loss: 131543.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75216.7266; val_chrom_access_recon_loss: 10140964.2500; val_global_loss: 24929844.0000; val_optim_loss: 24929844.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9413; val_auprc_score: 0.9195; val_best_acc_score: 0.8901; val_best_f1_score: 0.8967; train_kl_reg_loss: 95544.7513; train_edge_recon_loss: 2728431.5568; train_gene_expr_recon_loss: 11661427.7121; train_masked_gp_l1_reg_loss: 131510.4131; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74910.1089; train_chrom_access_recon_loss: 9877462.8939; train_global_loss: 24569287.3636; train_optim_loss: 24569287.3636; val_kl_reg_loss: 95659.7363; val_edge_recon_loss: 2804551.5625; val_gene_expr_recon_loss: 11647403.0000; val_masked_gp_l1_reg_loss: 131556.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74675.1250; val_chrom_access_recon_loss: 10141574.6250; val_global_loss: 24895421.0000; val_optim_loss: 24895421.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9494; val_auprc_score: 0.9264; val_best_acc_score: 0.8968; val_best_f1_score: 0.9026; train_kl_reg_loss: 94139.0655; train_edge_recon_loss: 2720976.5833; train_gene_expr_recon_loss: 11638709.4242; train_masked_gp_l1_reg_loss: 131562.5367; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74958.9076; train_chrom_access_recon_loss: 9838527.6818; train_global_loss: 24498874.1818; train_optim_loss: 24498874.1818; val_kl_reg_loss: 94637.9414; val_edge_recon_loss: 2755488.3125; val_gene_expr_recon_loss: 11719211.2500; val_masked_gp_l1_reg_loss: 131450.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74870.5156; val_chrom_access_recon_loss: 10213905.1250; val_global_loss: 24989563.5000; val_optim_loss: 24989563.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9479; val_auprc_score: 0.9248; val_best_acc_score: 0.8960; val_best_f1_score: 0.8983; train_kl_reg_loss: 94427.9263; train_edge_recon_loss: 2732478.6629; train_gene_expr_recon_loss: 11629014.3485; train_masked_gp_l1_reg_loss: 127258.4004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59090.1960; train_chrom_access_recon_loss: 9819448.2273; train_global_loss: 24461717.9091; train_optim_loss: 24461717.9091; val_kl_reg_loss: 96418.5410; val_edge_recon_loss: 2732579.3750; val_gene_expr_recon_loss: 11547910.8750; val_masked_gp_l1_reg_loss: 125931.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55725.7500; val_chrom_access_recon_loss: 10027839.6250; val_global_loss: 24586405.0000; val_optim_loss: 24586405.0000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9401; val_auprc_score: 0.9143; val_best_acc_score: 0.8850; val_best_f1_score: 0.8901; train_kl_reg_loss: 96118.9721; train_edge_recon_loss: 2718347.1705; train_gene_expr_recon_loss: 11625765.6061; train_masked_gp_l1_reg_loss: 125758.5711; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55418.9600; train_chrom_access_recon_loss: 9810089.7273; train_global_loss: 24431499.2121; train_optim_loss: 24431499.2121; val_kl_reg_loss: 97706.5273; val_edge_recon_loss: 2775109.1875; val_gene_expr_recon_loss: 11727414.3750; val_masked_gp_l1_reg_loss: 125667.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55170.6875; val_chrom_access_recon_loss: 10057728.2500; val_global_loss: 24838797.0000; val_optim_loss: 24838797.0000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9492; val_auprc_score: 0.9262; val_best_acc_score: 0.8955; val_best_f1_score: 0.9011; train_kl_reg_loss: 97092.7540; train_edge_recon_loss: 2719446.1780; train_gene_expr_recon_loss: 11629386.8636; train_masked_gp_l1_reg_loss: 125633.2532; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54998.6683; train_chrom_access_recon_loss: 9810159.2576; train_global_loss: 24436716.9394; train_optim_loss: 24436716.9394; val_kl_reg_loss: 98313.8545; val_edge_recon_loss: 2729154.2500; val_gene_expr_recon_loss: 11606838.0000; val_masked_gp_l1_reg_loss: 125582.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54847.1484; val_chrom_access_recon_loss: 10042794.2500; val_global_loss: 24657529.2500; val_optim_loss: 24657529.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9505; val_auprc_score: 0.9329; val_best_acc_score: 0.8944; val_best_f1_score: 0.8988; train_kl_reg_loss: 97273.4367; train_edge_recon_loss: 2712078.4811; train_gene_expr_recon_loss: 11621961.4091; train_masked_gp_l1_reg_loss: 125584.1496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54699.6402; train_chrom_access_recon_loss: 9797744.8030; train_global_loss: 24409341.9697; train_optim_loss: 24409341.9697; val_kl_reg_loss: 98687.0713; val_edge_recon_loss: 2746134.5625; val_gene_expr_recon_loss: 11637764.1250; val_masked_gp_l1_reg_loss: 125574.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54616.2930; val_chrom_access_recon_loss: 10054643.1250; val_global_loss: 24717418.5000; val_optim_loss: 24717418.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9478; val_auprc_score: 0.9295; val_best_acc_score: 0.8939; val_best_f1_score: 0.8981; train_kl_reg_loss: 97469.3061; train_edge_recon_loss: 2712399.8750; train_gene_expr_recon_loss: 11615977.3788; train_masked_gp_l1_reg_loss: 125547.3066; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54491.5592; train_chrom_access_recon_loss: 9793771.5303; train_global_loss: 24399656.9394; train_optim_loss: 24399656.9394; val_kl_reg_loss: 97722.2852; val_edge_recon_loss: 2747627.0625; val_gene_expr_recon_loss: 11743996.6250; val_masked_gp_l1_reg_loss: 125533.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54397.5234; val_chrom_access_recon_loss: 10118431.3750; val_global_loss: 24887708.2500; val_optim_loss: 24887708.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9467; val_auprc_score: 0.9252; val_best_acc_score: 0.8941; val_best_f1_score: 0.8999; train_kl_reg_loss: 97011.6765; train_edge_recon_loss: 2719860.7121; train_gene_expr_recon_loss: 11615503.2424; train_masked_gp_l1_reg_loss: 125103.5930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52841.2323; train_chrom_access_recon_loss: 9794425.3182; train_global_loss: 24404745.6061; train_optim_loss: 24404745.6061; val_kl_reg_loss: 98101.7539; val_edge_recon_loss: 2743240.4375; val_gene_expr_recon_loss: 11644847.8750; val_masked_gp_l1_reg_loss: 124945.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52514.9102; val_chrom_access_recon_loss: 10096951.3750; val_global_loss: 24760603.0000; val_optim_loss: 24760603.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9472; val_auprc_score: 0.9259; val_best_acc_score: 0.8925; val_best_f1_score: 0.8976; train_kl_reg_loss: 97208.9553; train_edge_recon_loss: 2713471.7462; train_gene_expr_recon_loss: 11612296.4091; train_masked_gp_l1_reg_loss: 124914.9008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52476.4776; train_chrom_access_recon_loss: 9784037.7879; train_global_loss: 24384406.2727; train_optim_loss: 24384406.2727; val_kl_reg_loss: 98513.5420; val_edge_recon_loss: 2769848.8125; val_gene_expr_recon_loss: 11604828.7500; val_masked_gp_l1_reg_loss: 124893.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52449.7852; val_chrom_access_recon_loss: 10112014.6250; val_global_loss: 24762549.7500; val_optim_loss: 24762549.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9474; val_auprc_score: 0.9254; val_best_acc_score: 0.8898; val_best_f1_score: 0.8930; train_kl_reg_loss: 97162.7236; train_edge_recon_loss: 2714286.0758; train_gene_expr_recon_loss: 11617206.5606; train_masked_gp_l1_reg_loss: 124881.1422; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52430.1164; train_chrom_access_recon_loss: 9790892.3182; train_global_loss: 24396858.8485; train_optim_loss: 24396858.8485; val_kl_reg_loss: 98257.5381; val_edge_recon_loss: 2767882.1875; val_gene_expr_recon_loss: 11571834.1250; val_masked_gp_l1_reg_loss: 124872.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52407.4258; val_chrom_access_recon_loss: 10015034.0000; val_global_loss: 24630288.0000; val_optim_loss: 24630288.0000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9478; val_auprc_score: 0.9272; val_best_acc_score: 0.8955; val_best_f1_score: 0.9018; train_kl_reg_loss: 97516.2061; train_edge_recon_loss: 2715935.1818; train_gene_expr_recon_loss: 11623202.3333; train_masked_gp_l1_reg_loss: 124869.9638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52391.0957; train_chrom_access_recon_loss: 9800929.6364; train_global_loss: 24414844.5455; train_optim_loss: 24414844.5455; val_kl_reg_loss: 97725.4609; val_edge_recon_loss: 2739049.1875; val_gene_expr_recon_loss: 11636067.1250; val_masked_gp_l1_reg_loss: 124863.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52373.2305; val_chrom_access_recon_loss: 10049687.5000; val_global_loss: 24699765.5000; val_optim_loss: 24699765.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 13 min 4 sec.
Using best model state, which was in epoch 32.

--- MODEL EVALUATION ---
val AUROC score: 0.9491
val AUPRC score: 0.9290
val best accuracy score: 0.8955
val best F1 score: 0.9007
val target rna MSE score: 1.2417
val source rna MSE score: 0.7816
val target atac MSE score: 0.3305
val source atac MSE score: 0.1291
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
