[True]
Run timestamp: 10102023_041105_138.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_138']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7734; val_auprc_score: 0.7939; val_best_acc_score: 0.5719; val_best_f1_score: 0.6954; train_kl_reg_loss: 62284.2387; train_edge_recon_loss: 3505244.9523; train_gene_expr_recon_loss: 13433317.9084; train_masked_gp_l1_reg_loss: 123149.8922; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2722791.9275; train_chrom_access_recon_loss: 4780419.7786; train_global_loss: 24627208.6870; train_optim_loss: 24627208.6870; val_kl_reg_loss: 95193.2917; val_edge_recon_loss: 4061383.0833; val_gene_expr_recon_loss: 12791974.8000; val_masked_gp_l1_reg_loss: 108071.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 380695.0000; val_chrom_access_recon_loss: 4669321.9000; val_global_loss: 22106640.0000; val_optim_loss: 22106640.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8220; val_auprc_score: 0.8256; val_best_acc_score: 0.7259; val_best_f1_score: 0.7559; train_kl_reg_loss: 81770.6516; train_edge_recon_loss: 3499649.8130; train_gene_expr_recon_loss: 12568152.0534; train_masked_gp_l1_reg_loss: 103739.7092; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 216690.3405; train_chrom_access_recon_loss: 4586158.2920; train_global_loss: 21056160.8702; train_optim_loss: 21056160.8702; val_kl_reg_loss: 76574.8854; val_edge_recon_loss: 3923426.4333; val_gene_expr_recon_loss: 12589085.1333; val_masked_gp_l1_reg_loss: 102501.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141859.5156; val_chrom_access_recon_loss: 4624236.7667; val_global_loss: 21457684.5333; val_optim_loss: 21457684.5333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8160; val_auprc_score: 0.8119; val_best_acc_score: 0.7264; val_best_f1_score: 0.7603; train_kl_reg_loss: 74388.2135; train_edge_recon_loss: 3209450.5191; train_gene_expr_recon_loss: 12451437.1298; train_masked_gp_l1_reg_loss: 108634.8069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117580.5688; train_chrom_access_recon_loss: 4547621.7901; train_global_loss: 20509112.9924; train_optim_loss: 20509112.9924; val_kl_reg_loss: 84237.7000; val_edge_recon_loss: 3212546.7000; val_gene_expr_recon_loss: 12526333.3333; val_masked_gp_l1_reg_loss: 113189.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100501.3984; val_chrom_access_recon_loss: 4581342.4000; val_global_loss: 20618150.2667; val_optim_loss: 20618150.2667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8961; val_auprc_score: 0.8845; val_best_acc_score: 0.8169; val_best_f1_score: 0.8287; train_kl_reg_loss: 86319.9028; train_edge_recon_loss: 2997018.3454; train_gene_expr_recon_loss: 12320803.9389; train_masked_gp_l1_reg_loss: 116554.3630; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91799.9710; train_chrom_access_recon_loss: 4500935.0763; train_global_loss: 20113431.6947; train_optim_loss: 20113431.6947; val_kl_reg_loss: 93473.7297; val_edge_recon_loss: 2914585.5333; val_gene_expr_recon_loss: 12416559.0667; val_masked_gp_l1_reg_loss: 120750.6250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86377.9453; val_chrom_access_recon_loss: 4559376.5333; val_global_loss: 20191124.0000; val_optim_loss: 20191124.0000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9288; val_auprc_score: 0.9149; val_best_acc_score: 0.8632; val_best_f1_score: 0.8709; train_kl_reg_loss: 96030.2448; train_edge_recon_loss: 2837474.3740; train_gene_expr_recon_loss: 12196125.0000; train_masked_gp_l1_reg_loss: 122503.6023; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85580.4380; train_chrom_access_recon_loss: 4458949.8340; train_global_loss: 19796663.5878; train_optim_loss: 19796663.5878; val_kl_reg_loss: 98249.0750; val_edge_recon_loss: 2808535.7667; val_gene_expr_recon_loss: 12249315.9333; val_masked_gp_l1_reg_loss: 123965.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87618.6016; val_chrom_access_recon_loss: 4500360.5333; val_global_loss: 19868046.4000; val_optim_loss: 19868046.4000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9291; val_auprc_score: 0.9155; val_best_acc_score: 0.8623; val_best_f1_score: 0.8705; train_kl_reg_loss: 98909.3742; train_edge_recon_loss: 2798752.0611; train_gene_expr_recon_loss: 12074738.3282; train_masked_gp_l1_reg_loss: 123751.0741; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88868.5590; train_chrom_access_recon_loss: 4419339.1832; train_global_loss: 19604358.4733; train_optim_loss: 19604358.4733; val_kl_reg_loss: 99324.1151; val_edge_recon_loss: 2811538.1167; val_gene_expr_recon_loss: 12214422.6667; val_masked_gp_l1_reg_loss: 123998.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89392.5938; val_chrom_access_recon_loss: 4490295.3333; val_global_loss: 19828971.2000; val_optim_loss: 19828971.2000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9285; val_auprc_score: 0.9126; val_best_acc_score: 0.8624; val_best_f1_score: 0.8690; train_kl_reg_loss: 94899.4187; train_edge_recon_loss: 2801329.5553; train_gene_expr_recon_loss: 11990509.6794; train_masked_gp_l1_reg_loss: 124054.9015; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88325.9026; train_chrom_access_recon_loss: 4393975.7061; train_global_loss: 19493095.1450; train_optim_loss: 19493095.1450; val_kl_reg_loss: 93250.6865; val_edge_recon_loss: 2832091.2167; val_gene_expr_recon_loss: 12053493.2667; val_masked_gp_l1_reg_loss: 124320.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87465.8828; val_chrom_access_recon_loss: 4432924.6833; val_global_loss: 19623545.8667; val_optim_loss: 19623545.8667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9369; val_auprc_score: 0.9236; val_best_acc_score: 0.8689; val_best_f1_score: 0.8773; train_kl_reg_loss: 92314.4268; train_edge_recon_loss: 2794309.8836; train_gene_expr_recon_loss: 11918734.9008; train_masked_gp_l1_reg_loss: 124683.8097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85751.2541; train_chrom_access_recon_loss: 4370141.2328; train_global_loss: 19385935.4809; train_optim_loss: 19385935.4809; val_kl_reg_loss: 95677.1500; val_edge_recon_loss: 2799912.3333; val_gene_expr_recon_loss: 12064230.7333; val_masked_gp_l1_reg_loss: 124921.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84200.8984; val_chrom_access_recon_loss: 4424976.4667; val_global_loss: 19593919.6000; val_optim_loss: 19593919.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9335; val_auprc_score: 0.9134; val_best_acc_score: 0.8728; val_best_f1_score: 0.8790; train_kl_reg_loss: 90472.9187; train_edge_recon_loss: 2785560.6832; train_gene_expr_recon_loss: 11854952.2748; train_masked_gp_l1_reg_loss: 125452.3189; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83042.2878; train_chrom_access_recon_loss: 4341542.6107; train_global_loss: 19281023.3130; train_optim_loss: 19281023.3130; val_kl_reg_loss: 88413.2323; val_edge_recon_loss: 2803977.7000; val_gene_expr_recon_loss: 11940506.0667; val_masked_gp_l1_reg_loss: 125684.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82456.1328; val_chrom_access_recon_loss: 4397328.7000; val_global_loss: 19438366.6667; val_optim_loss: 19438366.6667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9403; val_auprc_score: 0.9223; val_best_acc_score: 0.8797; val_best_f1_score: 0.8859; train_kl_reg_loss: 90466.0653; train_edge_recon_loss: 2766582.2233; train_gene_expr_recon_loss: 11780220.1221; train_masked_gp_l1_reg_loss: 126008.9917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 81028.4255; train_chrom_access_recon_loss: 4312368.9447; train_global_loss: 19156674.7786; train_optim_loss: 19156674.7786; val_kl_reg_loss: 89537.8714; val_edge_recon_loss: 2774806.1167; val_gene_expr_recon_loss: 11879315.2000; val_masked_gp_l1_reg_loss: 126051.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79690.5703; val_chrom_access_recon_loss: 4358494.8667; val_global_loss: 19307896.9333; val_optim_loss: 19307896.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9406; val_auprc_score: 0.9240; val_best_acc_score: 0.8841; val_best_f1_score: 0.8888; train_kl_reg_loss: 88073.0140; train_edge_recon_loss: 2762711.1813; train_gene_expr_recon_loss: 11727999.3206; train_masked_gp_l1_reg_loss: 126537.3703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79405.7681; train_chrom_access_recon_loss: 4297249.3321; train_global_loss: 19081976.0458; train_optim_loss: 19081976.0458; val_kl_reg_loss: 90061.0016; val_edge_recon_loss: 2784347.9833; val_gene_expr_recon_loss: 11826899.5333; val_masked_gp_l1_reg_loss: 126710.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78787.0078; val_chrom_access_recon_loss: 4351864.4833; val_global_loss: 19258669.7333; val_optim_loss: 19258669.7333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9450; val_auprc_score: 0.9308; val_best_acc_score: 0.8840; val_best_f1_score: 0.8887; train_kl_reg_loss: 86655.3333; train_edge_recon_loss: 2761483.8397; train_gene_expr_recon_loss: 11687921.1908; train_masked_gp_l1_reg_loss: 127102.0407; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78044.4007; train_chrom_access_recon_loss: 4276558.0134; train_global_loss: 19017764.8092; train_optim_loss: 19017764.8092; val_kl_reg_loss: 88300.7359; val_edge_recon_loss: 2776784.4500; val_gene_expr_recon_loss: 11809183.5333; val_masked_gp_l1_reg_loss: 127274.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77215.8438; val_chrom_access_recon_loss: 4326992.4500; val_global_loss: 19205751.4667; val_optim_loss: 19205751.4667
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9427; val_auprc_score: 0.9271; val_best_acc_score: 0.8808; val_best_f1_score: 0.8851; train_kl_reg_loss: 87264.9541; train_edge_recon_loss: 2757019.3225; train_gene_expr_recon_loss: 11642997.7176; train_masked_gp_l1_reg_loss: 127313.0012; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76996.1438; train_chrom_access_recon_loss: 4260300.6508; train_global_loss: 18951891.8779; train_optim_loss: 18951891.8779; val_kl_reg_loss: 87380.3708; val_edge_recon_loss: 2795404.3333; val_gene_expr_recon_loss: 11800282.4000; val_masked_gp_l1_reg_loss: 127334.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76149.7266; val_chrom_access_recon_loss: 4320556.6333; val_global_loss: 19207107.6000; val_optim_loss: 19207107.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9456; val_auprc_score: 0.9352; val_best_acc_score: 0.8818; val_best_f1_score: 0.8877; train_kl_reg_loss: 86733.2595; train_edge_recon_loss: 2747416.0916; train_gene_expr_recon_loss: 11612301.0840; train_masked_gp_l1_reg_loss: 127113.1090; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76021.1474; train_chrom_access_recon_loss: 4244872.9523; train_global_loss: 18894457.7252; train_optim_loss: 18894457.7252; val_kl_reg_loss: 86091.2625; val_edge_recon_loss: 2784162.1333; val_gene_expr_recon_loss: 11727139.7333; val_masked_gp_l1_reg_loss: 126979.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75925.2344; val_chrom_access_recon_loss: 4283755.4000; val_global_loss: 19084053.4667; val_optim_loss: 19084053.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9481; val_auprc_score: 0.9350; val_best_acc_score: 0.8880; val_best_f1_score: 0.8926; train_kl_reg_loss: 85944.7508; train_edge_recon_loss: 2743200.1298; train_gene_expr_recon_loss: 11571942.4656; train_masked_gp_l1_reg_loss: 126958.3447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75487.1118; train_chrom_access_recon_loss: 4229129.4084; train_global_loss: 18832662.2137; train_optim_loss: 18832662.2137; val_kl_reg_loss: 85787.4260; val_edge_recon_loss: 2772561.4833; val_gene_expr_recon_loss: 11678212.0667; val_masked_gp_l1_reg_loss: 127181.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75861.4375; val_chrom_access_recon_loss: 4279771.8833; val_global_loss: 19019374.6667; val_optim_loss: 19019374.6667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9508; val_auprc_score: 0.9381; val_best_acc_score: 0.8932; val_best_f1_score: 0.8976; train_kl_reg_loss: 86038.5648; train_edge_recon_loss: 2742329.8321; train_gene_expr_recon_loss: 11536828.2443; train_masked_gp_l1_reg_loss: 126823.4447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75275.1084; train_chrom_access_recon_loss: 4215670.0038; train_global_loss: 18782965.0229; train_optim_loss: 18782965.0229; val_kl_reg_loss: 88570.6021; val_edge_recon_loss: 2744745.0500; val_gene_expr_recon_loss: 11596118.0000; val_masked_gp_l1_reg_loss: 126510.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74790.2500; val_chrom_access_recon_loss: 4238819.8333; val_global_loss: 18869553.8667; val_optim_loss: 18869553.8667
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9487; val_auprc_score: 0.9336; val_best_acc_score: 0.8876; val_best_f1_score: 0.8943; train_kl_reg_loss: 84672.5861; train_edge_recon_loss: 2732308.0992; train_gene_expr_recon_loss: 11508564.9008; train_masked_gp_l1_reg_loss: 126294.6591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75112.8156; train_chrom_access_recon_loss: 4201542.8015; train_global_loss: 18728495.7710; train_optim_loss: 18728495.7710; val_kl_reg_loss: 84176.0344; val_edge_recon_loss: 2745578.4667; val_gene_expr_recon_loss: 11689162.4000; val_masked_gp_l1_reg_loss: 126190.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75476.3359; val_chrom_access_recon_loss: 4279839.3667; val_global_loss: 19000422.4000; val_optim_loss: 19000422.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9570; val_auprc_score: 0.9462; val_best_acc_score: 0.9014; val_best_f1_score: 0.9061; train_kl_reg_loss: 85534.7679; train_edge_recon_loss: 2720874.5229; train_gene_expr_recon_loss: 11491311.0153; train_masked_gp_l1_reg_loss: 126207.6345; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75289.4790; train_chrom_access_recon_loss: 4191600.2137; train_global_loss: 18690817.5420; train_optim_loss: 18690817.5420; val_kl_reg_loss: 82831.7031; val_edge_recon_loss: 2733070.4167; val_gene_expr_recon_loss: 11639903.1333; val_masked_gp_l1_reg_loss: 125741.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75578.0000; val_chrom_access_recon_loss: 4259056.7833; val_global_loss: 18916182.1333; val_optim_loss: 18916182.1333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9610; val_auprc_score: 0.9519; val_best_acc_score: 0.9047; val_best_f1_score: 0.9085; train_kl_reg_loss: 83315.3325; train_edge_recon_loss: 2719430.5095; train_gene_expr_recon_loss: 11473996.0916; train_masked_gp_l1_reg_loss: 125864.8026; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75717.5746; train_chrom_access_recon_loss: 4184801.7767; train_global_loss: 18663126.2290; train_optim_loss: 18663126.2290; val_kl_reg_loss: 84074.0880; val_edge_recon_loss: 2721428.6833; val_gene_expr_recon_loss: 11653122.0000; val_masked_gp_l1_reg_loss: 126356.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76276.4688; val_chrom_access_recon_loss: 4249154.6667; val_global_loss: 18910412.4000; val_optim_loss: 18910412.4000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9614; val_auprc_score: 0.9520; val_best_acc_score: 0.9039; val_best_f1_score: 0.9070; train_kl_reg_loss: 84067.2664; train_edge_recon_loss: 2716661.8912; train_gene_expr_recon_loss: 11439921.4733; train_masked_gp_l1_reg_loss: 125657.4819; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76290.4062; train_chrom_access_recon_loss: 4167564.7901; train_global_loss: 18610163.3588; train_optim_loss: 18610163.3588; val_kl_reg_loss: 84532.7109; val_edge_recon_loss: 2725135.0667; val_gene_expr_recon_loss: 11585854.8667; val_masked_gp_l1_reg_loss: 125349.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76538.6016; val_chrom_access_recon_loss: 4246353.8833; val_global_loss: 18843765.3333; val_optim_loss: 18843765.3333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9639; val_auprc_score: 0.9554; val_best_acc_score: 0.9111; val_best_f1_score: 0.9151; train_kl_reg_loss: 84141.4701; train_edge_recon_loss: 2715785.8950; train_gene_expr_recon_loss: 11423051.4198; train_masked_gp_l1_reg_loss: 124966.4757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76843.3191; train_chrom_access_recon_loss: 4156596.7595; train_global_loss: 18581385.4504; train_optim_loss: 18581385.4504; val_kl_reg_loss: 83022.1823; val_edge_recon_loss: 2703009.4000; val_gene_expr_recon_loss: 11590028.6000; val_masked_gp_l1_reg_loss: 124932.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77631.9062; val_chrom_access_recon_loss: 4256932.5333; val_global_loss: 18835556.5333; val_optim_loss: 18835556.5333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9607; val_auprc_score: 0.9497; val_best_acc_score: 0.9037; val_best_f1_score: 0.9078; train_kl_reg_loss: 85787.6376; train_edge_recon_loss: 2716672.1336; train_gene_expr_recon_loss: 11397502.4580; train_masked_gp_l1_reg_loss: 124370.7524; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77255.6415; train_chrom_access_recon_loss: 4148061.1889; train_global_loss: 18549649.7557; train_optim_loss: 18549649.7557; val_kl_reg_loss: 86787.7682; val_edge_recon_loss: 2723901.4167; val_gene_expr_recon_loss: 11526541.4667; val_masked_gp_l1_reg_loss: 124200.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77744.4766; val_chrom_access_recon_loss: 4215675.4167; val_global_loss: 18754850.0000; val_optim_loss: 18754850.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9666; val_auprc_score: 0.9572; val_best_acc_score: 0.9132; val_best_f1_score: 0.9162; train_kl_reg_loss: 84419.2623; train_edge_recon_loss: 2705469.0553; train_gene_expr_recon_loss: 11381185.7939; train_masked_gp_l1_reg_loss: 123838.5277; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77624.1924; train_chrom_access_recon_loss: 4136165.7061; train_global_loss: 18508702.5802; train_optim_loss: 18508702.5802; val_kl_reg_loss: 85696.9120; val_edge_recon_loss: 2727774.4500; val_gene_expr_recon_loss: 11508426.0000; val_masked_gp_l1_reg_loss: 123692.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78013.0000; val_chrom_access_recon_loss: 4207956.4000; val_global_loss: 18731558.9333; val_optim_loss: 18731558.9333
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9662; val_auprc_score: 0.9567; val_best_acc_score: 0.9155; val_best_f1_score: 0.9177; train_kl_reg_loss: 83018.3754; train_edge_recon_loss: 2699655.5172; train_gene_expr_recon_loss: 11361137.9771; train_masked_gp_l1_reg_loss: 123245.3764; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77736.1862; train_chrom_access_recon_loss: 4128346.2729; train_global_loss: 18473139.7557; train_optim_loss: 18473139.7557; val_kl_reg_loss: 83338.3667; val_edge_recon_loss: 2729723.0667; val_gene_expr_recon_loss: 11449572.1333; val_masked_gp_l1_reg_loss: 123177.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78136.1562; val_chrom_access_recon_loss: 4188900.4167; val_global_loss: 18652848.1333; val_optim_loss: 18652848.1333
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9671; val_auprc_score: 0.9592; val_best_acc_score: 0.9140; val_best_f1_score: 0.9169; train_kl_reg_loss: 82920.1755; train_edge_recon_loss: 2697236.5878; train_gene_expr_recon_loss: 11341260.5802; train_masked_gp_l1_reg_loss: 122707.2979; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77692.8672; train_chrom_access_recon_loss: 4115467.7538; train_global_loss: 18437285.2824; train_optim_loss: 18437285.2824; val_kl_reg_loss: 83379.2990; val_edge_recon_loss: 2720581.3167; val_gene_expr_recon_loss: 11475321.4667; val_masked_gp_l1_reg_loss: 122428.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78103.2812; val_chrom_access_recon_loss: 4189549.1667; val_global_loss: 18669362.4000; val_optim_loss: 18669362.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9704; val_auprc_score: 0.9619; val_best_acc_score: 0.9193; val_best_f1_score: 0.9211; train_kl_reg_loss: 82049.4589; train_edge_recon_loss: 2700738.5763; train_gene_expr_recon_loss: 11333696.6183; train_masked_gp_l1_reg_loss: 122054.5906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77847.7254; train_chrom_access_recon_loss: 4107295.3969; train_global_loss: 18423682.4275; train_optim_loss: 18423682.4275; val_kl_reg_loss: 81653.2318; val_edge_recon_loss: 2712990.2667; val_gene_expr_recon_loss: 11489075.2000; val_masked_gp_l1_reg_loss: 121976.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78473.5000; val_chrom_access_recon_loss: 4183034.3667; val_global_loss: 18667203.4667; val_optim_loss: 18667203.4667
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9668; val_auprc_score: 0.9567; val_best_acc_score: 0.9135; val_best_f1_score: 0.9168; train_kl_reg_loss: 80912.5926; train_edge_recon_loss: 2699349.7901; train_gene_expr_recon_loss: 11325613.1298; train_masked_gp_l1_reg_loss: 121546.3166; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78014.8463; train_chrom_access_recon_loss: 4097010.1698; train_global_loss: 18402446.8397; train_optim_loss: 18402446.8397; val_kl_reg_loss: 84002.3266; val_edge_recon_loss: 2712725.6667; val_gene_expr_recon_loss: 11454936.0667; val_masked_gp_l1_reg_loss: 121452.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78037.6719; val_chrom_access_recon_loss: 4164700.6500; val_global_loss: 18615854.6667; val_optim_loss: 18615854.6667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9721; val_auprc_score: 0.9660; val_best_acc_score: 0.9233; val_best_f1_score: 0.9258; train_kl_reg_loss: 81765.6894; train_edge_recon_loss: 2698851.7538; train_gene_expr_recon_loss: 11313773.9389; train_masked_gp_l1_reg_loss: 120935.5487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77753.7849; train_chrom_access_recon_loss: 4091005.1775; train_global_loss: 18384085.8321; train_optim_loss: 18384085.8321; val_kl_reg_loss: 79947.6760; val_edge_recon_loss: 2715724.6000; val_gene_expr_recon_loss: 11412891.8000; val_masked_gp_l1_reg_loss: 120406.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78656.0547; val_chrom_access_recon_loss: 4160901.4500; val_global_loss: 18568528.6667; val_optim_loss: 18568528.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9679; val_auprc_score: 0.9551; val_best_acc_score: 0.9216; val_best_f1_score: 0.9239; train_kl_reg_loss: 81172.8473; train_edge_recon_loss: 2692438.6317; train_gene_expr_recon_loss: 11294728.2901; train_masked_gp_l1_reg_loss: 120281.9857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78043.5574; train_chrom_access_recon_loss: 4081181.1584; train_global_loss: 18347846.4580; train_optim_loss: 18347846.4580; val_kl_reg_loss: 81705.7734; val_edge_recon_loss: 2727547.2667; val_gene_expr_recon_loss: 11431233.6667; val_masked_gp_l1_reg_loss: 119989.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78387.7500; val_chrom_access_recon_loss: 4168712.8833; val_global_loss: 18607576.6667; val_optim_loss: 18607576.6667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9738; val_auprc_score: 0.9666; val_best_acc_score: 0.9283; val_best_f1_score: 0.9305; train_kl_reg_loss: 81003.2900; train_edge_recon_loss: 2693281.9504; train_gene_expr_recon_loss: 11290363.6641; train_masked_gp_l1_reg_loss: 119679.0794; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78178.2238; train_chrom_access_recon_loss: 4073357.3397; train_global_loss: 18335863.6031; train_optim_loss: 18335863.6031; val_kl_reg_loss: 80529.7844; val_edge_recon_loss: 2692039.9500; val_gene_expr_recon_loss: 11426729.8667; val_masked_gp_l1_reg_loss: 119328.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77545.0078; val_chrom_access_recon_loss: 4148796.0167; val_global_loss: 18544969.4667; val_optim_loss: 18544969.4667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9750; val_auprc_score: 0.9654; val_best_acc_score: 0.9310; val_best_f1_score: 0.9328; train_kl_reg_loss: 80775.4115; train_edge_recon_loss: 2694775.4695; train_gene_expr_recon_loss: 11275483.8168; train_masked_gp_l1_reg_loss: 119080.5081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78116.2166; train_chrom_access_recon_loss: 4062196.1889; train_global_loss: 18310427.6947; train_optim_loss: 18310427.6947; val_kl_reg_loss: 79781.9724; val_edge_recon_loss: 2698872.6667; val_gene_expr_recon_loss: 11417059.2000; val_masked_gp_l1_reg_loss: 119036.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78106.0547; val_chrom_access_recon_loss: 4124936.3000; val_global_loss: 18517791.8667; val_optim_loss: 18517791.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9727; val_auprc_score: 0.9656; val_best_acc_score: 0.9266; val_best_f1_score: 0.9284; train_kl_reg_loss: 80600.1123; train_edge_recon_loss: 2690549.3435; train_gene_expr_recon_loss: 11265592.3817; train_masked_gp_l1_reg_loss: 118575.4506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78178.0184; train_chrom_access_recon_loss: 4052548.7252; train_global_loss: 18286044.0916; train_optim_loss: 18286044.0916; val_kl_reg_loss: 80606.3661; val_edge_recon_loss: 2712313.4167; val_gene_expr_recon_loss: 11393504.6667; val_masked_gp_l1_reg_loss: 118448.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78745.8984; val_chrom_access_recon_loss: 4121468.5333; val_global_loss: 18505086.9333; val_optim_loss: 18505086.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9749; val_auprc_score: 0.9667; val_best_acc_score: 0.9294; val_best_f1_score: 0.9323; train_kl_reg_loss: 80348.5172; train_edge_recon_loss: 2691789.0668; train_gene_expr_recon_loss: 11266018.7481; train_masked_gp_l1_reg_loss: 117891.2858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78549.7050; train_chrom_access_recon_loss: 4050422.7042; train_global_loss: 18285020.1832; train_optim_loss: 18285020.1832; val_kl_reg_loss: 80800.7656; val_edge_recon_loss: 2685123.3000; val_gene_expr_recon_loss: 11427333.2667; val_masked_gp_l1_reg_loss: 117657.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78888.3750; val_chrom_access_recon_loss: 4136318.4167; val_global_loss: 18526120.9333; val_optim_loss: 18526120.9333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9743; val_auprc_score: 0.9644; val_best_acc_score: 0.9303; val_best_f1_score: 0.9329; train_kl_reg_loss: 79679.7110; train_edge_recon_loss: 2694846.7538; train_gene_expr_recon_loss: 11270624.8168; train_masked_gp_l1_reg_loss: 117410.3847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78684.2413; train_chrom_access_recon_loss: 4045826.2405; train_global_loss: 18287072.0916; train_optim_loss: 18287072.0916; val_kl_reg_loss: 79253.6047; val_edge_recon_loss: 2716242.9167; val_gene_expr_recon_loss: 11424877.0000; val_masked_gp_l1_reg_loss: 117165.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78710.0391; val_chrom_access_recon_loss: 4127669.9333; val_global_loss: 18543919.4667; val_optim_loss: 18543919.4667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9778; val_auprc_score: 0.9698; val_best_acc_score: 0.9316; val_best_f1_score: 0.9337; train_kl_reg_loss: 79370.9674; train_edge_recon_loss: 2690386.2805; train_gene_expr_recon_loss: 11249942.7099; train_masked_gp_l1_reg_loss: 116766.7839; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78638.5698; train_chrom_access_recon_loss: 4033438.1985; train_global_loss: 18248543.5115; train_optim_loss: 18248543.5115; val_kl_reg_loss: 81610.8547; val_edge_recon_loss: 2686054.5167; val_gene_expr_recon_loss: 11373301.5333; val_masked_gp_l1_reg_loss: 116822.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79218.6953; val_chrom_access_recon_loss: 4133133.8667; val_global_loss: 18470142.5333; val_optim_loss: 18470142.5333
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9774; val_auprc_score: 0.9702; val_best_acc_score: 0.9334; val_best_f1_score: 0.9355; train_kl_reg_loss: 79850.2352; train_edge_recon_loss: 2682823.7882; train_gene_expr_recon_loss: 11234943.5802; train_masked_gp_l1_reg_loss: 116104.1545; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79110.3186; train_chrom_access_recon_loss: 4022802.2023; train_global_loss: 18215634.1679; train_optim_loss: 18215634.1679; val_kl_reg_loss: 80581.0990; val_edge_recon_loss: 2695814.6667; val_gene_expr_recon_loss: 11354902.6000; val_masked_gp_l1_reg_loss: 115888.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78753.1953; val_chrom_access_recon_loss: 4085954.9167; val_global_loss: 18411894.1333; val_optim_loss: 18411894.1333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9772; val_auprc_score: 0.9709; val_best_acc_score: 0.9330; val_best_f1_score: 0.9344; train_kl_reg_loss: 79591.5440; train_edge_recon_loss: 2690290.1279; train_gene_expr_recon_loss: 11236360.4351; train_masked_gp_l1_reg_loss: 115480.5621; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78959.4302; train_chrom_access_recon_loss: 4019614.7290; train_global_loss: 18220296.8550; train_optim_loss: 18220296.8550; val_kl_reg_loss: 79488.4479; val_edge_recon_loss: 2707422.4833; val_gene_expr_recon_loss: 11333562.4667; val_masked_gp_l1_reg_loss: 115441.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79679.7500; val_chrom_access_recon_loss: 4090390.6167; val_global_loss: 18405986.1333; val_optim_loss: 18405986.1333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9758; val_auprc_score: 0.9677; val_best_acc_score: 0.9297; val_best_f1_score: 0.9318; train_kl_reg_loss: 79001.3581; train_edge_recon_loss: 2682979.2137; train_gene_expr_recon_loss: 11221685.2137; train_masked_gp_l1_reg_loss: 115065.0394; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79369.4012; train_chrom_access_recon_loss: 4010148.3416; train_global_loss: 18188248.5038; train_optim_loss: 18188248.5038; val_kl_reg_loss: 79855.8411; val_edge_recon_loss: 2691660.3000; val_gene_expr_recon_loss: 11352231.3333; val_masked_gp_l1_reg_loss: 114776.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79438.0000; val_chrom_access_recon_loss: 4102506.4333; val_global_loss: 18420468.5333; val_optim_loss: 18420468.5333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9789; val_auprc_score: 0.9733; val_best_acc_score: 0.9347; val_best_f1_score: 0.9368; train_kl_reg_loss: 79473.5450; train_edge_recon_loss: 2683046.0286; train_gene_expr_recon_loss: 11226119.0458; train_masked_gp_l1_reg_loss: 114357.8258; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79528.4664; train_chrom_access_recon_loss: 4009960.5611; train_global_loss: 18192485.4962; train_optim_loss: 18192485.4962; val_kl_reg_loss: 82186.1995; val_edge_recon_loss: 2684491.4167; val_gene_expr_recon_loss: 11375729.0000; val_masked_gp_l1_reg_loss: 113998.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79179.8984; val_chrom_access_recon_loss: 4109216.0000; val_global_loss: 18444801.6000; val_optim_loss: 18444801.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9771; val_auprc_score: 0.9711; val_best_acc_score: 0.9337; val_best_f1_score: 0.9363; train_kl_reg_loss: 78493.1907; train_edge_recon_loss: 2683035.1775; train_gene_expr_recon_loss: 11213608.2977; train_masked_gp_l1_reg_loss: 113627.6127; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79551.0721; train_chrom_access_recon_loss: 3995440.7901; train_global_loss: 18163756.0763; train_optim_loss: 18163756.0763; val_kl_reg_loss: 78027.4380; val_edge_recon_loss: 2691207.7500; val_gene_expr_recon_loss: 11325084.8000; val_masked_gp_l1_reg_loss: 113022.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79738.6719; val_chrom_access_recon_loss: 4075289.7500; val_global_loss: 18362370.6667; val_optim_loss: 18362370.6667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9810; val_auprc_score: 0.9765; val_best_acc_score: 0.9396; val_best_f1_score: 0.9412; train_kl_reg_loss: 78803.3502; train_edge_recon_loss: 2684244.6202; train_gene_expr_recon_loss: 11216540.9313; train_masked_gp_l1_reg_loss: 112953.3450; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79653.0076; train_chrom_access_recon_loss: 3994981.4256; train_global_loss: 18167176.6260; train_optim_loss: 18167176.6260; val_kl_reg_loss: 79148.0521; val_edge_recon_loss: 2676519.0833; val_gene_expr_recon_loss: 11365964.6000; val_masked_gp_l1_reg_loss: 113202.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80273.6016; val_chrom_access_recon_loss: 4099852.3500; val_global_loss: 18414960.1333; val_optim_loss: 18414960.1333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9799; val_auprc_score: 0.9738; val_best_acc_score: 0.9375; val_best_f1_score: 0.9395; train_kl_reg_loss: 78101.2193; train_edge_recon_loss: 2681339.1355; train_gene_expr_recon_loss: 11219952.3435; train_masked_gp_l1_reg_loss: 112780.0170; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80113.1501; train_chrom_access_recon_loss: 3993514.4733; train_global_loss: 18165800.3511; train_optim_loss: 18165800.3511; val_kl_reg_loss: 79738.6089; val_edge_recon_loss: 2698717.7833; val_gene_expr_recon_loss: 11381146.8000; val_masked_gp_l1_reg_loss: 112616.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80374.4375; val_chrom_access_recon_loss: 4093743.5000; val_global_loss: 18446337.8667; val_optim_loss: 18446337.8667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9816; val_auprc_score: 0.9768; val_best_acc_score: 0.9422; val_best_f1_score: 0.9437; train_kl_reg_loss: 78335.1811; train_edge_recon_loss: 2679857.9141; train_gene_expr_recon_loss: 11204410.5267; train_masked_gp_l1_reg_loss: 112310.5627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80175.5126; train_chrom_access_recon_loss: 3980468.2385; train_global_loss: 18135557.9237; train_optim_loss: 18135557.9237; val_kl_reg_loss: 78288.7583; val_edge_recon_loss: 2687011.2000; val_gene_expr_recon_loss: 11376764.6000; val_masked_gp_l1_reg_loss: 112389.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80535.3594; val_chrom_access_recon_loss: 4082655.1500; val_global_loss: 18417644.2667; val_optim_loss: 18417644.2667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9807; val_auprc_score: 0.9761; val_best_acc_score: 0.9387; val_best_f1_score: 0.9404; train_kl_reg_loss: 78245.6579; train_edge_recon_loss: 2683304.3416; train_gene_expr_recon_loss: 11189905.5802; train_masked_gp_l1_reg_loss: 111944.3404; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80390.4737; train_chrom_access_recon_loss: 3976589.0592; train_global_loss: 18120379.5344; train_optim_loss: 18120379.5344; val_kl_reg_loss: 78260.4161; val_edge_recon_loss: 2682514.0333; val_gene_expr_recon_loss: 11322704.4667; val_masked_gp_l1_reg_loss: 111901.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80127.2344; val_chrom_access_recon_loss: 4049929.3000; val_global_loss: 18325436.1333; val_optim_loss: 18325436.1333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9803; val_auprc_score: 0.9754; val_best_acc_score: 0.9392; val_best_f1_score: 0.9405; train_kl_reg_loss: 78271.0846; train_edge_recon_loss: 2684960.4561; train_gene_expr_recon_loss: 11196988.1832; train_masked_gp_l1_reg_loss: 111538.3780; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80230.1353; train_chrom_access_recon_loss: 3969833.8454; train_global_loss: 18121821.9313; train_optim_loss: 18121821.9313; val_kl_reg_loss: 80211.8932; val_edge_recon_loss: 2705161.2833; val_gene_expr_recon_loss: 11330276.7333; val_masked_gp_l1_reg_loss: 111759.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80325.1328; val_chrom_access_recon_loss: 4077549.2000; val_global_loss: 18385283.0667; val_optim_loss: 18385283.0667
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9815; val_auprc_score: 0.9745; val_best_acc_score: 0.9426; val_best_f1_score: 0.9442; train_kl_reg_loss: 78755.5886; train_edge_recon_loss: 2674927.8855; train_gene_expr_recon_loss: 11188982.9084; train_masked_gp_l1_reg_loss: 111283.8179; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80407.7730; train_chrom_access_recon_loss: 3966784.8168; train_global_loss: 18101142.7786; train_optim_loss: 18101142.7786; val_kl_reg_loss: 80237.7302; val_edge_recon_loss: 2677185.6167; val_gene_expr_recon_loss: 11302550.0000; val_masked_gp_l1_reg_loss: 111372.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80622.0703; val_chrom_access_recon_loss: 4053994.5667; val_global_loss: 18305962.8000; val_optim_loss: 18305962.8000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9806; val_auprc_score: 0.9730; val_best_acc_score: 0.9388; val_best_f1_score: 0.9399; train_kl_reg_loss: 77619.2671; train_edge_recon_loss: 2679701.9008; train_gene_expr_recon_loss: 11194824.8168; train_masked_gp_l1_reg_loss: 110845.4187; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80609.2550; train_chrom_access_recon_loss: 3961204.0019; train_global_loss: 18104804.6718; train_optim_loss: 18104804.6718; val_kl_reg_loss: 77673.1427; val_edge_recon_loss: 2702203.5667; val_gene_expr_recon_loss: 11296583.5333; val_masked_gp_l1_reg_loss: 111192.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81181.9844; val_chrom_access_recon_loss: 4063378.1000; val_global_loss: 18332212.6667; val_optim_loss: 18332212.6667
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9817; val_auprc_score: 0.9783; val_best_acc_score: 0.9422; val_best_f1_score: 0.9437; train_kl_reg_loss: 78426.3651; train_edge_recon_loss: 2670699.4943; train_gene_expr_recon_loss: 11180969.1756; train_masked_gp_l1_reg_loss: 110616.0898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80677.7746; train_chrom_access_recon_loss: 3952591.2519; train_global_loss: 18073979.9389; train_optim_loss: 18073979.9389; val_kl_reg_loss: 78970.8078; val_edge_recon_loss: 2696291.6333; val_gene_expr_recon_loss: 11312319.2000; val_masked_gp_l1_reg_loss: 110736.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80956.9219; val_chrom_access_recon_loss: 4073184.0000; val_global_loss: 18352459.4667; val_optim_loss: 18352459.4667
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9832; val_auprc_score: 0.9781; val_best_acc_score: 0.9465; val_best_f1_score: 0.9481; train_kl_reg_loss: 78663.1031; train_edge_recon_loss: 2678357.9370; train_gene_expr_recon_loss: 11176800.8855; train_masked_gp_l1_reg_loss: 110493.8396; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80884.0130; train_chrom_access_recon_loss: 3946739.6202; train_global_loss: 18071939.3740; train_optim_loss: 18071939.3740; val_kl_reg_loss: 80375.9828; val_edge_recon_loss: 2683512.1333; val_gene_expr_recon_loss: 11361178.8000; val_masked_gp_l1_reg_loss: 110385.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80630.4531; val_chrom_access_recon_loss: 4090336.3500; val_global_loss: 18406419.2000; val_optim_loss: 18406419.2000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9833; val_auprc_score: 0.9767; val_best_acc_score: 0.9418; val_best_f1_score: 0.9431; train_kl_reg_loss: 78411.6523; train_edge_recon_loss: 2683290.8550; train_gene_expr_recon_loss: 11175671.7023; train_masked_gp_l1_reg_loss: 110024.8802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80996.5268; train_chrom_access_recon_loss: 3950664.3817; train_global_loss: 18079060.0534; train_optim_loss: 18079060.0534; val_kl_reg_loss: 78335.2734; val_edge_recon_loss: 2691963.5167; val_gene_expr_recon_loss: 11329454.4667; val_masked_gp_l1_reg_loss: 109957.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81288.1328; val_chrom_access_recon_loss: 4058399.5167; val_global_loss: 18349398.9333; val_optim_loss: 18349398.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9822; val_auprc_score: 0.9770; val_best_acc_score: 0.9461; val_best_f1_score: 0.9475; train_kl_reg_loss: 78723.4377; train_edge_recon_loss: 2669942.6145; train_gene_expr_recon_loss: 11151309.8244; train_masked_gp_l1_reg_loss: 104106.1882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62042.2241; train_chrom_access_recon_loss: 3924081.7767; train_global_loss: 17990205.9847; train_optim_loss: 17990205.9847; val_kl_reg_loss: 81271.4365; val_edge_recon_loss: 2690708.7333; val_gene_expr_recon_loss: 11367673.1333; val_masked_gp_l1_reg_loss: 102857.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59397.7852; val_chrom_access_recon_loss: 4078511.9167; val_global_loss: 18380420.8000; val_optim_loss: 18380420.8000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9796; val_auprc_score: 0.9737; val_best_acc_score: 0.9402; val_best_f1_score: 0.9419; train_kl_reg_loss: 81037.0299; train_edge_recon_loss: 2673926.6183; train_gene_expr_recon_loss: 11163553.1069; train_masked_gp_l1_reg_loss: 102651.1677; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58938.0202; train_chrom_access_recon_loss: 3926805.2061; train_global_loss: 18006911.2214; train_optim_loss: 18006911.2214; val_kl_reg_loss: 81901.7490; val_edge_recon_loss: 2687711.4000; val_gene_expr_recon_loss: 11313932.4667; val_masked_gp_l1_reg_loss: 102520.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58665.9922; val_chrom_access_recon_loss: 4065422.0167; val_global_loss: 18310154.6667; val_optim_loss: 18310154.6667
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9831; val_auprc_score: 0.9793; val_best_acc_score: 0.9431; val_best_f1_score: 0.9447; train_kl_reg_loss: 81250.4432; train_edge_recon_loss: 2673836.1546; train_gene_expr_recon_loss: 11152708.3511; train_masked_gp_l1_reg_loss: 102427.1084; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58432.2248; train_chrom_access_recon_loss: 3918667.0935; train_global_loss: 17987321.4962; train_optim_loss: 17987321.4962; val_kl_reg_loss: 81852.0714; val_edge_recon_loss: 2687250.8000; val_gene_expr_recon_loss: 11315304.2000; val_masked_gp_l1_reg_loss: 102310.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58168.7383; val_chrom_access_recon_loss: 4072167.4000; val_global_loss: 18317053.3333; val_optim_loss: 18317053.3333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9829; val_auprc_score: 0.9793; val_best_acc_score: 0.9446; val_best_f1_score: 0.9462; train_kl_reg_loss: 81582.8244; train_edge_recon_loss: 2677004.1546; train_gene_expr_recon_loss: 11160660.4885; train_masked_gp_l1_reg_loss: 102269.9021; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58023.2381; train_chrom_access_recon_loss: 3925873.6031; train_global_loss: 18005414.2901; train_optim_loss: 18005414.2901; val_kl_reg_loss: 82372.3729; val_edge_recon_loss: 2676752.9000; val_gene_expr_recon_loss: 11317449.3333; val_masked_gp_l1_reg_loss: 102214.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57832.9375; val_chrom_access_recon_loss: 4033211.3833; val_global_loss: 18269833.2000; val_optim_loss: 18269833.2000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9826; val_auprc_score: 0.9758; val_best_acc_score: 0.9462; val_best_f1_score: 0.9472; train_kl_reg_loss: 81343.0355; train_edge_recon_loss: 2668698.4828; train_gene_expr_recon_loss: 11147283.0153; train_masked_gp_l1_reg_loss: 102110.9755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57704.6688; train_chrom_access_recon_loss: 3917370.8702; train_global_loss: 17974510.8855; train_optim_loss: 17974510.8855; val_kl_reg_loss: 82123.7922; val_edge_recon_loss: 2692536.4833; val_gene_expr_recon_loss: 11300815.4667; val_masked_gp_l1_reg_loss: 102109.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57620.7539; val_chrom_access_recon_loss: 4033653.0167; val_global_loss: 18268858.6667; val_optim_loss: 18268858.6667
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9842; val_auprc_score: 0.9800; val_best_acc_score: 0.9462; val_best_f1_score: 0.9480; train_kl_reg_loss: 82140.2913; train_edge_recon_loss: 2663565.5076; train_gene_expr_recon_loss: 11153661.0076; train_masked_gp_l1_reg_loss: 102033.3308; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57390.4679; train_chrom_access_recon_loss: 3917502.9466; train_global_loss: 17976293.5802; train_optim_loss: 17976293.5802; val_kl_reg_loss: 83101.0151; val_edge_recon_loss: 2683783.5167; val_gene_expr_recon_loss: 11251051.6000; val_masked_gp_l1_reg_loss: 101988.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57296.3281; val_chrom_access_recon_loss: 4027378.0333; val_global_loss: 18204599.3333; val_optim_loss: 18204599.3333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9828; val_auprc_score: 0.9774; val_best_acc_score: 0.9446; val_best_f1_score: 0.9465; train_kl_reg_loss: 82327.0479; train_edge_recon_loss: 2673376.1584; train_gene_expr_recon_loss: 11160039.8015; train_masked_gp_l1_reg_loss: 101927.5841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57188.8887; train_chrom_access_recon_loss: 3919709.9637; train_global_loss: 17994569.4656; train_optim_loss: 17994569.4656; val_kl_reg_loss: 83201.6203; val_edge_recon_loss: 2687833.5333; val_gene_expr_recon_loss: 11259353.9333; val_masked_gp_l1_reg_loss: 101885.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57072.1523; val_chrom_access_recon_loss: 4049783.6333; val_global_loss: 18239129.8667; val_optim_loss: 18239129.8667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9840; val_auprc_score: 0.9789; val_best_acc_score: 0.9483; val_best_f1_score: 0.9497; train_kl_reg_loss: 82433.7440; train_edge_recon_loss: 2667201.0000; train_gene_expr_recon_loss: 11157230.4885; train_masked_gp_l1_reg_loss: 101843.7086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56933.9730; train_chrom_access_recon_loss: 3917823.5496; train_global_loss: 17983466.4427; train_optim_loss: 17983466.4427; val_kl_reg_loss: 82286.4750; val_edge_recon_loss: 2667053.9167; val_gene_expr_recon_loss: 11354489.7333; val_masked_gp_l1_reg_loss: 101736.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56669.5742; val_chrom_access_recon_loss: 4055928.8333; val_global_loss: 18318165.0667; val_optim_loss: 18318165.0667
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9828; val_auprc_score: 0.9783; val_best_acc_score: 0.9458; val_best_f1_score: 0.9476; train_kl_reg_loss: 82013.6011; train_edge_recon_loss: 2666542.1775; train_gene_expr_recon_loss: 11142277.7634; train_masked_gp_l1_reg_loss: 101708.9912; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56647.6693; train_chrom_access_recon_loss: 3914174.6565; train_global_loss: 17963364.7786; train_optim_loss: 17963364.7786; val_kl_reg_loss: 82955.0260; val_edge_recon_loss: 2672604.5667; val_gene_expr_recon_loss: 11321218.8000; val_masked_gp_l1_reg_loss: 101668.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56505.9258; val_chrom_access_recon_loss: 4051378.7000; val_global_loss: 18286331.0667; val_optim_loss: 18286331.0667
Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9855; val_auprc_score: 0.9813; val_best_acc_score: 0.9460; val_best_f1_score: 0.9472; train_kl_reg_loss: 81165.9307; train_edge_recon_loss: 2674354.0191; train_gene_expr_recon_loss: 11147759.4580; train_masked_gp_l1_reg_loss: 101603.8596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56452.9883; train_chrom_access_recon_loss: 3913286.3111; train_global_loss: 17974622.4427; train_optim_loss: 17974622.4427; val_kl_reg_loss: 82403.5458; val_edge_recon_loss: 2696649.0333; val_gene_expr_recon_loss: 11337356.8667; val_masked_gp_l1_reg_loss: 101624.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56414.7422; val_chrom_access_recon_loss: 4059089.4333; val_global_loss: 18333538.9333; val_optim_loss: 18333538.9333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9832; val_auprc_score: 0.9781; val_best_acc_score: 0.9460; val_best_f1_score: 0.9473; train_kl_reg_loss: 81437.0559; train_edge_recon_loss: 2666596.9427; train_gene_expr_recon_loss: 11152432.8931; train_masked_gp_l1_reg_loss: 101002.2861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54509.6813; train_chrom_access_recon_loss: 3910773.9828; train_global_loss: 17966752.9084; train_optim_loss: 17966752.9084; val_kl_reg_loss: 82399.6464; val_edge_recon_loss: 2699957.0333; val_gene_expr_recon_loss: 11258505.3333; val_masked_gp_l1_reg_loss: 100833.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54232.6758; val_chrom_access_recon_loss: 4048696.3833; val_global_loss: 18244624.4000; val_optim_loss: 18244624.4000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9842; val_auprc_score: 0.9767; val_best_acc_score: 0.9437; val_best_f1_score: 0.9456; train_kl_reg_loss: 81574.8969; train_edge_recon_loss: 2671288.0229; train_gene_expr_recon_loss: 11148856.2748; train_masked_gp_l1_reg_loss: 100795.4562; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54159.7395; train_chrom_access_recon_loss: 3910645.6698; train_global_loss: 17967320.0076; train_optim_loss: 17967320.0076; val_kl_reg_loss: 82387.1745; val_edge_recon_loss: 2683185.4667; val_gene_expr_recon_loss: 11295632.1333; val_masked_gp_l1_reg_loss: 100762.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54105.9883; val_chrom_access_recon_loss: 4038020.5833; val_global_loss: 18254093.2000; val_optim_loss: 18254093.2000
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9845; val_auprc_score: 0.9771; val_best_acc_score: 0.9512; val_best_f1_score: 0.9522; train_kl_reg_loss: 81656.5940; train_edge_recon_loss: 2676970.4447; train_gene_expr_recon_loss: 11151203.4046; train_masked_gp_l1_reg_loss: 100744.0526; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54062.1824; train_chrom_access_recon_loss: 3916772.6164; train_global_loss: 17981409.2519; train_optim_loss: 17981409.2519; val_kl_reg_loss: 82912.8990; val_edge_recon_loss: 2667315.4833; val_gene_expr_recon_loss: 11324605.8667; val_masked_gp_l1_reg_loss: 100727.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54031.7305; val_chrom_access_recon_loss: 4058392.8000; val_global_loss: 18287985.8667; val_optim_loss: 18287985.8667
Epoch 64/400 |███-----------------| 16.0% val_auroc_score: 0.9830; val_auprc_score: 0.9788; val_best_acc_score: 0.9419; val_best_f1_score: 0.9434; train_kl_reg_loss: 81771.6946; train_edge_recon_loss: 2674655.2844; train_gene_expr_recon_loss: 11156738.3282; train_masked_gp_l1_reg_loss: 100718.4767; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54001.4146; train_chrom_access_recon_loss: 3915661.0763; train_global_loss: 17983546.3359; train_optim_loss: 17983546.3359; val_kl_reg_loss: 82291.1318; val_edge_recon_loss: 2690898.2500; val_gene_expr_recon_loss: 11322907.6000; val_masked_gp_l1_reg_loss: 100702.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53975.2188; val_chrom_access_recon_loss: 4040441.0167; val_global_loss: 18291215.8667; val_optim_loss: 18291215.8667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 58 min 39 sec.
Using best model state, which was in epoch 56.

--- MODEL EVALUATION ---
val AUROC score: 0.9831
val AUPRC score: 0.9776
val best accuracy score: 0.9442
val best F1 score: 0.9453
val target rna MSE score: 1.1946
val source rna MSE score: 0.4203
val target atac MSE score: 0.5014
val source atac MSE score: 0.1311
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
