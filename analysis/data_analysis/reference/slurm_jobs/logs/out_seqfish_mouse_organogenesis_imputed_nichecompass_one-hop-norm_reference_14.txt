[True]
Run timestamp: 07082024_105225_14.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--no-include_omnipath_gps', '--no-include_nichenet_gps', '--include_mebocost_gps', '--no-include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--seed', '0', '--timestamp_suffix', '_14']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 115.
Number of gene programs after filtering and combining: 94.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 177, n_latent: 77, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 77, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 77, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8783; val_auprc_score: 0.9748; val_best_acc_score: 0.8795; val_best_f1_score: 0.9326; train_kl_reg_loss: 18636.0176; train_edge_recon_loss: 976471.5182; train_gene_expr_recon_loss: 42958380.2915; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 43953487.8710; train_optim_loss: 43953487.8710; val_kl_reg_loss: 18302.3473; val_edge_recon_loss: 889537.4469; val_gene_expr_recon_loss: 39013508.1720; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39921348.1290; val_optim_loss: 39921348.1290
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9078; val_auprc_score: 0.9812; val_best_acc_score: 0.9027; val_best_f1_score: 0.9451; train_kl_reg_loss: 17992.2467; train_edge_recon_loss: 846333.5650; train_gene_expr_recon_loss: 37176058.2700; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38040384.0908; train_optim_loss: 38040384.0908; val_kl_reg_loss: 17094.1656; val_edge_recon_loss: 830384.6949; val_gene_expr_recon_loss: 35636206.1075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36483685.0753; val_optim_loss: 36483685.0753
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9245; val_auprc_score: 0.9832; val_best_acc_score: 0.9176; val_best_f1_score: 0.9528; train_kl_reg_loss: 16055.1958; train_edge_recon_loss: 821909.5576; train_gene_expr_recon_loss: 34409946.1362; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35247910.9295; train_optim_loss: 35247910.9295; val_kl_reg_loss: 15610.8371; val_edge_recon_loss: 825383.0726; val_gene_expr_recon_loss: 33372935.6129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34213929.5914; val_optim_loss: 34213929.5914
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9323; val_auprc_score: 0.9857; val_best_acc_score: 0.9207; val_best_f1_score: 0.9542; train_kl_reg_loss: 15116.6626; train_edge_recon_loss: 811442.1108; train_gene_expr_recon_loss: 32579339.4695; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 33405898.2461; train_optim_loss: 33405898.2461; val_kl_reg_loss: 14468.4299; val_edge_recon_loss: 820331.1431; val_gene_expr_recon_loss: 31876292.1075; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32711091.7419; val_optim_loss: 32711091.7419
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9376; val_auprc_score: 0.9864; val_best_acc_score: 0.9261; val_best_f1_score: 0.9575; train_kl_reg_loss: 13455.3548; train_edge_recon_loss: 806911.3187; train_gene_expr_recon_loss: 31351822.8053; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32172189.4552; train_optim_loss: 32172189.4552; val_kl_reg_loss: 12356.9969; val_edge_recon_loss: 829430.1909; val_gene_expr_recon_loss: 30947885.9570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31789673.2043; val_optim_loss: 31789673.2043
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9509; val_auprc_score: 0.9891; val_best_acc_score: 0.9362; val_best_f1_score: 0.9633; train_kl_reg_loss: 11830.4992; train_edge_recon_loss: 797150.2936; train_gene_expr_recon_loss: 30529532.6786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31338513.4624; train_optim_loss: 31338513.4624; val_kl_reg_loss: 11445.4851; val_edge_recon_loss: 790199.8602; val_gene_expr_recon_loss: 30253994.0645; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31055639.4624; val_optim_loss: 31055639.4624
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9519; val_auprc_score: 0.9897; val_best_acc_score: 0.9404; val_best_f1_score: 0.9657; train_kl_reg_loss: 10566.8072; train_edge_recon_loss: 793815.2151; train_gene_expr_recon_loss: 29978813.9068; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30783195.9235; train_optim_loss: 30783195.9235; val_kl_reg_loss: 10110.4383; val_edge_recon_loss: 794120.7211; val_gene_expr_recon_loss: 29858229.5054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30662460.6452; val_optim_loss: 30662460.6452
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9599; val_auprc_score: 0.9916; val_best_acc_score: 0.9449; val_best_f1_score: 0.9681; train_kl_reg_loss: 9493.4229; train_edge_recon_loss: 783445.5085; train_gene_expr_recon_loss: 29611834.4755; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30404773.3740; train_optim_loss: 30404773.3740; val_kl_reg_loss: 8904.7056; val_edge_recon_loss: 792237.0087; val_gene_expr_recon_loss: 29592986.7527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30394128.4731; val_optim_loss: 30394128.4731
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9618; val_auprc_score: 0.9909; val_best_acc_score: 0.9476; val_best_f1_score: 0.9698; train_kl_reg_loss: 8457.6383; train_edge_recon_loss: 791475.2436; train_gene_expr_recon_loss: 29365773.0848; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30165706.0119; train_optim_loss: 30165706.0119; val_kl_reg_loss: 8056.6137; val_edge_recon_loss: 785823.0289; val_gene_expr_recon_loss: 29308659.5054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30102539.1613; val_optim_loss: 30102539.1613
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9608; val_auprc_score: 0.9908; val_best_acc_score: 0.9482; val_best_f1_score: 0.9701; train_kl_reg_loss: 7683.0485; train_edge_recon_loss: 777352.3595; train_gene_expr_recon_loss: 29208126.9821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29993162.4014; train_optim_loss: 29993162.4014; val_kl_reg_loss: 7463.2941; val_edge_recon_loss: 793924.1297; val_gene_expr_recon_loss: 29121218.7742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29922606.1290; val_optim_loss: 29922606.1290
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9659; val_auprc_score: 0.9921; val_best_acc_score: 0.9542; val_best_f1_score: 0.9733; train_kl_reg_loss: 7170.3866; train_edge_recon_loss: 771148.4524; train_gene_expr_recon_loss: 29093820.9845; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29872139.8088; train_optim_loss: 29872139.8088; val_kl_reg_loss: 6959.8279; val_edge_recon_loss: 797588.7742; val_gene_expr_recon_loss: 29026261.2043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29830809.7419; val_optim_loss: 29830809.7419
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9681; val_auprc_score: 0.9929; val_best_acc_score: 0.9532; val_best_f1_score: 0.9729; train_kl_reg_loss: 6730.6323; train_edge_recon_loss: 774480.9050; train_gene_expr_recon_loss: 29012479.7443; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29793691.2545; train_optim_loss: 29793691.2545; val_kl_reg_loss: 6645.9787; val_edge_recon_loss: 782661.2426; val_gene_expr_recon_loss: 29052582.9247; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29841890.1720; val_optim_loss: 29841890.1720
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9692; val_auprc_score: 0.9932; val_best_acc_score: 0.9538; val_best_f1_score: 0.9732; train_kl_reg_loss: 6376.2455; train_edge_recon_loss: 782488.1174; train_gene_expr_recon_loss: 28963124.0048; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29751988.3513; train_optim_loss: 29751988.3513; val_kl_reg_loss: 6334.8318; val_edge_recon_loss: 789585.3938; val_gene_expr_recon_loss: 29023984.1290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29819904.4086; val_optim_loss: 29819904.4086
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9729; val_auprc_score: 0.9937; val_best_acc_score: 0.9589; val_best_f1_score: 0.9762; train_kl_reg_loss: 6089.0123; train_edge_recon_loss: 780314.0958; train_gene_expr_recon_loss: 28922023.2258; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29708426.3393; train_optim_loss: 29708426.3393; val_kl_reg_loss: 6033.7114; val_edge_recon_loss: 768882.1190; val_gene_expr_recon_loss: 28889907.0968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29664822.9677; val_optim_loss: 29664822.9677
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9726; val_auprc_score: 0.9940; val_best_acc_score: 0.9585; val_best_f1_score: 0.9758; train_kl_reg_loss: 5871.5805; train_edge_recon_loss: 767586.5842; train_gene_expr_recon_loss: 28889298.7455; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29662756.9367; train_optim_loss: 29662756.9367; val_kl_reg_loss: 5944.8886; val_edge_recon_loss: 790149.5524; val_gene_expr_recon_loss: 28895507.5484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29691601.9570; val_optim_loss: 29691601.9570
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9728; val_auprc_score: 0.9939; val_best_acc_score: 0.9620; val_best_f1_score: 0.9780; train_kl_reg_loss: 5708.8362; train_edge_recon_loss: 770193.8688; train_gene_expr_recon_loss: 28869238.2103; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29645140.9654; train_optim_loss: 29645140.9654; val_kl_reg_loss: 5843.1278; val_edge_recon_loss: 782501.7997; val_gene_expr_recon_loss: 28934584.3656; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29722929.2258; val_optim_loss: 29722929.2258
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9722; val_auprc_score: 0.9938; val_best_acc_score: 0.9589; val_best_f1_score: 0.9761; train_kl_reg_loss: 5584.9198; train_edge_recon_loss: 771452.2356; train_gene_expr_recon_loss: 28854466.1553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29631503.3214; train_optim_loss: 29631503.3214; val_kl_reg_loss: 5547.4765; val_edge_recon_loss: 785116.3199; val_gene_expr_recon_loss: 28828537.7849; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29619201.5484; val_optim_loss: 29619201.5484
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9772; val_auprc_score: 0.9950; val_best_acc_score: 0.9636; val_best_f1_score: 0.9788; train_kl_reg_loss: 5439.0278; train_edge_recon_loss: 768553.8590; train_gene_expr_recon_loss: 28839798.9295; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29613791.8136; train_optim_loss: 29613791.8136; val_kl_reg_loss: 5469.3346; val_edge_recon_loss: 785341.5215; val_gene_expr_recon_loss: 28916015.8280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29706826.6667; val_optim_loss: 29706826.6667
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9763; val_auprc_score: 0.9948; val_best_acc_score: 0.9638; val_best_f1_score: 0.9789; train_kl_reg_loss: 5302.2773; train_edge_recon_loss: 773151.4413; train_gene_expr_recon_loss: 28833624.7694; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29612078.4922; train_optim_loss: 29612078.4922; val_kl_reg_loss: 5361.1046; val_edge_recon_loss: 782067.1122; val_gene_expr_recon_loss: 28843262.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29630690.9247; val_optim_loss: 29630690.9247
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9742; val_auprc_score: 0.9935; val_best_acc_score: 0.9620; val_best_f1_score: 0.9779; train_kl_reg_loss: 5254.9433; train_edge_recon_loss: 763703.1232; train_gene_expr_recon_loss: 28824842.4229; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29593800.5042; train_optim_loss: 29593800.5042; val_kl_reg_loss: 5186.0122; val_edge_recon_loss: 788713.8313; val_gene_expr_recon_loss: 28865604.0215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29659503.8925; val_optim_loss: 29659503.8925
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9768; val_auprc_score: 0.9949; val_best_acc_score: 0.9630; val_best_f1_score: 0.9784; train_kl_reg_loss: 5207.7366; train_edge_recon_loss: 765473.6010; train_gene_expr_recon_loss: 28826325.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29597007.3238; train_optim_loss: 29597007.3238; val_kl_reg_loss: 5234.4688; val_edge_recon_loss: 760276.7440; val_gene_expr_recon_loss: 28802690.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29568201.5699; val_optim_loss: 29568201.5699
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9751; val_auprc_score: 0.9938; val_best_acc_score: 0.9625; val_best_f1_score: 0.9782; train_kl_reg_loss: 5141.2265; train_edge_recon_loss: 767638.5260; train_gene_expr_recon_loss: 28816411.8065; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29589191.5651; train_optim_loss: 29589191.5651; val_kl_reg_loss: 5084.5256; val_edge_recon_loss: 792144.3427; val_gene_expr_recon_loss: 28853488.3441; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29650717.3118; val_optim_loss: 29650717.3118
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9787; val_auprc_score: 0.9955; val_best_acc_score: 0.9634; val_best_f1_score: 0.9787; train_kl_reg_loss: 5063.1564; train_edge_recon_loss: 761674.7827; train_gene_expr_recon_loss: 28811186.1195; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29577924.0908; train_optim_loss: 29577924.0908; val_kl_reg_loss: 5080.8331; val_edge_recon_loss: 775884.1566; val_gene_expr_recon_loss: 28794914.1290; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29575879.1183; val_optim_loss: 29575879.1183
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9742; val_auprc_score: 0.9933; val_best_acc_score: 0.9630; val_best_f1_score: 0.9785; train_kl_reg_loss: 4999.9751; train_edge_recon_loss: 765576.2610; train_gene_expr_recon_loss: 28808574.9606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29579151.1947; train_optim_loss: 29579151.1947; val_kl_reg_loss: 4978.6612; val_edge_recon_loss: 777926.8784; val_gene_expr_recon_loss: 28834078.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29616983.9570; val_optim_loss: 29616983.9570
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9762; val_auprc_score: 0.9949; val_best_acc_score: 0.9622; val_best_f1_score: 0.9780; train_kl_reg_loss: 4945.6766; train_edge_recon_loss: 763730.0548; train_gene_expr_recon_loss: 28813252.9821; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29581928.6834; train_optim_loss: 29581928.6834; val_kl_reg_loss: 5140.3304; val_edge_recon_loss: 770593.2806; val_gene_expr_recon_loss: 28884127.4409; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29659860.9677; val_optim_loss: 29659860.9677

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9759; val_auprc_score: 0.9942; val_best_acc_score: 0.9652; val_best_f1_score: 0.9797; train_kl_reg_loss: 5003.9233; train_edge_recon_loss: 762342.8949; train_gene_expr_recon_loss: 28752484.6547; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29519831.4695; train_optim_loss: 29519831.4695; val_kl_reg_loss: 4936.4113; val_edge_recon_loss: 782236.2483; val_gene_expr_recon_loss: 28743678.0430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29530850.8172; val_optim_loss: 29530850.8172
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9793; val_auprc_score: 0.9953; val_best_acc_score: 0.9682; val_best_f1_score: 0.9815; train_kl_reg_loss: 4938.6645; train_edge_recon_loss: 761193.1832; train_gene_expr_recon_loss: 28745556.2461; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29511688.1004; train_optim_loss: 29511688.1004; val_kl_reg_loss: 4878.9867; val_edge_recon_loss: 760032.5988; val_gene_expr_recon_loss: 28751932.8602; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29516844.3871; val_optim_loss: 29516844.3871
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9777; val_auprc_score: 0.9948; val_best_acc_score: 0.9645; val_best_f1_score: 0.9793; train_kl_reg_loss: 4917.3962; train_edge_recon_loss: 765970.6046; train_gene_expr_recon_loss: 28746230.4851; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29517118.5114; train_optim_loss: 29517118.5114; val_kl_reg_loss: 4898.7042; val_edge_recon_loss: 786764.6478; val_gene_expr_recon_loss: 28750008.7527; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29541672.1505; val_optim_loss: 29541672.1505
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9783; val_auprc_score: 0.9951; val_best_acc_score: 0.9673; val_best_f1_score: 0.9810; train_kl_reg_loss: 4922.0840; train_edge_recon_loss: 763706.7263; train_gene_expr_recon_loss: 28745497.1517; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29514125.9689; train_optim_loss: 29514125.9689; val_kl_reg_loss: 4886.4360; val_edge_recon_loss: 770521.1687; val_gene_expr_recon_loss: 28749464.6882; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29524872.3656; val_optim_loss: 29524872.3656
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9762; val_auprc_score: 0.9944; val_best_acc_score: 0.9653; val_best_f1_score: 0.9797; train_kl_reg_loss: 4928.3490; train_edge_recon_loss: 767596.4870; train_gene_expr_recon_loss: 28743247.6249; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29515772.4731; train_optim_loss: 29515772.4731; val_kl_reg_loss: 4915.3839; val_edge_recon_loss: 786164.3810; val_gene_expr_recon_loss: 28747687.5484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29538767.2903; val_optim_loss: 29538767.2903
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9769; val_auprc_score: 0.9947; val_best_acc_score: 0.9670; val_best_f1_score: 0.9809; train_kl_reg_loss: 4949.5926; train_edge_recon_loss: 764319.6588; train_gene_expr_recon_loss: 28743133.5938; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29512402.8698; train_optim_loss: 29512402.8698; val_kl_reg_loss: 4926.8279; val_edge_recon_loss: 766126.3750; val_gene_expr_recon_loss: 28746683.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29517737.0108; val_optim_loss: 29517737.0108

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9794; val_auprc_score: 0.9950; val_best_acc_score: 0.9681; val_best_f1_score: 0.9815; train_kl_reg_loss: 4949.3844; train_edge_recon_loss: 767556.5944; train_gene_expr_recon_loss: 28735699.0633; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29508205.0155; train_optim_loss: 29508205.0155; val_kl_reg_loss: 4907.0932; val_edge_recon_loss: 769476.3286; val_gene_expr_recon_loss: 28749709.1398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29524092.4731; val_optim_loss: 29524092.4731
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9791; val_auprc_score: 0.9952; val_best_acc_score: 0.9672; val_best_f1_score: 0.9809; train_kl_reg_loss: 4948.6586; train_edge_recon_loss: 768071.0581; train_gene_expr_recon_loss: 28736163.0777; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29509182.8244; train_optim_loss: 29509182.8244; val_kl_reg_loss: 4905.7854; val_edge_recon_loss: 770795.8401; val_gene_expr_recon_loss: 28735831.1828; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29511532.8172; val_optim_loss: 29511532.8172
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9762; val_auprc_score: 0.9943; val_best_acc_score: 0.9675; val_best_f1_score: 0.9811; train_kl_reg_loss: 4943.5871; train_edge_recon_loss: 766641.7779; train_gene_expr_recon_loss: 28734362.2151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29505947.5747; train_optim_loss: 29505947.5747; val_kl_reg_loss: 4907.3655; val_edge_recon_loss: 777772.3401; val_gene_expr_recon_loss: 28749735.3548; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29532415.0323; val_optim_loss: 29532415.0323
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9771; val_auprc_score: 0.9948; val_best_acc_score: 0.9671; val_best_f1_score: 0.9809; train_kl_reg_loss: 4936.3216; train_edge_recon_loss: 764381.8012; train_gene_expr_recon_loss: 28733897.8375; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29503215.9785; train_optim_loss: 29503215.9785; val_kl_reg_loss: 4903.0063; val_edge_recon_loss: 775532.2537; val_gene_expr_recon_loss: 28745825.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29526260.6237; val_optim_loss: 29526260.6237
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9797; val_auprc_score: 0.9952; val_best_acc_score: 0.9695; val_best_f1_score: 0.9822; train_kl_reg_loss: 4932.8766; train_edge_recon_loss: 765827.0752; train_gene_expr_recon_loss: 28736272.6619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29507032.6547; train_optim_loss: 29507032.6547; val_kl_reg_loss: 4888.1608; val_edge_recon_loss: 784538.8078; val_gene_expr_recon_loss: 28746781.6774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29536208.7527; val_optim_loss: 29536208.7527
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9774; val_auprc_score: 0.9945; val_best_acc_score: 0.9661; val_best_f1_score: 0.9803; train_kl_reg_loss: 4932.1405; train_edge_recon_loss: 763482.6243; train_gene_expr_recon_loss: 28739105.1470; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29507519.9235; train_optim_loss: 29507519.9235; val_kl_reg_loss: 4895.0928; val_edge_recon_loss: 774951.9691; val_gene_expr_recon_loss: 28735619.8710; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29515466.9247; val_optim_loss: 29515466.9247

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9780; val_auprc_score: 0.9946; val_best_acc_score: 0.9678; val_best_f1_score: 0.9812; train_kl_reg_loss: 4933.6536; train_edge_recon_loss: 767963.5488; train_gene_expr_recon_loss: 28733389.4313; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29506286.6452; train_optim_loss: 29506286.6452; val_kl_reg_loss: 4886.3188; val_edge_recon_loss: 758316.5185; val_gene_expr_recon_loss: 28731846.3226; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29495049.1183; val_optim_loss: 29495049.1183
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9768; val_auprc_score: 0.9946; val_best_acc_score: 0.9670; val_best_f1_score: 0.9808; train_kl_reg_loss: 4932.2722; train_edge_recon_loss: 764490.3308; train_gene_expr_recon_loss: 28731828.3011; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29501250.9223; train_optim_loss: 29501250.9223; val_kl_reg_loss: 4900.3824; val_edge_recon_loss: 775662.5161; val_gene_expr_recon_loss: 28742177.5914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29522740.4516; val_optim_loss: 29522740.4516
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9762; val_auprc_score: 0.9943; val_best_acc_score: 0.9688; val_best_f1_score: 0.9819; train_kl_reg_loss: 4932.4517; train_edge_recon_loss: 767065.3769; train_gene_expr_recon_loss: 28733832.0382; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29505829.8590; train_optim_loss: 29505829.8590; val_kl_reg_loss: 4896.7948; val_edge_recon_loss: 767584.5847; val_gene_expr_recon_loss: 28750462.3011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29522943.6344; val_optim_loss: 29522943.6344
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9780; val_auprc_score: 0.9947; val_best_acc_score: 0.9675; val_best_f1_score: 0.9810; train_kl_reg_loss: 4935.2276; train_edge_recon_loss: 761556.5210; train_gene_expr_recon_loss: 28736688.9056; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29503180.6667; train_optim_loss: 29503180.6667; val_kl_reg_loss: 4903.8598; val_edge_recon_loss: 782781.8562; val_gene_expr_recon_loss: 28737398.8172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29525084.5591; val_optim_loss: 29525084.5591
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9791; val_auprc_score: 0.9955; val_best_acc_score: 0.9682; val_best_f1_score: 0.9816; train_kl_reg_loss: 4937.9833; train_edge_recon_loss: 759792.2459; train_gene_expr_recon_loss: 28733230.5783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29497960.8339; train_optim_loss: 29497960.8339; val_kl_reg_loss: 4894.0962; val_edge_recon_loss: 753589.5296; val_gene_expr_recon_loss: 28749257.6774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29507741.2473; val_optim_loss: 29507741.2473

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9774; val_auprc_score: 0.9944; val_best_acc_score: 0.9665; val_best_f1_score: 0.9805; train_kl_reg_loss: 4939.6698; train_edge_recon_loss: 770285.4618; train_gene_expr_recon_loss: 28734286.6810; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29509511.7969; train_optim_loss: 29509511.7969; val_kl_reg_loss: 4903.1935; val_edge_recon_loss: 771452.6069; val_gene_expr_recon_loss: 28739827.3978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29516183.2473; val_optim_loss: 29516183.2473
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9783; val_auprc_score: 0.9952; val_best_acc_score: 0.9663; val_best_f1_score: 0.9804; train_kl_reg_loss: 4935.8745; train_edge_recon_loss: 760824.6597; train_gene_expr_recon_loss: 28734002.6595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29499763.1995; train_optim_loss: 29499763.1995; val_kl_reg_loss: 4890.6042; val_edge_recon_loss: 775091.8898; val_gene_expr_recon_loss: 28746806.4516; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29526788.9247; val_optim_loss: 29526788.9247
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9772; val_auprc_score: 0.9946; val_best_acc_score: 0.9673; val_best_f1_score: 0.9809; train_kl_reg_loss: 4933.3246; train_edge_recon_loss: 765500.4191; train_gene_expr_recon_loss: 28732994.3106; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29503428.0717; train_optim_loss: 29503428.0717; val_kl_reg_loss: 4909.6700; val_edge_recon_loss: 770161.6734; val_gene_expr_recon_loss: 28739856.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29514928.0215; val_optim_loss: 29514928.0215
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9768; val_auprc_score: 0.9941; val_best_acc_score: 0.9682; val_best_f1_score: 0.9814; train_kl_reg_loss: 4936.7852; train_edge_recon_loss: 764219.5856; train_gene_expr_recon_loss: 28735276.9677; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29504433.3357; train_optim_loss: 29504433.3357; val_kl_reg_loss: 4908.5954; val_edge_recon_loss: 776859.9325; val_gene_expr_recon_loss: 28731994.7742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29513763.3333; val_optim_loss: 29513763.3333

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 37 min 57 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9776
val AUPRC score: 0.9949
val best accuracy score: 0.9669
val best F1 score: 0.9808
val target rna MSE score: 0.7741
val source rna MSE score: 0.4312
Val cat covariate0 mean sim diff: -0.0016

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
