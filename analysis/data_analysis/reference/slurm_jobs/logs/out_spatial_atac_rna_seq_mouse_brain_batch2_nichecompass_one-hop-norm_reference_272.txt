[True]
Run timestamp: 10102023_125715_272.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_272']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6647; val_auprc_score: 0.6456; val_best_acc_score: 0.5161; val_best_f1_score: 0.6721; train_kl_reg_loss: 60193.4004; train_edge_recon_loss: 746579.3741; train_gene_expr_recon_loss: 23100066.4848; train_masked_gp_l1_reg_loss: 142383.8142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5045159.1250; train_chrom_access_recon_loss: 11516410.7121; train_global_loss: 40610793.0909; train_optim_loss: 40610793.0909; val_kl_reg_loss: 107849.2412; val_edge_recon_loss: 812853.7500; val_gene_expr_recon_loss: 21187567.7500; val_masked_gp_l1_reg_loss: 104893.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2890000.7500; val_chrom_access_recon_loss: 10916216.6250; val_global_loss: 36019381.5000; val_optim_loss: 36019381.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.7013; val_auprc_score: 0.6928; val_best_acc_score: 0.5844; val_best_f1_score: 0.6952; train_kl_reg_loss: 97893.1249; train_edge_recon_loss: 752645.7188; train_gene_expr_recon_loss: 21246252.4848; train_masked_gp_l1_reg_loss: 97942.5466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1628781.5237; train_chrom_access_recon_loss: 11008857.5303; train_global_loss: 34832372.9697; train_optim_loss: 34832372.9697; val_kl_reg_loss: 86632.7891; val_edge_recon_loss: 812123.2188; val_gene_expr_recon_loss: 21146876.5000; val_masked_gp_l1_reg_loss: 94835.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 823435.6875; val_chrom_access_recon_loss: 10976255.7500; val_global_loss: 33940160.2500; val_optim_loss: 33940160.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7746; val_auprc_score: 0.7625; val_best_acc_score: 0.7010; val_best_f1_score: 0.7222; train_kl_reg_loss: 90212.8055; train_edge_recon_loss: 744285.7746; train_gene_expr_recon_loss: 21053316.0303; train_masked_gp_l1_reg_loss: 94111.4845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 551058.2699; train_chrom_access_recon_loss: 10940306.0758; train_global_loss: 33473290.2727; train_optim_loss: 33473290.2727; val_kl_reg_loss: 82638.7559; val_edge_recon_loss: 807735.2266; val_gene_expr_recon_loss: 20738366.7500; val_masked_gp_l1_reg_loss: 94416.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 371335.1875; val_chrom_access_recon_loss: 10809644.3750; val_global_loss: 32904137.0000; val_optim_loss: 32904137.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8542; val_auprc_score: 0.8332; val_best_acc_score: 0.7595; val_best_f1_score: 0.7905; train_kl_reg_loss: 82444.3846; train_edge_recon_loss: 736646.6771; train_gene_expr_recon_loss: 20881492.0303; train_masked_gp_l1_reg_loss: 95888.3263; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 294269.6117; train_chrom_access_recon_loss: 10847338.3333; train_global_loss: 32938079.7273; train_optim_loss: 32938079.7273; val_kl_reg_loss: 76289.2295; val_edge_recon_loss: 789901.2891; val_gene_expr_recon_loss: 20470585.2500; val_masked_gp_l1_reg_loss: 97466.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 238764.3594; val_chrom_access_recon_loss: 10589141.1250; val_global_loss: 32262147.2500; val_optim_loss: 32262147.2500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8778; val_auprc_score: 0.8478; val_best_acc_score: 0.8079; val_best_f1_score: 0.8245; train_kl_reg_loss: 76893.4218; train_edge_recon_loss: 721280.6544; train_gene_expr_recon_loss: 20747442.6970; train_masked_gp_l1_reg_loss: 99371.6847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 211884.7682; train_chrom_access_recon_loss: 10788658.2273; train_global_loss: 32645531.1515; train_optim_loss: 32645531.1515; val_kl_reg_loss: 86887.7949; val_edge_recon_loss: 738720.4766; val_gene_expr_recon_loss: 20500450.0000; val_masked_gp_l1_reg_loss: 101350.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 190612.8906; val_chrom_access_recon_loss: 10570884.1250; val_global_loss: 32188904.2500; val_optim_loss: 32188904.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8908; val_auprc_score: 0.8618; val_best_acc_score: 0.8195; val_best_f1_score: 0.8322; train_kl_reg_loss: 79008.9808; train_edge_recon_loss: 681634.0066; train_gene_expr_recon_loss: 20600235.3636; train_masked_gp_l1_reg_loss: 103349.5398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175851.2112; train_chrom_access_recon_loss: 10732057.8485; train_global_loss: 32372136.7273; train_optim_loss: 32372136.7273; val_kl_reg_loss: 82562.0332; val_edge_recon_loss: 661280.2812; val_gene_expr_recon_loss: 20293225.7500; val_masked_gp_l1_reg_loss: 105122.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 162546.4844; val_chrom_access_recon_loss: 10544325.3750; val_global_loss: 31849061.0000; val_optim_loss: 31849061.0000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8906; val_auprc_score: 0.8582; val_best_acc_score: 0.8152; val_best_f1_score: 0.8326; train_kl_reg_loss: 87779.8910; train_edge_recon_loss: 644796.5180; train_gene_expr_recon_loss: 20468212.2727; train_masked_gp_l1_reg_loss: 106657.3802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 151644.2154; train_chrom_access_recon_loss: 10668459.8939; train_global_loss: 32127550.1515; train_optim_loss: 32127550.1515; val_kl_reg_loss: 87759.0615; val_edge_recon_loss: 641353.7422; val_gene_expr_recon_loss: 20306389.7500; val_masked_gp_l1_reg_loss: 108182.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 142726.5312; val_chrom_access_recon_loss: 10576748.7500; val_global_loss: 31863159.2500; val_optim_loss: 31863159.2500
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8982; val_auprc_score: 0.8622; val_best_acc_score: 0.8294; val_best_f1_score: 0.8442; train_kl_reg_loss: 88060.1965; train_edge_recon_loss: 632403.1932; train_gene_expr_recon_loss: 20395773.6061; train_masked_gp_l1_reg_loss: 109172.5509; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135349.0089; train_chrom_access_recon_loss: 10634118.0909; train_global_loss: 31994876.4545; train_optim_loss: 31994876.4545; val_kl_reg_loss: 85032.3379; val_edge_recon_loss: 631373.7344; val_gene_expr_recon_loss: 20316968.5000; val_masked_gp_l1_reg_loss: 110360.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129005.7656; val_chrom_access_recon_loss: 10512535.1250; val_global_loss: 31785276.0000; val_optim_loss: 31785276.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8996; val_auprc_score: 0.8669; val_best_acc_score: 0.8310; val_best_f1_score: 0.8411; train_kl_reg_loss: 87115.8029; train_edge_recon_loss: 623510.6411; train_gene_expr_recon_loss: 20301512.5455; train_masked_gp_l1_reg_loss: 111271.2134; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 124343.4793; train_chrom_access_recon_loss: 10594531.2424; train_global_loss: 31842285.2121; train_optim_loss: 31842285.2121; val_kl_reg_loss: 83235.4648; val_edge_recon_loss: 632619.6172; val_gene_expr_recon_loss: 20041054.0000; val_masked_gp_l1_reg_loss: 111827.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 119944.2734; val_chrom_access_recon_loss: 10366320.3750; val_global_loss: 31355001.5000; val_optim_loss: 31355001.5000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9053; val_auprc_score: 0.8766; val_best_acc_score: 0.8340; val_best_f1_score: 0.8506; train_kl_reg_loss: 86480.2231; train_edge_recon_loss: 618889.1032; train_gene_expr_recon_loss: 20219466.4242; train_masked_gp_l1_reg_loss: 112684.9640; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 116350.4775; train_chrom_access_recon_loss: 10540920.3182; train_global_loss: 31694791.7273; train_optim_loss: 31694791.7273; val_kl_reg_loss: 81844.4961; val_edge_recon_loss: 617730.3047; val_gene_expr_recon_loss: 20085359.2500; val_masked_gp_l1_reg_loss: 113619.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113778.9453; val_chrom_access_recon_loss: 10498343.2500; val_global_loss: 31510675.2500; val_optim_loss: 31510675.2500
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9093; val_auprc_score: 0.8781; val_best_acc_score: 0.8391; val_best_f1_score: 0.8510; train_kl_reg_loss: 84222.0266; train_edge_recon_loss: 616544.9138; train_gene_expr_recon_loss: 20145429.7576; train_masked_gp_l1_reg_loss: 114140.4970; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110755.4399; train_chrom_access_recon_loss: 10504755.9848; train_global_loss: 31575848.7576; train_optim_loss: 31575848.7576; val_kl_reg_loss: 80298.2510; val_edge_recon_loss: 619282.7109; val_gene_expr_recon_loss: 19882529.5000; val_masked_gp_l1_reg_loss: 114506.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108360.0625; val_chrom_access_recon_loss: 10318361.6250; val_global_loss: 31123337.7500; val_optim_loss: 31123337.7500
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9133; val_auprc_score: 0.8893; val_best_acc_score: 0.8420; val_best_f1_score: 0.8520; train_kl_reg_loss: 82790.9719; train_edge_recon_loss: 614008.6600; train_gene_expr_recon_loss: 20064172.0909; train_masked_gp_l1_reg_loss: 115252.9413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106341.9505; train_chrom_access_recon_loss: 10454983.2121; train_global_loss: 31437549.9091; train_optim_loss: 31437549.9091; val_kl_reg_loss: 82279.5225; val_edge_recon_loss: 615417.9688; val_gene_expr_recon_loss: 19821256.7500; val_masked_gp_l1_reg_loss: 116106.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104570.3594; val_chrom_access_recon_loss: 10325659.5000; val_global_loss: 31065290.0000; val_optim_loss: 31065290.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9114; val_auprc_score: 0.8877; val_best_acc_score: 0.8401; val_best_f1_score: 0.8523; train_kl_reg_loss: 81893.6682; train_edge_recon_loss: 611244.6354; train_gene_expr_recon_loss: 20008827.0000; train_masked_gp_l1_reg_loss: 116354.4946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102928.4283; train_chrom_access_recon_loss: 10409308.8485; train_global_loss: 31330557.0303; train_optim_loss: 31330557.0303; val_kl_reg_loss: 80638.8984; val_edge_recon_loss: 618990.2812; val_gene_expr_recon_loss: 19803619.0000; val_masked_gp_l1_reg_loss: 116852.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101814.6875; val_chrom_access_recon_loss: 10348770.0000; val_global_loss: 31070684.0000; val_optim_loss: 31070684.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9164; val_auprc_score: 0.8949; val_best_acc_score: 0.8407; val_best_f1_score: 0.8553; train_kl_reg_loss: 80281.4331; train_edge_recon_loss: 611606.1420; train_gene_expr_recon_loss: 19945823.6667; train_masked_gp_l1_reg_loss: 117319.4028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100623.3008; train_chrom_access_recon_loss: 10379712.0606; train_global_loss: 31235366.1212; train_optim_loss: 31235366.1212; val_kl_reg_loss: 78544.2012; val_edge_recon_loss: 615013.2422; val_gene_expr_recon_loss: 19779487.2500; val_masked_gp_l1_reg_loss: 117983.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99813.3281; val_chrom_access_recon_loss: 10226240.6250; val_global_loss: 30917083.2500; val_optim_loss: 30917083.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9176; val_auprc_score: 0.8931; val_best_acc_score: 0.8458; val_best_f1_score: 0.8589; train_kl_reg_loss: 79587.3963; train_edge_recon_loss: 606088.0587; train_gene_expr_recon_loss: 19902312.4242; train_masked_gp_l1_reg_loss: 118327.0722; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98952.4860; train_chrom_access_recon_loss: 10347506.6818; train_global_loss: 31152774.2727; train_optim_loss: 31152774.2727; val_kl_reg_loss: 77054.8379; val_edge_recon_loss: 610483.6797; val_gene_expr_recon_loss: 19673833.5000; val_masked_gp_l1_reg_loss: 118648.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97983.4453; val_chrom_access_recon_loss: 10290579.2500; val_global_loss: 30868582.7500; val_optim_loss: 30868582.7500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9241; val_auprc_score: 0.9018; val_best_acc_score: 0.8552; val_best_f1_score: 0.8671; train_kl_reg_loss: 78572.9566; train_edge_recon_loss: 606175.3864; train_gene_expr_recon_loss: 19830965.7273; train_masked_gp_l1_reg_loss: 119284.8458; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97589.4313; train_chrom_access_recon_loss: 10290707.7879; train_global_loss: 31023296.1515; train_optim_loss: 31023296.1515; val_kl_reg_loss: 75800.6562; val_edge_recon_loss: 606036.8750; val_gene_expr_recon_loss: 19458761.0000; val_masked_gp_l1_reg_loss: 119499.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97131.4297; val_chrom_access_recon_loss: 10234066.2500; val_global_loss: 30591297.0000; val_optim_loss: 30591297.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9354; val_auprc_score: 0.9172; val_best_acc_score: 0.8675; val_best_f1_score: 0.8769; train_kl_reg_loss: 78255.8034; train_edge_recon_loss: 602198.9934; train_gene_expr_recon_loss: 19773581.5455; train_masked_gp_l1_reg_loss: 120123.7076; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96627.4470; train_chrom_access_recon_loss: 10243255.1212; train_global_loss: 30914042.5758; train_optim_loss: 30914042.5758; val_kl_reg_loss: 74415.3545; val_edge_recon_loss: 602749.8438; val_gene_expr_recon_loss: 19705794.2500; val_masked_gp_l1_reg_loss: 120726.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96362.9219; val_chrom_access_recon_loss: 10134128.5000; val_global_loss: 30734176.2500; val_optim_loss: 30734176.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9284; val_auprc_score: 0.9065; val_best_acc_score: 0.8673; val_best_f1_score: 0.8738; train_kl_reg_loss: 77124.6042; train_edge_recon_loss: 602901.5057; train_gene_expr_recon_loss: 19722003.3636; train_masked_gp_l1_reg_loss: 121229.3853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96002.1219; train_chrom_access_recon_loss: 10214659.3333; train_global_loss: 30833920.2727; train_optim_loss: 30833920.2727; val_kl_reg_loss: 76813.3281; val_edge_recon_loss: 609995.7578; val_gene_expr_recon_loss: 19507207.0000; val_masked_gp_l1_reg_loss: 121485.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95516.9688; val_chrom_access_recon_loss: 10097093.0000; val_global_loss: 30508111.0000; val_optim_loss: 30508111.0000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9326; val_auprc_score: 0.9148; val_best_acc_score: 0.8678; val_best_f1_score: 0.8741; train_kl_reg_loss: 76561.9548; train_edge_recon_loss: 600855.8816; train_gene_expr_recon_loss: 19671581.2727; train_masked_gp_l1_reg_loss: 122139.1985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95242.7926; train_chrom_access_recon_loss: 10176552.1970; train_global_loss: 30742933.5758; train_optim_loss: 30742933.5758; val_kl_reg_loss: 75599.9805; val_edge_recon_loss: 610367.5547; val_gene_expr_recon_loss: 19593322.5000; val_masked_gp_l1_reg_loss: 122909.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95439.7891; val_chrom_access_recon_loss: 10085816.2500; val_global_loss: 30583456.2500; val_optim_loss: 30583456.2500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9344; val_auprc_score: 0.9141; val_best_acc_score: 0.8745; val_best_f1_score: 0.8806; train_kl_reg_loss: 75884.4471; train_edge_recon_loss: 600431.1780; train_gene_expr_recon_loss: 19627800.9697; train_masked_gp_l1_reg_loss: 123204.0083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94773.6057; train_chrom_access_recon_loss: 10127964.3182; train_global_loss: 30650058.6667; train_optim_loss: 30650058.6667; val_kl_reg_loss: 75740.3447; val_edge_recon_loss: 596974.5234; val_gene_expr_recon_loss: 19385193.0000; val_masked_gp_l1_reg_loss: 123886.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94341.2812; val_chrom_access_recon_loss: 9947853.2500; val_global_loss: 30223989.0000; val_optim_loss: 30223989.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9326; val_auprc_score: 0.9123; val_best_acc_score: 0.8689; val_best_f1_score: 0.8785; train_kl_reg_loss: 75699.4702; train_edge_recon_loss: 596661.2775; train_gene_expr_recon_loss: 19573220.5152; train_masked_gp_l1_reg_loss: 124237.5911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94043.4953; train_chrom_access_recon_loss: 10080443.7424; train_global_loss: 30544306.1515; train_optim_loss: 30544306.1515; val_kl_reg_loss: 75706.7275; val_edge_recon_loss: 603058.7344; val_gene_expr_recon_loss: 19495217.7500; val_masked_gp_l1_reg_loss: 124712.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93714.7500; val_chrom_access_recon_loss: 10020203.0000; val_global_loss: 30412612.0000; val_optim_loss: 30412612.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9429; val_auprc_score: 0.9293; val_best_acc_score: 0.8751; val_best_f1_score: 0.8828; train_kl_reg_loss: 75001.9395; train_edge_recon_loss: 597005.5398; train_gene_expr_recon_loss: 19525144.5758; train_masked_gp_l1_reg_loss: 125242.7496; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93124.4777; train_chrom_access_recon_loss: 10039861.0455; train_global_loss: 30455380.3030; train_optim_loss: 30455380.3030; val_kl_reg_loss: 74759.1445; val_edge_recon_loss: 602622.6016; val_gene_expr_recon_loss: 19341657.7500; val_masked_gp_l1_reg_loss: 125799.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93397.0156; val_chrom_access_recon_loss: 10037297.7500; val_global_loss: 30275534.7500; val_optim_loss: 30275534.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9369; val_auprc_score: 0.9187; val_best_acc_score: 0.8743; val_best_f1_score: 0.8809; train_kl_reg_loss: 74506.9652; train_edge_recon_loss: 595864.3551; train_gene_expr_recon_loss: 19477368.1212; train_masked_gp_l1_reg_loss: 126415.6864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92693.1824; train_chrom_access_recon_loss: 9996955.6212; train_global_loss: 30363803.8485; train_optim_loss: 30363803.8485; val_kl_reg_loss: 77036.3994; val_edge_recon_loss: 606048.9844; val_gene_expr_recon_loss: 19371977.5000; val_masked_gp_l1_reg_loss: 126991.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92408.3828; val_chrom_access_recon_loss: 10074583.3750; val_global_loss: 30349046.0000; val_optim_loss: 30349046.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9465; val_auprc_score: 0.9326; val_best_acc_score: 0.8842; val_best_f1_score: 0.8877; train_kl_reg_loss: 74552.1125; train_edge_recon_loss: 593782.2159; train_gene_expr_recon_loss: 19441233.9697; train_masked_gp_l1_reg_loss: 127341.9808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91774.8531; train_chrom_access_recon_loss: 9944792.4091; train_global_loss: 30273477.5758; train_optim_loss: 30273477.5758; val_kl_reg_loss: 74469.6533; val_edge_recon_loss: 598200.8438; val_gene_expr_recon_loss: 19326877.0000; val_masked_gp_l1_reg_loss: 127845.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91396.6797; val_chrom_access_recon_loss: 9880645.7500; val_global_loss: 30099435.0000; val_optim_loss: 30099435.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9356; val_auprc_score: 0.9089; val_best_acc_score: 0.8729; val_best_f1_score: 0.8815; train_kl_reg_loss: 74389.5037; train_edge_recon_loss: 594211.7992; train_gene_expr_recon_loss: 19385697.9697; train_masked_gp_l1_reg_loss: 128171.8911; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90733.6308; train_chrom_access_recon_loss: 9898968.2424; train_global_loss: 30172173.2121; train_optim_loss: 30172173.2121; val_kl_reg_loss: 74328.8076; val_edge_recon_loss: 602869.0781; val_gene_expr_recon_loss: 19217445.7500; val_masked_gp_l1_reg_loss: 128990.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90451.1562; val_chrom_access_recon_loss: 9900116.1250; val_global_loss: 30014202.0000; val_optim_loss: 30014202.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.8757; val_auprc_score: 0.8576; val_best_acc_score: 0.8082; val_best_f1_score: 0.8205; train_kl_reg_loss: 41928.0906; train_edge_recon_loss: 747997.7330; train_gene_expr_recon_loss: 18971811.5455; train_masked_gp_l1_reg_loss: 132508.8234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97040.1174; train_chrom_access_recon_loss: 9875126.9848; train_global_loss: 29866413.3939; train_optim_loss: 29866413.3939; val_kl_reg_loss: 16161.1899; val_edge_recon_loss: 788174.8906; val_gene_expr_recon_loss: 18631094.7500; val_masked_gp_l1_reg_loss: 137131.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110345.6719; val_chrom_access_recon_loss: 9658067.7500; val_global_loss: 29340976.5000; val_optim_loss: 29340976.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.8765; val_auprc_score: 0.8456; val_best_acc_score: 0.8092; val_best_f1_score: 0.8298; train_kl_reg_loss: 23670.5568; train_edge_recon_loss: 763116.7860; train_gene_expr_recon_loss: 18716939.9697; train_masked_gp_l1_reg_loss: 136535.5362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 112405.7786; train_chrom_access_recon_loss: 9743192.0000; train_global_loss: 29495860.6364; train_optim_loss: 29495860.6364; val_kl_reg_loss: 18808.9302; val_edge_recon_loss: 773606.7031; val_gene_expr_recon_loss: 18542687.2500; val_masked_gp_l1_reg_loss: 135450.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113994.7031; val_chrom_access_recon_loss: 9583033.8750; val_global_loss: 29167581.0000; val_optim_loss: 29167581.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.8726; val_auprc_score: 0.8395; val_best_acc_score: 0.8060; val_best_f1_score: 0.8233; train_kl_reg_loss: 24157.4040; train_edge_recon_loss: 753298.0606; train_gene_expr_recon_loss: 18654405.6364; train_masked_gp_l1_reg_loss: 137629.1955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 118273.3964; train_chrom_access_recon_loss: 9723065.6515; train_global_loss: 29410829.3333; train_optim_loss: 29410829.3333; val_kl_reg_loss: 21822.5776; val_edge_recon_loss: 765300.2734; val_gene_expr_recon_loss: 18356239.7500; val_masked_gp_l1_reg_loss: 135782.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 118005.0625; val_chrom_access_recon_loss: 9539412.6250; val_global_loss: 28936563.5000; val_optim_loss: 28936563.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.8596; val_auprc_score: 0.8251; val_best_acc_score: 0.7945; val_best_f1_score: 0.8122; train_kl_reg_loss: 28144.7832; train_edge_recon_loss: 733332.0455; train_gene_expr_recon_loss: 18496451.2424; train_masked_gp_l1_reg_loss: 132937.9830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114954.6036; train_chrom_access_recon_loss: 9669518.4394; train_global_loss: 29175338.9091; train_optim_loss: 29175338.9091; val_kl_reg_loss: 19678.5955; val_edge_recon_loss: 753008.1406; val_gene_expr_recon_loss: 18328009.0000; val_masked_gp_l1_reg_loss: 131614.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 113705.6094; val_chrom_access_recon_loss: 9550202.3750; val_global_loss: 28896217.7500; val_optim_loss: 28896217.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.8769; val_auprc_score: 0.8482; val_best_acc_score: 0.8025; val_best_f1_score: 0.8205; train_kl_reg_loss: 29672.5746; train_edge_recon_loss: 716495.2917; train_gene_expr_recon_loss: 18433752.3333; train_masked_gp_l1_reg_loss: 130221.9247; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 111415.0283; train_chrom_access_recon_loss: 9646812.8939; train_global_loss: 29068370.2727; train_optim_loss: 29068370.2727; val_kl_reg_loss: 27169.9316; val_edge_recon_loss: 735412.1172; val_gene_expr_recon_loss: 18408695.5000; val_masked_gp_l1_reg_loss: 128004.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108754.4375; val_chrom_access_recon_loss: 9544874.8750; val_global_loss: 28952910.2500; val_optim_loss: 28952910.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.8663; val_auprc_score: 0.8377; val_best_acc_score: 0.7931; val_best_f1_score: 0.8141; train_kl_reg_loss: 31679.4030; train_edge_recon_loss: 704693.2898; train_gene_expr_recon_loss: 18410905.6061; train_masked_gp_l1_reg_loss: 126325.8746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 107001.6374; train_chrom_access_recon_loss: 9632091.4545; train_global_loss: 29012697.3333; train_optim_loss: 29012697.3333; val_kl_reg_loss: 25296.4390; val_edge_recon_loss: 721046.6875; val_gene_expr_recon_loss: 18267322.5000; val_masked_gp_l1_reg_loss: 124454.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105504.5312; val_chrom_access_recon_loss: 9436115.0000; val_global_loss: 28679738.5000; val_optim_loss: 28679738.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.8745; val_auprc_score: 0.8434; val_best_acc_score: 0.8074; val_best_f1_score: 0.8222; train_kl_reg_loss: 31157.7900; train_edge_recon_loss: 695907.5350; train_gene_expr_recon_loss: 18352562.2424; train_masked_gp_l1_reg_loss: 122960.1083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104051.9634; train_chrom_access_recon_loss: 9603270.0303; train_global_loss: 28909909.6364; train_optim_loss: 28909909.6364; val_kl_reg_loss: 26148.8367; val_edge_recon_loss: 698943.4688; val_gene_expr_recon_loss: 18160348.0000; val_masked_gp_l1_reg_loss: 121517.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102666.7969; val_chrom_access_recon_loss: 9414262.6250; val_global_loss: 28523886.5000; val_optim_loss: 28523886.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.8740; val_auprc_score: 0.8377; val_best_acc_score: 0.8012; val_best_f1_score: 0.8251; train_kl_reg_loss: 34200.8967; train_edge_recon_loss: 677023.8305; train_gene_expr_recon_loss: 18340160.3636; train_masked_gp_l1_reg_loss: 120268.6455; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100263.2797; train_chrom_access_recon_loss: 9604675.6515; train_global_loss: 28876592.6667; train_optim_loss: 28876592.6667; val_kl_reg_loss: 30000.5696; val_edge_recon_loss: 678155.1094; val_gene_expr_recon_loss: 18074656.0000; val_masked_gp_l1_reg_loss: 119011.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97964.2812; val_chrom_access_recon_loss: 9372431.6250; val_global_loss: 28372219.2500; val_optim_loss: 28372219.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.8730; val_auprc_score: 0.8358; val_best_acc_score: 0.8052; val_best_f1_score: 0.8288; train_kl_reg_loss: 36452.3057; train_edge_recon_loss: 658985.4735; train_gene_expr_recon_loss: 18312239.8485; train_masked_gp_l1_reg_loss: 117964.5573; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96176.0017; train_chrom_access_recon_loss: 9589711.7879; train_global_loss: 28811530.0303; train_optim_loss: 28811530.0303; val_kl_reg_loss: 32878.0127; val_edge_recon_loss: 656685.8047; val_gene_expr_recon_loss: 18315918.7500; val_masked_gp_l1_reg_loss: 117185.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94594.8516; val_chrom_access_recon_loss: 9449671.6250; val_global_loss: 28666934.2500; val_optim_loss: 28666934.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.8765; val_auprc_score: 0.8405; val_best_acc_score: 0.8114; val_best_f1_score: 0.8342; train_kl_reg_loss: 39634.5578; train_edge_recon_loss: 639727.1354; train_gene_expr_recon_loss: 18289055.2424; train_masked_gp_l1_reg_loss: 116517.4484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93007.8252; train_chrom_access_recon_loss: 9576186.1515; train_global_loss: 28754128.2424; train_optim_loss: 28754128.2424; val_kl_reg_loss: 35878.0342; val_edge_recon_loss: 633588.4297; val_gene_expr_recon_loss: 18023993.2500; val_masked_gp_l1_reg_loss: 115943.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91770.5391; val_chrom_access_recon_loss: 9398800.3750; val_global_loss: 28299973.7500; val_optim_loss: 28299973.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.8767; val_auprc_score: 0.8401; val_best_acc_score: 0.8047; val_best_f1_score: 0.8289; train_kl_reg_loss: 42685.7046; train_edge_recon_loss: 627453.9602; train_gene_expr_recon_loss: 18246171.8485; train_masked_gp_l1_reg_loss: 115373.6844; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90429.7180; train_chrom_access_recon_loss: 9557501.9545; train_global_loss: 28679616.6970; train_optim_loss: 28679616.6970; val_kl_reg_loss: 40122.3984; val_edge_recon_loss: 630647.9219; val_gene_expr_recon_loss: 18065589.7500; val_masked_gp_l1_reg_loss: 114933.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89414.3672; val_chrom_access_recon_loss: 9448591.0000; val_global_loss: 28389299.0000; val_optim_loss: 28389299.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.8838; val_auprc_score: 0.8449; val_best_acc_score: 0.8127; val_best_f1_score: 0.8382; train_kl_reg_loss: 46399.7439; train_edge_recon_loss: 614682.7481; train_gene_expr_recon_loss: 18230238.2424; train_masked_gp_l1_reg_loss: 114375.8627; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88477.0879; train_chrom_access_recon_loss: 9546507.7727; train_global_loss: 28640681.6061; train_optim_loss: 28640681.6061; val_kl_reg_loss: 44170.4219; val_edge_recon_loss: 607817.9219; val_gene_expr_recon_loss: 18057882.7500; val_masked_gp_l1_reg_loss: 113983.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87368.2422; val_chrom_access_recon_loss: 9365419.1250; val_global_loss: 28276642.7500; val_optim_loss: 28276642.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.8804; val_auprc_score: 0.8391; val_best_acc_score: 0.8063; val_best_f1_score: 0.8314; train_kl_reg_loss: 49184.8776; train_edge_recon_loss: 610426.1941; train_gene_expr_recon_loss: 18212295.4242; train_masked_gp_l1_reg_loss: 113423.3467; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86866.3601; train_chrom_access_recon_loss: 9527496.2273; train_global_loss: 28599692.6061; train_optim_loss: 28599692.6061; val_kl_reg_loss: 46778.5259; val_edge_recon_loss: 614419.3047; val_gene_expr_recon_loss: 18038605.0000; val_masked_gp_l1_reg_loss: 112856.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85993.5625; val_chrom_access_recon_loss: 9425886.1250; val_global_loss: 28324538.7500; val_optim_loss: 28324538.7500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.8748; val_auprc_score: 0.8366; val_best_acc_score: 0.8023; val_best_f1_score: 0.8277; train_kl_reg_loss: 51005.8510; train_edge_recon_loss: 607920.9602; train_gene_expr_recon_loss: 18174186.0000; train_masked_gp_l1_reg_loss: 112429.6673; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85503.7348; train_chrom_access_recon_loss: 9514828.9091; train_global_loss: 28545875.2121; train_optim_loss: 28545875.2121; val_kl_reg_loss: 49569.9971; val_edge_recon_loss: 613318.7109; val_gene_expr_recon_loss: 17897707.8750; val_masked_gp_l1_reg_loss: 112035.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85350.2969; val_chrom_access_recon_loss: 9338435.7500; val_global_loss: 28096418.2500; val_optim_loss: 28096418.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.8793; val_auprc_score: 0.8487; val_best_acc_score: 0.8063; val_best_f1_score: 0.8294; train_kl_reg_loss: 52352.6837; train_edge_recon_loss: 605408.8722; train_gene_expr_recon_loss: 18160046.8182; train_masked_gp_l1_reg_loss: 111638.5900; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84681.6779; train_chrom_access_recon_loss: 9503766.5455; train_global_loss: 28517895.1515; train_optim_loss: 28517895.1515; val_kl_reg_loss: 50029.2651; val_edge_recon_loss: 610704.2812; val_gene_expr_recon_loss: 17910518.7500; val_masked_gp_l1_reg_loss: 111215.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84465.5781; val_chrom_access_recon_loss: 9293041.2500; val_global_loss: 28059975.2500; val_optim_loss: 28059975.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.8829; val_auprc_score: 0.8489; val_best_acc_score: 0.8103; val_best_f1_score: 0.8308; train_kl_reg_loss: 53244.3222; train_edge_recon_loss: 606002.8381; train_gene_expr_recon_loss: 18146772.1818; train_masked_gp_l1_reg_loss: 110739.2931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83943.6515; train_chrom_access_recon_loss: 9508128.1212; train_global_loss: 28508830.5758; train_optim_loss: 28508830.5758; val_kl_reg_loss: 51688.7461; val_edge_recon_loss: 605638.8438; val_gene_expr_recon_loss: 17784255.7500; val_masked_gp_l1_reg_loss: 110387.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83528.7734; val_chrom_access_recon_loss: 9306344.5000; val_global_loss: 27941844.2500; val_optim_loss: 27941844.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.8857; val_auprc_score: 0.8532; val_best_acc_score: 0.8117; val_best_f1_score: 0.8319; train_kl_reg_loss: 53733.2108; train_edge_recon_loss: 603495.5341; train_gene_expr_recon_loss: 18115290.6061; train_masked_gp_l1_reg_loss: 109995.3688; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83210.6146; train_chrom_access_recon_loss: 9484743.0000; train_global_loss: 28450468.3636; train_optim_loss: 28450468.3636; val_kl_reg_loss: 51631.4082; val_edge_recon_loss: 607722.7500; val_gene_expr_recon_loss: 17970567.2500; val_masked_gp_l1_reg_loss: 109685.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83066.6719; val_chrom_access_recon_loss: 9273164.2500; val_global_loss: 28095837.7500; val_optim_loss: 28095837.7500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.8853; val_auprc_score: 0.8600; val_best_acc_score: 0.8079; val_best_f1_score: 0.8292; train_kl_reg_loss: 54030.3425; train_edge_recon_loss: 603037.7377; train_gene_expr_recon_loss: 18094712.7273; train_masked_gp_l1_reg_loss: 109446.7665; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82751.4498; train_chrom_access_recon_loss: 9478428.7576; train_global_loss: 28422407.6970; train_optim_loss: 28422407.6970; val_kl_reg_loss: 53795.2676; val_edge_recon_loss: 601825.5703; val_gene_expr_recon_loss: 18179926.5000; val_masked_gp_l1_reg_loss: 109252.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82665.9609; val_chrom_access_recon_loss: 9415845.0000; val_global_loss: 28443310.0000; val_optim_loss: 28443310.0000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.8895; val_auprc_score: 0.8622; val_best_acc_score: 0.8149; val_best_f1_score: 0.8343; train_kl_reg_loss: 54488.5892; train_edge_recon_loss: 603373.0521; train_gene_expr_recon_loss: 18097742.0303; train_masked_gp_l1_reg_loss: 108933.0234; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82448.2696; train_chrom_access_recon_loss: 9476806.0000; train_global_loss: 28423791.0000; train_optim_loss: 28423791.0000; val_kl_reg_loss: 52864.1543; val_edge_recon_loss: 604393.8203; val_gene_expr_recon_loss: 17890177.2500; val_masked_gp_l1_reg_loss: 108788.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81954.6953; val_chrom_access_recon_loss: 9345927.8750; val_global_loss: 28084105.7500; val_optim_loss: 28084105.7500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.8809; val_auprc_score: 0.8478; val_best_acc_score: 0.8025; val_best_f1_score: 0.8250; train_kl_reg_loss: 54857.0681; train_edge_recon_loss: 602496.7083; train_gene_expr_recon_loss: 18078957.5758; train_masked_gp_l1_reg_loss: 108516.1931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82015.4040; train_chrom_access_recon_loss: 9464261.7576; train_global_loss: 28391104.8485; train_optim_loss: 28391104.8485; val_kl_reg_loss: 53529.3965; val_edge_recon_loss: 612087.3672; val_gene_expr_recon_loss: 17916841.2500; val_masked_gp_l1_reg_loss: 108306.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81548.1719; val_chrom_access_recon_loss: 9320740.8750; val_global_loss: 28093052.7500; val_optim_loss: 28093052.7500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.8932; val_auprc_score: 0.8617; val_best_acc_score: 0.8184; val_best_f1_score: 0.8372; train_kl_reg_loss: 54944.7483; train_edge_recon_loss: 602403.0625; train_gene_expr_recon_loss: 18075125.5152; train_masked_gp_l1_reg_loss: 105194.1139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68762.3300; train_chrom_access_recon_loss: 9462634.1212; train_global_loss: 28369064.0303; train_optim_loss: 28369064.0303; val_kl_reg_loss: 53624.3604; val_edge_recon_loss: 596773.7344; val_gene_expr_recon_loss: 17773139.0000; val_masked_gp_l1_reg_loss: 104147.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66007.9141; val_chrom_access_recon_loss: 9272256.5000; val_global_loss: 27865949.7500; val_optim_loss: 27865949.7500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.8866; val_auprc_score: 0.8584; val_best_acc_score: 0.8130; val_best_f1_score: 0.8343; train_kl_reg_loss: 55446.9661; train_edge_recon_loss: 600016.9640; train_gene_expr_recon_loss: 18053121.2121; train_masked_gp_l1_reg_loss: 103952.3733; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65611.7969; train_chrom_access_recon_loss: 9455005.4242; train_global_loss: 28333154.6061; train_optim_loss: 28333154.6061; val_kl_reg_loss: 54652.5615; val_edge_recon_loss: 604241.3125; val_gene_expr_recon_loss: 17926264.5000; val_masked_gp_l1_reg_loss: 103803.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65317.9766; val_chrom_access_recon_loss: 9373121.0000; val_global_loss: 28127402.0000; val_optim_loss: 28127402.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.8835; val_auprc_score: 0.8534; val_best_acc_score: 0.8015; val_best_f1_score: 0.8244; train_kl_reg_loss: 56025.4276; train_edge_recon_loss: 600537.5758; train_gene_expr_recon_loss: 18056182.1515; train_masked_gp_l1_reg_loss: 103714.8890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65117.6708; train_chrom_access_recon_loss: 9457755.5606; train_global_loss: 28339333.2121; train_optim_loss: 28339333.2121; val_kl_reg_loss: 54207.3501; val_edge_recon_loss: 610610.6250; val_gene_expr_recon_loss: 17881057.0000; val_masked_gp_l1_reg_loss: 103624.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64922.6211; val_chrom_access_recon_loss: 9255784.8750; val_global_loss: 27970205.7500; val_optim_loss: 27970205.7500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.8988; val_auprc_score: 0.8742; val_best_acc_score: 0.8192; val_best_f1_score: 0.8358; train_kl_reg_loss: 56087.6444; train_edge_recon_loss: 602670.1544; train_gene_expr_recon_loss: 18056448.0606; train_masked_gp_l1_reg_loss: 103560.6410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64806.7263; train_chrom_access_recon_loss: 9460850.0303; train_global_loss: 28344423.3333; train_optim_loss: 28344423.3333; val_kl_reg_loss: 54722.9175; val_edge_recon_loss: 600356.1094; val_gene_expr_recon_loss: 17880469.0000; val_masked_gp_l1_reg_loss: 103510.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64636.7500; val_chrom_access_recon_loss: 9264650.7500; val_global_loss: 27968344.7500; val_optim_loss: 27968344.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.8883; val_auprc_score: 0.8605; val_best_acc_score: 0.8087; val_best_f1_score: 0.8303; train_kl_reg_loss: 56444.1020; train_edge_recon_loss: 598558.8750; train_gene_expr_recon_loss: 18052284.6061; train_masked_gp_l1_reg_loss: 103422.6167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64502.8000; train_chrom_access_recon_loss: 9455235.4545; train_global_loss: 28330448.3333; train_optim_loss: 28330448.3333; val_kl_reg_loss: 55072.2578; val_edge_recon_loss: 607860.6562; val_gene_expr_recon_loss: 17859916.2500; val_masked_gp_l1_reg_loss: 103360.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64408.9492; val_chrom_access_recon_loss: 9365185.6250; val_global_loss: 28055802.5000; val_optim_loss: 28055802.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.8864; val_auprc_score: 0.8567; val_best_acc_score: 0.8117; val_best_f1_score: 0.8325; train_kl_reg_loss: 56554.8245; train_edge_recon_loss: 602868.4981; train_gene_expr_recon_loss: 18056950.9091; train_masked_gp_l1_reg_loss: 103033.4078; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63024.3219; train_chrom_access_recon_loss: 9493942.3182; train_global_loss: 28376374.2424; train_optim_loss: 28376374.2424; val_kl_reg_loss: 54811.4697; val_edge_recon_loss: 600275.2891; val_gene_expr_recon_loss: 18088324.0000; val_masked_gp_l1_reg_loss: 102900.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62703.7500; val_chrom_access_recon_loss: 9805249.2500; val_global_loss: 28714264.0000; val_optim_loss: 28714264.0000
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.8840; val_auprc_score: 0.8549; val_best_acc_score: 0.8041; val_best_f1_score: 0.8271; train_kl_reg_loss: 56848.7647; train_edge_recon_loss: 601384.4602; train_gene_expr_recon_loss: 18195909.8788; train_masked_gp_l1_reg_loss: 102827.0129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62592.7169; train_chrom_access_recon_loss: 9913361.8939; train_global_loss: 28932924.8788; train_optim_loss: 28932924.8788; val_kl_reg_loss: 54910.5566; val_edge_recon_loss: 606479.5312; val_gene_expr_recon_loss: 18033501.0000; val_masked_gp_l1_reg_loss: 102760.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62471.2031; val_chrom_access_recon_loss: 9679311.6250; val_global_loss: 28539434.7500; val_optim_loss: 28539434.7500
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.8945; val_auprc_score: 0.8683; val_best_acc_score: 0.8186; val_best_f1_score: 0.8357; train_kl_reg_loss: 56774.7665; train_edge_recon_loss: 604324.9205; train_gene_expr_recon_loss: 18134358.1818; train_masked_gp_l1_reg_loss: 102712.9478; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62352.4760; train_chrom_access_recon_loss: 9791249.6212; train_global_loss: 28751773.0606; train_optim_loss: 28751773.0606; val_kl_reg_loss: 54884.3643; val_edge_recon_loss: 610893.0703; val_gene_expr_recon_loss: 17974404.7500; val_masked_gp_l1_reg_loss: 102673.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62227.3555; val_chrom_access_recon_loss: 9621964.8750; val_global_loss: 28427049.0000; val_optim_loss: 28427049.0000
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.8787; val_auprc_score: 0.8422; val_best_acc_score: 0.8049; val_best_f1_score: 0.8260; train_kl_reg_loss: 56730.3343; train_edge_recon_loss: 604710.9773; train_gene_expr_recon_loss: 18101821.5152; train_masked_gp_l1_reg_loss: 102646.3700; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62114.8362; train_chrom_access_recon_loss: 9707181.5606; train_global_loss: 28635205.6061; train_optim_loss: 28635205.6061; val_kl_reg_loss: 54863.0918; val_edge_recon_loss: 612599.8672; val_gene_expr_recon_loss: 17950187.7500; val_masked_gp_l1_reg_loss: 102624.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61997.4297; val_chrom_access_recon_loss: 9573649.6250; val_global_loss: 28355922.5000; val_optim_loss: 28355922.5000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 25 min 20 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.8850
val AUPRC score: 0.8504
val best accuracy score: 0.8154
val best F1 score: 0.8336
val target rna MSE score: 1.3402
val source rna MSE score: 0.8587
val target atac MSE score: 0.3193
val source atac MSE score: 0.1704
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
