[True, False, True]
Run timestamp: 06092023_134843_13.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', 'batch7', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', 'patient', '--cat_covariates_no_edges', 'True', 'False', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '5', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.015625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '1000.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_13']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch7...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 38, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 563097
Number of validation nodes: 62566
Number of training edges: 1330101
Number of validation edges: 147789
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.8980; val_auprc_score: 0.9801; val_best_acc_score: 0.9174; val_best_f1_score: 0.9538; train_kl_reg_loss: 17234.4591; train_edge_recon_loss: 730783.4194; train_cat_covariates_contrastive_loss: 945524.7721; train_gene_expr_recon_loss: 2743523.3055; train_masked_gp_l1_reg_loss: 40555.2148; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 59407.9154; train_global_loss: 4537029.0844; train_optim_loss: 4537029.0844; val_kl_reg_loss: 15019.7258; val_edge_recon_loss: 724655.0789; val_cat_covariates_contrastive_loss: 942217.8525; val_gene_expr_recon_loss: 2618504.2318; val_masked_gp_l1_reg_loss: 28884.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14529.2031; val_global_loss: 4343809.8919; val_optim_loss: 4343809.8919
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9157; val_auprc_score: 0.9833; val_best_acc_score: 0.9237; val_best_f1_score: 0.9572; train_kl_reg_loss: 15193.9111; train_edge_recon_loss: 693834.3752; train_cat_covariates_contrastive_loss: 943402.6354; train_gene_expr_recon_loss: 2575490.6341; train_masked_gp_l1_reg_loss: 30018.8632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15260.5581; train_global_loss: 4273200.9690; train_optim_loss: 4273200.9690; val_kl_reg_loss: 15771.7097; val_edge_recon_loss: 722050.7117; val_cat_covariates_contrastive_loss: 942619.3975; val_gene_expr_recon_loss: 2555547.3002; val_masked_gp_l1_reg_loss: 31264.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15526.5791; val_global_loss: 4282780.1202; val_optim_loss: 4282780.1202
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9249; val_auprc_score: 0.9851; val_best_acc_score: 0.9286; val_best_f1_score: 0.9597; train_kl_reg_loss: 16277.2165; train_edge_recon_loss: 690033.6182; train_cat_covariates_contrastive_loss: 943905.8898; train_gene_expr_recon_loss: 2531127.4968; train_masked_gp_l1_reg_loss: 32910.2206; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15595.8097; train_global_loss: 4229850.2552; train_optim_loss: 4229850.2552; val_kl_reg_loss: 16687.3379; val_edge_recon_loss: 710268.5285; val_cat_covariates_contrastive_loss: 944596.8062; val_gene_expr_recon_loss: 2518234.1254; val_masked_gp_l1_reg_loss: 35165.0117; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15879.7031; val_global_loss: 4240831.3971; val_optim_loss: 4240831.3971
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9290; val_auprc_score: 0.9852; val_best_acc_score: 0.9348; val_best_f1_score: 0.9633; train_kl_reg_loss: 17955.2428; train_edge_recon_loss: 690056.1515; train_cat_covariates_contrastive_loss: 945423.5279; train_gene_expr_recon_loss: 2498025.8310; train_masked_gp_l1_reg_loss: 37155.2488; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15716.6718; train_global_loss: 4204332.6700; train_optim_loss: 4204332.6700; val_kl_reg_loss: 18979.6715; val_edge_recon_loss: 709656.0908; val_cat_covariates_contrastive_loss: 945766.3209; val_gene_expr_recon_loss: 2490237.7119; val_masked_gp_l1_reg_loss: 38879.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15834.9775; val_global_loss: 4219353.9083; val_optim_loss: 4219353.9083
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9344; val_auprc_score: 0.9867; val_best_acc_score: 0.9352; val_best_f1_score: 0.9634; train_kl_reg_loss: 19754.1401; train_edge_recon_loss: 686481.4483; train_cat_covariates_contrastive_loss: 946575.8453; train_gene_expr_recon_loss: 2475373.2508; train_masked_gp_l1_reg_loss: 40142.1618; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15952.4304; train_global_loss: 4184279.2805; train_optim_loss: 4184279.2805; val_kl_reg_loss: 20116.7215; val_edge_recon_loss: 711585.4572; val_cat_covariates_contrastive_loss: 948520.2783; val_gene_expr_recon_loss: 2473404.7353; val_masked_gp_l1_reg_loss: 41069.3750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15977.2754; val_global_loss: 4210674.0190; val_optim_loss: 4210674.0190
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9357; val_auprc_score: 0.9864; val_best_acc_score: 0.9392; val_best_f1_score: 0.9657; train_kl_reg_loss: 20968.8749; train_edge_recon_loss: 686984.9546; train_cat_covariates_contrastive_loss: 947145.1305; train_gene_expr_recon_loss: 2462708.0049; train_masked_gp_l1_reg_loss: 42098.4877; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16200.9651; train_global_loss: 4176106.4208; train_optim_loss: 4176106.4208; val_kl_reg_loss: 21431.5434; val_edge_recon_loss: 705657.3175; val_cat_covariates_contrastive_loss: 947167.0800; val_gene_expr_recon_loss: 2463192.0087; val_masked_gp_l1_reg_loss: 42966.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16455.4531; val_global_loss: 4196870.2837; val_optim_loss: 4196870.2837
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9368; val_auprc_score: 0.9868; val_best_acc_score: 0.9387; val_best_f1_score: 0.9655; train_kl_reg_loss: 22023.3252; train_edge_recon_loss: 686255.7152; train_cat_covariates_contrastive_loss: 947753.8330; train_gene_expr_recon_loss: 2451838.9808; train_masked_gp_l1_reg_loss: 43909.4802; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16450.0423; train_global_loss: 4168231.3762; train_optim_loss: 4168231.3762; val_kl_reg_loss: 21802.1545; val_edge_recon_loss: 703547.5002; val_cat_covariates_contrastive_loss: 948805.6797; val_gene_expr_recon_loss: 2451375.6471; val_masked_gp_l1_reg_loss: 44412.3008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16379.6104; val_global_loss: 4186322.8227; val_optim_loss: 4186322.8227
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9341; val_auprc_score: 0.9858; val_best_acc_score: 0.9392; val_best_f1_score: 0.9657; train_kl_reg_loss: 22792.4046; train_edge_recon_loss: 686438.7257; train_cat_covariates_contrastive_loss: 948038.6834; train_gene_expr_recon_loss: 2443577.3810; train_masked_gp_l1_reg_loss: 44958.2707; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16648.3442; train_global_loss: 4162453.8125; train_optim_loss: 4162453.8125; val_kl_reg_loss: 23563.4219; val_edge_recon_loss: 703516.2734; val_cat_covariates_contrastive_loss: 947551.0160; val_gene_expr_recon_loss: 2444730.8702; val_masked_gp_l1_reg_loss: 45483.6914; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16878.6797; val_global_loss: 4181723.9221; val_optim_loss: 4181723.9221
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9356; val_auprc_score: 0.9857; val_best_acc_score: 0.9408; val_best_f1_score: 0.9667; train_kl_reg_loss: 23414.6988; train_edge_recon_loss: 687441.5666; train_cat_covariates_contrastive_loss: 948289.6674; train_gene_expr_recon_loss: 2435291.8279; train_masked_gp_l1_reg_loss: 46161.2061; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16797.5015; train_global_loss: 4157396.4649; train_optim_loss: 4157396.4649; val_kl_reg_loss: 24223.3820; val_edge_recon_loss: 708590.7274; val_cat_covariates_contrastive_loss: 947539.4397; val_gene_expr_recon_loss: 2437696.0043; val_masked_gp_l1_reg_loss: 46813.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16649.8711; val_global_loss: 4181513.3841; val_optim_loss: 4181513.3841
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9378; val_auprc_score: 0.9868; val_best_acc_score: 0.9396; val_best_f1_score: 0.9659; train_kl_reg_loss: 24117.4236; train_edge_recon_loss: 685300.2293; train_cat_covariates_contrastive_loss: 948538.4305; train_gene_expr_recon_loss: 2429354.5216; train_masked_gp_l1_reg_loss: 47294.2815; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16919.5677; train_global_loss: 4151524.4574; train_optim_loss: 4151524.4574; val_kl_reg_loss: 24912.7070; val_edge_recon_loss: 708069.0638; val_cat_covariates_contrastive_loss: 948657.1183; val_gene_expr_recon_loss: 2429365.6151; val_masked_gp_l1_reg_loss: 47787.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17111.1250; val_global_loss: 4175902.5865; val_optim_loss: 4175902.5865
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9418; val_auprc_score: 0.9877; val_best_acc_score: 0.9407; val_best_f1_score: 0.9665; train_kl_reg_loss: 24734.7405; train_edge_recon_loss: 688673.4035; train_cat_covariates_contrastive_loss: 948711.4227; train_gene_expr_recon_loss: 2422674.1672; train_masked_gp_l1_reg_loss: 48193.8705; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17128.4656; train_global_loss: 4150116.0701; train_optim_loss: 4150116.0701; val_kl_reg_loss: 24677.3137; val_edge_recon_loss: 707239.0002; val_cat_covariates_contrastive_loss: 950369.1308; val_gene_expr_recon_loss: 2428356.6920; val_masked_gp_l1_reg_loss: 48646.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17164.0527; val_global_loss: 4176452.9732; val_optim_loss: 4176452.9732
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9388; val_auprc_score: 0.9868; val_best_acc_score: 0.9402; val_best_f1_score: 0.9662; train_kl_reg_loss: 25133.5989; train_edge_recon_loss: 688717.7111; train_cat_covariates_contrastive_loss: 948770.3001; train_gene_expr_recon_loss: 2418264.6707; train_masked_gp_l1_reg_loss: 48812.7028; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17193.1566; train_global_loss: 4146892.1382; train_optim_loss: 4146892.1382; val_kl_reg_loss: 25399.4298; val_edge_recon_loss: 704140.0004; val_cat_covariates_contrastive_loss: 947807.2470; val_gene_expr_recon_loss: 2422078.6116; val_masked_gp_l1_reg_loss: 49122.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17233.9238; val_global_loss: 4165781.2958; val_optim_loss: 4165781.2958
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9369; val_auprc_score: 0.9861; val_best_acc_score: 0.9410; val_best_f1_score: 0.9666; train_kl_reg_loss: 25465.9114; train_edge_recon_loss: 687162.3346; train_cat_covariates_contrastive_loss: 948960.5473; train_gene_expr_recon_loss: 2415257.2911; train_masked_gp_l1_reg_loss: 49367.8359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17309.8933; train_global_loss: 4143523.8149; train_optim_loss: 4143523.8149; val_kl_reg_loss: 26313.1684; val_edge_recon_loss: 713261.0980; val_cat_covariates_contrastive_loss: 947219.2158; val_gene_expr_recon_loss: 2419101.3313; val_masked_gp_l1_reg_loss: 49633.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17613.8145; val_global_loss: 4173142.1453; val_optim_loss: 4173142.1453
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9425; val_auprc_score: 0.9874; val_best_acc_score: 0.9425; val_best_f1_score: 0.9675; train_kl_reg_loss: 25788.7231; train_edge_recon_loss: 688895.3571; train_cat_covariates_contrastive_loss: 948888.6383; train_gene_expr_recon_loss: 2412815.7427; train_masked_gp_l1_reg_loss: 49769.4852; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17435.9448; train_global_loss: 4143593.8903; train_optim_loss: 4143593.8903; val_kl_reg_loss: 26101.2722; val_edge_recon_loss: 708356.8620; val_cat_covariates_contrastive_loss: 948652.1183; val_gene_expr_recon_loss: 2418615.3235; val_masked_gp_l1_reg_loss: 50072.3633; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17685.8320; val_global_loss: 4169483.7275; val_optim_loss: 4169483.7275
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9381; val_auprc_score: 0.9862; val_best_acc_score: 0.9438; val_best_f1_score: 0.9683; train_kl_reg_loss: 26057.7660; train_edge_recon_loss: 688715.7674; train_cat_covariates_contrastive_loss: 948981.8827; train_gene_expr_recon_loss: 2410158.1287; train_masked_gp_l1_reg_loss: 50133.5826; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17515.4821; train_global_loss: 4141562.6081; train_optim_loss: 4141562.6081; val_kl_reg_loss: 27181.0721; val_edge_recon_loss: 704545.6672; val_cat_covariates_contrastive_loss: 947108.8635; val_gene_expr_recon_loss: 2417883.9152; val_masked_gp_l1_reg_loss: 50308.7070; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17569.4082; val_global_loss: 4164597.7042; val_optim_loss: 4164597.7042
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9449; val_auprc_score: 0.9881; val_best_acc_score: 0.9439; val_best_f1_score: 0.9682; train_kl_reg_loss: 26316.9504; train_edge_recon_loss: 687644.7045; train_cat_covariates_contrastive_loss: 949079.3486; train_gene_expr_recon_loss: 2407298.3639; train_masked_gp_l1_reg_loss: 50481.3142; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17629.6563; train_global_loss: 4138450.3403; train_optim_loss: 4138450.3403; val_kl_reg_loss: 26721.7501; val_edge_recon_loss: 711521.6784; val_cat_covariates_contrastive_loss: 948665.6894; val_gene_expr_recon_loss: 2413994.6670; val_masked_gp_l1_reg_loss: 50750.3320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17540.3066; val_global_loss: 4169194.4325; val_optim_loss: 4169194.4325
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9437; val_auprc_score: 0.9877; val_best_acc_score: 0.9450; val_best_f1_score: 0.9689; train_kl_reg_loss: 26491.7800; train_edge_recon_loss: 685647.6919; train_cat_covariates_contrastive_loss: 949055.9872; train_gene_expr_recon_loss: 2404856.8176; train_masked_gp_l1_reg_loss: 50794.5643; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17699.1953; train_global_loss: 4134546.0416; train_optim_loss: 4134546.0416; val_kl_reg_loss: 26720.7740; val_edge_recon_loss: 708376.9462; val_cat_covariates_contrastive_loss: 948590.3077; val_gene_expr_recon_loss: 2408653.5199; val_masked_gp_l1_reg_loss: 50901.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17635.2305; val_global_loss: 4160877.9100; val_optim_loss: 4160877.9100
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9404; val_auprc_score: 0.9869; val_best_acc_score: 0.9421; val_best_f1_score: 0.9672; train_kl_reg_loss: 26745.0260; train_edge_recon_loss: 686183.8704; train_cat_covariates_contrastive_loss: 949159.9557; train_gene_expr_recon_loss: 2402757.5022; train_masked_gp_l1_reg_loss: 51171.5190; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17743.7033; train_global_loss: 4133761.5786; train_optim_loss: 4133761.5786; val_kl_reg_loss: 27104.6343; val_edge_recon_loss: 708920.2822; val_cat_covariates_contrastive_loss: 948249.3209; val_gene_expr_recon_loss: 2407613.6990; val_masked_gp_l1_reg_loss: 51502.2383; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17866.1914; val_global_loss: 4161256.3028; val_optim_loss: 4161256.3028
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9377; val_auprc_score: 0.9861; val_best_acc_score: 0.9404; val_best_f1_score: 0.9663; train_kl_reg_loss: 26921.5965; train_edge_recon_loss: 684846.1214; train_cat_covariates_contrastive_loss: 949165.4541; train_gene_expr_recon_loss: 2400090.2460; train_masked_gp_l1_reg_loss: 51495.9879; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17817.9082; train_global_loss: 4130337.3143; train_optim_loss: 4130337.3143; val_kl_reg_loss: 27946.4882; val_edge_recon_loss: 714499.4299; val_cat_covariates_contrastive_loss: 947556.1315; val_gene_expr_recon_loss: 2403827.9542; val_masked_gp_l1_reg_loss: 51482.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17794.4082; val_global_loss: 4163107.1912; val_optim_loss: 4163107.1912
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9440; val_auprc_score: 0.9877; val_best_acc_score: 0.9454; val_best_f1_score: 0.9691; train_kl_reg_loss: 27159.3426; train_edge_recon_loss: 688889.7533; train_cat_covariates_contrastive_loss: 949372.9271; train_gene_expr_recon_loss: 2398211.6033; train_masked_gp_l1_reg_loss: 51793.6370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17890.8477; train_global_loss: 4133318.1139; train_optim_loss: 4133318.1139; val_kl_reg_loss: 27839.8011; val_edge_recon_loss: 709717.1574; val_cat_covariates_contrastive_loss: 948777.8255; val_gene_expr_recon_loss: 2405578.7699; val_masked_gp_l1_reg_loss: 51829.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18073.7598; val_global_loss: 4161816.5666; val_optim_loss: 4161816.5666
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9432; val_auprc_score: 0.9874; val_best_acc_score: 0.9457; val_best_f1_score: 0.9693; train_kl_reg_loss: 27295.8343; train_edge_recon_loss: 686667.3143; train_cat_covariates_contrastive_loss: 949353.5995; train_gene_expr_recon_loss: 2397587.4965; train_masked_gp_l1_reg_loss: 51963.5915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17951.7672; train_global_loss: 4130819.6072; train_optim_loss: 4130819.6072; val_kl_reg_loss: 27888.3206; val_edge_recon_loss: 706133.9954; val_cat_covariates_contrastive_loss: 949132.4048; val_gene_expr_recon_loss: 2402086.0441; val_masked_gp_l1_reg_loss: 51946.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17993.2969; val_global_loss: 4155181.0761; val_optim_loss: 4155181.0761
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9420; val_auprc_score: 0.9872; val_best_acc_score: 0.9448; val_best_f1_score: 0.9688; train_kl_reg_loss: 27449.0723; train_edge_recon_loss: 682950.9088; train_cat_covariates_contrastive_loss: 949262.2330; train_gene_expr_recon_loss: 2395981.0427; train_masked_gp_l1_reg_loss: 52208.3317; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17990.2532; train_global_loss: 4125841.8426; train_optim_loss: 4125841.8426; val_kl_reg_loss: 27976.7518; val_edge_recon_loss: 708503.8739; val_cat_covariates_contrastive_loss: 948766.4362; val_gene_expr_recon_loss: 2398677.2889; val_masked_gp_l1_reg_loss: 52305.8320; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18102.5840; val_global_loss: 4154332.6756; val_optim_loss: 4154332.6756
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9406; val_auprc_score: 0.9867; val_best_acc_score: 0.9450; val_best_f1_score: 0.9688; train_kl_reg_loss: 27573.9196; train_edge_recon_loss: 688562.1697; train_cat_covariates_contrastive_loss: 949425.0126; train_gene_expr_recon_loss: 2394389.0517; train_masked_gp_l1_reg_loss: 52451.3097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18039.4041; train_global_loss: 4130440.8657; train_optim_loss: 4130440.8657; val_kl_reg_loss: 27632.0789; val_edge_recon_loss: 715231.9031; val_cat_covariates_contrastive_loss: 948505.1300; val_gene_expr_recon_loss: 2397981.7846; val_masked_gp_l1_reg_loss: 52386.2930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17947.9121; val_global_loss: 4159685.1782; val_optim_loss: 4159685.1782
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9443; val_auprc_score: 0.9877; val_best_acc_score: 0.9437; val_best_f1_score: 0.9681; train_kl_reg_loss: 27639.2395; train_edge_recon_loss: 687397.2830; train_cat_covariates_contrastive_loss: 949501.6815; train_gene_expr_recon_loss: 2392740.6813; train_masked_gp_l1_reg_loss: 52699.1355; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18106.3770; train_global_loss: 4128084.3951; train_optim_loss: 4128084.3951; val_kl_reg_loss: 27562.7090; val_edge_recon_loss: 716132.6123; val_cat_covariates_contrastive_loss: 950121.4325; val_gene_expr_recon_loss: 2398440.0735; val_masked_gp_l1_reg_loss: 52764.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18144.6777; val_global_loss: 4163166.4784; val_optim_loss: 4163166.4784
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9412; val_auprc_score: 0.9868; val_best_acc_score: 0.9457; val_best_f1_score: 0.9692; train_kl_reg_loss: 27850.9511; train_edge_recon_loss: 688179.0701; train_cat_covariates_contrastive_loss: 949593.3618; train_gene_expr_recon_loss: 2390694.4473; train_masked_gp_l1_reg_loss: 52932.0223; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18140.6808; train_global_loss: 4127390.5371; train_optim_loss: 4127390.5371; val_kl_reg_loss: 28589.0621; val_edge_recon_loss: 712825.3367; val_cat_covariates_contrastive_loss: 948638.8560; val_gene_expr_recon_loss: 2396694.4637; val_masked_gp_l1_reg_loss: 53165.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18162.3555; val_global_loss: 4158076.0458; val_optim_loss: 4158076.0458
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9355; val_auprc_score: 0.9861; val_best_acc_score: 0.9405; val_best_f1_score: 0.9664; train_kl_reg_loss: 23106.3521; train_edge_recon_loss: 689365.1812; train_cat_covariates_contrastive_loss: 949023.7139; train_gene_expr_recon_loss: 1915237.0624; train_masked_gp_l1_reg_loss: 50703.2954; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16597.6625; train_global_loss: 3644033.2666; train_optim_loss: 3644033.2666; val_kl_reg_loss: 22379.1877; val_edge_recon_loss: 710190.5918; val_cat_covariates_contrastive_loss: 948264.2995; val_gene_expr_recon_loss: 1918119.1146; val_masked_gp_l1_reg_loss: 50840.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16555.1777; val_global_loss: 3666349.1946; val_optim_loss: 3666349.1946
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9401; val_auprc_score: 0.9868; val_best_acc_score: 0.9424; val_best_f1_score: 0.9675; train_kl_reg_loss: 22916.3516; train_edge_recon_loss: 688056.0517; train_cat_covariates_contrastive_loss: 948932.6511; train_gene_expr_recon_loss: 1912989.3749; train_masked_gp_l1_reg_loss: 50861.2533; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16565.4579; train_global_loss: 3640321.1400; train_optim_loss: 3640321.1400; val_kl_reg_loss: 22594.6599; val_edge_recon_loss: 712979.9928; val_cat_covariates_contrastive_loss: 948769.3893; val_gene_expr_recon_loss: 1916964.3144; val_masked_gp_l1_reg_loss: 50863.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16533.8828; val_global_loss: 3668705.8590; val_optim_loss: 3668705.8590
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9362; val_auprc_score: 0.9860; val_best_acc_score: 0.9391; val_best_f1_score: 0.9656; train_kl_reg_loss: 23031.3011; train_edge_recon_loss: 688754.8877; train_cat_covariates_contrastive_loss: 948797.6135; train_gene_expr_recon_loss: 1911957.2244; train_masked_gp_l1_reg_loss: 50813.3746; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16516.3335; train_global_loss: 3639870.7322; train_optim_loss: 3639870.7322; val_kl_reg_loss: 23426.7587; val_edge_recon_loss: 711922.9600; val_cat_covariates_contrastive_loss: 948227.7695; val_gene_expr_recon_loss: 1917530.9304; val_masked_gp_l1_reg_loss: 50923.5273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16616.2109; val_global_loss: 3668648.1747; val_optim_loss: 3668648.1747
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9397; val_auprc_score: 0.9868; val_best_acc_score: 0.9442; val_best_f1_score: 0.9685; train_kl_reg_loss: 23112.3349; train_edge_recon_loss: 686428.1764; train_cat_covariates_contrastive_loss: 948841.7686; train_gene_expr_recon_loss: 1910817.3395; train_masked_gp_l1_reg_loss: 51030.9680; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16543.7568; train_global_loss: 3636774.3433; train_optim_loss: 3636774.3433; val_kl_reg_loss: 22946.9492; val_edge_recon_loss: 704095.4403; val_cat_covariates_contrastive_loss: 948347.7346; val_gene_expr_recon_loss: 1913909.4706; val_masked_gp_l1_reg_loss: 51295.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16604.1035; val_global_loss: 3657199.0978; val_optim_loss: 3657199.0978
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9404; val_auprc_score: 0.9867; val_best_acc_score: 0.9437; val_best_f1_score: 0.9682; train_kl_reg_loss: 23245.2789; train_edge_recon_loss: 685114.5637; train_cat_covariates_contrastive_loss: 948858.0271; train_gene_expr_recon_loss: 1910404.7320; train_masked_gp_l1_reg_loss: 51132.7352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16569.4251; train_global_loss: 3635324.7617; train_optim_loss: 3635324.7617; val_kl_reg_loss: 23611.3460; val_edge_recon_loss: 710702.6856; val_cat_covariates_contrastive_loss: 948311.3672; val_gene_expr_recon_loss: 1913831.0476; val_masked_gp_l1_reg_loss: 51061.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16485.6797; val_global_loss: 3664003.9394; val_optim_loss: 3664003.9394
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9410; val_auprc_score: 0.9869; val_best_acc_score: 0.9447; val_best_f1_score: 0.9688; train_kl_reg_loss: 23197.2239; train_edge_recon_loss: 686773.3894; train_cat_covariates_contrastive_loss: 948746.9013; train_gene_expr_recon_loss: 1907485.9410; train_masked_gp_l1_reg_loss: 51181.2272; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16585.5563; train_global_loss: 3633970.2405; train_optim_loss: 3633970.2405; val_kl_reg_loss: 23110.1211; val_edge_recon_loss: 708057.0743; val_cat_covariates_contrastive_loss: 949021.9366; val_gene_expr_recon_loss: 1913428.8979; val_masked_gp_l1_reg_loss: 51251.2852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16505.7480; val_global_loss: 3661375.0320; val_optim_loss: 3661375.0320
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9424; val_auprc_score: 0.9875; val_best_acc_score: 0.9442; val_best_f1_score: 0.9685; train_kl_reg_loss: 23281.8577; train_edge_recon_loss: 686046.2644; train_cat_covariates_contrastive_loss: 948697.7115; train_gene_expr_recon_loss: 1906978.5982; train_masked_gp_l1_reg_loss: 51216.4095; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16594.9089; train_global_loss: 3632815.7533; train_optim_loss: 3632815.7533; val_kl_reg_loss: 24001.3300; val_edge_recon_loss: 713681.8175; val_cat_covariates_contrastive_loss: 948459.3038; val_gene_expr_recon_loss: 1910490.2872; val_masked_gp_l1_reg_loss: 51152.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16549.0723; val_global_loss: 3664334.7405; val_optim_loss: 3664334.7405
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9460; val_auprc_score: 0.9884; val_best_acc_score: 0.9435; val_best_f1_score: 0.9680; train_kl_reg_loss: 23420.1380; train_edge_recon_loss: 684825.6302; train_cat_covariates_contrastive_loss: 948757.4285; train_gene_expr_recon_loss: 1906967.1387; train_masked_gp_l1_reg_loss: 51297.5030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16623.5901; train_global_loss: 3631891.4299; train_optim_loss: 3631891.4299; val_kl_reg_loss: 23428.4930; val_edge_recon_loss: 711310.4120; val_cat_covariates_contrastive_loss: 950794.1062; val_gene_expr_recon_loss: 1910339.2760; val_masked_gp_l1_reg_loss: 51408.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16504.0273; val_global_loss: 3663784.5389; val_optim_loss: 3663784.5389

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9457; val_auprc_score: 0.9883; val_best_acc_score: 0.9447; val_best_f1_score: 0.9688; train_kl_reg_loss: 23549.2613; train_edge_recon_loss: 684640.4810; train_cat_covariates_contrastive_loss: 948538.3246; train_gene_expr_recon_loss: 1905715.8355; train_masked_gp_l1_reg_loss: 39722.5757; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8628.2098; train_global_loss: 3610794.6870; train_optim_loss: 3610794.6870; val_kl_reg_loss: 23388.5834; val_edge_recon_loss: 710977.9260; val_cat_covariates_contrastive_loss: 949319.0097; val_gene_expr_recon_loss: 1910367.8075; val_masked_gp_l1_reg_loss: 39780.6992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8443.5527; val_global_loss: 3642277.5779; val_optim_loss: 3642277.5779
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9444; val_auprc_score: 0.9878; val_best_acc_score: 0.9443; val_best_f1_score: 0.9685; train_kl_reg_loss: 23595.6691; train_edge_recon_loss: 684060.1868; train_cat_covariates_contrastive_loss: 948429.0973; train_gene_expr_recon_loss: 1904917.6060; train_masked_gp_l1_reg_loss: 39823.8146; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8475.4254; train_global_loss: 3609301.8029; train_optim_loss: 3609301.8029; val_kl_reg_loss: 23414.5001; val_edge_recon_loss: 712156.5532; val_cat_covariates_contrastive_loss: 948697.8657; val_gene_expr_recon_loss: 1909954.4126; val_masked_gp_l1_reg_loss: 39835.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8535.9199; val_global_loss: 3642594.3365; val_optim_loss: 3642594.3365
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9447; val_auprc_score: 0.9876; val_best_acc_score: 0.9460; val_best_f1_score: 0.9695; train_kl_reg_loss: 23571.4078; train_edge_recon_loss: 685682.4278; train_cat_covariates_contrastive_loss: 948494.7735; train_gene_expr_recon_loss: 1903472.9182; train_masked_gp_l1_reg_loss: 39894.4350; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8480.7139; train_global_loss: 3609596.6748; train_optim_loss: 3609596.6748; val_kl_reg_loss: 23555.0605; val_edge_recon_loss: 709798.1133; val_cat_covariates_contrastive_loss: 948772.5121; val_gene_expr_recon_loss: 1907702.0221; val_masked_gp_l1_reg_loss: 39846.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8496.3467; val_global_loss: 3638170.4567; val_optim_loss: 3638170.4567
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9432; val_auprc_score: 0.9874; val_best_acc_score: 0.9449; val_best_f1_score: 0.9688; train_kl_reg_loss: 23536.0745; train_edge_recon_loss: 682881.9880; train_cat_covariates_contrastive_loss: 948584.1667; train_gene_expr_recon_loss: 1902472.2987; train_masked_gp_l1_reg_loss: 39867.4754; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8486.6782; train_global_loss: 3605828.6841; train_optim_loss: 3605828.6841; val_kl_reg_loss: 23542.0147; val_edge_recon_loss: 707803.0141; val_cat_covariates_contrastive_loss: 949335.9840; val_gene_expr_recon_loss: 1905372.2102; val_masked_gp_l1_reg_loss: 39935.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8473.8350; val_global_loss: 3634462.2171; val_optim_loss: 3634462.2171
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9461; val_auprc_score: 0.9882; val_best_acc_score: 0.9461; val_best_f1_score: 0.9696; train_kl_reg_loss: 23486.8391; train_edge_recon_loss: 687164.4676; train_cat_covariates_contrastive_loss: 948418.9087; train_gene_expr_recon_loss: 1900003.3188; train_masked_gp_l1_reg_loss: 39852.8319; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8492.7498; train_global_loss: 3607419.1152; train_optim_loss: 3607419.1152; val_kl_reg_loss: 23405.5241; val_edge_recon_loss: 698976.6024; val_cat_covariates_contrastive_loss: 948802.8925; val_gene_expr_recon_loss: 1905033.6125; val_masked_gp_l1_reg_loss: 39812.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8436.2305; val_global_loss: 3624467.1367; val_optim_loss: 3624467.1367
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9439; val_auprc_score: 0.9876; val_best_acc_score: 0.9450; val_best_f1_score: 0.9689; train_kl_reg_loss: 23457.1629; train_edge_recon_loss: 684347.7209; train_cat_covariates_contrastive_loss: 948465.7005; train_gene_expr_recon_loss: 1899787.2383; train_masked_gp_l1_reg_loss: 39875.7551; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8500.9846; train_global_loss: 3604434.5615; train_optim_loss: 3604434.5615; val_kl_reg_loss: 23395.8964; val_edge_recon_loss: 709650.1049; val_cat_covariates_contrastive_loss: 948763.1319; val_gene_expr_recon_loss: 1905909.1929; val_masked_gp_l1_reg_loss: 39949.9805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8503.2188; val_global_loss: 3636171.5804; val_optim_loss: 3636171.5804
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9433; val_auprc_score: 0.9871; val_best_acc_score: 0.9461; val_best_f1_score: 0.9695; train_kl_reg_loss: 23434.2200; train_edge_recon_loss: 684190.1600; train_cat_covariates_contrastive_loss: 948471.2143; train_gene_expr_recon_loss: 1900238.4888; train_masked_gp_l1_reg_loss: 39916.6933; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8498.8597; train_global_loss: 3604749.6348; train_optim_loss: 3604749.6348; val_kl_reg_loss: 23439.5847; val_edge_recon_loss: 710618.4237; val_cat_covariates_contrastive_loss: 948453.5417; val_gene_expr_recon_loss: 1905001.1198; val_masked_gp_l1_reg_loss: 39969.8125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8538.3701; val_global_loss: 3636020.6721; val_optim_loss: 3636020.6721
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9446; val_auprc_score: 0.9876; val_best_acc_score: 0.9457; val_best_f1_score: 0.9692; train_kl_reg_loss: 23397.3309; train_edge_recon_loss: 683986.6751; train_cat_covariates_contrastive_loss: 948374.5342; train_gene_expr_recon_loss: 1899568.0762; train_masked_gp_l1_reg_loss: 39944.8049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8505.7221; train_global_loss: 3603777.1456; train_optim_loss: 3603777.1456; val_kl_reg_loss: 23432.6949; val_edge_recon_loss: 713406.8166; val_cat_covariates_contrastive_loss: 948494.5699; val_gene_expr_recon_loss: 1905657.6678; val_masked_gp_l1_reg_loss: 39901.4805; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8453.6094; val_global_loss: 3639346.7474; val_optim_loss: 3639346.7474
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9455; val_auprc_score: 0.9881; val_best_acc_score: 0.9459; val_best_f1_score: 0.9694; train_kl_reg_loss: 23398.0908; train_edge_recon_loss: 684910.9043; train_cat_covariates_contrastive_loss: 948476.9741; train_gene_expr_recon_loss: 1899608.0780; train_masked_gp_l1_reg_loss: 39971.1086; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8499.6796; train_global_loss: 3604864.8364; train_optim_loss: 3604864.8364; val_kl_reg_loss: 23508.6629; val_edge_recon_loss: 700690.2100; val_cat_covariates_contrastive_loss: 948642.7690; val_gene_expr_recon_loss: 1905006.8006; val_masked_gp_l1_reg_loss: 39976.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8517.1885; val_global_loss: 3626342.1851; val_optim_loss: 3626342.1851

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9434; val_auprc_score: 0.9872; val_best_acc_score: 0.9452; val_best_f1_score: 0.9690; train_kl_reg_loss: 23414.3466; train_edge_recon_loss: 683158.2553; train_cat_covariates_contrastive_loss: 948325.2611; train_gene_expr_recon_loss: 1899284.4132; train_masked_gp_l1_reg_loss: 38655.1056; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7595.8120; train_global_loss: 3600433.1940; train_optim_loss: 3600433.1940; val_kl_reg_loss: 23395.9908; val_edge_recon_loss: 711546.5549; val_cat_covariates_contrastive_loss: 948442.7920; val_gene_expr_recon_loss: 1902867.7491; val_masked_gp_l1_reg_loss: 38656.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7580.6885; val_global_loss: 3632490.8417; val_optim_loss: 3632490.8417
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9443; val_auprc_score: 0.9876; val_best_acc_score: 0.9456; val_best_f1_score: 0.9692; train_kl_reg_loss: 23351.7505; train_edge_recon_loss: 685914.2843; train_cat_covariates_contrastive_loss: 948424.4136; train_gene_expr_recon_loss: 1899471.1955; train_masked_gp_l1_reg_loss: 38670.4051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7583.8195; train_global_loss: 3603415.8654; train_optim_loss: 3603415.8654; val_kl_reg_loss: 23466.8575; val_edge_recon_loss: 703806.6094; val_cat_covariates_contrastive_loss: 949103.2444; val_gene_expr_recon_loss: 1904984.7902; val_masked_gp_l1_reg_loss: 38683.0742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7576.5352; val_global_loss: 3627620.9957; val_optim_loss: 3627620.9957
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9441; val_auprc_score: 0.9873; val_best_acc_score: 0.9453; val_best_f1_score: 0.9690; train_kl_reg_loss: 23363.2993; train_edge_recon_loss: 683005.3384; train_cat_covariates_contrastive_loss: 948378.0213; train_gene_expr_recon_loss: 1899497.2900; train_masked_gp_l1_reg_loss: 38680.8993; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7585.1408; train_global_loss: 3600509.9925; train_optim_loss: 3600509.9925; val_kl_reg_loss: 23439.4798; val_edge_recon_loss: 713312.7093; val_cat_covariates_contrastive_loss: 948273.7933; val_gene_expr_recon_loss: 1905170.9260; val_masked_gp_l1_reg_loss: 38687.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7590.5762; val_global_loss: 3636474.4144; val_optim_loss: 3636474.4144
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9444; val_auprc_score: 0.9876; val_best_acc_score: 0.9454; val_best_f1_score: 0.9690; train_kl_reg_loss: 23351.4303; train_edge_recon_loss: 683318.3226; train_cat_covariates_contrastive_loss: 948428.0020; train_gene_expr_recon_loss: 1899132.7219; train_masked_gp_l1_reg_loss: 38685.8327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 7589.6585; train_global_loss: 3600505.9681; train_optim_loss: 3600505.9681; val_kl_reg_loss: 23501.4679; val_edge_recon_loss: 713873.3231; val_cat_covariates_contrastive_loss: 948477.7288; val_gene_expr_recon_loss: 1904307.6293; val_masked_gp_l1_reg_loss: 38691.1836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 7594.3267; val_global_loss: 3636445.6497; val_optim_loss: 3636445.6497

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 871 min 36 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9284
val AUPRC score: 0.9807
val best accuracy score: 0.9429
val best F1 score: 0.9676
val target rna MSE score: 0.3757
val source rna MSE score: 0.1547
Val cat covariate0 mean sim diff: -0.0010
Val cat covariate1 mean sim diff: -0.0516
Val cat covariate2 mean sim diff: -0.0008

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
