[True]
Run timestamp: 10102023_100428_226.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_226']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7652; val_auprc_score: 0.7903; val_best_acc_score: 0.5155; val_best_f1_score: 0.6729; train_kl_reg_loss: 59034.3030; train_edge_recon_loss: 742859.7037; train_gene_expr_recon_loss: 22132564.6870; train_masked_gp_l1_reg_loss: 97602.4719; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2395713.0587; train_chrom_access_recon_loss: 2869679.9885; train_global_loss: 28297454.3053; train_optim_loss: 28297454.3053; val_kl_reg_loss: 83063.0557; val_edge_recon_loss: 812897.9125; val_gene_expr_recon_loss: 20948320.4000; val_masked_gp_l1_reg_loss: 80052.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 905535.1875; val_chrom_access_recon_loss: 2763227.1000; val_global_loss: 25593096.6667; val_optim_loss: 25593096.6667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8411; val_auprc_score: 0.8473; val_best_acc_score: 0.7591; val_best_f1_score: 0.7646; train_kl_reg_loss: 67816.3592; train_edge_recon_loss: 730173.5997; train_gene_expr_recon_loss: 20855953.6794; train_masked_gp_l1_reg_loss: 77372.9300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 480556.3684; train_chrom_access_recon_loss: 2757134.3340; train_global_loss: 24969007.1145; train_optim_loss: 24969007.1145; val_kl_reg_loss: 65445.6654; val_edge_recon_loss: 798485.8333; val_gene_expr_recon_loss: 20562775.6000; val_masked_gp_l1_reg_loss: 77284.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 260059.3438; val_chrom_access_recon_loss: 2717882.4833; val_global_loss: 24481933.3333; val_optim_loss: 24481933.3333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8967; val_auprc_score: 0.8895; val_best_acc_score: 0.8139; val_best_f1_score: 0.8236; train_kl_reg_loss: 60453.0640; train_edge_recon_loss: 711023.7071; train_gene_expr_recon_loss: 20589293.5573; train_masked_gp_l1_reg_loss: 78544.6696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 198524.8804; train_chrom_access_recon_loss: 2735172.4351; train_global_loss: 24373012.2137; train_optim_loss: 24373012.2137; val_kl_reg_loss: 58477.0612; val_edge_recon_loss: 723581.9625; val_gene_expr_recon_loss: 20387647.8667; val_masked_gp_l1_reg_loss: 80200.5000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158372.3125; val_chrom_access_recon_loss: 2697520.5000; val_global_loss: 24105799.0667; val_optim_loss: 24105799.0667
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9147; val_auprc_score: 0.9024; val_best_acc_score: 0.8383; val_best_f1_score: 0.8443; train_kl_reg_loss: 66135.7253; train_edge_recon_loss: 648961.1155; train_gene_expr_recon_loss: 20338435.5267; train_masked_gp_l1_reg_loss: 81775.2085; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139301.0554; train_chrom_access_recon_loss: 2705753.7500; train_global_loss: 23980362.4122; train_optim_loss: 23980362.4122; val_kl_reg_loss: 69335.7573; val_edge_recon_loss: 627203.9708; val_gene_expr_recon_loss: 20100714.5333; val_masked_gp_l1_reg_loss: 83189.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 123016.5703; val_chrom_access_recon_loss: 2674248.1167; val_global_loss: 23677708.4000; val_optim_loss: 23677708.4000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9294; val_auprc_score: 0.9183; val_best_acc_score: 0.8604; val_best_f1_score: 0.8650; train_kl_reg_loss: 69336.6021; train_edge_recon_loss: 615771.4227; train_gene_expr_recon_loss: 20163954.9466; train_masked_gp_l1_reg_loss: 84680.0413; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113098.6845; train_chrom_access_recon_loss: 2685897.0649; train_global_loss: 23732738.6718; train_optim_loss: 23732738.6718; val_kl_reg_loss: 68588.2203; val_edge_recon_loss: 616336.9500; val_gene_expr_recon_loss: 20013761.8667; val_masked_gp_l1_reg_loss: 86598.5469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107025.7500; val_chrom_access_recon_loss: 2650863.9333; val_global_loss: 23543174.8000; val_optim_loss: 23543174.8000
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9335; val_auprc_score: 0.9212; val_best_acc_score: 0.8635; val_best_f1_score: 0.8714; train_kl_reg_loss: 67751.5901; train_edge_recon_loss: 607629.3449; train_gene_expr_recon_loss: 19973711.1450; train_masked_gp_l1_reg_loss: 87561.5625; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99867.2776; train_chrom_access_recon_loss: 2661203.4637; train_global_loss: 23497724.3817; train_optim_loss: 23497724.3817; val_kl_reg_loss: 68281.6656; val_edge_recon_loss: 606812.3042; val_gene_expr_recon_loss: 19830740.6667; val_masked_gp_l1_reg_loss: 88615.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94721.7109; val_chrom_access_recon_loss: 2645338.7500; val_global_loss: 23334511.3333; val_optim_loss: 23334511.3333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9398; val_auprc_score: 0.9260; val_best_acc_score: 0.8684; val_best_f1_score: 0.8766; train_kl_reg_loss: 66476.3169; train_edge_recon_loss: 600136.3941; train_gene_expr_recon_loss: 19849009.3435; train_masked_gp_l1_reg_loss: 89218.3612; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90382.5341; train_chrom_access_recon_loss: 2645081.7462; train_global_loss: 23340304.7939; train_optim_loss: 23340304.7939; val_kl_reg_loss: 63985.6365; val_edge_recon_loss: 600715.7500; val_gene_expr_recon_loss: 19657299.3333; val_masked_gp_l1_reg_loss: 90074.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87759.3750; val_chrom_access_recon_loss: 2607550.1500; val_global_loss: 23107384.9333; val_optim_loss: 23107384.9333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9424; val_auprc_score: 0.9265; val_best_acc_score: 0.8800; val_best_f1_score: 0.8853; train_kl_reg_loss: 64742.0293; train_edge_recon_loss: 596530.6608; train_gene_expr_recon_loss: 19725010.7176; train_masked_gp_l1_reg_loss: 90688.0782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84178.0768; train_chrom_access_recon_loss: 2627015.5458; train_global_loss: 23188165.1603; train_optim_loss: 23188165.1603; val_kl_reg_loss: 65292.7049; val_edge_recon_loss: 596798.4583; val_gene_expr_recon_loss: 19554208.6667; val_masked_gp_l1_reg_loss: 91455.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82106.4688; val_chrom_access_recon_loss: 2598539.5833; val_global_loss: 22988401.2000; val_optim_loss: 22988401.2000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9468; val_auprc_score: 0.9332; val_best_acc_score: 0.8777; val_best_f1_score: 0.8835; train_kl_reg_loss: 63313.0081; train_edge_recon_loss: 592032.8402; train_gene_expr_recon_loss: 19614542.0763; train_masked_gp_l1_reg_loss: 91967.0926; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80005.8746; train_chrom_access_recon_loss: 2609485.0553; train_global_loss: 23051345.9237; train_optim_loss: 23051345.9237; val_kl_reg_loss: 64273.3250; val_edge_recon_loss: 592115.0708; val_gene_expr_recon_loss: 19455363.3333; val_masked_gp_l1_reg_loss: 92751.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79153.2344; val_chrom_access_recon_loss: 2581709.0500; val_global_loss: 22865366.8000; val_optim_loss: 22865366.8000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9546; val_auprc_score: 0.9439; val_best_acc_score: 0.8960; val_best_f1_score: 0.9010; train_kl_reg_loss: 62236.7234; train_edge_recon_loss: 589857.0110; train_gene_expr_recon_loss: 19533088.6870; train_masked_gp_l1_reg_loss: 93031.0150; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77457.2234; train_chrom_access_recon_loss: 2599454.2672; train_global_loss: 22955124.8092; train_optim_loss: 22955124.8092; val_kl_reg_loss: 61887.2714; val_edge_recon_loss: 591919.1750; val_gene_expr_recon_loss: 19330117.6000; val_masked_gp_l1_reg_loss: 93724.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76875.6250; val_chrom_access_recon_loss: 2563334.8000; val_global_loss: 22717858.9333; val_optim_loss: 22717858.9333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9562; val_auprc_score: 0.9449; val_best_acc_score: 0.8992; val_best_f1_score: 0.9036; train_kl_reg_loss: 61218.8895; train_edge_recon_loss: 588519.5973; train_gene_expr_recon_loss: 19407070.2748; train_masked_gp_l1_reg_loss: 94094.1964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75649.2972; train_chrom_access_recon_loss: 2585499.7824; train_global_loss: 22812052.0305; train_optim_loss: 22812052.0305; val_kl_reg_loss: 62095.5307; val_edge_recon_loss: 588226.7333; val_gene_expr_recon_loss: 19264958.4000; val_masked_gp_l1_reg_loss: 94951.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76244.8516; val_chrom_access_recon_loss: 2566657.8000; val_global_loss: 22653134.2667; val_optim_loss: 22653134.2667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9546; val_auprc_score: 0.9435; val_best_acc_score: 0.8938; val_best_f1_score: 0.9000; train_kl_reg_loss: 60384.3907; train_edge_recon_loss: 586522.1560; train_gene_expr_recon_loss: 19338548.1985; train_masked_gp_l1_reg_loss: 95141.7593; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75111.1276; train_chrom_access_recon_loss: 2568928.8950; train_global_loss: 22724636.4733; train_optim_loss: 22724636.4733; val_kl_reg_loss: 59764.1974; val_edge_recon_loss: 588458.5750; val_gene_expr_recon_loss: 19165682.9333; val_masked_gp_l1_reg_loss: 95385.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74187.2031; val_chrom_access_recon_loss: 2548785.9833; val_global_loss: 22532265.7333; val_optim_loss: 22532265.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9573; val_auprc_score: 0.9432; val_best_acc_score: 0.9003; val_best_f1_score: 0.9056; train_kl_reg_loss: 59865.1907; train_edge_recon_loss: 584465.2438; train_gene_expr_recon_loss: 19262958.6565; train_masked_gp_l1_reg_loss: 95923.8288; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73826.4507; train_chrom_access_recon_loss: 2560351.4905; train_global_loss: 22637390.9160; train_optim_loss: 22637390.9160; val_kl_reg_loss: 60452.8326; val_edge_recon_loss: 587682.9292; val_gene_expr_recon_loss: 19173167.0667; val_masked_gp_l1_reg_loss: 96370.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73247.6094; val_chrom_access_recon_loss: 2530472.9500; val_global_loss: 22521393.6000; val_optim_loss: 22521393.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9618; val_auprc_score: 0.9464; val_best_acc_score: 0.9120; val_best_f1_score: 0.9144; train_kl_reg_loss: 59307.8606; train_edge_recon_loss: 583072.5663; train_gene_expr_recon_loss: 19206687.1603; train_masked_gp_l1_reg_loss: 96932.1985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73119.1486; train_chrom_access_recon_loss: 2549111.1088; train_global_loss: 22568230.0153; train_optim_loss: 22568230.0153; val_kl_reg_loss: 58330.8773; val_edge_recon_loss: 583525.4083; val_gene_expr_recon_loss: 19038160.8000; val_masked_gp_l1_reg_loss: 97431.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73371.5547; val_chrom_access_recon_loss: 2528834.2667; val_global_loss: 22379655.4667; val_optim_loss: 22379655.4667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9603; val_auprc_score: 0.9482; val_best_acc_score: 0.9078; val_best_f1_score: 0.9123; train_kl_reg_loss: 58521.5946; train_edge_recon_loss: 581374.0487; train_gene_expr_recon_loss: 19119562.1069; train_masked_gp_l1_reg_loss: 98117.9129; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72887.3531; train_chrom_access_recon_loss: 2538425.9065; train_global_loss: 22468888.8550; train_optim_loss: 22468888.8550; val_kl_reg_loss: 57356.1125; val_edge_recon_loss: 587039.2250; val_gene_expr_recon_loss: 19000212.1333; val_masked_gp_l1_reg_loss: 98904.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72601.1172; val_chrom_access_recon_loss: 2512895.5500; val_global_loss: 22329009.2000; val_optim_loss: 22329009.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9595; val_auprc_score: 0.9454; val_best_acc_score: 0.9091; val_best_f1_score: 0.9127; train_kl_reg_loss: 58042.0558; train_edge_recon_loss: 581979.1885; train_gene_expr_recon_loss: 19052464.9618; train_masked_gp_l1_reg_loss: 99351.9624; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72543.9859; train_chrom_access_recon_loss: 2529651.4179; train_global_loss: 22394033.5725; train_optim_loss: 22394033.5725; val_kl_reg_loss: 58335.3000; val_edge_recon_loss: 585853.1875; val_gene_expr_recon_loss: 18936411.3333; val_masked_gp_l1_reg_loss: 99766.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72114.3125; val_chrom_access_recon_loss: 2505937.5667; val_global_loss: 22258416.9333; val_optim_loss: 22258416.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9619; val_auprc_score: 0.9497; val_best_acc_score: 0.9080; val_best_f1_score: 0.9124; train_kl_reg_loss: 57244.7195; train_edge_recon_loss: 580707.2667; train_gene_expr_recon_loss: 18947890.6412; train_masked_gp_l1_reg_loss: 100891.4955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72133.4453; train_chrom_access_recon_loss: 2515061.7958; train_global_loss: 22273929.2977; train_optim_loss: 22273929.2977; val_kl_reg_loss: 57426.4427; val_edge_recon_loss: 580055.7458; val_gene_expr_recon_loss: 18857183.2000; val_masked_gp_l1_reg_loss: 102047.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72484.6406; val_chrom_access_recon_loss: 2500114.1833; val_global_loss: 22169311.2000; val_optim_loss: 22169311.2000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9647; val_auprc_score: 0.9527; val_best_acc_score: 0.9142; val_best_f1_score: 0.9172; train_kl_reg_loss: 56913.2986; train_edge_recon_loss: 577707.9084; train_gene_expr_recon_loss: 18912407.4046; train_masked_gp_l1_reg_loss: 102877.6830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72207.5681; train_chrom_access_recon_loss: 2511152.1298; train_global_loss: 22233266.0458; train_optim_loss: 22233266.0458; val_kl_reg_loss: 57318.9893; val_edge_recon_loss: 577149.8833; val_gene_expr_recon_loss: 18728298.1333; val_masked_gp_l1_reg_loss: 103601.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72599.4609; val_chrom_access_recon_loss: 2507925.8500; val_global_loss: 22046894.9333; val_optim_loss: 22046894.9333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9638; val_auprc_score: 0.9533; val_best_acc_score: 0.9122; val_best_f1_score: 0.9155; train_kl_reg_loss: 56250.2085; train_edge_recon_loss: 578812.4251; train_gene_expr_recon_loss: 18861743.8931; train_masked_gp_l1_reg_loss: 104708.2224; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72179.9930; train_chrom_access_recon_loss: 2503983.0458; train_global_loss: 22177677.8931; train_optim_loss: 22177677.8931; val_kl_reg_loss: 56796.1943; val_edge_recon_loss: 578786.3667; val_gene_expr_recon_loss: 18743898.8000; val_masked_gp_l1_reg_loss: 105808.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72547.0547; val_chrom_access_recon_loss: 2484780.9667; val_global_loss: 22042618.1333; val_optim_loss: 22042618.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9627; val_auprc_score: 0.9483; val_best_acc_score: 0.9124; val_best_f1_score: 0.9164; train_kl_reg_loss: 55813.4258; train_edge_recon_loss: 578346.7538; train_gene_expr_recon_loss: 18768328.9618; train_masked_gp_l1_reg_loss: 106856.8093; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72271.6394; train_chrom_access_recon_loss: 2491344.1641; train_global_loss: 22072961.7405; train_optim_loss: 22072961.7405; val_kl_reg_loss: 55635.1328; val_edge_recon_loss: 579643.9625; val_gene_expr_recon_loss: 18731549.0667; val_masked_gp_l1_reg_loss: 107807.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72759.7500; val_chrom_access_recon_loss: 2479624.1167; val_global_loss: 22027020.5333; val_optim_loss: 22027020.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9635; val_auprc_score: 0.9515; val_best_acc_score: 0.9122; val_best_f1_score: 0.9151; train_kl_reg_loss: 55494.5031; train_edge_recon_loss: 577652.5086; train_gene_expr_recon_loss: 18704110.8779; train_masked_gp_l1_reg_loss: 108775.9847; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72498.7273; train_chrom_access_recon_loss: 2482733.0134; train_global_loss: 22001265.6336; train_optim_loss: 22001265.6336; val_kl_reg_loss: 53807.3961; val_edge_recon_loss: 577666.4958; val_gene_expr_recon_loss: 18598341.7333; val_masked_gp_l1_reg_loss: 109514.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73097.5547; val_chrom_access_recon_loss: 2474997.3333; val_global_loss: 21887425.2000; val_optim_loss: 21887425.2000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9644; val_auprc_score: 0.9518; val_best_acc_score: 0.9174; val_best_f1_score: 0.9205; train_kl_reg_loss: 55779.5278; train_edge_recon_loss: 576912.2543; train_gene_expr_recon_loss: 18619539.3282; train_masked_gp_l1_reg_loss: 110537.7784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72545.2378; train_chrom_access_recon_loss: 2470882.6660; train_global_loss: 21906196.9008; train_optim_loss: 21906196.9008; val_kl_reg_loss: 56359.2878; val_edge_recon_loss: 575895.1625; val_gene_expr_recon_loss: 18546106.1333; val_masked_gp_l1_reg_loss: 111650.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72764.6875; val_chrom_access_recon_loss: 2461533.3167; val_global_loss: 21824308.0000; val_optim_loss: 21824308.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9639; val_auprc_score: 0.9530; val_best_acc_score: 0.9132; val_best_f1_score: 0.9174; train_kl_reg_loss: 55734.6043; train_edge_recon_loss: 576833.2319; train_gene_expr_recon_loss: 18559293.2214; train_masked_gp_l1_reg_loss: 112164.6324; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72972.6894; train_chrom_access_recon_loss: 2467614.9370; train_global_loss: 21844613.2824; train_optim_loss: 21844613.2824; val_kl_reg_loss: 57457.7943; val_edge_recon_loss: 579716.8875; val_gene_expr_recon_loss: 18481545.6000; val_masked_gp_l1_reg_loss: 112867.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73091.2969; val_chrom_access_recon_loss: 2462463.1333; val_global_loss: 21767143.4667; val_optim_loss: 21767143.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9593; val_auprc_score: 0.9437; val_best_acc_score: 0.9077; val_best_f1_score: 0.9121; train_kl_reg_loss: 56224.8804; train_edge_recon_loss: 576375.0487; train_gene_expr_recon_loss: 18478755.5267; train_masked_gp_l1_reg_loss: 113688.7873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72861.2859; train_chrom_access_recon_loss: 2454195.1603; train_global_loss: 21752100.8855; train_optim_loss: 21752100.8855; val_kl_reg_loss: 56175.0117; val_edge_recon_loss: 581846.8000; val_gene_expr_recon_loss: 18398030.2667; val_masked_gp_l1_reg_loss: 114401.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73061.3438; val_chrom_access_recon_loss: 2436978.8333; val_global_loss: 21660494.6667; val_optim_loss: 21660494.6667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9606; val_auprc_score: 0.9462; val_best_acc_score: 0.9105; val_best_f1_score: 0.9146; train_kl_reg_loss: 56250.3814; train_edge_recon_loss: 576505.9914; train_gene_expr_recon_loss: 18413121.1908; train_masked_gp_l1_reg_loss: 115182.0510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73259.7041; train_chrom_access_recon_loss: 2446934.6813; train_global_loss: 21681253.9847; train_optim_loss: 21681253.9847; val_kl_reg_loss: 56224.5620; val_edge_recon_loss: 578129.0750; val_gene_expr_recon_loss: 18331149.4667; val_masked_gp_l1_reg_loss: 115942.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73633.8750; val_chrom_access_recon_loss: 2431479.1333; val_global_loss: 21586558.4000; val_optim_loss: 21586558.4000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9632; val_auprc_score: 0.9484; val_best_acc_score: 0.9144; val_best_f1_score: 0.9175; train_kl_reg_loss: 56567.5454; train_edge_recon_loss: 576875.1942; train_gene_expr_recon_loss: 18360043.7405; train_masked_gp_l1_reg_loss: 116479.5429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73578.0484; train_chrom_access_recon_loss: 2440331.6069; train_global_loss: 21623875.6947; train_optim_loss: 21623875.6947; val_kl_reg_loss: 57289.0104; val_edge_recon_loss: 578522.8167; val_gene_expr_recon_loss: 18405435.2000; val_masked_gp_l1_reg_loss: 117018.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74333.2109; val_chrom_access_recon_loss: 2443187.9500; val_global_loss: 21675786.9333; val_optim_loss: 21675786.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9606; val_auprc_score: 0.9478; val_best_acc_score: 0.9099; val_best_f1_score: 0.9148; train_kl_reg_loss: 57198.0508; train_edge_recon_loss: 577036.3774; train_gene_expr_recon_loss: 18298749.6031; train_masked_gp_l1_reg_loss: 117502.3795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73910.2340; train_chrom_access_recon_loss: 2432394.1050; train_global_loss: 21556790.7786; train_optim_loss: 21556790.7786; val_kl_reg_loss: 57618.9766; val_edge_recon_loss: 580760.7625; val_gene_expr_recon_loss: 18312665.4667; val_masked_gp_l1_reg_loss: 117970.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74675.7422; val_chrom_access_recon_loss: 2428034.1000; val_global_loss: 21571725.3333; val_optim_loss: 21571725.3333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9633; val_auprc_score: 0.9504; val_best_acc_score: 0.9113; val_best_f1_score: 0.9142; train_kl_reg_loss: 57450.0846; train_edge_recon_loss: 577101.0553; train_gene_expr_recon_loss: 18232653.0763; train_masked_gp_l1_reg_loss: 118428.9039; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74288.1033; train_chrom_access_recon_loss: 2423148.5687; train_global_loss: 21483069.7099; train_optim_loss: 21483069.7099; val_kl_reg_loss: 58192.4068; val_edge_recon_loss: 577185.1208; val_gene_expr_recon_loss: 18256527.6000; val_masked_gp_l1_reg_loss: 118941.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74345.1484; val_chrom_access_recon_loss: 2423120.0333; val_global_loss: 21508312.8000; val_optim_loss: 21508312.8000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9595; val_auprc_score: 0.9455; val_best_acc_score: 0.9080; val_best_f1_score: 0.9125; train_kl_reg_loss: 57937.6235; train_edge_recon_loss: 579266.5553; train_gene_expr_recon_loss: 18197760.8244; train_masked_gp_l1_reg_loss: 119202.7814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74356.3250; train_chrom_access_recon_loss: 2416637.3626; train_global_loss: 21445161.4046; train_optim_loss: 21445161.4046; val_kl_reg_loss: 57894.9672; val_edge_recon_loss: 584486.9208; val_gene_expr_recon_loss: 18246709.3333; val_masked_gp_l1_reg_loss: 119694.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74952.3125; val_chrom_access_recon_loss: 2419744.7167; val_global_loss: 21503482.0000; val_optim_loss: 21503482.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9569; val_auprc_score: 0.9420; val_best_acc_score: 0.9058; val_best_f1_score: 0.9104; train_kl_reg_loss: 58340.5884; train_edge_recon_loss: 578303.8120; train_gene_expr_recon_loss: 18155916.3053; train_masked_gp_l1_reg_loss: 119921.2403; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74877.0528; train_chrom_access_recon_loss: 2409721.1317; train_global_loss: 21397080.1527; train_optim_loss: 21397080.1527; val_kl_reg_loss: 60047.2656; val_edge_recon_loss: 584311.5125; val_gene_expr_recon_loss: 18269910.6667; val_masked_gp_l1_reg_loss: 120203.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74376.9141; val_chrom_access_recon_loss: 2418582.7333; val_global_loss: 21527432.2667; val_optim_loss: 21527432.2667
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9540; val_auprc_score: 0.9376; val_best_acc_score: 0.9014; val_best_f1_score: 0.9060; train_kl_reg_loss: 60323.7128; train_edge_recon_loss: 577569.7123; train_gene_expr_recon_loss: 18120822.1603; train_masked_gp_l1_reg_loss: 120120.6667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74935.6327; train_chrom_access_recon_loss: 2403934.3912; train_global_loss: 21357706.2443; train_optim_loss: 21357706.2443; val_kl_reg_loss: 60703.7109; val_edge_recon_loss: 584193.4458; val_gene_expr_recon_loss: 18177137.8667; val_masked_gp_l1_reg_loss: 120210.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76013.7656; val_chrom_access_recon_loss: 2421111.0167; val_global_loss: 21439370.1333; val_optim_loss: 21439370.1333
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9559; val_auprc_score: 0.9424; val_best_acc_score: 0.9012; val_best_f1_score: 0.9070; train_kl_reg_loss: 60233.8836; train_edge_recon_loss: 579396.9423; train_gene_expr_recon_loss: 18064497.0229; train_masked_gp_l1_reg_loss: 120520.9104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75693.6549; train_chrom_access_recon_loss: 2397195.7500; train_global_loss: 21297538.0153; train_optim_loss: 21297538.0153; val_kl_reg_loss: 60731.8958; val_edge_recon_loss: 585698.8958; val_gene_expr_recon_loss: 18188502.9333; val_masked_gp_l1_reg_loss: 120759.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76330.8281; val_chrom_access_recon_loss: 2423087.6333; val_global_loss: 21455111.4667; val_optim_loss: 21455111.4667
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9605; val_auprc_score: 0.9482; val_best_acc_score: 0.9104; val_best_f1_score: 0.9146; train_kl_reg_loss: 60792.1086; train_edge_recon_loss: 578807.5587; train_gene_expr_recon_loss: 18026882.4046; train_masked_gp_l1_reg_loss: 120881.0989; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76014.3749; train_chrom_access_recon_loss: 2390631.1641; train_global_loss: 21254008.8092; train_optim_loss: 21254008.8092; val_kl_reg_loss: 60121.5461; val_edge_recon_loss: 581976.1625; val_gene_expr_recon_loss: 18085509.7333; val_masked_gp_l1_reg_loss: 121167.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76283.9375; val_chrom_access_recon_loss: 2394976.9000; val_global_loss: 21320036.4000; val_optim_loss: 21320036.4000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9575; val_auprc_score: 0.9423; val_best_acc_score: 0.9030; val_best_f1_score: 0.9080; train_kl_reg_loss: 61333.3825; train_edge_recon_loss: 581826.0377; train_gene_expr_recon_loss: 18049783.9313; train_masked_gp_l1_reg_loss: 121502.2887; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77254.0985; train_chrom_access_recon_loss: 2396562.4370; train_global_loss: 21288262.1985; train_optim_loss: 21288262.1985; val_kl_reg_loss: 62386.9036; val_edge_recon_loss: 585275.9750; val_gene_expr_recon_loss: 18188900.8000; val_masked_gp_l1_reg_loss: 120501.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 79124.8750; val_chrom_access_recon_loss: 2418792.6333; val_global_loss: 21454982.4000; val_optim_loss: 21454982.4000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9565; val_auprc_score: 0.9417; val_best_acc_score: 0.9018; val_best_f1_score: 0.9076; train_kl_reg_loss: 62466.7663; train_edge_recon_loss: 581280.7805; train_gene_expr_recon_loss: 18003455.1145; train_masked_gp_l1_reg_loss: 120852.8915; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79222.4935; train_chrom_access_recon_loss: 2387468.5324; train_global_loss: 21234746.3969; train_optim_loss: 21234746.3969; val_kl_reg_loss: 62646.5776; val_edge_recon_loss: 584314.8208; val_gene_expr_recon_loss: 18147687.6000; val_masked_gp_l1_reg_loss: 120806.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77735.8984; val_chrom_access_recon_loss: 2416368.6333; val_global_loss: 21409560.0000; val_optim_loss: 21409560.0000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9573; val_auprc_score: 0.9434; val_best_acc_score: 0.9066; val_best_f1_score: 0.9106; train_kl_reg_loss: 63130.0355; train_edge_recon_loss: 580706.5377; train_gene_expr_recon_loss: 17969560.0687; train_masked_gp_l1_reg_loss: 120313.5807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77672.1704; train_chrom_access_recon_loss: 2382003.9179; train_global_loss: 21193386.1985; train_optim_loss: 21193386.1985; val_kl_reg_loss: 63362.5086; val_edge_recon_loss: 585748.9500; val_gene_expr_recon_loss: 18111331.6000; val_masked_gp_l1_reg_loss: 120321.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78049.8047; val_chrom_access_recon_loss: 2411123.1167; val_global_loss: 21369938.0000; val_optim_loss: 21369938.0000
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9551; val_auprc_score: 0.9364; val_best_acc_score: 0.9029; val_best_f1_score: 0.9070; train_kl_reg_loss: 67403.5564; train_edge_recon_loss: 584789.5844; train_gene_expr_recon_loss: 17973466.3359; train_masked_gp_l1_reg_loss: 120978.7964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78246.5862; train_chrom_access_recon_loss: 2382547.5553; train_global_loss: 21207432.4733; train_optim_loss: 21207432.4733; val_kl_reg_loss: 55021.2003; val_edge_recon_loss: 605975.2250; val_gene_expr_recon_loss: 18399694.8000; val_masked_gp_l1_reg_loss: 126897.9922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83641.8750; val_chrom_access_recon_loss: 2459185.1000; val_global_loss: 21730416.5333; val_optim_loss: 21730416.5333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9584; val_auprc_score: 0.9446; val_best_acc_score: 0.9047; val_best_f1_score: 0.9104; train_kl_reg_loss: 56707.7528; train_edge_recon_loss: 590651.3173; train_gene_expr_recon_loss: 18229784.5954; train_masked_gp_l1_reg_loss: 118564.8346; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60036.2881; train_chrom_access_recon_loss: 2408048.2958; train_global_loss: 21463793.0534; train_optim_loss: 21463793.0534; val_kl_reg_loss: 59225.5846; val_edge_recon_loss: 588509.5542; val_gene_expr_recon_loss: 18161629.3333; val_masked_gp_l1_reg_loss: 114690.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54775.8438; val_chrom_access_recon_loss: 2409957.9833; val_global_loss: 21388788.8000; val_optim_loss: 21388788.8000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9618; val_auprc_score: 0.9520; val_best_acc_score: 0.9103; val_best_f1_score: 0.9153; train_kl_reg_loss: 60813.1521; train_edge_recon_loss: 583364.1913; train_gene_expr_recon_loss: 18063345.7786; train_masked_gp_l1_reg_loss: 113638.3945; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53685.6160; train_chrom_access_recon_loss: 2384932.2748; train_global_loss: 21259779.5115; train_optim_loss: 21259779.5115; val_kl_reg_loss: 62763.8310; val_edge_recon_loss: 582209.6917; val_gene_expr_recon_loss: 18167165.6000; val_masked_gp_l1_reg_loss: 112782.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53036.3633; val_chrom_access_recon_loss: 2402998.4000; val_global_loss: 21380955.4667; val_optim_loss: 21380955.4667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9555; val_auprc_score: 0.9421; val_best_acc_score: 0.9033; val_best_f1_score: 0.9083; train_kl_reg_loss: 62876.5391; train_edge_recon_loss: 581076.0859; train_gene_expr_recon_loss: 18032212.5878; train_masked_gp_l1_reg_loss: 112314.2864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52451.3470; train_chrom_access_recon_loss: 2380828.4370; train_global_loss: 21221759.2672; train_optim_loss: 21221759.2672; val_kl_reg_loss: 63821.0445; val_edge_recon_loss: 587103.6708; val_gene_expr_recon_loss: 18145400.8000; val_masked_gp_l1_reg_loss: 111940.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52103.0859; val_chrom_access_recon_loss: 2405568.9667; val_global_loss: 21365938.2667; val_optim_loss: 21365938.2667
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9584; val_auprc_score: 0.9448; val_best_acc_score: 0.9039; val_best_f1_score: 0.9089; train_kl_reg_loss: 64152.2700; train_edge_recon_loss: 580608.7925; train_gene_expr_recon_loss: 17972781.0076; train_masked_gp_l1_reg_loss: 111688.4240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51699.6829; train_chrom_access_recon_loss: 2373652.5973; train_global_loss: 21154582.7481; train_optim_loss: 21154582.7481; val_kl_reg_loss: 65020.4260; val_edge_recon_loss: 585377.9042; val_gene_expr_recon_loss: 18166670.6667; val_masked_gp_l1_reg_loss: 111486.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51432.2148; val_chrom_access_recon_loss: 2402314.1500; val_global_loss: 21382301.2000; val_optim_loss: 21382301.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 49 sec.
Using best model state, which was in epoch 33.

--- MODEL EVALUATION ---
val AUROC score: 0.9591
val AUPRC score: 0.9468
val best accuracy score: 0.9093
val best F1 score: 0.9127
val target rna MSE score: 1.1300
val source rna MSE score: 0.3916
val target atac MSE score: 0.5001
val source atac MSE score: 0.1394
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
