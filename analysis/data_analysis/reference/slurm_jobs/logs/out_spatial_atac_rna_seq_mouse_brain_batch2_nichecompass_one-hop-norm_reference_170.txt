[True]
Run timestamp: 10102023_062501_170.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_170']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2310, n_latent: 2210, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2210, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7636; val_auprc_score: 0.7884; val_best_acc_score: 0.5449; val_best_f1_score: 0.6844; train_kl_reg_loss: 57901.2728; train_edge_recon_loss: 742692.6775; train_gene_expr_recon_loss: 22355960.5649; train_masked_gp_l1_reg_loss: 142067.8101; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3410007.7514; train_chrom_access_recon_loss: 953491.9337; train_global_loss: 27662121.7710; train_optim_loss: 27662121.7710; val_kl_reg_loss: 63904.2237; val_edge_recon_loss: 812548.0583; val_gene_expr_recon_loss: 20881541.4667; val_masked_gp_l1_reg_loss: 117411.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 890636.7500; val_chrom_access_recon_loss: 910140.3083; val_global_loss: 23676182.0000; val_optim_loss: 23676182.0000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8227; val_auprc_score: 0.8315; val_best_acc_score: 0.7183; val_best_f1_score: 0.7512; train_kl_reg_loss: 68557.5540; train_edge_recon_loss: 732781.8039; train_gene_expr_recon_loss: 20943706.9313; train_masked_gp_l1_reg_loss: 112764.5100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 442454.3090; train_chrom_access_recon_loss: 915841.2758; train_global_loss: 23216106.5496; train_optim_loss: 23216106.5496; val_kl_reg_loss: 68125.7578; val_edge_recon_loss: 806657.5333; val_gene_expr_recon_loss: 20413837.0667; val_masked_gp_l1_reg_loss: 110917.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 230840.6875; val_chrom_access_recon_loss: 893515.7375; val_global_loss: 22523894.1333; val_optim_loss: 22523894.1333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8685; val_auprc_score: 0.8736; val_best_acc_score: 0.7811; val_best_f1_score: 0.7943; train_kl_reg_loss: 63282.6842; train_edge_recon_loss: 721601.1803; train_gene_expr_recon_loss: 20646292.0763; train_masked_gp_l1_reg_loss: 111057.2114; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 175357.6713; train_chrom_access_recon_loss: 905399.0043; train_global_loss: 22622989.8473; train_optim_loss: 22622989.8473; val_kl_reg_loss: 62322.2018; val_edge_recon_loss: 768870.3667; val_gene_expr_recon_loss: 20232531.2000; val_masked_gp_l1_reg_loss: 111964.5859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145057.2188; val_chrom_access_recon_loss: 891280.0208; val_global_loss: 22212025.6000; val_optim_loss: 22212025.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9134; val_auprc_score: 0.9088; val_best_acc_score: 0.8355; val_best_f1_score: 0.8408; train_kl_reg_loss: 61043.1268; train_edge_recon_loss: 691520.5768; train_gene_expr_recon_loss: 20401979.4962; train_masked_gp_l1_reg_loss: 113290.3896; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 129860.0100; train_chrom_access_recon_loss: 896838.1770; train_global_loss: 22294531.8168; train_optim_loss: 22294531.8168; val_kl_reg_loss: 63633.9042; val_edge_recon_loss: 670640.0208; val_gene_expr_recon_loss: 19870459.0667; val_masked_gp_l1_reg_loss: 114966.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122206.3359; val_chrom_access_recon_loss: 879405.9250; val_global_loss: 21721310.8000; val_optim_loss: 21721310.8000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9258; val_auprc_score: 0.9156; val_best_acc_score: 0.8517; val_best_f1_score: 0.8591; train_kl_reg_loss: 71600.8156; train_edge_recon_loss: 634182.8917; train_gene_expr_recon_loss: 20182764.9618; train_masked_gp_l1_reg_loss: 115819.5892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 117775.1787; train_chrom_access_recon_loss: 890234.9494; train_global_loss: 22012378.4122; train_optim_loss: 22012378.4122; val_kl_reg_loss: 74917.0089; val_edge_recon_loss: 621265.6167; val_gene_expr_recon_loss: 19823890.0000; val_masked_gp_l1_reg_loss: 116930.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 111914.5000; val_chrom_access_recon_loss: 878002.2792; val_global_loss: 21626919.3333; val_optim_loss: 21626919.3333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9286; val_auprc_score: 0.9162; val_best_acc_score: 0.8597; val_best_f1_score: 0.8685; train_kl_reg_loss: 74345.4509; train_edge_recon_loss: 615327.5496; train_gene_expr_recon_loss: 20023344.7939; train_masked_gp_l1_reg_loss: 117913.0428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110157.9249; train_chrom_access_recon_loss: 883282.4752; train_global_loss: 21824371.1450; train_optim_loss: 21824371.1450; val_kl_reg_loss: 74962.7635; val_edge_recon_loss: 616849.6542; val_gene_expr_recon_loss: 19645704.8000; val_masked_gp_l1_reg_loss: 119378.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 108395.6250; val_chrom_access_recon_loss: 870727.0792; val_global_loss: 21436018.6667; val_optim_loss: 21436018.6667
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9372; val_auprc_score: 0.9275; val_best_acc_score: 0.8670; val_best_f1_score: 0.8741; train_kl_reg_loss: 73717.4858; train_edge_recon_loss: 609625.4260; train_gene_expr_recon_loss: 19878159.6183; train_masked_gp_l1_reg_loss: 119431.5701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103860.0861; train_chrom_access_recon_loss: 878517.0520; train_global_loss: 21663311.3130; train_optim_loss: 21663311.3130; val_kl_reg_loss: 73123.8141; val_edge_recon_loss: 608375.7792; val_gene_expr_recon_loss: 19471146.4000; val_masked_gp_l1_reg_loss: 119821.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100950.5000; val_chrom_access_recon_loss: 863389.0667; val_global_loss: 21236807.3333; val_optim_loss: 21236807.3333
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9358; val_auprc_score: 0.9224; val_best_acc_score: 0.8667; val_best_f1_score: 0.8719; train_kl_reg_loss: 72306.9789; train_edge_recon_loss: 606648.2848; train_gene_expr_recon_loss: 19768444.9466; train_masked_gp_l1_reg_loss: 120183.4736; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98599.6299; train_chrom_access_recon_loss: 874023.8154; train_global_loss: 21540207.2519; train_optim_loss: 21540207.2519; val_kl_reg_loss: 70641.0328; val_edge_recon_loss: 611054.2292; val_gene_expr_recon_loss: 19483490.0000; val_masked_gp_l1_reg_loss: 121029.2109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96897.8906; val_chrom_access_recon_loss: 862624.7375; val_global_loss: 21245738.2667; val_optim_loss: 21245738.2667
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9445; val_auprc_score: 0.9350; val_best_acc_score: 0.8742; val_best_f1_score: 0.8807; train_kl_reg_loss: 71381.6457; train_edge_recon_loss: 601967.2052; train_gene_expr_recon_loss: 19649558.3206; train_masked_gp_l1_reg_loss: 120841.9353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94978.2170; train_chrom_access_recon_loss: 868808.0320; train_global_loss: 21407535.2061; train_optim_loss: 21407535.2061; val_kl_reg_loss: 70344.3562; val_edge_recon_loss: 606634.2833; val_gene_expr_recon_loss: 19270189.6000; val_masked_gp_l1_reg_loss: 121279.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93318.3984; val_chrom_access_recon_loss: 856205.5542; val_global_loss: 21017971.8667; val_optim_loss: 21017971.8667
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9435; val_auprc_score: 0.9294; val_best_acc_score: 0.8771; val_best_f1_score: 0.8846; train_kl_reg_loss: 70041.2341; train_edge_recon_loss: 601018.8521; train_gene_expr_recon_loss: 19569659.0382; train_masked_gp_l1_reg_loss: 121385.1466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92024.9096; train_chrom_access_recon_loss: 864764.6231; train_global_loss: 21318893.8321; train_optim_loss: 21318893.8321; val_kl_reg_loss: 69572.7656; val_edge_recon_loss: 599959.6333; val_gene_expr_recon_loss: 19216001.3333; val_masked_gp_l1_reg_loss: 121931.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92088.1797; val_chrom_access_recon_loss: 854520.2375; val_global_loss: 20954074.0000; val_optim_loss: 20954074.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9467; val_auprc_score: 0.9364; val_best_acc_score: 0.8770; val_best_f1_score: 0.8812; train_kl_reg_loss: 69273.7442; train_edge_recon_loss: 600340.4986; train_gene_expr_recon_loss: 19455348.1527; train_masked_gp_l1_reg_loss: 121854.1363; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90509.3433; train_chrom_access_recon_loss: 860222.3430; train_global_loss: 21197548.0916; train_optim_loss: 21197548.0916; val_kl_reg_loss: 68409.3036; val_edge_recon_loss: 600316.8000; val_gene_expr_recon_loss: 19084643.7333; val_masked_gp_l1_reg_loss: 122796.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90268.7109; val_chrom_access_recon_loss: 848988.5125; val_global_loss: 20815422.1333; val_optim_loss: 20815422.1333
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9552; val_auprc_score: 0.9476; val_best_acc_score: 0.8917; val_best_f1_score: 0.8951; train_kl_reg_loss: 68814.9429; train_edge_recon_loss: 596619.1722; train_gene_expr_recon_loss: 19403294.0000; train_masked_gp_l1_reg_loss: 122393.9315; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89409.1192; train_chrom_access_recon_loss: 857332.8736; train_global_loss: 21137863.7863; train_optim_loss: 21137863.7863; val_kl_reg_loss: 68140.7117; val_edge_recon_loss: 594204.7500; val_gene_expr_recon_loss: 19045800.5333; val_masked_gp_l1_reg_loss: 122301.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89335.0234; val_chrom_access_recon_loss: 843490.5083; val_global_loss: 20763274.8000; val_optim_loss: 20763274.8000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9549; val_auprc_score: 0.9445; val_best_acc_score: 0.8879; val_best_f1_score: 0.8926; train_kl_reg_loss: 68376.5855; train_edge_recon_loss: 595190.7552; train_gene_expr_recon_loss: 19318889.0840; train_masked_gp_l1_reg_loss: 122768.6763; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89110.0477; train_chrom_access_recon_loss: 854545.4103; train_global_loss: 21048880.5649; train_optim_loss: 21048880.5649; val_kl_reg_loss: 67739.9536; val_edge_recon_loss: 597599.7000; val_gene_expr_recon_loss: 18933394.6667; val_masked_gp_l1_reg_loss: 122976.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88914.3516; val_chrom_access_recon_loss: 843485.0458; val_global_loss: 20654109.6000; val_optim_loss: 20654109.6000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9511; val_auprc_score: 0.9357; val_best_acc_score: 0.8888; val_best_f1_score: 0.8923; train_kl_reg_loss: 67728.6196; train_edge_recon_loss: 593858.1579; train_gene_expr_recon_loss: 19247875.4351; train_masked_gp_l1_reg_loss: 123137.9655; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88635.0537; train_chrom_access_recon_loss: 850997.5711; train_global_loss: 20972233.0076; train_optim_loss: 20972233.0076; val_kl_reg_loss: 67669.0453; val_edge_recon_loss: 597663.0542; val_gene_expr_recon_loss: 18923975.6000; val_masked_gp_l1_reg_loss: 123499.8359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89259.1094; val_chrom_access_recon_loss: 838399.0083; val_global_loss: 20640466.8000; val_optim_loss: 20640466.8000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9581; val_auprc_score: 0.9450; val_best_acc_score: 0.9003; val_best_f1_score: 0.9028; train_kl_reg_loss: 67199.0980; train_edge_recon_loss: 592953.3187; train_gene_expr_recon_loss: 19198098.1527; train_masked_gp_l1_reg_loss: 123495.6845; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89088.5219; train_chrom_access_recon_loss: 849568.4160; train_global_loss: 20920402.9924; train_optim_loss: 20920402.9924; val_kl_reg_loss: 66917.9047; val_edge_recon_loss: 589847.8250; val_gene_expr_recon_loss: 18833120.4000; val_masked_gp_l1_reg_loss: 123481.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89108.6094; val_chrom_access_recon_loss: 839583.6375; val_global_loss: 20542059.6000; val_optim_loss: 20542059.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9591; val_auprc_score: 0.9468; val_best_acc_score: 0.9006; val_best_f1_score: 0.9055; train_kl_reg_loss: 67079.6475; train_edge_recon_loss: 591379.6842; train_gene_expr_recon_loss: 19131124.4885; train_masked_gp_l1_reg_loss: 123794.8238; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88945.0759; train_chrom_access_recon_loss: 845349.5076; train_global_loss: 20847673.4656; train_optim_loss: 20847673.4656; val_kl_reg_loss: 65812.7711; val_edge_recon_loss: 591601.8042; val_gene_expr_recon_loss: 18744879.7333; val_masked_gp_l1_reg_loss: 124203.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 89245.2578; val_chrom_access_recon_loss: 834081.6042; val_global_loss: 20449826.0000; val_optim_loss: 20449826.0000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9576; val_auprc_score: 0.9461; val_best_acc_score: 0.8987; val_best_f1_score: 0.9025; train_kl_reg_loss: 66735.8471; train_edge_recon_loss: 589240.2271; train_gene_expr_recon_loss: 19067847.8321; train_masked_gp_l1_reg_loss: 124172.5144; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88253.1610; train_chrom_access_recon_loss: 843618.0544; train_global_loss: 20779867.4504; train_optim_loss: 20779867.4504; val_kl_reg_loss: 67733.0057; val_edge_recon_loss: 591953.1667; val_gene_expr_recon_loss: 18810133.4667; val_masked_gp_l1_reg_loss: 124439.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87449.3594; val_chrom_access_recon_loss: 832424.4042; val_global_loss: 20514134.0000; val_optim_loss: 20514134.0000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9631; val_auprc_score: 0.9548; val_best_acc_score: 0.9054; val_best_f1_score: 0.9089; train_kl_reg_loss: 66399.7950; train_edge_recon_loss: 590057.1240; train_gene_expr_recon_loss: 19041532.6412; train_masked_gp_l1_reg_loss: 124610.7849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87246.0005; train_chrom_access_recon_loss: 842114.3063; train_global_loss: 20751960.6412; train_optim_loss: 20751960.6412; val_kl_reg_loss: 66090.5182; val_edge_recon_loss: 591240.1000; val_gene_expr_recon_loss: 18711564.5333; val_masked_gp_l1_reg_loss: 125196.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88112.1484; val_chrom_access_recon_loss: 830205.3292; val_global_loss: 20412408.6667; val_optim_loss: 20412408.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9596; val_auprc_score: 0.9510; val_best_acc_score: 0.9034; val_best_f1_score: 0.9059; train_kl_reg_loss: 65814.4863; train_edge_recon_loss: 589154.7610; train_gene_expr_recon_loss: 18984597.8015; train_masked_gp_l1_reg_loss: 125398.5182; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86414.6633; train_chrom_access_recon_loss: 840402.2314; train_global_loss: 20691782.4885; train_optim_loss: 20691782.4885; val_kl_reg_loss: 66674.1911; val_edge_recon_loss: 592785.8500; val_gene_expr_recon_loss: 18670006.4000; val_masked_gp_l1_reg_loss: 125590.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86586.7891; val_chrom_access_recon_loss: 825646.6625; val_global_loss: 20367289.0667; val_optim_loss: 20367289.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9598; val_auprc_score: 0.9483; val_best_acc_score: 0.9051; val_best_f1_score: 0.9077; train_kl_reg_loss: 65457.3106; train_edge_recon_loss: 588869.3044; train_gene_expr_recon_loss: 18910901.3893; train_masked_gp_l1_reg_loss: 125887.8398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85874.4025; train_chrom_access_recon_loss: 837408.5878; train_global_loss: 20614398.7328; train_optim_loss: 20614398.7328; val_kl_reg_loss: 64340.4060; val_edge_recon_loss: 590245.7500; val_gene_expr_recon_loss: 18678404.5333; val_masked_gp_l1_reg_loss: 126268.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84904.0938; val_chrom_access_recon_loss: 827759.8792; val_global_loss: 20371922.5333; val_optim_loss: 20371922.5333
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9610; val_auprc_score: 0.9486; val_best_acc_score: 0.9041; val_best_f1_score: 0.9090; train_kl_reg_loss: 64830.9438; train_edge_recon_loss: 588778.0396; train_gene_expr_recon_loss: 18875656.0458; train_masked_gp_l1_reg_loss: 126737.8380; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84929.1675; train_chrom_access_recon_loss: 836282.9604; train_global_loss: 20577214.9618; train_optim_loss: 20577214.9618; val_kl_reg_loss: 63588.4794; val_edge_recon_loss: 589463.9458; val_gene_expr_recon_loss: 18593520.9333; val_masked_gp_l1_reg_loss: 127406.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85443.5000; val_chrom_access_recon_loss: 829504.0833; val_global_loss: 20288927.6000; val_optim_loss: 20288927.6000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9594; val_auprc_score: 0.9454; val_best_acc_score: 0.9078; val_best_f1_score: 0.9114; train_kl_reg_loss: 64401.2296; train_edge_recon_loss: 588344.8807; train_gene_expr_recon_loss: 18823932.0916; train_masked_gp_l1_reg_loss: 127744.9861; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84541.0327; train_chrom_access_recon_loss: 835991.8010; train_global_loss: 20524956.0305; train_optim_loss: 20524956.0305; val_kl_reg_loss: 63595.8578; val_edge_recon_loss: 591821.6792; val_gene_expr_recon_loss: 18500575.6000; val_masked_gp_l1_reg_loss: 128140.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85300.8047; val_chrom_access_recon_loss: 819113.2667; val_global_loss: 20188546.5333; val_optim_loss: 20188546.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9621; val_auprc_score: 0.9509; val_best_acc_score: 0.9081; val_best_f1_score: 0.9126; train_kl_reg_loss: 64126.6288; train_edge_recon_loss: 588680.7018; train_gene_expr_recon_loss: 18779282.0458; train_masked_gp_l1_reg_loss: 128822.3588; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84211.3685; train_chrom_access_recon_loss: 833603.5940; train_global_loss: 20478726.5802; train_optim_loss: 20478726.5802; val_kl_reg_loss: 63301.7867; val_edge_recon_loss: 586968.3167; val_gene_expr_recon_loss: 18512255.2000; val_masked_gp_l1_reg_loss: 129166.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83562.9844; val_chrom_access_recon_loss: 824098.9417; val_global_loss: 20199352.4000; val_optim_loss: 20199352.4000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9615; val_auprc_score: 0.9485; val_best_acc_score: 0.9076; val_best_f1_score: 0.9115; train_kl_reg_loss: 63789.5283; train_edge_recon_loss: 587540.4900; train_gene_expr_recon_loss: 18736243.8321; train_masked_gp_l1_reg_loss: 129906.7419; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83527.2367; train_chrom_access_recon_loss: 833057.9509; train_global_loss: 20434065.7710; train_optim_loss: 20434065.7710; val_kl_reg_loss: 62167.3927; val_edge_recon_loss: 590953.5208; val_gene_expr_recon_loss: 18423203.0667; val_masked_gp_l1_reg_loss: 130760.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83731.2109; val_chrom_access_recon_loss: 826116.5375; val_global_loss: 20116932.4000; val_optim_loss: 20116932.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9655; val_auprc_score: 0.9544; val_best_acc_score: 0.9167; val_best_f1_score: 0.9201; train_kl_reg_loss: 63616.9041; train_edge_recon_loss: 585946.1064; train_gene_expr_recon_loss: 18686454.8855; train_masked_gp_l1_reg_loss: 131190.0779; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83464.5726; train_chrom_access_recon_loss: 832111.9256; train_global_loss: 20382784.5802; train_optim_loss: 20382784.5802; val_kl_reg_loss: 63009.9979; val_edge_recon_loss: 583969.4792; val_gene_expr_recon_loss: 18428179.2000; val_masked_gp_l1_reg_loss: 131826.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83999.9297; val_chrom_access_recon_loss: 823485.4458; val_global_loss: 20114470.2667; val_optim_loss: 20114470.2667
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9560; val_auprc_score: 0.9433; val_best_acc_score: 0.8976; val_best_f1_score: 0.9022; train_kl_reg_loss: 61309.4324; train_edge_recon_loss: 620440.2987; train_gene_expr_recon_loss: 17978286.3969; train_masked_gp_l1_reg_loss: 129939.5341; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75467.8360; train_chrom_access_recon_loss: 808608.8163; train_global_loss: 19674052.3511; train_optim_loss: 19674052.3511; val_kl_reg_loss: 42613.2971; val_edge_recon_loss: 604217.2583; val_gene_expr_recon_loss: 17747151.8667; val_masked_gp_l1_reg_loss: 129154.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75185.0312; val_chrom_access_recon_loss: 797376.0250; val_global_loss: 19395698.1333; val_optim_loss: 19395698.1333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9546; val_auprc_score: 0.9444; val_best_acc_score: 0.8949; val_best_f1_score: 0.8995; train_kl_reg_loss: 58046.4786; train_edge_recon_loss: 595315.8635; train_gene_expr_recon_loss: 17906969.0229; train_masked_gp_l1_reg_loss: 128309.4860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74934.2484; train_chrom_access_recon_loss: 805262.2719; train_global_loss: 19568837.3893; train_optim_loss: 19568837.3893; val_kl_reg_loss: 48779.6346; val_edge_recon_loss: 593675.1292; val_gene_expr_recon_loss: 17604086.6667; val_masked_gp_l1_reg_loss: 127892.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75216.8125; val_chrom_access_recon_loss: 792275.1083; val_global_loss: 19241924.4000; val_optim_loss: 19241924.4000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9618; val_auprc_score: 0.9511; val_best_acc_score: 0.9074; val_best_f1_score: 0.9115; train_kl_reg_loss: 57464.3094; train_edge_recon_loss: 589340.6746; train_gene_expr_recon_loss: 17867031.4809; train_masked_gp_l1_reg_loss: 127305.6750; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75010.2614; train_chrom_access_recon_loss: 803915.3049; train_global_loss: 19520067.7252; train_optim_loss: 19520067.7252; val_kl_reg_loss: 51980.8729; val_edge_recon_loss: 587971.4500; val_gene_expr_recon_loss: 17544685.7333; val_masked_gp_l1_reg_loss: 126732.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74866.6562; val_chrom_access_recon_loss: 790199.6500; val_global_loss: 19176435.7333; val_optim_loss: 19176435.7333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9569; val_auprc_score: 0.9415; val_best_acc_score: 0.9039; val_best_f1_score: 0.9082; train_kl_reg_loss: 56724.6533; train_edge_recon_loss: 586851.9857; train_gene_expr_recon_loss: 17808930.7710; train_masked_gp_l1_reg_loss: 126596.8782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75154.9781; train_chrom_access_recon_loss: 802356.0935; train_global_loss: 19456615.1908; train_optim_loss: 19456615.1908; val_kl_reg_loss: 50795.9810; val_edge_recon_loss: 586369.5458; val_gene_expr_recon_loss: 17570066.4000; val_masked_gp_l1_reg_loss: 126567.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74649.8828; val_chrom_access_recon_loss: 791071.9208; val_global_loss: 19199521.7333; val_optim_loss: 19199521.7333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9580; val_auprc_score: 0.9430; val_best_acc_score: 0.9047; val_best_f1_score: 0.9090; train_kl_reg_loss: 56275.6220; train_edge_recon_loss: 584778.0611; train_gene_expr_recon_loss: 17775150.9313; train_masked_gp_l1_reg_loss: 126346.5848; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75184.2100; train_chrom_access_recon_loss: 801913.9098; train_global_loss: 19419649.2672; train_optim_loss: 19419649.2672; val_kl_reg_loss: 51892.7411; val_edge_recon_loss: 585323.1708; val_gene_expr_recon_loss: 17473748.6000; val_masked_gp_l1_reg_loss: 126186.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75042.3594; val_chrom_access_recon_loss: 788473.6333; val_global_loss: 19100665.7333; val_optim_loss: 19100665.7333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9587; val_auprc_score: 0.9458; val_best_acc_score: 0.9068; val_best_f1_score: 0.9095; train_kl_reg_loss: 56199.8632; train_edge_recon_loss: 582137.4800; train_gene_expr_recon_loss: 17737456.0305; train_masked_gp_l1_reg_loss: 126299.5534; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75124.9164; train_chrom_access_recon_loss: 801097.9342; train_global_loss: 19378315.7863; train_optim_loss: 19378315.7863; val_kl_reg_loss: 53908.7125; val_edge_recon_loss: 586757.5542; val_gene_expr_recon_loss: 17513678.6667; val_masked_gp_l1_reg_loss: 126329.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75745.8594; val_chrom_access_recon_loss: 791947.5375; val_global_loss: 19148368.6667; val_optim_loss: 19148368.6667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9605; val_auprc_score: 0.9478; val_best_acc_score: 0.9082; val_best_f1_score: 0.9113; train_kl_reg_loss: 56208.9740; train_edge_recon_loss: 582097.0759; train_gene_expr_recon_loss: 17701713.5191; train_masked_gp_l1_reg_loss: 126397.2924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75356.8330; train_chrom_access_recon_loss: 801239.5348; train_global_loss: 19343013.4046; train_optim_loss: 19343013.4046; val_kl_reg_loss: 52961.5760; val_edge_recon_loss: 581768.5583; val_gene_expr_recon_loss: 17473796.4000; val_masked_gp_l1_reg_loss: 126420.7422; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75724.2422; val_chrom_access_recon_loss: 788578.4375; val_global_loss: 19099248.9333; val_optim_loss: 19099248.9333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9539; val_auprc_score: 0.9381; val_best_acc_score: 0.9022; val_best_f1_score: 0.9058; train_kl_reg_loss: 55867.6421; train_edge_recon_loss: 581180.7362; train_gene_expr_recon_loss: 17668253.9695; train_masked_gp_l1_reg_loss: 126647.7435; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75563.6435; train_chrom_access_recon_loss: 801182.0754; train_global_loss: 19308695.7863; train_optim_loss: 19308695.7863; val_kl_reg_loss: 52465.5901; val_edge_recon_loss: 585808.6083; val_gene_expr_recon_loss: 17508981.3333; val_masked_gp_l1_reg_loss: 126548.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75638.6172; val_chrom_access_recon_loss: 797797.2083; val_global_loss: 19147238.6667; val_optim_loss: 19147238.6667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9612; val_auprc_score: 0.9490; val_best_acc_score: 0.9082; val_best_f1_score: 0.9113; train_kl_reg_loss: 55895.0047; train_edge_recon_loss: 580766.9623; train_gene_expr_recon_loss: 17624277.0992; train_masked_gp_l1_reg_loss: 126725.6245; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75441.1937; train_chrom_access_recon_loss: 800975.7595; train_global_loss: 19264081.7099; train_optim_loss: 19264081.7099; val_kl_reg_loss: 52430.6857; val_edge_recon_loss: 583744.1333; val_gene_expr_recon_loss: 17377649.2667; val_masked_gp_l1_reg_loss: 127017.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75662.1250; val_chrom_access_recon_loss: 788307.4167; val_global_loss: 19004811.6000; val_optim_loss: 19004811.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9588; val_auprc_score: 0.9429; val_best_acc_score: 0.9091; val_best_f1_score: 0.9121; train_kl_reg_loss: 55690.1615; train_edge_recon_loss: 580721.2347; train_gene_expr_recon_loss: 17579966.5267; train_masked_gp_l1_reg_loss: 127058.9860; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75712.6904; train_chrom_access_recon_loss: 799995.9890; train_global_loss: 19219145.7099; train_optim_loss: 19219145.7099; val_kl_reg_loss: 52326.1724; val_edge_recon_loss: 585013.5583; val_gene_expr_recon_loss: 17408845.0000; val_masked_gp_l1_reg_loss: 127268.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75983.5391; val_chrom_access_recon_loss: 792942.3542; val_global_loss: 19042379.2000; val_optim_loss: 19042379.2000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9598; val_auprc_score: 0.9464; val_best_acc_score: 0.9085; val_best_f1_score: 0.9112; train_kl_reg_loss: 55426.2587; train_edge_recon_loss: 582228.5014; train_gene_expr_recon_loss: 17547702.8092; train_masked_gp_l1_reg_loss: 127430.2864; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75698.2413; train_chrom_access_recon_loss: 799761.5668; train_global_loss: 19188247.7099; train_optim_loss: 19188247.7099; val_kl_reg_loss: 53174.2448; val_edge_recon_loss: 585120.1167; val_gene_expr_recon_loss: 17352293.1333; val_masked_gp_l1_reg_loss: 127359.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75625.3516; val_chrom_access_recon_loss: 792268.9458; val_global_loss: 18985842.5333; val_optim_loss: 18985842.5333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9601; val_auprc_score: 0.9437; val_best_acc_score: 0.9105; val_best_f1_score: 0.9130; train_kl_reg_loss: 56036.7098; train_edge_recon_loss: 580746.4924; train_gene_expr_recon_loss: 17531689.2901; train_masked_gp_l1_reg_loss: 127341.3885; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75634.5037; train_chrom_access_recon_loss: 799342.0272; train_global_loss: 19170790.4122; train_optim_loss: 19170790.4122; val_kl_reg_loss: 52898.0266; val_edge_recon_loss: 583781.3500; val_gene_expr_recon_loss: 17394643.7333; val_masked_gp_l1_reg_loss: 127088.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75748.9141; val_chrom_access_recon_loss: 791037.9333; val_global_loss: 19025196.8000; val_optim_loss: 19025196.8000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9624; val_auprc_score: 0.9486; val_best_acc_score: 0.9091; val_best_f1_score: 0.9137; train_kl_reg_loss: 56798.5753; train_edge_recon_loss: 579834.9385; train_gene_expr_recon_loss: 17495055.9389; train_masked_gp_l1_reg_loss: 127060.9563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75953.7140; train_chrom_access_recon_loss: 798979.4556; train_global_loss: 19133683.4656; train_optim_loss: 19133683.4656; val_kl_reg_loss: 53170.8279; val_edge_recon_loss: 583578.1417; val_gene_expr_recon_loss: 17296032.6000; val_masked_gp_l1_reg_loss: 126910.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75866.0156; val_chrom_access_recon_loss: 786471.8250; val_global_loss: 18922029.4667; val_optim_loss: 18922029.4667
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9598; val_auprc_score: 0.9446; val_best_acc_score: 0.9093; val_best_f1_score: 0.9140; train_kl_reg_loss: 56700.6335; train_edge_recon_loss: 581223.6994; train_gene_expr_recon_loss: 17499218.0305; train_masked_gp_l1_reg_loss: 126910.8905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75846.4209; train_chrom_access_recon_loss: 799170.3421; train_global_loss: 19139070.0000; train_optim_loss: 19139070.0000; val_kl_reg_loss: 53893.1794; val_edge_recon_loss: 581279.9208; val_gene_expr_recon_loss: 17249962.4000; val_masked_gp_l1_reg_loss: 126929.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75997.4688; val_chrom_access_recon_loss: 784578.5833; val_global_loss: 18872642.1333; val_optim_loss: 18872642.1333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9617; val_auprc_score: 0.9494; val_best_acc_score: 0.9107; val_best_f1_score: 0.9143; train_kl_reg_loss: 56664.9079; train_edge_recon_loss: 580345.2142; train_gene_expr_recon_loss: 17447018.3130; train_masked_gp_l1_reg_loss: 126756.7805; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75974.0174; train_chrom_access_recon_loss: 798536.6837; train_global_loss: 19085296.0458; train_optim_loss: 19085296.0458; val_kl_reg_loss: 54205.0622; val_edge_recon_loss: 581962.9417; val_gene_expr_recon_loss: 17352164.0000; val_masked_gp_l1_reg_loss: 126625.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75578.7812; val_chrom_access_recon_loss: 790561.3250; val_global_loss: 18981097.3333; val_optim_loss: 18981097.3333
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9646; val_auprc_score: 0.9537; val_best_acc_score: 0.9148; val_best_f1_score: 0.9165; train_kl_reg_loss: 56824.0771; train_edge_recon_loss: 579439.0949; train_gene_expr_recon_loss: 17422726.7939; train_masked_gp_l1_reg_loss: 126757.2924; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75653.3358; train_chrom_access_recon_loss: 799011.4685; train_global_loss: 19060412.2290; train_optim_loss: 19060412.2290; val_kl_reg_loss: 55657.3727; val_edge_recon_loss: 582142.0042; val_gene_expr_recon_loss: 17237156.7333; val_masked_gp_l1_reg_loss: 126820.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76067.0469; val_chrom_access_recon_loss: 788059.9083; val_global_loss: 18865904.5333; val_optim_loss: 18865904.5333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9593; val_auprc_score: 0.9436; val_best_acc_score: 0.9109; val_best_f1_score: 0.9145; train_kl_reg_loss: 56782.0413; train_edge_recon_loss: 579322.3912; train_gene_expr_recon_loss: 17396822.7863; train_masked_gp_l1_reg_loss: 126761.3461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75894.1899; train_chrom_access_recon_loss: 798203.6217; train_global_loss: 19033786.4122; train_optim_loss: 19033786.4122; val_kl_reg_loss: 55405.6750; val_edge_recon_loss: 582881.0750; val_gene_expr_recon_loss: 17264866.4000; val_masked_gp_l1_reg_loss: 126891.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75992.4297; val_chrom_access_recon_loss: 786792.3833; val_global_loss: 18892829.4667; val_optim_loss: 18892829.4667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9631; val_auprc_score: 0.9511; val_best_acc_score: 0.9123; val_best_f1_score: 0.9159; train_kl_reg_loss: 56918.6275; train_edge_recon_loss: 580375.5854; train_gene_expr_recon_loss: 17376694.5802; train_masked_gp_l1_reg_loss: 126628.7191; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75961.4624; train_chrom_access_recon_loss: 798575.8678; train_global_loss: 19015154.7634; train_optim_loss: 19015154.7634; val_kl_reg_loss: 54582.2721; val_edge_recon_loss: 581346.8417; val_gene_expr_recon_loss: 17251599.4667; val_masked_gp_l1_reg_loss: 126401.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75816.8125; val_chrom_access_recon_loss: 787048.0417; val_global_loss: 18876794.6667; val_optim_loss: 18876794.6667
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9597; val_auprc_score: 0.9432; val_best_acc_score: 0.9085; val_best_f1_score: 0.9117; train_kl_reg_loss: 57190.0040; train_edge_recon_loss: 579763.4127; train_gene_expr_recon_loss: 17362083.2290; train_masked_gp_l1_reg_loss: 126316.3432; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 76019.7761; train_chrom_access_recon_loss: 797616.9299; train_global_loss: 18998989.7405; train_optim_loss: 18998989.7405; val_kl_reg_loss: 54724.2974; val_edge_recon_loss: 585796.1208; val_gene_expr_recon_loss: 17190929.3333; val_masked_gp_l1_reg_loss: 125930.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75690.0781; val_chrom_access_recon_loss: 785133.5917; val_global_loss: 18818203.6000; val_optim_loss: 18818203.6000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9544; val_auprc_score: 0.9438; val_best_acc_score: 0.8910; val_best_f1_score: 0.8950; train_kl_reg_loss: 45577.9674; train_edge_recon_loss: 650423.9981; train_gene_expr_recon_loss: 18243174.3969; train_masked_gp_l1_reg_loss: 137741.9447; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86915.2855; train_chrom_access_recon_loss: 802028.0019; train_global_loss: 19965861.6183; train_optim_loss: 19965861.6183; val_kl_reg_loss: 31100.9161; val_edge_recon_loss: 646809.1542; val_gene_expr_recon_loss: 17641750.2667; val_masked_gp_l1_reg_loss: 129219.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91620.3906; val_chrom_access_recon_loss: 784769.7750; val_global_loss: 19325270.4000; val_optim_loss: 19325270.4000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9552; val_auprc_score: 0.9413; val_best_acc_score: 0.9006; val_best_f1_score: 0.9047; train_kl_reg_loss: 38237.0715; train_edge_recon_loss: 618573.0830; train_gene_expr_recon_loss: 17857400.5725; train_masked_gp_l1_reg_loss: 123482.7960; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85217.0778; train_chrom_access_recon_loss: 797193.2629; train_global_loss: 19520103.9389; train_optim_loss: 19520103.9389; val_kl_reg_loss: 40624.9773; val_edge_recon_loss: 603433.4750; val_gene_expr_recon_loss: 17560408.1333; val_masked_gp_l1_reg_loss: 120731.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80271.1250; val_chrom_access_recon_loss: 785637.0292; val_global_loss: 19191107.7333; val_optim_loss: 19191107.7333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9511; val_auprc_score: 0.9340; val_best_acc_score: 0.8952; val_best_f1_score: 0.9006; train_kl_reg_loss: 46963.7465; train_edge_recon_loss: 596320.9800; train_gene_expr_recon_loss: 17742881.0687; train_masked_gp_l1_reg_loss: 119343.3461; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78521.5037; train_chrom_access_recon_loss: 796567.4113; train_global_loss: 19380598.1221; train_optim_loss: 19380598.1221; val_kl_reg_loss: 46475.8500; val_edge_recon_loss: 594165.9625; val_gene_expr_recon_loss: 17409304.6667; val_masked_gp_l1_reg_loss: 118302.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77409.7500; val_chrom_access_recon_loss: 783478.7833; val_global_loss: 19029137.2000; val_optim_loss: 19029137.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9534; val_auprc_score: 0.9368; val_best_acc_score: 0.8989; val_best_f1_score: 0.9046; train_kl_reg_loss: 50475.0159; train_edge_recon_loss: 590554.9127; train_gene_expr_recon_loss: 17680081.6489; train_masked_gp_l1_reg_loss: 117828.3291; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77133.7776; train_chrom_access_recon_loss: 796166.3659; train_global_loss: 19312240.1985; train_optim_loss: 19312240.1985; val_kl_reg_loss: 48952.1745; val_edge_recon_loss: 594145.7583; val_gene_expr_recon_loss: 17498153.2667; val_masked_gp_l1_reg_loss: 117522.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77229.0156; val_chrom_access_recon_loss: 788990.7250; val_global_loss: 19124993.7333; val_optim_loss: 19124993.7333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9539; val_auprc_score: 0.9400; val_best_acc_score: 0.8996; val_best_f1_score: 0.9039; train_kl_reg_loss: 51859.4222; train_edge_recon_loss: 587112.4623; train_gene_expr_recon_loss: 17629877.1374; train_masked_gp_l1_reg_loss: 113170.1307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61699.8740; train_chrom_access_recon_loss: 794765.0420; train_global_loss: 19238484.0458; train_optim_loss: 19238484.0458; val_kl_reg_loss: 49886.6440; val_edge_recon_loss: 588655.4250; val_gene_expr_recon_loss: 17386627.9333; val_masked_gp_l1_reg_loss: 112029.0703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59090.8047; val_chrom_access_recon_loss: 782002.4958; val_global_loss: 18978292.6667; val_optim_loss: 18978292.6667
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9552; val_auprc_score: 0.9372; val_best_acc_score: 0.9039; val_best_f1_score: 0.9083; train_kl_reg_loss: 52767.3675; train_edge_recon_loss: 586404.3306; train_gene_expr_recon_loss: 17649637.0000; train_masked_gp_l1_reg_loss: 111805.8162; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58498.1532; train_chrom_access_recon_loss: 796072.3010; train_global_loss: 19255184.8702; train_optim_loss: 19255184.8702; val_kl_reg_loss: 50724.5667; val_edge_recon_loss: 587651.0833; val_gene_expr_recon_loss: 17443814.9333; val_masked_gp_l1_reg_loss: 111625.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57991.6250; val_chrom_access_recon_loss: 787621.7625; val_global_loss: 19039430.2667; val_optim_loss: 19039430.2667
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9552; val_auprc_score: 0.9371; val_best_acc_score: 0.9020; val_best_f1_score: 0.9072; train_kl_reg_loss: 53462.2205; train_edge_recon_loss: 585999.7734; train_gene_expr_recon_loss: 17634012.3435; train_masked_gp_l1_reg_loss: 111520.1231; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57676.0308; train_chrom_access_recon_loss: 794937.6746; train_global_loss: 19237608.2748; train_optim_loss: 19237608.2748; val_kl_reg_loss: 51560.4779; val_edge_recon_loss: 587728.4167; val_gene_expr_recon_loss: 17402793.3333; val_masked_gp_l1_reg_loss: 111415.4531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57520.0391; val_chrom_access_recon_loss: 786108.1583; val_global_loss: 18997126.5333; val_optim_loss: 18997126.5333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9528; val_auprc_score: 0.9377; val_best_acc_score: 0.8991; val_best_f1_score: 0.9033; train_kl_reg_loss: 54060.0666; train_edge_recon_loss: 585362.0687; train_gene_expr_recon_loss: 17605803.9618; train_masked_gp_l1_reg_loss: 111329.7952; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57306.0439; train_chrom_access_recon_loss: 794611.4871; train_global_loss: 19208473.3740; train_optim_loss: 19208473.3740; val_kl_reg_loss: 51985.8471; val_edge_recon_loss: 589561.9792; val_gene_expr_recon_loss: 17404190.6000; val_masked_gp_l1_reg_loss: 111242.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57096.7578; val_chrom_access_recon_loss: 783416.3500; val_global_loss: 18997492.6667; val_optim_loss: 18997492.6667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 33 min 17 sec.
Using best model state, which was in epoch 44.

--- MODEL EVALUATION ---
val AUROC score: 0.9558
val AUPRC score: 0.9407
val best accuracy score: 0.9077
val best F1 score: 0.9109
val target rna MSE score: 1.9681
val source rna MSE score: 0.3964
val target atac MSE score: 0.4933
val source atac MSE score: 0.1502
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
