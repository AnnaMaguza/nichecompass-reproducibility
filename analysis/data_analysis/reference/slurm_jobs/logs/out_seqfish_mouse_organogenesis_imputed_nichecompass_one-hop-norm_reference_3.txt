[True]
Run timestamp: 01082024_191836_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2444.
Number of gene programs after filtering and combining: 2109.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8510 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1961, n_latent: 1861, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1861, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1861, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 28792
Number of validation nodes: 3199
Number of training edges: 129792
Number of validation edges: 14421
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8457; val_auprc_score: 0.9498; val_best_acc_score: 0.8402; val_best_f1_score: 0.9059; train_kl_reg_loss: 181069.0896; train_edge_recon_loss: 1513668.9569; train_gene_expr_recon_loss: 46464990.2880; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 48159728.2840; train_optim_loss: 48159728.2840; val_kl_reg_loss: 125491.5857; val_edge_recon_loss: 1565424.2895; val_gene_expr_recon_loss: 41772566.9474; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 43463483.1579; val_optim_loss: 43463483.1579
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8821; val_auprc_score: 0.9633; val_best_acc_score: 0.8764; val_best_f1_score: 0.9260; train_kl_reg_loss: 138322.1559; train_edge_recon_loss: 1354935.2241; train_gene_expr_recon_loss: 40141355.0059; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 41634612.2919; train_optim_loss: 41634612.2919; val_kl_reg_loss: 129964.3599; val_edge_recon_loss: 1278023.3838; val_gene_expr_recon_loss: 38762098.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40170086.7368; val_optim_loss: 40170086.7368
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.8961; val_auprc_score: 0.9682; val_best_acc_score: 0.8852; val_best_f1_score: 0.9310; train_kl_reg_loss: 119624.3265; train_edge_recon_loss: 1274290.3984; train_gene_expr_recon_loss: 37635396.7022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 39029311.4241; train_optim_loss: 39029311.4241; val_kl_reg_loss: 112221.5286; val_edge_recon_loss: 1241252.7489; val_gene_expr_recon_loss: 36638910.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 37992384.9825; val_optim_loss: 37992384.9825
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9003; val_auprc_score: 0.9698; val_best_acc_score: 0.8919; val_best_f1_score: 0.9346; train_kl_reg_loss: 106521.6769; train_edge_recon_loss: 1229743.2488; train_gene_expr_recon_loss: 35800290.5089; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 37136555.4951; train_optim_loss: 37136555.4951; val_kl_reg_loss: 100998.3073; val_edge_recon_loss: 1217314.5833; val_gene_expr_recon_loss: 35054088.1404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36372400.9123; val_optim_loss: 36372400.9123
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9138; val_auprc_score: 0.9737; val_best_acc_score: 0.8889; val_best_f1_score: 0.9323; train_kl_reg_loss: 95384.1675; train_edge_recon_loss: 1208368.4172; train_gene_expr_recon_loss: 34392645.4990; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35696398.0750; train_optim_loss: 35696398.0750; val_kl_reg_loss: 89047.3065; val_edge_recon_loss: 1221927.5702; val_gene_expr_recon_loss: 33787351.6491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35098326.5263; val_optim_loss: 35098326.5263
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9242; val_auprc_score: 0.9773; val_best_acc_score: 0.8976; val_best_f1_score: 0.9374; train_kl_reg_loss: 85810.9677; train_edge_recon_loss: 1176726.7585; train_gene_expr_recon_loss: 33266684.2406; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34529221.9487; train_optim_loss: 34529221.9487; val_kl_reg_loss: 83729.6103; val_edge_recon_loss: 1183287.0351; val_gene_expr_recon_loss: 32825277.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34092294.3860; val_optim_loss: 34092294.3860
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9378; val_auprc_score: 0.9806; val_best_acc_score: 0.9083; val_best_f1_score: 0.9437; train_kl_reg_loss: 77888.6170; train_edge_recon_loss: 1176137.2462; train_gene_expr_recon_loss: 32370853.5819; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 33624879.4438; train_optim_loss: 33624879.4438; val_kl_reg_loss: 74503.1175; val_edge_recon_loss: 1182835.9419; val_gene_expr_recon_loss: 31981815.4386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33239154.5614; val_optim_loss: 33239154.5614
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9474; val_auprc_score: 0.9836; val_best_acc_score: 0.9210; val_best_f1_score: 0.9512; train_kl_reg_loss: 72339.3488; train_edge_recon_loss: 1154744.9078; train_gene_expr_recon_loss: 31650497.5621; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32877581.7870; train_optim_loss: 32877581.7870; val_kl_reg_loss: 68886.5666; val_edge_recon_loss: 1160403.7270; val_gene_expr_recon_loss: 31334539.8596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32563830.2105; val_optim_loss: 32563830.2105
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9479; val_auprc_score: 0.9821; val_best_acc_score: 0.9270; val_best_f1_score: 0.9550; train_kl_reg_loss: 66348.6786; train_edge_recon_loss: 1139387.4624; train_gene_expr_recon_loss: 31061936.0039; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32267672.1854; train_optim_loss: 32267672.1854; val_kl_reg_loss: 64414.1101; val_edge_recon_loss: 1132487.7412; val_gene_expr_recon_loss: 30830116.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32027018.4561; val_optim_loss: 32027018.4561
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9585; val_auprc_score: 0.9864; val_best_acc_score: 0.9338; val_best_f1_score: 0.9590; train_kl_reg_loss: 60093.3024; train_edge_recon_loss: 1133081.3214; train_gene_expr_recon_loss: 30603537.6252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31796712.2446; train_optim_loss: 31796712.2446; val_kl_reg_loss: 57674.8514; val_edge_recon_loss: 1134894.7281; val_gene_expr_recon_loss: 30448432.2456; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31641001.8246; val_optim_loss: 31641001.8246
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9567; val_auprc_score: 0.9858; val_best_acc_score: 0.9350; val_best_f1_score: 0.9597; train_kl_reg_loss: 54440.1804; train_edge_recon_loss: 1124246.0357; train_gene_expr_recon_loss: 30233424.4379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31412110.6351; train_optim_loss: 31412110.6351; val_kl_reg_loss: 51848.2709; val_edge_recon_loss: 1123742.1371; val_gene_expr_recon_loss: 30093029.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31268620.2105; val_optim_loss: 31268620.2105
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9568; val_auprc_score: 0.9854; val_best_acc_score: 0.9336; val_best_f1_score: 0.9586; train_kl_reg_loss: 49635.1890; train_edge_recon_loss: 1114433.4804; train_gene_expr_recon_loss: 29948054.3708; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31112123.0414; train_optim_loss: 31112123.0414; val_kl_reg_loss: 47742.5406; val_edge_recon_loss: 1152084.4868; val_gene_expr_recon_loss: 29834992.7719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31034819.6842; val_optim_loss: 31034819.6842
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9598; val_auprc_score: 0.9871; val_best_acc_score: 0.9384; val_best_f1_score: 0.9621; train_kl_reg_loss: 45619.4721; train_edge_recon_loss: 1104456.9614; train_gene_expr_recon_loss: 29717804.6785; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30867881.1361; train_optim_loss: 30867881.1361; val_kl_reg_loss: 43508.0427; val_edge_recon_loss: 1094228.1327; val_gene_expr_recon_loss: 29625533.3684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30763269.5439; val_optim_loss: 30763269.5439
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9604; val_auprc_score: 0.9866; val_best_acc_score: 0.9382; val_best_f1_score: 0.9617; train_kl_reg_loss: 42085.8526; train_edge_recon_loss: 1101728.5222; train_gene_expr_recon_loss: 29541472.5957; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30685286.9901; train_optim_loss: 30685286.9901; val_kl_reg_loss: 40210.0759; val_edge_recon_loss: 1104549.3015; val_gene_expr_recon_loss: 29492356.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30637115.2632; val_optim_loss: 30637115.2632
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9599; val_auprc_score: 0.9865; val_best_acc_score: 0.9390; val_best_f1_score: 0.9623; train_kl_reg_loss: 39486.3753; train_edge_recon_loss: 1103325.6519; train_gene_expr_recon_loss: 29398785.4043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30541597.4241; train_optim_loss: 30541597.4241; val_kl_reg_loss: 38608.9622; val_edge_recon_loss: 1116368.9298; val_gene_expr_recon_loss: 29367650.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30522628.1754; val_optim_loss: 30522628.1754
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9659; val_auprc_score: 0.9885; val_best_acc_score: 0.9424; val_best_f1_score: 0.9644; train_kl_reg_loss: 36981.0181; train_edge_recon_loss: 1095913.3083; train_gene_expr_recon_loss: 29280847.5937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30413741.8895; train_optim_loss: 30413741.8895; val_kl_reg_loss: 36146.8968; val_edge_recon_loss: 1112569.2719; val_gene_expr_recon_loss: 29260197.8947; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30408914.0000; val_optim_loss: 30408914.0000
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9623; val_auprc_score: 0.9874; val_best_acc_score: 0.9415; val_best_f1_score: 0.9637; train_kl_reg_loss: 34691.6914; train_edge_recon_loss: 1102477.8188; train_gene_expr_recon_loss: 29193387.9408; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30330557.4398; train_optim_loss: 30330557.4398; val_kl_reg_loss: 34070.4985; val_edge_recon_loss: 1104974.6217; val_gene_expr_recon_loss: 29164286.5263; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30303331.6842; val_optim_loss: 30303331.6842
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9664; val_auprc_score: 0.9890; val_best_acc_score: 0.9458; val_best_f1_score: 0.9665; train_kl_reg_loss: 33070.4207; train_edge_recon_loss: 1085020.9285; train_gene_expr_recon_loss: 29120104.3156; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30238195.6805; train_optim_loss: 30238195.6805; val_kl_reg_loss: 32693.1338; val_edge_recon_loss: 1083558.9660; val_gene_expr_recon_loss: 29104676.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30220928.2807; val_optim_loss: 30220928.2807
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9678; val_auprc_score: 0.9892; val_best_acc_score: 0.9457; val_best_f1_score: 0.9664; train_kl_reg_loss: 31472.5413; train_edge_recon_loss: 1090087.8040; train_gene_expr_recon_loss: 29064184.9783; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30185745.3136; train_optim_loss: 30185745.3136; val_kl_reg_loss: 30487.5084; val_edge_recon_loss: 1079658.0329; val_gene_expr_recon_loss: 29058631.9649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30168777.6842; val_optim_loss: 30168777.6842
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9671; val_auprc_score: 0.9890; val_best_acc_score: 0.9468; val_best_f1_score: 0.9671; train_kl_reg_loss: 30198.7056; train_edge_recon_loss: 1087903.1317; train_gene_expr_recon_loss: 29013541.3373; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30131643.1755; train_optim_loss: 30131643.1755; val_kl_reg_loss: 29672.9518; val_edge_recon_loss: 1100568.2083; val_gene_expr_recon_loss: 28995167.5789; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30125408.7018; val_optim_loss: 30125408.7018
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9671; val_auprc_score: 0.9891; val_best_acc_score: 0.9481; val_best_f1_score: 0.9680; train_kl_reg_loss: 29070.5500; train_edge_recon_loss: 1082718.4673; train_gene_expr_recon_loss: 28979407.3491; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30091196.3353; train_optim_loss: 30091196.3353; val_kl_reg_loss: 28586.7649; val_edge_recon_loss: 1057309.0022; val_gene_expr_recon_loss: 28970366.3860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30056262.2456; val_optim_loss: 30056262.2456
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9713; val_auprc_score: 0.9907; val_best_acc_score: 0.9525; val_best_f1_score: 0.9706; train_kl_reg_loss: 28109.2497; train_edge_recon_loss: 1081620.4138; train_gene_expr_recon_loss: 28945401.9842; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30055131.6095; train_optim_loss: 30055131.6095; val_kl_reg_loss: 27818.0571; val_edge_recon_loss: 1075331.1787; val_gene_expr_recon_loss: 28935093.5439; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30038242.7018; val_optim_loss: 30038242.7018
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9691; val_auprc_score: 0.9890; val_best_acc_score: 0.9514; val_best_f1_score: 0.9698; train_kl_reg_loss: 27108.0825; train_edge_recon_loss: 1084184.4783; train_gene_expr_recon_loss: 28915222.3432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30026514.9310; train_optim_loss: 30026514.9310; val_kl_reg_loss: 26745.5444; val_edge_recon_loss: 1096126.1886; val_gene_expr_recon_loss: 28931913.5088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30054785.2982; val_optim_loss: 30054785.2982
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9721; val_auprc_score: 0.9910; val_best_acc_score: 0.9517; val_best_f1_score: 0.9700; train_kl_reg_loss: 26270.5575; train_edge_recon_loss: 1081201.4005; train_gene_expr_recon_loss: 28903984.7732; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30011456.7653; train_optim_loss: 30011456.7653; val_kl_reg_loss: 25979.6965; val_edge_recon_loss: 1077983.7840; val_gene_expr_recon_loss: 28913178.1404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30017141.6140; val_optim_loss: 30017141.6140
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9686; val_auprc_score: 0.9890; val_best_acc_score: 0.9513; val_best_f1_score: 0.9697; train_kl_reg_loss: 25539.1696; train_edge_recon_loss: 1083054.9373; train_gene_expr_recon_loss: 28878668.7456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29987262.8560; train_optim_loss: 29987262.8560; val_kl_reg_loss: 25202.2268; val_edge_recon_loss: 1097644.2368; val_gene_expr_recon_loss: 28879095.1930; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30001941.6140; val_optim_loss: 30001941.6140
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9743; val_auprc_score: 0.9910; val_best_acc_score: 0.9550; val_best_f1_score: 0.9720; train_kl_reg_loss: 23980.3610; train_edge_recon_loss: 1081085.4175; train_gene_expr_recon_loss: 28813367.7594; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29918433.5227; train_optim_loss: 29918433.5227; val_kl_reg_loss: 21782.5874; val_edge_recon_loss: 1084862.2928; val_gene_expr_recon_loss: 28807961.0175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29914605.9649; val_optim_loss: 29914605.9649
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9722; val_auprc_score: 0.9907; val_best_acc_score: 0.9536; val_best_f1_score: 0.9714; train_kl_reg_loss: 23367.0705; train_edge_recon_loss: 1074885.8161; train_gene_expr_recon_loss: 28807913.8540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29906166.7219; train_optim_loss: 29906166.7219; val_kl_reg_loss: 21077.5198; val_edge_recon_loss: 1061528.1360; val_gene_expr_recon_loss: 28817074.7018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29899680.3860; val_optim_loss: 29899680.3860
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9710; val_auprc_score: 0.9901; val_best_acc_score: 0.9528; val_best_f1_score: 0.9708; train_kl_reg_loss: 22643.5153; train_edge_recon_loss: 1083439.8818; train_gene_expr_recon_loss: 28790843.4832; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29896926.8679; train_optim_loss: 29896926.8679; val_kl_reg_loss: 21033.0578; val_edge_recon_loss: 1077621.7774; val_gene_expr_recon_loss: 28790818.4211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29889473.1930; val_optim_loss: 29889473.1930
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9701; val_auprc_score: 0.9889; val_best_acc_score: 0.9540; val_best_f1_score: 0.9712; train_kl_reg_loss: 22119.6009; train_edge_recon_loss: 1077952.8005; train_gene_expr_recon_loss: 28785355.9645; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29885428.3590; train_optim_loss: 29885428.3590; val_kl_reg_loss: 20893.9751; val_edge_recon_loss: 1110838.9627; val_gene_expr_recon_loss: 28780544.8070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29912277.6140; val_optim_loss: 29912277.6140
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9684; val_auprc_score: 0.9891; val_best_acc_score: 0.9530; val_best_f1_score: 0.9709; train_kl_reg_loss: 21697.8470; train_edge_recon_loss: 1081264.7753; train_gene_expr_recon_loss: 28773952.7022; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29876915.3254; train_optim_loss: 29876915.3254; val_kl_reg_loss: 20859.4225; val_edge_recon_loss: 1077750.9704; val_gene_expr_recon_loss: 28784577.0877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29883187.5789; val_optim_loss: 29883187.5789
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9736; val_auprc_score: 0.9905; val_best_acc_score: 0.9543; val_best_f1_score: 0.9717; train_kl_reg_loss: 21212.5778; train_edge_recon_loss: 1077951.7325; train_gene_expr_recon_loss: 28768151.3057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29867315.6134; train_optim_loss: 29867315.6134; val_kl_reg_loss: 20745.3350; val_edge_recon_loss: 1086247.6886; val_gene_expr_recon_loss: 28789505.6140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29896498.5965; val_optim_loss: 29896498.5965
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9697; val_auprc_score: 0.9891; val_best_acc_score: 0.9535; val_best_f1_score: 0.9710; train_kl_reg_loss: 20870.6023; train_edge_recon_loss: 1079861.6208; train_gene_expr_recon_loss: 28760656.2959; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29861388.5168; train_optim_loss: 29861388.5168; val_kl_reg_loss: 20255.7023; val_edge_recon_loss: 1095638.4221; val_gene_expr_recon_loss: 28780998.8070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29896893.0175; val_optim_loss: 29896893.0175
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9698; val_auprc_score: 0.9892; val_best_acc_score: 0.9549; val_best_f1_score: 0.9720; train_kl_reg_loss: 20500.1427; train_edge_recon_loss: 1072416.6757; train_gene_expr_recon_loss: 28758943.7830; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29851860.6233; train_optim_loss: 29851860.6233; val_kl_reg_loss: 19980.5275; val_edge_recon_loss: 1082886.7204; val_gene_expr_recon_loss: 28774209.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29877076.2807; val_optim_loss: 29877076.2807
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9739; val_auprc_score: 0.9910; val_best_acc_score: 0.9572; val_best_f1_score: 0.9733; train_kl_reg_loss: 20273.7753; train_edge_recon_loss: 1076814.0219; train_gene_expr_recon_loss: 28750629.2939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29847717.0730; train_optim_loss: 29847717.0730; val_kl_reg_loss: 19965.1430; val_edge_recon_loss: 1087215.0296; val_gene_expr_recon_loss: 28761875.7193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29869055.8596; val_optim_loss: 29869055.8596
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9767; val_auprc_score: 0.9917; val_best_acc_score: 0.9573; val_best_f1_score: 0.9733; train_kl_reg_loss: 20033.7555; train_edge_recon_loss: 1072402.9875; train_gene_expr_recon_loss: 28750368.0355; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29842804.8245; train_optim_loss: 29842804.8245; val_kl_reg_loss: 19690.8464; val_edge_recon_loss: 1097141.5395; val_gene_expr_recon_loss: 28761773.1579; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29878605.4737; val_optim_loss: 29878605.4737
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9758; val_auprc_score: 0.9918; val_best_acc_score: 0.9579; val_best_f1_score: 0.9738; train_kl_reg_loss: 19759.4739; train_edge_recon_loss: 1066565.0901; train_gene_expr_recon_loss: 28741237.1085; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29827561.6489; train_optim_loss: 29827561.6489; val_kl_reg_loss: 19682.3251; val_edge_recon_loss: 1083149.9660; val_gene_expr_recon_loss: 28750493.6491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29853325.9649; val_optim_loss: 29853325.9649
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9736; val_auprc_score: 0.9899; val_best_acc_score: 0.9564; val_best_f1_score: 0.9730; train_kl_reg_loss: 19512.1005; train_edge_recon_loss: 1070178.2776; train_gene_expr_recon_loss: 28742317.8422; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29832008.1578; train_optim_loss: 29832008.1578; val_kl_reg_loss: 19152.6265; val_edge_recon_loss: 1088506.7007; val_gene_expr_recon_loss: 28747952.6667; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29855612.0000; val_optim_loss: 29855612.0000
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9738; val_auprc_score: 0.9906; val_best_acc_score: 0.9584; val_best_f1_score: 0.9742; train_kl_reg_loss: 19353.2445; train_edge_recon_loss: 1073829.9773; train_gene_expr_recon_loss: 28744449.7791; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29837632.9980; train_optim_loss: 29837632.9980; val_kl_reg_loss: 19105.3932; val_edge_recon_loss: 1088256.3586; val_gene_expr_recon_loss: 28780490.7018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29887852.3509; val_optim_loss: 29887852.3509
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9703; val_auprc_score: 0.9900; val_best_acc_score: 0.9556; val_best_f1_score: 0.9726; train_kl_reg_loss: 19217.0677; train_edge_recon_loss: 1074862.1970; train_gene_expr_recon_loss: 28740795.1045; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29834874.3550; train_optim_loss: 29834874.3550; val_kl_reg_loss: 19048.5236; val_edge_recon_loss: 1062747.6590; val_gene_expr_recon_loss: 28735479.3684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29817275.5439; val_optim_loss: 29817275.5439
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9752; val_auprc_score: 0.9907; val_best_acc_score: 0.9572; val_best_f1_score: 0.9734; train_kl_reg_loss: 19099.6431; train_edge_recon_loss: 1060132.4798; train_gene_expr_recon_loss: 28733867.5069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29813099.6292; train_optim_loss: 29813099.6292; val_kl_reg_loss: 18931.3420; val_edge_recon_loss: 1087540.2873; val_gene_expr_recon_loss: 28741754.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29848225.6140; val_optim_loss: 29848225.6140
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9734; val_auprc_score: 0.9909; val_best_acc_score: 0.9586; val_best_f1_score: 0.9744; train_kl_reg_loss: 18916.3414; train_edge_recon_loss: 1066232.2056; train_gene_expr_recon_loss: 28732174.0592; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29817322.6193; train_optim_loss: 29817322.6193; val_kl_reg_loss: 18793.3197; val_edge_recon_loss: 1068104.8410; val_gene_expr_recon_loss: 28745687.2982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29832585.5789; val_optim_loss: 29832585.5789
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9754; val_auprc_score: 0.9911; val_best_acc_score: 0.9588; val_best_f1_score: 0.9744; train_kl_reg_loss: 18809.4028; train_edge_recon_loss: 1066296.0325; train_gene_expr_recon_loss: 28731339.4596; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29816444.9191; train_optim_loss: 29816444.9191; val_kl_reg_loss: 18568.5058; val_edge_recon_loss: 1079850.6469; val_gene_expr_recon_loss: 28749658.0702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29848077.1579; val_optim_loss: 29848077.1579
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9744; val_auprc_score: 0.9901; val_best_acc_score: 0.9571; val_best_f1_score: 0.9733; train_kl_reg_loss: 18683.2422; train_edge_recon_loss: 1064634.0445; train_gene_expr_recon_loss: 28727698.4379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29811015.7594; train_optim_loss: 29811015.7594; val_kl_reg_loss: 18640.1762; val_edge_recon_loss: 1083955.3805; val_gene_expr_recon_loss: 28742383.5088; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29844979.0175; val_optim_loss: 29844979.0175

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9759; val_auprc_score: 0.9909; val_best_acc_score: 0.9602; val_best_f1_score: 0.9752; train_kl_reg_loss: 18790.4041; train_edge_recon_loss: 1070476.8454; train_gene_expr_recon_loss: 28681886.3037; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29771153.5582; train_optim_loss: 29771153.5582; val_kl_reg_loss: 18623.0904; val_edge_recon_loss: 1085124.5921; val_gene_expr_recon_loss: 28693301.8596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29797049.6140; val_optim_loss: 29797049.6140
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9744; val_auprc_score: 0.9902; val_best_acc_score: 0.9581; val_best_f1_score: 0.9741; train_kl_reg_loss: 18671.6172; train_edge_recon_loss: 1069440.0219; train_gene_expr_recon_loss: 28676875.4043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29764987.0690; train_optim_loss: 29764987.0690; val_kl_reg_loss: 18616.9476; val_edge_recon_loss: 1079900.1371; val_gene_expr_recon_loss: 28704375.8596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29802892.9825; val_optim_loss: 29802892.9825
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9755; val_auprc_score: 0.9911; val_best_acc_score: 0.9599; val_best_f1_score: 0.9750; train_kl_reg_loss: 18646.7076; train_edge_recon_loss: 1070851.9469; train_gene_expr_recon_loss: 28680155.9527; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29769654.6469; train_optim_loss: 29769654.6469; val_kl_reg_loss: 18610.1993; val_edge_recon_loss: 1081394.1557; val_gene_expr_recon_loss: 28690244.2807; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29790248.5965; val_optim_loss: 29790248.5965
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9781; val_auprc_score: 0.9926; val_best_acc_score: 0.9617; val_best_f1_score: 0.9761; train_kl_reg_loss: 18675.8290; train_edge_recon_loss: 1070061.5375; train_gene_expr_recon_loss: 28675074.4813; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29763811.8777; train_optim_loss: 29763811.8777; val_kl_reg_loss: 18597.7521; val_edge_recon_loss: 1090165.7171; val_gene_expr_recon_loss: 28687789.4386; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29796552.8421; val_optim_loss: 29796552.8421
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9778; val_auprc_score: 0.9925; val_best_acc_score: 0.9604; val_best_f1_score: 0.9755; train_kl_reg_loss: 18690.6519; train_edge_recon_loss: 1068368.3717; train_gene_expr_recon_loss: 28674551.4872; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29761610.4813; train_optim_loss: 29761610.4813; val_kl_reg_loss: 18668.6184; val_edge_recon_loss: 1055315.5866; val_gene_expr_recon_loss: 28686849.8246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29760834.0000; val_optim_loss: 29760834.0000
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9763; val_auprc_score: 0.9918; val_best_acc_score: 0.9593; val_best_f1_score: 0.9746; train_kl_reg_loss: 18742.1647; train_edge_recon_loss: 1068199.5224; train_gene_expr_recon_loss: 28677499.6529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29764441.3176; train_optim_loss: 29764441.3176; val_kl_reg_loss: 18688.8404; val_edge_recon_loss: 1092865.3202; val_gene_expr_recon_loss: 28694305.9298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29805860.1404; val_optim_loss: 29805860.1404
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9776; val_auprc_score: 0.9925; val_best_acc_score: 0.9623; val_best_f1_score: 0.9766; train_kl_reg_loss: 18759.5126; train_edge_recon_loss: 1069353.0615; train_gene_expr_recon_loss: 28681092.7377; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29769205.3176; train_optim_loss: 29769205.3176; val_kl_reg_loss: 18600.4538; val_edge_recon_loss: 1065040.3695; val_gene_expr_recon_loss: 28678820.8070; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29762461.6140; val_optim_loss: 29762461.6140
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9779; val_auprc_score: 0.9923; val_best_acc_score: 0.9613; val_best_f1_score: 0.9761; train_kl_reg_loss: 18747.7255; train_edge_recon_loss: 1065024.5836; train_gene_expr_recon_loss: 28674642.6824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29758415.0375; train_optim_loss: 29758415.0375; val_kl_reg_loss: 18691.7186; val_edge_recon_loss: 1061587.6919; val_gene_expr_recon_loss: 28696171.9298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29776451.3684; val_optim_loss: 29776451.3684
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9752; val_auprc_score: 0.9909; val_best_acc_score: 0.9600; val_best_f1_score: 0.9751; train_kl_reg_loss: 18767.5611; train_edge_recon_loss: 1063535.5117; train_gene_expr_recon_loss: 28675416.1262; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29757719.1913; train_optim_loss: 29757719.1913; val_kl_reg_loss: 18790.8005; val_edge_recon_loss: 1079047.9419; val_gene_expr_recon_loss: 28691797.9649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29789636.7018; val_optim_loss: 29789636.7018

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9763; val_auprc_score: 0.9920; val_best_acc_score: 0.9587; val_best_f1_score: 0.9744; train_kl_reg_loss: 18826.5591; train_edge_recon_loss: 1067770.9894; train_gene_expr_recon_loss: 28672036.0907; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29758633.6489; train_optim_loss: 29758633.6489; val_kl_reg_loss: 18755.6523; val_edge_recon_loss: 1071084.1689; val_gene_expr_recon_loss: 28674239.2982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29764079.0877; val_optim_loss: 29764079.0877
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9776; val_auprc_score: 0.9920; val_best_acc_score: 0.9604; val_best_f1_score: 0.9754; train_kl_reg_loss: 18811.2857; train_edge_recon_loss: 1068917.7804; train_gene_expr_recon_loss: 28673599.3886; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29761328.4024; train_optim_loss: 29761328.4024; val_kl_reg_loss: 18766.0751; val_edge_recon_loss: 1072314.1250; val_gene_expr_recon_loss: 28694135.4737; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29785215.7895; val_optim_loss: 29785215.7895
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9771; val_auprc_score: 0.9922; val_best_acc_score: 0.9606; val_best_f1_score: 0.9754; train_kl_reg_loss: 18803.2049; train_edge_recon_loss: 1070487.2954; train_gene_expr_recon_loss: 28672328.9507; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29761619.4793; train_optim_loss: 29761619.4793; val_kl_reg_loss: 18775.8680; val_edge_recon_loss: 1074352.5066; val_gene_expr_recon_loss: 28682273.2982; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29775401.7193; val_optim_loss: 29775401.7193
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9761; val_auprc_score: 0.9914; val_best_acc_score: 0.9596; val_best_f1_score: 0.9750; train_kl_reg_loss: 18794.3383; train_edge_recon_loss: 1066475.2266; train_gene_expr_recon_loss: 28666489.6568; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29751759.2150; train_optim_loss: 29751759.2150; val_kl_reg_loss: 18728.5835; val_edge_recon_loss: 1063149.2566; val_gene_expr_recon_loss: 28686192.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29768069.9649; val_optim_loss: 29768069.9649

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 136 min 19 sec.
Using best model state, which was in epoch 48.

--- MODEL EVALUATION ---
val AUROC score: 0.9775
val AUPRC score: 0.9927
val best accuracy score: 0.9603
val best F1 score: 0.9754
val target rna MSE score: 0.9129
val source rna MSE score: 0.3812
Val cat covariate0 mean sim diff: -0.0016

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
