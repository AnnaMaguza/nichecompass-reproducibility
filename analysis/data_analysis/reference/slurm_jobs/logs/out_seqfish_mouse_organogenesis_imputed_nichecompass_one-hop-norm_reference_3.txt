[True]
Run timestamp: 01082024_104747_3.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '30.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_3']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2444.
Number of gene programs after filtering and combining: 2109.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8510 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1961, n_latent: 1861, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1861, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1861, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 28792
Number of validation nodes: 3199
Number of training edges: 129792
Number of validation edges: 14421
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8832; val_auprc_score: 0.9634; val_best_acc_score: 0.8721; val_best_f1_score: 0.9218; train_kl_reg_loss: 58508.8630; train_edge_recon_loss: 157836.2681; train_gene_expr_recon_loss: 4645519.0444; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 406362.3529; train_global_loss: 5268226.5187; train_optim_loss: 5268226.5187; val_kl_reg_loss: 42990.8110; val_edge_recon_loss: 151017.7241; val_gene_expr_recon_loss: 4170867.7325; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 137827.8594; val_global_loss: 4502704.2719; val_optim_loss: 4502704.2719
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9143; val_auprc_score: 0.9750; val_best_acc_score: 0.8900; val_best_f1_score: 0.9332; train_kl_reg_loss: 38250.5481; train_edge_recon_loss: 142444.8403; train_gene_expr_recon_loss: 4010313.4043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85095.9780; train_global_loss: 4276104.7678; train_optim_loss: 4276104.7678; val_kl_reg_loss: 33936.9398; val_edge_recon_loss: 136244.9941; val_gene_expr_recon_loss: 3872507.2719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54709.9414; val_global_loss: 4097399.2237; val_optim_loss: 4097399.2237
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9335; val_auprc_score: 0.9798; val_best_acc_score: 0.9023; val_best_f1_score: 0.9405; train_kl_reg_loss: 31420.5121; train_edge_recon_loss: 135536.2054; train_gene_expr_recon_loss: 3764706.0335; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 42551.1563; train_global_loss: 3974213.9073; train_optim_loss: 3974213.9073; val_kl_reg_loss: 29266.6798; val_edge_recon_loss: 132183.6690; val_gene_expr_recon_loss: 3666387.6272; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 34132.5820; val_global_loss: 3861970.4868; val_optim_loss: 3861970.4868
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9427; val_auprc_score: 0.9824; val_best_acc_score: 0.9175; val_best_f1_score: 0.9500; train_kl_reg_loss: 27242.7170; train_edge_recon_loss: 130871.1450; train_gene_expr_recon_loss: 3586386.6203; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 29891.7972; train_global_loss: 3774392.2747; train_optim_loss: 3774392.2747; val_kl_reg_loss: 25737.4252; val_edge_recon_loss: 127969.1186; val_gene_expr_recon_loss: 3511302.6404; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 27163.4277; val_global_loss: 3692172.6711; val_optim_loss: 3692172.6711
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9541; val_auprc_score: 0.9851; val_best_acc_score: 0.9290; val_best_f1_score: 0.9561; train_kl_reg_loss: 24222.8898; train_edge_recon_loss: 127303.2270; train_gene_expr_recon_loss: 3447660.2140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25514.3064; train_global_loss: 3624700.6440; train_optim_loss: 3624700.6440; val_kl_reg_loss: 22877.7236; val_edge_recon_loss: 127474.6830; val_gene_expr_recon_loss: 3386280.1447; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24527.1523; val_global_loss: 3561159.7982; val_optim_loss: 3561159.7982
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9588; val_auprc_score: 0.9872; val_best_acc_score: 0.9351; val_best_f1_score: 0.9600; train_kl_reg_loss: 21643.7509; train_edge_recon_loss: 122835.0765; train_gene_expr_recon_loss: 3335968.0552; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24253.2710; train_global_loss: 3504700.1588; train_optim_loss: 3504700.1588; val_kl_reg_loss: 20357.2778; val_edge_recon_loss: 121889.7558; val_gene_expr_recon_loss: 3289908.6754; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24148.5938; val_global_loss: 3456304.2105; val_optim_loss: 3456304.2105
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9612; val_auprc_score: 0.9873; val_best_acc_score: 0.9389; val_best_f1_score: 0.9622; train_kl_reg_loss: 19354.5961; train_edge_recon_loss: 121556.9311; train_gene_expr_recon_loss: 3246226.6509; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24474.6858; train_global_loss: 3411612.8649; train_optim_loss: 3411612.8649; val_kl_reg_loss: 18193.5271; val_edge_recon_loss: 121272.1842; val_gene_expr_recon_loss: 3207582.8596; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24849.0762; val_global_loss: 3371897.5877; val_optim_loss: 3371897.5877
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9676; val_auprc_score: 0.9897; val_best_acc_score: 0.9467; val_best_f1_score: 0.9670; train_kl_reg_loss: 17556.6431; train_edge_recon_loss: 118672.8139; train_gene_expr_recon_loss: 3173451.8378; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25136.8907; train_global_loss: 3334818.1879; train_optim_loss: 3334818.1879; val_kl_reg_loss: 16765.8953; val_edge_recon_loss: 118214.5032; val_gene_expr_recon_loss: 3140966.6360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25440.7070; val_global_loss: 3301387.7851; val_optim_loss: 3301387.7851
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9647; val_auprc_score: 0.9872; val_best_acc_score: 0.9483; val_best_f1_score: 0.9682; train_kl_reg_loss: 16126.6819; train_edge_recon_loss: 116571.9568; train_gene_expr_recon_loss: 3114927.1504; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25557.6047; train_global_loss: 3273183.3945; train_optim_loss: 3273183.3945; val_kl_reg_loss: 15459.2088; val_edge_recon_loss: 114755.1451; val_gene_expr_recon_loss: 3090279.5132; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25321.8926; val_global_loss: 3245815.8553; val_optim_loss: 3245815.8553
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9705; val_auprc_score: 0.9897; val_best_acc_score: 0.9500; val_best_f1_score: 0.9691; train_kl_reg_loss: 15004.2956; train_edge_recon_loss: 115517.1663; train_gene_expr_recon_loss: 3069083.8023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25496.7389; train_global_loss: 3225102.0059; train_optim_loss: 3225102.0059; val_kl_reg_loss: 14677.8573; val_edge_recon_loss: 114902.2622; val_gene_expr_recon_loss: 3050745.4561; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25363.4395; val_global_loss: 3205689.0789; val_optim_loss: 3205689.0789
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9700; val_auprc_score: 0.9899; val_best_acc_score: 0.9505; val_best_f1_score: 0.9693; train_kl_reg_loss: 14183.9308; train_edge_recon_loss: 114240.0015; train_gene_expr_recon_loss: 3032238.1657; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25345.1327; train_global_loss: 3186007.2406; train_optim_loss: 3186007.2406; val_kl_reg_loss: 13793.4555; val_edge_recon_loss: 113524.3385; val_gene_expr_recon_loss: 3015170.5175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25099.0137; val_global_loss: 3167587.3158; val_optim_loss: 3167587.3158
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9690; val_auprc_score: 0.9894; val_best_acc_score: 0.9509; val_best_f1_score: 0.9694; train_kl_reg_loss: 13531.8125; train_edge_recon_loss: 112863.1009; train_gene_expr_recon_loss: 3002745.5710; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25244.7224; train_global_loss: 3154385.2027; train_optim_loss: 3154385.2027; val_kl_reg_loss: 13170.9339; val_edge_recon_loss: 115909.7897; val_gene_expr_recon_loss: 2990187.1798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25016.9336; val_global_loss: 3144284.8947; val_optim_loss: 3144284.8947
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9718; val_auprc_score: 0.9905; val_best_acc_score: 0.9549; val_best_f1_score: 0.9722; train_kl_reg_loss: 13012.7882; train_edge_recon_loss: 111590.4371; train_gene_expr_recon_loss: 2978928.0745; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24978.2244; train_global_loss: 3128509.5256; train_optim_loss: 3128509.5256; val_kl_reg_loss: 12646.3822; val_edge_recon_loss: 110106.0715; val_gene_expr_recon_loss: 2969236.7675; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24963.7031; val_global_loss: 3116952.9649; val_optim_loss: 3116952.9649
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9720; val_auprc_score: 0.9899; val_best_acc_score: 0.9526; val_best_f1_score: 0.9707; train_kl_reg_loss: 12519.4297; train_edge_recon_loss: 111104.5147; train_gene_expr_recon_loss: 2960466.2608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24716.9087; train_global_loss: 3108807.1193; train_optim_loss: 3108807.1193; val_kl_reg_loss: 12368.2079; val_edge_recon_loss: 110948.6495; val_gene_expr_recon_loss: 2951974.6184; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24488.6895; val_global_loss: 3099780.2149; val_optim_loss: 3099780.2149
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9709; val_auprc_score: 0.9902; val_best_acc_score: 0.9538; val_best_f1_score: 0.9713; train_kl_reg_loss: 12214.5783; train_edge_recon_loss: 111066.6657; train_gene_expr_recon_loss: 2945256.3812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24477.8765; train_global_loss: 3093015.5005; train_optim_loss: 3093015.5005; val_kl_reg_loss: 11958.3885; val_edge_recon_loss: 111481.8673; val_gene_expr_recon_loss: 2940233.7193; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24069.0059; val_global_loss: 3087742.9605; val_optim_loss: 3087742.9605
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9632; val_auprc_score: 0.9878; val_best_acc_score: 0.9356; val_best_f1_score: 0.9601; train_kl_reg_loss: 11920.5197; train_edge_recon_loss: 111128.6723; train_gene_expr_recon_loss: 2953740.4763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26571.3672; train_global_loss: 3103361.0365; train_optim_loss: 3103361.0365; val_kl_reg_loss: 11273.1699; val_edge_recon_loss: 112645.5251; val_gene_expr_recon_loss: 2974421.1491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 31172.1680; val_global_loss: 3129512.1096; val_optim_loss: 3129512.1096
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9669; val_auprc_score: 0.9886; val_best_acc_score: 0.9473; val_best_f1_score: 0.9674; train_kl_reg_loss: 11034.9646; train_edge_recon_loss: 111300.6908; train_gene_expr_recon_loss: 2947243.8062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24997.5263; train_global_loss: 3094576.9882; train_optim_loss: 3094576.9882; val_kl_reg_loss: 11042.6369; val_edge_recon_loss: 110514.9084; val_gene_expr_recon_loss: 2937395.0570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23899.0664; val_global_loss: 3082851.6009; val_optim_loss: 3082851.6009
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9693; val_auprc_score: 0.9898; val_best_acc_score: 0.9532; val_best_f1_score: 0.9711; train_kl_reg_loss: 11010.9913; train_edge_recon_loss: 109326.6236; train_gene_expr_recon_loss: 2932390.5138; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23512.4155; train_global_loss: 3076240.5483; train_optim_loss: 3076240.5483; val_kl_reg_loss: 10994.5979; val_edge_recon_loss: 108313.3923; val_gene_expr_recon_loss: 2930024.3509; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23251.3887; val_global_loss: 3072583.8421; val_optim_loss: 3072583.8421
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9706; val_auprc_score: 0.9904; val_best_acc_score: 0.9522; val_best_f1_score: 0.9705; train_kl_reg_loss: 10931.6092; train_edge_recon_loss: 109806.8400; train_gene_expr_recon_loss: 2925039.7239; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23291.4345; train_global_loss: 3069069.5952; train_optim_loss: 3069069.5952; val_kl_reg_loss: 10954.0314; val_edge_recon_loss: 108078.3810; val_gene_expr_recon_loss: 2921497.5965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23290.9395; val_global_loss: 3063820.9956; val_optim_loss: 3063820.9956
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9706; val_auprc_score: 0.9903; val_best_acc_score: 0.9508; val_best_f1_score: 0.9696; train_kl_reg_loss: 10856.7254; train_edge_recon_loss: 109625.7395; train_gene_expr_recon_loss: 2919339.3057; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23146.7071; train_global_loss: 3062968.4872; train_optim_loss: 3062968.4872; val_kl_reg_loss: 10773.5639; val_edge_recon_loss: 110215.5639; val_gene_expr_recon_loss: 2916320.6798; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22854.6152; val_global_loss: 3060164.3026; val_optim_loss: 3060164.3026
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9694; val_auprc_score: 0.9898; val_best_acc_score: 0.9523; val_best_f1_score: 0.9707; train_kl_reg_loss: 10769.1082; train_edge_recon_loss: 109064.3092; train_gene_expr_recon_loss: 2915508.3323; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23071.0581; train_global_loss: 3058412.8107; train_optim_loss: 3058412.8107; val_kl_reg_loss: 10784.2364; val_edge_recon_loss: 106021.2146; val_gene_expr_recon_loss: 2913881.2018; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22889.9336; val_global_loss: 3053576.6491; val_optim_loss: 3053576.6491
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9744; val_auprc_score: 0.9916; val_best_acc_score: 0.9575; val_best_f1_score: 0.9736; train_kl_reg_loss: 10681.8242; train_edge_recon_loss: 108998.2886; train_gene_expr_recon_loss: 2911537.8082; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22922.4767; train_global_loss: 3054140.4034; train_optim_loss: 3054140.4034; val_kl_reg_loss: 10703.7178; val_edge_recon_loss: 107580.5548; val_gene_expr_recon_loss: 2910027.9342; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22684.9805; val_global_loss: 3050997.1974; val_optim_loss: 3050997.1974
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9713; val_auprc_score: 0.9896; val_best_acc_score: 0.9550; val_best_f1_score: 0.9721; train_kl_reg_loss: 10605.8628; train_edge_recon_loss: 109213.3521; train_gene_expr_recon_loss: 2908609.3146; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22904.3852; train_global_loss: 3051332.9162; train_optim_loss: 3051332.9162; val_kl_reg_loss: 10439.4629; val_edge_recon_loss: 109818.5888; val_gene_expr_recon_loss: 2908832.3158; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23078.4512; val_global_loss: 3052168.8684; val_optim_loss: 3052168.8684
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9736; val_auprc_score: 0.9914; val_best_acc_score: 0.9549; val_best_f1_score: 0.9721; train_kl_reg_loss: 10549.2496; train_edge_recon_loss: 108969.7931; train_gene_expr_recon_loss: 2906498.2096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22799.9729; train_global_loss: 3048817.2318; train_optim_loss: 3048817.2318; val_kl_reg_loss: 10387.5522; val_edge_recon_loss: 107949.2186; val_gene_expr_recon_loss: 2906146.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22646.5723; val_global_loss: 3047129.5877; val_optim_loss: 3047129.5877
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9700; val_auprc_score: 0.9894; val_best_acc_score: 0.9535; val_best_f1_score: 0.9712; train_kl_reg_loss: 10493.4350; train_edge_recon_loss: 109257.6400; train_gene_expr_recon_loss: 2904141.2535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 22702.8777; train_global_loss: 3046595.2071; train_optim_loss: 3046595.2071; val_kl_reg_loss: 10522.6409; val_edge_recon_loss: 109584.7367; val_gene_expr_recon_loss: 2904110.1053; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 22642.8008; val_global_loss: 3046860.2325; val_optim_loss: 3046860.2325
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9735; val_auprc_score: 0.9906; val_best_acc_score: 0.9537; val_best_f1_score: 0.9712; train_kl_reg_loss: 9690.3992; train_edge_recon_loss: 108466.6737; train_gene_expr_recon_loss: 2901339.2899; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21242.5222; train_global_loss: 3040738.8871; train_optim_loss: 3040738.8871; val_kl_reg_loss: 9537.1808; val_edge_recon_loss: 108922.2647; val_gene_expr_recon_loss: 2900029.8728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21063.5312; val_global_loss: 3039552.8114; val_optim_loss: 3039552.8114
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9722; val_auprc_score: 0.9908; val_best_acc_score: 0.9558; val_best_f1_score: 0.9727; train_kl_reg_loss: 9541.1474; train_edge_recon_loss: 107965.3185; train_gene_expr_recon_loss: 2900588.0641; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21163.0158; train_global_loss: 3039257.5498; train_optim_loss: 3039257.5498; val_kl_reg_loss: 9404.3138; val_edge_recon_loss: 106468.9127; val_gene_expr_recon_loss: 2900833.3377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21257.4609; val_global_loss: 3037964.0658; val_optim_loss: 3037964.0658
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9706; val_auprc_score: 0.9900; val_best_acc_score: 0.9536; val_best_f1_score: 0.9712; train_kl_reg_loss: 9453.8180; train_edge_recon_loss: 108947.0121; train_gene_expr_recon_loss: 2900745.8876; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21182.7900; train_global_loss: 3040329.5030; train_optim_loss: 3040329.5030; val_kl_reg_loss: 9381.3101; val_edge_recon_loss: 107732.1813; val_gene_expr_recon_loss: 2897915.1360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21228.0879; val_global_loss: 3036256.6316; val_optim_loss: 3036256.6316
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9697; val_auprc_score: 0.9886; val_best_acc_score: 0.9535; val_best_f1_score: 0.9710; train_kl_reg_loss: 9444.6112; train_edge_recon_loss: 108283.0351; train_gene_expr_recon_loss: 2897716.8432; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21037.5912; train_global_loss: 3036482.0809; train_optim_loss: 3036482.0809; val_kl_reg_loss: 9386.8154; val_edge_recon_loss: 111193.4433; val_gene_expr_recon_loss: 2897353.8246; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21126.0156; val_global_loss: 3039060.0921; val_optim_loss: 3039060.0921
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9680; val_auprc_score: 0.9890; val_best_acc_score: 0.9529; val_best_f1_score: 0.9710; train_kl_reg_loss: 9404.6286; train_edge_recon_loss: 108692.2664; train_gene_expr_recon_loss: 2897148.6252; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 21001.0212; train_global_loss: 3036246.5449; train_optim_loss: 3036246.5449; val_kl_reg_loss: 9414.4858; val_edge_recon_loss: 108069.3623; val_gene_expr_recon_loss: 2897316.5570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21086.0625; val_global_loss: 3035886.4123; val_optim_loss: 3035886.4123
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9727; val_auprc_score: 0.9905; val_best_acc_score: 0.9525; val_best_f1_score: 0.9706; train_kl_reg_loss: 9352.7233; train_edge_recon_loss: 108469.6098; train_gene_expr_recon_loss: 2896425.5311; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20895.5996; train_global_loss: 3035143.4576; train_optim_loss: 3035143.4576; val_kl_reg_loss: 9378.5978; val_edge_recon_loss: 109301.4072; val_gene_expr_recon_loss: 2896357.2500; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 21038.6367; val_global_loss: 3036076.0088; val_optim_loss: 3036076.0088
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9686; val_auprc_score: 0.9888; val_best_acc_score: 0.9529; val_best_f1_score: 0.9707; train_kl_reg_loss: 9326.6642; train_edge_recon_loss: 108678.4246; train_gene_expr_recon_loss: 2895813.5212; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20815.5400; train_global_loss: 3034634.1504; train_optim_loss: 3034634.1504; val_kl_reg_loss: 9206.9747; val_edge_recon_loss: 109977.0593; val_gene_expr_recon_loss: 2896944.5965; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20700.0703; val_global_loss: 3036828.6272; val_optim_loss: 3036828.6272
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9686; val_auprc_score: 0.9888; val_best_acc_score: 0.9530; val_best_f1_score: 0.9708; train_kl_reg_loss: 9253.2791; train_edge_recon_loss: 108001.2455; train_gene_expr_recon_loss: 2895336.5306; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20759.5622; train_global_loss: 3033350.6183; train_optim_loss: 3033350.6183; val_kl_reg_loss: 9166.0737; val_edge_recon_loss: 108789.4762; val_gene_expr_recon_loss: 2896205.9781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20447.5273; val_global_loss: 3034609.0219; val_optim_loss: 3034609.0219
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9723; val_auprc_score: 0.9905; val_best_acc_score: 0.9531; val_best_f1_score: 0.9710; train_kl_reg_loss: 9259.8318; train_edge_recon_loss: 108468.0163; train_gene_expr_recon_loss: 2894344.4117; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20642.7827; train_global_loss: 3032715.0454; train_optim_loss: 3032715.0454; val_kl_reg_loss: 9319.5780; val_edge_recon_loss: 109413.4176; val_gene_expr_recon_loss: 2894836.8553; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20598.3945; val_global_loss: 3034168.3465; val_optim_loss: 3034168.3465
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9735; val_auprc_score: 0.9906; val_best_acc_score: 0.9547; val_best_f1_score: 0.9718; train_kl_reg_loss: 9239.9614; train_edge_recon_loss: 108050.4600; train_gene_expr_recon_loss: 2894325.8974; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20584.7989; train_global_loss: 3032201.1075; train_optim_loss: 3032201.1075; val_kl_reg_loss: 9350.6326; val_edge_recon_loss: 110290.3395; val_gene_expr_recon_loss: 2894587.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20798.5586; val_global_loss: 3035027.1886; val_optim_loss: 3035027.1886
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9741; val_auprc_score: 0.9914; val_best_acc_score: 0.9546; val_best_f1_score: 0.9718; train_kl_reg_loss: 9211.3335; train_edge_recon_loss: 107503.7791; train_gene_expr_recon_loss: 2893637.2352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20614.0653; train_global_loss: 3030966.4117; train_optim_loss: 3030966.4117; val_kl_reg_loss: 9163.7480; val_edge_recon_loss: 108906.3716; val_gene_expr_recon_loss: 2892881.8728; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20668.6172; val_global_loss: 3031620.4825; val_optim_loss: 3031620.4825
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9714; val_auprc_score: 0.9893; val_best_acc_score: 0.9528; val_best_f1_score: 0.9708; train_kl_reg_loss: 9196.0272; train_edge_recon_loss: 107917.8636; train_gene_expr_recon_loss: 2893841.5557; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20577.7714; train_global_loss: 3031533.2135; train_optim_loss: 3031533.2135; val_kl_reg_loss: 9282.7289; val_edge_recon_loss: 109504.6842; val_gene_expr_recon_loss: 2893677.0570; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20685.7227; val_global_loss: 3033150.2061; val_optim_loss: 3033150.2061
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9722; val_auprc_score: 0.9903; val_best_acc_score: 0.9547; val_best_f1_score: 0.9718; train_kl_reg_loss: 9189.1803; train_edge_recon_loss: 108268.7548; train_gene_expr_recon_loss: 2894295.0069; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20564.7151; train_global_loss: 3032317.6588; train_optim_loss: 3032317.6588; val_kl_reg_loss: 9175.3059; val_edge_recon_loss: 109780.1113; val_gene_expr_recon_loss: 2895270.0702; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20658.5898; val_global_loss: 3034883.9956; val_optim_loss: 3034883.9956
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9678; val_auprc_score: 0.9894; val_best_acc_score: 0.9537; val_best_f1_score: 0.9715; train_kl_reg_loss: 9166.5496; train_edge_recon_loss: 108440.8188; train_gene_expr_recon_loss: 2893709.0493; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20575.0878; train_global_loss: 3031891.5108; train_optim_loss: 3031891.5108; val_kl_reg_loss: 9252.4708; val_edge_recon_loss: 106975.3177; val_gene_expr_recon_loss: 2892234.4123; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20663.0234; val_global_loss: 3029125.1974; val_optim_loss: 3029125.1974
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9728; val_auprc_score: 0.9902; val_best_acc_score: 0.9560; val_best_f1_score: 0.9727; train_kl_reg_loss: 9152.8039; train_edge_recon_loss: 107026.7118; train_gene_expr_recon_loss: 2892921.3812; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20513.9662; train_global_loss: 3029614.8595; train_optim_loss: 3029614.8595; val_kl_reg_loss: 9165.0082; val_edge_recon_loss: 109658.2959; val_gene_expr_recon_loss: 2892865.6623; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20380.8828; val_global_loss: 3032069.9605; val_optim_loss: 3032069.9605
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9713; val_auprc_score: 0.9905; val_best_acc_score: 0.9537; val_best_f1_score: 0.9713; train_kl_reg_loss: 9157.0118; train_edge_recon_loss: 107654.7225; train_gene_expr_recon_loss: 2892755.2668; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20523.8978; train_global_loss: 3030090.8994; train_optim_loss: 3030090.8994; val_kl_reg_loss: 9176.4774; val_edge_recon_loss: 107665.4883; val_gene_expr_recon_loss: 2892377.2368; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20521.2559; val_global_loss: 3029740.4518; val_optim_loss: 3029740.4518
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9736; val_auprc_score: 0.9907; val_best_acc_score: 0.9559; val_best_f1_score: 0.9726; train_kl_reg_loss: 9139.0539; train_edge_recon_loss: 107589.3872; train_gene_expr_recon_loss: 2892272.1183; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20526.1028; train_global_loss: 3029526.6672; train_optim_loss: 3029526.6672; val_kl_reg_loss: 9129.7125; val_edge_recon_loss: 108792.6192; val_gene_expr_recon_loss: 2892573.0044; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20575.8340; val_global_loss: 3031071.0921; val_optim_loss: 3031071.0921
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9734; val_auprc_score: 0.9897; val_best_acc_score: 0.9564; val_best_f1_score: 0.9729; train_kl_reg_loss: 9112.1352; train_edge_recon_loss: 107535.9153; train_gene_expr_recon_loss: 2891901.2268; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 20514.9178; train_global_loss: 3029064.1958; train_optim_loss: 3029064.1958; val_kl_reg_loss: 9118.8213; val_edge_recon_loss: 109208.5038; val_gene_expr_recon_loss: 2893777.6009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 20348.8477; val_global_loss: 3032453.6798; val_optim_loss: 3032453.6798

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9731; val_auprc_score: 0.9905; val_best_acc_score: 0.9548; val_best_f1_score: 0.9720; train_kl_reg_loss: 9268.0785; train_edge_recon_loss: 108067.5027; train_gene_expr_recon_loss: 2884818.1834; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17328.3597; train_global_loss: 3019482.1292; train_optim_loss: 3019482.1292; val_kl_reg_loss: 9365.4013; val_edge_recon_loss: 109416.8283; val_gene_expr_recon_loss: 2885223.2851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16960.3145; val_global_loss: 3020965.7456; val_optim_loss: 3020965.7456
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9719; val_auprc_score: 0.9896; val_best_acc_score: 0.9536; val_best_f1_score: 0.9711; train_kl_reg_loss: 9499.2018; train_edge_recon_loss: 107982.1003; train_gene_expr_recon_loss: 2884458.5873; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16698.2990; train_global_loss: 3018638.1958; train_optim_loss: 3018638.1958; val_kl_reg_loss: 9632.6473; val_edge_recon_loss: 108759.9892; val_gene_expr_recon_loss: 2886147.9649; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16462.4746; val_global_loss: 3021003.0965; val_optim_loss: 3021003.0965
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9736; val_auprc_score: 0.9906; val_best_acc_score: 0.9547; val_best_f1_score: 0.9719; train_kl_reg_loss: 9749.6470; train_edge_recon_loss: 107982.8555; train_gene_expr_recon_loss: 2884695.1642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16339.6756; train_global_loss: 3018767.3447; train_optim_loss: 3018767.3447; val_kl_reg_loss: 9837.5489; val_edge_recon_loss: 109142.2797; val_gene_expr_recon_loss: 2884593.2281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16137.1543; val_global_loss: 3019710.3026; val_optim_loss: 3019710.3026
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9757; val_auprc_score: 0.9920; val_best_acc_score: 0.9575; val_best_f1_score: 0.9736; train_kl_reg_loss: 9967.4163; train_edge_recon_loss: 108040.4716; train_gene_expr_recon_loss: 2884102.6770; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16043.3354; train_global_loss: 3018153.8989; train_optim_loss: 3018153.8989; val_kl_reg_loss: 10078.7856; val_edge_recon_loss: 109856.1613; val_gene_expr_recon_loss: 2884287.2851; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15915.3037; val_global_loss: 3020137.4649; val_optim_loss: 3020137.4649
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9749; val_auprc_score: 0.9917; val_best_acc_score: 0.9549; val_best_f1_score: 0.9722; train_kl_reg_loss: 10173.4722; train_edge_recon_loss: 107817.9786; train_gene_expr_recon_loss: 2883912.1257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15801.7086; train_global_loss: 3017705.2959; train_optim_loss: 3017705.2959; val_kl_reg_loss: 10282.8846; val_edge_recon_loss: 106350.0932; val_gene_expr_recon_loss: 2884004.0175; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15680.9951; val_global_loss: 3016317.9912; val_optim_loss: 3016317.9912
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9738; val_auprc_score: 0.9912; val_best_acc_score: 0.9548; val_best_f1_score: 0.9718; train_kl_reg_loss: 10361.7966; train_edge_recon_loss: 107794.9040; train_gene_expr_recon_loss: 2884096.8767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15592.8554; train_global_loss: 3017846.4359; train_optim_loss: 3017846.4359; val_kl_reg_loss: 10459.0400; val_edge_recon_loss: 110146.5987; val_gene_expr_recon_loss: 2884568.4825; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15540.2852; val_global_loss: 3020714.3684; val_optim_loss: 3020714.3684
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9747; val_auprc_score: 0.9915; val_best_acc_score: 0.9576; val_best_f1_score: 0.9737; train_kl_reg_loss: 10524.1691; train_edge_recon_loss: 107879.7836; train_gene_expr_recon_loss: 2884400.9650; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15426.9897; train_global_loss: 3018231.8989; train_optim_loss: 3018231.8989; val_kl_reg_loss: 10533.4238; val_edge_recon_loss: 107195.8853; val_gene_expr_recon_loss: 2882745.6360; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15377.9990; val_global_loss: 3015852.9474; val_optim_loss: 3015852.9474
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9761; val_auprc_score: 0.9919; val_best_acc_score: 0.9583; val_best_f1_score: 0.9741; train_kl_reg_loss: 10655.4159; train_edge_recon_loss: 107425.1370; train_gene_expr_recon_loss: 2883585.8703; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15290.8208; train_global_loss: 3016957.2436; train_optim_loss: 3016957.2436; val_kl_reg_loss: 10748.8301; val_edge_recon_loss: 106801.6018; val_gene_expr_recon_loss: 2884474.2281; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15144.7129; val_global_loss: 3017169.4167; val_optim_loss: 3017169.4167
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9732; val_auprc_score: 0.9904; val_best_acc_score: 0.9556; val_best_f1_score: 0.9725; train_kl_reg_loss: 10801.0608; train_edge_recon_loss: 107213.9776; train_gene_expr_recon_loss: 2883662.1815; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15144.8838; train_global_loss: 3016822.1036; train_optim_loss: 3016822.1036; val_kl_reg_loss: 10870.2720; val_edge_recon_loss: 108951.3427; val_gene_expr_recon_loss: 2884178.0526; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15059.5596; val_global_loss: 3019059.1798; val_optim_loss: 3019059.1798
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9741; val_auprc_score: 0.9915; val_best_acc_score: 0.9542; val_best_f1_score: 0.9716; train_kl_reg_loss: 10919.6702; train_edge_recon_loss: 107610.5737; train_gene_expr_recon_loss: 2883710.9719; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15031.1842; train_global_loss: 3017272.3876; train_optim_loss: 3017272.3876; val_kl_reg_loss: 10947.9238; val_edge_recon_loss: 108061.5596; val_gene_expr_recon_loss: 2882661.1974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14998.6006; val_global_loss: 3016669.1842; val_optim_loss: 3016669.1842
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9761; val_auprc_score: 0.9916; val_best_acc_score: 0.9577; val_best_f1_score: 0.9737; train_kl_reg_loss: 11012.6838; train_edge_recon_loss: 107728.7000; train_gene_expr_recon_loss: 2883855.8738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14952.9351; train_global_loss: 3017550.1997; train_optim_loss: 3017550.1997; val_kl_reg_loss: 11059.3804; val_edge_recon_loss: 107816.1462; val_gene_expr_recon_loss: 2884926.3860; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14867.8936; val_global_loss: 3018669.9123; val_optim_loss: 3018669.9123

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9751; val_auprc_score: 0.9918; val_best_acc_score: 0.9568; val_best_f1_score: 0.9733; train_kl_reg_loss: 11082.0378; train_edge_recon_loss: 107862.1748; train_gene_expr_recon_loss: 2882768.1538; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14552.1574; train_global_loss: 3016264.5192; train_optim_loss: 3016264.5192; val_kl_reg_loss: 11099.6927; val_edge_recon_loss: 108270.4552; val_gene_expr_recon_loss: 2882396.3377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14505.7695; val_global_loss: 3016272.2237; val_optim_loss: 3016272.2237
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9746; val_auprc_score: 0.9909; val_best_acc_score: 0.9571; val_best_f1_score: 0.9735; train_kl_reg_loss: 11087.5148; train_edge_recon_loss: 107459.2083; train_gene_expr_recon_loss: 2882023.1933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14478.7266; train_global_loss: 3015048.6445; train_optim_loss: 3015048.6445; val_kl_reg_loss: 11108.6536; val_edge_recon_loss: 107034.0858; val_gene_expr_recon_loss: 2882774.4298; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14454.3799; val_global_loss: 3015371.6711; val_optim_loss: 3015371.6711
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9739; val_auprc_score: 0.9907; val_best_acc_score: 0.9565; val_best_f1_score: 0.9730; train_kl_reg_loss: 11116.0150; train_edge_recon_loss: 107938.1763; train_gene_expr_recon_loss: 2882070.7530; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14447.4476; train_global_loss: 3015572.3910; train_optim_loss: 3015572.3910; val_kl_reg_loss: 11124.2581; val_edge_recon_loss: 109554.9996; val_gene_expr_recon_loss: 2882245.6228; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14434.9678; val_global_loss: 3017359.8816; val_optim_loss: 3017359.8816
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9742; val_auprc_score: 0.9908; val_best_acc_score: 0.9565; val_best_f1_score: 0.9729; train_kl_reg_loss: 11129.9030; train_edge_recon_loss: 107958.6074; train_gene_expr_recon_loss: 2882367.9739; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14429.1350; train_global_loss: 3015885.6243; train_optim_loss: 3015885.6243; val_kl_reg_loss: 11149.2945; val_edge_recon_loss: 108589.7841; val_gene_expr_recon_loss: 2882469.7237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14420.5283; val_global_loss: 3016629.2763; val_optim_loss: 3016629.2763
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9766; val_auprc_score: 0.9926; val_best_acc_score: 0.9573; val_best_f1_score: 0.9735; train_kl_reg_loss: 11146.7162; train_edge_recon_loss: 107506.1650; train_gene_expr_recon_loss: 2882172.7747; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14409.6635; train_global_loss: 3015235.3220; train_optim_loss: 3015235.3220; val_kl_reg_loss: 11155.9422; val_edge_recon_loss: 106489.8130; val_gene_expr_recon_loss: 2883497.8991; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14405.5791; val_global_loss: 3015549.1623; val_optim_loss: 3015549.1623
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9755; val_auprc_score: 0.9914; val_best_acc_score: 0.9578; val_best_f1_score: 0.9737; train_kl_reg_loss: 11172.3371; train_edge_recon_loss: 107699.2136; train_gene_expr_recon_loss: 2882471.8023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14387.9139; train_global_loss: 3015731.2687; train_optim_loss: 3015731.2687; val_kl_reg_loss: 11192.0606; val_edge_recon_loss: 108450.7348; val_gene_expr_recon_loss: 2882484.3465; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14382.7480; val_global_loss: 3016509.8816; val_optim_loss: 3016509.8816

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9748; val_auprc_score: 0.9918; val_best_acc_score: 0.9559; val_best_f1_score: 0.9726; train_kl_reg_loss: 11196.9158; train_edge_recon_loss: 106922.0410; train_gene_expr_recon_loss: 2882208.4581; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14349.3118; train_global_loss: 3014676.7253; train_optim_loss: 3014676.7253; val_kl_reg_loss: 11180.8982; val_edge_recon_loss: 109445.3347; val_gene_expr_recon_loss: 2881837.2719; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14341.1172; val_global_loss: 3016804.5175; val_optim_loss: 3016804.5175
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9734; val_auprc_score: 0.9914; val_best_acc_score: 0.9565; val_best_f1_score: 0.9731; train_kl_reg_loss: 11181.4886; train_edge_recon_loss: 107754.9508; train_gene_expr_recon_loss: 2881770.7204; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14337.2156; train_global_loss: 3015044.3718; train_optim_loss: 3015044.3718; val_kl_reg_loss: 11191.6502; val_edge_recon_loss: 108898.0062; val_gene_expr_recon_loss: 2883217.6009; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14334.3447; val_global_loss: 3017641.5088; val_optim_loss: 3017641.5088
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9761; val_auprc_score: 0.9925; val_best_acc_score: 0.9580; val_best_f1_score: 0.9740; train_kl_reg_loss: 11188.5332; train_edge_recon_loss: 107974.4703; train_gene_expr_recon_loss: 2882315.7944; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14331.5750; train_global_loss: 3015810.3713; train_optim_loss: 3015810.3713; val_kl_reg_loss: 11177.4329; val_edge_recon_loss: 106348.0450; val_gene_expr_recon_loss: 2882608.6491; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14330.6035; val_global_loss: 3014464.6184; val_optim_loss: 3014464.6184
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9749; val_auprc_score: 0.9912; val_best_acc_score: 0.9574; val_best_f1_score: 0.9737; train_kl_reg_loss: 11187.7265; train_edge_recon_loss: 108027.1882; train_gene_expr_recon_loss: 2882175.8693; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14328.8156; train_global_loss: 3015719.5996; train_optim_loss: 3015719.5996; val_kl_reg_loss: 11196.2055; val_edge_recon_loss: 107231.1732; val_gene_expr_recon_loss: 2882648.4781; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14327.1016; val_global_loss: 3015402.8553; val_optim_loss: 3015402.8553
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9747; val_auprc_score: 0.9900; val_best_acc_score: 0.9591; val_best_f1_score: 0.9745; train_kl_reg_loss: 11180.5329; train_edge_recon_loss: 106923.7762; train_gene_expr_recon_loss: 2882120.7253; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14325.2179; train_global_loss: 3014550.2599; train_optim_loss: 3014550.2599; val_kl_reg_loss: 11182.5164; val_edge_recon_loss: 109664.6920; val_gene_expr_recon_loss: 2882222.8684; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14323.7422; val_global_loss: 3017393.8509; val_optim_loss: 3017393.8509
Epoch 66/100 |█████████████-------| 66.0% val_auroc_score: 0.9728; val_auprc_score: 0.9905; val_best_acc_score: 0.9569; val_best_f1_score: 0.9733; train_kl_reg_loss: 11183.2511; train_edge_recon_loss: 107644.6693; train_gene_expr_recon_loss: 2881883.5626; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14321.8673; train_global_loss: 3015033.3516; train_optim_loss: 3015033.3516; val_kl_reg_loss: 11154.0099; val_edge_recon_loss: 107462.7377; val_gene_expr_recon_loss: 2881805.6842; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14321.2510; val_global_loss: 3014743.6886; val_optim_loss: 3014743.6886
Epoch 67/100 |█████████████-------| 67.0% val_auroc_score: 0.9766; val_auprc_score: 0.9923; val_best_acc_score: 0.9588; val_best_f1_score: 0.9744; train_kl_reg_loss: 11188.3854; train_edge_recon_loss: 107081.5095; train_gene_expr_recon_loss: 2882344.5128; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14320.1447; train_global_loss: 3014934.5454; train_optim_loss: 3014934.5454; val_kl_reg_loss: 11196.2460; val_edge_recon_loss: 108724.6412; val_gene_expr_recon_loss: 2882449.9912; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14318.7520; val_global_loss: 3016689.6360; val_optim_loss: 3016689.6360

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 68/100 |█████████████-------| 68.0% val_auroc_score: 0.9731; val_auprc_score: 0.9906; val_best_acc_score: 0.9579; val_best_f1_score: 0.9740; train_kl_reg_loss: 11182.5386; train_edge_recon_loss: 106779.7751; train_gene_expr_recon_loss: 2882603.4063; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14315.6526; train_global_loss: 3014881.3674; train_optim_loss: 3014881.3674; val_kl_reg_loss: 11202.8086; val_edge_recon_loss: 107740.3328; val_gene_expr_recon_loss: 2882876.9167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14314.8711; val_global_loss: 3016134.8289; val_optim_loss: 3016134.8289
Epoch 69/100 |█████████████-------| 69.0% val_auroc_score: 0.9736; val_auprc_score: 0.9911; val_best_acc_score: 0.9579; val_best_f1_score: 0.9738; train_kl_reg_loss: 11187.2767; train_edge_recon_loss: 107308.0553; train_gene_expr_recon_loss: 2881907.1824; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14314.5395; train_global_loss: 3014717.0557; train_optim_loss: 3014717.0557; val_kl_reg_loss: 11186.4566; val_edge_recon_loss: 108491.9748; val_gene_expr_recon_loss: 2881845.6974; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14314.1865; val_global_loss: 3015838.3816; val_optim_loss: 3015838.3816
Epoch 70/100 |██████████████------| 70.0% val_auroc_score: 0.9747; val_auprc_score: 0.9918; val_best_acc_score: 0.9573; val_best_f1_score: 0.9736; train_kl_reg_loss: 11184.4683; train_edge_recon_loss: 107806.0748; train_gene_expr_recon_loss: 2881585.8393; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14313.9290; train_global_loss: 3014890.3121; train_optim_loss: 3014890.3121; val_kl_reg_loss: 11175.7707; val_edge_recon_loss: 106960.9546; val_gene_expr_recon_loss: 2882599.3377; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14313.6748; val_global_loss: 3015049.7982; val_optim_loss: 3015049.7982
Epoch 71/100 |██████████████------| 71.0% val_auroc_score: 0.9719; val_auprc_score: 0.9900; val_best_acc_score: 0.9569; val_best_f1_score: 0.9733; train_kl_reg_loss: 11191.6246; train_edge_recon_loss: 107791.4106; train_gene_expr_recon_loss: 2882180.6297; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 14313.4506; train_global_loss: 3015477.1346; train_optim_loss: 3015477.1346; val_kl_reg_loss: 11195.5558; val_edge_recon_loss: 107091.5669; val_gene_expr_recon_loss: 2882255.8289; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 14313.2588; val_global_loss: 3014856.1930; val_optim_loss: 3014856.1930

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 330 min 27 sec.
Using best model state, which was in epoch 63.

--- MODEL EVALUATION ---
val AUROC score: 0.9745
val AUPRC score: 0.9908
val best accuracy score: 0.9550
val best F1 score: 0.9718
val target rna MSE score: 0.9757
val source rna MSE score: 0.4725
Val cat covariate0 mean sim diff: -0.0061

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
