[True]
Run timestamp: 10102023_121817_261.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_261']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2422 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5181, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2422

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7432; val_auprc_score: 0.7728; val_best_acc_score: 0.5710; val_best_f1_score: 0.6915; train_kl_reg_loss: 61853.1052; train_edge_recon_loss: 750969.9785; train_gene_expr_recon_loss: 22342023.9542; train_masked_gp_l1_reg_loss: 44953.1808; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3028772.4771; train_chrom_access_recon_loss: 11187079.6565; train_global_loss: 37415652.3817; train_optim_loss: 37415652.3817; val_kl_reg_loss: 71020.0099; val_edge_recon_loss: 812229.7833; val_gene_expr_recon_loss: 21734014.4000; val_masked_gp_l1_reg_loss: 51809.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1217119.6250; val_chrom_access_recon_loss: 11088694.5333; val_global_loss: 34974889.0667; val_optim_loss: 34974889.0667
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8251; val_auprc_score: 0.8367; val_best_acc_score: 0.7115; val_best_f1_score: 0.7540; train_kl_reg_loss: 68553.0970; train_edge_recon_loss: 734425.2023; train_gene_expr_recon_loss: 20871672.0916; train_masked_gp_l1_reg_loss: 51999.8180; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 660525.0646; train_chrom_access_recon_loss: 10784804.5038; train_global_loss: 33171979.8473; train_optim_loss: 33171979.8473; val_kl_reg_loss: 60660.1680; val_edge_recon_loss: 808525.0667; val_gene_expr_recon_loss: 21171378.4000; val_masked_gp_l1_reg_loss: 52455.5430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 360655.1562; val_chrom_access_recon_loss: 10882032.8000; val_global_loss: 33335708.8000; val_optim_loss: 33335708.8000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8926; val_auprc_score: 0.8844; val_best_acc_score: 0.8061; val_best_f1_score: 0.8224; train_kl_reg_loss: 59992.2102; train_edge_recon_loss: 720112.1651; train_gene_expr_recon_loss: 20569289.8626; train_masked_gp_l1_reg_loss: 53570.2357; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 267771.5636; train_chrom_access_recon_loss: 10651678.0458; train_global_loss: 32322414.0305; train_optim_loss: 32322414.0305; val_kl_reg_loss: 54895.8247; val_edge_recon_loss: 759114.8708; val_gene_expr_recon_loss: 20879672.2667; val_masked_gp_l1_reg_loss: 55200.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 208665.2031; val_chrom_access_recon_loss: 10754340.8667; val_global_loss: 32711889.6000; val_optim_loss: 32711889.6000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.8959; val_auprc_score: 0.8847; val_best_acc_score: 0.8104; val_best_f1_score: 0.8278; train_kl_reg_loss: 62165.8164; train_edge_recon_loss: 661319.7643; train_gene_expr_recon_loss: 20321649.8168; train_masked_gp_l1_reg_loss: 56761.4662; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 180266.3082; train_chrom_access_recon_loss: 10541878.7786; train_global_loss: 31824042.0000; train_optim_loss: 31824042.0000; val_kl_reg_loss: 70045.1531; val_edge_recon_loss: 631884.8625; val_gene_expr_recon_loss: 20718017.4667; val_masked_gp_l1_reg_loss: 58337.7227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 158127.4219; val_chrom_access_recon_loss: 10711275.3333; val_global_loss: 32347688.9333; val_optim_loss: 32347688.9333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9148; val_auprc_score: 0.9026; val_best_acc_score: 0.8294; val_best_f1_score: 0.8407; train_kl_reg_loss: 67916.4740; train_edge_recon_loss: 624269.0219; train_gene_expr_recon_loss: 20115585.4351; train_masked_gp_l1_reg_loss: 59658.0784; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 142858.4291; train_chrom_access_recon_loss: 10437052.7405; train_global_loss: 31447340.0611; train_optim_loss: 31447340.0611; val_kl_reg_loss: 67172.7388; val_edge_recon_loss: 616257.5333; val_gene_expr_recon_loss: 20480135.0667; val_masked_gp_l1_reg_loss: 60599.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 129785.5078; val_chrom_access_recon_loss: 10536940.0667; val_global_loss: 31890891.7333; val_optim_loss: 31890891.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9200; val_auprc_score: 0.9110; val_best_acc_score: 0.8364; val_best_f1_score: 0.8462; train_kl_reg_loss: 65107.0906; train_edge_recon_loss: 614206.1503; train_gene_expr_recon_loss: 19962719.9084; train_masked_gp_l1_reg_loss: 61470.6886; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 121577.2040; train_chrom_access_recon_loss: 10367269.3435; train_global_loss: 31192350.3664; train_optim_loss: 31192350.3664; val_kl_reg_loss: 64437.7359; val_edge_recon_loss: 610342.2875; val_gene_expr_recon_loss: 20426625.0667; val_masked_gp_l1_reg_loss: 62270.1055; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 114731.0234; val_chrom_access_recon_loss: 10522683.6000; val_global_loss: 31801090.9333; val_optim_loss: 31801090.9333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9244; val_auprc_score: 0.9137; val_best_acc_score: 0.8461; val_best_f1_score: 0.8552; train_kl_reg_loss: 63294.0215; train_edge_recon_loss: 607598.0969; train_gene_expr_recon_loss: 19835542.0153; train_masked_gp_l1_reg_loss: 62893.3599; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 109709.7609; train_chrom_access_recon_loss: 10294294.6260; train_global_loss: 30973331.9237; train_optim_loss: 30973331.9237; val_kl_reg_loss: 62228.6237; val_edge_recon_loss: 610515.5375; val_gene_expr_recon_loss: 20219060.0000; val_masked_gp_l1_reg_loss: 63494.9102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106262.1094; val_chrom_access_recon_loss: 10446450.0000; val_global_loss: 31508010.0000; val_optim_loss: 31508010.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9306; val_auprc_score: 0.9186; val_best_acc_score: 0.8558; val_best_f1_score: 0.8628; train_kl_reg_loss: 61175.1843; train_edge_recon_loss: 601016.8936; train_gene_expr_recon_loss: 19700664.1527; train_masked_gp_l1_reg_loss: 64063.6273; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102666.7835; train_chrom_access_recon_loss: 10228379.2519; train_global_loss: 30757965.7710; train_optim_loss: 30757965.7710; val_kl_reg_loss: 59953.8792; val_edge_recon_loss: 596590.6042; val_gene_expr_recon_loss: 20102143.6000; val_masked_gp_l1_reg_loss: 64705.2695; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 100867.2344; val_chrom_access_recon_loss: 10390619.6000; val_global_loss: 31314881.6000; val_optim_loss: 31314881.6000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9389; val_auprc_score: 0.9272; val_best_acc_score: 0.8728; val_best_f1_score: 0.8778; train_kl_reg_loss: 60024.1489; train_edge_recon_loss: 595607.0215; train_gene_expr_recon_loss: 19586126.5802; train_masked_gp_l1_reg_loss: 65134.7440; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 98983.1917; train_chrom_access_recon_loss: 10170804.0992; train_global_loss: 30576679.7557; train_optim_loss: 30576679.7557; val_kl_reg_loss: 57903.3799; val_edge_recon_loss: 594465.7667; val_gene_expr_recon_loss: 19969215.3333; val_masked_gp_l1_reg_loss: 65578.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97538.0000; val_chrom_access_recon_loss: 10286661.6667; val_global_loss: 31071362.4000; val_optim_loss: 31071362.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9454; val_auprc_score: 0.9318; val_best_acc_score: 0.8806; val_best_f1_score: 0.8843; train_kl_reg_loss: 58641.8202; train_edge_recon_loss: 593080.7867; train_gene_expr_recon_loss: 19496142.5954; train_masked_gp_l1_reg_loss: 66004.3048; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96805.3003; train_chrom_access_recon_loss: 10125206.7557; train_global_loss: 30435881.5573; train_optim_loss: 30435881.5573; val_kl_reg_loss: 58511.1482; val_edge_recon_loss: 594536.2625; val_gene_expr_recon_loss: 19879448.6667; val_masked_gp_l1_reg_loss: 66508.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95774.5156; val_chrom_access_recon_loss: 10198832.2000; val_global_loss: 30893610.5333; val_optim_loss: 30893610.5333
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9506; val_auprc_score: 0.9428; val_best_acc_score: 0.8824; val_best_f1_score: 0.8864; train_kl_reg_loss: 57858.1041; train_edge_recon_loss: 589453.9685; train_gene_expr_recon_loss: 19405507.4046; train_masked_gp_l1_reg_loss: 66744.9646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94679.8480; train_chrom_access_recon_loss: 10068992.6336; train_global_loss: 30283237.0840; train_optim_loss: 30283237.0840; val_kl_reg_loss: 58261.4602; val_edge_recon_loss: 592613.3000; val_gene_expr_recon_loss: 19794632.9333; val_masked_gp_l1_reg_loss: 67157.8438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 94714.8359; val_chrom_access_recon_loss: 10224118.0667; val_global_loss: 30831498.0000; val_optim_loss: 30831498.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9554; val_auprc_score: 0.9467; val_best_acc_score: 0.8933; val_best_f1_score: 0.8967; train_kl_reg_loss: 57244.4239; train_edge_recon_loss: 586695.4561; train_gene_expr_recon_loss: 19329981.3130; train_masked_gp_l1_reg_loss: 67362.7186; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93169.5108; train_chrom_access_recon_loss: 10024182.7176; train_global_loss: 30158636.3053; train_optim_loss: 30158636.3053; val_kl_reg_loss: 56864.7094; val_edge_recon_loss: 581960.9833; val_gene_expr_recon_loss: 19726799.2000; val_masked_gp_l1_reg_loss: 67678.3359; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91825.7266; val_chrom_access_recon_loss: 10193546.9333; val_global_loss: 30718675.7333; val_optim_loss: 30718675.7333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9564; val_auprc_score: 0.9475; val_best_acc_score: 0.8979; val_best_f1_score: 0.9006; train_kl_reg_loss: 56622.3560; train_edge_recon_loss: 583954.0568; train_gene_expr_recon_loss: 19243181.6031; train_masked_gp_l1_reg_loss: 67930.0690; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90745.5024; train_chrom_access_recon_loss: 9967795.2519; train_global_loss: 30010228.8244; train_optim_loss: 30010228.8244; val_kl_reg_loss: 56999.3802; val_edge_recon_loss: 583131.2667; val_gene_expr_recon_loss: 19727910.2667; val_masked_gp_l1_reg_loss: 68331.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90640.5469; val_chrom_access_recon_loss: 10186497.4000; val_global_loss: 30713510.2667; val_optim_loss: 30713510.2667
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9545; val_auprc_score: 0.9426; val_best_acc_score: 0.8953; val_best_f1_score: 0.8994; train_kl_reg_loss: 55744.8816; train_edge_recon_loss: 582557.6107; train_gene_expr_recon_loss: 19177804.1374; train_masked_gp_l1_reg_loss: 68530.3850; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89206.6873; train_chrom_access_recon_loss: 9936036.9924; train_global_loss: 29909880.5954; train_optim_loss: 29909880.5954; val_kl_reg_loss: 55708.7034; val_edge_recon_loss: 583324.4792; val_gene_expr_recon_loss: 19569122.2667; val_masked_gp_l1_reg_loss: 68894.6562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88315.2891; val_chrom_access_recon_loss: 10049635.9333; val_global_loss: 30415001.3333; val_optim_loss: 30415001.3333
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9593; val_auprc_score: 0.9529; val_best_acc_score: 0.8953; val_best_f1_score: 0.8998; train_kl_reg_loss: 55281.8494; train_edge_recon_loss: 580191.9275; train_gene_expr_recon_loss: 19113624.9466; train_masked_gp_l1_reg_loss: 69118.0958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87535.5146; train_chrom_access_recon_loss: 9889843.8092; train_global_loss: 29795596.3664; train_optim_loss: 29795596.3664; val_kl_reg_loss: 55487.2008; val_edge_recon_loss: 582458.6792; val_gene_expr_recon_loss: 19539838.4000; val_masked_gp_l1_reg_loss: 69316.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87531.4609; val_chrom_access_recon_loss: 10071940.8000; val_global_loss: 30406573.2000; val_optim_loss: 30406573.2000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9597; val_auprc_score: 0.9506; val_best_acc_score: 0.8989; val_best_f1_score: 0.9025; train_kl_reg_loss: 54464.7888; train_edge_recon_loss: 578268.5568; train_gene_expr_recon_loss: 19064679.7252; train_masked_gp_l1_reg_loss: 69610.8628; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86531.9840; train_chrom_access_recon_loss: 9862761.2137; train_global_loss: 29716317.0992; train_optim_loss: 29716317.0992; val_kl_reg_loss: 53812.1466; val_edge_recon_loss: 580962.1167; val_gene_expr_recon_loss: 19452762.8000; val_masked_gp_l1_reg_loss: 70025.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86466.8906; val_chrom_access_recon_loss: 9971956.7333; val_global_loss: 30215986.1333; val_optim_loss: 30215986.1333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9618; val_auprc_score: 0.9534; val_best_acc_score: 0.9054; val_best_f1_score: 0.9084; train_kl_reg_loss: 53963.8062; train_edge_recon_loss: 577436.0095; train_gene_expr_recon_loss: 19021847.9084; train_masked_gp_l1_reg_loss: 70161.2167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85847.6559; train_chrom_access_recon_loss: 9823228.0687; train_global_loss: 29632484.6412; train_optim_loss: 29632484.6412; val_kl_reg_loss: 53270.6570; val_edge_recon_loss: 581972.6208; val_gene_expr_recon_loss: 19468598.2667; val_masked_gp_l1_reg_loss: 70531.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85370.0469; val_chrom_access_recon_loss: 9984986.6667; val_global_loss: 30244730.4000; val_optim_loss: 30244730.4000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9637; val_auprc_score: 0.9562; val_best_acc_score: 0.9065; val_best_f1_score: 0.9099; train_kl_reg_loss: 53569.8121; train_edge_recon_loss: 575228.3898; train_gene_expr_recon_loss: 18959352.1374; train_masked_gp_l1_reg_loss: 70700.7208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85007.7956; train_chrom_access_recon_loss: 9783736.5191; train_global_loss: 29527595.4809; train_optim_loss: 29527595.4809; val_kl_reg_loss: 53894.7669; val_edge_recon_loss: 580263.6875; val_gene_expr_recon_loss: 19340952.8000; val_masked_gp_l1_reg_loss: 70900.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85258.6641; val_chrom_access_recon_loss: 9951981.7333; val_global_loss: 30083251.0667; val_optim_loss: 30083251.0667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9675; val_auprc_score: 0.9619; val_best_acc_score: 0.9105; val_best_f1_score: 0.9132; train_kl_reg_loss: 52871.9963; train_edge_recon_loss: 574703.4971; train_gene_expr_recon_loss: 18908215.5573; train_masked_gp_l1_reg_loss: 71225.6832; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84840.8823; train_chrom_access_recon_loss: 9745048.2595; train_global_loss: 29436905.8168; train_optim_loss: 29436905.8168; val_kl_reg_loss: 54406.3385; val_edge_recon_loss: 578271.9917; val_gene_expr_recon_loss: 19388346.8000; val_masked_gp_l1_reg_loss: 71590.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84679.3281; val_chrom_access_recon_loss: 9913253.3333; val_global_loss: 30090548.1333; val_optim_loss: 30090548.1333
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9671; val_auprc_score: 0.9601; val_best_acc_score: 0.9154; val_best_f1_score: 0.9181; train_kl_reg_loss: 52444.9885; train_edge_recon_loss: 574728.7338; train_gene_expr_recon_loss: 18870578.9466; train_masked_gp_l1_reg_loss: 71757.1193; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84772.4874; train_chrom_access_recon_loss: 9713486.7863; train_global_loss: 29367769.0076; train_optim_loss: 29367769.0076; val_kl_reg_loss: 52569.4602; val_edge_recon_loss: 569972.5292; val_gene_expr_recon_loss: 19201273.2000; val_masked_gp_l1_reg_loss: 72025.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83960.4688; val_chrom_access_recon_loss: 9829737.9333; val_global_loss: 29809539.0667; val_optim_loss: 29809539.0667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9689; val_auprc_score: 0.9644; val_best_acc_score: 0.9148; val_best_f1_score: 0.9177; train_kl_reg_loss: 52112.0074; train_edge_recon_loss: 574895.9470; train_gene_expr_recon_loss: 18827347.3588; train_masked_gp_l1_reg_loss: 72265.1734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84554.0990; train_chrom_access_recon_loss: 9676014.0840; train_global_loss: 29287188.6260; train_optim_loss: 29287188.6260; val_kl_reg_loss: 51578.9977; val_edge_recon_loss: 576712.6250; val_gene_expr_recon_loss: 19276357.3333; val_masked_gp_l1_reg_loss: 72515.4141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84580.6250; val_chrom_access_recon_loss: 9849684.1333; val_global_loss: 29911429.0667; val_optim_loss: 29911429.0667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9667; val_auprc_score: 0.9610; val_best_acc_score: 0.9134; val_best_f1_score: 0.9163; train_kl_reg_loss: 51798.9785; train_edge_recon_loss: 573326.8063; train_gene_expr_recon_loss: 18797576.0153; train_masked_gp_l1_reg_loss: 72745.8359; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84675.9580; train_chrom_access_recon_loss: 9650344.0840; train_global_loss: 29230467.5573; train_optim_loss: 29230467.5573; val_kl_reg_loss: 51968.7625; val_edge_recon_loss: 576338.3750; val_gene_expr_recon_loss: 19275171.6000; val_masked_gp_l1_reg_loss: 73055.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85086.2656; val_chrom_access_recon_loss: 9851711.4667; val_global_loss: 29913332.5333; val_optim_loss: 29913332.5333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9661; val_auprc_score: 0.9584; val_best_acc_score: 0.9140; val_best_f1_score: 0.9165; train_kl_reg_loss: 51487.3968; train_edge_recon_loss: 571449.8268; train_gene_expr_recon_loss: 18772812.4122; train_masked_gp_l1_reg_loss: 73275.1506; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85185.3305; train_chrom_access_recon_loss: 9632199.9389; train_global_loss: 29186410.0458; train_optim_loss: 29186410.0458; val_kl_reg_loss: 51498.6562; val_edge_recon_loss: 576269.3042; val_gene_expr_recon_loss: 19238091.3333; val_masked_gp_l1_reg_loss: 73584.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85070.1016; val_chrom_access_recon_loss: 9819909.6000; val_global_loss: 29844423.2000; val_optim_loss: 29844423.2000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9714; val_auprc_score: 0.9656; val_best_acc_score: 0.9181; val_best_f1_score: 0.9201; train_kl_reg_loss: 51213.4209; train_edge_recon_loss: 572030.9881; train_gene_expr_recon_loss: 18733389.2061; train_masked_gp_l1_reg_loss: 73846.8636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85476.4077; train_chrom_access_recon_loss: 9598151.9695; train_global_loss: 29114108.7481; train_optim_loss: 29114108.7481; val_kl_reg_loss: 51952.6120; val_edge_recon_loss: 577174.8208; val_gene_expr_recon_loss: 19225119.2000; val_masked_gp_l1_reg_loss: 74148.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85524.8281; val_chrom_access_recon_loss: 9806840.2667; val_global_loss: 29820759.0667; val_optim_loss: 29820759.0667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9719; val_auprc_score: 0.9655; val_best_acc_score: 0.9196; val_best_f1_score: 0.9225; train_kl_reg_loss: 51275.7931; train_edge_recon_loss: 570368.1741; train_gene_expr_recon_loss: 18685528.9313; train_masked_gp_l1_reg_loss: 73232.9405; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65875.2530; train_chrom_access_recon_loss: 9558133.5496; train_global_loss: 29004414.6870; train_optim_loss: 29004414.6870; val_kl_reg_loss: 52174.3956; val_edge_recon_loss: 570780.2583; val_gene_expr_recon_loss: 19212047.7333; val_masked_gp_l1_reg_loss: 72826.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62683.4922; val_chrom_access_recon_loss: 9810542.4667; val_global_loss: 29781054.9333; val_optim_loss: 29781054.9333
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9667; val_auprc_score: 0.9627; val_best_acc_score: 0.9073; val_best_f1_score: 0.9100; train_kl_reg_loss: 52165.3068; train_edge_recon_loss: 662161.0463; train_gene_expr_recon_loss: 17573477.6794; train_masked_gp_l1_reg_loss: 72774.1098; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60266.0907; train_chrom_access_recon_loss: 9257500.8855; train_global_loss: 27678345.2366; train_optim_loss: 27678345.2366; val_kl_reg_loss: 19758.1569; val_edge_recon_loss: 660145.6208; val_gene_expr_recon_loss: 18056039.9333; val_masked_gp_l1_reg_loss: 72764.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 59293.1953; val_chrom_access_recon_loss: 9399553.2000; val_global_loss: 28267554.9333; val_optim_loss: 28267554.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9586; val_auprc_score: 0.9537; val_best_acc_score: 0.8928; val_best_f1_score: 0.8962; train_kl_reg_loss: 51311.9668; train_edge_recon_loss: 649311.5110; train_gene_expr_recon_loss: 17545830.7939; train_masked_gp_l1_reg_loss: 72690.2610; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58944.3985; train_chrom_access_recon_loss: 9177697.8321; train_global_loss: 27555786.8702; train_optim_loss: 27555786.8702; val_kl_reg_loss: 19459.3167; val_edge_recon_loss: 650809.6333; val_gene_expr_recon_loss: 18000820.5333; val_masked_gp_l1_reg_loss: 72616.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58611.1172; val_chrom_access_recon_loss: 9381863.0000; val_global_loss: 28184180.5333; val_optim_loss: 28184180.5333
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9620; val_auprc_score: 0.9575; val_best_acc_score: 0.8995; val_best_f1_score: 0.9020; train_kl_reg_loss: 50150.8778; train_edge_recon_loss: 640579.0802; train_gene_expr_recon_loss: 17532417.6641; train_masked_gp_l1_reg_loss: 72530.0574; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58379.0147; train_chrom_access_recon_loss: 9172704.9008; train_global_loss: 27526761.6336; train_optim_loss: 27526761.6336; val_kl_reg_loss: 20044.3171; val_edge_recon_loss: 641977.8167; val_gene_expr_recon_loss: 17986964.5333; val_masked_gp_l1_reg_loss: 72410.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58016.9023; val_chrom_access_recon_loss: 9288157.2000; val_global_loss: 28067569.8667; val_optim_loss: 28067569.8667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9597; val_auprc_score: 0.9554; val_best_acc_score: 0.8922; val_best_f1_score: 0.8951; train_kl_reg_loss: 48962.6955; train_edge_recon_loss: 630459.4647; train_gene_expr_recon_loss: 17520061.5115; train_masked_gp_l1_reg_loss: 72300.1369; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57814.4257; train_chrom_access_recon_loss: 9163539.8244; train_global_loss: 27493137.8931; train_optim_loss: 27493137.8931; val_kl_reg_loss: 20819.6973; val_edge_recon_loss: 629168.9958; val_gene_expr_recon_loss: 17928445.2000; val_masked_gp_l1_reg_loss: 72176.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57530.6367; val_chrom_access_recon_loss: 9318327.8000; val_global_loss: 28026467.8667; val_optim_loss: 28026467.8667
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9588; val_auprc_score: 0.9540; val_best_acc_score: 0.8960; val_best_f1_score: 0.8984; train_kl_reg_loss: 48067.7547; train_edge_recon_loss: 620606.3760; train_gene_expr_recon_loss: 17523070.4275; train_masked_gp_l1_reg_loss: 72045.6840; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57273.0029; train_chrom_access_recon_loss: 9166437.7939; train_global_loss: 27487501.0382; train_optim_loss: 27487501.0382; val_kl_reg_loss: 22164.0186; val_edge_recon_loss: 621262.5542; val_gene_expr_recon_loss: 18030726.8000; val_masked_gp_l1_reg_loss: 71909.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57063.3359; val_chrom_access_recon_loss: 9382292.4667; val_global_loss: 28185419.7333; val_optim_loss: 28185419.7333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9579; val_auprc_score: 0.9534; val_best_acc_score: 0.8928; val_best_f1_score: 0.8964; train_kl_reg_loss: 46955.6160; train_edge_recon_loss: 613894.9633; train_gene_expr_recon_loss: 17503216.9771; train_masked_gp_l1_reg_loss: 71746.6955; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56795.6540; train_chrom_access_recon_loss: 9150383.2137; train_global_loss: 27442993.1298; train_optim_loss: 27442993.1298; val_kl_reg_loss: 23891.8885; val_edge_recon_loss: 612872.8125; val_gene_expr_recon_loss: 17950087.2000; val_masked_gp_l1_reg_loss: 71586.2656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56597.2500; val_chrom_access_recon_loss: 9315719.8000; val_global_loss: 28030755.6000; val_optim_loss: 28030755.6000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9558; val_auprc_score: 0.9509; val_best_acc_score: 0.8882; val_best_f1_score: 0.8918; train_kl_reg_loss: 46068.7246; train_edge_recon_loss: 605911.5573; train_gene_expr_recon_loss: 17495403.7099; train_masked_gp_l1_reg_loss: 71417.0065; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56349.0306; train_chrom_access_recon_loss: 9136686.7443; train_global_loss: 27411836.6870; train_optim_loss: 27411836.6870; val_kl_reg_loss: 25439.5691; val_edge_recon_loss: 605452.4792; val_gene_expr_recon_loss: 18006003.8667; val_masked_gp_l1_reg_loss: 71248.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56110.0898; val_chrom_access_recon_loss: 9337323.9333; val_global_loss: 28101577.6000; val_optim_loss: 28101577.6000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9550; val_auprc_score: 0.9478; val_best_acc_score: 0.8902; val_best_f1_score: 0.8932; train_kl_reg_loss: 45384.4028; train_edge_recon_loss: 602284.7910; train_gene_expr_recon_loss: 17504003.4962; train_masked_gp_l1_reg_loss: 71075.0554; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55897.2817; train_chrom_access_recon_loss: 9148108.5725; train_global_loss: 27426753.7252; train_optim_loss: 27426753.7252; val_kl_reg_loss: 26979.8043; val_edge_recon_loss: 601488.7750; val_gene_expr_recon_loss: 17926622.8000; val_masked_gp_l1_reg_loss: 70897.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55689.6602; val_chrom_access_recon_loss: 9286352.2667; val_global_loss: 27968031.7333; val_optim_loss: 27968031.7333
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9538; val_auprc_score: 0.9460; val_best_acc_score: 0.8859; val_best_f1_score: 0.8905; train_kl_reg_loss: 44827.5120; train_edge_recon_loss: 597561.1842; train_gene_expr_recon_loss: 17482694.4198; train_masked_gp_l1_reg_loss: 70718.4906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55477.6081; train_chrom_access_recon_loss: 9138365.6145; train_global_loss: 27389644.9160; train_optim_loss: 27389644.9160; val_kl_reg_loss: 28471.3400; val_edge_recon_loss: 595147.7417; val_gene_expr_recon_loss: 17916030.0000; val_masked_gp_l1_reg_loss: 70523.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55255.3984; val_chrom_access_recon_loss: 9307596.6667; val_global_loss: 27973025.8667; val_optim_loss: 27973025.8667
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9565; val_auprc_score: 0.9520; val_best_acc_score: 0.8911; val_best_f1_score: 0.8942; train_kl_reg_loss: 44525.4203; train_edge_recon_loss: 593308.8244; train_gene_expr_recon_loss: 17484237.1298; train_masked_gp_l1_reg_loss: 70340.1410; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55102.5691; train_chrom_access_recon_loss: 9144758.3473; train_global_loss: 27392272.4580; train_optim_loss: 27392272.4580; val_kl_reg_loss: 30020.7193; val_edge_recon_loss: 592478.2625; val_gene_expr_recon_loss: 17951057.7333; val_masked_gp_l1_reg_loss: 70155.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54846.2422; val_chrom_access_recon_loss: 9293830.8000; val_global_loss: 27992389.6000; val_optim_loss: 27992389.6000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9513; val_auprc_score: 0.9417; val_best_acc_score: 0.8836; val_best_f1_score: 0.8879; train_kl_reg_loss: 44344.6475; train_edge_recon_loss: 589616.7691; train_gene_expr_recon_loss: 17473782.3053; train_masked_gp_l1_reg_loss: 69979.1242; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54656.7739; train_chrom_access_recon_loss: 9133336.7137; train_global_loss: 27365716.3053; train_optim_loss: 27365716.3053; val_kl_reg_loss: 31114.2052; val_edge_recon_loss: 595542.7000; val_gene_expr_recon_loss: 17838537.8000; val_masked_gp_l1_reg_loss: 69799.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54465.5625; val_chrom_access_recon_loss: 9234632.4000; val_global_loss: 27824093.4667; val_optim_loss: 27824093.4667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9551; val_auprc_score: 0.9467; val_best_acc_score: 0.8921; val_best_f1_score: 0.8949; train_kl_reg_loss: 44009.6860; train_edge_recon_loss: 588444.5573; train_gene_expr_recon_loss: 17482910.1756; train_masked_gp_l1_reg_loss: 69631.5824; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54276.5733; train_chrom_access_recon_loss: 9148595.1832; train_global_loss: 27387867.7099; train_optim_loss: 27387867.7099; val_kl_reg_loss: 32394.2652; val_edge_recon_loss: 587354.3000; val_gene_expr_recon_loss: 17995564.0000; val_masked_gp_l1_reg_loss: 69439.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54073.8516; val_chrom_access_recon_loss: 9340053.6000; val_global_loss: 28078879.8667; val_optim_loss: 28078879.8667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9528; val_auprc_score: 0.9447; val_best_acc_score: 0.8861; val_best_f1_score: 0.8895; train_kl_reg_loss: 43953.4115; train_edge_recon_loss: 584098.8826; train_gene_expr_recon_loss: 17457171.1450; train_masked_gp_l1_reg_loss: 69277.3096; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53888.3935; train_chrom_access_recon_loss: 9123818.7176; train_global_loss: 27332207.9389; train_optim_loss: 27332207.9389; val_kl_reg_loss: 33165.2017; val_edge_recon_loss: 589003.5625; val_gene_expr_recon_loss: 17886831.8667; val_masked_gp_l1_reg_loss: 69097.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53694.3242; val_chrom_access_recon_loss: 9305737.0000; val_global_loss: 27937529.6000; val_optim_loss: 27937529.6000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9567; val_auprc_score: 0.9507; val_best_acc_score: 0.8907; val_best_f1_score: 0.8938; train_kl_reg_loss: 43891.8093; train_edge_recon_loss: 582903.0930; train_gene_expr_recon_loss: 17464790.8855; train_masked_gp_l1_reg_loss: 68936.0939; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53523.1646; train_chrom_access_recon_loss: 9129985.6489; train_global_loss: 27344030.5496; train_optim_loss: 27344030.5496; val_kl_reg_loss: 34352.5931; val_edge_recon_loss: 584793.0125; val_gene_expr_recon_loss: 17952021.2000; val_masked_gp_l1_reg_loss: 68776.6484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53349.1133; val_chrom_access_recon_loss: 9328732.6667; val_global_loss: 28022025.3333; val_optim_loss: 28022025.3333
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9563; val_auprc_score: 0.9493; val_best_acc_score: 0.8926; val_best_f1_score: 0.8947; train_kl_reg_loss: 43915.0952; train_edge_recon_loss: 581735.2510; train_gene_expr_recon_loss: 17465027.6489; train_masked_gp_l1_reg_loss: 68627.1882; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53173.1157; train_chrom_access_recon_loss: 9132389.8092; train_global_loss: 27344867.9847; train_optim_loss: 27344867.9847; val_kl_reg_loss: 35084.1979; val_edge_recon_loss: 584668.0625; val_gene_expr_recon_loss: 17898277.3333; val_masked_gp_l1_reg_loss: 68455.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52971.3242; val_chrom_access_recon_loss: 9269165.8000; val_global_loss: 27908623.6000; val_optim_loss: 27908623.6000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9579; val_auprc_score: 0.9512; val_best_acc_score: 0.8954; val_best_f1_score: 0.9002; train_kl_reg_loss: 43899.4206; train_edge_recon_loss: 580434.4437; train_gene_expr_recon_loss: 17456767.3511; train_masked_gp_l1_reg_loss: 68395.0325; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51906.9822; train_chrom_access_recon_loss: 9125373.3931; train_global_loss: 27326776.6718; train_optim_loss: 27326776.6718; val_kl_reg_loss: 35407.4859; val_edge_recon_loss: 582148.0458; val_gene_expr_recon_loss: 17937323.8667; val_masked_gp_l1_reg_loss: 68353.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51748.5703; val_chrom_access_recon_loss: 9324629.2667; val_global_loss: 27999610.9333; val_optim_loss: 27999610.9333
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9586; val_auprc_score: 0.9504; val_best_acc_score: 0.8969; val_best_f1_score: 0.8994; train_kl_reg_loss: 43850.6897; train_edge_recon_loss: 579887.4442; train_gene_expr_recon_loss: 17437665.4275; train_masked_gp_l1_reg_loss: 68327.4619; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51704.1869; train_chrom_access_recon_loss: 9108232.5000; train_global_loss: 27289667.7863; train_optim_loss: 27289667.7863; val_kl_reg_loss: 35269.5083; val_edge_recon_loss: 580839.1542; val_gene_expr_recon_loss: 17947376.2667; val_masked_gp_l1_reg_loss: 68302.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51653.9961; val_chrom_access_recon_loss: 9268991.6000; val_global_loss: 27952432.6667; val_optim_loss: 27952432.6667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9542; val_auprc_score: 0.9445; val_best_acc_score: 0.8898; val_best_f1_score: 0.8932; train_kl_reg_loss: 43846.6572; train_edge_recon_loss: 580560.2190; train_gene_expr_recon_loss: 17449071.1603; train_masked_gp_l1_reg_loss: 68280.0200; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51616.7193; train_chrom_access_recon_loss: 9120196.6412; train_global_loss: 27313571.5878; train_optim_loss: 27313571.5878; val_kl_reg_loss: 35320.6990; val_edge_recon_loss: 582072.6833; val_gene_expr_recon_loss: 17879393.3333; val_masked_gp_l1_reg_loss: 68259.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51580.8984; val_chrom_access_recon_loss: 9282646.7333; val_global_loss: 27899273.2000; val_optim_loss: 27899273.2000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9528; val_auprc_score: 0.9438; val_best_acc_score: 0.8875; val_best_f1_score: 0.8907; train_kl_reg_loss: 43910.0689; train_edge_recon_loss: 581608.5525; train_gene_expr_recon_loss: 17454072.8244; train_masked_gp_l1_reg_loss: 68239.7985; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51546.2811; train_chrom_access_recon_loss: 9125407.4275; train_global_loss: 27324784.9313; train_optim_loss: 27324784.9313; val_kl_reg_loss: 35344.7685; val_edge_recon_loss: 586160.4167; val_gene_expr_recon_loss: 17923596.6667; val_masked_gp_l1_reg_loss: 68218.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51516.8789; val_chrom_access_recon_loss: 9299879.4667; val_global_loss: 27964715.2000; val_optim_loss: 27964715.2000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 31 min 51 sec.
Using best model state, which was in epoch 36.

--- MODEL EVALUATION ---
val AUROC score: 0.9555
val AUPRC score: 0.9490
val best accuracy score: 0.8888
val best F1 score: 0.8917
val target rna MSE score: 1.5133
val source rna MSE score: 0.6831
val target atac MSE score: 0.3450
val source atac MSE score: 0.1065
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
