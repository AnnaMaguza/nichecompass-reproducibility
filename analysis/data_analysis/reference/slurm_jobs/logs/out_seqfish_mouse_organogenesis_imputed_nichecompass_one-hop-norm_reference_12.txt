[True]
Run timestamp: 07082024_105223_12.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_omnipath_gps', '--no-include_nichenet_gps', '--no-include_mebocost_gps', '--no-include_collectri_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--seed', '0', '--timestamp_suffix', '_12']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1042.
Number of gene programs after filtering and combining: 1004.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 752, n_latent: 652, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 652, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 652, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 214020
Number of validation edges: 23779
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8886; val_auprc_score: 0.9768; val_best_acc_score: 0.8909; val_best_f1_score: 0.9390; train_kl_reg_loss: 63949.8392; train_edge_recon_loss: 980023.3838; train_gene_expr_recon_loss: 43307520.8554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44351494.1601; train_optim_loss: 44351494.1601; val_kl_reg_loss: 42081.9242; val_edge_recon_loss: 899440.6163; val_gene_expr_recon_loss: 39275402.6237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 40216925.2043; val_optim_loss: 40216925.2043
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9188; val_auprc_score: 0.9830; val_best_acc_score: 0.9172; val_best_f1_score: 0.9527; train_kl_reg_loss: 38375.1005; train_edge_recon_loss: 851670.9804; train_gene_expr_recon_loss: 37345802.1171; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 38235848.1912; train_optim_loss: 38235848.1912; val_kl_reg_loss: 36322.7867; val_edge_recon_loss: 836005.1882; val_gene_expr_recon_loss: 35760097.6774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 36632425.5914; val_optim_loss: 36632425.5914
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9344; val_auprc_score: 0.9851; val_best_acc_score: 0.9274; val_best_f1_score: 0.9583; train_kl_reg_loss: 31992.2031; train_edge_recon_loss: 824722.4744; train_gene_expr_recon_loss: 34498400.7981; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 35355115.3787; train_optim_loss: 35355115.3787; val_kl_reg_loss: 28912.1120; val_edge_recon_loss: 829972.0585; val_gene_expr_recon_loss: 33432799.9140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 34291684.1290; val_optim_loss: 34291684.1290
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9509; val_auprc_score: 0.9892; val_best_acc_score: 0.9403; val_best_f1_score: 0.9655; train_kl_reg_loss: 26966.2795; train_edge_recon_loss: 809635.3822; train_gene_expr_recon_loss: 32618664.9534; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 33455266.6476; train_optim_loss: 33455266.6476; val_kl_reg_loss: 24969.8068; val_edge_recon_loss: 818345.1384; val_gene_expr_recon_loss: 31899121.3763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32742436.3226; val_optim_loss: 32742436.3226
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9552; val_auprc_score: 0.9900; val_best_acc_score: 0.9434; val_best_f1_score: 0.9673; train_kl_reg_loss: 23321.1601; train_edge_recon_loss: 800256.0211; train_gene_expr_recon_loss: 31359869.2855; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32183446.4803; train_optim_loss: 32183446.4803; val_kl_reg_loss: 21616.6780; val_edge_recon_loss: 820566.6848; val_gene_expr_recon_loss: 30910001.1613; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31752184.4516; val_optim_loss: 31752184.4516
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9575; val_auprc_score: 0.9903; val_best_acc_score: 0.9476; val_best_f1_score: 0.9697; train_kl_reg_loss: 20507.4363; train_edge_recon_loss: 790091.0727; train_gene_expr_recon_loss: 30521551.2569; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31332149.7873; train_optim_loss: 31332149.7873; val_kl_reg_loss: 20204.3611; val_edge_recon_loss: 787383.4147; val_gene_expr_recon_loss: 30256214.1935; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31063801.9140; val_optim_loss: 31063801.9140
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9631; val_auprc_score: 0.9920; val_best_acc_score: 0.9532; val_best_f1_score: 0.9730; train_kl_reg_loss: 18249.4366; train_edge_recon_loss: 788593.2499; train_gene_expr_recon_loss: 29957362.8220; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30764205.5054; train_optim_loss: 30764205.5054; val_kl_reg_loss: 17080.5153; val_edge_recon_loss: 785327.4919; val_gene_expr_recon_loss: 29818017.6774; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30620425.6989; val_optim_loss: 30620425.6989
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9653; val_auprc_score: 0.9924; val_best_acc_score: 0.9536; val_best_f1_score: 0.9731; train_kl_reg_loss: 16230.6699; train_edge_recon_loss: 779616.8554; train_gene_expr_recon_loss: 29590168.4540; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30386015.9761; train_optim_loss: 30386015.9761; val_kl_reg_loss: 15531.4096; val_edge_recon_loss: 790227.2809; val_gene_expr_recon_loss: 29484587.0968; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30290345.9140; val_optim_loss: 30290345.9140
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9662; val_auprc_score: 0.9916; val_best_acc_score: 0.9563; val_best_f1_score: 0.9747; train_kl_reg_loss: 14760.5826; train_edge_recon_loss: 787746.9011; train_gene_expr_recon_loss: 29340708.5400; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30143216.0263; train_optim_loss: 30143216.0263; val_kl_reg_loss: 14382.3268; val_edge_recon_loss: 784450.5605; val_gene_expr_recon_loss: 29229739.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30028572.5806; val_optim_loss: 30028572.5806
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9650; val_auprc_score: 0.9914; val_best_acc_score: 0.9567; val_best_f1_score: 0.9748; train_kl_reg_loss: 13701.2811; train_edge_recon_loss: 775226.1452; train_gene_expr_recon_loss: 29177462.8005; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29966390.2843; train_optim_loss: 29966390.2843; val_kl_reg_loss: 13228.0865; val_edge_recon_loss: 791121.1405; val_gene_expr_recon_loss: 29096785.2688; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29901134.6452; val_optim_loss: 29901134.6452
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9680; val_auprc_score: 0.9922; val_best_acc_score: 0.9597; val_best_f1_score: 0.9765; train_kl_reg_loss: 12948.7231; train_edge_recon_loss: 770233.5130; train_gene_expr_recon_loss: 29060436.1266; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29843618.3656; train_optim_loss: 29843618.3656; val_kl_reg_loss: 12492.4764; val_edge_recon_loss: 800006.8011; val_gene_expr_recon_loss: 29014032.0430; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29826531.3118; val_optim_loss: 29826531.3118
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9702; val_auprc_score: 0.9931; val_best_acc_score: 0.9584; val_best_f1_score: 0.9758; train_kl_reg_loss: 12269.0795; train_edge_recon_loss: 774337.9946; train_gene_expr_recon_loss: 28983817.4050; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29770424.4516; train_optim_loss: 29770424.4516; val_kl_reg_loss: 12255.5258; val_edge_recon_loss: 780487.1411; val_gene_expr_recon_loss: 28980901.0538; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29773643.6344; val_optim_loss: 29773643.6344
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9711; val_auprc_score: 0.9935; val_best_acc_score: 0.9583; val_best_f1_score: 0.9758; train_kl_reg_loss: 11772.2915; train_edge_recon_loss: 782638.6949; train_gene_expr_recon_loss: 28931771.2425; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29726182.2103; train_optim_loss: 29726182.2103; val_kl_reg_loss: 11807.2403; val_edge_recon_loss: 795621.0847; val_gene_expr_recon_loss: 28972183.6344; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29779612.0860; val_optim_loss: 29779612.0860
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9669; val_auprc_score: 0.9923; val_best_acc_score: 0.9535; val_best_f1_score: 0.9731; train_kl_reg_loss: 10322.3742; train_edge_recon_loss: 789021.2609; train_gene_expr_recon_loss: 29270753.8996; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30070097.5962; train_optim_loss: 30070097.5962; val_kl_reg_loss: 10289.5144; val_edge_recon_loss: 778668.1808; val_gene_expr_recon_loss: 29103750.6237; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29892708.3441; val_optim_loss: 29892708.3441
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9685; val_auprc_score: 0.9930; val_best_acc_score: 0.9549; val_best_f1_score: 0.9738; train_kl_reg_loss: 10221.0640; train_edge_recon_loss: 772868.3789; train_gene_expr_recon_loss: 29067827.2616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29850916.6834; train_optim_loss: 29850916.6834; val_kl_reg_loss: 10228.0804; val_edge_recon_loss: 800139.5605; val_gene_expr_recon_loss: 29106549.7204; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29916917.2903; val_optim_loss: 29916917.2903
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9661; val_auprc_score: 0.9924; val_best_acc_score: 0.9559; val_best_f1_score: 0.9744; train_kl_reg_loss: 10124.8378; train_edge_recon_loss: 774220.2677; train_gene_expr_recon_loss: 29029165.0012; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29813510.1123; train_optim_loss: 29813510.1123; val_kl_reg_loss: 10116.9433; val_edge_recon_loss: 783465.9913; val_gene_expr_recon_loss: 29018181.8065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29811764.7527; val_optim_loss: 29811764.7527

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9668; val_auprc_score: 0.9924; val_best_acc_score: 0.9567; val_best_f1_score: 0.9748; train_kl_reg_loss: 10052.2655; train_edge_recon_loss: 775988.4008; train_gene_expr_recon_loss: 28958308.4803; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29744349.1374; train_optim_loss: 29744349.1374; val_kl_reg_loss: 10048.1919; val_edge_recon_loss: 792297.4362; val_gene_expr_recon_loss: 28947651.1398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29749996.7097; val_optim_loss: 29749996.7097
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9711; val_auprc_score: 0.9936; val_best_acc_score: 0.9592; val_best_f1_score: 0.9763; train_kl_reg_loss: 10043.2494; train_edge_recon_loss: 773236.0999; train_gene_expr_recon_loss: 28950185.9642; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29733465.2975; train_optim_loss: 29733465.2975; val_kl_reg_loss: 10063.7394; val_edge_recon_loss: 783603.1344; val_gene_expr_recon_loss: 28952764.4946; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29746431.3333; val_optim_loss: 29746431.3333
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9700; val_auprc_score: 0.9932; val_best_acc_score: 0.9600; val_best_f1_score: 0.9767; train_kl_reg_loss: 10068.7969; train_edge_recon_loss: 778039.7999; train_gene_expr_recon_loss: 28946767.5723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29734876.1649; train_optim_loss: 29734876.1649; val_kl_reg_loss: 10122.4899; val_edge_recon_loss: 784264.4691; val_gene_expr_recon_loss: 28948639.0108; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29743025.9570; val_optim_loss: 29743025.9570
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9676; val_auprc_score: 0.9921; val_best_acc_score: 0.9577; val_best_f1_score: 0.9753; train_kl_reg_loss: 10114.2452; train_edge_recon_loss: 770254.3044; train_gene_expr_recon_loss: 28943919.1326; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29724287.6822; train_optim_loss: 29724287.6822; val_kl_reg_loss: 10158.6481; val_edge_recon_loss: 796297.1976; val_gene_expr_recon_loss: 28949196.2581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29755652.1075; val_optim_loss: 29755652.1075
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9715; val_auprc_score: 0.9937; val_best_acc_score: 0.9600; val_best_f1_score: 0.9768; train_kl_reg_loss: 10110.8962; train_edge_recon_loss: 771000.9463; train_gene_expr_recon_loss: 28942454.3608; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29723566.2127; train_optim_loss: 29723566.2127; val_kl_reg_loss: 10103.0020; val_edge_recon_loss: 766857.2231; val_gene_expr_recon_loss: 28933619.8280; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29710580.1075; val_optim_loss: 29710580.1075
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9675; val_auprc_score: 0.9919; val_best_acc_score: 0.9574; val_best_f1_score: 0.9753; train_kl_reg_loss: 10117.5648; train_edge_recon_loss: 774710.5861; train_gene_expr_recon_loss: 28938321.5030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29723149.6655; train_optim_loss: 29723149.6655; val_kl_reg_loss: 10115.1191; val_edge_recon_loss: 799474.5067; val_gene_expr_recon_loss: 28946365.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29755954.9677; val_optim_loss: 29755954.9677
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9724; val_auprc_score: 0.9941; val_best_acc_score: 0.9588; val_best_f1_score: 0.9761; train_kl_reg_loss: 10130.7421; train_edge_recon_loss: 768469.3169; train_gene_expr_recon_loss: 28931398.5257; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29709998.5639; train_optim_loss: 29709998.5639; val_kl_reg_loss: 10139.1917; val_edge_recon_loss: 784067.9792; val_gene_expr_recon_loss: 28928674.4086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29722881.5699; val_optim_loss: 29722881.5699
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9689; val_auprc_score: 0.9922; val_best_acc_score: 0.9587; val_best_f1_score: 0.9760; train_kl_reg_loss: 10138.1284; train_edge_recon_loss: 773310.1886; train_gene_expr_recon_loss: 28929262.7431; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29712711.0442; train_optim_loss: 29712711.0442; val_kl_reg_loss: 10146.9707; val_edge_recon_loss: 780224.9577; val_gene_expr_recon_loss: 28934988.5806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29725360.5591; val_optim_loss: 29725360.5591
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9682; val_auprc_score: 0.9931; val_best_acc_score: 0.9595; val_best_f1_score: 0.9766; train_kl_reg_loss: 10149.9783; train_edge_recon_loss: 771195.3841; train_gene_expr_recon_loss: 28929111.3740; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29710456.7599; train_optim_loss: 29710456.7599; val_kl_reg_loss: 10167.3258; val_edge_recon_loss: 766906.1008; val_gene_expr_recon_loss: 28927877.5914; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29704950.9892; val_optim_loss: 29704950.9892
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9657; val_auprc_score: 0.9917; val_best_acc_score: 0.9570; val_best_f1_score: 0.9750; train_kl_reg_loss: 10081.1489; train_edge_recon_loss: 771033.6617; train_gene_expr_recon_loss: 28926746.2318; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29707861.0705; train_optim_loss: 29707861.0705; val_kl_reg_loss: 9527.0165; val_edge_recon_loss: 792800.3488; val_gene_expr_recon_loss: 28918576.9677; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29720904.3441; val_optim_loss: 29720904.3441
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9713; val_auprc_score: 0.9936; val_best_acc_score: 0.9611; val_best_f1_score: 0.9775; train_kl_reg_loss: 10048.9346; train_edge_recon_loss: 769896.2419; train_gene_expr_recon_loss: 28923099.3811; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29703044.5568; train_optim_loss: 29703044.5568; val_kl_reg_loss: 9523.3544; val_edge_recon_loss: 770728.9032; val_gene_expr_recon_loss: 28927900.4301; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29708152.7312; val_optim_loss: 29708152.7312
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9690; val_auprc_score: 0.9929; val_best_acc_score: 0.9578; val_best_f1_score: 0.9754; train_kl_reg_loss: 10020.7161; train_edge_recon_loss: 774980.2230; train_gene_expr_recon_loss: 28921676.3871; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29706677.3333; train_optim_loss: 29706677.3333; val_kl_reg_loss: 9527.5053; val_edge_recon_loss: 796113.3300; val_gene_expr_recon_loss: 28923707.9140; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29729348.8387; val_optim_loss: 29729348.8387
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9700; val_auprc_score: 0.9932; val_best_acc_score: 0.9596; val_best_f1_score: 0.9765; train_kl_reg_loss: 10002.4854; train_edge_recon_loss: 773437.1218; train_gene_expr_recon_loss: 28919036.0550; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29702475.6822; train_optim_loss: 29702475.6822; val_kl_reg_loss: 9570.7251; val_edge_recon_loss: 781811.3222; val_gene_expr_recon_loss: 28919697.0323; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29711079.0753; val_optim_loss: 29711079.0753

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9680; val_auprc_score: 0.9924; val_best_acc_score: 0.9611; val_best_f1_score: 0.9773; train_kl_reg_loss: 10012.3243; train_edge_recon_loss: 776486.8542; train_gene_expr_recon_loss: 28910668.4659; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29697167.6511; train_optim_loss: 29697167.6511; val_kl_reg_loss: 9562.9265; val_edge_recon_loss: 794940.8058; val_gene_expr_recon_loss: 28906500.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29711004.3871; val_optim_loss: 29711004.3871
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9679; val_auprc_score: 0.9929; val_best_acc_score: 0.9604; val_best_f1_score: 0.9770; train_kl_reg_loss: 10016.8644; train_edge_recon_loss: 772923.7480; train_gene_expr_recon_loss: 28909861.8160; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29692802.4110; train_optim_loss: 29692802.4110; val_kl_reg_loss: 9580.6672; val_edge_recon_loss: 775205.9341; val_gene_expr_recon_loss: 28906826.2151; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29691612.8817; val_optim_loss: 29691612.8817
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9711; val_auprc_score: 0.9931; val_best_acc_score: 0.9609; val_best_f1_score: 0.9773; train_kl_reg_loss: 10006.2571; train_edge_recon_loss: 776607.3082; train_gene_expr_recon_loss: 28908291.8734; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29694905.4743; train_optim_loss: 29694905.4743; val_kl_reg_loss: 9558.3187; val_edge_recon_loss: 779237.4825; val_gene_expr_recon_loss: 28920151.4839; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29708947.2688; val_optim_loss: 29708947.2688
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9693; val_auprc_score: 0.9930; val_best_acc_score: 0.9597; val_best_f1_score: 0.9766; train_kl_reg_loss: 9999.8558; train_edge_recon_loss: 776703.5566; train_gene_expr_recon_loss: 28909311.9881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29696015.3740; train_optim_loss: 29696015.3740; val_kl_reg_loss: 9558.2893; val_edge_recon_loss: 781207.3703; val_gene_expr_recon_loss: 28906525.5054; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29697291.2258; val_optim_loss: 29697291.2258
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9679; val_auprc_score: 0.9923; val_best_acc_score: 0.9607; val_best_f1_score: 0.9772; train_kl_reg_loss: 9994.0164; train_edge_recon_loss: 775702.4991; train_gene_expr_recon_loss: 28907773.7587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29693470.2700; train_optim_loss: 29693470.2700; val_kl_reg_loss: 9568.2484; val_edge_recon_loss: 785902.5827; val_gene_expr_recon_loss: 28921154.7097; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29716625.4409; val_optim_loss: 29716625.4409
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9689; val_auprc_score: 0.9929; val_best_acc_score: 0.9590; val_best_f1_score: 0.9762; train_kl_reg_loss: 9984.2209; train_edge_recon_loss: 773367.7101; train_gene_expr_recon_loss: 28906364.4349; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29689716.4062; train_optim_loss: 29689716.4062; val_kl_reg_loss: 9589.0505; val_edge_recon_loss: 785053.2718; val_gene_expr_recon_loss: 28914682.2796; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29709324.4946; val_optim_loss: 29709324.4946

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9718; val_auprc_score: 0.9936; val_best_acc_score: 0.9603; val_best_f1_score: 0.9767; train_kl_reg_loss: 9990.3625; train_edge_recon_loss: 774611.0897; train_gene_expr_recon_loss: 28908355.5890; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29692957.0370; train_optim_loss: 29692957.0370; val_kl_reg_loss: 9580.1480; val_edge_recon_loss: 795948.4321; val_gene_expr_recon_loss: 28916097.3333; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29721625.8280; val_optim_loss: 29721625.8280
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9690; val_auprc_score: 0.9926; val_best_acc_score: 0.9593; val_best_f1_score: 0.9763; train_kl_reg_loss: 9985.6315; train_edge_recon_loss: 772264.7799; train_gene_expr_recon_loss: 28911664.8148; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29693915.2401; train_optim_loss: 29693915.2401; val_kl_reg_loss: 9563.9079; val_edge_recon_loss: 784319.7876; val_gene_expr_recon_loss: 28906152.0215; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29700035.7634; val_optim_loss: 29700035.7634
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9709; val_auprc_score: 0.9930; val_best_acc_score: 0.9622; val_best_f1_score: 0.9781; train_kl_reg_loss: 9985.0010; train_edge_recon_loss: 777333.2830; train_gene_expr_recon_loss: 28906357.4026; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29693675.6870; train_optim_loss: 29693675.6870; val_kl_reg_loss: 9563.1596; val_edge_recon_loss: 767813.3464; val_gene_expr_recon_loss: 28901001.8495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29678378.3011; val_optim_loss: 29678378.3011
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9693; val_auprc_score: 0.9930; val_best_acc_score: 0.9592; val_best_f1_score: 0.9762; train_kl_reg_loss: 9980.3374; train_edge_recon_loss: 773970.2283; train_gene_expr_recon_loss: 28905165.9403; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29689116.4946; train_optim_loss: 29689116.4946; val_kl_reg_loss: 9581.1915; val_edge_recon_loss: 785940.0188; val_gene_expr_recon_loss: 28912773.8065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29708295.0108; val_optim_loss: 29708295.0108
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9684; val_auprc_score: 0.9925; val_best_acc_score: 0.9619; val_best_f1_score: 0.9779; train_kl_reg_loss: 9977.6543; train_edge_recon_loss: 776426.1953; train_gene_expr_recon_loss: 28906641.4361; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29693045.3047; train_optim_loss: 29693045.3047; val_kl_reg_loss: 9572.6469; val_edge_recon_loss: 778046.7117; val_gene_expr_recon_loss: 28921762.8172; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29709382.1290; val_optim_loss: 29709382.1290
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9702; val_auprc_score: 0.9930; val_best_acc_score: 0.9605; val_best_f1_score: 0.9770; train_kl_reg_loss: 9980.1834; train_edge_recon_loss: 770206.5525; train_gene_expr_recon_loss: 28909411.1254; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29689597.8471; train_optim_loss: 29689597.8471; val_kl_reg_loss: 9572.9325; val_edge_recon_loss: 793535.8132; val_gene_expr_recon_loss: 28907237.6129; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29710346.3441; val_optim_loss: 29710346.3441
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9705; val_auprc_score: 0.9936; val_best_acc_score: 0.9607; val_best_f1_score: 0.9772; train_kl_reg_loss: 9983.9507; train_edge_recon_loss: 768686.1025; train_gene_expr_recon_loss: 28906819.9952; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29685490.0956; train_optim_loss: 29685490.0956; val_kl_reg_loss: 9563.5733; val_edge_recon_loss: 762135.4160; val_gene_expr_recon_loss: 28917202.6452; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29688901.5914; val_optim_loss: 29688901.5914

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9695; val_auprc_score: 0.9927; val_best_acc_score: 0.9603; val_best_f1_score: 0.9769; train_kl_reg_loss: 9984.3507; train_edge_recon_loss: 780463.4176; train_gene_expr_recon_loss: 28907390.2963; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29697838.0454; train_optim_loss: 29697838.0454; val_kl_reg_loss: 9562.4365; val_edge_recon_loss: 781405.1922; val_gene_expr_recon_loss: 28910857.1398; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29701824.7957; val_optim_loss: 29701824.7957
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9693; val_auprc_score: 0.9930; val_best_acc_score: 0.9602; val_best_f1_score: 0.9769; train_kl_reg_loss: 9981.1718; train_edge_recon_loss: 769375.0042; train_gene_expr_recon_loss: 28907388.8554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29686745.0370; train_optim_loss: 29686745.0370; val_kl_reg_loss: 9565.0893; val_edge_recon_loss: 784357.1909; val_gene_expr_recon_loss: 28918349.5269; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29712271.7634; val_optim_loss: 29712271.7634
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9694; val_auprc_score: 0.9928; val_best_acc_score: 0.9591; val_best_f1_score: 0.9762; train_kl_reg_loss: 9975.8126; train_edge_recon_loss: 775781.3019; train_gene_expr_recon_loss: 28905746.8554; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29691503.9594; train_optim_loss: 29691503.9594; val_kl_reg_loss: 9578.8166; val_edge_recon_loss: 780865.2923; val_gene_expr_recon_loss: 28909846.7742; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29700290.9247; val_optim_loss: 29700290.9247
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9684; val_auprc_score: 0.9922; val_best_acc_score: 0.9595; val_best_f1_score: 0.9764; train_kl_reg_loss: 9982.7889; train_edge_recon_loss: 773845.0702; train_gene_expr_recon_loss: 28908353.8280; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 29692181.6846; train_optim_loss: 29692181.6846; val_kl_reg_loss: 9584.1764; val_edge_recon_loss: 787823.5185; val_gene_expr_recon_loss: 28903161.4194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 29700569.0323; val_optim_loss: 29700569.0323

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 61 min 3 sec.
Using best model state, which was in epoch 38.

--- MODEL EVALUATION ---
val AUROC score: 0.9678
val AUPRC score: 0.9926
val best accuracy score: 0.9587
val best F1 score: 0.9760
val target rna MSE score: 0.9232
val source rna MSE score: 0.4714
Val cat covariate0 mean sim diff: -0.0041

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
