[True]
Run timestamp: 10102023_014758_105.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_105']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7701; val_auprc_score: 0.7857; val_best_acc_score: 0.5679; val_best_f1_score: 0.6949; train_kl_reg_loss: 73027.0293; train_edge_recon_loss: 3507344.3149; train_gene_expr_recon_loss: 13307132.0305; train_masked_gp_l1_reg_loss: 46867.0081; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3218315.5458; train_chrom_access_recon_loss: 4746579.1412; train_global_loss: 24899264.9160; train_optim_loss: 24899264.9160; val_kl_reg_loss: 85035.9255; val_edge_recon_loss: 4061541.5833; val_gene_expr_recon_loss: 12889312.8000; val_masked_gp_l1_reg_loss: 54329.2734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 424246.5312; val_chrom_access_recon_loss: 4689628.1667; val_global_loss: 22204094.1333; val_optim_loss: 22204094.1333
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8097; val_auprc_score: 0.8162; val_best_acc_score: 0.7171; val_best_f1_score: 0.7482; train_kl_reg_loss: 77237.6038; train_edge_recon_loss: 3460071.3302; train_gene_expr_recon_loss: 12589932.5115; train_masked_gp_l1_reg_loss: 56131.6051; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 246826.0533; train_chrom_access_recon_loss: 4585166.6260; train_global_loss: 21015365.8168; train_optim_loss: 21015365.8168; val_kl_reg_loss: 70305.9185; val_edge_recon_loss: 3330187.8667; val_gene_expr_recon_loss: 12662642.2667; val_masked_gp_l1_reg_loss: 60101.4961; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 168959.3438; val_chrom_access_recon_loss: 4585717.8000; val_global_loss: 20877913.7333; val_optim_loss: 20877913.7333
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.8532; val_auprc_score: 0.8482; val_best_acc_score: 0.7629; val_best_f1_score: 0.7800; train_kl_reg_loss: 88725.9149; train_edge_recon_loss: 3085278.3645; train_gene_expr_recon_loss: 12456346.3664; train_masked_gp_l1_reg_loss: 64385.9537; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 141548.8478; train_chrom_access_recon_loss: 4538067.7958; train_global_loss: 20374353.3588; train_optim_loss: 20374353.3588; val_kl_reg_loss: 91456.2135; val_edge_recon_loss: 3062117.4833; val_gene_expr_recon_loss: 12537618.1333; val_masked_gp_l1_reg_loss: 67576.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122610.8438; val_chrom_access_recon_loss: 4563043.0333; val_global_loss: 20444422.0000; val_optim_loss: 20444422.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9249; val_auprc_score: 0.9108; val_best_acc_score: 0.8564; val_best_f1_score: 0.8650; train_kl_reg_loss: 101681.4564; train_edge_recon_loss: 2880418.7195; train_gene_expr_recon_loss: 12317821.0687; train_masked_gp_l1_reg_loss: 70701.7370; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113338.3255; train_chrom_access_recon_loss: 4491062.1069; train_global_loss: 19975023.2519; train_optim_loss: 19975023.2519; val_kl_reg_loss: 103391.7609; val_edge_recon_loss: 2797934.6500; val_gene_expr_recon_loss: 12415189.2000; val_masked_gp_l1_reg_loss: 73423.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107612.7500; val_chrom_access_recon_loss: 4527019.2333; val_global_loss: 20024571.7333; val_optim_loss: 20024571.7333
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9269; val_auprc_score: 0.9120; val_best_acc_score: 0.8577; val_best_f1_score: 0.8649; train_kl_reg_loss: 98466.8075; train_edge_recon_loss: 2811897.3092; train_gene_expr_recon_loss: 12191373.1756; train_masked_gp_l1_reg_loss: 75050.0494; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105421.6100; train_chrom_access_recon_loss: 4447978.2653; train_global_loss: 19730187.1908; train_optim_loss: 19730187.1908; val_kl_reg_loss: 99495.9245; val_edge_recon_loss: 2817085.3667; val_gene_expr_recon_loss: 12289401.3333; val_masked_gp_l1_reg_loss: 76783.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105823.5703; val_chrom_access_recon_loss: 4480059.8167; val_global_loss: 19868649.7333; val_optim_loss: 19868649.7333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9312; val_auprc_score: 0.9138; val_best_acc_score: 0.8642; val_best_f1_score: 0.8723; train_kl_reg_loss: 97976.0081; train_edge_recon_loss: 2785875.1240; train_gene_expr_recon_loss: 12089889.4809; train_masked_gp_l1_reg_loss: 77831.8553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 106449.2259; train_chrom_access_recon_loss: 4425643.3969; train_global_loss: 19583665.0687; train_optim_loss: 19583665.0687; val_kl_reg_loss: 93174.9646; val_edge_recon_loss: 2809092.8000; val_gene_expr_recon_loss: 12175871.4667; val_masked_gp_l1_reg_loss: 78736.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105355.1328; val_chrom_access_recon_loss: 4442457.4000; val_global_loss: 19704687.7333; val_optim_loss: 19704687.7333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9343; val_auprc_score: 0.9180; val_best_acc_score: 0.8723; val_best_f1_score: 0.8793; train_kl_reg_loss: 92557.2689; train_edge_recon_loss: 2791009.0821; train_gene_expr_recon_loss: 11987377.5496; train_masked_gp_l1_reg_loss: 79620.2018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103674.2909; train_chrom_access_recon_loss: 4386008.2385; train_global_loss: 19440246.5496; train_optim_loss: 19440246.5496; val_kl_reg_loss: 90301.2453; val_edge_recon_loss: 2804928.9333; val_gene_expr_recon_loss: 12039004.0667; val_masked_gp_l1_reg_loss: 80517.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 101877.0156; val_chrom_access_recon_loss: 4402406.3333; val_global_loss: 19519035.6000; val_optim_loss: 19519035.6000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9367; val_auprc_score: 0.9221; val_best_acc_score: 0.8760; val_best_f1_score: 0.8809; train_kl_reg_loss: 89289.4241; train_edge_recon_loss: 2780956.9924; train_gene_expr_recon_loss: 11919119.6794; train_masked_gp_l1_reg_loss: 81272.3935; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 99696.9040; train_chrom_access_recon_loss: 4362502.9752; train_global_loss: 19332838.3511; train_optim_loss: 19332838.3511; val_kl_reg_loss: 85580.8547; val_edge_recon_loss: 2790900.9833; val_gene_expr_recon_loss: 12043267.7333; val_masked_gp_l1_reg_loss: 82323.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98809.5781; val_chrom_access_recon_loss: 4411419.9333; val_global_loss: 19512302.8000; val_optim_loss: 19512302.8000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9398; val_auprc_score: 0.9239; val_best_acc_score: 0.8801; val_best_f1_score: 0.8863; train_kl_reg_loss: 86462.3506; train_edge_recon_loss: 2783288.9389; train_gene_expr_recon_loss: 11838168.1221; train_masked_gp_l1_reg_loss: 82683.0816; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96245.9723; train_chrom_access_recon_loss: 4335600.0382; train_global_loss: 19222448.4427; train_optim_loss: 19222448.4427; val_kl_reg_loss: 83352.1719; val_edge_recon_loss: 2788824.1167; val_gene_expr_recon_loss: 12025350.8667; val_masked_gp_l1_reg_loss: 83179.1641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 95286.3750; val_chrom_access_recon_loss: 4380767.2667; val_global_loss: 19456759.3333; val_optim_loss: 19456759.3333
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9401; val_auprc_score: 0.9270; val_best_acc_score: 0.8778; val_best_f1_score: 0.8843; train_kl_reg_loss: 83998.6097; train_edge_recon_loss: 2759828.8416; train_gene_expr_recon_loss: 11787658.7710; train_masked_gp_l1_reg_loss: 83795.3787; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 93749.9977; train_chrom_access_recon_loss: 4315758.8073; train_global_loss: 19124790.3969; train_optim_loss: 19124790.3969; val_kl_reg_loss: 80517.4646; val_edge_recon_loss: 2797323.1000; val_gene_expr_recon_loss: 11902630.2667; val_masked_gp_l1_reg_loss: 84382.2812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93182.2422; val_chrom_access_recon_loss: 4328395.3500; val_global_loss: 19286430.2667; val_optim_loss: 19286430.2667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9448; val_auprc_score: 0.9306; val_best_acc_score: 0.8849; val_best_f1_score: 0.8897; train_kl_reg_loss: 83588.7096; train_edge_recon_loss: 2750017.6698; train_gene_expr_recon_loss: 11728169.5573; train_masked_gp_l1_reg_loss: 84864.1503; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91642.2195; train_chrom_access_recon_loss: 4287825.7500; train_global_loss: 19026108.0611; train_optim_loss: 19026108.0611; val_kl_reg_loss: 86261.5458; val_edge_recon_loss: 2764839.3000; val_gene_expr_recon_loss: 11904973.5333; val_masked_gp_l1_reg_loss: 85127.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91062.3438; val_chrom_access_recon_loss: 4363855.8833; val_global_loss: 19296119.2000; val_optim_loss: 19296119.2000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9481; val_auprc_score: 0.9341; val_best_acc_score: 0.8891; val_best_f1_score: 0.8940; train_kl_reg_loss: 82909.2475; train_edge_recon_loss: 2742398.5401; train_gene_expr_recon_loss: 11696691.4046; train_masked_gp_l1_reg_loss: 85504.9507; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90160.0908; train_chrom_access_recon_loss: 4273785.4905; train_global_loss: 18971449.6031; train_optim_loss: 18971449.6031; val_kl_reg_loss: 84138.7818; val_edge_recon_loss: 2745539.6833; val_gene_expr_recon_loss: 11807943.2000; val_masked_gp_l1_reg_loss: 86038.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90080.0781; val_chrom_access_recon_loss: 4311608.2500; val_global_loss: 19125348.1333; val_optim_loss: 19125348.1333
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9523; val_auprc_score: 0.9415; val_best_acc_score: 0.8959; val_best_f1_score: 0.8991; train_kl_reg_loss: 81716.3580; train_edge_recon_loss: 2730115.8225; train_gene_expr_recon_loss: 11637864.4885; train_masked_gp_l1_reg_loss: 86350.5454; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88799.0139; train_chrom_access_recon_loss: 4255934.8168; train_global_loss: 18880781.0229; train_optim_loss: 18880781.0229; val_kl_reg_loss: 80831.4750; val_edge_recon_loss: 2736759.0167; val_gene_expr_recon_loss: 11803444.1333; val_masked_gp_l1_reg_loss: 86681.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88255.2422; val_chrom_access_recon_loss: 4293588.3667; val_global_loss: 19089558.8000; val_optim_loss: 19089558.8000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9572; val_auprc_score: 0.9461; val_best_acc_score: 0.9015; val_best_f1_score: 0.9051; train_kl_reg_loss: 80495.7004; train_edge_recon_loss: 2727050.2996; train_gene_expr_recon_loss: 11599039.2366; train_masked_gp_l1_reg_loss: 86867.1591; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87916.8459; train_chrom_access_recon_loss: 4237124.6355; train_global_loss: 18818493.9389; train_optim_loss: 18818493.9389; val_kl_reg_loss: 80048.5453; val_edge_recon_loss: 2722785.6333; val_gene_expr_recon_loss: 11702877.9333; val_masked_gp_l1_reg_loss: 86996.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87578.9766; val_chrom_access_recon_loss: 4283851.6000; val_global_loss: 18964139.8667; val_optim_loss: 18964139.8667
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9560; val_auprc_score: 0.9439; val_best_acc_score: 0.8954; val_best_f1_score: 0.9001; train_kl_reg_loss: 79407.5051; train_edge_recon_loss: 2723075.8874; train_gene_expr_recon_loss: 11557622.0534; train_masked_gp_l1_reg_loss: 87239.5803; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87227.4240; train_chrom_access_recon_loss: 4219199.2634; train_global_loss: 18753771.7405; train_optim_loss: 18753771.7405; val_kl_reg_loss: 76982.9516; val_edge_recon_loss: 2732093.0500; val_gene_expr_recon_loss: 11716027.0000; val_masked_gp_l1_reg_loss: 87464.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86806.5000; val_chrom_access_recon_loss: 4274084.5500; val_global_loss: 18973459.6000; val_optim_loss: 18973459.6000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9596; val_auprc_score: 0.9482; val_best_acc_score: 0.9031; val_best_f1_score: 0.9078; train_kl_reg_loss: 78346.6428; train_edge_recon_loss: 2718202.8989; train_gene_expr_recon_loss: 11535108.9237; train_masked_gp_l1_reg_loss: 87607.3276; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86673.8383; train_chrom_access_recon_loss: 4207446.6870; train_global_loss: 18713386.2443; train_optim_loss: 18713386.2443; val_kl_reg_loss: 78747.9005; val_edge_recon_loss: 2718023.3167; val_gene_expr_recon_loss: 11679420.8000; val_masked_gp_l1_reg_loss: 87805.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86723.6797; val_chrom_access_recon_loss: 4266036.9333; val_global_loss: 18916758.9333; val_optim_loss: 18916758.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9587; val_auprc_score: 0.9473; val_best_acc_score: 0.9072; val_best_f1_score: 0.9118; train_kl_reg_loss: 79596.3054; train_edge_recon_loss: 2704996.2328; train_gene_expr_recon_loss: 11506683.7710; train_masked_gp_l1_reg_loss: 87823.4693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86236.7793; train_chrom_access_recon_loss: 4194174.9427; train_global_loss: 18659511.5267; train_optim_loss: 18659511.5267; val_kl_reg_loss: 80405.7167; val_edge_recon_loss: 2728113.1333; val_gene_expr_recon_loss: 11656055.7333; val_masked_gp_l1_reg_loss: 87711.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86741.3203; val_chrom_access_recon_loss: 4253273.8167; val_global_loss: 18892301.4667; val_optim_loss: 18892301.4667
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9630; val_auprc_score: 0.9498; val_best_acc_score: 0.9089; val_best_f1_score: 0.9143; train_kl_reg_loss: 77467.4213; train_edge_recon_loss: 2697567.3321; train_gene_expr_recon_loss: 11469692.6794; train_masked_gp_l1_reg_loss: 87896.4906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86346.4608; train_chrom_access_recon_loss: 4170135.8511; train_global_loss: 18589106.1832; train_optim_loss: 18589106.1832; val_kl_reg_loss: 76810.7016; val_edge_recon_loss: 2722921.0167; val_gene_expr_recon_loss: 11616817.2000; val_masked_gp_l1_reg_loss: 87947.0078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86080.8438; val_chrom_access_recon_loss: 4233427.8333; val_global_loss: 18824004.6667; val_optim_loss: 18824004.6667
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9673; val_auprc_score: 0.9572; val_best_acc_score: 0.9197; val_best_f1_score: 0.9228; train_kl_reg_loss: 76819.2463; train_edge_recon_loss: 2699838.2347; train_gene_expr_recon_loss: 11475917.3435; train_masked_gp_l1_reg_loss: 88004.4903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86224.5379; train_chrom_access_recon_loss: 4171598.9256; train_global_loss: 18598402.7786; train_optim_loss: 18598402.7786; val_kl_reg_loss: 79639.3922; val_edge_recon_loss: 2701385.1000; val_gene_expr_recon_loss: 11590533.1333; val_masked_gp_l1_reg_loss: 88011.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86419.9375; val_chrom_access_recon_loss: 4210867.4500; val_global_loss: 18756855.8667; val_optim_loss: 18756855.8667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9636; val_auprc_score: 0.9513; val_best_acc_score: 0.9136; val_best_f1_score: 0.9166; train_kl_reg_loss: 77521.7638; train_edge_recon_loss: 2706480.6031; train_gene_expr_recon_loss: 11435793.7786; train_masked_gp_l1_reg_loss: 87683.3067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86245.8848; train_chrom_access_recon_loss: 4149580.4676; train_global_loss: 18543305.6336; train_optim_loss: 18543305.6336; val_kl_reg_loss: 77320.3120; val_edge_recon_loss: 2706609.7000; val_gene_expr_recon_loss: 11589260.1333; val_masked_gp_l1_reg_loss: 87606.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86991.5781; val_chrom_access_recon_loss: 4200192.0000; val_global_loss: 18747979.8667; val_optim_loss: 18747979.8667
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9678; val_auprc_score: 0.9581; val_best_acc_score: 0.9155; val_best_f1_score: 0.9184; train_kl_reg_loss: 76109.1583; train_edge_recon_loss: 2698102.5248; train_gene_expr_recon_loss: 11427714.3206; train_masked_gp_l1_reg_loss: 87412.9221; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86876.5071; train_chrom_access_recon_loss: 4146334.2691; train_global_loss: 18522549.7099; train_optim_loss: 18522549.7099; val_kl_reg_loss: 77247.0906; val_edge_recon_loss: 2738662.0000; val_gene_expr_recon_loss: 11563744.4667; val_masked_gp_l1_reg_loss: 87528.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87382.7500; val_chrom_access_recon_loss: 4187584.4000; val_global_loss: 18742149.0667; val_optim_loss: 18742149.0667
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9683; val_auprc_score: 0.9587; val_best_acc_score: 0.9202; val_best_f1_score: 0.9230; train_kl_reg_loss: 76247.0012; train_edge_recon_loss: 2690013.0153; train_gene_expr_recon_loss: 11393456.8855; train_masked_gp_l1_reg_loss: 87292.3327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87886.1305; train_chrom_access_recon_loss: 4125182.6832; train_global_loss: 18460078.1221; train_optim_loss: 18460078.1221; val_kl_reg_loss: 77708.6010; val_edge_recon_loss: 2714962.3000; val_gene_expr_recon_loss: 11529433.2667; val_masked_gp_l1_reg_loss: 87130.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88491.4531; val_chrom_access_recon_loss: 4181896.4167; val_global_loss: 18679622.4000; val_optim_loss: 18679622.4000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9680; val_auprc_score: 0.9569; val_best_acc_score: 0.9201; val_best_f1_score: 0.9232; train_kl_reg_loss: 76087.0155; train_edge_recon_loss: 2695252.6469; train_gene_expr_recon_loss: 11361146.9924; train_masked_gp_l1_reg_loss: 86834.0112; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88783.1886; train_chrom_access_recon_loss: 4109745.6317; train_global_loss: 18417849.5725; train_optim_loss: 18417849.5725; val_kl_reg_loss: 76491.3141; val_edge_recon_loss: 2709925.4000; val_gene_expr_recon_loss: 11554117.8000; val_masked_gp_l1_reg_loss: 86929.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90403.3984; val_chrom_access_recon_loss: 4167744.1167; val_global_loss: 18685611.4667; val_optim_loss: 18685611.4667
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9681; val_auprc_score: 0.9578; val_best_acc_score: 0.9135; val_best_f1_score: 0.9162; train_kl_reg_loss: 75630.5407; train_edge_recon_loss: 2691459.7443; train_gene_expr_recon_loss: 11349067.9618; train_masked_gp_l1_reg_loss: 86577.5132; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89986.1908; train_chrom_access_recon_loss: 4102364.7691; train_global_loss: 18395086.7634; train_optim_loss: 18395086.7634; val_kl_reg_loss: 74391.0458; val_edge_recon_loss: 2726471.6667; val_gene_expr_recon_loss: 11532889.0000; val_masked_gp_l1_reg_loss: 86485.0312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90779.4766; val_chrom_access_recon_loss: 4185972.5500; val_global_loss: 18696988.4000; val_optim_loss: 18696988.4000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9692; val_auprc_score: 0.9586; val_best_acc_score: 0.9201; val_best_f1_score: 0.9234; train_kl_reg_loss: 75271.9433; train_edge_recon_loss: 2688786.6107; train_gene_expr_recon_loss: 11344085.9313; train_masked_gp_l1_reg_loss: 86255.1205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90684.3377; train_chrom_access_recon_loss: 4090395.2233; train_global_loss: 18375479.1450; train_optim_loss: 18375479.1450; val_kl_reg_loss: 75650.3141; val_edge_recon_loss: 2698385.3833; val_gene_expr_recon_loss: 11496915.2000; val_masked_gp_l1_reg_loss: 85997.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91462.7891; val_chrom_access_recon_loss: 4163175.9833; val_global_loss: 18611587.6000; val_optim_loss: 18611587.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9694; val_auprc_score: 0.9613; val_best_acc_score: 0.9175; val_best_f1_score: 0.9213; train_kl_reg_loss: 87237.1824; train_edge_recon_loss: 2745031.6431; train_gene_expr_recon_loss: 10151812.3740; train_masked_gp_l1_reg_loss: 84340.4913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86771.2685; train_chrom_access_recon_loss: 3733883.2710; train_global_loss: 16889076.3740; train_optim_loss: 16889076.3740; val_kl_reg_loss: 35010.4544; val_edge_recon_loss: 2718434.3333; val_gene_expr_recon_loss: 10255962.2000; val_masked_gp_l1_reg_loss: 82549.7891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86032.1406; val_chrom_access_recon_loss: 3754219.0667; val_global_loss: 16932207.9333; val_optim_loss: 16932207.9333
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9693; val_auprc_score: 0.9594; val_best_acc_score: 0.9221; val_best_f1_score: 0.9248; train_kl_reg_loss: 65670.5587; train_edge_recon_loss: 2709512.6202; train_gene_expr_recon_loss: 10101867.8702; train_masked_gp_l1_reg_loss: 80252.1518; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86180.7351; train_chrom_access_recon_loss: 3706736.8931; train_global_loss: 16750220.9160; train_optim_loss: 16750220.9160; val_kl_reg_loss: 40725.5938; val_edge_recon_loss: 2703074.4000; val_gene_expr_recon_loss: 10233597.3333; val_masked_gp_l1_reg_loss: 77833.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86090.2031; val_chrom_access_recon_loss: 3760206.9333; val_global_loss: 16901528.0667; val_optim_loss: 16901528.0667
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9706; val_auprc_score: 0.9610; val_best_acc_score: 0.9229; val_best_f1_score: 0.9256; train_kl_reg_loss: 59186.6752; train_edge_recon_loss: 2686535.8416; train_gene_expr_recon_loss: 10079586.3130; train_masked_gp_l1_reg_loss: 75749.8801; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86218.4294; train_chrom_access_recon_loss: 3691150.4599; train_global_loss: 16678427.6412; train_optim_loss: 16678427.6412; val_kl_reg_loss: 41647.3805; val_edge_recon_loss: 2708076.0000; val_gene_expr_recon_loss: 10203443.7333; val_masked_gp_l1_reg_loss: 73696.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86203.5469; val_chrom_access_recon_loss: 3726546.4500; val_global_loss: 16839614.6667; val_optim_loss: 16839614.6667
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9704; val_auprc_score: 0.9621; val_best_acc_score: 0.9190; val_best_f1_score: 0.9217; train_kl_reg_loss: 56203.1008; train_edge_recon_loss: 2684194.8912; train_gene_expr_recon_loss: 10041188.1298; train_masked_gp_l1_reg_loss: 72212.4165; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86212.2931; train_chrom_access_recon_loss: 3676060.6489; train_global_loss: 16616071.5344; train_optim_loss: 16616071.5344; val_kl_reg_loss: 45938.3320; val_edge_recon_loss: 2710824.3000; val_gene_expr_recon_loss: 10160335.4000; val_masked_gp_l1_reg_loss: 70798.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86190.1094; val_chrom_access_recon_loss: 3712861.8333; val_global_loss: 16786948.9333; val_optim_loss: 16786948.9333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9702; val_auprc_score: 0.9597; val_best_acc_score: 0.9208; val_best_f1_score: 0.9226; train_kl_reg_loss: 55600.5622; train_edge_recon_loss: 2672254.1756; train_gene_expr_recon_loss: 10035409.4809; train_masked_gp_l1_reg_loss: 69717.6408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86144.9035; train_chrom_access_recon_loss: 3676004.7099; train_global_loss: 16595131.4656; train_optim_loss: 16595131.4656; val_kl_reg_loss: 47941.5555; val_edge_recon_loss: 2687689.7667; val_gene_expr_recon_loss: 10173524.3333; val_masked_gp_l1_reg_loss: 68750.5625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86105.4062; val_chrom_access_recon_loss: 3723567.8500; val_global_loss: 16787579.3333; val_optim_loss: 16787579.3333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9731; val_auprc_score: 0.9662; val_best_acc_score: 0.9241; val_best_f1_score: 0.9256; train_kl_reg_loss: 56222.8230; train_edge_recon_loss: 2677398.1107; train_gene_expr_recon_loss: 10019575.6947; train_masked_gp_l1_reg_loss: 67866.2703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85720.9031; train_chrom_access_recon_loss: 3667906.6469; train_global_loss: 16574690.3359; train_optim_loss: 16574690.3359; val_kl_reg_loss: 50106.4943; val_edge_recon_loss: 2687204.0833; val_gene_expr_recon_loss: 10154284.3333; val_masked_gp_l1_reg_loss: 67112.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85624.8906; val_chrom_access_recon_loss: 3698052.9833; val_global_loss: 16742386.0000; val_optim_loss: 16742386.0000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9709; val_auprc_score: 0.9601; val_best_acc_score: 0.9256; val_best_f1_score: 0.9273; train_kl_reg_loss: 55136.0582; train_edge_recon_loss: 2679163.8053; train_gene_expr_recon_loss: 9990193.8168; train_masked_gp_l1_reg_loss: 66239.5669; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85580.6951; train_chrom_access_recon_loss: 3660237.4847; train_global_loss: 16536551.5191; train_optim_loss: 16536551.5191; val_kl_reg_loss: 46504.4758; val_edge_recon_loss: 2702020.6833; val_gene_expr_recon_loss: 10088528.6000; val_masked_gp_l1_reg_loss: 65676.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85506.6406; val_chrom_access_recon_loss: 3692896.6000; val_global_loss: 16681134.2000; val_optim_loss: 16681134.2000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9735; val_auprc_score: 0.9656; val_best_acc_score: 0.9254; val_best_f1_score: 0.9271; train_kl_reg_loss: 54712.0641; train_edge_recon_loss: 2682698.9790; train_gene_expr_recon_loss: 9973364.9924; train_masked_gp_l1_reg_loss: 65030.5062; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85501.5304; train_chrom_access_recon_loss: 3659096.0153; train_global_loss: 16520404.0458; train_optim_loss: 16520404.0458; val_kl_reg_loss: 47472.8250; val_edge_recon_loss: 2694116.4000; val_gene_expr_recon_loss: 10083107.3333; val_masked_gp_l1_reg_loss: 64376.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85624.4922; val_chrom_access_recon_loss: 3700785.0667; val_global_loss: 16675481.8667; val_optim_loss: 16675481.8667
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9741; val_auprc_score: 0.9674; val_best_acc_score: 0.9270; val_best_f1_score: 0.9292; train_kl_reg_loss: 54817.5460; train_edge_recon_loss: 2669226.8034; train_gene_expr_recon_loss: 9946393.2290; train_masked_gp_l1_reg_loss: 63843.7930; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85479.4791; train_chrom_access_recon_loss: 3649776.6565; train_global_loss: 16469537.4656; train_optim_loss: 16469537.4656; val_kl_reg_loss: 50204.5849; val_edge_recon_loss: 2692646.1333; val_gene_expr_recon_loss: 10106841.8667; val_masked_gp_l1_reg_loss: 63272.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85175.3203; val_chrom_access_recon_loss: 3695917.0000; val_global_loss: 16694056.8000; val_optim_loss: 16694056.8000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9740; val_auprc_score: 0.9645; val_best_acc_score: 0.9276; val_best_f1_score: 0.9298; train_kl_reg_loss: 54119.6842; train_edge_recon_loss: 2668370.5038; train_gene_expr_recon_loss: 9919377.2824; train_masked_gp_l1_reg_loss: 62711.4704; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85283.5193; train_chrom_access_recon_loss: 3643247.4618; train_global_loss: 16433109.9542; train_optim_loss: 16433109.9542; val_kl_reg_loss: 48624.4930; val_edge_recon_loss: 2685141.8000; val_gene_expr_recon_loss: 10058232.6000; val_masked_gp_l1_reg_loss: 62264.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85773.2969; val_chrom_access_recon_loss: 3692531.1000; val_global_loss: 16632566.8000; val_optim_loss: 16632566.8000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9744; val_auprc_score: 0.9638; val_best_acc_score: 0.9310; val_best_f1_score: 0.9337; train_kl_reg_loss: 54444.8355; train_edge_recon_loss: 2668952.8626; train_gene_expr_recon_loss: 9913913.6641; train_masked_gp_l1_reg_loss: 61750.1931; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85512.2598; train_chrom_access_recon_loss: 3638616.0973; train_global_loss: 16423189.8397; train_optim_loss: 16423189.8397; val_kl_reg_loss: 46883.4615; val_edge_recon_loss: 2680417.7333; val_gene_expr_recon_loss: 10013395.6667; val_masked_gp_l1_reg_loss: 61371.4258; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85735.6719; val_chrom_access_recon_loss: 3676277.2167; val_global_loss: 16564081.2667; val_optim_loss: 16564081.2667
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9758; val_auprc_score: 0.9678; val_best_acc_score: 0.9332; val_best_f1_score: 0.9352; train_kl_reg_loss: 53562.9655; train_edge_recon_loss: 2670908.4008; train_gene_expr_recon_loss: 9891405.0076; train_masked_gp_l1_reg_loss: 60905.5946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85464.9316; train_chrom_access_recon_loss: 3634137.6088; train_global_loss: 16396384.4427; train_optim_loss: 16396384.4427; val_kl_reg_loss: 50132.9706; val_edge_recon_loss: 2664602.7333; val_gene_expr_recon_loss: 10038712.9333; val_masked_gp_l1_reg_loss: 60459.1992; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85674.2266; val_chrom_access_recon_loss: 3686941.8500; val_global_loss: 16586523.6667; val_optim_loss: 16586523.6667
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9790; val_auprc_score: 0.9725; val_best_acc_score: 0.9338; val_best_f1_score: 0.9361; train_kl_reg_loss: 52848.6885; train_edge_recon_loss: 2672851.6164; train_gene_expr_recon_loss: 9876301.1450; train_masked_gp_l1_reg_loss: 60109.4003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85459.7137; train_chrom_access_recon_loss: 3623609.8130; train_global_loss: 16371180.4198; train_optim_loss: 16371180.4198; val_kl_reg_loss: 49289.0820; val_edge_recon_loss: 2675819.8167; val_gene_expr_recon_loss: 10014606.8000; val_masked_gp_l1_reg_loss: 59786.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85208.8750; val_chrom_access_recon_loss: 3660400.1667; val_global_loss: 16545111.0000; val_optim_loss: 16545111.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9769; val_auprc_score: 0.9673; val_best_acc_score: 0.9367; val_best_f1_score: 0.9380; train_kl_reg_loss: 52209.8579; train_edge_recon_loss: 2662040.3683; train_gene_expr_recon_loss: 9857908.5649; train_masked_gp_l1_reg_loss: 59363.7208; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85404.2507; train_chrom_access_recon_loss: 3614825.3130; train_global_loss: 16331752.1069; train_optim_loss: 16331752.1069; val_kl_reg_loss: 49251.7458; val_edge_recon_loss: 2656857.6167; val_gene_expr_recon_loss: 9929195.3333; val_masked_gp_l1_reg_loss: 58906.8047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85025.9219; val_chrom_access_recon_loss: 3635935.7333; val_global_loss: 16415173.6667; val_optim_loss: 16415173.6667
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9753; val_auprc_score: 0.9664; val_best_acc_score: 0.9348; val_best_f1_score: 0.9372; train_kl_reg_loss: 51226.1470; train_edge_recon_loss: 2664520.8683; train_gene_expr_recon_loss: 9841193.5038; train_masked_gp_l1_reg_loss: 58605.6118; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85603.5412; train_chrom_access_recon_loss: 3605299.6145; train_global_loss: 16306449.2901; train_optim_loss: 16306449.2901; val_kl_reg_loss: 47558.0813; val_edge_recon_loss: 2677585.7833; val_gene_expr_recon_loss: 9969648.3333; val_masked_gp_l1_reg_loss: 58363.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85735.1406; val_chrom_access_recon_loss: 3637756.4667; val_global_loss: 16476646.6000; val_optim_loss: 16476646.6000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9768; val_auprc_score: 0.9690; val_best_acc_score: 0.9316; val_best_f1_score: 0.9337; train_kl_reg_loss: 51030.6121; train_edge_recon_loss: 2665118.5573; train_gene_expr_recon_loss: 9840443.5115; train_masked_gp_l1_reg_loss: 58126.2361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85738.5598; train_chrom_access_recon_loss: 3604467.2080; train_global_loss: 16304924.5649; train_optim_loss: 16304924.5649; val_kl_reg_loss: 49899.3503; val_edge_recon_loss: 2677548.9667; val_gene_expr_recon_loss: 9937782.3333; val_masked_gp_l1_reg_loss: 57894.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85313.3438; val_chrom_access_recon_loss: 3645034.7167; val_global_loss: 16453473.2667; val_optim_loss: 16453473.2667
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9735; val_auprc_score: 0.9619; val_best_acc_score: 0.9295; val_best_f1_score: 0.9319; train_kl_reg_loss: 51174.8100; train_edge_recon_loss: 2661817.8740; train_gene_expr_recon_loss: 9837326.0611; train_masked_gp_l1_reg_loss: 57609.2897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85588.3820; train_chrom_access_recon_loss: 3608367.3053; train_global_loss: 16301883.8244; train_optim_loss: 16301883.8244; val_kl_reg_loss: 48151.7299; val_edge_recon_loss: 2693870.6333; val_gene_expr_recon_loss: 9946017.0000; val_masked_gp_l1_reg_loss: 57472.4570; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86148.7656; val_chrom_access_recon_loss: 3639247.1667; val_global_loss: 16470907.5333; val_optim_loss: 16470907.5333
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9766; val_auprc_score: 0.9674; val_best_acc_score: 0.9332; val_best_f1_score: 0.9354; train_kl_reg_loss: 50752.3634; train_edge_recon_loss: 2658075.1298; train_gene_expr_recon_loss: 9836075.3817; train_masked_gp_l1_reg_loss: 57262.1681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85775.1023; train_chrom_access_recon_loss: 3608173.3092; train_global_loss: 16296113.3282; train_optim_loss: 16296113.3282; val_kl_reg_loss: 46448.0253; val_edge_recon_loss: 2673113.6167; val_gene_expr_recon_loss: 9996481.0000; val_masked_gp_l1_reg_loss: 56954.7656; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85490.3906; val_chrom_access_recon_loss: 3671090.7167; val_global_loss: 16529578.3333; val_optim_loss: 16529578.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9797; val_auprc_score: 0.9712; val_best_acc_score: 0.9361; val_best_f1_score: 0.9380; train_kl_reg_loss: 50330.7920; train_edge_recon_loss: 2657722.6355; train_gene_expr_recon_loss: 9812518.2748; train_masked_gp_l1_reg_loss: 56275.8921; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68420.9221; train_chrom_access_recon_loss: 3592537.0229; train_global_loss: 16237805.4504; train_optim_loss: 16237805.4504; val_kl_reg_loss: 49285.5398; val_edge_recon_loss: 2662015.8667; val_gene_expr_recon_loss: 9915756.2667; val_masked_gp_l1_reg_loss: 56077.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66455.1250; val_chrom_access_recon_loss: 3603671.9500; val_global_loss: 16353261.7333; val_optim_loss: 16353261.7333
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9774; val_auprc_score: 0.9704; val_best_acc_score: 0.9329; val_best_f1_score: 0.9353; train_kl_reg_loss: 51761.8537; train_edge_recon_loss: 2657864.0191; train_gene_expr_recon_loss: 9788750.9771; train_masked_gp_l1_reg_loss: 56005.4353; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66098.7901; train_chrom_access_recon_loss: 3582897.2882; train_global_loss: 16203378.4198; train_optim_loss: 16203378.4198; val_kl_reg_loss: 49681.8857; val_edge_recon_loss: 2664870.7833; val_gene_expr_recon_loss: 9952167.8667; val_masked_gp_l1_reg_loss: 55949.2891; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65816.8906; val_chrom_access_recon_loss: 3637236.6167; val_global_loss: 16425723.1333; val_optim_loss: 16425723.1333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9770; val_auprc_score: 0.9679; val_best_acc_score: 0.9364; val_best_f1_score: 0.9384; train_kl_reg_loss: 52605.7486; train_edge_recon_loss: 2654357.2214; train_gene_expr_recon_loss: 9801243.3130; train_masked_gp_l1_reg_loss: 55904.8553; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65523.9530; train_chrom_access_recon_loss: 3585936.7710; train_global_loss: 16215571.8855; train_optim_loss: 16215571.8855; val_kl_reg_loss: 50575.2477; val_edge_recon_loss: 2669693.2667; val_gene_expr_recon_loss: 9918170.0667; val_masked_gp_l1_reg_loss: 55860.6836; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65257.9883; val_chrom_access_recon_loss: 3617215.8333; val_global_loss: 16376773.5333; val_optim_loss: 16376773.5333
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9788; val_auprc_score: 0.9717; val_best_acc_score: 0.9365; val_best_f1_score: 0.9390; train_kl_reg_loss: 53049.6253; train_edge_recon_loss: 2656728.1240; train_gene_expr_recon_loss: 9792134.3511; train_masked_gp_l1_reg_loss: 55806.1207; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65028.5087; train_chrom_access_recon_loss: 3579492.0573; train_global_loss: 16202238.7634; train_optim_loss: 16202238.7634; val_kl_reg_loss: 51007.2971; val_edge_recon_loss: 2661388.2667; val_gene_expr_recon_loss: 9902441.0000; val_masked_gp_l1_reg_loss: 55768.5977; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64835.0234; val_chrom_access_recon_loss: 3615251.3833; val_global_loss: 16350692.0000; val_optim_loss: 16350692.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9775; val_auprc_score: 0.9662; val_best_acc_score: 0.9400; val_best_f1_score: 0.9417; train_kl_reg_loss: 53393.7609; train_edge_recon_loss: 2658403.0763; train_gene_expr_recon_loss: 9794753.8168; train_masked_gp_l1_reg_loss: 55720.5685; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64655.7094; train_chrom_access_recon_loss: 3583111.0649; train_global_loss: 16210038.0305; train_optim_loss: 16210038.0305; val_kl_reg_loss: 51234.2552; val_edge_recon_loss: 2655424.5333; val_gene_expr_recon_loss: 9882082.4667; val_masked_gp_l1_reg_loss: 55672.5742; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64465.4375; val_chrom_access_recon_loss: 3607255.6667; val_global_loss: 16316134.9333; val_optim_loss: 16316134.9333
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9766; val_auprc_score: 0.9688; val_best_acc_score: 0.9379; val_best_f1_score: 0.9398; train_kl_reg_loss: 53795.5639; train_edge_recon_loss: 2656080.5840; train_gene_expr_recon_loss: 9799554.8702; train_masked_gp_l1_reg_loss: 55636.5386; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64292.7049; train_chrom_access_recon_loss: 3584862.7595; train_global_loss: 16214222.9924; train_optim_loss: 16214222.9924; val_kl_reg_loss: 51609.1583; val_edge_recon_loss: 2665189.0833; val_gene_expr_recon_loss: 9926776.6667; val_masked_gp_l1_reg_loss: 55588.7539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64114.2188; val_chrom_access_recon_loss: 3618652.9167; val_global_loss: 16381930.8000; val_optim_loss: 16381930.8000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9778; val_auprc_score: 0.9679; val_best_acc_score: 0.9382; val_best_f1_score: 0.9402; train_kl_reg_loss: 53660.7329; train_edge_recon_loss: 2659290.8931; train_gene_expr_recon_loss: 9793780.7405; train_masked_gp_l1_reg_loss: 55545.6964; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63956.8468; train_chrom_access_recon_loss: 3581626.7691; train_global_loss: 16207861.6336; train_optim_loss: 16207861.6336; val_kl_reg_loss: 51711.9602; val_edge_recon_loss: 2664980.5500; val_gene_expr_recon_loss: 9951775.4667; val_masked_gp_l1_reg_loss: 55500.7773; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63720.9141; val_chrom_access_recon_loss: 3640150.6000; val_global_loss: 16427840.5333; val_optim_loss: 16427840.5333
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9750; val_auprc_score: 0.9664; val_best_acc_score: 0.9314; val_best_f1_score: 0.9338; train_kl_reg_loss: 53779.4306; train_edge_recon_loss: 2653844.1221; train_gene_expr_recon_loss: 9781538.6107; train_masked_gp_l1_reg_loss: 55465.4607; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63687.0783; train_chrom_access_recon_loss: 3580187.5744; train_global_loss: 16188502.2137; train_optim_loss: 16188502.2137; val_kl_reg_loss: 51541.1336; val_edge_recon_loss: 2690275.9000; val_gene_expr_recon_loss: 9865691.9333; val_masked_gp_l1_reg_loss: 55409.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63402.1406; val_chrom_access_recon_loss: 3619436.1167; val_global_loss: 16345756.2667; val_optim_loss: 16345756.2667
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9792; val_auprc_score: 0.9706; val_best_acc_score: 0.9406; val_best_f1_score: 0.9419; train_kl_reg_loss: 53829.9975; train_edge_recon_loss: 2663132.9618; train_gene_expr_recon_loss: 9765955.5267; train_masked_gp_l1_reg_loss: 55360.7766; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63301.0942; train_chrom_access_recon_loss: 3580750.1489; train_global_loss: 16182330.6412; train_optim_loss: 16182330.6412; val_kl_reg_loss: 52052.6224; val_edge_recon_loss: 2666995.7833; val_gene_expr_recon_loss: 9879364.7333; val_masked_gp_l1_reg_loss: 55306.1445; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63158.1055; val_chrom_access_recon_loss: 3617000.6667; val_global_loss: 16333877.6667; val_optim_loss: 16333877.6667

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9787; val_auprc_score: 0.9723; val_best_acc_score: 0.9356; val_best_f1_score: 0.9382; train_kl_reg_loss: 53777.1109; train_edge_recon_loss: 2650594.1947; train_gene_expr_recon_loss: 9758823.1679; train_masked_gp_l1_reg_loss: 55231.6289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61365.1736; train_chrom_access_recon_loss: 3578457.0821; train_global_loss: 16158248.3206; train_optim_loss: 16158248.3206; val_kl_reg_loss: 51950.7792; val_edge_recon_loss: 2671761.3667; val_gene_expr_recon_loss: 9882442.0667; val_masked_gp_l1_reg_loss: 55207.7852; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61163.6875; val_chrom_access_recon_loss: 3617412.4167; val_global_loss: 16339938.7333; val_optim_loss: 16339938.7333
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9782; val_auprc_score: 0.9712; val_best_acc_score: 0.9363; val_best_f1_score: 0.9382; train_kl_reg_loss: 53801.6628; train_edge_recon_loss: 2660235.9466; train_gene_expr_recon_loss: 9757173.6107; train_masked_gp_l1_reg_loss: 55196.9830; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61115.5636; train_chrom_access_recon_loss: 3576414.3836; train_global_loss: 16163938.1450; train_optim_loss: 16163938.1450; val_kl_reg_loss: 52000.1490; val_edge_recon_loss: 2672599.4500; val_gene_expr_recon_loss: 9934197.6000; val_masked_gp_l1_reg_loss: 55186.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61077.4688; val_chrom_access_recon_loss: 3628284.5833; val_global_loss: 16403344.8667; val_optim_loss: 16403344.8667
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9815; val_auprc_score: 0.9741; val_best_acc_score: 0.9427; val_best_f1_score: 0.9442; train_kl_reg_loss: 53846.6020; train_edge_recon_loss: 2656868.0210; train_gene_expr_recon_loss: 9756287.3588; train_masked_gp_l1_reg_loss: 55178.9120; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61040.8168; train_chrom_access_recon_loss: 3572244.7672; train_global_loss: 16155466.5267; train_optim_loss: 16155466.5267; val_kl_reg_loss: 51976.5146; val_edge_recon_loss: 2638674.3000; val_gene_expr_recon_loss: 9850619.8667; val_masked_gp_l1_reg_loss: 55171.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61008.1719; val_chrom_access_recon_loss: 3610661.1167; val_global_loss: 16268111.8000; val_optim_loss: 16268111.8000
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9765; val_auprc_score: 0.9664; val_best_acc_score: 0.9422; val_best_f1_score: 0.9440; train_kl_reg_loss: 54018.4770; train_edge_recon_loss: 2659702.6794; train_gene_expr_recon_loss: 9758708.3206; train_masked_gp_l1_reg_loss: 55165.1251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60989.7337; train_chrom_access_recon_loss: 3577495.2424; train_global_loss: 16166079.5344; train_optim_loss: 16166079.5344; val_kl_reg_loss: 51774.0461; val_edge_recon_loss: 2663303.6500; val_gene_expr_recon_loss: 9921379.0667; val_masked_gp_l1_reg_loss: 55156.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60959.8633; val_chrom_access_recon_loss: 3625576.0000; val_global_loss: 16378149.9333; val_optim_loss: 16378149.9333
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9786; val_auprc_score: 0.9699; val_best_acc_score: 0.9386; val_best_f1_score: 0.9407; train_kl_reg_loss: 53830.8575; train_edge_recon_loss: 2656867.2901; train_gene_expr_recon_loss: 9768561.7252; train_masked_gp_l1_reg_loss: 55149.5703; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60937.3983; train_chrom_access_recon_loss: 3577024.7824; train_global_loss: 16172371.6260; train_optim_loss: 16172371.6260; val_kl_reg_loss: 51692.1484; val_edge_recon_loss: 2648531.1667; val_gene_expr_recon_loss: 9866413.2667; val_masked_gp_l1_reg_loss: 55143.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60913.3672; val_chrom_access_recon_loss: 3604090.1500; val_global_loss: 16286782.6667; val_optim_loss: 16286782.6667
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9779; val_auprc_score: 0.9691; val_best_acc_score: 0.9379; val_best_f1_score: 0.9397; train_kl_reg_loss: 53888.9509; train_edge_recon_loss: 2649332.7233; train_gene_expr_recon_loss: 9765325.9924; train_masked_gp_l1_reg_loss: 55136.5576; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60898.7317; train_chrom_access_recon_loss: 3579587.3607; train_global_loss: 16164170.2366; train_optim_loss: 16164170.2366; val_kl_reg_loss: 51806.6451; val_edge_recon_loss: 2661977.3167; val_gene_expr_recon_loss: 9853038.7333; val_masked_gp_l1_reg_loss: 55129.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60880.0195; val_chrom_access_recon_loss: 3606484.8500; val_global_loss: 16289317.6000; val_optim_loss: 16289317.6000
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9773; val_auprc_score: 0.9700; val_best_acc_score: 0.9353; val_best_f1_score: 0.9374; train_kl_reg_loss: 53787.2238; train_edge_recon_loss: 2650006.9198; train_gene_expr_recon_loss: 9763872.9313; train_masked_gp_l1_reg_loss: 55123.5706; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60859.7186; train_chrom_access_recon_loss: 3578402.0725; train_global_loss: 16162052.4122; train_optim_loss: 16162052.4122; val_kl_reg_loss: 51794.9794; val_edge_recon_loss: 2666238.9500; val_gene_expr_recon_loss: 9873451.8000; val_masked_gp_l1_reg_loss: 55116.3477; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60839.7852; val_chrom_access_recon_loss: 3617953.7167; val_global_loss: 16325395.3333; val_optim_loss: 16325395.3333

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 60/400 |███-----------------| 15.0% val_auroc_score: 0.9799; val_auprc_score: 0.9732; val_best_acc_score: 0.9407; val_best_f1_score: 0.9421; train_kl_reg_loss: 53812.2982; train_edge_recon_loss: 2655957.6679; train_gene_expr_recon_loss: 9766951.5344; train_masked_gp_l1_reg_loss: 55109.0327; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60661.3252; train_chrom_access_recon_loss: 3577952.2443; train_global_loss: 16170444.1603; train_optim_loss: 16170444.1603; val_kl_reg_loss: 51509.3581; val_edge_recon_loss: 2655603.0333; val_gene_expr_recon_loss: 9882484.2000; val_masked_gp_l1_reg_loss: 55106.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60641.8438; val_chrom_access_recon_loss: 3611931.4000; val_global_loss: 16317277.1333; val_optim_loss: 16317277.1333
Epoch 61/400 |███-----------------| 15.2% val_auroc_score: 0.9783; val_auprc_score: 0.9704; val_best_acc_score: 0.9365; val_best_f1_score: 0.9382; train_kl_reg_loss: 53865.9482; train_edge_recon_loss: 2659955.0744; train_gene_expr_recon_loss: 9760775.4122; train_masked_gp_l1_reg_loss: 55105.5817; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60638.5580; train_chrom_access_recon_loss: 3577997.7901; train_global_loss: 16168338.3664; train_optim_loss: 16168338.3664; val_kl_reg_loss: 51822.7448; val_edge_recon_loss: 2682495.5167; val_gene_expr_recon_loss: 9886528.3333; val_masked_gp_l1_reg_loss: 55104.3984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60634.8398; val_chrom_access_recon_loss: 3605121.9833; val_global_loss: 16341707.6000; val_optim_loss: 16341707.6000
Epoch 62/400 |███-----------------| 15.5% val_auroc_score: 0.9780; val_auprc_score: 0.9716; val_best_acc_score: 0.9369; val_best_f1_score: 0.9390; train_kl_reg_loss: 53866.1702; train_edge_recon_loss: 2657942.7595; train_gene_expr_recon_loss: 9764862.0763; train_masked_gp_l1_reg_loss: 55103.4906; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60631.2497; train_chrom_access_recon_loss: 3580966.9599; train_global_loss: 16173372.7328; train_optim_loss: 16173372.7328; val_kl_reg_loss: 52042.7661; val_edge_recon_loss: 2672003.5000; val_gene_expr_recon_loss: 9879808.9333; val_masked_gp_l1_reg_loss: 55102.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60628.5820; val_chrom_access_recon_loss: 3614826.8500; val_global_loss: 16334412.9333; val_optim_loss: 16334412.9333
Epoch 63/400 |███-----------------| 15.8% val_auroc_score: 0.9801; val_auprc_score: 0.9715; val_best_acc_score: 0.9382; val_best_f1_score: 0.9405; train_kl_reg_loss: 53872.7196; train_edge_recon_loss: 2661081.3225; train_gene_expr_recon_loss: 9762330.8473; train_masked_gp_l1_reg_loss: 55101.4429; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 60625.9716; train_chrom_access_recon_loss: 3578190.9733; train_global_loss: 16171203.2672; train_optim_loss: 16171203.2672; val_kl_reg_loss: 51526.1398; val_edge_recon_loss: 2668143.4500; val_gene_expr_recon_loss: 9903710.7333; val_masked_gp_l1_reg_loss: 55100.5352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 60623.6445; val_chrom_access_recon_loss: 3605390.2667; val_global_loss: 16344495.6000; val_optim_loss: 16344495.6000

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 42 min 16 sec.
Using best model state, which was in epoch 55.

--- MODEL EVALUATION ---
val AUROC score: 0.9796
val AUPRC score: 0.9731
val best accuracy score: 0.9419
val best F1 score: 0.9432
val target rna MSE score: 2.4423
val source rna MSE score: 0.7379
val target atac MSE score: 0.5144
val source atac MSE score: 0.1537
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
