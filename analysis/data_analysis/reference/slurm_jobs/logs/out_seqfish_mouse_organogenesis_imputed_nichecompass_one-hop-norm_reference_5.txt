[True]
Run timestamp: 02082024_002349_5.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch3', 'batch4', 'batch5', 'batch6', '--n_neighbors', '12', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '0.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_5']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2444.
Number of gene programs after filtering and combining: 2109.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch4...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8574 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1958, n_latent: 1858, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1858, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1858, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 47311
Number of validation nodes: 5257
Number of training edges: 319410
Number of validation edges: 35490
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8569; val_auprc_score: 0.9690; val_best_acc_score: 0.8796; val_best_f1_score: 0.9322; train_kl_reg_loss: 126476.4668; train_edge_recon_loss: 1067738.6133; train_gene_expr_recon_loss: 43087810.7853; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 44282025.8205; train_optim_loss: 44282025.8205; val_kl_reg_loss: 87537.5934; val_edge_recon_loss: 1027163.1745; val_gene_expr_recon_loss: 38193713.8993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 39308414.5899; val_optim_loss: 39308414.5899
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.8912; val_auprc_score: 0.9769; val_best_acc_score: 0.8979; val_best_f1_score: 0.9417; train_kl_reg_loss: 86550.3183; train_edge_recon_loss: 943908.9629; train_gene_expr_recon_loss: 36096280.3750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 37126739.6474; train_optim_loss: 37126739.6474; val_kl_reg_loss: 80851.1510; val_edge_recon_loss: 914609.4919; val_gene_expr_recon_loss: 34386973.1799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 35382433.7554; val_optim_loss: 35382433.7554
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9137; val_auprc_score: 0.9814; val_best_acc_score: 0.9155; val_best_f1_score: 0.9515; train_kl_reg_loss: 75173.2376; train_edge_recon_loss: 882691.4668; train_gene_expr_recon_loss: 33264284.8077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 34222149.4567; train_optim_loss: 34222149.4567; val_kl_reg_loss: 68905.3199; val_edge_recon_loss: 868162.7599; val_gene_expr_recon_loss: 32336231.4101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 33273299.3957; val_optim_loss: 33273299.3957
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9207; val_auprc_score: 0.9820; val_best_acc_score: 0.9227; val_best_f1_score: 0.9555; train_kl_reg_loss: 63378.2042; train_edge_recon_loss: 857411.3631; train_gene_expr_recon_loss: 31688516.0529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 32609305.6202; train_optim_loss: 32609305.6202; val_kl_reg_loss: 57407.3126; val_edge_recon_loss: 864257.6335; val_gene_expr_recon_loss: 31164769.3525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 32086434.2878; val_optim_loss: 32086434.2878
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9297; val_auprc_score: 0.9845; val_best_acc_score: 0.9278; val_best_f1_score: 0.9587; train_kl_reg_loss: 53000.2327; train_edge_recon_loss: 837958.5355; train_gene_expr_recon_loss: 30786423.8109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31677382.5721; train_optim_loss: 31677382.5721; val_kl_reg_loss: 49363.9465; val_edge_recon_loss: 826393.4029; val_gene_expr_recon_loss: 30489431.0072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 31365188.3453; val_optim_loss: 31365188.3453
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9369; val_auprc_score: 0.9861; val_best_acc_score: 0.9315; val_best_f1_score: 0.9606; train_kl_reg_loss: 45850.9628; train_edge_recon_loss: 823908.8185; train_gene_expr_recon_loss: 30281206.9423; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 31150966.7099; train_optim_loss: 31150966.7099; val_kl_reg_loss: 43081.8739; val_edge_recon_loss: 821355.2572; val_gene_expr_recon_loss: 30108908.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30973345.1367; val_optim_loss: 30973345.1367
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9414; val_auprc_score: 0.9872; val_best_acc_score: 0.9322; val_best_f1_score: 0.9610; train_kl_reg_loss: 40549.5107; train_edge_recon_loss: 821111.3009; train_gene_expr_recon_loss: 30002040.5881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30863701.4022; train_optim_loss: 30863701.4022; val_kl_reg_loss: 38494.2247; val_edge_recon_loss: 825631.0445; val_gene_expr_recon_loss: 29886131.4820; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30750256.8201; val_optim_loss: 30750256.8201
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9459; val_auprc_score: 0.9884; val_best_acc_score: 0.9371; val_best_f1_score: 0.9637; train_kl_reg_loss: 36875.7656; train_edge_recon_loss: 809783.9895; train_gene_expr_recon_loss: 29830087.8109; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30676747.5609; train_optim_loss: 30676747.5609; val_kl_reg_loss: 34895.5894; val_edge_recon_loss: 806667.1515; val_gene_expr_recon_loss: 29772252.9353; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30613815.7554; val_optim_loss: 30613815.7554
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9473; val_auprc_score: 0.9880; val_best_acc_score: 0.9390; val_best_f1_score: 0.9647; train_kl_reg_loss: 33858.6481; train_edge_recon_loss: 805314.3698; train_gene_expr_recon_loss: 29729068.1763; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30568241.1939; train_optim_loss: 30568241.1939; val_kl_reg_loss: 32660.4485; val_edge_recon_loss: 820390.0917; val_gene_expr_recon_loss: 29693286.7770; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30546337.3813; val_optim_loss: 30546337.3813
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9521; val_auprc_score: 0.9894; val_best_acc_score: 0.9402; val_best_f1_score: 0.9653; train_kl_reg_loss: 31423.4114; train_edge_recon_loss: 798477.9059; train_gene_expr_recon_loss: 29671186.9792; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30501088.2821; train_optim_loss: 30501088.2821; val_kl_reg_loss: 30150.3318; val_edge_recon_loss: 809362.4231; val_gene_expr_recon_loss: 29628437.0072; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30467949.7842; val_optim_loss: 30467949.7842
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9523; val_auprc_score: 0.9893; val_best_acc_score: 0.9420; val_best_f1_score: 0.9665; train_kl_reg_loss: 29381.4181; train_edge_recon_loss: 805042.6738; train_gene_expr_recon_loss: 29623850.6090; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30458274.6987; train_optim_loss: 30458274.6987; val_kl_reg_loss: 28574.0274; val_edge_recon_loss: 798936.1380; val_gene_expr_recon_loss: 29622596.4604; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30450106.6331; val_optim_loss: 30450106.6331
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9511; val_auprc_score: 0.9887; val_best_acc_score: 0.9417; val_best_f1_score: 0.9661; train_kl_reg_loss: 27575.0670; train_edge_recon_loss: 793658.4237; train_gene_expr_recon_loss: 29604105.9535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30425339.4503; train_optim_loss: 30425339.4503; val_kl_reg_loss: 26537.1836; val_edge_recon_loss: 811679.7379; val_gene_expr_recon_loss: 29581392.0144; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30419608.9928; val_optim_loss: 30419608.9928
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9496; val_auprc_score: 0.9890; val_best_acc_score: 0.9401; val_best_f1_score: 0.9655; train_kl_reg_loss: 26092.7551; train_edge_recon_loss: 793892.7078; train_gene_expr_recon_loss: 29579547.0497; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30399532.4663; train_optim_loss: 30399532.4663; val_kl_reg_loss: 25321.1465; val_edge_recon_loss: 800123.2513; val_gene_expr_recon_loss: 29565055.4532; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30390499.8705; val_optim_loss: 30390499.8705
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9523; val_auprc_score: 0.9894; val_best_acc_score: 0.9401; val_best_f1_score: 0.9652; train_kl_reg_loss: 24857.6057; train_edge_recon_loss: 795062.7520; train_gene_expr_recon_loss: 29562228.0849; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30382148.4295; train_optim_loss: 30382148.4295; val_kl_reg_loss: 24096.3862; val_edge_recon_loss: 814011.5423; val_gene_expr_recon_loss: 29561270.3309; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30399378.2014; val_optim_loss: 30399378.2014
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9520; val_auprc_score: 0.9894; val_best_acc_score: 0.9421; val_best_f1_score: 0.9665; train_kl_reg_loss: 23763.0025; train_edge_recon_loss: 788687.8772; train_gene_expr_recon_loss: 29544050.4359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30356501.3237; train_optim_loss: 30356501.3237; val_kl_reg_loss: 23404.1422; val_edge_recon_loss: 793246.6533; val_gene_expr_recon_loss: 29547001.8273; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30363652.6475; val_optim_loss: 30363652.6475
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9507; val_auprc_score: 0.9889; val_best_acc_score: 0.9397; val_best_f1_score: 0.9652; train_kl_reg_loss: 22858.6572; train_edge_recon_loss: 793376.0366; train_gene_expr_recon_loss: 29532881.1891; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30349115.8878; train_optim_loss: 30349115.8878; val_kl_reg_loss: 22188.0631; val_edge_recon_loss: 804980.4168; val_gene_expr_recon_loss: 29553752.6906; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30380921.2662; val_optim_loss: 30380921.2662
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9563; val_auprc_score: 0.9904; val_best_acc_score: 0.9426; val_best_f1_score: 0.9668; train_kl_reg_loss: 22111.5014; train_edge_recon_loss: 786949.7175; train_gene_expr_recon_loss: 29524669.8750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30333731.0962; train_optim_loss: 30333731.0962; val_kl_reg_loss: 22068.8355; val_edge_recon_loss: 797681.4290; val_gene_expr_recon_loss: 29516780.9784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30336531.3237; val_optim_loss: 30336531.3237
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9539; val_auprc_score: 0.9897; val_best_acc_score: 0.9418; val_best_f1_score: 0.9663; train_kl_reg_loss: 21541.1317; train_edge_recon_loss: 786460.4624; train_gene_expr_recon_loss: 29520082.6587; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30328084.2388; train_optim_loss: 30328084.2388; val_kl_reg_loss: 21157.7654; val_edge_recon_loss: 803026.9780; val_gene_expr_recon_loss: 29512237.6259; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30336422.4029; val_optim_loss: 30336422.4029
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9516; val_auprc_score: 0.9895; val_best_acc_score: 0.9421; val_best_f1_score: 0.9667; train_kl_reg_loss: 20934.7407; train_edge_recon_loss: 785621.9129; train_gene_expr_recon_loss: 29509784.1410; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30316340.7901; train_optim_loss: 30316340.7901; val_kl_reg_loss: 20463.1645; val_edge_recon_loss: 783013.0034; val_gene_expr_recon_loss: 29513911.1799; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30317387.3669; val_optim_loss: 30317387.3669
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9564; val_auprc_score: 0.9904; val_best_acc_score: 0.9432; val_best_f1_score: 0.9672; train_kl_reg_loss: 20474.1063; train_edge_recon_loss: 787376.3933; train_gene_expr_recon_loss: 29500435.6859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30308286.1907; train_optim_loss: 30308286.1907; val_kl_reg_loss: 20025.5446; val_edge_recon_loss: 798094.8404; val_gene_expr_recon_loss: 29492652.5180; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30310772.8058; val_optim_loss: 30310772.8058
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9538; val_auprc_score: 0.9894; val_best_acc_score: 0.9439; val_best_f1_score: 0.9676; train_kl_reg_loss: 20091.4135; train_edge_recon_loss: 789032.5170; train_gene_expr_recon_loss: 29498686.4167; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30307810.3686; train_optim_loss: 30307810.3686; val_kl_reg_loss: 20339.9897; val_edge_recon_loss: 795085.0238; val_gene_expr_recon_loss: 29496470.2014; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30311895.1799; val_optim_loss: 30311895.1799
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9549; val_auprc_score: 0.9896; val_best_acc_score: 0.9444; val_best_f1_score: 0.9677; train_kl_reg_loss: 19696.7029; train_edge_recon_loss: 787824.5482; train_gene_expr_recon_loss: 29489993.5721; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30297514.8285; train_optim_loss: 30297514.8285; val_kl_reg_loss: 19765.6131; val_edge_recon_loss: 800890.2284; val_gene_expr_recon_loss: 29493296.4892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30313952.3885; val_optim_loss: 30313952.3885
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9580; val_auprc_score: 0.9904; val_best_acc_score: 0.9457; val_best_f1_score: 0.9685; train_kl_reg_loss: 19367.4005; train_edge_recon_loss: 783505.0567; train_gene_expr_recon_loss: 29486594.5897; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30289467.0240; train_optim_loss: 30289467.0240; val_kl_reg_loss: 19345.6957; val_edge_recon_loss: 800648.8750; val_gene_expr_recon_loss: 29466862.9640; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30286857.4676; val_optim_loss: 30286857.4676
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9589; val_auprc_score: 0.9906; val_best_acc_score: 0.9487; val_best_f1_score: 0.9703; train_kl_reg_loss: 19116.8969; train_edge_recon_loss: 786915.7272; train_gene_expr_recon_loss: 29482131.4904; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30288164.1042; train_optim_loss: 30288164.1042; val_kl_reg_loss: 19248.0889; val_edge_recon_loss: 791128.7050; val_gene_expr_recon_loss: 29492033.4101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30302410.2302; val_optim_loss: 30302410.2302
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9566; val_auprc_score: 0.9905; val_best_acc_score: 0.9461; val_best_f1_score: 0.9687; train_kl_reg_loss: 18892.3557; train_edge_recon_loss: 785919.6083; train_gene_expr_recon_loss: 29476765.5192; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30281577.4920; train_optim_loss: 30281577.4920; val_kl_reg_loss: 18714.6325; val_edge_recon_loss: 789549.5710; val_gene_expr_recon_loss: 29485030.7194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30293294.8201; val_optim_loss: 30293294.8201
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9581; val_auprc_score: 0.9899; val_best_acc_score: 0.9488; val_best_f1_score: 0.9704; train_kl_reg_loss: 17459.0206; train_edge_recon_loss: 785502.0069; train_gene_expr_recon_loss: 29446430.3638; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30249391.4054; train_optim_loss: 30249391.4054; val_kl_reg_loss: 15820.6499; val_edge_recon_loss: 792591.3790; val_gene_expr_recon_loss: 29451353.5252; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30259765.6115; val_optim_loss: 30259765.6115
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9555; val_auprc_score: 0.9899; val_best_acc_score: 0.9471; val_best_f1_score: 0.9696; train_kl_reg_loss: 17124.9321; train_edge_recon_loss: 787536.4706; train_gene_expr_recon_loss: 29440167.1058; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30244828.5353; train_optim_loss: 30244828.5353; val_kl_reg_loss: 15501.2022; val_edge_recon_loss: 780594.5679; val_gene_expr_recon_loss: 29445456.1727; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30241551.9424; val_optim_loss: 30241551.9424
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9537; val_auprc_score: 0.9893; val_best_acc_score: 0.9448; val_best_f1_score: 0.9680; train_kl_reg_loss: 16730.0258; train_edge_recon_loss: 785780.4548; train_gene_expr_recon_loss: 29437980.6522; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30240491.1250; train_optim_loss: 30240491.1250; val_kl_reg_loss: 15447.3280; val_edge_recon_loss: 792607.8363; val_gene_expr_recon_loss: 29448260.7050; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30256315.8993; val_optim_loss: 30256315.8993
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9588; val_auprc_score: 0.9908; val_best_acc_score: 0.9475; val_best_f1_score: 0.9696; train_kl_reg_loss: 16374.9576; train_edge_recon_loss: 786259.7477; train_gene_expr_recon_loss: 29438245.6186; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30240880.3317; train_optim_loss: 30240880.3317; val_kl_reg_loss: 15379.5419; val_edge_recon_loss: 791974.0863; val_gene_expr_recon_loss: 29462570.7194; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30269924.3165; val_optim_loss: 30269924.3165
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9584; val_auprc_score: 0.9907; val_best_acc_score: 0.9483; val_best_f1_score: 0.9701; train_kl_reg_loss: 16133.0932; train_edge_recon_loss: 783627.3474; train_gene_expr_recon_loss: 29430121.2756; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30229881.7147; train_optim_loss: 30229881.7147; val_kl_reg_loss: 15691.1071; val_edge_recon_loss: 787944.6839; val_gene_expr_recon_loss: 29430123.9137; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30233759.6547; val_optim_loss: 30233759.6547
Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9580; val_auprc_score: 0.9897; val_best_acc_score: 0.9502; val_best_f1_score: 0.9711; train_kl_reg_loss: 15961.0383; train_edge_recon_loss: 778126.7612; train_gene_expr_recon_loss: 29429599.3221; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30223687.0994; train_optim_loss: 30223687.0994; val_kl_reg_loss: 15424.3485; val_edge_recon_loss: 792740.7959; val_gene_expr_recon_loss: 29426097.1079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30234262.1727; val_optim_loss: 30234262.1727
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9588; val_auprc_score: 0.9903; val_best_acc_score: 0.9480; val_best_f1_score: 0.9698; train_kl_reg_loss: 15802.3408; train_edge_recon_loss: 779490.1837; train_gene_expr_recon_loss: 29421918.3814; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30217210.8958; train_optim_loss: 30217210.8958; val_kl_reg_loss: 15496.8883; val_edge_recon_loss: 798444.1897; val_gene_expr_recon_loss: 29419644.5899; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30233585.6115; val_optim_loss: 30233585.6115
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9612; val_auprc_score: 0.9914; val_best_acc_score: 0.9505; val_best_f1_score: 0.9713; train_kl_reg_loss: 15667.5317; train_edge_recon_loss: 780243.7504; train_gene_expr_recon_loss: 29426069.6234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30221980.9103; train_optim_loss: 30221980.9103; val_kl_reg_loss: 15303.1178; val_edge_recon_loss: 789171.6432; val_gene_expr_recon_loss: 29433052.1871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30237526.9496; val_optim_loss: 30237526.9496
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9625; val_auprc_score: 0.9918; val_best_acc_score: 0.9513; val_best_f1_score: 0.9718; train_kl_reg_loss: 15619.8872; train_edge_recon_loss: 782633.2598; train_gene_expr_recon_loss: 29419238.1490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30217491.2933; train_optim_loss: 30217491.2933; val_kl_reg_loss: 15027.8442; val_edge_recon_loss: 777249.3147; val_gene_expr_recon_loss: 29416726.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30209003.2086; val_optim_loss: 30209003.2086
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9601; val_auprc_score: 0.9909; val_best_acc_score: 0.9499; val_best_f1_score: 0.9711; train_kl_reg_loss: 15500.1521; train_edge_recon_loss: 776115.5001; train_gene_expr_recon_loss: 29421557.9359; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30213173.6026; train_optim_loss: 30213173.6026; val_kl_reg_loss: 15160.5361; val_edge_recon_loss: 784678.7190; val_gene_expr_recon_loss: 29412682.8201; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30212522.0719; val_optim_loss: 30212522.0719
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9619; val_auprc_score: 0.9914; val_best_acc_score: 0.9531; val_best_f1_score: 0.9727; train_kl_reg_loss: 15411.7844; train_edge_recon_loss: 781840.0841; train_gene_expr_recon_loss: 29418721.6859; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30215973.5609; train_optim_loss: 30215973.5609; val_kl_reg_loss: 15197.9143; val_edge_recon_loss: 785895.1673; val_gene_expr_recon_loss: 29425365.4676; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30226458.6043; val_optim_loss: 30226458.6043
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9624; val_auprc_score: 0.9913; val_best_acc_score: 0.9508; val_best_f1_score: 0.9714; train_kl_reg_loss: 15302.4185; train_edge_recon_loss: 778457.1763; train_gene_expr_recon_loss: 29415314.4647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30209074.0817; train_optim_loss: 30209074.0817; val_kl_reg_loss: 14921.9414; val_edge_recon_loss: 789558.8858; val_gene_expr_recon_loss: 29432913.2950; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30237394.1295; val_optim_loss: 30237394.1295
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9614; val_auprc_score: 0.9914; val_best_acc_score: 0.9507; val_best_f1_score: 0.9715; train_kl_reg_loss: 15269.3151; train_edge_recon_loss: 778900.1878; train_gene_expr_recon_loss: 29410310.4327; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30204479.9215; train_optim_loss: 30204479.9215; val_kl_reg_loss: 15138.0499; val_edge_recon_loss: 785733.0411; val_gene_expr_recon_loss: 29451237.2806; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30252108.3741; val_optim_loss: 30252108.3741

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9607; val_auprc_score: 0.9912; val_best_acc_score: 0.9509; val_best_f1_score: 0.9715; train_kl_reg_loss: 15244.4244; train_edge_recon_loss: 777027.2950; train_gene_expr_recon_loss: 29357106.1490; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30149377.8830; train_optim_loss: 30149377.8830; val_kl_reg_loss: 15087.4781; val_edge_recon_loss: 783909.1871; val_gene_expr_recon_loss: 29366880.4460; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30165877.1367; val_optim_loss: 30165877.1367
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9615; val_auprc_score: 0.9910; val_best_acc_score: 0.9511; val_best_f1_score: 0.9716; train_kl_reg_loss: 15254.3783; train_edge_recon_loss: 777780.8923; train_gene_expr_recon_loss: 29356152.3782; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30149187.6426; train_optim_loss: 30149187.6426; val_kl_reg_loss: 15101.1442; val_edge_recon_loss: 793773.6628; val_gene_expr_recon_loss: 29352820.2734; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30161695.0072; val_optim_loss: 30161695.0072
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9597; val_auprc_score: 0.9908; val_best_acc_score: 0.9511; val_best_f1_score: 0.9717; train_kl_reg_loss: 15295.6701; train_edge_recon_loss: 779215.8395; train_gene_expr_recon_loss: 29354052.3702; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30148563.8926; train_optim_loss: 30148563.8926; val_kl_reg_loss: 15102.3223; val_edge_recon_loss: 786797.0636; val_gene_expr_recon_loss: 29350213.7986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30152113.0791; val_optim_loss: 30152113.0791
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9612; val_auprc_score: 0.9910; val_best_acc_score: 0.9526; val_best_f1_score: 0.9726; train_kl_reg_loss: 15297.8486; train_edge_recon_loss: 784038.4782; train_gene_expr_recon_loss: 29352137.2260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30151473.5497; train_optim_loss: 30151473.5497; val_kl_reg_loss: 15144.5301; val_edge_recon_loss: 781042.9627; val_gene_expr_recon_loss: 29357938.8633; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30154126.3741; val_optim_loss: 30154126.3741
Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9603; val_auprc_score: 0.9909; val_best_acc_score: 0.9524; val_best_f1_score: 0.9724; train_kl_reg_loss: 15336.7358; train_edge_recon_loss: 783365.4205; train_gene_expr_recon_loss: 29351227.4519; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30149929.5817; train_optim_loss: 30149929.5817; val_kl_reg_loss: 15223.6818; val_edge_recon_loss: 785198.5953; val_gene_expr_recon_loss: 29367630.5612; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30168052.8058; val_optim_loss: 30168052.8058
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9607; val_auprc_score: 0.9910; val_best_acc_score: 0.9523; val_best_f1_score: 0.9723; train_kl_reg_loss: 15359.9771; train_edge_recon_loss: 774438.7862; train_gene_expr_recon_loss: 29350761.9776; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30140560.7308; train_optim_loss: 30140560.7308; val_kl_reg_loss: 15209.6053; val_edge_recon_loss: 787709.5569; val_gene_expr_recon_loss: 29360588.6475; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30163507.7266; val_optim_loss: 30163507.7266
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9632; val_auprc_score: 0.9918; val_best_acc_score: 0.9526; val_best_f1_score: 0.9724; train_kl_reg_loss: 15374.9189; train_edge_recon_loss: 774370.0913; train_gene_expr_recon_loss: 29351127.5609; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30140872.5625; train_optim_loss: 30140872.5625; val_kl_reg_loss: 15214.5164; val_edge_recon_loss: 788651.9366; val_gene_expr_recon_loss: 29355106.9209; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30158973.3525; val_optim_loss: 30158973.3525

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9608; val_auprc_score: 0.9906; val_best_acc_score: 0.9502; val_best_f1_score: 0.9710; train_kl_reg_loss: 15388.9546; train_edge_recon_loss: 773587.8466; train_gene_expr_recon_loss: 29344780.4808; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30133757.2837; train_optim_loss: 30133757.2837; val_kl_reg_loss: 15231.8827; val_edge_recon_loss: 795179.5193; val_gene_expr_recon_loss: 29354720.5324; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30165131.7986; val_optim_loss: 30165131.7986
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9637; val_auprc_score: 0.9916; val_best_acc_score: 0.9516; val_best_f1_score: 0.9720; train_kl_reg_loss: 15388.2382; train_edge_recon_loss: 779094.2074; train_gene_expr_recon_loss: 29344177.5865; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30138660.0449; train_optim_loss: 30138660.0449; val_kl_reg_loss: 15199.5783; val_edge_recon_loss: 787719.3543; val_gene_expr_recon_loss: 29348061.0216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30150979.8705; val_optim_loss: 30150979.8705
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9622; val_auprc_score: 0.9913; val_best_acc_score: 0.9513; val_best_f1_score: 0.9718; train_kl_reg_loss: 15393.4779; train_edge_recon_loss: 776932.9448; train_gene_expr_recon_loss: 29345404.5321; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30137730.9615; train_optim_loss: 30137730.9615; val_kl_reg_loss: 15234.0644; val_edge_recon_loss: 777921.9530; val_gene_expr_recon_loss: 29362782.0288; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30155938.0719; val_optim_loss: 30155938.0719
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9608; val_auprc_score: 0.9912; val_best_acc_score: 0.9527; val_best_f1_score: 0.9726; train_kl_reg_loss: 15399.9341; train_edge_recon_loss: 775191.0135; train_gene_expr_recon_loss: 29345026.8125; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30135617.7580; train_optim_loss: 30135617.7580; val_kl_reg_loss: 15198.8420; val_edge_recon_loss: 774788.6524; val_gene_expr_recon_loss: 29359147.1079; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30149134.5612; val_optim_loss: 30149134.5612
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9615; val_auprc_score: 0.9911; val_best_acc_score: 0.9514; val_best_f1_score: 0.9719; train_kl_reg_loss: 15402.6160; train_edge_recon_loss: 777645.9058; train_gene_expr_recon_loss: 29346631.4535; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30139680.0160; train_optim_loss: 30139680.0160; val_kl_reg_loss: 15209.2191; val_edge_recon_loss: 781135.0308; val_gene_expr_recon_loss: 29355076.0576; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30151420.2734; val_optim_loss: 30151420.2734
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9618; val_auprc_score: 0.9915; val_best_acc_score: 0.9522; val_best_f1_score: 0.9723; train_kl_reg_loss: 15402.0857; train_edge_recon_loss: 780736.2275; train_gene_expr_recon_loss: 29343137.6843; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30139275.9840; train_optim_loss: 30139275.9840; val_kl_reg_loss: 15204.7972; val_edge_recon_loss: 774088.2788; val_gene_expr_recon_loss: 29343849.7986; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30133142.9353; val_optim_loss: 30133142.9353
Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9612; val_auprc_score: 0.9910; val_best_acc_score: 0.9511; val_best_f1_score: 0.9715; train_kl_reg_loss: 15408.7100; train_edge_recon_loss: 776470.9428; train_gene_expr_recon_loss: 29346675.7917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30138555.4439; train_optim_loss: 30138555.4439; val_kl_reg_loss: 15241.0422; val_edge_recon_loss: 788521.3085; val_gene_expr_recon_loss: 29361992.8777; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30165755.2230; val_optim_loss: 30165755.2230
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9604; val_auprc_score: 0.9908; val_best_acc_score: 0.9511; val_best_f1_score: 0.9717; train_kl_reg_loss: 15413.7799; train_edge_recon_loss: 776758.6862; train_gene_expr_recon_loss: 29348327.7067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30140500.1747; train_optim_loss: 30140500.1747; val_kl_reg_loss: 15262.7979; val_edge_recon_loss: 780391.6295; val_gene_expr_recon_loss: 29341802.2878; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30137456.6619; val_optim_loss: 30137456.6619
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9626; val_auprc_score: 0.9916; val_best_acc_score: 0.9528; val_best_f1_score: 0.9726; train_kl_reg_loss: 15413.4235; train_edge_recon_loss: 774000.5766; train_gene_expr_recon_loss: 29348510.3574; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30137924.3830; train_optim_loss: 30137924.3830; val_kl_reg_loss: 15206.1133; val_edge_recon_loss: 782578.2671; val_gene_expr_recon_loss: 29354986.6763; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30152771.0791; val_optim_loss: 30152771.0791
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9628; val_auprc_score: 0.9914; val_best_acc_score: 0.9529; val_best_f1_score: 0.9726; train_kl_reg_loss: 15421.5696; train_edge_recon_loss: 774201.5886; train_gene_expr_recon_loss: 29341306.5465; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30130929.6907; train_optim_loss: 30130929.6907; val_kl_reg_loss: 15217.3631; val_edge_recon_loss: 787142.7010; val_gene_expr_recon_loss: 29354789.6835; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30157149.6259; val_optim_loss: 30157149.6259

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9607; val_auprc_score: 0.9911; val_best_acc_score: 0.9486; val_best_f1_score: 0.9702; train_kl_reg_loss: 15417.1623; train_edge_recon_loss: 775367.1310; train_gene_expr_recon_loss: 29340276.4343; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30131060.7212; train_optim_loss: 30131060.7212; val_kl_reg_loss: 15227.3335; val_edge_recon_loss: 798137.7986; val_gene_expr_recon_loss: 29356589.2230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30169954.3165; val_optim_loss: 30169954.3165
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9635; val_auprc_score: 0.9920; val_best_acc_score: 0.9546; val_best_f1_score: 0.9738; train_kl_reg_loss: 15412.3182; train_edge_recon_loss: 777768.6007; train_gene_expr_recon_loss: 29343913.7163; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30137094.6490; train_optim_loss: 30137094.6490; val_kl_reg_loss: 15193.8912; val_edge_recon_loss: 761336.5724; val_gene_expr_recon_loss: 29353468.4892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30129998.9928; val_optim_loss: 30129998.9928
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9577; val_auprc_score: 0.9895; val_best_acc_score: 0.9502; val_best_f1_score: 0.9710; train_kl_reg_loss: 15411.2121; train_edge_recon_loss: 777052.9922; train_gene_expr_recon_loss: 29342150.9567; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30134615.1651; train_optim_loss: 30134615.1651; val_kl_reg_loss: 15221.9441; val_edge_recon_loss: 794856.4141; val_gene_expr_recon_loss: 29351075.5683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30161153.9568; val_optim_loss: 30161153.9568
Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9618; val_auprc_score: 0.9913; val_best_acc_score: 0.9531; val_best_f1_score: 0.9728; train_kl_reg_loss: 15421.5474; train_edge_recon_loss: 777158.5321; train_gene_expr_recon_loss: 29346328.6170; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30138908.6715; train_optim_loss: 30138908.6715; val_kl_reg_loss: 15216.9191; val_edge_recon_loss: 775840.0387; val_gene_expr_recon_loss: 29339404.6043; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30130461.5827; val_optim_loss: 30130461.5827
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9604; val_auprc_score: 0.9905; val_best_acc_score: 0.9520; val_best_f1_score: 0.9720; train_kl_reg_loss: 15415.8020; train_edge_recon_loss: 778947.9616; train_gene_expr_recon_loss: 29346106.0529; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30140469.8205; train_optim_loss: 30140469.8205; val_kl_reg_loss: 15192.3049; val_edge_recon_loss: 809721.3156; val_gene_expr_recon_loss: 29347757.3525; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30172671.0216; val_optim_loss: 30172671.0216
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9605; val_auprc_score: 0.9908; val_best_acc_score: 0.9515; val_best_f1_score: 0.9719; train_kl_reg_loss: 15421.3328; train_edge_recon_loss: 775212.0412; train_gene_expr_recon_loss: 29339928.8205; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30130562.1971; train_optim_loss: 30130562.1971; val_kl_reg_loss: 15234.6783; val_edge_recon_loss: 788624.4415; val_gene_expr_recon_loss: 29350602.4892; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30154461.6978; val_optim_loss: 30154461.6978

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9629; val_auprc_score: 0.9915; val_best_acc_score: 0.9524; val_best_f1_score: 0.9724; train_kl_reg_loss: 15415.1225; train_edge_recon_loss: 779809.1893; train_gene_expr_recon_loss: 29342003.3269; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30137227.6234; train_optim_loss: 30137227.6234; val_kl_reg_loss: 15223.4198; val_edge_recon_loss: 786128.7963; val_gene_expr_recon_loss: 29364062.1871; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30165414.3741; val_optim_loss: 30165414.3741
Epoch 63/100 |████████████--------| 63.0% val_auroc_score: 0.9585; val_auprc_score: 0.9905; val_best_acc_score: 0.9499; val_best_f1_score: 0.9709; train_kl_reg_loss: 15420.1456; train_edge_recon_loss: 779763.9367; train_gene_expr_recon_loss: 29341652.9984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30136837.0705; train_optim_loss: 30136837.0705; val_kl_reg_loss: 15216.0735; val_edge_recon_loss: 794893.4098; val_gene_expr_recon_loss: 29348223.5971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30158333.0935; val_optim_loss: 30158333.0935
Epoch 64/100 |████████████--------| 64.0% val_auroc_score: 0.9609; val_auprc_score: 0.9908; val_best_acc_score: 0.9519; val_best_f1_score: 0.9720; train_kl_reg_loss: 15417.3570; train_edge_recon_loss: 779353.8906; train_gene_expr_recon_loss: 29341134.4215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30135905.6731; train_optim_loss: 30135905.6731; val_kl_reg_loss: 15224.8019; val_edge_recon_loss: 797854.7102; val_gene_expr_recon_loss: 29364339.2230; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30177418.7050; val_optim_loss: 30177418.7050
Epoch 65/100 |█████████████-------| 65.0% val_auroc_score: 0.9603; val_auprc_score: 0.9910; val_best_acc_score: 0.9526; val_best_f1_score: 0.9727; train_kl_reg_loss: 15418.5660; train_edge_recon_loss: 776504.2810; train_gene_expr_recon_loss: 29345615.5737; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 0.0000; train_global_loss: 30137538.4071; train_optim_loss: 30137538.4071; val_kl_reg_loss: 15244.5798; val_edge_recon_loss: 776921.4328; val_gene_expr_recon_loss: 29347534.9784; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 0.0000; val_global_loss: 30139701.0360; val_optim_loss: 30139701.0360

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 414 min 41 sec.
Using best model state, which was in epoch 57.

--- MODEL EVALUATION ---
val AUROC score: 0.9652
val AUPRC score: 0.9918
val best accuracy score: 0.9536
val best F1 score: 0.9730
val target rna MSE score: 1.2242
val source rna MSE score: 0.6490
Val cat covariate0 mean sim diff: -0.0001

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
