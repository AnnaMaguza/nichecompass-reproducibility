[True]
Run timestamp: 10102023_105614_241.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '5000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_241']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 5000 peaks after filtering spatially variable peaks.
Keeping 816 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 3575, n_cat_covariates_embed_input: 0, n_hidden: 2265, n_latent: 2165, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2759
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2165, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 816

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 33399
Number of validation edges: 3711
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.7691; val_auprc_score: 0.7899; val_best_acc_score: 0.5768; val_best_f1_score: 0.6981; train_kl_reg_loss: 72192.1225; train_edge_recon_loss: 746370.8626; train_gene_expr_recon_loss: 22055124.0000; train_masked_gp_l1_reg_loss: 40675.1888; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2848924.4609; train_chrom_access_recon_loss: 4734220.2023; train_global_loss: 30497506.7786; train_optim_loss: 30497506.7786; val_kl_reg_loss: 78320.4198; val_edge_recon_loss: 812196.0083; val_gene_expr_recon_loss: 21133992.4000; val_masked_gp_l1_reg_loss: 43899.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 1025351.9375; val_chrom_access_recon_loss: 4638371.8667; val_global_loss: 27732132.8000; val_optim_loss: 27732132.8000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.8654; val_auprc_score: 0.8707; val_best_acc_score: 0.7858; val_best_f1_score: 0.7659; train_kl_reg_loss: 71664.9967; train_edge_recon_loss: 729491.4699; train_gene_expr_recon_loss: 20846381.7863; train_masked_gp_l1_reg_loss: 45251.3115; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 548921.6100; train_chrom_access_recon_loss: 4576653.3588; train_global_loss: 26818364.7634; train_optim_loss: 26818364.7634; val_kl_reg_loss: 64986.2617; val_edge_recon_loss: 786226.7458; val_gene_expr_recon_loss: 20777342.6667; val_masked_gp_l1_reg_loss: 47101.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 299055.9688; val_chrom_access_recon_loss: 4581720.5833; val_global_loss: 26556434.2667; val_optim_loss: 26556434.2667
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9116; val_auprc_score: 0.9019; val_best_acc_score: 0.8289; val_best_f1_score: 0.8388; train_kl_reg_loss: 62570.6751; train_edge_recon_loss: 694111.5420; train_gene_expr_recon_loss: 20585918.1374; train_masked_gp_l1_reg_loss: 48595.7527; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 227010.5122; train_chrom_access_recon_loss: 4531804.1813; train_global_loss: 26150010.7634; train_optim_loss: 26150010.7634; val_kl_reg_loss: 67991.0328; val_edge_recon_loss: 658588.9458; val_gene_expr_recon_loss: 20585786.8000; val_masked_gp_l1_reg_loss: 50357.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 184423.4375; val_chrom_access_recon_loss: 4563436.4000; val_global_loss: 26110585.2000; val_optim_loss: 26110585.2000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9283; val_auprc_score: 0.9134; val_best_acc_score: 0.8564; val_best_f1_score: 0.8661; train_kl_reg_loss: 70365.0625; train_edge_recon_loss: 627786.4542; train_gene_expr_recon_loss: 20347511.1603; train_masked_gp_l1_reg_loss: 52087.4397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 162533.8146; train_chrom_access_recon_loss: 4490053.1527; train_global_loss: 25750337.0840; train_optim_loss: 25750337.0840; val_kl_reg_loss: 71440.6370; val_edge_recon_loss: 625707.1083; val_gene_expr_recon_loss: 20354707.8667; val_masked_gp_l1_reg_loss: 53925.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 145336.6094; val_chrom_access_recon_loss: 4490481.2000; val_global_loss: 25741598.6667; val_optim_loss: 25741598.6667
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9369; val_auprc_score: 0.9257; val_best_acc_score: 0.8674; val_best_f1_score: 0.8739; train_kl_reg_loss: 69105.3377; train_edge_recon_loss: 609624.7777; train_gene_expr_recon_loss: 20140981.3435; train_masked_gp_l1_reg_loss: 55371.0139; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 132311.1569; train_chrom_access_recon_loss: 4449196.3111; train_global_loss: 25456589.8321; train_optim_loss: 25456589.8321; val_kl_reg_loss: 68525.8747; val_edge_recon_loss: 608849.0708; val_gene_expr_recon_loss: 20085138.6667; val_masked_gp_l1_reg_loss: 56604.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 120962.2734; val_chrom_access_recon_loss: 4434339.0333; val_global_loss: 25374418.5333; val_optim_loss: 25374418.5333
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9311; val_auprc_score: 0.9171; val_best_acc_score: 0.8593; val_best_f1_score: 0.8667; train_kl_reg_loss: 66365.6400; train_edge_recon_loss: 600846.0615; train_gene_expr_recon_loss: 19991881.0076; train_masked_gp_l1_reg_loss: 57742.8237; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114156.4067; train_chrom_access_recon_loss: 4414460.7844; train_global_loss: 25245452.5344; train_optim_loss: 25245452.5344; val_kl_reg_loss: 63391.9799; val_edge_recon_loss: 604712.0792; val_gene_expr_recon_loss: 19998138.4000; val_masked_gp_l1_reg_loss: 58805.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109559.5938; val_chrom_access_recon_loss: 4425926.0000; val_global_loss: 25260534.5333; val_optim_loss: 25260534.5333
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9405; val_auprc_score: 0.9334; val_best_acc_score: 0.8670; val_best_f1_score: 0.8712; train_kl_reg_loss: 63476.1756; train_edge_recon_loss: 597226.5143; train_gene_expr_recon_loss: 19854066.1679; train_masked_gp_l1_reg_loss: 59682.0682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105116.9717; train_chrom_access_recon_loss: 4385898.2405; train_global_loss: 25065465.9389; train_optim_loss: 25065465.9389; val_kl_reg_loss: 65303.2089; val_edge_recon_loss: 601127.6917; val_gene_expr_recon_loss: 19797869.0667; val_masked_gp_l1_reg_loss: 60410.8242; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102392.1328; val_chrom_access_recon_loss: 4398978.6500; val_global_loss: 25026081.0667; val_optim_loss: 25026081.0667
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9426; val_auprc_score: 0.9297; val_best_acc_score: 0.8759; val_best_f1_score: 0.8822; train_kl_reg_loss: 60970.4910; train_edge_recon_loss: 593211.3306; train_gene_expr_recon_loss: 19728541.1145; train_masked_gp_l1_reg_loss: 61295.7330; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100056.2929; train_chrom_access_recon_loss: 4360076.0344; train_global_loss: 24904151.0992; train_optim_loss: 24904151.0992; val_kl_reg_loss: 59584.0698; val_edge_recon_loss: 592245.5583; val_gene_expr_recon_loss: 19741047.3333; val_masked_gp_l1_reg_loss: 62051.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 97942.4922; val_chrom_access_recon_loss: 4346489.3667; val_global_loss: 24899360.4000; val_optim_loss: 24899360.4000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9510; val_auprc_score: 0.9444; val_best_acc_score: 0.8847; val_best_f1_score: 0.8874; train_kl_reg_loss: 59857.3021; train_edge_recon_loss: 589281.7767; train_gene_expr_recon_loss: 19614246.4122; train_masked_gp_l1_reg_loss: 62587.6668; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95669.3993; train_chrom_access_recon_loss: 4329988.6011; train_global_loss: 24751631.1908; train_optim_loss: 24751631.1908; val_kl_reg_loss: 57882.1276; val_edge_recon_loss: 588402.4625; val_gene_expr_recon_loss: 19701520.6667; val_masked_gp_l1_reg_loss: 63215.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93840.5156; val_chrom_access_recon_loss: 4358961.2333; val_global_loss: 24863822.4000; val_optim_loss: 24863822.4000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9537; val_auprc_score: 0.9430; val_best_acc_score: 0.8909; val_best_f1_score: 0.8945; train_kl_reg_loss: 58664.4312; train_edge_recon_loss: 585016.7872; train_gene_expr_recon_loss: 19506010.1374; train_masked_gp_l1_reg_loss: 63843.2408; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91614.5237; train_chrom_access_recon_loss: 4307333.7958; train_global_loss: 24612482.9160; train_optim_loss: 24612482.9160; val_kl_reg_loss: 57233.1747; val_edge_recon_loss: 583883.1625; val_gene_expr_recon_loss: 19515308.1333; val_masked_gp_l1_reg_loss: 64506.7930; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 90774.8906; val_chrom_access_recon_loss: 4312362.9833; val_global_loss: 24624067.4667; val_optim_loss: 24624067.4667
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9586; val_auprc_score: 0.9500; val_best_acc_score: 0.8977; val_best_f1_score: 0.9008; train_kl_reg_loss: 57343.3355; train_edge_recon_loss: 583444.4556; train_gene_expr_recon_loss: 19426293.0687; train_masked_gp_l1_reg_loss: 65040.6567; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88865.2182; train_chrom_access_recon_loss: 4287344.8798; train_global_loss: 24508331.6641; train_optim_loss: 24508331.6641; val_kl_reg_loss: 55686.3388; val_edge_recon_loss: 582085.2583; val_gene_expr_recon_loss: 19511230.9333; val_masked_gp_l1_reg_loss: 65498.5078; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87238.1875; val_chrom_access_recon_loss: 4307399.0500; val_global_loss: 24609137.8667; val_optim_loss: 24609137.8667
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9592; val_auprc_score: 0.9493; val_best_acc_score: 0.9027; val_best_f1_score: 0.9068; train_kl_reg_loss: 56811.3086; train_edge_recon_loss: 580689.7815; train_gene_expr_recon_loss: 19347887.8015; train_masked_gp_l1_reg_loss: 66101.6342; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86245.4843; train_chrom_access_recon_loss: 4265859.7538; train_global_loss: 24403595.9084; train_optim_loss: 24403595.9084; val_kl_reg_loss: 55473.7159; val_edge_recon_loss: 584434.5625; val_gene_expr_recon_loss: 19339184.6667; val_masked_gp_l1_reg_loss: 66606.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85779.3438; val_chrom_access_recon_loss: 4256677.7667; val_global_loss: 24388157.2000; val_optim_loss: 24388157.2000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9606; val_auprc_score: 0.9480; val_best_acc_score: 0.9074; val_best_f1_score: 0.9095; train_kl_reg_loss: 55711.3209; train_edge_recon_loss: 580822.3946; train_gene_expr_recon_loss: 19257150.2901; train_masked_gp_l1_reg_loss: 67151.7971; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84821.0072; train_chrom_access_recon_loss: 4241180.4733; train_global_loss: 24286837.2061; train_optim_loss: 24286837.2061; val_kl_reg_loss: 56481.2682; val_edge_recon_loss: 579862.0208; val_gene_expr_recon_loss: 19275723.2000; val_masked_gp_l1_reg_loss: 67675.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84318.2266; val_chrom_access_recon_loss: 4237884.2333; val_global_loss: 24301944.5333; val_optim_loss: 24301944.5333
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9629; val_auprc_score: 0.9533; val_best_acc_score: 0.9089; val_best_f1_score: 0.9112; train_kl_reg_loss: 54862.8653; train_edge_recon_loss: 580182.0687; train_gene_expr_recon_loss: 19176993.1908; train_masked_gp_l1_reg_loss: 68308.0513; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84022.7807; train_chrom_access_recon_loss: 4219155.3588; train_global_loss: 24183524.4580; train_optim_loss: 24183524.4580; val_kl_reg_loss: 54799.6057; val_edge_recon_loss: 585501.6000; val_gene_expr_recon_loss: 19262911.2000; val_masked_gp_l1_reg_loss: 69128.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84409.4297; val_chrom_access_recon_loss: 4214862.9000; val_global_loss: 24271613.6000; val_optim_loss: 24271613.6000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9633; val_auprc_score: 0.9543; val_best_acc_score: 0.9109; val_best_f1_score: 0.9133; train_kl_reg_loss: 54143.2456; train_edge_recon_loss: 577050.9914; train_gene_expr_recon_loss: 19110888.5649; train_masked_gp_l1_reg_loss: 69569.1660; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83611.9171; train_chrom_access_recon_loss: 4198292.6508; train_global_loss: 24093556.5038; train_optim_loss: 24093556.5038; val_kl_reg_loss: 54510.6211; val_edge_recon_loss: 576018.7625; val_gene_expr_recon_loss: 19148681.2000; val_masked_gp_l1_reg_loss: 70088.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83131.5469; val_chrom_access_recon_loss: 4198320.5167; val_global_loss: 24130751.0667; val_optim_loss: 24130751.0667
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9630; val_auprc_score: 0.9527; val_best_acc_score: 0.9105; val_best_f1_score: 0.9134; train_kl_reg_loss: 53896.9615; train_edge_recon_loss: 575854.0258; train_gene_expr_recon_loss: 19056905.2977; train_masked_gp_l1_reg_loss: 70726.5682; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83312.6077; train_chrom_access_recon_loss: 4176761.5038; train_global_loss: 24017457.0687; train_optim_loss: 24017457.0687; val_kl_reg_loss: 55023.9177; val_edge_recon_loss: 583524.8542; val_gene_expr_recon_loss: 19119534.1333; val_masked_gp_l1_reg_loss: 71260.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84263.7969; val_chrom_access_recon_loss: 4187697.7667; val_global_loss: 24101304.9333; val_optim_loss: 24101304.9333
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9634; val_auprc_score: 0.9538; val_best_acc_score: 0.9112; val_best_f1_score: 0.9135; train_kl_reg_loss: 53500.5398; train_edge_recon_loss: 575840.8550; train_gene_expr_recon_loss: 18968894.0153; train_masked_gp_l1_reg_loss: 71986.6484; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83040.3729; train_chrom_access_recon_loss: 4148021.1718; train_global_loss: 23901283.6336; train_optim_loss: 23901283.6336; val_kl_reg_loss: 53611.1820; val_edge_recon_loss: 578258.5167; val_gene_expr_recon_loss: 19102839.2000; val_masked_gp_l1_reg_loss: 72755.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83941.5312; val_chrom_access_recon_loss: 4164906.4667; val_global_loss: 24056313.3333; val_optim_loss: 24056313.3333
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9613; val_auprc_score: 0.9505; val_best_acc_score: 0.9078; val_best_f1_score: 0.9117; train_kl_reg_loss: 52848.5561; train_edge_recon_loss: 575890.6780; train_gene_expr_recon_loss: 18875019.1450; train_masked_gp_l1_reg_loss: 73494.2561; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83350.3940; train_chrom_access_recon_loss: 4120054.1260; train_global_loss: 23780657.0229; train_optim_loss: 23780657.0229; val_kl_reg_loss: 51367.6953; val_edge_recon_loss: 579601.4500; val_gene_expr_recon_loss: 19056369.7333; val_masked_gp_l1_reg_loss: 74147.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83173.6016; val_chrom_access_recon_loss: 4177280.9333; val_global_loss: 24021941.7333; val_optim_loss: 24021941.7333
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9629; val_auprc_score: 0.9533; val_best_acc_score: 0.9084; val_best_f1_score: 0.9132; train_kl_reg_loss: 52401.2788; train_edge_recon_loss: 576606.5463; train_gene_expr_recon_loss: 18834397.4656; train_masked_gp_l1_reg_loss: 74984.2570; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83215.4167; train_chrom_access_recon_loss: 4099808.8969; train_global_loss: 23721413.7557; train_optim_loss: 23721413.7557; val_kl_reg_loss: 52733.1680; val_edge_recon_loss: 577483.7792; val_gene_expr_recon_loss: 18889976.6667; val_masked_gp_l1_reg_loss: 75732.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83791.7031; val_chrom_access_recon_loss: 4117253.1333; val_global_loss: 23796971.0667; val_optim_loss: 23796971.0667
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9670; val_auprc_score: 0.9570; val_best_acc_score: 0.9182; val_best_f1_score: 0.9208; train_kl_reg_loss: 52844.9226; train_edge_recon_loss: 574643.4967; train_gene_expr_recon_loss: 18743352.7328; train_masked_gp_l1_reg_loss: 76588.0584; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83462.2105; train_chrom_access_recon_loss: 4070640.5782; train_global_loss: 23601532.0916; train_optim_loss: 23601532.0916; val_kl_reg_loss: 52164.7505; val_edge_recon_loss: 575359.3792; val_gene_expr_recon_loss: 18830087.4667; val_masked_gp_l1_reg_loss: 77343.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83733.8203; val_chrom_access_recon_loss: 4121594.6167; val_global_loss: 23740284.0000; val_optim_loss: 23740284.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9637; val_auprc_score: 0.9513; val_best_acc_score: 0.9104; val_best_f1_score: 0.9137; train_kl_reg_loss: 52667.2616; train_edge_recon_loss: 574599.6312; train_gene_expr_recon_loss: 18709568.4275; train_masked_gp_l1_reg_loss: 78141.9528; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83733.3279; train_chrom_access_recon_loss: 4051357.3531; train_global_loss: 23550067.8321; train_optim_loss: 23550067.8321; val_kl_reg_loss: 52706.3089; val_edge_recon_loss: 578873.2167; val_gene_expr_recon_loss: 18844951.7333; val_masked_gp_l1_reg_loss: 78978.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84699.6406; val_chrom_access_recon_loss: 4092087.8833; val_global_loss: 23732296.9333; val_optim_loss: 23732296.9333
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9633; val_auprc_score: 0.9511; val_best_acc_score: 0.9109; val_best_f1_score: 0.9144; train_kl_reg_loss: 52734.7609; train_edge_recon_loss: 573928.5124; train_gene_expr_recon_loss: 18620580.3511; train_masked_gp_l1_reg_loss: 79723.9962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84390.8930; train_chrom_access_recon_loss: 4028841.2996; train_global_loss: 23440199.6794; train_optim_loss: 23440199.6794; val_kl_reg_loss: 52547.2180; val_edge_recon_loss: 577690.1917; val_gene_expr_recon_loss: 18746881.0667; val_masked_gp_l1_reg_loss: 80364.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84269.8828; val_chrom_access_recon_loss: 4059583.8833; val_global_loss: 23601336.1333; val_optim_loss: 23601336.1333
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9609; val_auprc_score: 0.9507; val_best_acc_score: 0.9076; val_best_f1_score: 0.9118; train_kl_reg_loss: 53271.8868; train_edge_recon_loss: 573605.8593; train_gene_expr_recon_loss: 18566669.2366; train_masked_gp_l1_reg_loss: 80945.7897; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84491.0587; train_chrom_access_recon_loss: 4002016.5057; train_global_loss: 23361000.2443; train_optim_loss: 23361000.2443; val_kl_reg_loss: 54047.7901; val_edge_recon_loss: 579409.4167; val_gene_expr_recon_loss: 18743899.6000; val_masked_gp_l1_reg_loss: 81579.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85555.7891; val_chrom_access_recon_loss: 4076722.6667; val_global_loss: 23621215.6000; val_optim_loss: 23621215.6000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9590; val_auprc_score: 0.9438; val_best_acc_score: 0.9132; val_best_f1_score: 0.9174; train_kl_reg_loss: 53713.4918; train_edge_recon_loss: 573855.8426; train_gene_expr_recon_loss: 18493859.5573; train_masked_gp_l1_reg_loss: 82068.6580; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85175.2112; train_chrom_access_recon_loss: 3983974.7595; train_global_loss: 23272647.7252; train_optim_loss: 23272647.7252; val_kl_reg_loss: 52860.6253; val_edge_recon_loss: 577751.0167; val_gene_expr_recon_loss: 18699254.6667; val_masked_gp_l1_reg_loss: 82488.4297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86289.4688; val_chrom_access_recon_loss: 4036831.4167; val_global_loss: 23535475.8667; val_optim_loss: 23535475.8667
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9613; val_auprc_score: 0.9515; val_best_acc_score: 0.9076; val_best_f1_score: 0.9097; train_kl_reg_loss: 53822.4982; train_edge_recon_loss: 575491.4819; train_gene_expr_recon_loss: 18430767.8321; train_masked_gp_l1_reg_loss: 82976.9903; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85617.5105; train_chrom_access_recon_loss: 3958775.8760; train_global_loss: 23187452.1527; train_optim_loss: 23187452.1527; val_kl_reg_loss: 53855.9708; val_edge_recon_loss: 580502.5500; val_gene_expr_recon_loss: 18635398.4000; val_masked_gp_l1_reg_loss: 83362.2266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86215.6797; val_chrom_access_recon_loss: 4032016.5000; val_global_loss: 23471351.6000; val_optim_loss: 23471351.6000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9256; val_auprc_score: 0.9187; val_best_acc_score: 0.8445; val_best_f1_score: 0.8528; train_kl_reg_loss: 30992.7660; train_edge_recon_loss: 762197.5897; train_gene_expr_recon_loss: 17580657.6183; train_masked_gp_l1_reg_loss: 81193.0976; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 78999.2931; train_chrom_access_recon_loss: 3806382.2576; train_global_loss: 22340422.7176; train_optim_loss: 22340422.7176; val_kl_reg_loss: 7457.6792; val_edge_recon_loss: 773704.3000; val_gene_expr_recon_loss: 17214389.1333; val_masked_gp_l1_reg_loss: 78634.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83205.6484; val_chrom_access_recon_loss: 3786937.8167; val_global_loss: 21944329.2000; val_optim_loss: 21944329.2000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9116; val_auprc_score: 0.9014; val_best_acc_score: 0.8339; val_best_f1_score: 0.8458; train_kl_reg_loss: 14205.3816; train_edge_recon_loss: 767986.4141; train_gene_expr_recon_loss: 17234806.0076; train_masked_gp_l1_reg_loss: 77911.0233; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91955.6538; train_chrom_access_recon_loss: 3770032.8931; train_global_loss: 21956897.3282; train_optim_loss: 21956897.3282; val_kl_reg_loss: 6648.3383; val_edge_recon_loss: 782780.2417; val_gene_expr_recon_loss: 17055009.4000; val_masked_gp_l1_reg_loss: 76650.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96926.8984; val_chrom_access_recon_loss: 3778309.0000; val_global_loss: 21796323.2000; val_optim_loss: 21796323.2000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9235; val_auprc_score: 0.9120; val_best_acc_score: 0.8502; val_best_f1_score: 0.8547; train_kl_reg_loss: 10646.4765; train_edge_recon_loss: 765367.4485; train_gene_expr_recon_loss: 17053810.8168; train_masked_gp_l1_reg_loss: 74279.9598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 97350.4457; train_chrom_access_recon_loss: 3759870.5916; train_global_loss: 21761325.7557; train_optim_loss: 21761325.7557; val_kl_reg_loss: 7631.6101; val_edge_recon_loss: 756759.8417; val_gene_expr_recon_loss: 17103458.8000; val_masked_gp_l1_reg_loss: 71396.1406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92419.1016; val_chrom_access_recon_loss: 3778429.1167; val_global_loss: 21810095.3333; val_optim_loss: 21810095.3333
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9117; val_auprc_score: 0.8953; val_best_acc_score: 0.8300; val_best_f1_score: 0.8445; train_kl_reg_loss: 10451.8662; train_edge_recon_loss: 730671.8053; train_gene_expr_recon_loss: 17045683.3053; train_masked_gp_l1_reg_loss: 69833.6040; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92082.0425; train_chrom_access_recon_loss: 3749335.9008; train_global_loss: 21698058.4580; train_optim_loss: 21698058.4580; val_kl_reg_loss: 7288.3872; val_edge_recon_loss: 725349.0875; val_gene_expr_recon_loss: 17052233.1333; val_masked_gp_l1_reg_loss: 68909.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92070.1562; val_chrom_access_recon_loss: 3758248.1167; val_global_loss: 21704098.5333; val_optim_loss: 21704098.5333
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9110; val_auprc_score: 0.8947; val_best_acc_score: 0.8358; val_best_f1_score: 0.8464; train_kl_reg_loss: 10442.3349; train_edge_recon_loss: 711747.9924; train_gene_expr_recon_loss: 16973524.7557; train_masked_gp_l1_reg_loss: 67629.5986; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 91261.8194; train_chrom_access_recon_loss: 3743274.4656; train_global_loss: 21597880.8702; train_optim_loss: 21597880.8702; val_kl_reg_loss: 8467.3269; val_edge_recon_loss: 701093.2083; val_gene_expr_recon_loss: 17042170.7333; val_masked_gp_l1_reg_loss: 65906.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88913.8906; val_chrom_access_recon_loss: 3765291.8000; val_global_loss: 21671842.9333; val_optim_loss: 21671842.9333
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9143; val_auprc_score: 0.8975; val_best_acc_score: 0.8390; val_best_f1_score: 0.8481; train_kl_reg_loss: 13409.1657; train_edge_recon_loss: 681675.5391; train_gene_expr_recon_loss: 16952825.5802; train_masked_gp_l1_reg_loss: 64434.4476; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87192.7248; train_chrom_access_recon_loss: 3743160.5134; train_global_loss: 21542697.9695; train_optim_loss: 21542697.9695; val_kl_reg_loss: 9606.5883; val_edge_recon_loss: 663682.6125; val_gene_expr_recon_loss: 16943967.7333; val_masked_gp_l1_reg_loss: 63188.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86228.6797; val_chrom_access_recon_loss: 3762502.5833; val_global_loss: 21529175.8667; val_optim_loss: 21529175.8667
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9135; val_auprc_score: 0.8994; val_best_acc_score: 0.8397; val_best_f1_score: 0.8510; train_kl_reg_loss: 15951.8190; train_edge_recon_loss: 652077.9957; train_gene_expr_recon_loss: 16888310.7557; train_masked_gp_l1_reg_loss: 61844.1777; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83514.0886; train_chrom_access_recon_loss: 3740112.3225; train_global_loss: 21441811.0687; train_optim_loss: 21441811.0687; val_kl_reg_loss: 11404.9074; val_edge_recon_loss: 640384.1833; val_gene_expr_recon_loss: 16962219.4667; val_masked_gp_l1_reg_loss: 60611.1953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 80643.9531; val_chrom_access_recon_loss: 3747883.1000; val_global_loss: 21503147.7333; val_optim_loss: 21503147.7333
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9211; val_auprc_score: 0.9074; val_best_acc_score: 0.8479; val_best_f1_score: 0.8580; train_kl_reg_loss: 17876.4753; train_edge_recon_loss: 629283.7910; train_gene_expr_recon_loss: 16860035.2901; train_masked_gp_l1_reg_loss: 59908.4196; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 79264.4178; train_chrom_access_recon_loss: 3733498.0935; train_global_loss: 21379866.5954; train_optim_loss: 21379866.5954; val_kl_reg_loss: 13944.6852; val_edge_recon_loss: 640014.9375; val_gene_expr_recon_loss: 16929660.2000; val_masked_gp_l1_reg_loss: 59238.2539; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77625.0938; val_chrom_access_recon_loss: 3739841.6000; val_global_loss: 21460325.2000; val_optim_loss: 21460325.2000
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9099; val_auprc_score: 0.8928; val_best_acc_score: 0.8306; val_best_f1_score: 0.8432; train_kl_reg_loss: 18416.7661; train_edge_recon_loss: 631657.9127; train_gene_expr_recon_loss: 16825779.1450; train_masked_gp_l1_reg_loss: 58120.1917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77031.0027; train_chrom_access_recon_loss: 3727463.0210; train_global_loss: 21338468.0916; train_optim_loss: 21338468.0916; val_kl_reg_loss: 13663.7246; val_edge_recon_loss: 619549.4125; val_gene_expr_recon_loss: 16838000.1333; val_masked_gp_l1_reg_loss: 57643.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 76013.2109; val_chrom_access_recon_loss: 3737392.1833; val_global_loss: 21342263.6000; val_optim_loss: 21342263.6000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9084; val_auprc_score: 0.8955; val_best_acc_score: 0.8252; val_best_f1_score: 0.8428; train_kl_reg_loss: 19820.1669; train_edge_recon_loss: 612803.0281; train_gene_expr_recon_loss: 16822525.9084; train_masked_gp_l1_reg_loss: 57251.8457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75553.0917; train_chrom_access_recon_loss: 3731826.4485; train_global_loss: 21319780.4885; train_optim_loss: 21319780.4885; val_kl_reg_loss: 15890.7971; val_edge_recon_loss: 609013.5042; val_gene_expr_recon_loss: 16901527.6667; val_masked_gp_l1_reg_loss: 56918.2617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 75015.8750; val_chrom_access_recon_loss: 3743400.8000; val_global_loss: 21401766.4000; val_optim_loss: 21401766.4000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9085; val_auprc_score: 0.8954; val_best_acc_score: 0.8286; val_best_f1_score: 0.8419; train_kl_reg_loss: 21766.1840; train_edge_recon_loss: 603697.4919; train_gene_expr_recon_loss: 16795613.7557; train_masked_gp_l1_reg_loss: 56418.2641; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74786.9357; train_chrom_access_recon_loss: 3726002.1107; train_global_loss: 21278284.6870; train_optim_loss: 21278284.6870; val_kl_reg_loss: 18358.7296; val_edge_recon_loss: 602368.3917; val_gene_expr_recon_loss: 16923509.0667; val_masked_gp_l1_reg_loss: 56016.1133; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74230.4062; val_chrom_access_recon_loss: 3758606.9833; val_global_loss: 21433089.3333; val_optim_loss: 21433089.3333
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9086; val_auprc_score: 0.8920; val_best_acc_score: 0.8273; val_best_f1_score: 0.8422; train_kl_reg_loss: 23038.7534; train_edge_recon_loss: 594338.8502; train_gene_expr_recon_loss: 16769223.4809; train_masked_gp_l1_reg_loss: 55587.3220; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73860.9100; train_chrom_access_recon_loss: 3718845.1508; train_global_loss: 21234894.4122; train_optim_loss: 21234894.4122; val_kl_reg_loss: 20605.4717; val_edge_recon_loss: 595757.1458; val_gene_expr_recon_loss: 16828932.4000; val_masked_gp_l1_reg_loss: 55207.1328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73290.6016; val_chrom_access_recon_loss: 3732672.7833; val_global_loss: 21306465.7333; val_optim_loss: 21306465.7333
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9116; val_auprc_score: 0.8950; val_best_acc_score: 0.8347; val_best_f1_score: 0.8480; train_kl_reg_loss: 24695.4445; train_edge_recon_loss: 593721.9532; train_gene_expr_recon_loss: 16751774.0916; train_masked_gp_l1_reg_loss: 54872.2161; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72864.6372; train_chrom_access_recon_loss: 3717363.6546; train_global_loss: 21215291.9084; train_optim_loss: 21215291.9084; val_kl_reg_loss: 20924.4947; val_edge_recon_loss: 592729.4292; val_gene_expr_recon_loss: 16789422.5333; val_masked_gp_l1_reg_loss: 54573.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72037.3828; val_chrom_access_recon_loss: 3719842.7667; val_global_loss: 21249531.3333; val_optim_loss: 21249531.3333
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9199; val_auprc_score: 0.9097; val_best_acc_score: 0.8434; val_best_f1_score: 0.8541; train_kl_reg_loss: 26172.9792; train_edge_recon_loss: 586251.9227; train_gene_expr_recon_loss: 16761237.7176; train_masked_gp_l1_reg_loss: 54201.3059; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71751.3757; train_chrom_access_recon_loss: 3722715.8645; train_global_loss: 21222330.9618; train_optim_loss: 21222330.9618; val_kl_reg_loss: 22345.9368; val_edge_recon_loss: 587701.0875; val_gene_expr_recon_loss: 16790971.3333; val_masked_gp_l1_reg_loss: 53907.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71479.4141; val_chrom_access_recon_loss: 3713035.0667; val_global_loss: 21239441.6000; val_optim_loss: 21239441.6000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9232; val_auprc_score: 0.9109; val_best_acc_score: 0.8491; val_best_f1_score: 0.8605; train_kl_reg_loss: 26960.4053; train_edge_recon_loss: 583666.8497; train_gene_expr_recon_loss: 16737763.8931; train_masked_gp_l1_reg_loss: 53582.2565; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71066.9720; train_chrom_access_recon_loss: 3714118.9294; train_global_loss: 21187159.2366; train_optim_loss: 21187159.2366; val_kl_reg_loss: 23344.5508; val_edge_recon_loss: 580547.6250; val_gene_expr_recon_loss: 16792444.4667; val_masked_gp_l1_reg_loss: 53322.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70796.9297; val_chrom_access_recon_loss: 3725658.1333; val_global_loss: 21246113.2000; val_optim_loss: 21246113.2000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9241; val_auprc_score: 0.9119; val_best_acc_score: 0.8508; val_best_f1_score: 0.8614; train_kl_reg_loss: 27632.4567; train_edge_recon_loss: 579921.3917; train_gene_expr_recon_loss: 16729365.4427; train_masked_gp_l1_reg_loss: 53057.1486; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70393.9896; train_chrom_access_recon_loss: 3715139.7481; train_global_loss: 21175510.0763; train_optim_loss: 21175510.0763; val_kl_reg_loss: 24850.1732; val_edge_recon_loss: 582477.7458; val_gene_expr_recon_loss: 16834505.0000; val_masked_gp_l1_reg_loss: 52861.0195; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70252.4688; val_chrom_access_recon_loss: 3734736.5000; val_global_loss: 21299683.2000; val_optim_loss: 21299683.2000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9311; val_auprc_score: 0.9170; val_best_acc_score: 0.8580; val_best_f1_score: 0.8676; train_kl_reg_loss: 28364.7703; train_edge_recon_loss: 576334.1054; train_gene_expr_recon_loss: 16717790.9237; train_masked_gp_l1_reg_loss: 52570.5531; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69728.1172; train_chrom_access_recon_loss: 3714734.7405; train_global_loss: 21159522.9924; train_optim_loss: 21159522.9924; val_kl_reg_loss: 25616.4307; val_edge_recon_loss: 578339.0833; val_gene_expr_recon_loss: 16810805.4000; val_masked_gp_l1_reg_loss: 52389.0820; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 69527.4688; val_chrom_access_recon_loss: 3751390.4000; val_global_loss: 21288069.0667; val_optim_loss: 21288069.0667
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9403; val_auprc_score: 0.9286; val_best_acc_score: 0.8739; val_best_f1_score: 0.8799; train_kl_reg_loss: 28790.6297; train_edge_recon_loss: 575248.9509; train_gene_expr_recon_loss: 16718419.0229; train_masked_gp_l1_reg_loss: 52195.9379; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69241.4831; train_chrom_access_recon_loss: 3718921.6737; train_global_loss: 21162817.8321; train_optim_loss: 21162817.8321; val_kl_reg_loss: 25298.1779; val_edge_recon_loss: 573735.4417; val_gene_expr_recon_loss: 16783841.4667; val_masked_gp_l1_reg_loss: 52135.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68798.3750; val_chrom_access_recon_loss: 3737505.4000; val_global_loss: 21241314.4000; val_optim_loss: 21241314.4000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9384; val_auprc_score: 0.9243; val_best_acc_score: 0.8678; val_best_f1_score: 0.8736; train_kl_reg_loss: 29431.5673; train_edge_recon_loss: 574788.7805; train_gene_expr_recon_loss: 16684215.1756; train_masked_gp_l1_reg_loss: 51698.0428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 58157.4025; train_chrom_access_recon_loss: 3705476.3721; train_global_loss: 21103767.4198; train_optim_loss: 21103767.4198; val_kl_reg_loss: 25451.3173; val_edge_recon_loss: 576282.9000; val_gene_expr_recon_loss: 16796472.8667; val_masked_gp_l1_reg_loss: 51538.6289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56749.9961; val_chrom_access_recon_loss: 3741940.5500; val_global_loss: 21248435.6000; val_optim_loss: 21248435.6000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9404; val_auprc_score: 0.9293; val_best_acc_score: 0.8693; val_best_f1_score: 0.8748; train_kl_reg_loss: 29692.2166; train_edge_recon_loss: 574801.0105; train_gene_expr_recon_loss: 16698811.0229; train_masked_gp_l1_reg_loss: 51473.2300; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56405.7590; train_chrom_access_recon_loss: 3714143.7882; train_global_loss: 21125327.0534; train_optim_loss: 21125327.0534; val_kl_reg_loss: 25611.8391; val_edge_recon_loss: 573384.0667; val_gene_expr_recon_loss: 16675664.4667; val_masked_gp_l1_reg_loss: 51405.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56091.7383; val_chrom_access_recon_loss: 3715543.6667; val_global_loss: 21097701.7333; val_optim_loss: 21097701.7333
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9333; val_auprc_score: 0.9207; val_best_acc_score: 0.8631; val_best_f1_score: 0.8712; train_kl_reg_loss: 29943.8154; train_edge_recon_loss: 574096.4289; train_gene_expr_recon_loss: 16670577.1756; train_masked_gp_l1_reg_loss: 51364.8227; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55882.2929; train_chrom_access_recon_loss: 3704167.9179; train_global_loss: 21086032.4427; train_optim_loss: 21086032.4427; val_kl_reg_loss: 26005.8740; val_edge_recon_loss: 575601.8958; val_gene_expr_recon_loss: 16732784.2000; val_masked_gp_l1_reg_loss: 51311.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55590.1641; val_chrom_access_recon_loss: 3716433.6167; val_global_loss: 21157727.4667; val_optim_loss: 21157727.4667
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9365; val_auprc_score: 0.9231; val_best_acc_score: 0.8674; val_best_f1_score: 0.8754; train_kl_reg_loss: 30131.6343; train_edge_recon_loss: 572351.7133; train_gene_expr_recon_loss: 16673151.7099; train_masked_gp_l1_reg_loss: 51283.0130; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55374.3126; train_chrom_access_recon_loss: 3707882.3435; train_global_loss: 21090174.6718; train_optim_loss: 21090174.6718; val_kl_reg_loss: 26222.7133; val_edge_recon_loss: 575350.8667; val_gene_expr_recon_loss: 16788009.6000; val_masked_gp_l1_reg_loss: 51244.1289; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55209.7930; val_chrom_access_recon_loss: 3721983.8167; val_global_loss: 21218021.2000; val_optim_loss: 21218021.2000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9407; val_auprc_score: 0.9263; val_best_acc_score: 0.8740; val_best_f1_score: 0.8814; train_kl_reg_loss: 30308.6364; train_edge_recon_loss: 571514.3144; train_gene_expr_recon_loss: 16685585.7939; train_masked_gp_l1_reg_loss: 51214.6774; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55026.4082; train_chrom_access_recon_loss: 3706299.1775; train_global_loss: 21099949.0229; train_optim_loss: 21099949.0229; val_kl_reg_loss: 26399.8376; val_edge_recon_loss: 569885.7083; val_gene_expr_recon_loss: 16728445.6667; val_masked_gp_l1_reg_loss: 51172.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54843.2812; val_chrom_access_recon_loss: 3723436.8500; val_global_loss: 21154184.0000; val_optim_loss: 21154184.0000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9379; val_auprc_score: 0.9276; val_best_acc_score: 0.8653; val_best_f1_score: 0.8731; train_kl_reg_loss: 30423.6607; train_edge_recon_loss: 571382.5496; train_gene_expr_recon_loss: 16669387.3206; train_masked_gp_l1_reg_loss: 51139.4240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 54683.9203; train_chrom_access_recon_loss: 3703762.7271; train_global_loss: 21080779.5420; train_optim_loss: 21080779.5420; val_kl_reg_loss: 26494.3264; val_edge_recon_loss: 574886.5125; val_gene_expr_recon_loss: 16701883.3333; val_masked_gp_l1_reg_loss: 51112.7617; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 54492.6602; val_chrom_access_recon_loss: 3703888.2833; val_global_loss: 21112756.8000; val_optim_loss: 21112756.8000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9377; val_auprc_score: 0.9271; val_best_acc_score: 0.8661; val_best_f1_score: 0.8750; train_kl_reg_loss: 30470.3844; train_edge_recon_loss: 572379.9227; train_gene_expr_recon_loss: 16669949.7710; train_masked_gp_l1_reg_loss: 51067.0858; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53426.9659; train_chrom_access_recon_loss: 3707976.4351; train_global_loss: 21085270.5802; train_optim_loss: 21085270.5802; val_kl_reg_loss: 26816.4741; val_edge_recon_loss: 576048.2500; val_gene_expr_recon_loss: 16730585.5333; val_masked_gp_l1_reg_loss: 51045.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53293.7969; val_chrom_access_recon_loss: 3715545.6833; val_global_loss: 21153336.0000; val_optim_loss: 21153336.0000
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9323; val_auprc_score: 0.9200; val_best_acc_score: 0.8611; val_best_f1_score: 0.8695; train_kl_reg_loss: 30472.1286; train_edge_recon_loss: 571921.2452; train_gene_expr_recon_loss: 16680427.0840; train_masked_gp_l1_reg_loss: 51035.0654; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53259.0762; train_chrom_access_recon_loss: 3708094.1202; train_global_loss: 21095208.6870; train_optim_loss: 21095208.6870; val_kl_reg_loss: 26677.7079; val_edge_recon_loss: 577603.2292; val_gene_expr_recon_loss: 16797449.2667; val_masked_gp_l1_reg_loss: 51024.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53226.2422; val_chrom_access_recon_loss: 3733445.0667; val_global_loss: 21239425.3333; val_optim_loss: 21239425.3333
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9344; val_auprc_score: 0.9243; val_best_acc_score: 0.8634; val_best_f1_score: 0.8703; train_kl_reg_loss: 30515.1972; train_edge_recon_loss: 573077.6975; train_gene_expr_recon_loss: 16673524.6718; train_masked_gp_l1_reg_loss: 51019.0785; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53196.8460; train_chrom_access_recon_loss: 3704977.5019; train_global_loss: 21086310.8550; train_optim_loss: 21086310.8550; val_kl_reg_loss: 26711.7594; val_edge_recon_loss: 581030.3125; val_gene_expr_recon_loss: 16778081.9333; val_masked_gp_l1_reg_loss: 51012.1211; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53165.9180; val_chrom_access_recon_loss: 3734332.5667; val_global_loss: 21224334.5333; val_optim_loss: 21224334.5333
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9391; val_auprc_score: 0.9272; val_best_acc_score: 0.8707; val_best_f1_score: 0.8781; train_kl_reg_loss: 30501.5346; train_edge_recon_loss: 571386.9819; train_gene_expr_recon_loss: 16669545.0076; train_masked_gp_l1_reg_loss: 51006.8240; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53142.5098; train_chrom_access_recon_loss: 3703047.7882; train_global_loss: 21078630.6565; train_optim_loss: 21078630.6565; val_kl_reg_loss: 26646.8874; val_edge_recon_loss: 573403.0833; val_gene_expr_recon_loss: 16746242.2000; val_masked_gp_l1_reg_loss: 51002.8008; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53115.7305; val_chrom_access_recon_loss: 3713922.1500; val_global_loss: 21164332.2667; val_optim_loss: 21164332.2667

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 34 min 25 sec.
Using best model state, which was in epoch 45.

--- MODEL EVALUATION ---
val AUROC score: 0.9346
val AUPRC score: 0.9227
val best accuracy score: 0.8666
val best F1 score: 0.8752
val target rna MSE score: 1.6175
val source rna MSE score: 0.6784
val target atac MSE score: 0.5003
val source atac MSE score: 0.1550
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
