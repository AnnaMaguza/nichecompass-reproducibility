[True]
Run timestamp: 31072024_212252_2.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'seqfish_mouse_organogenesis_imputed', '--reference_batches', 'batch1', 'batch2', 'batch5', 'batch6', '--n_neighbors', '8', '--filter_genes', '--n_hvg', '0', '--n_svg', '5000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.01', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '100', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '500000', '--lambda_gene_expr_recon', '300', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0', '--lambda_l1_addon', '30.0', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_2']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2444.
Number of gene programs after filtering and combining: 2109.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch5...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch6...
Loading data...
Computing spatial neighborhood graph...

Filtering genes...
Starting with 29239 genes.
Keeping 8548 genes after filtering genes with expression in {} cells.
Keeping 5000 spatially variable, highly variable or gene program relevant genes.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.01
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 5000, n_cat_covariates_embed_input: 0, n_hidden: 1956, n_latent: 1856, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, 
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1856, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1856, n_addon_gp_input: 100, n_cat_covariates_embed_input: 3, n_output: 5000

--- INITIALIZING TRAINER ---
Number of training nodes: 34545
Number of validation nodes: 3838
Number of training edges: 156703
Number of validation edges: 17411
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/100 |--------------------| 1.0% val_auroc_score: 0.8666; val_auprc_score: 0.9598; val_best_acc_score: 0.8418; val_best_f1_score: 0.9061; train_kl_reg_loss: 50220.4991; train_edge_recon_loss: 156050.9914; train_gene_expr_recon_loss: 4601007.5151; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 353538.4598; train_global_loss: 5160817.4584; train_optim_loss: 5160817.4584; val_kl_reg_loss: 38109.8179; val_edge_recon_loss: 147641.8364; val_gene_expr_recon_loss: 4130241.1196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102853.2188; val_global_loss: 4418845.7899; val_optim_loss: 4418845.7899
Epoch 2/100 |--------------------| 2.0% val_auroc_score: 0.9059; val_auprc_score: 0.9720; val_best_acc_score: 0.8815; val_best_f1_score: 0.9273; train_kl_reg_loss: 34053.1734; train_edge_recon_loss: 139257.5793; train_gene_expr_recon_loss: 3963891.5620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63526.8409; train_global_loss: 4200729.1517; train_optim_loss: 4200729.1517; val_kl_reg_loss: 30811.7525; val_edge_recon_loss: 136858.8100; val_gene_expr_recon_loss: 3817498.9601; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 41327.9531; val_global_loss: 4026497.5362; val_optim_loss: 4026497.5362
Epoch 3/100 |--------------------| 3.0% val_auroc_score: 0.9268; val_auprc_score: 0.9764; val_best_acc_score: 0.9048; val_best_f1_score: 0.9408; train_kl_reg_loss: 28200.9913; train_edge_recon_loss: 131723.9815; train_gene_expr_recon_loss: 3703922.9115; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 33593.9337; train_global_loss: 3897441.8226; train_optim_loss: 3897441.8226; val_kl_reg_loss: 26124.6961; val_edge_recon_loss: 130075.7123; val_gene_expr_recon_loss: 3599255.8116; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 28875.9121; val_global_loss: 3784332.2101; val_optim_loss: 3784332.2101
Epoch 4/100 |--------------------| 4.0% val_auroc_score: 0.9362; val_auprc_score: 0.9799; val_best_acc_score: 0.9140; val_best_f1_score: 0.9474; train_kl_reg_loss: 24268.6673; train_edge_recon_loss: 127459.4863; train_gene_expr_recon_loss: 3516900.7940; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26684.1143; train_global_loss: 3695313.0571; train_optim_loss: 3695313.0571; val_kl_reg_loss: 22398.5114; val_edge_recon_loss: 121863.6288; val_gene_expr_recon_loss: 3439082.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25112.9844; val_global_loss: 3608457.7428; val_optim_loss: 3608457.7428
Epoch 5/100 |█-------------------| 5.0% val_auroc_score: 0.9528; val_auprc_score: 0.9853; val_best_acc_score: 0.9290; val_best_f1_score: 0.9563; train_kl_reg_loss: 21153.0770; train_edge_recon_loss: 123626.0065; train_gene_expr_recon_loss: 3377715.7047; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24692.9258; train_global_loss: 3547187.7194; train_optim_loss: 3547187.7194; val_kl_reg_loss: 20053.2150; val_edge_recon_loss: 120673.6738; val_gene_expr_recon_loss: 3317314.3732; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24629.9961; val_global_loss: 3482671.2826; val_optim_loss: 3482671.2826
Epoch 6/100 |█-------------------| 6.0% val_auroc_score: 0.9574; val_auprc_score: 0.9862; val_best_acc_score: 0.9352; val_best_f1_score: 0.9600; train_kl_reg_loss: 18766.3931; train_edge_recon_loss: 120562.4989; train_gene_expr_recon_loss: 3269621.8409; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25065.7012; train_global_loss: 3434016.4376; train_optim_loss: 3434016.4376; val_kl_reg_loss: 17563.4139; val_edge_recon_loss: 121513.7502; val_gene_expr_recon_loss: 3223237.4094; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25745.5352; val_global_loss: 3388060.0725; val_optim_loss: 3388060.0725
Epoch 7/100 |█-------------------| 7.0% val_auroc_score: 0.9601; val_auprc_score: 0.9867; val_best_acc_score: 0.9448; val_best_f1_score: 0.9660; train_kl_reg_loss: 16877.2235; train_edge_recon_loss: 116848.4068; train_gene_expr_recon_loss: 3186251.9976; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26005.0132; train_global_loss: 3345982.6448; train_optim_loss: 3345982.6448; val_kl_reg_loss: 16154.7944; val_edge_recon_loss: 112797.7669; val_gene_expr_recon_loss: 3150874.9746; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26027.0078; val_global_loss: 3305854.5072; val_optim_loss: 3305854.5072
Epoch 8/100 |█-------------------| 8.0% val_auroc_score: 0.9608; val_auprc_score: 0.9872; val_best_acc_score: 0.9466; val_best_f1_score: 0.9672; train_kl_reg_loss: 15469.6522; train_edge_recon_loss: 116016.1935; train_gene_expr_recon_loss: 3123746.9984; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26293.7137; train_global_loss: 3281526.5661; train_optim_loss: 3281526.5661; val_kl_reg_loss: 15329.5148; val_edge_recon_loss: 115164.1524; val_gene_expr_recon_loss: 3099157.9891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 26391.2969; val_global_loss: 3256042.9022; val_optim_loss: 3256042.9022
Epoch 9/100 |█-------------------| 9.0% val_auroc_score: 0.9606; val_auprc_score: 0.9854; val_best_acc_score: 0.9452; val_best_f1_score: 0.9662; train_kl_reg_loss: 14488.3413; train_edge_recon_loss: 114589.9632; train_gene_expr_recon_loss: 3075988.8083; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 26041.1691; train_global_loss: 3231108.2814; train_optim_loss: 3231108.2814; val_kl_reg_loss: 14091.8886; val_edge_recon_loss: 114567.3639; val_gene_expr_recon_loss: 3054620.7174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25822.7305; val_global_loss: 3209102.7210; val_optim_loss: 3209102.7210
Epoch 10/100 |██------------------| 10.0% val_auroc_score: 0.9598; val_auprc_score: 0.9862; val_best_acc_score: 0.9467; val_best_f1_score: 0.9671; train_kl_reg_loss: 13641.6809; train_edge_recon_loss: 112958.2009; train_gene_expr_recon_loss: 3039740.6970; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25558.6475; train_global_loss: 3191899.2219; train_optim_loss: 3191899.2219; val_kl_reg_loss: 13340.2431; val_edge_recon_loss: 115402.5970; val_gene_expr_recon_loss: 3023662.9130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25382.7227; val_global_loss: 3177788.4964; val_optim_loss: 3177788.4964
Epoch 11/100 |██------------------| 11.0% val_auroc_score: 0.9627; val_auprc_score: 0.9872; val_best_acc_score: 0.9478; val_best_f1_score: 0.9679; train_kl_reg_loss: 13067.3488; train_edge_recon_loss: 111650.2730; train_gene_expr_recon_loss: 3012395.0383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25174.2803; train_global_loss: 3162286.9360; train_optim_loss: 3162286.9360; val_kl_reg_loss: 12655.3427; val_edge_recon_loss: 109986.1524; val_gene_expr_recon_loss: 3001114.0254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25070.1953; val_global_loss: 3148825.7609; val_optim_loss: 3148825.7609
Epoch 12/100 |██------------------| 12.0% val_auroc_score: 0.9680; val_auprc_score: 0.9893; val_best_acc_score: 0.9490; val_best_f1_score: 0.9686; train_kl_reg_loss: 12568.8337; train_edge_recon_loss: 110793.0638; train_gene_expr_recon_loss: 2991224.8091; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24916.1085; train_global_loss: 3139502.8046; train_optim_loss: 3139502.8046; val_kl_reg_loss: 12289.3972; val_edge_recon_loss: 108284.1480; val_gene_expr_recon_loss: 2980900.5978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25072.4531; val_global_loss: 3126546.6522; val_optim_loss: 3126546.6522
Epoch 13/100 |██------------------| 13.0% val_auroc_score: 0.9701; val_auprc_score: 0.9902; val_best_acc_score: 0.9529; val_best_f1_score: 0.9708; train_kl_reg_loss: 12220.0073; train_edge_recon_loss: 110273.1410; train_gene_expr_recon_loss: 2975523.7023; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24868.6442; train_global_loss: 3122885.4890; train_optim_loss: 3122885.4890; val_kl_reg_loss: 12046.6713; val_edge_recon_loss: 109353.8123; val_gene_expr_recon_loss: 2966929.0870; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24933.8164; val_global_loss: 3113263.3188; val_optim_loss: 3113263.3188
Epoch 14/100 |██------------------| 14.0% val_auroc_score: 0.9676; val_auprc_score: 0.9887; val_best_acc_score: 0.9513; val_best_f1_score: 0.9699; train_kl_reg_loss: 11914.4843; train_edge_recon_loss: 109570.7940; train_gene_expr_recon_loss: 2963950.8389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24873.3450; train_global_loss: 3110309.4662; train_optim_loss: 3110309.4662; val_kl_reg_loss: 11759.1334; val_edge_recon_loss: 107550.8020; val_gene_expr_recon_loss: 2956831.9457; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 24723.3281; val_global_loss: 3100865.1232; val_optim_loss: 3100865.1232
Epoch 15/100 |███-----------------| 15.0% val_auroc_score: 0.9683; val_auprc_score: 0.9888; val_best_acc_score: 0.9508; val_best_f1_score: 0.9696; train_kl_reg_loss: 11719.3531; train_edge_recon_loss: 109156.4929; train_gene_expr_recon_loss: 2955207.9914; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 24926.8283; train_global_loss: 3101010.6648; train_optim_loss: 3101010.6648; val_kl_reg_loss: 11833.5840; val_edge_recon_loss: 109732.5984; val_gene_expr_recon_loss: 2950145.9819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25007.3594; val_global_loss: 3096719.3877; val_optim_loss: 3096719.3877
Epoch 16/100 |███-----------------| 16.0% val_auroc_score: 0.9703; val_auprc_score: 0.9891; val_best_acc_score: 0.9554; val_best_f1_score: 0.9726; train_kl_reg_loss: 11593.7505; train_edge_recon_loss: 109603.3722; train_gene_expr_recon_loss: 2948688.9315; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25031.0639; train_global_loss: 3094917.1154; train_optim_loss: 3094917.1154; val_kl_reg_loss: 11499.6140; val_edge_recon_loss: 108640.2655; val_gene_expr_recon_loss: 2943844.6993; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25253.6621; val_global_loss: 3089238.3333; val_optim_loss: 3089238.3333
Epoch 17/100 |███-----------------| 17.0% val_auroc_score: 0.9697; val_auprc_score: 0.9901; val_best_acc_score: 0.9528; val_best_f1_score: 0.9709; train_kl_reg_loss: 11473.2805; train_edge_recon_loss: 109368.2653; train_gene_expr_recon_loss: 2942589.0901; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25124.4515; train_global_loss: 3088555.0918; train_optim_loss: 3088555.0918; val_kl_reg_loss: 11410.0739; val_edge_recon_loss: 108271.1182; val_gene_expr_recon_loss: 2938820.2609; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25289.1699; val_global_loss: 3083790.7029; val_optim_loss: 3083790.7029
Epoch 18/100 |███-----------------| 18.0% val_auroc_score: 0.9675; val_auprc_score: 0.9887; val_best_acc_score: 0.9506; val_best_f1_score: 0.9695; train_kl_reg_loss: 11383.1696; train_edge_recon_loss: 109386.3315; train_gene_expr_recon_loss: 2938804.1505; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25188.3065; train_global_loss: 3084761.9613; train_optim_loss: 3084761.9613; val_kl_reg_loss: 11382.7490; val_edge_recon_loss: 110746.8123; val_gene_expr_recon_loss: 2936595.0978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25232.0938; val_global_loss: 3083956.6775; val_optim_loss: 3083956.6775
Epoch 19/100 |███-----------------| 19.0% val_auroc_score: 0.9708; val_auprc_score: 0.9900; val_best_acc_score: 0.9539; val_best_f1_score: 0.9715; train_kl_reg_loss: 11315.6545; train_edge_recon_loss: 108410.3410; train_gene_expr_recon_loss: 2935630.9902; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25303.7273; train_global_loss: 3080660.7162; train_optim_loss: 3080660.7162; val_kl_reg_loss: 11141.6155; val_edge_recon_loss: 108662.4341; val_gene_expr_recon_loss: 2931859.1087; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25099.5371; val_global_loss: 3076762.6594; val_optim_loss: 3076762.6594
Epoch 20/100 |████----------------| 20.0% val_auroc_score: 0.9699; val_auprc_score: 0.9894; val_best_acc_score: 0.9542; val_best_f1_score: 0.9717; train_kl_reg_loss: 11272.7569; train_edge_recon_loss: 108951.2365; train_gene_expr_recon_loss: 2932385.7231; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25273.6644; train_global_loss: 3077883.3797; train_optim_loss: 3077883.3797; val_kl_reg_loss: 11408.7987; val_edge_recon_loss: 109653.8011; val_gene_expr_recon_loss: 2930608.7681; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25372.7148; val_global_loss: 3077044.1051; val_optim_loss: 3077044.1051
Epoch 21/100 |████----------------| 21.0% val_auroc_score: 0.9705; val_auprc_score: 0.9895; val_best_acc_score: 0.9560; val_best_f1_score: 0.9728; train_kl_reg_loss: 11219.5172; train_edge_recon_loss: 108884.5478; train_gene_expr_recon_loss: 2930512.6958; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25291.5033; train_global_loss: 3075908.2667; train_optim_loss: 3075908.2667; val_kl_reg_loss: 11227.8047; val_edge_recon_loss: 106795.6234; val_gene_expr_recon_loss: 2929068.3659; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25390.1797; val_global_loss: 3072482.0362; val_optim_loss: 3072482.0362
Epoch 22/100 |████----------------| 22.0% val_auroc_score: 0.9702; val_auprc_score: 0.9895; val_best_acc_score: 0.9526; val_best_f1_score: 0.9706; train_kl_reg_loss: 11193.7549; train_edge_recon_loss: 108620.7231; train_gene_expr_recon_loss: 2928971.6464; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25294.0724; train_global_loss: 3074080.2011; train_optim_loss: 3074080.2011; val_kl_reg_loss: 11086.9365; val_edge_recon_loss: 109383.3832; val_gene_expr_recon_loss: 2926488.2428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25160.8223; val_global_loss: 3072119.3007; val_optim_loss: 3072119.3007
Epoch 23/100 |████----------------| 23.0% val_auroc_score: 0.9705; val_auprc_score: 0.9900; val_best_acc_score: 0.9549; val_best_f1_score: 0.9721; train_kl_reg_loss: 11144.7951; train_edge_recon_loss: 108927.2825; train_gene_expr_recon_loss: 2927263.2166; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25268.8572; train_global_loss: 3072604.1533; train_optim_loss: 3072604.1533; val_kl_reg_loss: 11221.9889; val_edge_recon_loss: 106692.4397; val_gene_expr_recon_loss: 2925589.5797; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25131.0859; val_global_loss: 3068635.0000; val_optim_loss: 3068635.0000
Epoch 24/100 |████----------------| 24.0% val_auroc_score: 0.9712; val_auprc_score: 0.9897; val_best_acc_score: 0.9550; val_best_f1_score: 0.9723; train_kl_reg_loss: 11127.2216; train_edge_recon_loss: 108843.9346; train_gene_expr_recon_loss: 2926559.0281; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25295.2845; train_global_loss: 3071825.4682; train_optim_loss: 3071825.4682; val_kl_reg_loss: 11005.4662; val_edge_recon_loss: 106324.0742; val_gene_expr_recon_loss: 2925331.7971; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25269.3438; val_global_loss: 3067930.5870; val_optim_loss: 3067930.5870
Epoch 25/100 |█████---------------| 25.0% val_auroc_score: 0.9682; val_auprc_score: 0.9895; val_best_acc_score: 0.9550; val_best_f1_score: 0.9723; train_kl_reg_loss: 11106.6914; train_edge_recon_loss: 108549.3216; train_gene_expr_recon_loss: 2925810.5216; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 25228.5537; train_global_loss: 3070695.0930; train_optim_loss: 3070695.0930; val_kl_reg_loss: 11152.1717; val_edge_recon_loss: 107299.5787; val_gene_expr_recon_loss: 2924258.7174; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 25204.5273; val_global_loss: 3067914.9746; val_optim_loss: 3067914.9746
Epoch 26/100 |█████---------------| 26.0% val_auroc_score: 0.9687; val_auprc_score: 0.9890; val_best_acc_score: 0.9509; val_best_f1_score: 0.9697; train_kl_reg_loss: 10284.0237; train_edge_recon_loss: 108074.4937; train_gene_expr_recon_loss: 2924758.6521; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23612.4211; train_global_loss: 3066729.5934; train_optim_loss: 3066729.5934; val_kl_reg_loss: 10150.4127; val_edge_recon_loss: 106536.1242; val_gene_expr_recon_loss: 2921121.0000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23761.1621; val_global_loss: 3061568.7935; val_optim_loss: 3061568.7935
Epoch 27/100 |█████---------------| 27.0% val_auroc_score: 0.9696; val_auprc_score: 0.9895; val_best_acc_score: 0.9523; val_best_f1_score: 0.9704; train_kl_reg_loss: 10180.1278; train_edge_recon_loss: 107646.2691; train_gene_expr_recon_loss: 2924200.2936; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23590.4414; train_global_loss: 3065617.1277; train_optim_loss: 3065617.1277; val_kl_reg_loss: 10089.4792; val_edge_recon_loss: 109923.7317; val_gene_expr_recon_loss: 2924560.5000; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23420.5371; val_global_loss: 3067994.1993; val_optim_loss: 3067994.1993
Epoch 28/100 |█████---------------| 28.0% val_auroc_score: 0.9715; val_auprc_score: 0.9909; val_best_acc_score: 0.9554; val_best_f1_score: 0.9724; train_kl_reg_loss: 10157.6646; train_edge_recon_loss: 108212.5923; train_gene_expr_recon_loss: 2923775.1937; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23559.5559; train_global_loss: 3065705.0061; train_optim_loss: 3065705.0061; val_kl_reg_loss: 10093.8150; val_edge_recon_loss: 107085.0700; val_gene_expr_recon_loss: 2922339.6703; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23562.7559; val_global_loss: 3063081.3080; val_optim_loss: 3063081.3080
Epoch 29/100 |█████---------------| 29.0% val_auroc_score: 0.9702; val_auprc_score: 0.9903; val_best_acc_score: 0.9513; val_best_f1_score: 0.9699; train_kl_reg_loss: 10117.8986; train_edge_recon_loss: 108638.1828; train_gene_expr_recon_loss: 2923218.4498; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23503.2948; train_global_loss: 3065477.8230; train_optim_loss: 3065477.8230; val_kl_reg_loss: 10023.3193; val_edge_recon_loss: 111335.8647; val_gene_expr_recon_loss: 2921220.8007; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23610.2598; val_global_loss: 3066190.2391; val_optim_loss: 3066190.2391
Epoch 30/100 |██████--------------| 30.0% val_auroc_score: 0.9714; val_auprc_score: 0.9902; val_best_acc_score: 0.9528; val_best_f1_score: 0.9707; train_kl_reg_loss: 10105.5557; train_edge_recon_loss: 107749.0375; train_gene_expr_recon_loss: 2922171.8487; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 23446.7978; train_global_loss: 3063473.2410; train_optim_loss: 3063473.2410; val_kl_reg_loss: 9961.8465; val_edge_recon_loss: 110669.5897; val_gene_expr_recon_loss: 2923526.1341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 23521.5020; val_global_loss: 3067679.0652; val_optim_loss: 3067679.0652

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 31/100 |██████--------------| 31.0% val_auroc_score: 0.9719; val_auprc_score: 0.9903; val_best_acc_score: 0.9555; val_best_f1_score: 0.9725; train_kl_reg_loss: 10374.2551; train_edge_recon_loss: 107674.9810; train_gene_expr_recon_loss: 2913888.3532; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 19348.1283; train_global_loss: 3051285.7149; train_optim_loss: 3051285.7149; val_kl_reg_loss: 10580.1764; val_edge_recon_loss: 109881.2415; val_gene_expr_recon_loss: 2911987.1196; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18721.3320; val_global_loss: 3051169.7971; val_optim_loss: 3051169.7971
Epoch 32/100 |██████--------------| 32.0% val_auroc_score: 0.9717; val_auprc_score: 0.9903; val_best_acc_score: 0.9545; val_best_f1_score: 0.9719; train_kl_reg_loss: 10769.3228; train_edge_recon_loss: 107244.4201; train_gene_expr_recon_loss: 2913376.4180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18439.9159; train_global_loss: 3049830.0754; train_optim_loss: 3049830.0754; val_kl_reg_loss: 10937.0968; val_edge_recon_loss: 108864.7858; val_gene_expr_recon_loss: 2911949.9420; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18110.6504; val_global_loss: 3049862.5761; val_optim_loss: 3049862.5761
Epoch 33/100 |██████--------------| 33.0% val_auroc_score: 0.9689; val_auprc_score: 0.9876; val_best_acc_score: 0.9526; val_best_f1_score: 0.9705; train_kl_reg_loss: 11145.1270; train_edge_recon_loss: 107824.3930; train_gene_expr_recon_loss: 2913452.0502; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18003.5457; train_global_loss: 3050425.1191; train_optim_loss: 3050425.1191; val_kl_reg_loss: 11273.2068; val_edge_recon_loss: 112402.0816; val_gene_expr_recon_loss: 2913310.3949; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17821.8535; val_global_loss: 3054807.4275; val_optim_loss: 3054807.4275
Epoch 34/100 |██████--------------| 34.0% val_auroc_score: 0.9713; val_auprc_score: 0.9903; val_best_acc_score: 0.9554; val_best_f1_score: 0.9725; train_kl_reg_loss: 11447.6846; train_edge_recon_loss: 107576.5032; train_gene_expr_recon_loss: 2913207.8030; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17669.1306; train_global_loss: 3049901.1207; train_optim_loss: 3049901.1207; val_kl_reg_loss: 11532.8493; val_edge_recon_loss: 108131.3339; val_gene_expr_recon_loss: 2911795.1159; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17545.1270; val_global_loss: 3049004.5399; val_optim_loss: 3049004.5399
Epoch 35/100 |███████-------------| 35.0% val_auroc_score: 0.9731; val_auprc_score: 0.9905; val_best_acc_score: 0.9540; val_best_f1_score: 0.9712; train_kl_reg_loss: 11718.5187; train_edge_recon_loss: 107501.5027; train_gene_expr_recon_loss: 2912495.6346; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17394.0748; train_global_loss: 3049109.7276; train_optim_loss: 3049109.7276; val_kl_reg_loss: 11771.6985; val_edge_recon_loss: 112476.9872; val_gene_expr_recon_loss: 2910745.2428; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17310.2266; val_global_loss: 3052304.1812; val_optim_loss: 3052304.1812
Epoch 36/100 |███████-------------| 36.0% val_auroc_score: 0.9717; val_auprc_score: 0.9900; val_best_acc_score: 0.9555; val_best_f1_score: 0.9725; train_kl_reg_loss: 11953.0053; train_edge_recon_loss: 107251.1877; train_gene_expr_recon_loss: 2912533.0379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17180.4507; train_global_loss: 3048917.6737; train_optim_loss: 3048917.6737; val_kl_reg_loss: 12012.2821; val_edge_recon_loss: 107207.0756; val_gene_expr_recon_loss: 2911575.2101; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17076.4062; val_global_loss: 3047871.0725; val_optim_loss: 3047871.0725
Epoch 37/100 |███████-------------| 37.0% val_auroc_score: 0.9726; val_auprc_score: 0.9904; val_best_acc_score: 0.9549; val_best_f1_score: 0.9721; train_kl_reg_loss: 12137.1677; train_edge_recon_loss: 107322.4532; train_gene_expr_recon_loss: 2911936.0379; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17017.7774; train_global_loss: 3048413.4311; train_optim_loss: 3048413.4311; val_kl_reg_loss: 12137.9331; val_edge_recon_loss: 106942.8586; val_gene_expr_recon_loss: 2909841.0725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16971.1270; val_global_loss: 3045893.1159; val_optim_loss: 3045893.1159
Epoch 38/100 |███████-------------| 38.0% val_auroc_score: 0.9726; val_auprc_score: 0.9899; val_best_acc_score: 0.9564; val_best_f1_score: 0.9730; train_kl_reg_loss: 12302.2214; train_edge_recon_loss: 107612.2182; train_gene_expr_recon_loss: 2912163.4197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16894.2617; train_global_loss: 3048972.1203; train_optim_loss: 3048972.1203; val_kl_reg_loss: 12351.6945; val_edge_recon_loss: 105063.6008; val_gene_expr_recon_loss: 2911261.0725; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16858.6777; val_global_loss: 3045535.1123; val_optim_loss: 3045535.1123
Epoch 39/100 |███████-------------| 39.0% val_auroc_score: 0.9725; val_auprc_score: 0.9912; val_best_acc_score: 0.9569; val_best_f1_score: 0.9734; train_kl_reg_loss: 12416.4694; train_edge_recon_loss: 108411.2271; train_gene_expr_recon_loss: 2911839.3234; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16779.6657; train_global_loss: 3049446.6823; train_optim_loss: 3049446.6823; val_kl_reg_loss: 12471.6903; val_edge_recon_loss: 108216.7884; val_gene_expr_recon_loss: 2910789.2536; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16730.9082; val_global_loss: 3048208.7355; val_optim_loss: 3048208.7355
Epoch 40/100 |████████------------| 40.0% val_auroc_score: 0.9721; val_auprc_score: 0.9908; val_best_acc_score: 0.9555; val_best_f1_score: 0.9724; train_kl_reg_loss: 12516.2653; train_edge_recon_loss: 107086.1341; train_gene_expr_recon_loss: 2911595.6126; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16679.1719; train_global_loss: 3047877.1778; train_optim_loss: 3047877.1778; val_kl_reg_loss: 12515.3789; val_edge_recon_loss: 108704.0191; val_gene_expr_recon_loss: 2910634.4783; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16642.7754; val_global_loss: 3048496.6341; val_optim_loss: 3048496.6341
Epoch 41/100 |████████------------| 41.0% val_auroc_score: 0.9713; val_auprc_score: 0.9901; val_best_acc_score: 0.9549; val_best_f1_score: 0.9720; train_kl_reg_loss: 12618.6772; train_edge_recon_loss: 107182.5706; train_gene_expr_recon_loss: 2911504.1142; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16610.9436; train_global_loss: 3047916.3018; train_optim_loss: 3047916.3018; val_kl_reg_loss: 12588.5983; val_edge_recon_loss: 111730.4915; val_gene_expr_recon_loss: 2911104.0507; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16512.2617; val_global_loss: 3051935.3986; val_optim_loss: 3051935.3986
Epoch 42/100 |████████------------| 42.0% val_auroc_score: 0.9712; val_auprc_score: 0.9898; val_best_acc_score: 0.9549; val_best_f1_score: 0.9721; train_kl_reg_loss: 12698.2365; train_edge_recon_loss: 107525.4627; train_gene_expr_recon_loss: 2911631.1064; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16539.0803; train_global_loss: 3048393.8850; train_optim_loss: 3048393.8850; val_kl_reg_loss: 12668.4634; val_edge_recon_loss: 110388.6318; val_gene_expr_recon_loss: 2911331.9819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16537.1973; val_global_loss: 3050926.3188; val_optim_loss: 3050926.3188

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 43/100 |████████------------| 43.0% val_auroc_score: 0.9717; val_auprc_score: 0.9899; val_best_acc_score: 0.9556; val_best_f1_score: 0.9726; train_kl_reg_loss: 12755.6825; train_edge_recon_loss: 108128.4523; train_gene_expr_recon_loss: 2910717.4531; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16072.1800; train_global_loss: 3047673.7732; train_optim_loss: 3047673.7732; val_kl_reg_loss: 12741.7331; val_edge_recon_loss: 105881.1586; val_gene_expr_recon_loss: 2909579.0616; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15992.8525; val_global_loss: 3044194.7029; val_optim_loss: 3044194.7029
Epoch 44/100 |████████------------| 44.0% val_auroc_score: 0.9738; val_auprc_score: 0.9914; val_best_acc_score: 0.9556; val_best_f1_score: 0.9726; train_kl_reg_loss: 12766.3232; train_edge_recon_loss: 107112.8724; train_gene_expr_recon_loss: 2910198.5485; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15965.2503; train_global_loss: 3046042.9927; train_optim_loss: 3046042.9927; val_kl_reg_loss: 12736.2184; val_edge_recon_loss: 108134.3886; val_gene_expr_recon_loss: 2908663.4167; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15938.7451; val_global_loss: 3045472.7717; val_optim_loss: 3045472.7717
Epoch 45/100 |█████████-----------| 45.0% val_auroc_score: 0.9707; val_auprc_score: 0.9899; val_best_acc_score: 0.9577; val_best_f1_score: 0.9738; train_kl_reg_loss: 12798.3569; train_edge_recon_loss: 107036.2234; train_gene_expr_recon_loss: 2910710.7590; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15925.8382; train_global_loss: 3046471.1746; train_optim_loss: 3046471.1746; val_kl_reg_loss: 12776.7105; val_edge_recon_loss: 107713.5448; val_gene_expr_recon_loss: 2910451.9565; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15913.3721; val_global_loss: 3046855.4493; val_optim_loss: 3046855.4493
Epoch 46/100 |█████████-----------| 46.0% val_auroc_score: 0.9710; val_auprc_score: 0.9901; val_best_acc_score: 0.9543; val_best_f1_score: 0.9717; train_kl_reg_loss: 12826.6570; train_edge_recon_loss: 106900.2664; train_gene_expr_recon_loss: 2910479.4250; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15908.6249; train_global_loss: 3046114.9678; train_optim_loss: 3046114.9678; val_kl_reg_loss: 12795.9534; val_edge_recon_loss: 108658.5675; val_gene_expr_recon_loss: 2909520.7355; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15895.8213; val_global_loss: 3046871.0145; val_optim_loss: 3046871.0145
Epoch 47/100 |█████████-----------| 47.0% val_auroc_score: 0.9710; val_auprc_score: 0.9907; val_best_acc_score: 0.9550; val_best_f1_score: 0.9723; train_kl_reg_loss: 12841.9266; train_edge_recon_loss: 106945.4477; train_gene_expr_recon_loss: 2910579.6077; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15888.6260; train_global_loss: 3046255.6117; train_optim_loss: 3046255.6117; val_kl_reg_loss: 12824.1325; val_edge_recon_loss: 105375.3811; val_gene_expr_recon_loss: 2908893.8406; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15877.3994; val_global_loss: 3042970.8478; val_optim_loss: 3042970.8478
Epoch 48/100 |█████████-----------| 48.0% val_auroc_score: 0.9745; val_auprc_score: 0.9912; val_best_acc_score: 0.9562; val_best_f1_score: 0.9729; train_kl_reg_loss: 12866.0772; train_edge_recon_loss: 107011.8070; train_gene_expr_recon_loss: 2910237.0754; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15869.2269; train_global_loss: 3045984.1823; train_optim_loss: 3045984.1823; val_kl_reg_loss: 12875.3692; val_edge_recon_loss: 106029.9775; val_gene_expr_recon_loss: 2909485.1341; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15865.3086; val_global_loss: 3044255.7319; val_optim_loss: 3044255.7319
Epoch 49/100 |█████████-----------| 49.0% val_auroc_score: 0.9721; val_auprc_score: 0.9899; val_best_acc_score: 0.9558; val_best_f1_score: 0.9726; train_kl_reg_loss: 12885.1263; train_edge_recon_loss: 107641.7755; train_gene_expr_recon_loss: 2910234.1619; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15856.1740; train_global_loss: 3046617.2414; train_optim_loss: 3046617.2414; val_kl_reg_loss: 12847.9595; val_edge_recon_loss: 109284.5094; val_gene_expr_recon_loss: 2910425.5833; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15832.7715; val_global_loss: 3048390.8007; val_optim_loss: 3048390.8007
Epoch 50/100 |██████████----------| 50.0% val_auroc_score: 0.9724; val_auprc_score: 0.9908; val_best_acc_score: 0.9559; val_best_f1_score: 0.9728; train_kl_reg_loss: 12895.3203; train_edge_recon_loss: 107544.2773; train_gene_expr_recon_loss: 2909900.5208; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15835.0724; train_global_loss: 3046175.1945; train_optim_loss: 3046175.1945; val_kl_reg_loss: 12909.5714; val_edge_recon_loss: 107670.3337; val_gene_expr_recon_loss: 2909113.0399; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15813.8711; val_global_loss: 3045506.6957; val_optim_loss: 3045506.6957
Epoch 51/100 |██████████----------| 51.0% val_auroc_score: 0.9704; val_auprc_score: 0.9889; val_best_acc_score: 0.9540; val_best_f1_score: 0.9716; train_kl_reg_loss: 12933.7066; train_edge_recon_loss: 107866.0642; train_gene_expr_recon_loss: 2909644.2635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15814.1237; train_global_loss: 3046258.1627; train_optim_loss: 3046258.1627; val_kl_reg_loss: 12868.5044; val_edge_recon_loss: 110534.0425; val_gene_expr_recon_loss: 2908716.4819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15811.7725; val_global_loss: 3047930.7935; val_optim_loss: 3047930.7935

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 52/100 |██████████----------| 52.0% val_auroc_score: 0.9734; val_auprc_score: 0.9910; val_best_acc_score: 0.9557; val_best_f1_score: 0.9726; train_kl_reg_loss: 12939.8542; train_edge_recon_loss: 107482.2780; train_gene_expr_recon_loss: 2909761.0653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15764.8168; train_global_loss: 3045948.0090; train_optim_loss: 3045948.0090; val_kl_reg_loss: 12906.1103; val_edge_recon_loss: 106021.6661; val_gene_expr_recon_loss: 2908620.6268; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15752.2373; val_global_loss: 3043300.6558; val_optim_loss: 3043300.6558
Epoch 53/100 |██████████----------| 53.0% val_auroc_score: 0.9713; val_auprc_score: 0.9894; val_best_acc_score: 0.9548; val_best_f1_score: 0.9719; train_kl_reg_loss: 12947.2670; train_edge_recon_loss: 107206.4723; train_gene_expr_recon_loss: 2910117.5285; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15747.8080; train_global_loss: 3046019.0820; train_optim_loss: 3046019.0820; val_kl_reg_loss: 12907.1840; val_edge_recon_loss: 109036.4166; val_gene_expr_recon_loss: 2907462.0036; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15744.6016; val_global_loss: 3045150.0870; val_optim_loss: 3045150.0870
Epoch 54/100 |██████████----------| 54.0% val_auroc_score: 0.9746; val_auprc_score: 0.9918; val_best_acc_score: 0.9578; val_best_f1_score: 0.9740; train_kl_reg_loss: 12948.0167; train_edge_recon_loss: 107492.4246; train_gene_expr_recon_loss: 2909626.1635; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15741.0360; train_global_loss: 3045807.6334; train_optim_loss: 3045807.6334; val_kl_reg_loss: 12937.9444; val_edge_recon_loss: 105180.0590; val_gene_expr_recon_loss: 2909101.3877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15738.6436; val_global_loss: 3042958.1449; val_optim_loss: 3042958.1449
Epoch 55/100 |███████████---------| 55.0% val_auroc_score: 0.9728; val_auprc_score: 0.9914; val_best_acc_score: 0.9559; val_best_f1_score: 0.9727; train_kl_reg_loss: 12950.0420; train_edge_recon_loss: 107197.6659; train_gene_expr_recon_loss: 2909667.0918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15736.2572; train_global_loss: 3045551.0457; train_optim_loss: 3045551.0457; val_kl_reg_loss: 12924.8277; val_edge_recon_loss: 109482.5876; val_gene_expr_recon_loss: 2909419.7065; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15734.9502; val_global_loss: 3047562.1159; val_optim_loss: 3047562.1159
Epoch 56/100 |███████████---------| 56.0% val_auroc_score: 0.9725; val_auprc_score: 0.9901; val_best_acc_score: 0.9554; val_best_f1_score: 0.9723; train_kl_reg_loss: 12940.6862; train_edge_recon_loss: 107431.9103; train_gene_expr_recon_loss: 2909735.0000; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15734.3923; train_global_loss: 3045841.9931; train_optim_loss: 3045841.9931; val_kl_reg_loss: 12932.9345; val_edge_recon_loss: 108478.2540; val_gene_expr_recon_loss: 2909179.1848; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15732.0811; val_global_loss: 3046322.3659; val_optim_loss: 3046322.3659
Epoch 57/100 |███████████---------| 57.0% val_auroc_score: 0.9705; val_auprc_score: 0.9892; val_best_acc_score: 0.9552; val_best_f1_score: 0.9723; train_kl_reg_loss: 12947.3507; train_edge_recon_loss: 107417.3118; train_gene_expr_recon_loss: 2909719.8993; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15731.4505; train_global_loss: 3045816.0037; train_optim_loss: 3045816.0037; val_kl_reg_loss: 12945.9425; val_edge_recon_loss: 108194.2815; val_gene_expr_recon_loss: 2908973.5145; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15729.6182; val_global_loss: 3045843.2391; val_optim_loss: 3045843.2391
Epoch 58/100 |███████████---------| 58.0% val_auroc_score: 0.9725; val_auprc_score: 0.9909; val_best_acc_score: 0.9563; val_best_f1_score: 0.9730; train_kl_reg_loss: 12954.7589; train_edge_recon_loss: 106960.0062; train_gene_expr_recon_loss: 2909570.8723; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15729.0292; train_global_loss: 3045214.6676; train_optim_loss: 3045214.6676; val_kl_reg_loss: 12930.6542; val_edge_recon_loss: 110649.2660; val_gene_expr_recon_loss: 2909632.6775; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15728.1387; val_global_loss: 3048940.8587; val_optim_loss: 3048940.8587

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 59/100 |███████████---------| 59.0% val_auroc_score: 0.9715; val_auprc_score: 0.9900; val_best_acc_score: 0.9554; val_best_f1_score: 0.9725; train_kl_reg_loss: 12943.2317; train_edge_recon_loss: 108179.6106; train_gene_expr_recon_loss: 2909786.4144; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15723.6556; train_global_loss: 3046632.9123; train_optim_loss: 3046632.9123; val_kl_reg_loss: 12897.5989; val_edge_recon_loss: 109288.6437; val_gene_expr_recon_loss: 2909546.6232; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15722.4570; val_global_loss: 3047455.3623; val_optim_loss: 3047455.3623
Epoch 60/100 |████████████--------| 60.0% val_auroc_score: 0.9725; val_auprc_score: 0.9901; val_best_acc_score: 0.9547; val_best_f1_score: 0.9719; train_kl_reg_loss: 12953.5144; train_edge_recon_loss: 107067.0715; train_gene_expr_recon_loss: 2909328.6864; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15721.8972; train_global_loss: 3045071.1648; train_optim_loss: 3045071.1648; val_kl_reg_loss: 12914.6295; val_edge_recon_loss: 109330.6627; val_gene_expr_recon_loss: 2908745.4239; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15721.5342; val_global_loss: 3046712.2138; val_optim_loss: 3046712.2138
Epoch 61/100 |████████████--------| 61.0% val_auroc_score: 0.9726; val_auprc_score: 0.9895; val_best_acc_score: 0.9575; val_best_f1_score: 0.9739; train_kl_reg_loss: 12944.3730; train_edge_recon_loss: 107995.6490; train_gene_expr_recon_loss: 2910258.1835; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15721.2739; train_global_loss: 3046919.4943; train_optim_loss: 3046919.4943; val_kl_reg_loss: 12937.6680; val_edge_recon_loss: 105106.0435; val_gene_expr_recon_loss: 2909838.5254; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15720.9375; val_global_loss: 3043603.2428; val_optim_loss: 3043603.2428
Epoch 62/100 |████████████--------| 62.0% val_auroc_score: 0.9729; val_auprc_score: 0.9907; val_best_acc_score: 0.9574; val_best_f1_score: 0.9736; train_kl_reg_loss: 12956.3378; train_edge_recon_loss: 108126.8103; train_gene_expr_recon_loss: 2909695.5991; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15720.7352; train_global_loss: 3046499.4747; train_optim_loss: 3046499.4747; val_kl_reg_loss: 12932.2058; val_edge_recon_loss: 111068.9835; val_gene_expr_recon_loss: 2909280.5978; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15720.6045; val_global_loss: 3049002.3007; val_optim_loss: 3049002.3007

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 184 min 52 sec.
Using best model state, which was in epoch 54.

--- MODEL EVALUATION ---
val AUROC score: 0.9727
val AUPRC score: 0.9911
val best accuracy score: 0.9557
val best F1 score: 0.9727
val target rna MSE score: 0.9342
val source rna MSE score: 0.3868
Val cat covariate0 mean sim diff: -0.0034

Finished model training...

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
