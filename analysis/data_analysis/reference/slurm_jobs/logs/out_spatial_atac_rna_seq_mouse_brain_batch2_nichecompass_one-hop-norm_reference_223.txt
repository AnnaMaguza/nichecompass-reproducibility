[True]
Run timestamp: 10102023_095009_223.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.001', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_223']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.001
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6652; val_auprc_score: 0.6547; val_best_acc_score: 0.5064; val_best_f1_score: 0.6694; train_kl_reg_loss: 60357.3511; train_edge_recon_loss: 742870.6193; train_gene_expr_recon_loss: 23127713.4545; train_masked_gp_l1_reg_loss: 62810.5107; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 6171214.6439; train_chrom_access_recon_loss: 6890685.2348; train_global_loss: 37055652.0606; train_optim_loss: 37055652.0606; val_kl_reg_loss: 86235.0117; val_edge_recon_loss: 813011.1172; val_gene_expr_recon_loss: 21265380.7500; val_masked_gp_l1_reg_loss: 71518.1172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3556227.5000; val_chrom_access_recon_loss: 6648802.4375; val_global_loss: 32441175.5000; val_optim_loss: 32441175.5000
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6663; val_auprc_score: 0.6473; val_best_acc_score: 0.5510; val_best_f1_score: 0.6842; train_kl_reg_loss: 83170.9634; train_edge_recon_loss: 743522.6562; train_gene_expr_recon_loss: 21296706.4545; train_masked_gp_l1_reg_loss: 70789.4814; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 2002459.8030; train_chrom_access_recon_loss: 6580710.1818; train_global_loss: 30777359.5455; train_optim_loss: 30777359.5455; val_kl_reg_loss: 84155.4502; val_edge_recon_loss: 812479.7344; val_gene_expr_recon_loss: 21062673.2500; val_masked_gp_l1_reg_loss: 70296.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 997989.7500; val_chrom_access_recon_loss: 6644097.9375; val_global_loss: 29671692.0000; val_optim_loss: 29671692.0000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7352; val_auprc_score: 0.7243; val_best_acc_score: 0.6158; val_best_f1_score: 0.7064; train_kl_reg_loss: 74954.1262; train_edge_recon_loss: 737335.9877; train_gene_expr_recon_loss: 21030349.6970; train_masked_gp_l1_reg_loss: 71120.4229; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 655848.6837; train_chrom_access_recon_loss: 6532375.3258; train_global_loss: 29101984.3030; train_optim_loss: 29101984.3030; val_kl_reg_loss: 73735.4404; val_edge_recon_loss: 811184.0938; val_gene_expr_recon_loss: 20718185.2500; val_masked_gp_l1_reg_loss: 71319.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 427187.2500; val_chrom_access_recon_loss: 6620500.8750; val_global_loss: 28722113.5000; val_optim_loss: 28722113.5000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7951; val_auprc_score: 0.7839; val_best_acc_score: 0.7249; val_best_f1_score: 0.7269; train_kl_reg_loss: 69833.8415; train_edge_recon_loss: 733025.8902; train_gene_expr_recon_loss: 20875012.8182; train_masked_gp_l1_reg_loss: 71566.1320; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 325965.8277; train_chrom_access_recon_loss: 6501566.8788; train_global_loss: 28576971.3333; train_optim_loss: 28576971.3333; val_kl_reg_loss: 64061.1846; val_edge_recon_loss: 804012.5938; val_gene_expr_recon_loss: 20756993.0000; val_masked_gp_l1_reg_loss: 71950.1250; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 253126.5312; val_chrom_access_recon_loss: 6623442.5000; val_global_loss: 28573585.7500; val_optim_loss: 28573585.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8425; val_auprc_score: 0.8142; val_best_acc_score: 0.7574; val_best_f1_score: 0.7873; train_kl_reg_loss: 64972.0662; train_edge_recon_loss: 725859.4271; train_gene_expr_recon_loss: 20712946.0000; train_masked_gp_l1_reg_loss: 72383.1046; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 217007.5885; train_chrom_access_recon_loss: 6448486.2273; train_global_loss: 28241654.4242; train_optim_loss: 28241654.4242; val_kl_reg_loss: 64797.9878; val_edge_recon_loss: 784182.9688; val_gene_expr_recon_loss: 20332072.5000; val_masked_gp_l1_reg_loss: 72924.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 191992.0625; val_chrom_access_recon_loss: 6430485.0625; val_global_loss: 27876454.7500; val_optim_loss: 27876454.7500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8747; val_auprc_score: 0.8431; val_best_acc_score: 0.7982; val_best_f1_score: 0.8179; train_kl_reg_loss: 61944.0285; train_edge_recon_loss: 707512.2973; train_gene_expr_recon_loss: 20557360.8182; train_masked_gp_l1_reg_loss: 73905.6905; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 181172.2041; train_chrom_access_recon_loss: 6410622.2879; train_global_loss: 27992517.3030; train_optim_loss: 27992517.3030; val_kl_reg_loss: 62534.2002; val_edge_recon_loss: 706495.6016; val_gene_expr_recon_loss: 20352862.2500; val_masked_gp_l1_reg_loss: 74768.6641; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 171710.6250; val_chrom_access_recon_loss: 6506766.6250; val_global_loss: 27875135.7500; val_optim_loss: 27875135.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8763; val_auprc_score: 0.8468; val_best_acc_score: 0.8031; val_best_f1_score: 0.8233; train_kl_reg_loss: 70365.8176; train_edge_recon_loss: 656611.8561; train_gene_expr_recon_loss: 20459763.7576; train_masked_gp_l1_reg_loss: 75975.3075; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 164093.6016; train_chrom_access_recon_loss: 6389671.2273; train_global_loss: 27816481.5455; train_optim_loss: 27816481.5455; val_kl_reg_loss: 76245.7139; val_edge_recon_loss: 632959.4766; val_gene_expr_recon_loss: 20259893.0000; val_masked_gp_l1_reg_loss: 77148.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 157184.9688; val_chrom_access_recon_loss: 6435061.7500; val_global_loss: 27638492.0000; val_optim_loss: 27638492.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8881; val_auprc_score: 0.8639; val_best_acc_score: 0.8141; val_best_f1_score: 0.8334; train_kl_reg_loss: 76113.6320; train_edge_recon_loss: 634024.3835; train_gene_expr_recon_loss: 20351320.7576; train_masked_gp_l1_reg_loss: 77991.0097; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 148455.9257; train_chrom_access_recon_loss: 6358853.6591; train_global_loss: 27646759.2121; train_optim_loss: 27646759.2121; val_kl_reg_loss: 75845.3525; val_edge_recon_loss: 627719.4219; val_gene_expr_recon_loss: 20226851.7500; val_masked_gp_l1_reg_loss: 78871.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 141954.6406; val_chrom_access_recon_loss: 6436005.5625; val_global_loss: 27587248.2500; val_optim_loss: 27587248.2500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8766; val_auprc_score: 0.8416; val_best_acc_score: 0.8071; val_best_f1_score: 0.8274; train_kl_reg_loss: 75498.9032; train_edge_recon_loss: 624865.4924; train_gene_expr_recon_loss: 20264128.5152; train_masked_gp_l1_reg_loss: 79522.0044; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 135790.7049; train_chrom_access_recon_loss: 6334724.2652; train_global_loss: 27514529.8788; train_optim_loss: 27514529.8788; val_kl_reg_loss: 73812.9092; val_edge_recon_loss: 624762.2734; val_gene_expr_recon_loss: 20064409.2500; val_masked_gp_l1_reg_loss: 80118.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 130559.3125; val_chrom_access_recon_loss: 6390247.8750; val_global_loss: 27363910.2500; val_optim_loss: 27363910.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8863; val_auprc_score: 0.8531; val_best_acc_score: 0.8127; val_best_f1_score: 0.8307; train_kl_reg_loss: 74007.0566; train_edge_recon_loss: 619802.1790; train_gene_expr_recon_loss: 20181271.3636; train_masked_gp_l1_reg_loss: 80661.3287; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 126663.8853; train_chrom_access_recon_loss: 6313346.6894; train_global_loss: 27395752.5455; train_optim_loss: 27395752.5455; val_kl_reg_loss: 74077.9404; val_edge_recon_loss: 617114.2578; val_gene_expr_recon_loss: 20053374.0000; val_masked_gp_l1_reg_loss: 81220.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 122393.0625; val_chrom_access_recon_loss: 6429192.1875; val_global_loss: 27377372.0000; val_optim_loss: 27377372.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8913; val_auprc_score: 0.8657; val_best_acc_score: 0.8162; val_best_f1_score: 0.8357; train_kl_reg_loss: 72732.9046; train_edge_recon_loss: 616918.4091; train_gene_expr_recon_loss: 20104800.1212; train_masked_gp_l1_reg_loss: 81564.1426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 119508.9961; train_chrom_access_recon_loss: 6284307.9242; train_global_loss: 27279832.3939; train_optim_loss: 27279832.3939; val_kl_reg_loss: 73572.9902; val_edge_recon_loss: 620863.8672; val_gene_expr_recon_loss: 19872134.2500; val_masked_gp_l1_reg_loss: 82100.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 116902.4609; val_chrom_access_recon_loss: 6338329.3750; val_global_loss: 27103902.5000; val_optim_loss: 27103902.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8942; val_auprc_score: 0.8631; val_best_acc_score: 0.8205; val_best_f1_score: 0.8384; train_kl_reg_loss: 72254.4382; train_edge_recon_loss: 611154.4044; train_gene_expr_recon_loss: 20048411.3030; train_masked_gp_l1_reg_loss: 82432.7884; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114742.3501; train_chrom_access_recon_loss: 6268414.7803; train_global_loss: 27197409.9697; train_optim_loss: 27197409.9697; val_kl_reg_loss: 72003.4697; val_edge_recon_loss: 621623.5625; val_gene_expr_recon_loss: 19963092.7500; val_masked_gp_l1_reg_loss: 82775.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 112879.9375; val_chrom_access_recon_loss: 6305742.2500; val_global_loss: 27158117.5000; val_optim_loss: 27158117.5000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9101; val_auprc_score: 0.8847; val_best_acc_score: 0.8377; val_best_f1_score: 0.8500; train_kl_reg_loss: 71017.4759; train_edge_recon_loss: 609241.6913; train_gene_expr_recon_loss: 19994772.6667; train_masked_gp_l1_reg_loss: 83146.1758; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 110624.1874; train_chrom_access_recon_loss: 6248038.6439; train_global_loss: 27116840.9697; train_optim_loss: 27116840.9697; val_kl_reg_loss: 70652.8711; val_edge_recon_loss: 608505.0156; val_gene_expr_recon_loss: 19833398.7500; val_masked_gp_l1_reg_loss: 83562.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 109868.2188; val_chrom_access_recon_loss: 6382854.9375; val_global_loss: 27088842.0000; val_optim_loss: 27088842.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9135; val_auprc_score: 0.8885; val_best_acc_score: 0.8461; val_best_f1_score: 0.8591; train_kl_reg_loss: 70078.6165; train_edge_recon_loss: 606060.2860; train_gene_expr_recon_loss: 19910525.6364; train_masked_gp_l1_reg_loss: 83833.5853; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108004.4640; train_chrom_access_recon_loss: 6228482.3030; train_global_loss: 27006985.0000; train_optim_loss: 27006985.0000; val_kl_reg_loss: 66858.3193; val_edge_recon_loss: 611532.4375; val_gene_expr_recon_loss: 19732262.2500; val_masked_gp_l1_reg_loss: 84233.3281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106343.2344; val_chrom_access_recon_loss: 6351576.5000; val_global_loss: 26952807.2500; val_optim_loss: 26952807.2500
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9221; val_auprc_score: 0.9036; val_best_acc_score: 0.8525; val_best_f1_score: 0.8626; train_kl_reg_loss: 69137.6265; train_edge_recon_loss: 605443.1714; train_gene_expr_recon_loss: 19853579.0909; train_masked_gp_l1_reg_loss: 84484.6606; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 105470.0917; train_chrom_access_recon_loss: 6203769.7955; train_global_loss: 26921884.3333; train_optim_loss: 26921884.3333; val_kl_reg_loss: 69465.7373; val_edge_recon_loss: 604763.7188; val_gene_expr_recon_loss: 19382820.7500; val_masked_gp_l1_reg_loss: 84936.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 105334.9844; val_chrom_access_recon_loss: 6187106.3125; val_global_loss: 26434426.2500; val_optim_loss: 26434426.2500
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9102; val_auprc_score: 0.8853; val_best_acc_score: 0.8439; val_best_f1_score: 0.8547; train_kl_reg_loss: 69234.4368; train_edge_recon_loss: 601797.7756; train_gene_expr_recon_loss: 19806243.0303; train_masked_gp_l1_reg_loss: 85149.0398; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104496.8774; train_chrom_access_recon_loss: 6191180.1894; train_global_loss: 26858101.4848; train_optim_loss: 26858101.4848; val_kl_reg_loss: 68302.2471; val_edge_recon_loss: 610778.0859; val_gene_expr_recon_loss: 19686772.2500; val_masked_gp_l1_reg_loss: 85556.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104496.8750; val_chrom_access_recon_loss: 6276424.9375; val_global_loss: 26832329.5000; val_optim_loss: 26832329.5000
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9210; val_auprc_score: 0.8940; val_best_acc_score: 0.8536; val_best_f1_score: 0.8645; train_kl_reg_loss: 67579.0952; train_edge_recon_loss: 601678.9110; train_gene_expr_recon_loss: 19751745.2424; train_masked_gp_l1_reg_loss: 85775.4672; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103972.4349; train_chrom_access_recon_loss: 6175130.8485; train_global_loss: 26785882.1515; train_optim_loss: 26785882.1515; val_kl_reg_loss: 67375.5850; val_edge_recon_loss: 608746.6719; val_gene_expr_recon_loss: 19555521.7500; val_masked_gp_l1_reg_loss: 86099.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104379.0547; val_chrom_access_recon_loss: 6238241.9375; val_global_loss: 26660365.7500; val_optim_loss: 26660365.7500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9283; val_auprc_score: 0.9068; val_best_acc_score: 0.8622; val_best_f1_score: 0.8684; train_kl_reg_loss: 67627.6155; train_edge_recon_loss: 599162.4432; train_gene_expr_recon_loss: 19690662.5152; train_masked_gp_l1_reg_loss: 86351.2249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104640.9497; train_chrom_access_recon_loss: 6154751.7803; train_global_loss: 26703196.4545; train_optim_loss: 26703196.4545; val_kl_reg_loss: 67165.5664; val_edge_recon_loss: 607442.8984; val_gene_expr_recon_loss: 19494976.5000; val_masked_gp_l1_reg_loss: 86696.8203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104688.5312; val_chrom_access_recon_loss: 6207970.2500; val_global_loss: 26568939.5000; val_optim_loss: 26568939.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9274; val_auprc_score: 0.8978; val_best_acc_score: 0.8721; val_best_f1_score: 0.8766; train_kl_reg_loss: 67323.5491; train_edge_recon_loss: 597070.4347; train_gene_expr_recon_loss: 19662778.6364; train_masked_gp_l1_reg_loss: 86891.9244; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 104615.6482; train_chrom_access_recon_loss: 6145265.4545; train_global_loss: 26663945.8182; train_optim_loss: 26663945.8182; val_kl_reg_loss: 65953.0527; val_edge_recon_loss: 605371.3906; val_gene_expr_recon_loss: 19609782.7500; val_masked_gp_l1_reg_loss: 86992.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 104531.0859; val_chrom_access_recon_loss: 6259211.8125; val_global_loss: 26731842.5000; val_optim_loss: 26731842.5000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9323; val_auprc_score: 0.9109; val_best_acc_score: 0.8684; val_best_f1_score: 0.8755; train_kl_reg_loss: 66956.1459; train_edge_recon_loss: 594436.7756; train_gene_expr_recon_loss: 19614286.2727; train_masked_gp_l1_reg_loss: 86104.2030; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80167.4806; train_chrom_access_recon_loss: 6127436.5985; train_global_loss: 26569387.3939; train_optim_loss: 26569387.3939; val_kl_reg_loss: 68100.1162; val_edge_recon_loss: 600724.7031; val_gene_expr_recon_loss: 19544812.5000; val_masked_gp_l1_reg_loss: 85608.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 73573.3828; val_chrom_access_recon_loss: 6196053.2500; val_global_loss: 26568872.7500; val_optim_loss: 26568872.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9222; val_auprc_score: 0.8888; val_best_acc_score: 0.8592; val_best_f1_score: 0.8688; train_kl_reg_loss: 68233.2389; train_edge_recon_loss: 592495.5871; train_gene_expr_recon_loss: 19605864.1818; train_masked_gp_l1_reg_loss: 85518.4647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72886.0378; train_chrom_access_recon_loss: 6123005.0227; train_global_loss: 26548002.5455; train_optim_loss: 26548002.5455; val_kl_reg_loss: 69037.6572; val_edge_recon_loss: 604537.4531; val_gene_expr_recon_loss: 19490826.5000; val_masked_gp_l1_reg_loss: 85472.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72430.0234; val_chrom_access_recon_loss: 6242081.7500; val_global_loss: 26564385.5000; val_optim_loss: 26564385.5000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9312; val_auprc_score: 0.9100; val_best_acc_score: 0.8673; val_best_f1_score: 0.8760; train_kl_reg_loss: 68459.4723; train_edge_recon_loss: 592850.5843; train_gene_expr_recon_loss: 19587309.8182; train_masked_gp_l1_reg_loss: 85464.5251; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72128.1516; train_chrom_access_recon_loss: 6117134.5758; train_global_loss: 26523347.3636; train_optim_loss: 26523347.3636; val_kl_reg_loss: 69369.2949; val_edge_recon_loss: 598747.7109; val_gene_expr_recon_loss: 19496264.0000; val_masked_gp_l1_reg_loss: 85463.3125; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71893.2969; val_chrom_access_recon_loss: 6214757.6875; val_global_loss: 26536496.7500; val_optim_loss: 26536496.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9283; val_auprc_score: 0.9068; val_best_acc_score: 0.8649; val_best_f1_score: 0.8715; train_kl_reg_loss: 68644.9144; train_edge_recon_loss: 593060.4915; train_gene_expr_recon_loss: 19586192.4848; train_masked_gp_l1_reg_loss: 85484.7812; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71610.4596; train_chrom_access_recon_loss: 6112608.5530; train_global_loss: 26517601.6970; train_optim_loss: 26517601.6970; val_kl_reg_loss: 69919.7891; val_edge_recon_loss: 605991.9297; val_gene_expr_recon_loss: 19359680.5000; val_masked_gp_l1_reg_loss: 85486.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71369.5547; val_chrom_access_recon_loss: 6161726.8750; val_global_loss: 26354174.7500; val_optim_loss: 26354174.7500
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9377; val_auprc_score: 0.9159; val_best_acc_score: 0.8802; val_best_f1_score: 0.8865; train_kl_reg_loss: 68841.3423; train_edge_recon_loss: 593230.9441; train_gene_expr_recon_loss: 19591959.6970; train_masked_gp_l1_reg_loss: 85479.0856; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71136.1732; train_chrom_access_recon_loss: 6116106.4091; train_global_loss: 26526753.3333; train_optim_loss: 26526753.3333; val_kl_reg_loss: 69006.9639; val_edge_recon_loss: 593930.9531; val_gene_expr_recon_loss: 19443084.5000; val_masked_gp_l1_reg_loss: 85501.7109; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70997.1328; val_chrom_access_recon_loss: 6215200.8125; val_global_loss: 26477723.5000; val_optim_loss: 26477723.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9361; val_auprc_score: 0.9128; val_best_acc_score: 0.8802; val_best_f1_score: 0.8865; train_kl_reg_loss: 68714.3942; train_edge_recon_loss: 591211.3504; train_gene_expr_recon_loss: 19585914.3030; train_masked_gp_l1_reg_loss: 85503.5362; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70753.3222; train_chrom_access_recon_loss: 6111646.0682; train_global_loss: 26513742.9697; train_optim_loss: 26513742.9697; val_kl_reg_loss: 69658.8604; val_edge_recon_loss: 594567.0000; val_gene_expr_recon_loss: 19523826.2500; val_masked_gp_l1_reg_loss: 85522.4844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70594.1875; val_chrom_access_recon_loss: 6199918.2500; val_global_loss: 26544087.0000; val_optim_loss: 26544087.0000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9262; val_auprc_score: 0.9047; val_best_acc_score: 0.8673; val_best_f1_score: 0.8763; train_kl_reg_loss: 67169.0287; train_edge_recon_loss: 720070.3987; train_gene_expr_recon_loss: 18367120.7273; train_masked_gp_l1_reg_loss: 85396.5917; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 69007.0801; train_chrom_access_recon_loss: 6189650.8333; train_global_loss: 25498414.5152; train_optim_loss: 25498414.5152; val_kl_reg_loss: 35238.4038; val_edge_recon_loss: 739811.3828; val_gene_expr_recon_loss: 18043419.0000; val_masked_gp_l1_reg_loss: 85138.5938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68429.9688; val_chrom_access_recon_loss: 5892835.8125; val_global_loss: 24864872.7500; val_optim_loss: 24864872.7500
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9304; val_auprc_score: 0.9131; val_best_acc_score: 0.8657; val_best_f1_score: 0.8752; train_kl_reg_loss: 66321.8641; train_edge_recon_loss: 705912.9337; train_gene_expr_recon_loss: 18197863.4848; train_masked_gp_l1_reg_loss: 84819.6138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68634.2866; train_chrom_access_recon_loss: 5791929.7576; train_global_loss: 24915482.1818; train_optim_loss: 24915482.1818; val_kl_reg_loss: 32263.8713; val_edge_recon_loss: 751293.8281; val_gene_expr_recon_loss: 18016722.7500; val_masked_gp_l1_reg_loss: 84483.9453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68919.8203; val_chrom_access_recon_loss: 5828403.1875; val_global_loss: 24782088.0000; val_optim_loss: 24782088.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9262; val_auprc_score: 0.9090; val_best_acc_score: 0.8624; val_best_f1_score: 0.8693; train_kl_reg_loss: 62232.8874; train_edge_recon_loss: 707452.5502; train_gene_expr_recon_loss: 18185026.8182; train_masked_gp_l1_reg_loss: 84168.5311; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68916.4126; train_chrom_access_recon_loss: 5763136.9848; train_global_loss: 24870934.2424; train_optim_loss: 24870934.2424; val_kl_reg_loss: 35427.9712; val_edge_recon_loss: 751701.1562; val_gene_expr_recon_loss: 18064669.7500; val_masked_gp_l1_reg_loss: 83857.1797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68915.1719; val_chrom_access_recon_loss: 5823778.9375; val_global_loss: 24828351.2500; val_optim_loss: 24828351.2500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9293; val_auprc_score: 0.9159; val_best_acc_score: 0.8630; val_best_f1_score: 0.8731; train_kl_reg_loss: 60027.3277; train_edge_recon_loss: 705669.9318; train_gene_expr_recon_loss: 18168225.6970; train_masked_gp_l1_reg_loss: 83562.7598; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68883.5588; train_chrom_access_recon_loss: 5744648.7727; train_global_loss: 24831017.8485; train_optim_loss: 24831017.8485; val_kl_reg_loss: 33436.1909; val_edge_recon_loss: 746025.9219; val_gene_expr_recon_loss: 18135839.5000; val_masked_gp_l1_reg_loss: 83257.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68782.7031; val_chrom_access_recon_loss: 5848403.5000; val_global_loss: 24915745.0000; val_optim_loss: 24915745.0000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9279; val_auprc_score: 0.9080; val_best_acc_score: 0.8665; val_best_f1_score: 0.8761; train_kl_reg_loss: 58580.8439; train_edge_recon_loss: 704409.9195; train_gene_expr_recon_loss: 18162561.7879; train_masked_gp_l1_reg_loss: 82964.5375; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68628.3699; train_chrom_access_recon_loss: 5734222.3333; train_global_loss: 24811367.7576; train_optim_loss: 24811367.7576; val_kl_reg_loss: 34111.0405; val_edge_recon_loss: 744653.0312; val_gene_expr_recon_loss: 18000734.5000; val_masked_gp_l1_reg_loss: 82665.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68469.3281; val_chrom_access_recon_loss: 5824686.3750; val_global_loss: 24755321.0000; val_optim_loss: 24755321.0000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9277; val_auprc_score: 0.9089; val_best_acc_score: 0.8563; val_best_f1_score: 0.8664; train_kl_reg_loss: 57141.3694; train_edge_recon_loss: 702681.6174; train_gene_expr_recon_loss: 18162983.3333; train_masked_gp_l1_reg_loss: 82380.2696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68322.6448; train_chrom_access_recon_loss: 5734855.1364; train_global_loss: 24808364.2121; train_optim_loss: 24808364.2121; val_kl_reg_loss: 33550.0254; val_edge_recon_loss: 742756.8906; val_gene_expr_recon_loss: 18096752.0000; val_masked_gp_l1_reg_loss: 82083.6016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68158.1328; val_chrom_access_recon_loss: 5843295.2500; val_global_loss: 24866595.7500; val_optim_loss: 24866595.7500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9280; val_auprc_score: 0.9079; val_best_acc_score: 0.8692; val_best_f1_score: 0.8775; train_kl_reg_loss: 55584.9911; train_edge_recon_loss: 700392.8314; train_gene_expr_recon_loss: 18151347.6061; train_masked_gp_l1_reg_loss: 81807.7583; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67996.6039; train_chrom_access_recon_loss: 5725789.3561; train_global_loss: 24782919.0909; train_optim_loss: 24782919.0909; val_kl_reg_loss: 33510.1694; val_edge_recon_loss: 735862.1562; val_gene_expr_recon_loss: 18070709.0000; val_masked_gp_l1_reg_loss: 81534.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67785.9219; val_chrom_access_recon_loss: 5773306.0625; val_global_loss: 24762707.2500; val_optim_loss: 24762707.2500
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9230; val_auprc_score: 0.8960; val_best_acc_score: 0.8659; val_best_f1_score: 0.8733; train_kl_reg_loss: 53911.2263; train_edge_recon_loss: 697534.0189; train_gene_expr_recon_loss: 18134105.9697; train_masked_gp_l1_reg_loss: 81250.3892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67600.5732; train_chrom_access_recon_loss: 5719661.3636; train_global_loss: 24754063.6667; train_optim_loss: 24754063.6667; val_kl_reg_loss: 32738.6392; val_edge_recon_loss: 730974.8125; val_gene_expr_recon_loss: 17967119.2500; val_masked_gp_l1_reg_loss: 80986.5703; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67466.1016; val_chrom_access_recon_loss: 5720476.3125; val_global_loss: 24599761.2500; val_optim_loss: 24599761.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9301; val_auprc_score: 0.9088; val_best_acc_score: 0.8603; val_best_f1_score: 0.8721; train_kl_reg_loss: 52555.3627; train_edge_recon_loss: 694190.0720; train_gene_expr_recon_loss: 18139322.7879; train_masked_gp_l1_reg_loss: 80715.8977; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67276.7308; train_chrom_access_recon_loss: 5718109.1591; train_global_loss: 24752169.8182; train_optim_loss: 24752169.8182; val_kl_reg_loss: 32751.4595; val_edge_recon_loss: 722533.9844; val_gene_expr_recon_loss: 17996509.0000; val_masked_gp_l1_reg_loss: 80447.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67089.8047; val_chrom_access_recon_loss: 5741349.3750; val_global_loss: 24640682.2500; val_optim_loss: 24640682.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9241; val_auprc_score: 0.8997; val_best_acc_score: 0.8667; val_best_f1_score: 0.8769; train_kl_reg_loss: 51005.9010; train_edge_recon_loss: 689983.4034; train_gene_expr_recon_loss: 18137266.6364; train_masked_gp_l1_reg_loss: 80195.1998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66916.8967; train_chrom_access_recon_loss: 5717529.2424; train_global_loss: 24742896.9697; train_optim_loss: 24742896.9697; val_kl_reg_loss: 32457.9736; val_edge_recon_loss: 714957.8516; val_gene_expr_recon_loss: 17942951.0000; val_masked_gp_l1_reg_loss: 79932.3438; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66724.4219; val_chrom_access_recon_loss: 5760105.6875; val_global_loss: 24597128.2500; val_optim_loss: 24597128.2500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9264; val_auprc_score: 0.9043; val_best_acc_score: 0.8632; val_best_f1_score: 0.8730; train_kl_reg_loss: 49972.7472; train_edge_recon_loss: 686352.8286; train_gene_expr_recon_loss: 18133262.1515; train_masked_gp_l1_reg_loss: 79689.0228; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66555.2431; train_chrom_access_recon_loss: 5716211.2121; train_global_loss: 24732043.2424; train_optim_loss: 24732043.2424; val_kl_reg_loss: 32631.2676; val_edge_recon_loss: 707623.2891; val_gene_expr_recon_loss: 17973637.0000; val_masked_gp_l1_reg_loss: 79457.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66395.8125; val_chrom_access_recon_loss: 5781987.4375; val_global_loss: 24641733.2500; val_optim_loss: 24641733.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9313; val_auprc_score: 0.9151; val_best_acc_score: 0.8657; val_best_f1_score: 0.8750; train_kl_reg_loss: 48611.5813; train_edge_recon_loss: 680530.0218; train_gene_expr_recon_loss: 18099596.4545; train_masked_gp_l1_reg_loss: 79234.8563; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 66158.5749; train_chrom_access_recon_loss: 5699101.5000; train_global_loss: 24673233.1212; train_optim_loss: 24673233.1212; val_kl_reg_loss: 31834.4602; val_edge_recon_loss: 695597.3359; val_gene_expr_recon_loss: 18120510.2500; val_masked_gp_l1_reg_loss: 79018.8906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65979.4297; val_chrom_access_recon_loss: 5807152.9375; val_global_loss: 24800093.0000; val_optim_loss: 24800093.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9278; val_auprc_score: 0.9034; val_best_acc_score: 0.8673; val_best_f1_score: 0.8741; train_kl_reg_loss: 47318.7824; train_edge_recon_loss: 672950.6922; train_gene_expr_recon_loss: 18101112.9394; train_masked_gp_l1_reg_loss: 78824.0339; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65797.4923; train_chrom_access_recon_loss: 5701097.0076; train_global_loss: 24667100.9091; train_optim_loss: 24667100.9091; val_kl_reg_loss: 31751.1689; val_edge_recon_loss: 682456.5938; val_gene_expr_recon_loss: 18083617.7500; val_masked_gp_l1_reg_loss: 78616.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65544.6484; val_chrom_access_recon_loss: 5809816.3125; val_global_loss: 24751802.0000; val_optim_loss: 24751802.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9240; val_auprc_score: 0.9024; val_best_acc_score: 0.8557; val_best_f1_score: 0.8671; train_kl_reg_loss: 46715.9003; train_edge_recon_loss: 665844.3248; train_gene_expr_recon_loss: 18092595.7879; train_masked_gp_l1_reg_loss: 78428.6177; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65376.5524; train_chrom_access_recon_loss: 5695700.0455; train_global_loss: 24644661.0909; train_optim_loss: 24644661.0909; val_kl_reg_loss: 32228.6741; val_edge_recon_loss: 672108.3750; val_gene_expr_recon_loss: 17869107.7500; val_masked_gp_l1_reg_loss: 78236.4609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65208.0977; val_chrom_access_recon_loss: 5691993.1875; val_global_loss: 24408881.5000; val_optim_loss: 24408881.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9182; val_auprc_score: 0.8902; val_best_acc_score: 0.8544; val_best_f1_score: 0.8634; train_kl_reg_loss: 46315.0353; train_edge_recon_loss: 657393.0994; train_gene_expr_recon_loss: 18116583.6970; train_masked_gp_l1_reg_loss: 78073.0913; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65019.4500; train_chrom_access_recon_loss: 5705990.2576; train_global_loss: 24669374.4242; train_optim_loss: 24669374.4242; val_kl_reg_loss: 33942.5469; val_edge_recon_loss: 659037.8281; val_gene_expr_recon_loss: 18076780.2500; val_masked_gp_l1_reg_loss: 77900.5156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64798.6602; val_chrom_access_recon_loss: 5810396.4375; val_global_loss: 24722854.7500; val_optim_loss: 24722854.7500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9122; val_auprc_score: 0.8863; val_best_acc_score: 0.8407; val_best_f1_score: 0.8539; train_kl_reg_loss: 46658.8229; train_edge_recon_loss: 647841.7348; train_gene_expr_recon_loss: 18093040.3939; train_masked_gp_l1_reg_loss: 77751.1083; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64630.2889; train_chrom_access_recon_loss: 5696625.4697; train_global_loss: 24626547.7273; train_optim_loss: 24626547.7273; val_kl_reg_loss: 35378.5767; val_edge_recon_loss: 652344.3047; val_gene_expr_recon_loss: 17875568.0000; val_masked_gp_l1_reg_loss: 77604.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64405.9062; val_chrom_access_recon_loss: 5751634.8750; val_global_loss: 24456935.2500; val_optim_loss: 24456935.2500
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9125; val_auprc_score: 0.8886; val_best_acc_score: 0.8415; val_best_f1_score: 0.8538; train_kl_reg_loss: 47360.1937; train_edge_recon_loss: 638319.1364; train_gene_expr_recon_loss: 18086291.3636; train_masked_gp_l1_reg_loss: 77480.2857; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64247.2044; train_chrom_access_recon_loss: 5699835.8561; train_global_loss: 24613534.1818; train_optim_loss: 24613534.1818; val_kl_reg_loss: 37342.9268; val_edge_recon_loss: 643934.0234; val_gene_expr_recon_loss: 18012613.7500; val_masked_gp_l1_reg_loss: 77348.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64151.9102; val_chrom_access_recon_loss: 5764690.6875; val_global_loss: 24600081.2500; val_optim_loss: 24600081.2500
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9166; val_auprc_score: 0.8948; val_best_acc_score: 0.8461; val_best_f1_score: 0.8581; train_kl_reg_loss: 48275.9067; train_edge_recon_loss: 632757.2064; train_gene_expr_recon_loss: 18075679.6364; train_masked_gp_l1_reg_loss: 77207.9119; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63939.2464; train_chrom_access_recon_loss: 5689244.1364; train_global_loss: 24587103.8788; train_optim_loss: 24587103.8788; val_kl_reg_loss: 39328.9019; val_edge_recon_loss: 628654.9062; val_gene_expr_recon_loss: 17922190.2500; val_masked_gp_l1_reg_loss: 77084.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63801.8867; val_chrom_access_recon_loss: 5759718.3750; val_global_loss: 24490779.0000; val_optim_loss: 24490779.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9165; val_auprc_score: 0.8936; val_best_acc_score: 0.8455; val_best_f1_score: 0.8569; train_kl_reg_loss: 49043.9645; train_edge_recon_loss: 628430.8447; train_gene_expr_recon_loss: 18075301.3333; train_masked_gp_l1_reg_loss: 77024.7962; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62283.7098; train_chrom_access_recon_loss: 5690187.1212; train_global_loss: 24582271.7879; train_optim_loss: 24582271.7879; val_kl_reg_loss: 39540.7422; val_edge_recon_loss: 634160.3672; val_gene_expr_recon_loss: 18039282.0000; val_masked_gp_l1_reg_loss: 76986.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61954.0547; val_chrom_access_recon_loss: 5813946.0625; val_global_loss: 24665869.2500; val_optim_loss: 24665869.2500
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9109; val_auprc_score: 0.8851; val_best_acc_score: 0.8399; val_best_f1_score: 0.8525; train_kl_reg_loss: 49198.3789; train_edge_recon_loss: 627990.0881; train_gene_expr_recon_loss: 18081789.7273; train_masked_gp_l1_reg_loss: 76961.2047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61897.8417; train_chrom_access_recon_loss: 5689203.0455; train_global_loss: 24587040.3333; train_optim_loss: 24587040.3333; val_kl_reg_loss: 40093.5933; val_edge_recon_loss: 630581.8594; val_gene_expr_recon_loss: 17947214.5000; val_masked_gp_l1_reg_loss: 76937.8594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61847.2227; val_chrom_access_recon_loss: 5743962.6875; val_global_loss: 24500638.2500; val_optim_loss: 24500638.2500
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9072; val_auprc_score: 0.8826; val_best_acc_score: 0.8366; val_best_f1_score: 0.8502; train_kl_reg_loss: 49258.1651; train_edge_recon_loss: 626293.9536; train_gene_expr_recon_loss: 18071113.0909; train_masked_gp_l1_reg_loss: 76919.4638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61807.1043; train_chrom_access_recon_loss: 5690488.6439; train_global_loss: 24575880.3333; train_optim_loss: 24575880.3333; val_kl_reg_loss: 39681.9619; val_edge_recon_loss: 633674.0469; val_gene_expr_recon_loss: 17859256.7500; val_masked_gp_l1_reg_loss: 76901.3516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61764.5898; val_chrom_access_recon_loss: 5716319.8125; val_global_loss: 24387599.0000; val_optim_loss: 24387599.0000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9179; val_auprc_score: 0.8984; val_best_acc_score: 0.8458; val_best_f1_score: 0.8572; train_kl_reg_loss: 49291.3499; train_edge_recon_loss: 626845.9384; train_gene_expr_recon_loss: 18076399.1818; train_masked_gp_l1_reg_loss: 76883.3344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61732.5629; train_chrom_access_recon_loss: 5690550.0606; train_global_loss: 24581702.3939; train_optim_loss: 24581702.3939; val_kl_reg_loss: 40104.8823; val_edge_recon_loss: 632486.5547; val_gene_expr_recon_loss: 17900743.7500; val_masked_gp_l1_reg_loss: 76866.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61703.3125; val_chrom_access_recon_loss: 5775148.0625; val_global_loss: 24487053.5000; val_optim_loss: 24487053.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9059; val_auprc_score: 0.8794; val_best_acc_score: 0.8326; val_best_f1_score: 0.8469; train_kl_reg_loss: 49543.5307; train_edge_recon_loss: 625120.8636; train_gene_expr_recon_loss: 18074113.9394; train_masked_gp_l1_reg_loss: 76849.9699; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61676.0196; train_chrom_access_recon_loss: 5684061.7348; train_global_loss: 24571366.0303; train_optim_loss: 24571366.0303; val_kl_reg_loss: 40642.4946; val_edge_recon_loss: 630119.8906; val_gene_expr_recon_loss: 18012837.7500; val_masked_gp_l1_reg_loss: 76832.2188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61649.4922; val_chrom_access_recon_loss: 5778388.0000; val_global_loss: 24600470.2500; val_optim_loss: 24600470.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9122; val_auprc_score: 0.8881; val_best_acc_score: 0.8375; val_best_f1_score: 0.8540; train_kl_reg_loss: 49768.1895; train_edge_recon_loss: 624579.9820; train_gene_expr_recon_loss: 18076502.7879; train_masked_gp_l1_reg_loss: 76816.3781; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61623.5355; train_chrom_access_recon_loss: 5691838.2424; train_global_loss: 24581129.1515; train_optim_loss: 24581129.1515; val_kl_reg_loss: 40826.6353; val_edge_recon_loss: 623644.8047; val_gene_expr_recon_loss: 18104973.0000; val_masked_gp_l1_reg_loss: 76799.4062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61593.1211; val_chrom_access_recon_loss: 5767957.2500; val_global_loss: 24675796.0000; val_optim_loss: 24675796.0000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9112; val_auprc_score: 0.8873; val_best_acc_score: 0.8396; val_best_f1_score: 0.8543; train_kl_reg_loss: 49855.8411; train_edge_recon_loss: 624597.4356; train_gene_expr_recon_loss: 18080977.2424; train_masked_gp_l1_reg_loss: 76784.9782; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61571.6660; train_chrom_access_recon_loss: 5694403.3106; train_global_loss: 24588190.5152; train_optim_loss: 24588190.5152; val_kl_reg_loss: 40899.1304; val_edge_recon_loss: 625854.3438; val_gene_expr_recon_loss: 18001753.5000; val_masked_gp_l1_reg_loss: 76766.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61548.2969; val_chrom_access_recon_loss: 5735631.3125; val_global_loss: 24542452.0000; val_optim_loss: 24542452.0000

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9087; val_auprc_score: 0.8838; val_best_acc_score: 0.8366; val_best_f1_score: 0.8488; train_kl_reg_loss: 49943.0779; train_edge_recon_loss: 623141.1629; train_gene_expr_recon_loss: 18075661.5152; train_masked_gp_l1_reg_loss: 76760.7873; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61387.0815; train_chrom_access_recon_loss: 5687788.7045; train_global_loss: 24574682.3030; train_optim_loss: 24574682.3030; val_kl_reg_loss: 40760.3916; val_edge_recon_loss: 633207.6250; val_gene_expr_recon_loss: 18105292.7500; val_masked_gp_l1_reg_loss: 76757.0547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61354.1758; val_chrom_access_recon_loss: 5808389.3125; val_global_loss: 24725762.2500; val_optim_loss: 24725762.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9071; val_auprc_score: 0.8823; val_best_acc_score: 0.8399; val_best_f1_score: 0.8495; train_kl_reg_loss: 49989.9149; train_edge_recon_loss: 624004.1525; train_gene_expr_recon_loss: 18086853.6061; train_masked_gp_l1_reg_loss: 76754.9239; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61349.0517; train_chrom_access_recon_loss: 5688916.9015; train_global_loss: 24587868.5455; train_optim_loss: 24587868.5455; val_kl_reg_loss: 40677.3511; val_edge_recon_loss: 632226.8906; val_gene_expr_recon_loss: 18036203.2500; val_masked_gp_l1_reg_loss: 76752.5781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61344.4023; val_chrom_access_recon_loss: 5750399.5000; val_global_loss: 24597603.0000; val_optim_loss: 24597603.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9120; val_auprc_score: 0.8868; val_best_acc_score: 0.8452; val_best_f1_score: 0.8567; train_kl_reg_loss: 49934.2336; train_edge_recon_loss: 623670.0739; train_gene_expr_recon_loss: 18078166.4242; train_masked_gp_l1_reg_loss: 76750.6512; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61340.7680; train_chrom_access_recon_loss: 5692800.3258; train_global_loss: 24582662.6667; train_optim_loss: 24582662.6667; val_kl_reg_loss: 41021.5498; val_edge_recon_loss: 627877.0547; val_gene_expr_recon_loss: 17933037.0000; val_masked_gp_l1_reg_loss: 76748.6406; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61336.7578; val_chrom_access_recon_loss: 5765830.0625; val_global_loss: 24505849.2500; val_optim_loss: 24505849.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9083; val_auprc_score: 0.8819; val_best_acc_score: 0.8305; val_best_f1_score: 0.8454; train_kl_reg_loss: 49925.1067; train_edge_recon_loss: 623792.2386; train_gene_expr_recon_loss: 18075563.2424; train_masked_gp_l1_reg_loss: 76746.7778; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 61333.4288; train_chrom_access_recon_loss: 5688009.3485; train_global_loss: 24575370.3030; train_optim_loss: 24575370.3030; val_kl_reg_loss: 40768.0864; val_edge_recon_loss: 629342.5859; val_gene_expr_recon_loss: 17984285.5000; val_masked_gp_l1_reg_loss: 76744.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 61329.9570; val_chrom_access_recon_loss: 5782760.5000; val_global_loss: 24575230.2500; val_optim_loss: 24575230.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 19 min 15 sec.
Using best model state, which was in epoch 46.

--- MODEL EVALUATION ---
val AUROC score: 0.9103
val AUPRC score: 0.8865
val best accuracy score: 0.8428
val best F1 score: 0.8551
val target rna MSE score: 2.0464
val source rna MSE score: 0.9435
val target atac MSE score: 0.3304
val source atac MSE score: 0.1403
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
