[True, False]
Run timestamp: 01092023_183450_7.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'nanostring_cosmx_human_nsclc_modified', '--reference_batches', 'batch1', 'batch2', 'batch3', '--n_neighbors', '4', '--no-filter_genes', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--species', 'human', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--cat_covariates_keys', 'batch', 'fov', '--cat_covariates_no_edges', 'True', 'False', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'gene_expr_decoder', '--cat_covariates_embeds_nums', '3', '30', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000.', '--lambda_gene_expr_recon', '3000.', '--lambda_cat_covariates_contrastive', '1000000.0', '--contrastive_logits_pos_ratio', '0.0625', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '0.0', '--lambda_l1_addon', '1000.', '--edge_batch_size', '512', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_7']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 2264.
Number of gene programs after filtering and combining: 1691.

Processing batch batch1...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch2...
Loading data...
Computing spatial neighborhood graph...

Processing batch batch3...
Loading data...
Computing spatial neighborhood graph...

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['gene_expr_decoder']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ENCODER -> n_input: 960, n_cat_covariates_embed_input: 0, n_hidden: 960, n_latent: 1494, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 1494, n_addon_gp_input: 100, n_cat_covariates_embed_input: 33, n_output: 960

--- INITIALIZING TRAINER ---
Number of training nodes: 209404
Number of validation nodes: 23267
Number of training edges: 496403
Number of validation edges: 55155
Edge batch size: 512
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.9163; val_auprc_score: 0.9701; val_best_acc_score: 0.8774; val_best_f1_score: 0.9220; train_kl_reg_loss: 24313.1402; train_edge_recon_loss: 1470853.4170; train_cat_covariates_contrastive_loss: 648960.7073; train_gene_expr_recon_loss: 2799489.2753; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133200.1476; train_global_loss: 5076816.7010; train_optim_loss: 5076816.7010; val_kl_reg_loss: 19869.8606; val_edge_recon_loss: 1427051.0208; val_cat_covariates_contrastive_loss: 643317.7650; val_gene_expr_recon_loss: 2572963.0347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16783.4512; val_global_loss: 4679985.1574; val_optim_loss: 4679985.1574
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.9361; val_auprc_score: 0.9759; val_best_acc_score: 0.8985; val_best_f1_score: 0.9348; train_kl_reg_loss: 19236.3548; train_edge_recon_loss: 1369552.0655; train_cat_covariates_contrastive_loss: 645106.3326; train_gene_expr_recon_loss: 2447931.3595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15962.1101; train_global_loss: 4497788.2258; train_optim_loss: 4497788.2258; val_kl_reg_loss: 19884.1523; val_edge_recon_loss: 1416706.1528; val_cat_covariates_contrastive_loss: 644568.3385; val_gene_expr_recon_loss: 2318530.2083; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15613.3057; val_global_loss: 4415302.3426; val_optim_loss: 4415302.3426
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.9396; val_auprc_score: 0.9777; val_best_acc_score: 0.9034; val_best_f1_score: 0.9384; train_kl_reg_loss: 21205.1155; train_edge_recon_loss: 1357434.1706; train_cat_covariates_contrastive_loss: 645180.2905; train_gene_expr_recon_loss: 2218107.8647; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15667.4727; train_global_loss: 4257594.9131; train_optim_loss: 4257594.9131; val_kl_reg_loss: 23336.0962; val_edge_recon_loss: 1394988.8646; val_cat_covariates_contrastive_loss: 642872.2141; val_gene_expr_recon_loss: 2135992.4109; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 15842.7637; val_global_loss: 4213032.4352; val_optim_loss: 4213032.4352
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.9436; val_auprc_score: 0.9779; val_best_acc_score: 0.9132; val_best_f1_score: 0.9441; train_kl_reg_loss: 23103.5333; train_edge_recon_loss: 1356491.0738; train_cat_covariates_contrastive_loss: 645082.1133; train_gene_expr_recon_loss: 2071797.6820; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 15968.9651; train_global_loss: 4112443.3716; train_optim_loss: 4112443.3716; val_kl_reg_loss: 22999.3443; val_edge_recon_loss: 1398196.7188; val_cat_covariates_contrastive_loss: 645394.2749; val_gene_expr_recon_loss: 2027759.5243; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16093.6221; val_global_loss: 4110443.3681; val_optim_loss: 4110443.3681
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.9471; val_auprc_score: 0.9795; val_best_acc_score: 0.9161; val_best_f1_score: 0.9463; train_kl_reg_loss: 24133.8172; train_edge_recon_loss: 1355656.4726; train_cat_covariates_contrastive_loss: 644955.6630; train_gene_expr_recon_loss: 1988391.0466; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16226.9829; train_global_loss: 4029363.9763; train_optim_loss: 4029363.9763; val_kl_reg_loss: 25037.5080; val_edge_recon_loss: 1383536.7546; val_cat_covariates_contrastive_loss: 642817.4450; val_gene_expr_recon_loss: 1965321.1458; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16342.0566; val_global_loss: 4033054.8449; val_optim_loss: 4033054.8449
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.9470; val_auprc_score: 0.9796; val_best_acc_score: 0.9155; val_best_f1_score: 0.9457; train_kl_reg_loss: 24732.6259; train_edge_recon_loss: 1349298.5437; train_cat_covariates_contrastive_loss: 644708.8226; train_gene_expr_recon_loss: 1940641.0383; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16332.0288; train_global_loss: 3975713.0606; train_optim_loss: 3975713.0606; val_kl_reg_loss: 26151.1446; val_edge_recon_loss: 1380066.2326; val_cat_covariates_contrastive_loss: 642708.7361; val_gene_expr_recon_loss: 1929361.7141; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16347.6504; val_global_loss: 3994635.5764; val_optim_loss: 3994635.5764
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.9508; val_auprc_score: 0.9807; val_best_acc_score: 0.9187; val_best_f1_score: 0.9476; train_kl_reg_loss: 25130.1374; train_edge_recon_loss: 1352581.2390; train_cat_covariates_contrastive_loss: 644742.8578; train_gene_expr_recon_loss: 1905317.2111; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16440.8739; train_global_loss: 3944212.3216; train_optim_loss: 3944212.3216; val_kl_reg_loss: 24909.1689; val_edge_recon_loss: 1375611.9769; val_cat_covariates_contrastive_loss: 645426.3478; val_gene_expr_recon_loss: 1911139.3148; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16579.6055; val_global_loss: 3973666.3079; val_optim_loss: 3973666.3079
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.9529; val_auprc_score: 0.9819; val_best_acc_score: 0.9212; val_best_f1_score: 0.9492; train_kl_reg_loss: 25485.5491; train_edge_recon_loss: 1348671.2143; train_cat_covariates_contrastive_loss: 644440.3374; train_gene_expr_recon_loss: 1884219.9866; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16601.3715; train_global_loss: 3919418.4624; train_optim_loss: 3919418.4624; val_kl_reg_loss: 25619.8817; val_edge_recon_loss: 1377304.1644; val_cat_covariates_contrastive_loss: 645294.6007; val_gene_expr_recon_loss: 1888305.3241; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16617.3281; val_global_loss: 3953141.2338; val_optim_loss: 3953141.2338
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.9527; val_auprc_score: 0.9814; val_best_acc_score: 0.9201; val_best_f1_score: 0.9488; train_kl_reg_loss: 25711.8077; train_edge_recon_loss: 1352253.0726; train_cat_covariates_contrastive_loss: 644230.5236; train_gene_expr_recon_loss: 1870222.3884; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 16765.0218; train_global_loss: 3909182.8129; train_optim_loss: 3909182.8129; val_kl_reg_loss: 26084.3305; val_edge_recon_loss: 1373979.4155; val_cat_covariates_contrastive_loss: 644049.9508; val_gene_expr_recon_loss: 1873923.6331; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17009.9297; val_global_loss: 3935047.3403; val_optim_loss: 3935047.3403
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.9555; val_auprc_score: 0.9827; val_best_acc_score: 0.9235; val_best_f1_score: 0.9508; train_kl_reg_loss: 25911.8745; train_edge_recon_loss: 1344705.0214; train_cat_covariates_contrastive_loss: 643981.5818; train_gene_expr_recon_loss: 1857936.4496; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17006.4832; train_global_loss: 3889541.4095; train_optim_loss: 3889541.4095; val_kl_reg_loss: 25448.9894; val_edge_recon_loss: 1375898.0312; val_cat_covariates_contrastive_loss: 643872.5874; val_gene_expr_recon_loss: 1866422.4271; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 16982.7168; val_global_loss: 3928624.7755; val_optim_loss: 3928624.7755
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.9555; val_auprc_score: 0.9827; val_best_acc_score: 0.9240; val_best_f1_score: 0.9510; train_kl_reg_loss: 26048.6847; train_edge_recon_loss: 1347867.2253; train_cat_covariates_contrastive_loss: 643703.1741; train_gene_expr_recon_loss: 1844736.5553; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17088.6177; train_global_loss: 3879444.2582; train_optim_loss: 3879444.2582; val_kl_reg_loss: 26257.0992; val_edge_recon_loss: 1378778.6042; val_cat_covariates_contrastive_loss: 644242.8791; val_gene_expr_recon_loss: 1860917.4769; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17185.7812; val_global_loss: 3927381.8056; val_optim_loss: 3927381.8056
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9558; val_auprc_score: 0.9828; val_best_acc_score: 0.9241; val_best_f1_score: 0.9511; train_kl_reg_loss: 26112.1807; train_edge_recon_loss: 1343095.6733; train_cat_covariates_contrastive_loss: 643953.6218; train_gene_expr_recon_loss: 1839132.7720; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17247.0802; train_global_loss: 3869541.3188; train_optim_loss: 3869541.3188; val_kl_reg_loss: 26481.9965; val_edge_recon_loss: 1379157.1146; val_cat_covariates_contrastive_loss: 644086.0787; val_gene_expr_recon_loss: 1855014.7801; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17391.0586; val_global_loss: 3922130.9699; val_optim_loss: 3922130.9699
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9547; val_auprc_score: 0.9823; val_best_acc_score: 0.9220; val_best_f1_score: 0.9498; train_kl_reg_loss: 26495.8704; train_edge_recon_loss: 1346681.6399; train_cat_covariates_contrastive_loss: 643852.6431; train_gene_expr_recon_loss: 1828954.7197; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17488.3015; train_global_loss: 3863473.1786; train_optim_loss: 3863473.1786; val_kl_reg_loss: 25628.9720; val_edge_recon_loss: 1373630.0475; val_cat_covariates_contrastive_loss: 645371.6973; val_gene_expr_recon_loss: 1852940.0845; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17644.7344; val_global_loss: 3915215.5579; val_optim_loss: 3915215.5579
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9535; val_auprc_score: 0.9813; val_best_acc_score: 0.9235; val_best_f1_score: 0.9507; train_kl_reg_loss: 26495.0732; train_edge_recon_loss: 1343632.9722; train_cat_covariates_contrastive_loss: 643776.7651; train_gene_expr_recon_loss: 1823293.0631; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17583.5893; train_global_loss: 3854781.4595; train_optim_loss: 3854781.4595; val_kl_reg_loss: 26657.8883; val_edge_recon_loss: 1387860.2269; val_cat_covariates_contrastive_loss: 643397.3617; val_gene_expr_recon_loss: 1835744.7627; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17656.1289; val_global_loss: 3911316.4954; val_optim_loss: 3911316.4954
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9573; val_auprc_score: 0.9831; val_best_acc_score: 0.9266; val_best_f1_score: 0.9525; train_kl_reg_loss: 26626.7405; train_edge_recon_loss: 1344851.7178; train_cat_covariates_contrastive_loss: 643566.9623; train_gene_expr_recon_loss: 1820280.6616; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17711.5910; train_global_loss: 3853037.6791; train_optim_loss: 3853037.6791; val_kl_reg_loss: 26859.8982; val_edge_recon_loss: 1373292.0706; val_cat_covariates_contrastive_loss: 644154.5978; val_gene_expr_recon_loss: 1834945.8542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17787.9727; val_global_loss: 3897040.4306; val_optim_loss: 3897040.4306
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9553; val_auprc_score: 0.9821; val_best_acc_score: 0.9258; val_best_f1_score: 0.9521; train_kl_reg_loss: 26772.1534; train_edge_recon_loss: 1343268.3737; train_cat_covariates_contrastive_loss: 643547.2229; train_gene_expr_recon_loss: 1813605.1731; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17774.4624; train_global_loss: 3844967.3912; train_optim_loss: 3844967.3912; val_kl_reg_loss: 27451.5636; val_edge_recon_loss: 1378161.9271; val_cat_covariates_contrastive_loss: 643414.8831; val_gene_expr_recon_loss: 1833564.7662; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18025.2422; val_global_loss: 3900618.3935; val_optim_loss: 3900618.3935
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9575; val_auprc_score: 0.9830; val_best_acc_score: 0.9271; val_best_f1_score: 0.9531; train_kl_reg_loss: 26934.6570; train_edge_recon_loss: 1338418.0758; train_cat_covariates_contrastive_loss: 643569.7343; train_gene_expr_recon_loss: 1810775.1947; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17815.8054; train_global_loss: 3837513.4649; train_optim_loss: 3837513.4649; val_kl_reg_loss: 26504.4132; val_edge_recon_loss: 1379803.5486; val_cat_covariates_contrastive_loss: 644858.0608; val_gene_expr_recon_loss: 1830232.0069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17806.4316; val_global_loss: 3899204.5255; val_optim_loss: 3899204.5255
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9555; val_auprc_score: 0.9825; val_best_acc_score: 0.9257; val_best_f1_score: 0.9522; train_kl_reg_loss: 27147.7604; train_edge_recon_loss: 1345488.9068; train_cat_covariates_contrastive_loss: 643652.0064; train_gene_expr_recon_loss: 1808205.4067; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17857.1315; train_global_loss: 3842351.2180; train_optim_loss: 3842351.2180; val_kl_reg_loss: 28471.1546; val_edge_recon_loss: 1374979.3102; val_cat_covariates_contrastive_loss: 641755.2344; val_gene_expr_recon_loss: 1823772.6852; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18101.1152; val_global_loss: 3887079.3727; val_optim_loss: 3887079.3727
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9562; val_auprc_score: 0.9827; val_best_acc_score: 0.9253; val_best_f1_score: 0.9519; train_kl_reg_loss: 27173.0843; train_edge_recon_loss: 1343905.3195; train_cat_covariates_contrastive_loss: 643544.4465; train_gene_expr_recon_loss: 1798646.5559; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17908.9043; train_global_loss: 3831178.3010; train_optim_loss: 3831178.3010; val_kl_reg_loss: 27134.0622; val_edge_recon_loss: 1387821.8079; val_cat_covariates_contrastive_loss: 644278.2095; val_gene_expr_recon_loss: 1820223.7488; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17941.3086; val_global_loss: 3897399.0648; val_optim_loss: 3897399.0648
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9594; val_auprc_score: 0.9841; val_best_acc_score: 0.9294; val_best_f1_score: 0.9545; train_kl_reg_loss: 27168.9820; train_edge_recon_loss: 1343806.7162; train_cat_covariates_contrastive_loss: 643378.8273; train_gene_expr_recon_loss: 1799477.3439; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17938.7990; train_global_loss: 3831770.6644; train_optim_loss: 3831770.6644; val_kl_reg_loss: 26870.7392; val_edge_recon_loss: 1360795.2535; val_cat_covariates_contrastive_loss: 645849.3368; val_gene_expr_recon_loss: 1817361.4792; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18097.2500; val_global_loss: 3868974.0764; val_optim_loss: 3868974.0764
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9594; val_auprc_score: 0.9841; val_best_acc_score: 0.9269; val_best_f1_score: 0.9527; train_kl_reg_loss: 27280.5434; train_edge_recon_loss: 1346303.0325; train_cat_covariates_contrastive_loss: 643535.6766; train_gene_expr_recon_loss: 1798114.7228; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17954.3922; train_global_loss: 3833188.3662; train_optim_loss: 3833188.3662; val_kl_reg_loss: 26959.2994; val_edge_recon_loss: 1371065.8125; val_cat_covariates_contrastive_loss: 646234.8015; val_gene_expr_recon_loss: 1818371.8484; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18266.1816; val_global_loss: 3880898.0000; val_optim_loss: 3880898.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9588; val_auprc_score: 0.9834; val_best_acc_score: 0.9283; val_best_f1_score: 0.9536; train_kl_reg_loss: 27468.0445; train_edge_recon_loss: 1340920.7501; train_cat_covariates_contrastive_loss: 643232.6685; train_gene_expr_recon_loss: 1794453.3827; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 17994.5235; train_global_loss: 3824069.3686; train_optim_loss: 3824069.3686; val_kl_reg_loss: 27410.3345; val_edge_recon_loss: 1370996.6319; val_cat_covariates_contrastive_loss: 644513.7182; val_gene_expr_recon_loss: 1816825.3877; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17845.6426; val_global_loss: 3877591.8287; val_optim_loss: 3877591.8287
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9572; val_auprc_score: 0.9825; val_best_acc_score: 0.9294; val_best_f1_score: 0.9544; train_kl_reg_loss: 27508.4454; train_edge_recon_loss: 1344842.1124; train_cat_covariates_contrastive_loss: 643169.6015; train_gene_expr_recon_loss: 1789035.3456; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18044.3849; train_global_loss: 3822599.8838; train_optim_loss: 3822599.8838; val_kl_reg_loss: 27043.8142; val_edge_recon_loss: 1370731.5336; val_cat_covariates_contrastive_loss: 644460.1030; val_gene_expr_recon_loss: 1811137.4086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 18022.9219; val_global_loss: 3871395.8495; val_optim_loss: 3871395.8495
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9543; val_auprc_score: 0.9814; val_best_acc_score: 0.9271; val_best_f1_score: 0.9530; train_kl_reg_loss: 27715.3165; train_edge_recon_loss: 1341770.6119; train_cat_covariates_contrastive_loss: 643497.1329; train_gene_expr_recon_loss: 1788926.8293; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 18081.4304; train_global_loss: 3819991.3186; train_optim_loss: 3819991.3186; val_kl_reg_loss: 28057.2920; val_edge_recon_loss: 1376993.5509; val_cat_covariates_contrastive_loss: 641915.6019; val_gene_expr_recon_loss: 1812317.5683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 17912.6230; val_global_loss: 3877196.5069; val_optim_loss: 3877196.5069

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9585; val_auprc_score: 0.9836; val_best_acc_score: 0.9295; val_best_f1_score: 0.9547; train_kl_reg_loss: 27757.9407; train_edge_recon_loss: 1338469.9553; train_cat_covariates_contrastive_loss: 643075.5182; train_gene_expr_recon_loss: 1758335.0367; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9920.6990; train_global_loss: 3777559.1572; train_optim_loss: 3777559.1572; val_kl_reg_loss: 27951.2108; val_edge_recon_loss: 1366930.6481; val_cat_covariates_contrastive_loss: 643518.1863; val_gene_expr_recon_loss: 1788165.7859; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9762.1436; val_global_loss: 3836328.0671; val_optim_loss: 3836328.0671
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9603; val_auprc_score: 0.9844; val_best_acc_score: 0.9305; val_best_f1_score: 0.9552; train_kl_reg_loss: 27838.5736; train_edge_recon_loss: 1341428.6552; train_cat_covariates_contrastive_loss: 642908.3595; train_gene_expr_recon_loss: 1755104.4454; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9822.0144; train_global_loss: 3777102.0541; train_optim_loss: 3777102.0541; val_kl_reg_loss: 27854.2799; val_edge_recon_loss: 1368185.0312; val_cat_covariates_contrastive_loss: 644191.1076; val_gene_expr_recon_loss: 1786798.7778; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9845.3633; val_global_loss: 3836874.4514; val_optim_loss: 3836874.4514
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9577; val_auprc_score: 0.9828; val_best_acc_score: 0.9281; val_best_f1_score: 0.9536; train_kl_reg_loss: 27817.3517; train_edge_recon_loss: 1338905.4642; train_cat_covariates_contrastive_loss: 642472.7654; train_gene_expr_recon_loss: 1753172.3260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9838.1251; train_global_loss: 3772206.0335; train_optim_loss: 3772206.0335; val_kl_reg_loss: 27743.9220; val_edge_recon_loss: 1376584.5023; val_cat_covariates_contrastive_loss: 642597.4201; val_gene_expr_recon_loss: 1783684.5683; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9858.2939; val_global_loss: 3840468.6505; val_optim_loss: 3840468.6505
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9588; val_auprc_score: 0.9835; val_best_acc_score: 0.9304; val_best_f1_score: 0.9552; train_kl_reg_loss: 27754.1309; train_edge_recon_loss: 1336962.9758; train_cat_covariates_contrastive_loss: 642862.2757; train_gene_expr_recon_loss: 1751331.1245; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9861.9628; train_global_loss: 3768772.4642; train_optim_loss: 3768772.4642; val_kl_reg_loss: 27475.0347; val_edge_recon_loss: 1359423.6481; val_cat_covariates_contrastive_loss: 643501.8582; val_gene_expr_recon_loss: 1784152.0347; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9843.1807; val_global_loss: 3824395.8310; val_optim_loss: 3824395.8310
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9593; val_auprc_score: 0.9836; val_best_acc_score: 0.9316; val_best_f1_score: 0.9559; train_kl_reg_loss: 27616.2627; train_edge_recon_loss: 1341733.0668; train_cat_covariates_contrastive_loss: 642455.9101; train_gene_expr_recon_loss: 1750719.9518; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9887.3921; train_global_loss: 3772412.5827; train_optim_loss: 3772412.5827; val_kl_reg_loss: 27763.1315; val_edge_recon_loss: 1367024.6377; val_cat_covariates_contrastive_loss: 642327.8524; val_gene_expr_recon_loss: 1782117.6944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9889.9551; val_global_loss: 3829123.3264; val_optim_loss: 3829123.3264
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9568; val_auprc_score: 0.9823; val_best_acc_score: 0.9300; val_best_f1_score: 0.9548; train_kl_reg_loss: 27491.1956; train_edge_recon_loss: 1338825.7164; train_cat_covariates_contrastive_loss: 642610.5083; train_gene_expr_recon_loss: 1749737.5062; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9892.8171; train_global_loss: 3768557.7371; train_optim_loss: 3768557.7371; val_kl_reg_loss: 27522.9128; val_edge_recon_loss: 1372515.2720; val_cat_covariates_contrastive_loss: 641689.6858; val_gene_expr_recon_loss: 1783089.4699; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9933.9404; val_global_loss: 3834751.3426; val_optim_loss: 3834751.3426
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9578; val_auprc_score: 0.9830; val_best_acc_score: 0.9300; val_best_f1_score: 0.9549; train_kl_reg_loss: 27525.7532; train_edge_recon_loss: 1337160.9411; train_cat_covariates_contrastive_loss: 642433.4208; train_gene_expr_recon_loss: 1748434.0653; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9896.3136; train_global_loss: 3765450.4928; train_optim_loss: 3765450.4928; val_kl_reg_loss: 27692.9730; val_edge_recon_loss: 1359275.9919; val_cat_covariates_contrastive_loss: 641702.6476; val_gene_expr_recon_loss: 1781269.8819; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9825.9697; val_global_loss: 3819767.5000; val_optim_loss: 3819767.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9593; val_auprc_score: 0.9833; val_best_acc_score: 0.9299; val_best_f1_score: 0.9549; train_kl_reg_loss: 27415.5446; train_edge_recon_loss: 1336039.8296; train_cat_covariates_contrastive_loss: 642299.9769; train_gene_expr_recon_loss: 1747281.6786; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9922.1850; train_global_loss: 3762959.2170; train_optim_loss: 3762959.2170; val_kl_reg_loss: 27213.1628; val_edge_recon_loss: 1368981.1447; val_cat_covariates_contrastive_loss: 643251.9983; val_gene_expr_recon_loss: 1779959.9062; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9877.4355; val_global_loss: 3829283.7199; val_optim_loss: 3829283.7199
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9598; val_auprc_score: 0.9835; val_best_acc_score: 0.9302; val_best_f1_score: 0.9551; train_kl_reg_loss: 27348.8833; train_edge_recon_loss: 1343955.2974; train_cat_covariates_contrastive_loss: 642421.6588; train_gene_expr_recon_loss: 1747273.6918; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9944.1272; train_global_loss: 3770943.6611; train_optim_loss: 3770943.6611; val_kl_reg_loss: 27350.2271; val_edge_recon_loss: 1365160.4537; val_cat_covariates_contrastive_loss: 642678.7228; val_gene_expr_recon_loss: 1781026.2211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9949.0742; val_global_loss: 3826164.6273; val_optim_loss: 3826164.6273
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9612; val_auprc_score: 0.9845; val_best_acc_score: 0.9324; val_best_f1_score: 0.9563; train_kl_reg_loss: 27233.5357; train_edge_recon_loss: 1336823.9151; train_cat_covariates_contrastive_loss: 642279.9097; train_gene_expr_recon_loss: 1746967.8001; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9965.4133; train_global_loss: 3763270.5724; train_optim_loss: 3763270.5724; val_kl_reg_loss: 27375.0348; val_edge_recon_loss: 1359769.1447; val_cat_covariates_contrastive_loss: 642643.5851; val_gene_expr_recon_loss: 1779294.7315; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9988.3975; val_global_loss: 3819071.0046; val_optim_loss: 3819071.0046
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9570; val_auprc_score: 0.9827; val_best_acc_score: 0.9297; val_best_f1_score: 0.9547; train_kl_reg_loss: 27259.9419; train_edge_recon_loss: 1339448.9459; train_cat_covariates_contrastive_loss: 642155.8516; train_gene_expr_recon_loss: 1745792.9131; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9978.9606; train_global_loss: 3764636.6111; train_optim_loss: 3764636.6111; val_kl_reg_loss: 27444.4239; val_edge_recon_loss: 1364702.1157; val_cat_covariates_contrastive_loss: 641961.6927; val_gene_expr_recon_loss: 1777629.8218; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9977.3975; val_global_loss: 3821715.5370; val_optim_loss: 3821715.5370
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9582; val_auprc_score: 0.9830; val_best_acc_score: 0.9314; val_best_f1_score: 0.9557; train_kl_reg_loss: 27156.7348; train_edge_recon_loss: 1337244.4460; train_cat_covariates_contrastive_loss: 642441.1111; train_gene_expr_recon_loss: 1744837.4709; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10003.4890; train_global_loss: 3761683.2528; train_optim_loss: 3761683.2528; val_kl_reg_loss: 27402.4837; val_edge_recon_loss: 1364179.8472; val_cat_covariates_contrastive_loss: 641195.2303; val_gene_expr_recon_loss: 1776957.8495; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10022.3711; val_global_loss: 3819757.6481; val_optim_loss: 3819757.6481
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9593; val_auprc_score: 0.9833; val_best_acc_score: 0.9301; val_best_f1_score: 0.9548; train_kl_reg_loss: 27102.3798; train_edge_recon_loss: 1338229.6951; train_cat_covariates_contrastive_loss: 642163.3262; train_gene_expr_recon_loss: 1744284.4735; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10016.6993; train_global_loss: 3761796.5771; train_optim_loss: 3761796.5771; val_kl_reg_loss: 27202.5097; val_edge_recon_loss: 1377860.3808; val_cat_covariates_contrastive_loss: 642050.8791; val_gene_expr_recon_loss: 1779184.6562; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 10024.0879; val_global_loss: 3836322.4306; val_optim_loss: 3836322.4306
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9577; val_auprc_score: 0.9823; val_best_acc_score: 0.9302; val_best_f1_score: 0.9550; train_kl_reg_loss: 27037.8585; train_edge_recon_loss: 1338053.2037; train_cat_covariates_contrastive_loss: 642112.3822; train_gene_expr_recon_loss: 1743804.6790; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 10021.6934; train_global_loss: 3761029.8160; train_optim_loss: 3761029.8160; val_kl_reg_loss: 27182.3433; val_edge_recon_loss: 1378980.8160; val_cat_covariates_contrastive_loss: 642100.3796; val_gene_expr_recon_loss: 1777856.4086; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9970.4580; val_global_loss: 3836090.4560; val_optim_loss: 3836090.4560

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9590; val_auprc_score: 0.9832; val_best_acc_score: 0.9305; val_best_f1_score: 0.9550; train_kl_reg_loss: 26884.2577; train_edge_recon_loss: 1338435.2030; train_cat_covariates_contrastive_loss: 642089.1987; train_gene_expr_recon_loss: 1739705.1767; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9092.8257; train_global_loss: 3756206.6564; train_optim_loss: 3756206.6564; val_kl_reg_loss: 27031.1540; val_edge_recon_loss: 1373755.6019; val_cat_covariates_contrastive_loss: 642115.3576; val_gene_expr_recon_loss: 1776879.0440; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9092.3438; val_global_loss: 3828873.4167; val_optim_loss: 3828873.4167
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9595; val_auprc_score: 0.9834; val_best_acc_score: 0.9314; val_best_f1_score: 0.9557; train_kl_reg_loss: 26930.3176; train_edge_recon_loss: 1336443.6394; train_cat_covariates_contrastive_loss: 642112.3576; train_gene_expr_recon_loss: 1740111.7599; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9098.7302; train_global_loss: 3754696.8026; train_optim_loss: 3754696.8026; val_kl_reg_loss: 26995.3377; val_edge_recon_loss: 1367960.1817; val_cat_covariates_contrastive_loss: 642429.4907; val_gene_expr_recon_loss: 1777021.6655; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9100.9463; val_global_loss: 3823507.6782; val_optim_loss: 3823507.6782
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9585; val_auprc_score: 0.9832; val_best_acc_score: 0.9318; val_best_f1_score: 0.9561; train_kl_reg_loss: 26956.5881; train_edge_recon_loss: 1337853.9862; train_cat_covariates_contrastive_loss: 641918.0476; train_gene_expr_recon_loss: 1739672.9606; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9098.6787; train_global_loss: 3755500.2603; train_optim_loss: 3755500.2603; val_kl_reg_loss: 27022.5895; val_edge_recon_loss: 1363294.9954; val_cat_covariates_contrastive_loss: 641791.9508; val_gene_expr_recon_loss: 1775374.5255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9104.3330; val_global_loss: 3816588.3009; val_optim_loss: 3816588.3009
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9586; val_auprc_score: 0.9830; val_best_acc_score: 0.9305; val_best_f1_score: 0.9551; train_kl_reg_loss: 27025.7556; train_edge_recon_loss: 1333338.0312; train_cat_covariates_contrastive_loss: 641854.2710; train_gene_expr_recon_loss: 1739627.4352; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9102.4102; train_global_loss: 3750947.9046; train_optim_loss: 3750947.9046; val_kl_reg_loss: 27041.2111; val_edge_recon_loss: 1376115.6181; val_cat_covariates_contrastive_loss: 641616.9427; val_gene_expr_recon_loss: 1777161.7431; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9099.8545; val_global_loss: 3831035.2616; val_optim_loss: 3831035.2616
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9611; val_auprc_score: 0.9842; val_best_acc_score: 0.9326; val_best_f1_score: 0.9565; train_kl_reg_loss: 27005.1732; train_edge_recon_loss: 1335382.0871; train_cat_covariates_contrastive_loss: 641955.9448; train_gene_expr_recon_loss: 1739840.9389; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9099.2393; train_global_loss: 3753283.3799; train_optim_loss: 3753283.3799; val_kl_reg_loss: 27186.6703; val_edge_recon_loss: 1357418.2708; val_cat_covariates_contrastive_loss: 642424.2685; val_gene_expr_recon_loss: 1775471.3542; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9096.5039; val_global_loss: 3811597.0741; val_optim_loss: 3811597.0741
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9595; val_auprc_score: 0.9839; val_best_acc_score: 0.9316; val_best_f1_score: 0.9559; train_kl_reg_loss: 27023.6330; train_edge_recon_loss: 1332259.6255; train_cat_covariates_contrastive_loss: 641978.6835; train_gene_expr_recon_loss: 1739221.8840; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9102.2400; train_global_loss: 3749586.0688; train_optim_loss: 3749586.0688; val_kl_reg_loss: 27086.3464; val_edge_recon_loss: 1362454.2558; val_cat_covariates_contrastive_loss: 642552.3854; val_gene_expr_recon_loss: 1774321.2130; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9098.0605; val_global_loss: 3815512.2106; val_optim_loss: 3815512.2106
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9588; val_auprc_score: 0.9834; val_best_acc_score: 0.9306; val_best_f1_score: 0.9551; train_kl_reg_loss: 27047.9911; train_edge_recon_loss: 1333946.5325; train_cat_covariates_contrastive_loss: 641947.2803; train_gene_expr_recon_loss: 1738755.3135; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9105.4513; train_global_loss: 3750802.5660; train_optim_loss: 3750802.5660; val_kl_reg_loss: 27077.4028; val_edge_recon_loss: 1376017.2361; val_cat_covariates_contrastive_loss: 641168.9543; val_gene_expr_recon_loss: 1775022.1944; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9096.2393; val_global_loss: 3828382.0486; val_optim_loss: 3828382.0486
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9587; val_auprc_score: 0.9831; val_best_acc_score: 0.9313; val_best_f1_score: 0.9557; train_kl_reg_loss: 27016.0240; train_edge_recon_loss: 1338036.4133; train_cat_covariates_contrastive_loss: 641960.9722; train_gene_expr_recon_loss: 1739163.0867; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9105.6925; train_global_loss: 3755282.1879; train_optim_loss: 3755282.1879; val_kl_reg_loss: 27128.3600; val_edge_recon_loss: 1365689.1586; val_cat_covariates_contrastive_loss: 641215.6163; val_gene_expr_recon_loss: 1776222.8924; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9110.6895; val_global_loss: 3819366.7708; val_optim_loss: 3819366.7708
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9581; val_auprc_score: 0.9831; val_best_acc_score: 0.9306; val_best_f1_score: 0.9552; train_kl_reg_loss: 26995.0087; train_edge_recon_loss: 1338657.0582; train_cat_covariates_contrastive_loss: 641739.5205; train_gene_expr_recon_loss: 1738800.7260; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9107.8584; train_global_loss: 3755300.1781; train_optim_loss: 3755300.1781; val_kl_reg_loss: 27142.8119; val_edge_recon_loss: 1366809.6227; val_cat_covariates_contrastive_loss: 641642.3351; val_gene_expr_recon_loss: 1776469.0069; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9109.8604; val_global_loss: 3821173.5116; val_optim_loss: 3821173.5116

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-06.

Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9597; val_auprc_score: 0.9837; val_best_acc_score: 0.9310; val_best_f1_score: 0.9555; train_kl_reg_loss: 27042.2599; train_edge_recon_loss: 1334655.0367; train_cat_covariates_contrastive_loss: 641562.9505; train_gene_expr_recon_loss: 1739512.4675; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9013.2895; train_global_loss: 3751786.0070; train_optim_loss: 3751786.0070; val_kl_reg_loss: 27086.7271; val_edge_recon_loss: 1367444.0150; val_cat_covariates_contrastive_loss: 641686.3032; val_gene_expr_recon_loss: 1775909.9942; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9008.3086; val_global_loss: 3821135.2755; val_optim_loss: 3821135.2755
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9596; val_auprc_score: 0.9837; val_best_acc_score: 0.9316; val_best_f1_score: 0.9558; train_kl_reg_loss: 26982.2053; train_edge_recon_loss: 1337178.5841; train_cat_covariates_contrastive_loss: 642026.5317; train_gene_expr_recon_loss: 1738557.6595; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9008.7716; train_global_loss: 3753753.7572; train_optim_loss: 3753753.7572; val_kl_reg_loss: 27064.7997; val_edge_recon_loss: 1368393.7569; val_cat_covariates_contrastive_loss: 641635.5799; val_gene_expr_recon_loss: 1775859.5671; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9008.9951; val_global_loss: 3821962.7083; val_optim_loss: 3821962.7083
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9611; val_auprc_score: 0.9844; val_best_acc_score: 0.9319; val_best_f1_score: 0.9560; train_kl_reg_loss: 26993.1986; train_edge_recon_loss: 1336727.1589; train_cat_covariates_contrastive_loss: 642029.9709; train_gene_expr_recon_loss: 1739291.7193; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9008.7255; train_global_loss: 3754050.7665; train_optim_loss: 3754050.7665; val_kl_reg_loss: 27029.3264; val_edge_recon_loss: 1363052.6528; val_cat_covariates_contrastive_loss: 642381.3686; val_gene_expr_recon_loss: 1775909.0891; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9010.6943; val_global_loss: 3817383.1944; val_optim_loss: 3817383.1944
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9582; val_auprc_score: 0.9832; val_best_acc_score: 0.9314; val_best_f1_score: 0.9558; train_kl_reg_loss: 27001.1463; train_edge_recon_loss: 1340569.6126; train_cat_covariates_contrastive_loss: 642138.6914; train_gene_expr_recon_loss: 1739095.8794; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9009.6589; train_global_loss: 3757814.9802; train_optim_loss: 3757814.9802; val_kl_reg_loss: 27090.6777; val_edge_recon_loss: 1355212.1169; val_cat_covariates_contrastive_loss: 641972.5741; val_gene_expr_recon_loss: 1774681.3657; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9010.2393; val_global_loss: 3807966.9861; val_optim_loss: 3807966.9861
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9606; val_auprc_score: 0.9845; val_best_acc_score: 0.9313; val_best_f1_score: 0.9556; train_kl_reg_loss: 26988.6545; train_edge_recon_loss: 1337853.7613; train_cat_covariates_contrastive_loss: 642001.4405; train_gene_expr_recon_loss: 1739081.1939; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9010.1481; train_global_loss: 3754935.1956; train_optim_loss: 3754935.1956; val_kl_reg_loss: 27082.3640; val_edge_recon_loss: 1365564.0706; val_cat_covariates_contrastive_loss: 642175.6348; val_gene_expr_recon_loss: 1776733.9282; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9009.9668; val_global_loss: 3820565.9931; val_optim_loss: 3820565.9931
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9598; val_auprc_score: 0.9837; val_best_acc_score: 0.9319; val_best_f1_score: 0.9561; train_kl_reg_loss: 26993.5192; train_edge_recon_loss: 1337675.2223; train_cat_covariates_contrastive_loss: 642080.5726; train_gene_expr_recon_loss: 1739007.1457; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9010.3103; train_global_loss: 3754766.7714; train_optim_loss: 3754766.7714; val_kl_reg_loss: 27044.9274; val_edge_recon_loss: 1358462.5556; val_cat_covariates_contrastive_loss: 641805.6366; val_gene_expr_recon_loss: 1775860.4248; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9010.7754; val_global_loss: 3812184.2894; val_optim_loss: 3812184.2894
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9592; val_auprc_score: 0.9835; val_best_acc_score: 0.9312; val_best_f1_score: 0.9557; train_kl_reg_loss: 27002.6040; train_edge_recon_loss: 1337970.1675; train_cat_covariates_contrastive_loss: 641837.3617; train_gene_expr_recon_loss: 1738457.6101; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9010.9221; train_global_loss: 3754278.6619; train_optim_loss: 3754278.6619; val_kl_reg_loss: 27043.1677; val_edge_recon_loss: 1360851.8102; val_cat_covariates_contrastive_loss: 641383.5457; val_gene_expr_recon_loss: 1775669.2928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9009.4932; val_global_loss: 3813957.3194; val_optim_loss: 3813957.3194
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9587; val_auprc_score: 0.9833; val_best_acc_score: 0.9309; val_best_f1_score: 0.9553; train_kl_reg_loss: 26967.2142; train_edge_recon_loss: 1338829.1464; train_cat_covariates_contrastive_loss: 641850.9668; train_gene_expr_recon_loss: 1738238.5598; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9009.1322; train_global_loss: 3754895.0232; train_optim_loss: 3754895.0232; val_kl_reg_loss: 27028.4626; val_edge_recon_loss: 1372418.0984; val_cat_covariates_contrastive_loss: 641621.1152; val_gene_expr_recon_loss: 1774966.2211; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 9009.6689; val_global_loss: 3825043.6644; val_optim_loss: 3825043.6644

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1.0000000000000002e-07.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9602; val_auprc_score: 0.9840; val_best_acc_score: 0.9321; val_best_f1_score: 0.9562; train_kl_reg_loss: 26959.2319; train_edge_recon_loss: 1336259.3193; train_cat_covariates_contrastive_loss: 642181.5628; train_gene_expr_recon_loss: 1738542.2807; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 9000.1421; train_global_loss: 3752942.5479; train_optim_loss: 3752942.5479; val_kl_reg_loss: 27008.8726; val_edge_recon_loss: 1367741.4919; val_cat_covariates_contrastive_loss: 642527.1973; val_gene_expr_recon_loss: 1772581.4977; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8999.6152; val_global_loss: 3818858.5579; val_optim_loss: 3818858.5579
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9589; val_auprc_score: 0.9833; val_best_acc_score: 0.9312; val_best_f1_score: 0.9554; train_kl_reg_loss: 26964.8574; train_edge_recon_loss: 1334486.9862; train_cat_covariates_contrastive_loss: 642021.2042; train_gene_expr_recon_loss: 1739226.7858; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8999.4709; train_global_loss: 3751699.3335; train_optim_loss: 3751699.3335; val_kl_reg_loss: 27042.4560; val_edge_recon_loss: 1377586.8993; val_cat_covariates_contrastive_loss: 642058.1400; val_gene_expr_recon_loss: 1777711.2928; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8999.5000; val_global_loss: 3833398.2940; val_optim_loss: 3833398.2940
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9610; val_auprc_score: 0.9844; val_best_acc_score: 0.9310; val_best_f1_score: 0.9552; train_kl_reg_loss: 26970.2027; train_edge_recon_loss: 1336331.0973; train_cat_covariates_contrastive_loss: 642100.5103; train_gene_expr_recon_loss: 1738067.7713; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8999.3727; train_global_loss: 3752468.9678; train_optim_loss: 3752468.9678; val_kl_reg_loss: 27075.9727; val_edge_recon_loss: 1379024.9769; val_cat_covariates_contrastive_loss: 641909.9450; val_gene_expr_recon_loss: 1776414.2581; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8999.2461; val_global_loss: 3833424.4074; val_optim_loss: 3833424.4074
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9591; val_auprc_score: 0.9835; val_best_acc_score: 0.9309; val_best_f1_score: 0.9553; train_kl_reg_loss: 26981.4358; train_edge_recon_loss: 1337798.1741; train_cat_covariates_contrastive_loss: 641990.0351; train_gene_expr_recon_loss: 1738762.3798; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 8999.2199; train_global_loss: 3754531.2747; train_optim_loss: 3754531.2747; val_kl_reg_loss: 27066.4955; val_edge_recon_loss: 1366773.7477; val_cat_covariates_contrastive_loss: 641766.2106; val_gene_expr_recon_loss: 1775018.4838; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 8999.1914; val_global_loss: 3819624.1620; val_optim_loss: 3819624.1620

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 525 min 28 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9155
val AUPRC score: 0.9528
val best accuracy score: 0.9158
val best F1 score: 0.9452
val target rna MSE score: 0.7509
val source rna MSE score: 0.1086
Val cat covariate0 mean sim diff: -0.0029
Val cat covariate1 mean sim diff: -0.0953

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
