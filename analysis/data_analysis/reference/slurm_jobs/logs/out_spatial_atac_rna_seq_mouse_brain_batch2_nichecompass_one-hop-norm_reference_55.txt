[True]
Run timestamp: 09102023_221220_55.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '25', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.003', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '5000000', '--lambda_gene_expr_recon', '3000', '--lambda_chrom_access_recon', '3000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '300', '--lambda_l1_addon', '300.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_55']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2838.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.003
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2304, n_latent: 2204, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2204, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6475; val_auprc_score: 0.6372; val_best_acc_score: 0.5005; val_best_f1_score: 0.6669; train_kl_reg_loss: 31796.1612; train_edge_recon_loss: 3505422.4280; train_gene_expr_recon_loss: 14128795.4697; train_masked_gp_l1_reg_loss: 33539.9471; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 3647635.9678; train_chrom_access_recon_loss: 6939418.3182; train_global_loss: 28286608.4545; train_optim_loss: 28286608.4545; val_kl_reg_loss: 75295.5713; val_edge_recon_loss: 4065258.0625; val_gene_expr_recon_loss: 13254106.8750; val_masked_gp_l1_reg_loss: 41929.8555; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 2030371.2500; val_chrom_access_recon_loss: 6841188.6875; val_global_loss: 26308151.2500; val_optim_loss: 26308151.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6517; val_auprc_score: 0.6395; val_best_acc_score: 0.5876; val_best_f1_score: 0.6883; train_kl_reg_loss: 82389.8127; train_edge_recon_loss: 3513473.2159; train_gene_expr_recon_loss: 12881485.4242; train_masked_gp_l1_reg_loss: 43371.4666; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1101810.7244; train_chrom_access_recon_loss: 6608699.8106; train_global_loss: 24231230.6061; train_optim_loss: 24231230.6061; val_kl_reg_loss: 80827.3223; val_edge_recon_loss: 4058850.1562; val_gene_expr_recon_loss: 12825454.5000; val_masked_gp_l1_reg_loss: 44600.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 526354.1250; val_chrom_access_recon_loss: 6696545.4375; val_global_loss: 24232631.5000; val_optim_loss: 24232631.5000
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7096; val_auprc_score: 0.6914; val_best_acc_score: 0.6472; val_best_f1_score: 0.6956; train_kl_reg_loss: 81856.5903; train_edge_recon_loss: 3508885.9280; train_gene_expr_recon_loss: 12681961.9242; train_masked_gp_l1_reg_loss: 45932.1067; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 348720.6155; train_chrom_access_recon_loss: 6542099.9167; train_global_loss: 23209457.0909; train_optim_loss: 23209457.0909; val_kl_reg_loss: 66282.1265; val_edge_recon_loss: 4024848.0000; val_gene_expr_recon_loss: 12848515.6250; val_masked_gp_l1_reg_loss: 47253.3672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 234261.1094; val_chrom_access_recon_loss: 6715822.4375; val_global_loss: 23936984.0000; val_optim_loss: 23936984.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7968; val_auprc_score: 0.7724; val_best_acc_score: 0.7171; val_best_f1_score: 0.7537; train_kl_reg_loss: 66312.3920; train_edge_recon_loss: 3461122.6894; train_gene_expr_recon_loss: 12597221.2273; train_masked_gp_l1_reg_loss: 48714.3307; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 185114.1655; train_chrom_access_recon_loss: 6503106.3182; train_global_loss: 22861590.9697; train_optim_loss: 22861590.9697; val_kl_reg_loss: 52079.5728; val_edge_recon_loss: 3521485.3438; val_gene_expr_recon_loss: 12828385.0000; val_masked_gp_l1_reg_loss: 50786.0273; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149615.7656; val_chrom_access_recon_loss: 6656395.6875; val_global_loss: 23258747.7500; val_optim_loss: 23258747.7500
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8415; val_auprc_score: 0.8117; val_best_acc_score: 0.7544; val_best_f1_score: 0.7927; train_kl_reg_loss: 77404.5282; train_edge_recon_loss: 3088037.9470; train_gene_expr_recon_loss: 12539042.2576; train_masked_gp_l1_reg_loss: 53922.7457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 133523.5530; train_chrom_access_recon_loss: 6469495.4848; train_global_loss: 22361426.6667; train_optim_loss: 22361426.6667; val_kl_reg_loss: 91876.2324; val_edge_recon_loss: 2969069.2500; val_gene_expr_recon_loss: 12692385.2500; val_masked_gp_l1_reg_loss: 56247.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 121484.0703; val_chrom_access_recon_loss: 6614663.6875; val_global_loss: 22545725.2500; val_optim_loss: 22545725.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8404; val_auprc_score: 0.8119; val_best_acc_score: 0.7587; val_best_f1_score: 0.7968; train_kl_reg_loss: 95369.8814; train_edge_recon_loss: 2946286.9318; train_gene_expr_recon_loss: 12440349.8485; train_masked_gp_l1_reg_loss: 57448.2973; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 113997.4286; train_chrom_access_recon_loss: 6425182.4242; train_global_loss: 22078634.9091; train_optim_loss: 22078634.9091; val_kl_reg_loss: 101738.5391; val_edge_recon_loss: 2916395.3438; val_gene_expr_recon_loss: 12604480.8750; val_masked_gp_l1_reg_loss: 58586.8750; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 107583.2578; val_chrom_access_recon_loss: 6583159.5000; val_global_loss: 22371944.5000; val_optim_loss: 22371944.5000
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8631; val_auprc_score: 0.8273; val_best_acc_score: 0.7821; val_best_f1_score: 0.8076; train_kl_reg_loss: 94188.8917; train_edge_recon_loss: 2894066.3333; train_gene_expr_recon_loss: 12371458.0909; train_masked_gp_l1_reg_loss: 59666.0439; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 102650.2758; train_chrom_access_recon_loss: 6395140.6212; train_global_loss: 21917170.0909; train_optim_loss: 21917170.0909; val_kl_reg_loss: 87422.6895; val_edge_recon_loss: 2912469.2812; val_gene_expr_recon_loss: 12608015.5000; val_masked_gp_l1_reg_loss: 60802.4766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 99171.7891; val_chrom_access_recon_loss: 6562561.8125; val_global_loss: 22330443.0000; val_optim_loss: 22330443.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8777; val_auprc_score: 0.8404; val_best_acc_score: 0.8109; val_best_f1_score: 0.8263; train_kl_reg_loss: 88682.8106; train_edge_recon_loss: 2866007.0038; train_gene_expr_recon_loss: 12310263.4545; train_masked_gp_l1_reg_loss: 61750.5605; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 95004.2799; train_chrom_access_recon_loss: 6366541.4470; train_global_loss: 21788249.5152; train_optim_loss: 21788249.5152; val_kl_reg_loss: 88945.0752; val_edge_recon_loss: 2866018.6562; val_gene_expr_recon_loss: 12413713.0000; val_masked_gp_l1_reg_loss: 62826.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92348.5625; val_chrom_access_recon_loss: 6472974.5625; val_global_loss: 21996827.0000; val_optim_loss: 21996827.0000
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8869; val_auprc_score: 0.8529; val_best_acc_score: 0.8256; val_best_f1_score: 0.8408; train_kl_reg_loss: 92669.3567; train_edge_recon_loss: 2834449.5303; train_gene_expr_recon_loss: 12251900.4091; train_masked_gp_l1_reg_loss: 63609.6457; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89921.4808; train_chrom_access_recon_loss: 6344536.9621; train_global_loss: 21677087.3333; train_optim_loss: 21677087.3333; val_kl_reg_loss: 90891.0664; val_edge_recon_loss: 2865902.3438; val_gene_expr_recon_loss: 12445696.0000; val_masked_gp_l1_reg_loss: 64544.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87981.4609; val_chrom_access_recon_loss: 6547882.5625; val_global_loss: 22102897.2500; val_optim_loss: 22102897.2500
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8940; val_auprc_score: 0.8669; val_best_acc_score: 0.8235; val_best_f1_score: 0.8397; train_kl_reg_loss: 93318.3784; train_edge_recon_loss: 2809506.0000; train_gene_expr_recon_loss: 12206459.3030; train_masked_gp_l1_reg_loss: 65226.9049; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86017.0685; train_chrom_access_recon_loss: 6330251.1439; train_global_loss: 21590778.8485; train_optim_loss: 21590778.8485; val_kl_reg_loss: 93646.1992; val_edge_recon_loss: 2834554.2500; val_gene_expr_recon_loss: 12258029.6250; val_masked_gp_l1_reg_loss: 66011.2969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84528.8281; val_chrom_access_recon_loss: 6392370.6875; val_global_loss: 21729141.0000; val_optim_loss: 21729141.0000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8873; val_auprc_score: 0.8481; val_best_acc_score: 0.8254; val_best_f1_score: 0.8407; train_kl_reg_loss: 90983.9568; train_edge_recon_loss: 2803125.1136; train_gene_expr_recon_loss: 12155591.0455; train_masked_gp_l1_reg_loss: 66553.1428; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82750.5336; train_chrom_access_recon_loss: 6298420.4773; train_global_loss: 21497424.1212; train_optim_loss: 21497424.1212; val_kl_reg_loss: 90730.5156; val_edge_recon_loss: 2820742.5000; val_gene_expr_recon_loss: 12254769.0000; val_masked_gp_l1_reg_loss: 67216.9766; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 81308.5547; val_chrom_access_recon_loss: 6418003.4375; val_global_loss: 21732771.5000; val_optim_loss: 21732771.5000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.9011; val_auprc_score: 0.8697; val_best_acc_score: 0.8458; val_best_f1_score: 0.8555; train_kl_reg_loss: 88624.8494; train_edge_recon_loss: 2785576.4508; train_gene_expr_recon_loss: 12109371.6818; train_masked_gp_l1_reg_loss: 67932.9714; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 80014.4502; train_chrom_access_recon_loss: 6276046.3258; train_global_loss: 21407566.7576; train_optim_loss: 21407566.7576; val_kl_reg_loss: 84835.0908; val_edge_recon_loss: 2830824.9688; val_gene_expr_recon_loss: 12220297.8750; val_masked_gp_l1_reg_loss: 68625.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 78669.5234; val_chrom_access_recon_loss: 6387288.4375; val_global_loss: 21670541.7500; val_optim_loss: 21670541.7500
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.8965; val_auprc_score: 0.8550; val_best_acc_score: 0.8372; val_best_f1_score: 0.8510; train_kl_reg_loss: 86386.2661; train_edge_recon_loss: 2788829.0795; train_gene_expr_recon_loss: 12058368.1667; train_masked_gp_l1_reg_loss: 69301.8018; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 77647.7769; train_chrom_access_recon_loss: 6257455.6591; train_global_loss: 21337988.8485; train_optim_loss: 21337988.8485; val_kl_reg_loss: 84866.8115; val_edge_recon_loss: 2804888.0000; val_gene_expr_recon_loss: 12291223.1250; val_masked_gp_l1_reg_loss: 69963.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 77226.2500; val_chrom_access_recon_loss: 6394209.7500; val_global_loss: 21722378.0000; val_optim_loss: 21722378.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9005; val_auprc_score: 0.8659; val_best_acc_score: 0.8391; val_best_f1_score: 0.8529; train_kl_reg_loss: 84862.5304; train_edge_recon_loss: 2770717.9015; train_gene_expr_recon_loss: 12024307.5303; train_masked_gp_l1_reg_loss: 70478.4753; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 75929.9715; train_chrom_access_recon_loss: 6236682.1591; train_global_loss: 21262978.6061; train_optim_loss: 21262978.6061; val_kl_reg_loss: 83551.1885; val_edge_recon_loss: 2821200.1562; val_gene_expr_recon_loss: 12156505.0000; val_masked_gp_l1_reg_loss: 71023.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74946.7109; val_chrom_access_recon_loss: 6368675.6875; val_global_loss: 21575902.5000; val_optim_loss: 21575902.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9129; val_auprc_score: 0.8842; val_best_acc_score: 0.8565; val_best_f1_score: 0.8682; train_kl_reg_loss: 85426.7295; train_edge_recon_loss: 2762775.2765; train_gene_expr_recon_loss: 11995743.1364; train_masked_gp_l1_reg_loss: 71511.4795; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 74446.9513; train_chrom_access_recon_loss: 6222665.8712; train_global_loss: 21212569.2424; train_optim_loss: 21212569.2424; val_kl_reg_loss: 86138.6953; val_edge_recon_loss: 2764518.2812; val_gene_expr_recon_loss: 12218423.0000; val_masked_gp_l1_reg_loss: 72098.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 74091.7969; val_chrom_access_recon_loss: 6425907.3125; val_global_loss: 21641177.5000; val_optim_loss: 21641177.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9115; val_auprc_score: 0.8806; val_best_acc_score: 0.8517; val_best_f1_score: 0.8630; train_kl_reg_loss: 84138.6342; train_edge_recon_loss: 2751991.2311; train_gene_expr_recon_loss: 11947215.1212; train_masked_gp_l1_reg_loss: 72412.9008; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 73328.2744; train_chrom_access_recon_loss: 6198977.9924; train_global_loss: 21128064.3333; train_optim_loss: 21128064.3333; val_kl_reg_loss: 82161.0518; val_edge_recon_loss: 2798907.1562; val_gene_expr_recon_loss: 12079809.8750; val_masked_gp_l1_reg_loss: 72885.3906; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 72699.9062; val_chrom_access_recon_loss: 6346868.3750; val_global_loss: 21453330.7500; val_optim_loss: 21453330.7500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9215; val_auprc_score: 0.8924; val_best_acc_score: 0.8665; val_best_f1_score: 0.8725; train_kl_reg_loss: 83005.5638; train_edge_recon_loss: 2761131.2121; train_gene_expr_recon_loss: 11927035.4242; train_masked_gp_l1_reg_loss: 73168.7586; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 72199.5117; train_chrom_access_recon_loss: 6192723.0152; train_global_loss: 21109263.5152; train_optim_loss: 21109263.5152; val_kl_reg_loss: 82471.7100; val_edge_recon_loss: 2767636.6875; val_gene_expr_recon_loss: 12062302.0000; val_masked_gp_l1_reg_loss: 73555.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71943.9453; val_chrom_access_recon_loss: 6299977.0000; val_global_loss: 21357887.2500; val_optim_loss: 21357887.2500
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9230; val_auprc_score: 0.8916; val_best_acc_score: 0.8667; val_best_f1_score: 0.8766; train_kl_reg_loss: 82284.2448; train_edge_recon_loss: 2755304.8371; train_gene_expr_recon_loss: 11893861.0758; train_masked_gp_l1_reg_loss: 73925.5632; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 71420.8853; train_chrom_access_recon_loss: 6177492.8561; train_global_loss: 21054289.3939; train_optim_loss: 21054289.3939; val_kl_reg_loss: 83292.4756; val_edge_recon_loss: 2776869.1562; val_gene_expr_recon_loss: 12091930.6250; val_masked_gp_l1_reg_loss: 74235.6797; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70884.9453; val_chrom_access_recon_loss: 6351250.6250; val_global_loss: 21448463.5000; val_optim_loss: 21448463.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9252; val_auprc_score: 0.9026; val_best_acc_score: 0.8684; val_best_f1_score: 0.8756; train_kl_reg_loss: 81543.5024; train_edge_recon_loss: 2737279.6098; train_gene_expr_recon_loss: 11868477.0606; train_masked_gp_l1_reg_loss: 74533.7205; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70737.8194; train_chrom_access_recon_loss: 6160789.7803; train_global_loss: 20993361.5152; train_optim_loss: 20993361.5152; val_kl_reg_loss: 82194.6484; val_edge_recon_loss: 2756988.4062; val_gene_expr_recon_loss: 11894274.8750; val_masked_gp_l1_reg_loss: 74897.7812; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70457.0625; val_chrom_access_recon_loss: 6248638.9375; val_global_loss: 21127451.7500; val_optim_loss: 21127451.7500
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9251; val_auprc_score: 0.8917; val_best_acc_score: 0.8732; val_best_f1_score: 0.8803; train_kl_reg_loss: 82155.8564; train_edge_recon_loss: 2745120.8523; train_gene_expr_recon_loss: 11839202.0455; train_masked_gp_l1_reg_loss: 75263.7045; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70459.0449; train_chrom_access_recon_loss: 6144086.9470; train_global_loss: 20956288.4848; train_optim_loss: 20956288.4848; val_kl_reg_loss: 80616.4092; val_edge_recon_loss: 2768987.8438; val_gene_expr_recon_loss: 11903282.8750; val_masked_gp_l1_reg_loss: 75506.9141; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70158.1797; val_chrom_access_recon_loss: 6271816.8125; val_global_loss: 21170368.7500; val_optim_loss: 21170368.7500
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9256; val_auprc_score: 0.8983; val_best_acc_score: 0.8686; val_best_f1_score: 0.8771; train_kl_reg_loss: 81263.7595; train_edge_recon_loss: 2727619.6553; train_gene_expr_recon_loss: 11802667.7879; train_masked_gp_l1_reg_loss: 75664.4102; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70033.9139; train_chrom_access_recon_loss: 6122577.1515; train_global_loss: 20879826.6970; train_optim_loss: 20879826.6970; val_kl_reg_loss: 80388.1318; val_edge_recon_loss: 2765329.2188; val_gene_expr_recon_loss: 11946479.6250; val_masked_gp_l1_reg_loss: 75936.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70160.7969; val_chrom_access_recon_loss: 6343942.6250; val_global_loss: 21282237.0000; val_optim_loss: 21282237.0000
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9307; val_auprc_score: 0.9086; val_best_acc_score: 0.8681; val_best_f1_score: 0.8764; train_kl_reg_loss: 80561.9458; train_edge_recon_loss: 2745138.3333; train_gene_expr_recon_loss: 11782035.4091; train_masked_gp_l1_reg_loss: 76161.1145; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70016.8214; train_chrom_access_recon_loss: 6110952.5682; train_global_loss: 20864866.2121; train_optim_loss: 20864866.2121; val_kl_reg_loss: 82540.8701; val_edge_recon_loss: 2770961.0938; val_gene_expr_recon_loss: 11877494.6250; val_masked_gp_l1_reg_loss: 76460.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70290.7266; val_chrom_access_recon_loss: 6246804.2500; val_global_loss: 21124551.7500; val_optim_loss: 21124551.7500
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9331; val_auprc_score: 0.9118; val_best_acc_score: 0.8729; val_best_f1_score: 0.8809; train_kl_reg_loss: 80818.1411; train_edge_recon_loss: 2740803.7992; train_gene_expr_recon_loss: 11763657.6212; train_masked_gp_l1_reg_loss: 76609.4892; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70442.8048; train_chrom_access_recon_loss: 6097198.3409; train_global_loss: 20829530.2727; train_optim_loss: 20829530.2727; val_kl_reg_loss: 81757.0234; val_edge_recon_loss: 2763307.5938; val_gene_expr_recon_loss: 11877008.2500; val_masked_gp_l1_reg_loss: 76900.3047; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70435.5391; val_chrom_access_recon_loss: 6230362.0625; val_global_loss: 21099771.0000; val_optim_loss: 21099771.0000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9278; val_auprc_score: 0.9052; val_best_acc_score: 0.8681; val_best_f1_score: 0.8789; train_kl_reg_loss: 79608.3118; train_edge_recon_loss: 2727191.3295; train_gene_expr_recon_loss: 11735181.4394; train_masked_gp_l1_reg_loss: 77031.5516; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70498.7688; train_chrom_access_recon_loss: 6086189.0909; train_global_loss: 20775700.5455; train_optim_loss: 20775700.5455; val_kl_reg_loss: 80840.3193; val_edge_recon_loss: 2767097.1562; val_gene_expr_recon_loss: 11800569.0000; val_masked_gp_l1_reg_loss: 77146.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 70533.3047; val_chrom_access_recon_loss: 6239793.3125; val_global_loss: 21035979.5000; val_optim_loss: 21035979.5000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9400; val_auprc_score: 0.9215; val_best_acc_score: 0.8794; val_best_f1_score: 0.8876; train_kl_reg_loss: 78629.2608; train_edge_recon_loss: 2721190.0795; train_gene_expr_recon_loss: 11714828.4545; train_masked_gp_l1_reg_loss: 77364.8068; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 70712.1535; train_chrom_access_recon_loss: 6070856.2045; train_global_loss: 20733581.0303; train_optim_loss: 20733581.0303; val_kl_reg_loss: 81064.2969; val_edge_recon_loss: 2745844.0938; val_gene_expr_recon_loss: 11843979.0000; val_masked_gp_l1_reg_loss: 77544.2344; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 71105.2734; val_chrom_access_recon_loss: 6286004.9375; val_global_loss: 21105541.5000; val_optim_loss: 21105541.5000
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9328; val_auprc_score: 0.9120; val_best_acc_score: 0.8667; val_best_f1_score: 0.8754; train_kl_reg_loss: 109710.7498; train_edge_recon_loss: 2863412.0114; train_gene_expr_recon_loss: 10549598.6818; train_masked_gp_l1_reg_loss: 77595.8725; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 68430.4587; train_chrom_access_recon_loss: 5574200.6136; train_global_loss: 19242948.4242; train_optim_loss: 19242948.4242; val_kl_reg_loss: 23149.3792; val_edge_recon_loss: 2820889.4062; val_gene_expr_recon_loss: 10695323.5000; val_masked_gp_l1_reg_loss: 76907.9219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68106.8047; val_chrom_access_recon_loss: 5678992.5000; val_global_loss: 19363369.5000; val_optim_loss: 19363369.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9362; val_auprc_score: 0.9129; val_best_acc_score: 0.8761; val_best_f1_score: 0.8827; train_kl_reg_loss: 85670.5598; train_edge_recon_loss: 2762029.5833; train_gene_expr_recon_loss: 10484499.0455; train_masked_gp_l1_reg_loss: 76096.9281; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67946.3205; train_chrom_access_recon_loss: 5480454.1818; train_global_loss: 18956696.4545; train_optim_loss: 18956696.4545; val_kl_reg_loss: 29594.3335; val_edge_recon_loss: 2787099.7812; val_gene_expr_recon_loss: 10619785.7500; val_masked_gp_l1_reg_loss: 75240.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 68141.9062; val_chrom_access_recon_loss: 5640737.3125; val_global_loss: 19220599.2500; val_optim_loss: 19220599.2500
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9299; val_auprc_score: 0.9038; val_best_acc_score: 0.8705; val_best_f1_score: 0.8776; train_kl_reg_loss: 68761.8200; train_edge_recon_loss: 2738228.0455; train_gene_expr_recon_loss: 10450050.4697; train_masked_gp_l1_reg_loss: 74360.8693; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67598.9657; train_chrom_access_recon_loss: 5461883.2045; train_global_loss: 18860883.3636; train_optim_loss: 18860883.3636; val_kl_reg_loss: 33174.5994; val_edge_recon_loss: 2790950.5625; val_gene_expr_recon_loss: 10588144.1250; val_masked_gp_l1_reg_loss: 73470.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 67541.9922; val_chrom_access_recon_loss: 5565765.3750; val_global_loss: 19119046.7500; val_optim_loss: 19119046.7500
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9384; val_auprc_score: 0.9085; val_best_acc_score: 0.8839; val_best_f1_score: 0.8892; train_kl_reg_loss: 58101.0707; train_edge_recon_loss: 2717123.0455; train_gene_expr_recon_loss: 10426495.7727; train_masked_gp_l1_reg_loss: 72656.6841; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 67047.3475; train_chrom_access_recon_loss: 5455429.9167; train_global_loss: 18796853.9091; train_optim_loss: 18796853.9091; val_kl_reg_loss: 38176.7061; val_edge_recon_loss: 2730635.6250; val_gene_expr_recon_loss: 10562756.7500; val_masked_gp_l1_reg_loss: 71897.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 66367.0547; val_chrom_access_recon_loss: 5594971.6875; val_global_loss: 19064805.7500; val_optim_loss: 19064805.7500
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9339; val_auprc_score: 0.9111; val_best_acc_score: 0.8721; val_best_f1_score: 0.8782; train_kl_reg_loss: 56326.5497; train_edge_recon_loss: 2707554.3712; train_gene_expr_recon_loss: 10418354.0152; train_masked_gp_l1_reg_loss: 71092.1249; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65779.3051; train_chrom_access_recon_loss: 5444131.1061; train_global_loss: 18763237.4242; train_optim_loss: 18763237.4242; val_kl_reg_loss: 40028.8208; val_edge_recon_loss: 2761604.5000; val_gene_expr_recon_loss: 10513643.6250; val_masked_gp_l1_reg_loss: 70297.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65664.1094; val_chrom_access_recon_loss: 5605967.1875; val_global_loss: 19057205.2500; val_optim_loss: 19057205.2500
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9375; val_auprc_score: 0.9090; val_best_acc_score: 0.8842; val_best_f1_score: 0.8909; train_kl_reg_loss: 56087.0990; train_edge_recon_loss: 2704508.0303; train_gene_expr_recon_loss: 10396709.6970; train_masked_gp_l1_reg_loss: 69625.7438; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 65219.4128; train_chrom_access_recon_loss: 5431567.2576; train_global_loss: 18723717.1515; train_optim_loss: 18723717.1515; val_kl_reg_loss: 43195.1992; val_edge_recon_loss: 2717558.2812; val_gene_expr_recon_loss: 10517066.7500; val_masked_gp_l1_reg_loss: 68976.7031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 65205.4688; val_chrom_access_recon_loss: 5600525.9375; val_global_loss: 19012528.2500; val_optim_loss: 19012528.2500
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9438; val_auprc_score: 0.9222; val_best_acc_score: 0.8861; val_best_f1_score: 0.8921; train_kl_reg_loss: 55295.2198; train_edge_recon_loss: 2703298.6439; train_gene_expr_recon_loss: 10385785.5000; train_masked_gp_l1_reg_loss: 68389.1100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64926.5301; train_chrom_access_recon_loss: 5427967.6212; train_global_loss: 18705662.5758; train_optim_loss: 18705662.5758; val_kl_reg_loss: 43508.6895; val_edge_recon_loss: 2694563.5938; val_gene_expr_recon_loss: 10524372.7500; val_masked_gp_l1_reg_loss: 67846.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64805.3906; val_chrom_access_recon_loss: 5614175.6875; val_global_loss: 19009271.5000; val_optim_loss: 19009271.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9424; val_auprc_score: 0.9213; val_best_acc_score: 0.8877; val_best_f1_score: 0.8936; train_kl_reg_loss: 53749.0614; train_edge_recon_loss: 2701454.3068; train_gene_expr_recon_loss: 10371116.4545; train_masked_gp_l1_reg_loss: 67367.0069; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64656.3103; train_chrom_access_recon_loss: 5416786.1439; train_global_loss: 18675129.2424; train_optim_loss: 18675129.2424; val_kl_reg_loss: 45594.6074; val_edge_recon_loss: 2733422.1875; val_gene_expr_recon_loss: 10440281.5000; val_masked_gp_l1_reg_loss: 66886.0859; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64727.5195; val_chrom_access_recon_loss: 5529691.6875; val_global_loss: 18880604.2500; val_optim_loss: 18880604.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9352; val_auprc_score: 0.9119; val_best_acc_score: 0.8761; val_best_f1_score: 0.8814; train_kl_reg_loss: 54137.6369; train_edge_recon_loss: 2699456.9735; train_gene_expr_recon_loss: 10355887.3182; train_masked_gp_l1_reg_loss: 66388.7944; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64310.0520; train_chrom_access_recon_loss: 5411893.6667; train_global_loss: 18652074.3939; train_optim_loss: 18652074.3939; val_kl_reg_loss: 44395.2412; val_edge_recon_loss: 2768056.3438; val_gene_expr_recon_loss: 10437609.2500; val_masked_gp_l1_reg_loss: 65933.7969; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64200.7969; val_chrom_access_recon_loss: 5548406.0000; val_global_loss: 18928601.2500; val_optim_loss: 18928601.2500
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9428; val_auprc_score: 0.9229; val_best_acc_score: 0.8826; val_best_f1_score: 0.8895; train_kl_reg_loss: 53203.6710; train_edge_recon_loss: 2704744.1023; train_gene_expr_recon_loss: 10343856.6364; train_masked_gp_l1_reg_loss: 65472.3965; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 64197.0331; train_chrom_access_recon_loss: 5405904.2652; train_global_loss: 18637377.9394; train_optim_loss: 18637377.9394; val_kl_reg_loss: 46691.3911; val_edge_recon_loss: 2723180.4375; val_gene_expr_recon_loss: 10482623.2500; val_masked_gp_l1_reg_loss: 65044.0430; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 64159.0859; val_chrom_access_recon_loss: 5580602.8125; val_global_loss: 18962300.7500; val_optim_loss: 18962300.7500
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9426; val_auprc_score: 0.9214; val_best_acc_score: 0.8839; val_best_f1_score: 0.8898; train_kl_reg_loss: 54095.2411; train_edge_recon_loss: 2688843.2121; train_gene_expr_recon_loss: 10304724.7424; train_masked_gp_l1_reg_loss: 64605.3176; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63905.4453; train_chrom_access_recon_loss: 5385046.1212; train_global_loss: 18561220.1818; train_optim_loss: 18561220.1818; val_kl_reg_loss: 50354.6953; val_edge_recon_loss: 2746166.7500; val_gene_expr_recon_loss: 10389289.5000; val_masked_gp_l1_reg_loss: 64139.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63646.3672; val_chrom_access_recon_loss: 5513150.2500; val_global_loss: 18826747.2500; val_optim_loss: 18826747.2500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9304; val_auprc_score: 0.8976; val_best_acc_score: 0.8786; val_best_f1_score: 0.8868; train_kl_reg_loss: 53420.8511; train_edge_recon_loss: 2695712.7765; train_gene_expr_recon_loss: 10296519.9394; train_masked_gp_l1_reg_loss: 63644.7696; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63528.6393; train_chrom_access_recon_loss: 5377629.6742; train_global_loss: 18550456.4848; train_optim_loss: 18550456.4848; val_kl_reg_loss: 46188.0791; val_edge_recon_loss: 2750668.2812; val_gene_expr_recon_loss: 10478032.0000; val_masked_gp_l1_reg_loss: 63279.9414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63672.6367; val_chrom_access_recon_loss: 5557691.9375; val_global_loss: 18959532.7500; val_optim_loss: 18959532.7500
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9396; val_auprc_score: 0.9135; val_best_acc_score: 0.8880; val_best_f1_score: 0.8928; train_kl_reg_loss: 51807.6046; train_edge_recon_loss: 2692682.5152; train_gene_expr_recon_loss: 10281447.5455; train_masked_gp_l1_reg_loss: 62921.7872; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63609.8569; train_chrom_access_recon_loss: 5372895.6591; train_global_loss: 18525364.8182; train_optim_loss: 18525364.8182; val_kl_reg_loss: 48279.9639; val_edge_recon_loss: 2719776.9062; val_gene_expr_recon_loss: 10412122.5000; val_masked_gp_l1_reg_loss: 62552.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63200.9922; val_chrom_access_recon_loss: 5501200.7500; val_global_loss: 18807134.2500; val_optim_loss: 18807134.2500
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9383; val_auprc_score: 0.9069; val_best_acc_score: 0.8896; val_best_f1_score: 0.8940; train_kl_reg_loss: 51285.8838; train_edge_recon_loss: 2687091.6894; train_gene_expr_recon_loss: 10266174.7121; train_masked_gp_l1_reg_loss: 62174.7397; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63435.4498; train_chrom_access_recon_loss: 5368226.9015; train_global_loss: 18498389.3333; train_optim_loss: 18498389.3333; val_kl_reg_loss: 48780.3481; val_edge_recon_loss: 2718347.8750; val_gene_expr_recon_loss: 10434482.5000; val_masked_gp_l1_reg_loss: 61863.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63489.6797; val_chrom_access_recon_loss: 5579046.9375; val_global_loss: 18906010.2500; val_optim_loss: 18906010.2500
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9357; val_auprc_score: 0.9059; val_best_acc_score: 0.8866; val_best_f1_score: 0.8914; train_kl_reg_loss: 51901.6926; train_edge_recon_loss: 2689442.8258; train_gene_expr_recon_loss: 10267405.5606; train_masked_gp_l1_reg_loss: 61545.6994; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63342.0869; train_chrom_access_recon_loss: 5365046.1818; train_global_loss: 18498684.0909; train_optim_loss: 18498684.0909; val_kl_reg_loss: 48387.6221; val_edge_recon_loss: 2723545.1562; val_gene_expr_recon_loss: 10349747.5000; val_masked_gp_l1_reg_loss: 61282.1367; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63426.0508; val_chrom_access_recon_loss: 5519485.0000; val_global_loss: 18765873.2500; val_optim_loss: 18765873.2500
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9361; val_auprc_score: 0.9044; val_best_acc_score: 0.8853; val_best_f1_score: 0.8919; train_kl_reg_loss: 52001.1642; train_edge_recon_loss: 2693615.7841; train_gene_expr_recon_loss: 10264805.7879; train_masked_gp_l1_reg_loss: 61035.3523; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63219.7501; train_chrom_access_recon_loss: 5361337.9924; train_global_loss: 18496015.7879; train_optim_loss: 18496015.7879; val_kl_reg_loss: 47990.3213; val_edge_recon_loss: 2718961.6562; val_gene_expr_recon_loss: 10486615.7500; val_masked_gp_l1_reg_loss: 60780.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 63001.8477; val_chrom_access_recon_loss: 5550571.1875; val_global_loss: 18927920.5000; val_optim_loss: 18927920.5000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9455; val_auprc_score: 0.9202; val_best_acc_score: 0.8941; val_best_f1_score: 0.8990; train_kl_reg_loss: 52181.3284; train_edge_recon_loss: 2694595.1932; train_gene_expr_recon_loss: 10251775.8788; train_masked_gp_l1_reg_loss: 60555.0720; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63048.9707; train_chrom_access_recon_loss: 5351016.9924; train_global_loss: 18473173.3636; train_optim_loss: 18473173.3636; val_kl_reg_loss: 48836.2339; val_edge_recon_loss: 2711997.7188; val_gene_expr_recon_loss: 10368884.0000; val_masked_gp_l1_reg_loss: 60322.0469; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62876.1484; val_chrom_access_recon_loss: 5487865.7500; val_global_loss: 18740781.5000; val_optim_loss: 18740781.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9468; val_auprc_score: 0.9224; val_best_acc_score: 0.8971; val_best_f1_score: 0.9029; train_kl_reg_loss: 51249.6538; train_edge_recon_loss: 2691031.2879; train_gene_expr_recon_loss: 10246797.3485; train_masked_gp_l1_reg_loss: 60095.1813; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62935.6739; train_chrom_access_recon_loss: 5343728.8182; train_global_loss: 18455838.0606; train_optim_loss: 18455838.0606; val_kl_reg_loss: 48563.8418; val_edge_recon_loss: 2710912.5938; val_gene_expr_recon_loss: 10366868.5000; val_masked_gp_l1_reg_loss: 59870.3711; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62787.9102; val_chrom_access_recon_loss: 5430193.0000; val_global_loss: 18679195.7500; val_optim_loss: 18679195.7500
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9499; val_auprc_score: 0.9315; val_best_acc_score: 0.8955; val_best_f1_score: 0.8991; train_kl_reg_loss: 51063.3862; train_edge_recon_loss: 2692205.0795; train_gene_expr_recon_loss: 10228745.8030; train_masked_gp_l1_reg_loss: 59715.6667; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62847.0400; train_chrom_access_recon_loss: 5333287.2727; train_global_loss: 18427864.2121; train_optim_loss: 18427864.2121; val_kl_reg_loss: 48129.5435; val_edge_recon_loss: 2724948.5000; val_gene_expr_recon_loss: 10369904.8750; val_masked_gp_l1_reg_loss: 59534.1016; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62758.5078; val_chrom_access_recon_loss: 5506238.1250; val_global_loss: 18771514.5000; val_optim_loss: 18771514.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9388; val_auprc_score: 0.9089; val_best_acc_score: 0.8874; val_best_f1_score: 0.8929; train_kl_reg_loss: 49353.2331; train_edge_recon_loss: 2672074.3788; train_gene_expr_recon_loss: 10220257.2727; train_masked_gp_l1_reg_loss: 59371.9691; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62769.6810; train_chrom_access_recon_loss: 5328466.1364; train_global_loss: 18392292.6061; train_optim_loss: 18392292.6061; val_kl_reg_loss: 47915.8843; val_edge_recon_loss: 2727232.2500; val_gene_expr_recon_loss: 10351147.7500; val_masked_gp_l1_reg_loss: 59184.9531; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62703.2695; val_chrom_access_recon_loss: 5442468.6875; val_global_loss: 18690652.5000; val_optim_loss: 18690652.5000
Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9496; val_auprc_score: 0.9317; val_best_acc_score: 0.8925; val_best_f1_score: 0.8978; train_kl_reg_loss: 50578.5289; train_edge_recon_loss: 2672268.8447; train_gene_expr_recon_loss: 10205101.7879; train_masked_gp_l1_reg_loss: 58936.8426; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62697.3092; train_chrom_access_recon_loss: 5321081.6061; train_global_loss: 18370664.9697; train_optim_loss: 18370664.9697; val_kl_reg_loss: 48901.4146; val_edge_recon_loss: 2700699.7812; val_gene_expr_recon_loss: 10245151.2500; val_masked_gp_l1_reg_loss: 58691.0352; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62694.6953; val_chrom_access_recon_loss: 5400133.0625; val_global_loss: 18516271.2500; val_optim_loss: 18516271.2500
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9477; val_auprc_score: 0.9233; val_best_acc_score: 0.8976; val_best_f1_score: 0.9026; train_kl_reg_loss: 50291.1882; train_edge_recon_loss: 2677924.3371; train_gene_expr_recon_loss: 10183388.8788; train_masked_gp_l1_reg_loss: 58515.0596; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62680.2148; train_chrom_access_recon_loss: 5307607.6364; train_global_loss: 18340407.3636; train_optim_loss: 18340407.3636; val_kl_reg_loss: 49134.3584; val_edge_recon_loss: 2697662.4062; val_gene_expr_recon_loss: 10249409.5000; val_masked_gp_l1_reg_loss: 58377.4102; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62470.6680; val_chrom_access_recon_loss: 5478581.1875; val_global_loss: 18595635.5000; val_optim_loss: 18595635.5000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9493; val_auprc_score: 0.9285; val_best_acc_score: 0.8982; val_best_f1_score: 0.9036; train_kl_reg_loss: 49170.4319; train_edge_recon_loss: 2685828.8409; train_gene_expr_recon_loss: 10179634.0303; train_masked_gp_l1_reg_loss: 58241.1477; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62620.0053; train_chrom_access_recon_loss: 5304515.9091; train_global_loss: 18340010.2424; train_optim_loss: 18340010.2424; val_kl_reg_loss: 46315.4878; val_edge_recon_loss: 2717335.8125; val_gene_expr_recon_loss: 10394818.8750; val_masked_gp_l1_reg_loss: 58121.9648; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62420.6992; val_chrom_access_recon_loss: 5439530.2500; val_global_loss: 18718543.5000; val_optim_loss: 18718543.5000
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9504; val_auprc_score: 0.9328; val_best_acc_score: 0.8904; val_best_f1_score: 0.8959; train_kl_reg_loss: 48524.2420; train_edge_recon_loss: 2677999.0417; train_gene_expr_recon_loss: 10172469.8333; train_masked_gp_l1_reg_loss: 58063.4222; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62557.3101; train_chrom_access_recon_loss: 5304363.3712; train_global_loss: 18323977.1818; train_optim_loss: 18323977.1818; val_kl_reg_loss: 47843.2788; val_edge_recon_loss: 2739153.5000; val_gene_expr_recon_loss: 10290195.1250; val_masked_gp_l1_reg_loss: 57992.1602; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62684.3477; val_chrom_access_recon_loss: 5441889.6250; val_global_loss: 18639757.7500; val_optim_loss: 18639757.7500
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9469; val_auprc_score: 0.9238; val_best_acc_score: 0.8915; val_best_f1_score: 0.8965; train_kl_reg_loss: 49266.7871; train_edge_recon_loss: 2674296.1667; train_gene_expr_recon_loss: 10152482.6364; train_masked_gp_l1_reg_loss: 57849.8564; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 62434.0325; train_chrom_access_recon_loss: 5283736.7500; train_global_loss: 18280066.1818; train_optim_loss: 18280066.1818; val_kl_reg_loss: 44704.9497; val_edge_recon_loss: 2719525.0938; val_gene_expr_recon_loss: 10279869.0000; val_masked_gp_l1_reg_loss: 57730.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 62413.6875; val_chrom_access_recon_loss: 5404215.3125; val_global_loss: 18568459.2500; val_optim_loss: 18568459.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9522; val_auprc_score: 0.9320; val_best_acc_score: 0.8971; val_best_f1_score: 0.9012; train_kl_reg_loss: 46457.3149; train_edge_recon_loss: 2677085.3106; train_gene_expr_recon_loss: 10140778.5909; train_masked_gp_l1_reg_loss: 57448.5517; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53386.5465; train_chrom_access_recon_loss: 5280627.2121; train_global_loss: 18255783.7273; train_optim_loss: 18255783.7273; val_kl_reg_loss: 45454.6001; val_edge_recon_loss: 2717954.1250; val_gene_expr_recon_loss: 10228486.3750; val_masked_gp_l1_reg_loss: 57353.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51647.3516; val_chrom_access_recon_loss: 5397365.1875; val_global_loss: 18498261.2500; val_optim_loss: 18498261.2500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9490; val_auprc_score: 0.9271; val_best_acc_score: 0.8936; val_best_f1_score: 0.8974; train_kl_reg_loss: 47396.6076; train_edge_recon_loss: 2685593.7083; train_gene_expr_recon_loss: 10134497.3030; train_masked_gp_l1_reg_loss: 57321.6890; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51451.8672; train_chrom_access_recon_loss: 5274608.2803; train_global_loss: 18250869.3636; train_optim_loss: 18250869.3636; val_kl_reg_loss: 46286.7139; val_edge_recon_loss: 2753924.3438; val_gene_expr_recon_loss: 10331839.6250; val_masked_gp_l1_reg_loss: 57304.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51274.9531; val_chrom_access_recon_loss: 5415321.1250; val_global_loss: 18655951.5000; val_optim_loss: 18655951.5000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9552; val_auprc_score: 0.9405; val_best_acc_score: 0.9011; val_best_f1_score: 0.9046; train_kl_reg_loss: 48227.7456; train_edge_recon_loss: 2676048.2311; train_gene_expr_recon_loss: 10127083.2121; train_masked_gp_l1_reg_loss: 57287.7289; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 51165.1410; train_chrom_access_recon_loss: 5267914.0985; train_global_loss: 18227726.1818; train_optim_loss: 18227726.1818; val_kl_reg_loss: 47341.2441; val_edge_recon_loss: 2716500.6875; val_gene_expr_recon_loss: 10308013.8750; val_masked_gp_l1_reg_loss: 57273.2227; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 51003.4258; val_chrom_access_recon_loss: 5427386.3750; val_global_loss: 18607518.2500; val_optim_loss: 18607518.2500
Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9508; val_auprc_score: 0.9261; val_best_acc_score: 0.9003; val_best_f1_score: 0.9061; train_kl_reg_loss: 48972.9696; train_edge_recon_loss: 2678024.1856; train_gene_expr_recon_loss: 10135474.4545; train_masked_gp_l1_reg_loss: 57254.4285; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50932.6037; train_chrom_access_recon_loss: 5275709.9773; train_global_loss: 18246368.6970; train_optim_loss: 18246368.6970; val_kl_reg_loss: 47829.1577; val_edge_recon_loss: 2681467.7812; val_gene_expr_recon_loss: 10282830.0000; val_masked_gp_l1_reg_loss: 57241.3594; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50832.1641; val_chrom_access_recon_loss: 5395891.7500; val_global_loss: 18516092.0000; val_optim_loss: 18516092.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9514; val_auprc_score: 0.9269; val_best_acc_score: 0.8990; val_best_f1_score: 0.9046; train_kl_reg_loss: 49348.5262; train_edge_recon_loss: 2668445.6780; train_gene_expr_recon_loss: 10128909.0909; train_masked_gp_l1_reg_loss: 57232.3550; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 50748.5972; train_chrom_access_recon_loss: 5272401.7879; train_global_loss: 18227086.0303; train_optim_loss: 18227086.0303; val_kl_reg_loss: 48033.8037; val_edge_recon_loss: 2700592.5938; val_gene_expr_recon_loss: 10280366.7500; val_masked_gp_l1_reg_loss: 57215.4414; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 50720.7656; val_chrom_access_recon_loss: 5423711.6250; val_global_loss: 18560640.2500; val_optim_loss: 18560640.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9509; val_auprc_score: 0.9303; val_best_acc_score: 0.8987; val_best_f1_score: 0.9037; train_kl_reg_loss: 49541.9628; train_edge_recon_loss: 2677439.3939; train_gene_expr_recon_loss: 10128132.1818; train_masked_gp_l1_reg_loss: 57186.0352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49727.7965; train_chrom_access_recon_loss: 5272932.0530; train_global_loss: 18234959.6061; train_optim_loss: 18234959.6061; val_kl_reg_loss: 48371.9194; val_edge_recon_loss: 2703327.1250; val_gene_expr_recon_loss: 10392783.5000; val_masked_gp_l1_reg_loss: 57174.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49538.7891; val_chrom_access_recon_loss: 5476580.1875; val_global_loss: 18727777.0000; val_optim_loss: 18727777.0000
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9540; val_auprc_score: 0.9315; val_best_acc_score: 0.9033; val_best_f1_score: 0.9077; train_kl_reg_loss: 49601.7375; train_edge_recon_loss: 2671840.8030; train_gene_expr_recon_loss: 10137529.6061; train_masked_gp_l1_reg_loss: 57170.2361; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49520.7901; train_chrom_access_recon_loss: 5275608.1515; train_global_loss: 18241271.3636; train_optim_loss: 18241271.3636; val_kl_reg_loss: 48554.7065; val_edge_recon_loss: 2685323.3750; val_gene_expr_recon_loss: 10271170.3750; val_masked_gp_l1_reg_loss: 57166.7188; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49503.9727; val_chrom_access_recon_loss: 5404673.5000; val_global_loss: 18516393.0000; val_optim_loss: 18516393.0000
Epoch 58/400 |██------------------| 14.5% val_auroc_score: 0.9539; val_auprc_score: 0.9297; val_best_acc_score: 0.9035; val_best_f1_score: 0.9090; train_kl_reg_loss: 49433.6297; train_edge_recon_loss: 2670833.2576; train_gene_expr_recon_loss: 10126183.3030; train_masked_gp_l1_reg_loss: 57164.0047; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49490.5389; train_chrom_access_recon_loss: 5272555.5455; train_global_loss: 18225660.4848; train_optim_loss: 18225660.4848; val_kl_reg_loss: 48278.3921; val_edge_recon_loss: 2703829.9688; val_gene_expr_recon_loss: 10299705.1250; val_masked_gp_l1_reg_loss: 57161.5547; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49477.2539; val_chrom_access_recon_loss: 5468131.2500; val_global_loss: 18626584.2500; val_optim_loss: 18626584.2500
Epoch 59/400 |██------------------| 14.8% val_auroc_score: 0.9527; val_auprc_score: 0.9295; val_best_acc_score: 0.9003; val_best_f1_score: 0.9052; train_kl_reg_loss: 49610.7079; train_edge_recon_loss: 2665616.5152; train_gene_expr_recon_loss: 10121310.1970; train_masked_gp_l1_reg_loss: 57159.5718; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 49466.6213; train_chrom_access_recon_loss: 5268891.2879; train_global_loss: 18212054.8485; train_optim_loss: 18212054.8485; val_kl_reg_loss: 48497.4854; val_edge_recon_loss: 2691249.5000; val_gene_expr_recon_loss: 10294724.5000; val_masked_gp_l1_reg_loss: 57157.7461; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 49454.9180; val_chrom_access_recon_loss: 5428411.5625; val_global_loss: 18569496.2500; val_optim_loss: 18569496.2500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 26 min 54 sec.
Using best model state, which was in epoch 51.

--- MODEL EVALUATION ---
val AUROC score: 0.9562
val AUPRC score: 0.9362
val best accuracy score: 0.9027
val best F1 score: 0.9081
val target rna MSE score: 2.3256
val source rna MSE score: 1.0091
val target atac MSE score: 0.3468
val source atac MSE score: 0.1400
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
