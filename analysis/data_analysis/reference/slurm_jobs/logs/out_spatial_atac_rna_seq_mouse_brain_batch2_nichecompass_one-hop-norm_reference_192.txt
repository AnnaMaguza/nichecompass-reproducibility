[True]
Run timestamp: 10102023_073806_192.
Script arguments:
['../train_nichecompass_reference_model.py', '--dataset', 'spatial_atac_rna_seq_mouse_brain_batch2', '--reference_batches', 'None', '--n_neighbors', '4', '--filter_genes', '--n_hvg', '0', '--n_svg', '3000', '--n_svp', '15000', '--nichenet_keep_target_genes_ratio', '1.0', '--nichenet_max_n_target_genes_per_gp', '250', '--include_mebocost_gps', '--include_collectri_gps', '--include_brain_marker_gps', '--species', 'mouse', '--gp_filter_mode', 'subset', '--combine_overlap_gps', '--overlap_thresh_source_genes', '0.9', '--overlap_thresh_target_genes', '0.9', '--overlap_thresh_genes', '0.9', '--counts_key', 'counts', '--condition_key', 'batch', '--cat_covariates_keys', 'batch', '--cat_covariates_no_edges', 'True', '--spatial_key', 'spatial', '--adj_key', 'spatial_connectivities', '--mapping_entity_key', 'mapping_entity', '--gp_targets_mask_key', 'nichecompass_gp_targets', '--gp_sources_mask_key', 'nichecompass_gp_sources', '--gp_names_key', 'nichecompass_gp_names', '--include_atac_modality', '--filter_peaks', '--min_cell_peak_thresh_ratio', '0.005', '--min_cell_gene_thresh_ratio', '0.005', '--model_label', 'reference', '--active_gp_names_key', 'nichecompass_active_gp_names', '--latent_key', 'nichecompass_latent', '--n_addon_gp', '100', '--active_gp_thresh_ratio', '0.0', '--gene_expr_recon_dist', 'nb', '--cat_covariates_embeds_injection', 'None', '--cat_covariates_embeds_nums', '0', '--log_variational', '--node_label_method', 'one-hop-norm', '--n_layers_encoder', '1', '--n_hidden_encoder', 'None', '--conv_layer_encoder', 'gatv2conv', '--n_epochs', '400', '--n_epochs_all_gps', '25', '--n_epochs_no_cat_covariates_contrastive', '0', '--lr', '0.001', '--lambda_edge_recon', '1000000', '--lambda_gene_expr_recon', '5000', '--lambda_chrom_access_recon', '1000', '--lambda_cat_covariates_contrastive', '0.0', '--contrastive_logits_pos_ratio', '0.0', '--contrastive_logits_neg_ratio', '0.0', '--lambda_group_lasso', '0.', '--lambda_l1_masked', '500', '--lambda_l1_addon', '500.', '--edge_batch_size', '256', '--node_batch_size', 'None', '--n_sampled_neighbors', '4', '--timestamp_suffix', '_192']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 3404.
Number of gene programs after filtering and combining: 2803.

Filtering genes...
Starting with 22914 genes.
Keeping 12959 genes after filtering genes with expression in {} cells.
Keeping 3000 spatially variable, highly variable or gene program relevant genes.

Filtering peaks...
Starting with 121068 peaks.
Keeping 120652 peaks after filtering  peaks with counts in less than 46 cells.
Keeping 15000 peaks after filtering spatially variable peaks.
Keeping 2465 peaks after filtering peaks with no matching genes in gp mask.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, rna_recon_loss: nb, include_chrom_access_recon_loss: True, atac_recon_loss: nb 
NODE LABEL METHOD -> one-hop-norm
ACTIVE GP THRESHOLD RATIO -> 0.0
LOG VARIATIONAL -> True
CATEGORICAL COVARIATES EMBEDDINGS INJECTION -> ['None']
ONE HOP GCN NORM RNA NODE LABEL AGGREGATOR
ONE HOP GCN NORM ATAC NODE LABEL AGGREGATOR
ENCODER -> n_input: 5213, n_cat_covariates_embed_input: 0, n_hidden: 2323, n_latent: 2223, n_addon_latent: 100, n_fc_layers: 1, n_layers: 1, conv_layer: gatv2conv, n_attention_heads: 4, dropout_rate: 0.0, use_bn: False
COSINE SIM GRAPH DECODER -> dropout_rate: 0.0
MASKED TARGET RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED SOURCE RNA DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2748
MASKED TARGET ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465
MASKED SOURCE ATAC DECODER -> n_prior_gp_input: 2223, n_addon_gp_input: 100, n_cat_covariates_embed_input: 0, n_output: 2465

--- INITIALIZING TRAINER ---
Number of training nodes: 8293
Number of validation nodes: 922
Number of training edges: 16751
Number of validation edges: 1861
Edge batch size: 256
Node batch size: None

--- MODEL TRAINING ---
Epoch 1/400 |--------------------| 0.2% val_auroc_score: 0.6999; val_auprc_score: 0.6738; val_best_acc_score: 0.5013; val_best_f1_score: 0.6671; train_kl_reg_loss: 40875.7703; train_edge_recon_loss: 731285.0246; train_gene_expr_recon_loss: 23656019.3333; train_masked_gp_l1_reg_loss: 155507.2100; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 5170042.6705; train_chrom_access_recon_loss: 2358426.0379; train_global_loss: 32112155.7879; train_optim_loss: 32112155.7879; val_kl_reg_loss: 65227.1968; val_edge_recon_loss: 813076.8281; val_gene_expr_recon_loss: 21530021.5000; val_masked_gp_l1_reg_loss: 126115.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 3112702.5000; val_chrom_access_recon_loss: 2240023.6875; val_global_loss: 27887167.2500; val_optim_loss: 27887167.2500
Epoch 2/400 |--------------------| 0.5% val_auroc_score: 0.6985; val_auprc_score: 0.6738; val_best_acc_score: 0.5449; val_best_f1_score: 0.6845; train_kl_reg_loss: 74700.3756; train_edge_recon_loss: 740008.0985; train_gene_expr_recon_loss: 21279664.1212; train_masked_gp_l1_reg_loss: 117738.9344; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 1831163.9223; train_chrom_access_recon_loss: 2216729.6780; train_global_loss: 26260005.0909; train_optim_loss: 26260005.0909; val_kl_reg_loss: 84268.8027; val_edge_recon_loss: 812560.8359; val_gene_expr_recon_loss: 21092545.2500; val_masked_gp_l1_reg_loss: 111133.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 963820.6875; val_chrom_access_recon_loss: 2183481.4688; val_global_loss: 25247810.2500; val_optim_loss: 25247810.2500
Epoch 3/400 |--------------------| 0.8% val_auroc_score: 0.7453; val_auprc_score: 0.7142; val_best_acc_score: 0.6298; val_best_f1_score: 0.7192; train_kl_reg_loss: 77180.8623; train_edge_recon_loss: 736100.1259; train_gene_expr_recon_loss: 21025002.1818; train_masked_gp_l1_reg_loss: 108307.7487; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 637392.8409; train_chrom_access_recon_loss: 2197808.6856; train_global_loss: 24781792.5455; train_optim_loss: 24781792.5455; val_kl_reg_loss: 74371.4170; val_edge_recon_loss: 811606.0703; val_gene_expr_recon_loss: 20764055.2500; val_masked_gp_l1_reg_loss: 106760.9688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 416190.5312; val_chrom_access_recon_loss: 2155424.9844; val_global_loss: 24328408.0000; val_optim_loss: 24328408.0000
Epoch 4/400 |--------------------| 1.0% val_auroc_score: 0.7911; val_auprc_score: 0.7762; val_best_acc_score: 0.7101; val_best_f1_score: 0.7413; train_kl_reg_loss: 72318.8147; train_edge_recon_loss: 732475.7661; train_gene_expr_recon_loss: 20880481.6667; train_masked_gp_l1_reg_loss: 106337.1352; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 315562.0336; train_chrom_access_recon_loss: 2182943.1193; train_global_loss: 24290118.6364; train_optim_loss: 24290118.6364; val_kl_reg_loss: 70392.3799; val_edge_recon_loss: 807185.0703; val_gene_expr_recon_loss: 20713021.0000; val_masked_gp_l1_reg_loss: 106413.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 242000.5156; val_chrom_access_recon_loss: 2146430.2188; val_global_loss: 24085442.5000; val_optim_loss: 24085442.5000
Epoch 5/400 |--------------------| 1.2% val_auroc_score: 0.8393; val_auprc_score: 0.8206; val_best_acc_score: 0.7308; val_best_f1_score: 0.7549; train_kl_reg_loss: 67893.2581; train_edge_recon_loss: 727688.6742; train_gene_expr_recon_loss: 20740305.4848; train_masked_gp_l1_reg_loss: 107065.7636; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 205106.0125; train_chrom_access_recon_loss: 2168876.7027; train_global_loss: 24016935.7879; train_optim_loss: 24016935.7879; val_kl_reg_loss: 66316.4971; val_edge_recon_loss: 794547.4922; val_gene_expr_recon_loss: 20723190.2500; val_masked_gp_l1_reg_loss: 108094.6172; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 178638.8438; val_chrom_access_recon_loss: 2142778.4062; val_global_loss: 24013564.2500; val_optim_loss: 24013564.2500
Epoch 6/400 |--------------------| 1.5% val_auroc_score: 0.8613; val_auprc_score: 0.8277; val_best_acc_score: 0.7904; val_best_f1_score: 0.8074; train_kl_reg_loss: 64476.5785; train_edge_recon_loss: 717309.9972; train_gene_expr_recon_loss: 20600776.0000; train_masked_gp_l1_reg_loss: 109034.4646; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 163561.0793; train_chrom_access_recon_loss: 2160801.3523; train_global_loss: 23815959.2121; train_optim_loss: 23815959.2121; val_kl_reg_loss: 66994.0420; val_edge_recon_loss: 744345.1719; val_gene_expr_recon_loss: 20648072.7500; val_masked_gp_l1_reg_loss: 110256.2578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 149099.5156; val_chrom_access_recon_loss: 2169956.5781; val_global_loss: 23888724.7500; val_optim_loss: 23888724.7500
Epoch 7/400 |--------------------| 1.8% val_auroc_score: 0.8582; val_auprc_score: 0.8223; val_best_acc_score: 0.7800; val_best_f1_score: 0.7980; train_kl_reg_loss: 66032.5548; train_edge_recon_loss: 685005.2718; train_gene_expr_recon_loss: 20475650.2121; train_masked_gp_l1_reg_loss: 111540.7712; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 139936.6357; train_chrom_access_recon_loss: 2147587.4621; train_global_loss: 23625753.0606; train_optim_loss: 23625753.0606; val_kl_reg_loss: 72380.7236; val_edge_recon_loss: 670756.9531; val_gene_expr_recon_loss: 20416950.7500; val_masked_gp_l1_reg_loss: 112706.6719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 132488.3750; val_chrom_access_recon_loss: 2145171.2188; val_global_loss: 23550454.0000; val_optim_loss: 23550454.0000
Epoch 8/400 |--------------------| 2.0% val_auroc_score: 0.8813; val_auprc_score: 0.8534; val_best_acc_score: 0.8015; val_best_f1_score: 0.8137; train_kl_reg_loss: 74987.8267; train_edge_recon_loss: 646915.2756; train_gene_expr_recon_loss: 20374789.2727; train_masked_gp_l1_reg_loss: 113023.8604; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 128489.1147; train_chrom_access_recon_loss: 2138321.8674; train_global_loss: 23476527.3333; train_optim_loss: 23476527.3333; val_kl_reg_loss: 75242.2266; val_edge_recon_loss: 641973.5312; val_gene_expr_recon_loss: 20253488.7500; val_masked_gp_l1_reg_loss: 114021.4453; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 124898.2734; val_chrom_access_recon_loss: 2117872.1719; val_global_loss: 23327496.7500; val_optim_loss: 23327496.7500
Epoch 9/400 |--------------------| 2.2% val_auroc_score: 0.8794; val_auprc_score: 0.8524; val_best_acc_score: 0.8009; val_best_f1_score: 0.8165; train_kl_reg_loss: 76960.0277; train_edge_recon_loss: 638099.0265; train_gene_expr_recon_loss: 20296933.4545; train_masked_gp_l1_reg_loss: 114770.7958; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 120242.9551; train_chrom_access_recon_loss: 2131036.9034; train_global_loss: 23378043.1212; train_optim_loss: 23378043.1212; val_kl_reg_loss: 77117.5752; val_edge_recon_loss: 633979.8828; val_gene_expr_recon_loss: 20086847.5000; val_masked_gp_l1_reg_loss: 115580.4688; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 117232.6484; val_chrom_access_recon_loss: 2119382.4375; val_global_loss: 23150139.0000; val_optim_loss: 23150139.0000
Epoch 10/400 |--------------------| 2.5% val_auroc_score: 0.8836; val_auprc_score: 0.8453; val_best_acc_score: 0.8122; val_best_f1_score: 0.8261; train_kl_reg_loss: 76036.2191; train_edge_recon_loss: 629693.8059; train_gene_expr_recon_loss: 20179496.9697; train_masked_gp_l1_reg_loss: 116069.0169; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 114090.4103; train_chrom_access_recon_loss: 2119318.8598; train_global_loss: 23234705.2121; train_optim_loss: 23234705.2121; val_kl_reg_loss: 75762.1182; val_edge_recon_loss: 627119.2344; val_gene_expr_recon_loss: 19964242.5000; val_masked_gp_l1_reg_loss: 116647.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 110796.4766; val_chrom_access_recon_loss: 2112279.4219; val_global_loss: 23006847.5000; val_optim_loss: 23006847.5000
Epoch 11/400 |--------------------| 2.8% val_auroc_score: 0.8984; val_auprc_score: 0.8676; val_best_acc_score: 0.8216; val_best_f1_score: 0.8343; train_kl_reg_loss: 75560.6546; train_edge_recon_loss: 627058.2756; train_gene_expr_recon_loss: 20107168.6667; train_masked_gp_l1_reg_loss: 117193.4769; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 108233.1857; train_chrom_access_recon_loss: 2112937.3466; train_global_loss: 23148151.5455; train_optim_loss: 23148151.5455; val_kl_reg_loss: 75841.4844; val_edge_recon_loss: 627347.7031; val_gene_expr_recon_loss: 20136960.5000; val_masked_gp_l1_reg_loss: 118029.2031; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 106925.7656; val_chrom_access_recon_loss: 2131825.6875; val_global_loss: 23196932.0000; val_optim_loss: 23196932.0000
Epoch 12/400 |--------------------| 3.0% val_auroc_score: 0.8985; val_auprc_score: 0.8686; val_best_acc_score: 0.8286; val_best_f1_score: 0.8443; train_kl_reg_loss: 76013.4709; train_edge_recon_loss: 617372.8362; train_gene_expr_recon_loss: 20044707.6667; train_masked_gp_l1_reg_loss: 118352.8946; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 103966.1231; train_chrom_access_recon_loss: 2106592.3580; train_global_loss: 23067005.4242; train_optim_loss: 23067005.4242; val_kl_reg_loss: 75963.9717; val_edge_recon_loss: 619450.3281; val_gene_expr_recon_loss: 19930736.0000; val_masked_gp_l1_reg_loss: 118982.4922; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 102157.1797; val_chrom_access_recon_loss: 2096360.6719; val_global_loss: 22943651.0000; val_optim_loss: 22943651.0000
Epoch 13/400 |--------------------| 3.2% val_auroc_score: 0.9081; val_auprc_score: 0.8835; val_best_acc_score: 0.8423; val_best_f1_score: 0.8525; train_kl_reg_loss: 75304.4893; train_edge_recon_loss: 615685.9915; train_gene_expr_recon_loss: 19981320.4242; train_masked_gp_l1_reg_loss: 119268.2620; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 100472.6102; train_chrom_access_recon_loss: 2101690.3295; train_global_loss: 22993741.8182; train_optim_loss: 22993741.8182; val_kl_reg_loss: 74791.3174; val_edge_recon_loss: 622665.3672; val_gene_expr_recon_loss: 19871419.2500; val_masked_gp_l1_reg_loss: 119659.8672; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 98179.6250; val_chrom_access_recon_loss: 2083054.8125; val_global_loss: 22869771.0000; val_optim_loss: 22869771.0000
Epoch 14/400 |--------------------| 3.5% val_auroc_score: 0.9185; val_auprc_score: 0.8966; val_best_acc_score: 0.8474; val_best_f1_score: 0.8584; train_kl_reg_loss: 74853.0896; train_edge_recon_loss: 611428.0047; train_gene_expr_recon_loss: 19906913.0000; train_masked_gp_l1_reg_loss: 119977.6849; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 96979.4621; train_chrom_access_recon_loss: 2092134.5095; train_global_loss: 22902285.6970; train_optim_loss: 22902285.6970; val_kl_reg_loss: 75292.5117; val_edge_recon_loss: 611333.6406; val_gene_expr_recon_loss: 19781388.0000; val_masked_gp_l1_reg_loss: 120588.8516; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 96226.4766; val_chrom_access_recon_loss: 2083131.6562; val_global_loss: 22767959.5000; val_optim_loss: 22767959.5000
Epoch 15/400 |--------------------| 3.8% val_auroc_score: 0.9235; val_auprc_score: 0.9007; val_best_acc_score: 0.8544; val_best_f1_score: 0.8638; train_kl_reg_loss: 74886.0335; train_edge_recon_loss: 607009.4318; train_gene_expr_recon_loss: 19855099.3939; train_masked_gp_l1_reg_loss: 120674.6510; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 94709.7075; train_chrom_access_recon_loss: 2086463.8371; train_global_loss: 22838843.2121; train_optim_loss: 22838843.2121; val_kl_reg_loss: 74781.6807; val_edge_recon_loss: 610311.5469; val_gene_expr_recon_loss: 19693733.5000; val_masked_gp_l1_reg_loss: 121190.3203; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 93934.9062; val_chrom_access_recon_loss: 2081803.8906; val_global_loss: 22675755.5000; val_optim_loss: 22675755.5000
Epoch 16/400 |--------------------| 4.0% val_auroc_score: 0.9261; val_auprc_score: 0.9082; val_best_acc_score: 0.8555; val_best_f1_score: 0.8639; train_kl_reg_loss: 74218.7071; train_edge_recon_loss: 607673.8068; train_gene_expr_recon_loss: 19814603.6970; train_masked_gp_l1_reg_loss: 121395.0656; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 92422.6259; train_chrom_access_recon_loss: 2082089.6572; train_global_loss: 22792403.4545; train_optim_loss: 22792403.4545; val_kl_reg_loss: 72272.7803; val_edge_recon_loss: 614377.3047; val_gene_expr_recon_loss: 19733188.5000; val_masked_gp_l1_reg_loss: 121790.1719; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 92276.9531; val_chrom_access_recon_loss: 2056018.4844; val_global_loss: 22689923.2500; val_optim_loss: 22689923.2500
Epoch 17/400 |--------------------| 4.2% val_auroc_score: 0.9278; val_auprc_score: 0.9010; val_best_acc_score: 0.8659; val_best_f1_score: 0.8731; train_kl_reg_loss: 74027.1209; train_edge_recon_loss: 602916.1004; train_gene_expr_recon_loss: 19755800.5152; train_masked_gp_l1_reg_loss: 121827.3178; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 90981.4688; train_chrom_access_recon_loss: 2074588.6742; train_global_loss: 22720141.3030; train_optim_loss: 22720141.3030; val_kl_reg_loss: 73652.5576; val_edge_recon_loss: 605842.7891; val_gene_expr_recon_loss: 19737528.2500; val_masked_gp_l1_reg_loss: 122192.0234; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 91039.3125; val_chrom_access_recon_loss: 2074155.1094; val_global_loss: 22704410.5000; val_optim_loss: 22704410.5000
Epoch 18/400 |--------------------| 4.5% val_auroc_score: 0.9248; val_auprc_score: 0.9012; val_best_acc_score: 0.8643; val_best_f1_score: 0.8736; train_kl_reg_loss: 73940.4062; train_edge_recon_loss: 601444.7841; train_gene_expr_recon_loss: 19707176.1515; train_masked_gp_l1_reg_loss: 122391.4138; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 89456.1341; train_chrom_access_recon_loss: 2072197.8087; train_global_loss: 22666606.6061; train_optim_loss: 22666606.6061; val_kl_reg_loss: 73426.9922; val_edge_recon_loss: 605314.3828; val_gene_expr_recon_loss: 19615990.5000; val_masked_gp_l1_reg_loss: 122730.6875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 88647.8672; val_chrom_access_recon_loss: 2064503.3125; val_global_loss: 22570613.5000; val_optim_loss: 22570613.5000
Epoch 19/400 |--------------------| 4.8% val_auroc_score: 0.9348; val_auprc_score: 0.9118; val_best_acc_score: 0.8753; val_best_f1_score: 0.8795; train_kl_reg_loss: 73811.8535; train_edge_recon_loss: 597751.4110; train_gene_expr_recon_loss: 19652137.8485; train_masked_gp_l1_reg_loss: 122930.9033; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 88167.3771; train_chrom_access_recon_loss: 2064840.2595; train_global_loss: 22599639.5758; train_optim_loss: 22599639.5758; val_kl_reg_loss: 73801.0088; val_edge_recon_loss: 599145.5312; val_gene_expr_recon_loss: 19556824.5000; val_masked_gp_l1_reg_loss: 123459.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87750.8906; val_chrom_access_recon_loss: 2059345.2969; val_global_loss: 22500325.5000; val_optim_loss: 22500325.5000
Epoch 20/400 |█-------------------| 5.0% val_auroc_score: 0.9349; val_auprc_score: 0.9145; val_best_acc_score: 0.8713; val_best_f1_score: 0.8783; train_kl_reg_loss: 73221.4962; train_edge_recon_loss: 599219.2396; train_gene_expr_recon_loss: 19615097.5758; train_masked_gp_l1_reg_loss: 123490.4664; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 87253.0076; train_chrom_access_recon_loss: 2060210.3807; train_global_loss: 22558492.0909; train_optim_loss: 22558492.0909; val_kl_reg_loss: 73796.6465; val_edge_recon_loss: 603808.5234; val_gene_expr_recon_loss: 19479221.5000; val_masked_gp_l1_reg_loss: 123921.2500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87994.4844; val_chrom_access_recon_loss: 2040467.4219; val_global_loss: 22409210.0000; val_optim_loss: 22409210.0000
Epoch 21/400 |█-------------------| 5.2% val_auroc_score: 0.9361; val_auprc_score: 0.9142; val_best_acc_score: 0.8729; val_best_f1_score: 0.8796; train_kl_reg_loss: 72844.8331; train_edge_recon_loss: 597323.5066; train_gene_expr_recon_loss: 19559953.3333; train_masked_gp_l1_reg_loss: 123779.1701; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86789.9773; train_chrom_access_recon_loss: 2055827.5871; train_global_loss: 22496518.4242; train_optim_loss: 22496518.4242; val_kl_reg_loss: 72308.4717; val_edge_recon_loss: 606282.9062; val_gene_expr_recon_loss: 19442879.7500; val_masked_gp_l1_reg_loss: 124415.9375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 87275.3906; val_chrom_access_recon_loss: 2034851.2031; val_global_loss: 22368014.7500; val_optim_loss: 22368014.7500
Epoch 22/400 |█-------------------| 5.5% val_auroc_score: 0.9357; val_auprc_score: 0.9141; val_best_acc_score: 0.8724; val_best_f1_score: 0.8793; train_kl_reg_loss: 72723.3169; train_edge_recon_loss: 595421.0900; train_gene_expr_recon_loss: 19532160.5758; train_masked_gp_l1_reg_loss: 124238.8739; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86330.8733; train_chrom_access_recon_loss: 2050940.4110; train_global_loss: 22461815.1515; train_optim_loss: 22461815.1515; val_kl_reg_loss: 73095.6543; val_edge_recon_loss: 604086.4219; val_gene_expr_recon_loss: 19603224.0000; val_masked_gp_l1_reg_loss: 124363.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86410.6953; val_chrom_access_recon_loss: 2043177.9688; val_global_loss: 22534358.0000; val_optim_loss: 22534358.0000
Epoch 23/400 |█-------------------| 5.8% val_auroc_score: 0.9408; val_auprc_score: 0.9224; val_best_acc_score: 0.8796; val_best_f1_score: 0.8854; train_kl_reg_loss: 72069.6830; train_edge_recon_loss: 595982.0464; train_gene_expr_recon_loss: 19474221.3636; train_masked_gp_l1_reg_loss: 124609.6004; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86121.2369; train_chrom_access_recon_loss: 2046257.0492; train_global_loss: 22399261.1818; train_optim_loss: 22399261.1818; val_kl_reg_loss: 71728.2686; val_edge_recon_loss: 604150.1094; val_gene_expr_recon_loss: 19388214.7500; val_masked_gp_l1_reg_loss: 124704.1484; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85844.8516; val_chrom_access_recon_loss: 2035009.5312; val_global_loss: 22309650.5000; val_optim_loss: 22309650.5000
Epoch 24/400 |█-------------------| 6.0% val_auroc_score: 0.9463; val_auprc_score: 0.9274; val_best_acc_score: 0.8866; val_best_f1_score: 0.8912; train_kl_reg_loss: 72024.3735; train_edge_recon_loss: 594635.4953; train_gene_expr_recon_loss: 19436348.8485; train_masked_gp_l1_reg_loss: 124895.9670; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85873.0838; train_chrom_access_recon_loss: 2040395.0852; train_global_loss: 22354173.0909; train_optim_loss: 22354173.0909; val_kl_reg_loss: 72097.6543; val_edge_recon_loss: 599214.0547; val_gene_expr_recon_loss: 19518408.0000; val_masked_gp_l1_reg_loss: 125330.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86065.1484; val_chrom_access_recon_loss: 2052979.9531; val_global_loss: 22454095.0000; val_optim_loss: 22454095.0000
Epoch 25/400 |█-------------------| 6.2% val_auroc_score: 0.9451; val_auprc_score: 0.9223; val_best_acc_score: 0.8853; val_best_f1_score: 0.8910; train_kl_reg_loss: 71475.8053; train_edge_recon_loss: 595755.5502; train_gene_expr_recon_loss: 19386334.6667; train_masked_gp_l1_reg_loss: 125495.0734; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 86068.8529; train_chrom_access_recon_loss: 2035559.1477; train_global_loss: 22300689.1818; train_optim_loss: 22300689.1818; val_kl_reg_loss: 72705.2266; val_edge_recon_loss: 601603.5000; val_gene_expr_recon_loss: 19514137.5000; val_masked_gp_l1_reg_loss: 125798.8281; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 86163.6641; val_chrom_access_recon_loss: 2032813.0469; val_global_loss: 22433221.2500; val_optim_loss: 22433221.2500
Epoch 26/400 |█-------------------| 6.5% val_auroc_score: 0.9451; val_auprc_score: 0.9258; val_best_acc_score: 0.8896; val_best_f1_score: 0.8936; train_kl_reg_loss: 71305.3191; train_edge_recon_loss: 593108.0587; train_gene_expr_recon_loss: 19380681.1212; train_masked_gp_l1_reg_loss: 125778.6686; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85857.0323; train_chrom_access_recon_loss: 2034635.5436; train_global_loss: 22291365.4242; train_optim_loss: 22291365.4242; val_kl_reg_loss: 72055.1260; val_edge_recon_loss: 596415.1016; val_gene_expr_recon_loss: 19348199.2500; val_masked_gp_l1_reg_loss: 126099.8984; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85968.7109; val_chrom_access_recon_loss: 2025312.8281; val_global_loss: 22254050.5000; val_optim_loss: 22254050.5000
Epoch 27/400 |█-------------------| 6.8% val_auroc_score: 0.9466; val_auprc_score: 0.9297; val_best_acc_score: 0.8818; val_best_f1_score: 0.8860; train_kl_reg_loss: 71006.9189; train_edge_recon_loss: 592605.1866; train_gene_expr_recon_loss: 19330637.1818; train_masked_gp_l1_reg_loss: 126302.1104; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85918.9980; train_chrom_access_recon_loss: 2029560.2008; train_global_loss: 22236030.4242; train_optim_loss: 22236030.4242; val_kl_reg_loss: 71696.1855; val_edge_recon_loss: 604630.1406; val_gene_expr_recon_loss: 19319306.5000; val_masked_gp_l1_reg_loss: 126375.7734; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85933.0938; val_chrom_access_recon_loss: 2021090.2031; val_global_loss: 22229033.0000; val_optim_loss: 22229033.0000
Epoch 28/400 |█-------------------| 7.0% val_auroc_score: 0.9481; val_auprc_score: 0.9250; val_best_acc_score: 0.8923; val_best_f1_score: 0.8970; train_kl_reg_loss: 70616.5076; train_edge_recon_loss: 592761.5597; train_gene_expr_recon_loss: 19309255.8788; train_masked_gp_l1_reg_loss: 126762.9360; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85985.3765; train_chrom_access_recon_loss: 2025236.3920; train_global_loss: 22210618.6364; train_optim_loss: 22210618.6364; val_kl_reg_loss: 69925.2812; val_edge_recon_loss: 596337.6484; val_gene_expr_recon_loss: 19212936.0000; val_masked_gp_l1_reg_loss: 126935.9609; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85713.9297; val_chrom_access_recon_loss: 2025019.1094; val_global_loss: 22116867.5000; val_optim_loss: 22116867.5000
Epoch 29/400 |█-------------------| 7.2% val_auroc_score: 0.9426; val_auprc_score: 0.9197; val_best_acc_score: 0.8874; val_best_f1_score: 0.8930; train_kl_reg_loss: 70366.3571; train_edge_recon_loss: 592130.7443; train_gene_expr_recon_loss: 19285339.5152; train_masked_gp_l1_reg_loss: 127173.5786; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85725.6212; train_chrom_access_recon_loss: 2023322.0511; train_global_loss: 22184058.0303; train_optim_loss: 22184058.0303; val_kl_reg_loss: 70678.7666; val_edge_recon_loss: 596101.0391; val_gene_expr_recon_loss: 19198799.5000; val_masked_gp_l1_reg_loss: 127639.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85993.4922; val_chrom_access_recon_loss: 1998529.4531; val_global_loss: 22077742.5000; val_optim_loss: 22077742.5000
Epoch 30/400 |█-------------------| 7.5% val_auroc_score: 0.9529; val_auprc_score: 0.9402; val_best_acc_score: 0.8963; val_best_f1_score: 0.9004; train_kl_reg_loss: 70000.7156; train_edge_recon_loss: 589140.7841; train_gene_expr_recon_loss: 19256881.3030; train_masked_gp_l1_reg_loss: 127636.2343; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85488.1091; train_chrom_access_recon_loss: 2020712.9129; train_global_loss: 22149860.1515; train_optim_loss: 22149860.1515; val_kl_reg_loss: 70737.6602; val_edge_recon_loss: 594022.3828; val_gene_expr_recon_loss: 19084332.0000; val_masked_gp_l1_reg_loss: 127823.9297; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85521.5703; val_chrom_access_recon_loss: 2000305.1875; val_global_loss: 21962743.5000; val_optim_loss: 21962743.5000
Epoch 31/400 |█-------------------| 7.8% val_auroc_score: 0.9564; val_auprc_score: 0.9405; val_best_acc_score: 0.9025; val_best_f1_score: 0.9058; train_kl_reg_loss: 69907.9399; train_edge_recon_loss: 589349.8750; train_gene_expr_recon_loss: 19223598.8788; train_masked_gp_l1_reg_loss: 128046.3284; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 85096.3787; train_chrom_access_recon_loss: 2016753.6117; train_global_loss: 22112752.8788; train_optim_loss: 22112752.8788; val_kl_reg_loss: 70049.7598; val_edge_recon_loss: 588781.8125; val_gene_expr_recon_loss: 19231720.2500; val_masked_gp_l1_reg_loss: 128599.3828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85721.7969; val_chrom_access_recon_loss: 2042012.4219; val_global_loss: 22146886.5000; val_optim_loss: 22146886.5000
Epoch 32/400 |█-------------------| 8.0% val_auroc_score: 0.9462; val_auprc_score: 0.9180; val_best_acc_score: 0.8955; val_best_f1_score: 0.9008; train_kl_reg_loss: 69316.6064; train_edge_recon_loss: 591996.1847; train_gene_expr_recon_loss: 19161445.7879; train_masked_gp_l1_reg_loss: 128728.1437; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84982.6838; train_chrom_access_recon_loss: 2008459.0076; train_global_loss: 22044928.3636; train_optim_loss: 22044928.3636; val_kl_reg_loss: 69759.1104; val_edge_recon_loss: 593547.5703; val_gene_expr_recon_loss: 19096686.7500; val_masked_gp_l1_reg_loss: 129112.0938; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 85567.6250; val_chrom_access_recon_loss: 2002964.7969; val_global_loss: 21977638.5000; val_optim_loss: 21977638.5000
Epoch 33/400 |█-------------------| 8.2% val_auroc_score: 0.9498; val_auprc_score: 0.9335; val_best_acc_score: 0.8958; val_best_f1_score: 0.9000; train_kl_reg_loss: 68828.3175; train_edge_recon_loss: 590300.3627; train_gene_expr_recon_loss: 19145325.9697; train_masked_gp_l1_reg_loss: 129164.4089; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84889.0614; train_chrom_access_recon_loss: 2009462.2273; train_global_loss: 22027970.4545; train_optim_loss: 22027970.4545; val_kl_reg_loss: 69488.0264; val_edge_recon_loss: 594988.2812; val_gene_expr_recon_loss: 19093344.2500; val_masked_gp_l1_reg_loss: 129711.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84849.2422; val_chrom_access_recon_loss: 1987379.1875; val_global_loss: 21959761.2500; val_optim_loss: 21959761.2500
Epoch 34/400 |█-------------------| 8.5% val_auroc_score: 0.9513; val_auprc_score: 0.9289; val_best_acc_score: 0.8971; val_best_f1_score: 0.9020; train_kl_reg_loss: 68762.3145; train_edge_recon_loss: 587907.1449; train_gene_expr_recon_loss: 19122088.9394; train_masked_gp_l1_reg_loss: 129786.0421; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84622.9245; train_chrom_access_recon_loss: 2007050.6989; train_global_loss: 22000218.0303; train_optim_loss: 22000218.0303; val_kl_reg_loss: 69844.7979; val_edge_recon_loss: 593426.4375; val_gene_expr_recon_loss: 18996043.7500; val_masked_gp_l1_reg_loss: 130069.0625; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84899.2422; val_chrom_access_recon_loss: 1997125.5156; val_global_loss: 21871410.0000; val_optim_loss: 21871410.0000
Epoch 35/400 |█-------------------| 8.8% val_auroc_score: 0.9484; val_auprc_score: 0.9264; val_best_acc_score: 0.9011; val_best_f1_score: 0.9050; train_kl_reg_loss: 68420.0344; train_edge_recon_loss: 589193.3561; train_gene_expr_recon_loss: 19100145.1212; train_masked_gp_l1_reg_loss: 130390.0835; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84169.1909; train_chrom_access_recon_loss: 2006221.8239; train_global_loss: 21978539.6667; train_optim_loss: 21978539.6667; val_kl_reg_loss: 68671.6680; val_edge_recon_loss: 595325.3438; val_gene_expr_recon_loss: 19113649.5000; val_masked_gp_l1_reg_loss: 130570.0391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84437.0859; val_chrom_access_recon_loss: 2000367.1562; val_global_loss: 21993021.5000; val_optim_loss: 21993021.5000
Epoch 36/400 |█-------------------| 9.0% val_auroc_score: 0.9544; val_auprc_score: 0.9357; val_best_acc_score: 0.9025; val_best_f1_score: 0.9059; train_kl_reg_loss: 68310.7773; train_edge_recon_loss: 588409.3892; train_gene_expr_recon_loss: 19073081.5758; train_masked_gp_l1_reg_loss: 130884.9749; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 84069.4149; train_chrom_access_recon_loss: 2002397.4489; train_global_loss: 21947153.6970; train_optim_loss: 21947153.6970; val_kl_reg_loss: 69159.0762; val_edge_recon_loss: 589344.8281; val_gene_expr_recon_loss: 19047230.7500; val_masked_gp_l1_reg_loss: 131199.0000; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83995.7031; val_chrom_access_recon_loss: 1996031.2656; val_global_loss: 21916960.7500; val_optim_loss: 21916960.7500
Epoch 37/400 |█-------------------| 9.2% val_auroc_score: 0.9485; val_auprc_score: 0.9240; val_best_acc_score: 0.8984; val_best_f1_score: 0.9026; train_kl_reg_loss: 68041.0992; train_edge_recon_loss: 587367.0739; train_gene_expr_recon_loss: 19024977.1818; train_masked_gp_l1_reg_loss: 131428.9290; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83654.7493; train_chrom_access_recon_loss: 1997873.3447; train_global_loss: 21893342.5455; train_optim_loss: 21893342.5455; val_kl_reg_loss: 68775.2354; val_edge_recon_loss: 595754.9688; val_gene_expr_recon_loss: 18968022.2500; val_masked_gp_l1_reg_loss: 132043.4375; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 84244.1562; val_chrom_access_recon_loss: 1989160.5000; val_global_loss: 21838001.0000; val_optim_loss: 21838001.0000
Epoch 38/400 |█-------------------| 9.5% val_auroc_score: 0.9482; val_auprc_score: 0.9273; val_best_acc_score: 0.8952; val_best_f1_score: 0.8993; train_kl_reg_loss: 67759.2814; train_edge_recon_loss: 587997.6648; train_gene_expr_recon_loss: 19001984.9091; train_masked_gp_l1_reg_loss: 132245.0807; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83482.9044; train_chrom_access_recon_loss: 1995309.4261; train_global_loss: 21868779.3333; train_optim_loss: 21868779.3333; val_kl_reg_loss: 68347.3379; val_edge_recon_loss: 594315.7656; val_gene_expr_recon_loss: 19101315.7500; val_masked_gp_l1_reg_loss: 132660.4219; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83754.7969; val_chrom_access_recon_loss: 1994311.1875; val_global_loss: 21974704.0000; val_optim_loss: 21974704.0000
Epoch 39/400 |█-------------------| 9.8% val_auroc_score: 0.9450; val_auprc_score: 0.9201; val_best_acc_score: 0.8979; val_best_f1_score: 0.9019; train_kl_reg_loss: 67395.8555; train_edge_recon_loss: 586803.6449; train_gene_expr_recon_loss: 18976105.9091; train_masked_gp_l1_reg_loss: 133003.9600; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83155.5473; train_chrom_access_recon_loss: 1996152.3580; train_global_loss: 21842617.1818; train_optim_loss: 21842617.1818; val_kl_reg_loss: 69696.5127; val_edge_recon_loss: 596642.2812; val_gene_expr_recon_loss: 18946110.5000; val_masked_gp_l1_reg_loss: 133329.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83413.9219; val_chrom_access_recon_loss: 1972445.2656; val_global_loss: 21801638.5000; val_optim_loss: 21801638.5000
Epoch 40/400 |██------------------| 10.0% val_auroc_score: 0.9455; val_auprc_score: 0.9212; val_best_acc_score: 0.8966; val_best_f1_score: 0.9013; train_kl_reg_loss: 67080.1904; train_edge_recon_loss: 587514.4441; train_gene_expr_recon_loss: 18936503.6061; train_masked_gp_l1_reg_loss: 133655.7460; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83117.8797; train_chrom_access_recon_loss: 1991285.1856; train_global_loss: 21799156.9394; train_optim_loss: 21799156.9394; val_kl_reg_loss: 67416.9766; val_edge_recon_loss: 593002.9844; val_gene_expr_recon_loss: 18813449.2500; val_masked_gp_l1_reg_loss: 134001.1562; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 83349.6797; val_chrom_access_recon_loss: 2002514.7656; val_global_loss: 21693736.0000; val_optim_loss: 21693736.0000
Epoch 41/400 |██------------------| 10.2% val_auroc_score: 0.9562; val_auprc_score: 0.9415; val_best_acc_score: 0.9025; val_best_f1_score: 0.9068; train_kl_reg_loss: 66754.6363; train_edge_recon_loss: 587200.5682; train_gene_expr_recon_loss: 18917806.1818; train_masked_gp_l1_reg_loss: 134395.3390; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 83150.9562; train_chrom_access_recon_loss: 1990153.1780; train_global_loss: 21779460.9697; train_optim_loss: 21779460.9697; val_kl_reg_loss: 67919.5859; val_edge_recon_loss: 588320.1719; val_gene_expr_recon_loss: 18815738.7500; val_masked_gp_l1_reg_loss: 134873.0781; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82648.8906; val_chrom_access_recon_loss: 1973039.3281; val_global_loss: 21662540.0000; val_optim_loss: 21662540.0000
Epoch 42/400 |██------------------| 10.5% val_auroc_score: 0.9592; val_auprc_score: 0.9469; val_best_acc_score: 0.9030; val_best_f1_score: 0.9059; train_kl_reg_loss: 66481.9871; train_edge_recon_loss: 587653.2339; train_gene_expr_recon_loss: 18896949.8182; train_masked_gp_l1_reg_loss: 135199.9898; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82840.1107; train_chrom_access_recon_loss: 1989912.3258; train_global_loss: 21759037.2727; train_optim_loss: 21759037.2727; val_kl_reg_loss: 66975.6396; val_edge_recon_loss: 589610.5938; val_gene_expr_recon_loss: 18967103.5000; val_masked_gp_l1_reg_loss: 135454.5312; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82622.0703; val_chrom_access_recon_loss: 1989331.3438; val_global_loss: 21831097.5000; val_optim_loss: 21831097.5000
Epoch 43/400 |██------------------| 10.8% val_auroc_score: 0.9541; val_auprc_score: 0.9354; val_best_acc_score: 0.9027; val_best_f1_score: 0.9068; train_kl_reg_loss: 66301.8770; train_edge_recon_loss: 586850.5256; train_gene_expr_recon_loss: 18849695.5152; train_masked_gp_l1_reg_loss: 135850.3466; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82337.4523; train_chrom_access_recon_loss: 1983156.4470; train_global_loss: 21704192.3030; train_optim_loss: 21704192.3030; val_kl_reg_loss: 66986.7979; val_edge_recon_loss: 587898.2891; val_gene_expr_recon_loss: 18938185.7500; val_masked_gp_l1_reg_loss: 136374.1094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82646.4531; val_chrom_access_recon_loss: 1983765.6562; val_global_loss: 21795856.5000; val_optim_loss: 21795856.5000
Epoch 44/400 |██------------------| 11.0% val_auroc_score: 0.9557; val_auprc_score: 0.9407; val_best_acc_score: 0.9022; val_best_f1_score: 0.9068; train_kl_reg_loss: 66134.0517; train_edge_recon_loss: 585481.7509; train_gene_expr_recon_loss: 18833539.5758; train_masked_gp_l1_reg_loss: 136631.9003; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82497.0181; train_chrom_access_recon_loss: 1983938.0303; train_global_loss: 21688221.9394; train_optim_loss: 21688221.9394; val_kl_reg_loss: 67891.2646; val_edge_recon_loss: 589613.5391; val_gene_expr_recon_loss: 18984323.5000; val_masked_gp_l1_reg_loss: 137055.9062; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82940.3203; val_chrom_access_recon_loss: 1986157.2031; val_global_loss: 21847981.5000; val_optim_loss: 21847981.5000
Epoch 45/400 |██------------------| 11.2% val_auroc_score: 0.9512; val_auprc_score: 0.9331; val_best_acc_score: 0.8947; val_best_f1_score: 0.9004; train_kl_reg_loss: 66002.9344; train_edge_recon_loss: 585742.3968; train_gene_expr_recon_loss: 18805807.9394; train_masked_gp_l1_reg_loss: 137458.8681; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 82629.0052; train_chrom_access_recon_loss: 1983405.7121; train_global_loss: 21661046.8485; train_optim_loss: 21661046.8485; val_kl_reg_loss: 66977.9365; val_edge_recon_loss: 592774.0156; val_gene_expr_recon_loss: 18892513.7500; val_masked_gp_l1_reg_loss: 137765.1875; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 82428.0469; val_chrom_access_recon_loss: 1974819.4844; val_global_loss: 21747279.2500; val_optim_loss: 21747279.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 0.0001.

Epoch 46/400 |██------------------| 11.5% val_auroc_score: 0.9495; val_auprc_score: 0.9268; val_best_acc_score: 0.8995; val_best_f1_score: 0.9043; train_kl_reg_loss: 66233.5653; train_edge_recon_loss: 586469.7869; train_gene_expr_recon_loss: 18759326.1515; train_masked_gp_l1_reg_loss: 132889.3823; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 63503.0509; train_chrom_access_recon_loss: 1977411.8939; train_global_loss: 21585833.6364; train_optim_loss: 21585833.6364; val_kl_reg_loss: 68173.6768; val_edge_recon_loss: 591625.7109; val_gene_expr_recon_loss: 19034149.5000; val_masked_gp_l1_reg_loss: 131110.6094; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 58426.9531; val_chrom_access_recon_loss: 1987384.2969; val_global_loss: 21870869.5000; val_optim_loss: 21870869.5000
Epoch 47/400 |██------------------| 11.8% val_auroc_score: 0.9543; val_auprc_score: 0.9371; val_best_acc_score: 0.8974; val_best_f1_score: 0.9025; train_kl_reg_loss: 66818.0887; train_edge_recon_loss: 585839.3002; train_gene_expr_recon_loss: 18750463.4848; train_masked_gp_l1_reg_loss: 130864.2264; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57825.6257; train_chrom_access_recon_loss: 1976525.7822; train_global_loss: 21568336.4848; train_optim_loss: 21568336.4848; val_kl_reg_loss: 67906.1094; val_edge_recon_loss: 588757.8516; val_gene_expr_recon_loss: 18836969.2500; val_masked_gp_l1_reg_loss: 130700.6953; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 57347.4531; val_chrom_access_recon_loss: 1978937.0938; val_global_loss: 21660619.0000; val_optim_loss: 21660619.0000
Epoch 48/400 |██------------------| 12.0% val_auroc_score: 0.9529; val_auprc_score: 0.9361; val_best_acc_score: 0.8982; val_best_f1_score: 0.9020; train_kl_reg_loss: 67037.9347; train_edge_recon_loss: 585629.9100; train_gene_expr_recon_loss: 18729743.3636; train_masked_gp_l1_reg_loss: 130661.5998; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 57051.5629; train_chrom_access_recon_loss: 1975079.8580; train_global_loss: 21545204.1818; train_optim_loss: 21545204.1818; val_kl_reg_loss: 68242.2725; val_edge_recon_loss: 588861.6562; val_gene_expr_recon_loss: 18782068.0000; val_masked_gp_l1_reg_loss: 130642.8828; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56861.5469; val_chrom_access_recon_loss: 1975068.4219; val_global_loss: 21601744.2500; val_optim_loss: 21601744.2500
Epoch 49/400 |██------------------| 12.2% val_auroc_score: 0.9473; val_auprc_score: 0.9221; val_best_acc_score: 0.8952; val_best_f1_score: 0.9008; train_kl_reg_loss: 67339.9812; train_edge_recon_loss: 585431.6316; train_gene_expr_recon_loss: 18734723.3333; train_masked_gp_l1_reg_loss: 130640.3409; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56638.1434; train_chrom_access_recon_loss: 1974393.3201; train_global_loss: 21549166.6667; train_optim_loss: 21549166.6667; val_kl_reg_loss: 68609.0488; val_edge_recon_loss: 590460.9609; val_gene_expr_recon_loss: 18651752.2500; val_masked_gp_l1_reg_loss: 130686.9844; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56515.3438; val_chrom_access_recon_loss: 1960814.0469; val_global_loss: 21458838.5000; val_optim_loss: 21458838.5000
Epoch 50/400 |██------------------| 12.5% val_auroc_score: 0.9546; val_auprc_score: 0.9393; val_best_acc_score: 0.9009; val_best_f1_score: 0.9056; train_kl_reg_loss: 67498.2791; train_edge_recon_loss: 585080.2926; train_gene_expr_recon_loss: 18731311.1818; train_masked_gp_l1_reg_loss: 130685.3638; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56342.0553; train_chrom_access_recon_loss: 1972980.9280; train_global_loss: 21543898.3030; train_optim_loss: 21543898.3030; val_kl_reg_loss: 68637.0059; val_edge_recon_loss: 589451.2344; val_gene_expr_recon_loss: 18887342.5000; val_masked_gp_l1_reg_loss: 130727.7500; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 56179.7500; val_chrom_access_recon_loss: 1965023.5469; val_global_loss: 21697362.2500; val_optim_loss: 21697362.2500
Epoch 51/400 |██------------------| 12.8% val_auroc_score: 0.9554; val_auprc_score: 0.9387; val_best_acc_score: 0.9003; val_best_f1_score: 0.9023; train_kl_reg_loss: 67630.6673; train_edge_recon_loss: 585093.5540; train_gene_expr_recon_loss: 18728834.2121; train_masked_gp_l1_reg_loss: 130720.2212; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 56012.8922; train_chrom_access_recon_loss: 1975456.5133; train_global_loss: 21543748.1212; train_optim_loss: 21543748.1212; val_kl_reg_loss: 69134.7100; val_edge_recon_loss: 591116.7109; val_gene_expr_recon_loss: 18770952.7500; val_masked_gp_l1_reg_loss: 130753.6328; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55951.9336; val_chrom_access_recon_loss: 1985244.5625; val_global_loss: 21603154.7500; val_optim_loss: 21603154.7500
Epoch 52/400 |██------------------| 13.0% val_auroc_score: 0.9479; val_auprc_score: 0.9268; val_best_acc_score: 0.8904; val_best_f1_score: 0.8963; train_kl_reg_loss: 67671.3964; train_edge_recon_loss: 585440.1742; train_gene_expr_recon_loss: 18731544.5152; train_masked_gp_l1_reg_loss: 130756.3549; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55839.5388; train_chrom_access_recon_loss: 1976430.2348; train_global_loss: 21547681.9697; train_optim_loss: 21547681.9697; val_kl_reg_loss: 69076.3594; val_edge_recon_loss: 594450.0938; val_gene_expr_recon_loss: 18787133.5000; val_masked_gp_l1_reg_loss: 130772.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55705.5781; val_chrom_access_recon_loss: 1958103.7656; val_global_loss: 21595242.0000; val_optim_loss: 21595242.0000
Epoch 53/400 |██------------------| 13.2% val_auroc_score: 0.9492; val_auprc_score: 0.9299; val_best_acc_score: 0.8955; val_best_f1_score: 0.9021; train_kl_reg_loss: 67869.0368; train_edge_recon_loss: 583998.5653; train_gene_expr_recon_loss: 18720071.7273; train_masked_gp_l1_reg_loss: 130821.8648; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 55604.9292; train_chrom_access_recon_loss: 1973875.6856; train_global_loss: 21532241.4848; train_optim_loss: 21532241.4848; val_kl_reg_loss: 69256.5166; val_edge_recon_loss: 593793.8750; val_gene_expr_recon_loss: 18859481.2500; val_masked_gp_l1_reg_loss: 130866.7578; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 55488.6094; val_chrom_access_recon_loss: 1978741.6094; val_global_loss: 21687627.2500; val_optim_loss: 21687627.2500

Reducing learning rate: metric has not improved more than 0.0 in the last 4 epochs.
New learning rate is 1e-05.

Epoch 54/400 |██------------------| 13.5% val_auroc_score: 0.9564; val_auprc_score: 0.9437; val_best_acc_score: 0.8976; val_best_f1_score: 0.9022; train_kl_reg_loss: 67990.0967; train_edge_recon_loss: 584668.3523; train_gene_expr_recon_loss: 18721693.7576; train_masked_gp_l1_reg_loss: 130357.3755; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53675.5492; train_chrom_access_recon_loss: 1974672.2443; train_global_loss: 21533057.1818; train_optim_loss: 21533057.1818; val_kl_reg_loss: 69248.9414; val_edge_recon_loss: 591067.5078; val_gene_expr_recon_loss: 18848671.0000; val_masked_gp_l1_reg_loss: 130115.5391; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53215.7461; val_chrom_access_recon_loss: 1974474.0625; val_global_loss: 21666794.0000; val_optim_loss: 21666794.0000
Epoch 55/400 |██------------------| 13.8% val_auroc_score: 0.9524; val_auprc_score: 0.9371; val_best_acc_score: 0.9022; val_best_f1_score: 0.9066; train_kl_reg_loss: 67861.4905; train_edge_recon_loss: 584302.0426; train_gene_expr_recon_loss: 18724610.1212; train_masked_gp_l1_reg_loss: 130061.0919; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53139.2914; train_chrom_access_recon_loss: 1973354.9337; train_global_loss: 21533328.9091; train_optim_loss: 21533328.9091; val_kl_reg_loss: 69631.7080; val_edge_recon_loss: 583858.9141; val_gene_expr_recon_loss: 19075276.7500; val_masked_gp_l1_reg_loss: 130024.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53076.5117; val_chrom_access_recon_loss: 1988110.5781; val_global_loss: 21899977.7500; val_optim_loss: 21899977.7500
Epoch 56/400 |██------------------| 14.0% val_auroc_score: 0.9519; val_auprc_score: 0.9372; val_best_acc_score: 0.8960; val_best_f1_score: 0.9019; train_kl_reg_loss: 67932.9049; train_edge_recon_loss: 584740.7633; train_gene_expr_recon_loss: 18719905.4848; train_masked_gp_l1_reg_loss: 130007.7167; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 53032.4997; train_chrom_access_recon_loss: 1974286.7652; train_global_loss: 21529905.9697; train_optim_loss: 21529905.9697; val_kl_reg_loss: 69123.1182; val_edge_recon_loss: 589734.5156; val_gene_expr_recon_loss: 18834525.2500; val_masked_gp_l1_reg_loss: 129991.0156; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 53000.0352; val_chrom_access_recon_loss: 1964838.1875; val_global_loss: 21641213.2500; val_optim_loss: 21641213.2500
Epoch 57/400 |██------------------| 14.2% val_auroc_score: 0.9535; val_auprc_score: 0.9335; val_best_acc_score: 0.9046; val_best_f1_score: 0.9087; train_kl_reg_loss: 67888.5038; train_edge_recon_loss: 584502.9991; train_gene_expr_recon_loss: 18715855.3333; train_masked_gp_l1_reg_loss: 129985.7647; train_group_lasso_reg_loss: 0.0000; train_addon_gp_l1_reg_loss: 52969.5032; train_chrom_access_recon_loss: 1973208.5587; train_global_loss: 21524410.6061; train_optim_loss: 21524410.6061; val_kl_reg_loss: 69637.3164; val_edge_recon_loss: 583977.8906; val_gene_expr_recon_loss: 18955107.2500; val_masked_gp_l1_reg_loss: 129978.7266; val_group_lasso_reg_loss: 0.0000; val_addon_gp_l1_reg_loss: 52941.7188; val_chrom_access_recon_loss: 2003640.2969; val_global_loss: 21795282.7500; val_optim_loss: 21795282.7500

Stopping early: metric has not improved more than 0.0 in the last 8 epochs.
If the early stopping criterion is too strong, please instantiate it with different parameters in the train method.
Model training finished after 20 min 7 sec.
Using best model state, which was in epoch 49.

--- MODEL EVALUATION ---
val AUROC score: 0.9540
val AUPRC score: 0.9397
val best accuracy score: 0.9003
val best F1 score: 0.9051
val target rna MSE score: 1.1304
val source rna MSE score: 0.5407
val target atac MSE score: 0.3189
val source atac MSE score: 0.1289
Val cat covariate0 mean sim diff: nan

Computing neighbor graph...

Computing UMAP embedding...

Saving model...
