[12, 16, 16, 20, 20]
Run timestamp: 12032023_120456.
Script arguments:
['train_autotalker_benchmark_models.py', '--dataset', 'vizgen_merfish_mouse_liver', '--adata_new_name', 'vizgen_merfish_mouse_liver_autotalker', '--n_neighbors_list', '12', '16', '16', '20', '20', '--edge_batch_size_list', '256', '128', '128', '128', '128', '--node_batch_size_list', '32', '16', '16', '16', '16', '--seeds', '5', '6', '7', '8', '9', '--run_index', '5', '6', '7', '8', '9', '10']

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1725.
Number of gene programs after filtering and combining: 1575.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder', 'graph_decoder']
GRAPH ENCODER -> n_input: 347, n_cond_embed_input: 0, n_layers: 1, n_hidden: 522, n_latent: 522, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 20, n_output: 522, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 522, n_cond_embed_input: 20, n_addon_input: 0, n_output: 694

--- INITIALIZING TRAINER ---
Number of training nodes: 330601
Number of validation nodes: 36734
Number of training edges: 2175435
Number of validation edges: 241714

--- MODEL TRAINING ---
Epoch 1/40 |--------------------| 2.5% val_auroc_score: 0.9765; val_auprc_score: 0.9734; val_best_acc_score: 0.9225; val_best_f1_score: 0.9243; train_kl_reg_loss: 0.1487; train_edge_recon_loss: 542.3155; train_gene_expr_recon_loss: 426.2823; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 968.7465; train_optim_loss: 968.7465; val_kl_reg_loss: 0.0937; val_edge_recon_loss: 537.5409; val_gene_expr_recon_loss: 417.2011; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 954.8356; val_optim_loss: 954.8356
Epoch 2/40 |█-------------------| 5.0% val_auroc_score: 0.9803; val_auprc_score: 0.9780; val_best_acc_score: 0.9293; val_best_f1_score: 0.9304; train_kl_reg_loss: 0.0959; train_edge_recon_loss: 529.3514; train_gene_expr_recon_loss: 415.4622; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 944.9095; train_optim_loss: 944.9095; val_kl_reg_loss: 0.0928; val_edge_recon_loss: 534.4350; val_gene_expr_recon_loss: 415.9121; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 950.4399; val_optim_loss: 950.4399
Epoch 3/40 |█-------------------| 7.5% val_auroc_score: 0.9817; val_auprc_score: 0.9795; val_best_acc_score: 0.9323; val_best_f1_score: 0.9335; train_kl_reg_loss: 0.0959; train_edge_recon_loss: 528.9135; train_gene_expr_recon_loss: 414.3096; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 943.3191; train_optim_loss: 943.3191; val_kl_reg_loss: 0.0941; val_edge_recon_loss: 535.2011; val_gene_expr_recon_loss: 414.9813; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 950.2765; val_optim_loss: 950.2765
Epoch 4/40 |██------------------| 10.0% val_auroc_score: 0.9833; val_auprc_score: 0.9815; val_best_acc_score: 0.9354; val_best_f1_score: 0.9366; train_kl_reg_loss: 0.0970; train_edge_recon_loss: 528.6986; train_gene_expr_recon_loss: 413.3184; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 942.1141; train_optim_loss: 942.1141; val_kl_reg_loss: 0.0933; val_edge_recon_loss: 535.7413; val_gene_expr_recon_loss: 413.9015; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 949.7361; val_optim_loss: 949.7361
Epoch 5/40 |██------------------| 12.5% val_auroc_score: 0.9823; val_auprc_score: 0.9804; val_best_acc_score: 0.9333; val_best_f1_score: 0.9344; train_kl_reg_loss: 0.0984; train_edge_recon_loss: 528.3843; train_gene_expr_recon_loss: 412.8746; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 941.3573; train_optim_loss: 941.3573; val_kl_reg_loss: 0.0932; val_edge_recon_loss: 535.3396; val_gene_expr_recon_loss: 413.4888; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 948.9216; val_optim_loss: 948.9216
Epoch 6/40 |███-----------------| 15.0% val_auroc_score: 0.9826; val_auprc_score: 0.9806; val_best_acc_score: 0.9347; val_best_f1_score: 0.9357; train_kl_reg_loss: 0.1002; train_edge_recon_loss: 528.0794; train_gene_expr_recon_loss: 412.5738; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 940.7534; train_optim_loss: 940.7534; val_kl_reg_loss: 0.0934; val_edge_recon_loss: 535.0361; val_gene_expr_recon_loss: 413.0926; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 948.2221; val_optim_loss: 948.2221
Epoch 7/40 |███-----------------| 17.5% val_auroc_score: 0.9828; val_auprc_score: 0.9810; val_best_acc_score: 0.9344; val_best_f1_score: 0.9355; train_kl_reg_loss: 0.1022; train_edge_recon_loss: 528.0809; train_gene_expr_recon_loss: 412.3933; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 940.5763; train_optim_loss: 940.5763; val_kl_reg_loss: 0.0945; val_edge_recon_loss: 535.1059; val_gene_expr_recon_loss: 413.4233; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 948.6237; val_optim_loss: 948.6237
Epoch 8/40 |████----------------| 20.0% val_auroc_score: 0.9837; val_auprc_score: 0.9819; val_best_acc_score: 0.9362; val_best_f1_score: 0.9373; train_kl_reg_loss: 0.1040; train_edge_recon_loss: 527.9114; train_gene_expr_recon_loss: 412.2917; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 940.3071; train_optim_loss: 940.3071; val_kl_reg_loss: 0.0955; val_edge_recon_loss: 535.0861; val_gene_expr_recon_loss: 413.5422; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 948.7237; val_optim_loss: 948.7237
Epoch 9/40 |████----------------| 22.5% val_auroc_score: 0.9837; val_auprc_score: 0.9819; val_best_acc_score: 0.9361; val_best_f1_score: 0.9371; train_kl_reg_loss: 0.1061; train_edge_recon_loss: 527.8586; train_gene_expr_recon_loss: 412.1215; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 940.0862; train_optim_loss: 940.0862; val_kl_reg_loss: 0.0959; val_edge_recon_loss: 534.8928; val_gene_expr_recon_loss: 413.0879; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 948.0766; val_optim_loss: 948.0766
Epoch 10/40 |█████---------------| 25.0% val_auroc_score: 0.9839; val_auprc_score: 0.9820; val_best_acc_score: 0.9370; val_best_f1_score: 0.9380; train_kl_reg_loss: 0.1083; train_edge_recon_loss: 527.7216; train_gene_expr_recon_loss: 411.8452; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 939.6751; train_optim_loss: 939.6751; val_kl_reg_loss: 0.0970; val_edge_recon_loss: 535.2557; val_gene_expr_recon_loss: 413.5216; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 948.8743; val_optim_loss: 948.8743
Epoch 11/40 |█████---------------| 27.5% val_auroc_score: 0.9837; val_auprc_score: 0.9818; val_best_acc_score: 0.9366; val_best_f1_score: 0.9377; train_kl_reg_loss: 0.1105; train_edge_recon_loss: 527.6963; train_gene_expr_recon_loss: 411.6923; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 939.4991; train_optim_loss: 939.4991; val_kl_reg_loss: 0.0987; val_edge_recon_loss: 534.5621; val_gene_expr_recon_loss: 412.6812; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 947.3421; val_optim_loss: 947.3421
Epoch 12/40 |██████--------------| 30.0% val_auroc_score: 0.9838; val_auprc_score: 0.9820; val_best_acc_score: 0.9364; val_best_f1_score: 0.9374; train_kl_reg_loss: 0.1125; train_edge_recon_loss: 527.6873; train_gene_expr_recon_loss: 411.6620; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 939.4618; train_optim_loss: 939.4618; val_kl_reg_loss: 0.1000; val_edge_recon_loss: 534.6034; val_gene_expr_recon_loss: 412.9550; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 947.6583; val_optim_loss: 947.6583
Epoch 13/40 |██████--------------| 32.5% val_auroc_score: 0.9846; val_auprc_score: 0.9830; val_best_acc_score: 0.9387; val_best_f1_score: 0.9397; train_kl_reg_loss: 0.1146; train_edge_recon_loss: 527.4171; train_gene_expr_recon_loss: 411.6602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 939.1919; train_optim_loss: 939.1919; val_kl_reg_loss: 0.1007; val_edge_recon_loss: 534.9248; val_gene_expr_recon_loss: 412.8715; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 947.8969; val_optim_loss: 947.8969
Epoch 14/40 |███████-------------| 35.0% val_auroc_score: 0.9833; val_auprc_score: 0.9815; val_best_acc_score: 0.9355; val_best_f1_score: 0.9365; train_kl_reg_loss: 0.1166; train_edge_recon_loss: 527.3850; train_gene_expr_recon_loss: 411.5551; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 939.0567; train_optim_loss: 939.0567; val_kl_reg_loss: 0.1019; val_edge_recon_loss: 534.5558; val_gene_expr_recon_loss: 412.7723; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 947.4301; val_optim_loss: 947.4301

Reducing learning rate: metric has not improved more than 0.0 in the last 3 epochs.
New learning rate is 0.0001.

Epoch 15/40 |███████-------------| 37.5% val_auroc_score: 0.9848; val_auprc_score: 0.9831; val_best_acc_score: 0.9387; val_best_f1_score: 0.9397; train_kl_reg_loss: 0.1093; train_edge_recon_loss: 526.7413; train_gene_expr_recon_loss: 410.3759; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.2265; train_optim_loss: 937.2265; val_kl_reg_loss: 0.0905; val_edge_recon_loss: 533.8204; val_gene_expr_recon_loss: 411.8881; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 945.7990; val_optim_loss: 945.7990
Epoch 16/40 |████████------------| 40.0% val_auroc_score: 0.9846; val_auprc_score: 0.9829; val_best_acc_score: 0.9382; val_best_f1_score: 0.9394; train_kl_reg_loss: 0.1079; train_edge_recon_loss: 526.8305; train_gene_expr_recon_loss: 410.2881; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.2265; train_optim_loss: 937.2265; val_kl_reg_loss: 0.0907; val_edge_recon_loss: 533.8297; val_gene_expr_recon_loss: 411.5802; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 945.5006; val_optim_loss: 945.5006
Epoch 17/40 |████████------------| 42.5% val_auroc_score: 0.9844; val_auprc_score: 0.9826; val_best_acc_score: 0.9382; val_best_f1_score: 0.9394; train_kl_reg_loss: 0.1077; train_edge_recon_loss: 526.7312; train_gene_expr_recon_loss: 410.0165; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 936.8555; train_optim_loss: 936.8555; val_kl_reg_loss: 0.0901; val_edge_recon_loss: 533.9597; val_gene_expr_recon_loss: 411.9543; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 946.0042; val_optim_loss: 946.0042
Epoch 18/40 |█████████-----------| 45.0% val_auroc_score: 0.9842; val_auprc_score: 0.9823; val_best_acc_score: 0.9383; val_best_f1_score: 0.9395; train_kl_reg_loss: 0.1077; train_edge_recon_loss: 526.7302; train_gene_expr_recon_loss: 410.1191; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 936.9570; train_optim_loss: 936.9570; val_kl_reg_loss: 0.0900; val_edge_recon_loss: 533.9589; val_gene_expr_recon_loss: 411.9979; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 946.0468; val_optim_loss: 946.0468
Epoch 19/40 |█████████-----------| 47.5% val_auroc_score: 0.9845; val_auprc_score: 0.9827; val_best_acc_score: 0.9384; val_best_f1_score: 0.9396; train_kl_reg_loss: 0.1076; train_edge_recon_loss: 526.7926; train_gene_expr_recon_loss: 410.1043; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.0045; train_optim_loss: 937.0045; val_kl_reg_loss: 0.0898; val_edge_recon_loss: 533.6840; val_gene_expr_recon_loss: 411.7238; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 945.4976; val_optim_loss: 945.4976
Epoch 20/40 |██████████----------| 50.0% val_auroc_score: 0.9845; val_auprc_score: 0.9828; val_best_acc_score: 0.9385; val_best_f1_score: 0.9395; train_kl_reg_loss: 0.1076; train_edge_recon_loss: 526.8405; train_gene_expr_recon_loss: 410.2136; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.1617; train_optim_loss: 937.1617; val_kl_reg_loss: 0.0890; val_edge_recon_loss: 534.1308; val_gene_expr_recon_loss: 412.3292; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 946.5490; val_optim_loss: 946.5490
Epoch 21/40 |██████████----------| 52.5% val_auroc_score: 0.9847; val_auprc_score: 0.9830; val_best_acc_score: 0.9388; val_best_f1_score: 0.9398; train_kl_reg_loss: 0.0986; train_edge_recon_loss: 527.4782; train_gene_expr_recon_loss: 410.1697; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.7465; train_optim_loss: 937.7465; val_kl_reg_loss: 0.0766; val_edge_recon_loss: 533.3242; val_gene_expr_recon_loss: 411.0222; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 944.4229; val_optim_loss: 944.4229
Epoch 22/40 |███████████---------| 55.0% val_auroc_score: 0.9850; val_auprc_score: 0.9834; val_best_acc_score: 0.9391; val_best_f1_score: 0.9400; train_kl_reg_loss: 0.0914; train_edge_recon_loss: 527.4888; train_gene_expr_recon_loss: 410.1180; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.6983; train_optim_loss: 937.6983; val_kl_reg_loss: 0.0755; val_edge_recon_loss: 532.9883; val_gene_expr_recon_loss: 411.3408; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 944.4047; val_optim_loss: 944.4047
Epoch 23/40 |███████████---------| 57.5% val_auroc_score: 0.9849; val_auprc_score: 0.9831; val_best_acc_score: 0.9391; val_best_f1_score: 0.9401; train_kl_reg_loss: 0.0809; train_edge_recon_loss: 527.3786; train_gene_expr_recon_loss: 410.0046; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.4641; train_optim_loss: 937.4641; val_kl_reg_loss: 0.0753; val_edge_recon_loss: 532.9938; val_gene_expr_recon_loss: 411.5800; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 944.6491; val_optim_loss: 944.6491
Epoch 24/40 |████████████--------| 60.0% val_auroc_score: 0.9851; val_auprc_score: 0.9834; val_best_acc_score: 0.9397; val_best_f1_score: 0.9406; train_kl_reg_loss: 0.0761; train_edge_recon_loss: 527.3657; train_gene_expr_recon_loss: 410.1750; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.6169; train_optim_loss: 937.6169; val_kl_reg_loss: 0.0746; val_edge_recon_loss: 533.1578; val_gene_expr_recon_loss: 411.4889; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 944.7212; val_optim_loss: 944.7212
Epoch 25/40 |████████████--------| 62.5% val_auroc_score: 0.9852; val_auprc_score: 0.9835; val_best_acc_score: 0.9401; val_best_f1_score: 0.9410; train_kl_reg_loss: 0.0752; train_edge_recon_loss: 527.5203; train_gene_expr_recon_loss: 410.0602; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.6557; train_optim_loss: 937.6557; val_kl_reg_loss: 0.0750; val_edge_recon_loss: 532.7538; val_gene_expr_recon_loss: 410.9959; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 943.8248; val_optim_loss: 943.8248
Epoch 26/40 |█████████████-------| 65.0% val_auroc_score: 0.9852; val_auprc_score: 0.9835; val_best_acc_score: 0.9402; val_best_f1_score: 0.9411; train_kl_reg_loss: 0.0751; train_edge_recon_loss: 527.4549; train_gene_expr_recon_loss: 410.2140; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.7440; train_optim_loss: 937.7440; val_kl_reg_loss: 0.0746; val_edge_recon_loss: 533.1853; val_gene_expr_recon_loss: 411.1973; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 944.4572; val_optim_loss: 944.4572
Epoch 27/40 |█████████████-------| 67.5% val_auroc_score: 0.9853; val_auprc_score: 0.9837; val_best_acc_score: 0.9406; val_best_f1_score: 0.9415; train_kl_reg_loss: 0.0751; train_edge_recon_loss: 527.2520; train_gene_expr_recon_loss: 410.1441; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.4712; train_optim_loss: 937.4712; val_kl_reg_loss: 0.0749; val_edge_recon_loss: 532.8764; val_gene_expr_recon_loss: 411.0805; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 944.0319; val_optim_loss: 944.0319
Epoch 28/40 |██████████████------| 70.0% val_auroc_score: 0.9855; val_auprc_score: 0.9838; val_best_acc_score: 0.9407; val_best_f1_score: 0.9416; train_kl_reg_loss: 0.0753; train_edge_recon_loss: 527.2466; train_gene_expr_recon_loss: 410.1758; train_masked_gp_l1_reg_loss: 0.0000; train_group_lasso_reg_loss: 0.0000; train_global_loss: 937.4977; train_optim_loss: 937.4977; val_kl_reg_loss: 0.0751; val_edge_recon_loss: 532.8512; val_gene_expr_recon_loss: 411.2255; val_masked_gp_l1_reg_loss: 0.0000; val_group_lasso_reg_loss: 0.0000; val_global_loss: 944.1518; val_optim_loss: 944.1518
