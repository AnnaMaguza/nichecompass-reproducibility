Run timestamp: 10032023_145029.
Script arguments:
['train_autotalker_reference_model.py', '--dataset=nanostring_cosmx_human_liver_sample1', '--nichenet_max_n_target_genes_per_gp=20000', '--n_epochs=1', '--n_epochs_all_gps=1', '--lambda_group_lasso=0.', '--lambda_l1_masked=0.', '--edge_batch_size=256', '--node_batch_size=32']

Loading data...

Computing the spatial neighborhood graph...

Preparing the gene program mask...
Number of gene programs before filtering and combining: 1588.
Number of gene programs after filtering and combining: 1461.

Training model...
--- INITIALIZING NEW NETWORK MODULE: VARIATIONAL GENE PROGRAM GRAPH AUTOENCODER ---
LOSS -> include_edge_recon_loss: True, include_gene_expr_recon_loss: True, gene_expr_recon_dist: nb
NODE LABEL METHOD -> one-hop-attention
ACTIVE GP THRESHOLD RATIO -> 0.03
LOG VARIATIONAL -> True
CONDITIONAL EMBEDDING INJECTION -> ['gene_expr_decoder', 'graph_decoder']
GRAPH ENCODER -> n_input: 1000, n_cond_embed_input: 0, n_layers: 1, n_hidden: 989, n_latent: 989, n_addon_latent: 0, conv_layer: gcnconv, n_attention_heads: 0, dropout_rate: 0.0
COSINE SIM GRAPH DECODER -> n_cond_embed_input: 180, n_output: 989, dropout_rate: 0.0
MASKED GENE EXPRESSION DECODER -> n_input: 989, n_cond_embed_input: 180, n_addon_input: 0, n_output: 2000

--- INITIALIZING TRAINER ---
Number of training nodes: 299589
Number of validation nodes: 33288
Number of training edges: 1955199
Number of validation edges: 217244

--- MODEL TRAINING ---
Epoch 1/1 |████████████████████| 100.0% train_global_loss: 1029.5325; train_optim_loss: 1029.5325; val_global_loss: 1022.5037; val_optim_loss: 1022.5037

Model training finished after 76 min 46 sec.
Using best model state, which was in epoch 1.

--- MODEL EVALUATION ---
Val AUROC score: 0.9786
Val AUPRC score: 0.9746
Val best accuracy score: 0.9300
Val best F1 score: 0.9316
Val MSE score: 4.0337

Saving model...
